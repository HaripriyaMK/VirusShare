{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "Run": "May run an executable file or a system command",
            "chr": "May attempt to obfuscate specific str",
            "createObject": "May create an OLE object",
            "shell": "May run an executable file or a system command",
            "write": "May write to a file",
            "wscript.shell": "May run an executable file or a system command"
        },
        "macro": "on error resume next\nset instreem=wscript.stdin\nset outstreem=wscript.stdout\nif (lcase(right(wscript.fullname,11))=\"wscript.exe\") then\n   set objShell=wscript.createObject(\"wscript.shell\")\n   objShell.Run(\"cmd.exe /k cscript //nologo \"&chr(34)&wscript.scriptfullname&chr(34))\n   wscript.quit\nend if\nif wscript.arguments.count<4 then\n   usage()\n   wscript.echo \"Not enough parameters.\"\n   wscript.quit\nend if\n\nipaddress=wscript.arguments(0)\nusername=wscript.arguments(1)\npassword=wscript.arguments(2)\nstroption=wscript.arguments(3)\nselect case stroption\n   case \"-r\"\n      intflag=2\n      strshow=\"reboot\"\n   case \"-s\"\n      intflag=1\n      strshow=\"shutdown\"\n   case \"-l\"\n      intflag=0\n      strshow=\"logoff\"\n   case \"-p\"\n      intflag=8\n      strshow=\"power off\"\n   case \"-fr\"\n      intflag=6\n      strshow=\"force reboot\"\n   case \"-fs\"\n      inrflag=5\n      strshow=\"force shutdown\"\n   case \"-fl\"\n      intflag=4\n      strshow=\"force logoff\"\n   case \"-fp\"\n      intflag=12\n      strshow=\"force power off\"\n   case else\n      usage()\n      wscript.echo \"Parameters error.\"\n      wscript.quit\nend select\n\nusage()\noutstreem.write \"Conneting \"&ipaddress&\"....\"\nset objlocator=createobject(\"wbemscripting.swbemlocator\")\nset objswbemservices=objlocator.connectserver(ipaddress,\"root/cimv2\",username,password)\nshowerror(err.number)\n\noutstreem.write \"Applying for security privilege....\"\nobjswbemservices.security_.privileges.add 23,true\nobjswbemservices.security_.privileges.add 18,true\nshowerror(err.number)\n\nif intflag<>0 then\n   outstreem.write \"Checking boot os....\"\n   strwqlquery=\"select * from win32_computersystem\"\n   set colinstances=objswbemservices.execquery(strwqlquery)\n   for each objinstance in colinstances\n      bootos1=objinstance.properties_.item(\"systemstartupoptions\")\n   next\n   strwqlquery=\"select * from win32_operatingsystem\"\n   set colinstances=objswbemservices.execquery(strwqlquery)\n   for each objinstance in colinstances\n      bootos2=objinstance.properties_.item(\"caption\")\n   next\n   showerror(err.number)\n   if bootos1(0)<>chr(34)&bootos2&chr(34) then\n      wscript.echo \"Current os is not default boot os!\"\n      outstreem.write \"Do you want to continue?(y/n):\"\n      strinput=instreem.readline\n      if lcase(strinput)<>\"y\" then\n         wscript.echo \"Canceled!\"\n         wscript.quit\n      end if\n   end if\nend if\n\noutstreem.write \"Now, \"&strshow&\"ing target....\"\nstrwqlquery=\"select * from win32_operatingsystem where primary='true'\"\nset colinstances=objswbemservices.execquery(strwqlquery)\nfor each objinstance in colinstances\n   objinstance.win32shutdown(intflag)\nnext\nif err.number=0 then\n   wscript.echo \"OK!\"&vbcrlf&\"Target has been \"&strshow&\" Successfully!\"\nelse\n   wscript.echo \"Error!\"\nend if\n\nfunction showerror(errornumber)\nif errornumber<>0 then\n   wscript.echo \"Error!\"\n   wscript.quit\nelse\n   wscript.echo \"OK!\"\nend if\nend function\n\nfunction usage()\nwscript.echo string(79,\"*\")\nwscript.echo \"RRSS v1.03\"\nwscript.echo \"Remote Reboot and Shutdown Script, by zzzEVAzzz\"\nwscript.echo \"Welcome to visite www.isgrey.com\"\nwscript.echo \"Usage:\"\nwscript.echo \"cscript \"&wscript.scriptfullname&\" targetIP username password -r|s|l|p\"\nwscript.echo \"-r : reboot target.\"\nwscript.echo \"-s : shutdown target.\"\nwscript.echo \"-l : logoff target current user.\"\nwscript.echo \"-p : power off target.\"\nwscript.echo string(79,\"*\")&vbcrlf\nend function"
    },
    "filename": "VirusShare_001567898cf4edc6f72b9478e1783d11",
    "filesize": 3491,
    "filetype": "ASCII text, with CRLF line terminators",
    "hashes": {
        "md5": "001567898cf4edc6f72b9478e1783d11",
        "sha1": "a3b7e37593194ca0972ae1baebc6e488ea84edd7",
        "sha256": "11bb616e982fc53235fc1764a169433d69edbbd12cfdb38227c76631dbd68875"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "on error resume next",
            "set instreem=wscript.stdin",
            "set outstreem=wscript.stdout",
            "if (lcase(right(wscript.fullname,11))=\"wscript.exe\") then",
            "   set objShell=wscript.createObject(\"wscript.shell\")",
            "   objShell.Run(\"cmd.exe /k cscript //nologo \"&chr(34)&wscript.scriptfullname&chr(34))",
            "   wscript.quit",
            "end if",
            "if wscript.arguments.count<4 then",
            "   usage()",
            "   wscript.echo \"Not enough parameters.\"",
            "   wscript.quit",
            "end if",
            "ipaddress=wscript.arguments(0)",
            "username=wscript.arguments(1)",
            "password=wscript.arguments(2)",
            "stroption=wscript.arguments(3)",
            "select case stroption",
            "   case \"-r\"",
            "      intflag=2",
            "      strshow=\"reboot\"",
            "   case \"-s\"",
            "      intflag=1",
            "      strshow=\"shutdown\"",
            "   case \"-l\"",
            "      intflag=0",
            "      strshow=\"logoff\"",
            "   case \"-p\"",
            "      intflag=8",
            "      strshow=\"power off\"",
            "   case \"-fr\"",
            "      intflag=6",
            "      strshow=\"force reboot\"",
            "   case \"-fs\"",
            "      inrflag=5",
            "      strshow=\"force shutdown\"",
            "   case \"-fl\"",
            "      intflag=4",
            "      strshow=\"force logoff\"",
            "   case \"-fp\"",
            "      intflag=12",
            "      strshow=\"force power off\"",
            "   case else",
            "      usage()",
            "      wscript.echo \"Parameters error.\"",
            "      wscript.quit",
            "end select",
            "usage()",
            "outstreem.write \"Conneting \"&ipaddress&\"....\"",
            "set objlocator=createobject(\"wbemscripting.swbemlocator\")",
            "set objswbemservices=objlocator.connectserver(ipaddress,\"root/cimv2\",username,password)",
            "showerror(err.number)",
            "outstreem.write \"Applying for security privilege....\"",
            "objswbemservices.security_.privileges.add 23,true",
            "objswbemservices.security_.privileges.add 18,true",
            "showerror(err.number)",
            "if intflag<>0 then",
            "   outstreem.write \"Checking boot os....\"",
            "   strwqlquery=\"select * from win32_computersystem\"",
            "   set colinstances=objswbemservices.execquery(strwqlquery)",
            "   for each objinstance in colinstances",
            "      bootos1=objinstance.properties_.item(\"systemstartupoptions\")",
            "   next",
            "   strwqlquery=\"select * from win32_operatingsystem\"",
            "   set colinstances=objswbemservices.execquery(strwqlquery)",
            "   for each objinstance in colinstances",
            "      bootos2=objinstance.properties_.item(\"caption\")",
            "   next",
            "   showerror(err.number)",
            "   if bootos1(0)<>chr(34)&bootos2&chr(34) then",
            "      wscript.echo \"Current os is not default boot os!\"",
            "      outstreem.write \"Do you want to continue?(y/n):\"",
            "      strinput=instreem.readline",
            "      if lcase(strinput)<>\"y\" then",
            "         wscript.echo \"Canceled!\"",
            "         wscript.quit",
            "      end if",
            "   end if",
            "end if",
            "outstreem.write \"Now, \"&strshow&\"ing target....\"",
            "strwqlquery=\"select * from win32_operatingsystem where primary='true'\"",
            "set colinstances=objswbemservices.execquery(strwqlquery)",
            "for each objinstance in colinstances",
            "   objinstance.win32shutdown(intflag)",
            "next",
            "if err.number=0 then",
            "   wscript.echo \"OK!\"&vbcrlf&\"Target has been \"&strshow&\" Successfully!\"",
            "else",
            "   wscript.echo \"Error!\"",
            "end if",
            "function showerror(errornumber)",
            "if errornumber<>0 then",
            "   wscript.echo \"Error!\"",
            "   wscript.quit",
            "else",
            "   wscript.echo \"OK!\"",
            "end if",
            "end function",
            "function usage()",
            "wscript.echo string(79,\"*\")",
            "wscript.echo \"RRSS v1.03\"",
            "wscript.echo \"Remote Reboot and Shutdown Script, by zzzEVAzzz\"",
            "wscript.echo \"Welcome to visite www.isgrey.com\"",
            "wscript.echo \"Usage:\"",
            "wscript.echo \"cscript \"&wscript.scriptfullname&\" targetIP username password -r|s|l|p\"",
            "wscript.echo \"-r : reboot target.\"",
            "wscript.echo \"-s : shutdown target.\"",
            "wscript.echo \"-l : logoff target current user.\"",
            "wscript.echo \"-p : power off target.\"",
            "wscript.echo string(79,\"*\")&vbcrlf",
            "end function"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.283006",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
